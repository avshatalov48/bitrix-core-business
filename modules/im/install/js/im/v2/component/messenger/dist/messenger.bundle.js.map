{"version":3,"file":"messenger.bundle.js","sources":["../src/messenger.js"],"sourcesContent":["import 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport 'im.v2.css.tokens';\nimport 'im.v2.css.icons';\nimport 'im.v2.css.classes';\n\nimport { MessengerNavigation } from 'im.v2.component.navigation';\nimport { RecentListContainer } from 'im.v2.component.list.container.recent';\nimport { OpenlineListContainer } from 'im.v2.component.list.container.openline';\nimport { ChannelListContainer } from 'im.v2.component.list.container.channel';\nimport { ChatContent } from 'im.v2.component.content.chat';\nimport { CreateChatContent, UpdateChatContent } from 'im.v2.component.content.chat-forms';\nimport { OpenlinesContent } from 'im.v2.component.content.openlines';\nimport { NotificationContent } from 'im.v2.component.content.notification';\nimport { MarketContent } from 'im.v2.component.content.market';\nimport { SettingsContent } from 'im.v2.component.content.settings';\nimport { CopilotListContainer } from 'im.v2.component.list.container.copilot';\nimport { CopilotContent } from 'im.v2.component.content.copilot';\nimport { Analytics } from 'im.v2.lib.analytics';\n\nimport { Logger } from 'im.v2.lib.logger';\nimport { InitManager } from 'im.v2.lib.init';\nimport { Layout } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { ThemeManager } from 'im.v2.lib.theme';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { LayoutManager } from 'im.v2.lib.layout';\n\nimport './css/messenger.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelLayout } from 'im.v2.model';\n\n// @vue/component\nexport const Messenger = {\n\tname: 'MessengerRoot',\n\tcomponents: {\n\t\tMessengerNavigation,\n\t\tRecentListContainer,\n\t\tChannelListContainer,\n\t\tOpenlineListContainer,\n\t\tChatContent,\n\t\tCreateChatContent,\n\t\tUpdateChatContent,\n\t\tOpenlinesContent,\n\t\tNotificationContent,\n\t\tMarketContent,\n\t\tSettingsContent,\n\t\tCopilotListContainer,\n\t\tCopilotContent,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\topenlinesContentOpened: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tlayoutName(): string\n\t\t{\n\t\t\treturn this.layout?.name;\n\t\t},\n\t\tcurrentLayout(): {name: string, list: string, content: string}\n\t\t{\n\t\t\treturn Layout[this.layout.name];\n\t\t},\n\t\tentityId(): string\n\t\t{\n\t\t\treturn this.layout.entityId;\n\t\t},\n\t\tisOpenline(): boolean\n\t\t{\n\t\t\treturn this.layout.name === Layout.openlines.name;\n\t\t},\n\t\thasList(): boolean\n\t\t{\n\t\t\treturn Boolean(this.currentLayout.list);\n\t\t},\n\t\tcontainerClasses(): string[]\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--dark-theme': ThemeManager.isDarkTheme(),\n\t\t\t\t'--light-theme': ThemeManager.isLightTheme(),\n\t\t\t\t'--desktop': DesktopManager.isDesktop(),\n\t\t\t};\n\t\t},\n\t\tcallContainerClass(): string[]\n\t\t{\n\t\t\treturn [CallManager.viewContainerClass];\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tlayoutName:\n\t\t{\n\t\t\thandler(newLayoutName)\n\t\t\t{\n\t\t\t\tif (newLayoutName !== Layout.openlines.name)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.openlinesContentOpened = true;\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tInitManager.start();\n\t\tLayoutManager.init();\n\t\tLogger.warn('MessengerRoot created');\n\n\t\tthis.getLayoutManager().restoreLastLayout();\n\t\tthis.sendAnalytics();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.getLayoutManager().destroy();\n\t},\n\tmethods:\n\t{\n\t\tonNavigationClick({ layoutName, layoutEntityId }: {layoutName: string, layoutEntityId: string | number})\n\t\t{\n\t\t\tlet entityId = layoutEntityId;\n\n\t\t\tconst lastOpenedElement = this.getLayoutManager().getLastOpenedElement(layoutName);\n\t\t\tif (!entityId && lastOpenedElement)\n\t\t\t{\n\t\t\t\tentityId = lastOpenedElement;\n\t\t\t}\n\n\t\t\tthis.getLayoutManager().setLayout({ name: layoutName, entityId });\n\t\t},\n\t\tonEntitySelect({ layoutName, entityId })\n\t\t{\n\t\t\tthis.getLayoutManager().setLayout({ name: layoutName, entityId });\n\t\t},\n\t\tgetLayoutManager(): LayoutManager\n\t\t{\n\t\t\treturn LayoutManager.getInstance();\n\t\t},\n\t\tsendAnalytics()\n\t\t{\n\t\t\tAnalytics.getInstance().onOpenMessenger();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-messenger__scope bx-im-messenger__container\" :class=\"containerClasses\">\n\t\t\t<div class=\"bx-im-messenger__navigation_container\">\n\t\t\t\t<MessengerNavigation :currentLayoutName=\"currentLayout.name\" @navigationClick=\"onNavigationClick\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-messenger__layout_container\">\n\t\t\t\t<div class=\"bx-im-messenger__layout_content\">\n\t\t\t\t\t<div v-if=\"currentLayout.list\" class=\"bx-im-messenger__list_container\">\n\t\t\t\t\t\t<KeepAlive>\n\t\t\t\t\t\t\t<component :is=\"currentLayout.list\" @selectEntity=\"onEntitySelect\" />\n\t\t\t\t\t\t</KeepAlive>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-messenger__content_container\" :class=\"{'--with-list': hasList}\">\n\t\t\t\t\t\t<div v-if=\"openlinesContentOpened\" class=\"bx-im-messenger__openlines_container\" :class=\"{'--hidden': !isOpenline}\">\n\t\t\t\t\t\t\t<OpenlinesContent v-show=\"isOpenline\" :entityId=\"entityId\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<component v-if=\"!isOpenline\" :is=\"currentLayout.content\" :entityId=\"entityId\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div :class=\"callContainerClass\"></div>\n\t`,\n};\n"],"names":["Messenger","name","components","MessengerNavigation","RecentListContainer","ChannelListContainer","OpenlineListContainer","ChatContent","CreateChatContent","UpdateChatContent","OpenlinesContent","NotificationContent","MarketContent","SettingsContent","CopilotListContainer","CopilotContent","data","openlinesContentOpened","computed","layout","$store","getters","layoutName","currentLayout","Layout","entityId","isOpenline","openlines","hasList","Boolean","list","containerClasses","ThemeManager","isDarkTheme","isLightTheme","DesktopManager","isDesktop","callContainerClass","CallManager","viewContainerClass","watch","handler","newLayoutName","immediate","created","InitManager","start","LayoutManager","init","Logger","warn","getLayoutManager","restoreLastLayout","sendAnalytics","beforeUnmount","destroy","methods","onNavigationClick","layoutEntityId","lastOpenedElement","getLastOpenedElement","setLayout","onEntitySelect","getInstance","Analytics","onOpenMessenger","template"],"mappings":"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"}