this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,t,i,n,s){"use strict";function a(e,t){l(e,t);t.add(e)}function r(e,t,i){l(e,t);t.set(e,i)}function l(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function o(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var c=t.Reflection.namespace("BX.Bizproc.Component");var u=new WeakMap;var h=new WeakMap;var b=new WeakMap;var d=new WeakSet;var p=new WeakSet;var v=new WeakSet;var f=new WeakSet;var B=new WeakSet;var g=new WeakSet;var m=new WeakSet;var S=new WeakSet;var w=new WeakSet;var k=function(){function e(i){babelHelpers.classCallCheck(this,e);a(this,w);a(this,S);a(this,m);a(this,g);a(this,B);a(this,f);a(this,v);a(this,p);a(this,d);r(this,u,{writable:true,value:""});r(this,h,{writable:true,value:null});r(this,b,{writable:true,value:null});babelHelpers.classPrivateFieldSet(this,u,i.documentSigned);babelHelpers.classPrivateFieldSet(this,h,i.activeSession?new n.Session(i.activeSession):null);babelHelpers.classPrivateFieldSet(this,b,t.Text.toInteger(i.currentUserId))}babelHelpers.createClass(e,[{key:"init",value:function e(){if(babelHelpers.classPrivateFieldGet(this,h)){o(this,d,E).call(this);o(this,v,H).call(this);if(babelHelpers.classPrivateFieldGet(this,b)===babelHelpers.classPrivateFieldGet(this,h).startedBy){o(this,f,P).call(this)}}else{o(this,B,C).call(this)}}},{key:"buttons",get:function e(){var t={};t[n.Mode.experimental.id]=document.getElementById("bizproc-debugger-start-experimental-element");t[n.Mode.interception.id]=document.getElementById("bizproc-debugger-start-interception-element");return t}}]);return e}();function E(){var e=this.buttons;Object.keys(e).forEach((function(i){t.Dom.addClass(e[i],"ui-btn-disabled")}))}function D(){var e=this.buttons;Object.keys(e).forEach((function(i){t.Dom.removeClass(e[i],"ui-btn-disabled");t.Dom.attr(e[i],"disabled",null)}))}function H(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,h)){return}var i=this.buttons;Object.keys(i).forEach((function(n){t.Dom.attr(i[n],"data-hint",t.Text.encode(babelHelpers.classPrivateFieldGet(e,h).shortDescription));t.Dom.attr(i[n],"data-hint-no-icon","y");BX.UI.Hint.init(BX(i[n].id).parentElement)}))}function P(){var e=this.buttons;var i=babelHelpers.classPrivateFieldGet(this,h).modeId;if(e[i]){var n=e[i].id;var a=new s.Button({props:{id:n},color:s.ButtonColor.LIGHT_BORDER,size:s.ButtonSize.SMALL,text:t.Loc.getMessage("BIZPROC_DEBUGGER_START_TEMPLATE_FINISH"),round:true,onclick:o(this,m,I).bind(this)});t.Dom.replace(e[i],a.render())}}function C(){var e=this;var i=this.buttons;Object.keys(i).forEach((function(n){t.Event.bind(i[n],"click",(function(){o(e,g,F).call(e,i[n],n)}))}))}function F(e,i){var n=this;top.BX.Runtime.loadExtension("bizproc.debugger").then((function(s){o(n,d,E).call(n);t.Dom.addClass(e,"ui-btn-wait");var a=s.Manager;a.Instance.startSession(babelHelpers.classPrivateFieldGet(n,u),t.Text.toInteger(i)).then((function(){o(n,p,D).call(n);BX.SidePanel.Instance.closeAll();return true}),(function(i){o(n,w,X).call(n,i,(function(){o(n,p,D).call(n);t.Dom.removeClass(e,"ui-btn-wait");return true}))}))}))}function I(e){var t=this;e.setDisabled(true);e.setWaiting(true);if(top.BX.Bizproc.Debugger){top.BX.Bizproc.Debugger.Manager.Instance.askFinishSession(babelHelpers.classPrivateFieldGet(this,h)).then(o(this,S,T).bind(this),(function(i){o(t,w,X).call(t,i,(function(){e.setDisabled(false);e.setWaiting(false);return true}))}))}else{babelHelpers.classPrivateFieldGet(this,h).finish().then(o(this,S,T).bind(this),(function(i){o(t,w,X).call(t,i,(function(){e.setDisabled(false);e.setWaiting(false);return true}))}))}}function T(){var e=this.buttons;var i=babelHelpers.classPrivateFieldGet(this,h).modeId;var n=e[i].id;o(this,p,D).call(this);babelHelpers.classPrivateFieldSet(this,h,null);t.Dom.replace(e[i],new s.Button({props:{id:n},color:s.ButtonColor.SUCCESS,size:s.ButtonSize.SMALL,text:t.Loc.getMessage("BIZPROC_DEBUGGER_START_TEMPLATE_START"),round:true}).render());this.init()}function X(e,n){if(t.Type.isArrayFilled(e.errors)){var s="";e.errors.forEach((function(e){s=s+"\n"+e.message}));i.MessageBox.alert(s,n)}else if(t.Type.isFunction(n)){n()}}c.DebuggerStartComponent=k})(this.BX.Bizproc.Component=this.BX.Bizproc.Component||{},BX,BX.UI.Dialogs,BX.Bizproc.Debugger,BX.UI);
//# sourceMappingURL=script.map.js