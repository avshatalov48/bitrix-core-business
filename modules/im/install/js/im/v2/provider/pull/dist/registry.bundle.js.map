{"version":3,"file":"registry.bundle.js","sources":["../src/base/message.js","../src/base/chat.js","../src/base/user.js","../src/base/desktop.js","../src/base/settings.js","../src/base.js","../src/recent.js","../src/copilot-recent.js","../src/notification.js","../src/sidebar.js","../src/notifier.js","../src/lines.js","../src/online.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\nimport { UserManager } from 'im.v2.lib.user';\nimport { UuidManager } from 'im.v2.lib.uuid';\nimport { WritingManager } from 'im.v2.lib.writing';\nimport { EventType, DialogScrollThreshold, UserRole } from 'im.v2.const';\nimport { MessageService } from 'im.v2.provider.service';\n\nimport type { ImModelChat, ImModelMessage } from 'im.v2.model';\n\nimport type {\n\tMessageAddParams,\n\tMessageUpdateParams,\n\tMessageDeleteParams,\n\tMessageDeleteCompleteParams,\n\tReadMessageParams,\n\tReadMessageOpponentParams,\n\tPinAddParams,\n\tPinDeleteParams,\n\tAddReactionParams,\n\tDeleteReactionParams,\n} from '../types/message';\nimport type { PullExtraParams, RawFile, RawUser, RawMessage } from '../types/common';\n\ntype UserId = number;\n\nexport class MessagePullHandler\n{\n\t#store: Store;\n\t#messageViews: {[messageId: string]: Set<UserId>} = {};\n\n\tconstructor()\n\t{\n\t\tthis.#store = Core.getStore();\n\t}\n\n\thandleMessageAdd(params: MessageAddParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleMessageAdd', params);\n\t\tthis.#setMessageChat(params);\n\t\tthis.#setUsers(params);\n\t\tthis.#setFiles(params);\n\t\tthis.#setAdditionalEntities(params);\n\n\t\tconst messageWithTemplateId = this.#store.getters['messages/isInChatCollection']({\n\t\t\tmessageId: params.message.templateId,\n\t\t});\n\n\t\tconst messageWithRealId = this.#store.getters['messages/isInChatCollection']({\n\t\t\tmessageId: params.message.id,\n\t\t});\n\n\t\t// update message with parsed link info\n\t\tif (messageWithRealId)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we already have this message', params.message);\n\t\t\tthis.#store.dispatch('messages/update', {\n\t\t\t\tid: params.message.id,\n\t\t\t\tfields: { ...params.message, error: false },\n\t\t\t});\n\t\t\tthis.#sendScrollEvent(params.chatId);\n\t\t}\n\t\telse if (!messageWithRealId && messageWithTemplateId)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we already have the TEMPORARY message', params.message);\n\t\t\tthis.#store.dispatch('messages/updateWithId', {\n\t\t\t\tid: params.message.templateId,\n\t\t\t\tfields: { ...params.message, error: false },\n\t\t\t});\n\t\t}\n\t\t// it's an opponent message or our own message from somewhere else\n\t\telse if (!messageWithRealId && !messageWithTemplateId)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we dont have this message', params.message);\n\t\t\tthis.#handleAddingMessageToModel(params);\n\t\t}\n\n\t\tWritingManager.getInstance().stopWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.message.senderId,\n\t\t});\n\n\t\tthis.#updateDialog(params);\n\t}\n\n\thandleMessageUpdate(params: MessageUpdateParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleMessageUpdate', params);\n\t\tWritingManager.getInstance().stopWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t});\n\t\tthis.#store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tfields: {\n\t\t\t\ttext: params.text,\n\t\t\t\tparams: params.params,\n\t\t\t},\n\t\t});\n\t\tthis.#sendScrollEvent(params.chatId);\n\t}\n\n\thandleMessageDelete(params: MessageDeleteParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleMessageDelete', params);\n\t\tWritingManager.getInstance().stopWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t});\n\t\tthis.#store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tfields: {\n\t\t\t\ttext: '',\n\t\t\t\tisDeleted: true,\n\t\t\t\tfiles: [],\n\t\t\t\tattach: [],\n\t\t\t\treplyId: 0,\n\t\t\t},\n\t\t});\n\t}\n\n\thandleMessageDeleteComplete(params: MessageDeleteCompleteParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleMessageDeleteComplete', params);\n\t\tWritingManager.getInstance().stopWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t});\n\n\t\tthis.#store.dispatch('messages/delete', {\n\t\t\tid: params.id,\n\t\t});\n\n\t\tconst dialogUpdateFields = {\n\t\t\tcounter: params.counter,\n\t\t};\n\n\t\tconst lastMessageWasDeleted = Boolean(params.newLastMessage);\n\t\tif (lastMessageWasDeleted)\n\t\t{\n\t\t\tdialogUpdateFields.lastMessageId = params.newLastMessage.id;\n\t\t\tdialogUpdateFields.lastMessageViews = params.lastMessageViews;\n\t\t}\n\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: dialogUpdateFields,\n\t\t});\n\t}\n\n\thandleAddReaction(params: AddReactionParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleAddReaction', params);\n\t\tconst {\n\t\t\tactualReactions: { reaction: actualReactionsState, usersShort },\n\t\t\tuserId,\n\t\t\treaction,\n\t\t} = params;\n\t\tif (Core.getUserId() === userId)\n\t\t{\n\t\t\tactualReactionsState.ownReactions = [reaction];\n\t\t}\n\n\t\tconst userManager = new UserManager();\n\t\tuserManager.addUsersToModel(usersShort);\n\n\t\tthis.#store.dispatch('messages/reactions/set', [actualReactionsState]);\n\t}\n\n\thandleDeleteReaction(params: DeleteReactionParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleDeleteReaction', params);\n\t\tconst { actualReactions: { reaction: actualReactionsState } } = params;\n\t\tthis.#store.dispatch('messages/reactions/set', [actualReactionsState]);\n\t}\n\n\thandleMessageParamsUpdate(params)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleMessageParamsUpdate', params);\n\n\t\tthis.#store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: { params: params.params },\n\t\t});\n\t}\n\n\thandleReadMessage(params: ReadMessageParams, extra: PullExtraParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleReadMessage', params);\n\t\tconst uuidManager = UuidManager.getInstance();\n\t\tif (uuidManager.hasActionUuid(extra.action_uuid))\n\t\t{\n\t\t\tLogger.warn('MessagePullHandler: handleReadMessage: we have this uuid, skip');\n\t\t\tuuidManager.removeActionUuid(extra.action_uuid);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('messages/readMessages', {\n\t\t\tchatId: params.chatId,\n\t\t\tmessageIds: params.viewedMessages,\n\t\t}).then(() => {\n\t\t\tthis.#store.dispatch('chats/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t\tlastId: params.lastId,\n\t\t\t\t},\n\t\t\t});\n\t\t}).catch((error) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error('MessagePullHandler: error handling readMessage', error);\n\t\t});\n\t}\n\n\thandleReadMessageOpponent(params: ReadMessageOpponentParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handleReadMessageOpponent', params);\n\t\tthis.#updateMessageViewedByOthers(params);\n\t\tthis.#updateChatLastMessageViews(params);\n\t}\n\n\thandlePinAdd(params: PinAddParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handlePinAdd', params);\n\t\tthis.#setFiles(params);\n\t\tthis.#setUsers(params);\n\t\tthis.#store.dispatch('messages/store', params.additionalMessages);\n\t\tthis.#store.dispatch('messages/pin/add', {\n\t\t\tchatId: params.pin.chatId,\n\t\t\tmessageId: params.pin.messageId,\n\t\t});\n\t\tif (Core.getUserId() !== params.pin.authorId)\n\t\t{\n\t\t\t// this.#sendScrollEvent(params.link.chatId);\n\t\t}\n\t}\n\n\thandlePinDelete(params: PinDeleteParams)\n\t{\n\t\tLogger.warn('MessagePullHandler: handlePinDelete', params);\n\t\tthis.#store.dispatch('messages/pin/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tmessageId: params.messageId,\n\t\t});\n\t}\n\n\t// helpers\n\t#setMessageChat(params: MessageAddParams)\n\t{\n\t\tif (!params?.chat[params.chatId])\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatToAdd = { ...params.chat[params.chatId], dialogId: params.dialogId };\n\t\tconst dialogExists = Boolean(this.#getDialog(params.dialogId));\n\t\tconst messageWithoutNotification = !params.notify || params.message?.params?.NOTIFY === 'N';\n\t\tif (!dialogExists && !messageWithoutNotification && !chatToAdd.role)\n\t\t{\n\t\t\tchatToAdd.role = UserRole.member;\n\t\t}\n\t\tthis.#store.dispatch('chats/set', chatToAdd);\n\t}\n\n\t#setUsers(params: {users: {[userId: string]: RawUser} | []})\n\t{\n\t\tif (!params.users)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst userManager = new UserManager();\n\t\tuserManager.setUsersToModel(Object.values(params.users));\n\t}\n\n\t#setFiles(params: {files: {[fileId: string]: RawFile} | [], message?: RawMessage})\n\t{\n\t\tif (!params.files)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst files = Object.values(params.files);\n\t\tfiles.forEach((file: RawFile) => {\n\t\t\tconst templateFileIdExists = this.#store.getters['files/isInCollection']({\n\t\t\t\tfileId: params.message?.templateFileId,\n\t\t\t});\n\t\t\tif (templateFileIdExists)\n\t\t\t{\n\t\t\t\tthis.#store.dispatch('files/updateWithId', {\n\t\t\t\t\tid: params.message?.templateFileId,\n\t\t\t\t\tfields: file,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#store.dispatch('files/set', file);\n\t\t\t}\n\t\t});\n\t}\n\n\t#setAdditionalEntities(params: MessageAddParams): void\n\t{\n\t\tif (!params.message.additionalEntities)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tadditionalMessages,\n\t\t\tmessages,\n\t\t\tfiles,\n\t\t\tusers,\n\t\t} = params.message.additionalEntities;\n\t\tconst newMessages = [...messages, ...additionalMessages];\n\t\tthis.#store.dispatch('messages/store', newMessages);\n\t\tthis.#store.dispatch('files/set', files);\n\t\tthis.#store.dispatch('users/set', users);\n\t}\n\n\t#handleAddingMessageToModel(params: MessageAddParams)\n\t{\n\t\tconst dialog = this.#getDialog(params.dialogId, true);\n\t\tif (dialog.inited && dialog.hasNextPage)\n\t\t{\n\t\t\tthis.#store.dispatch('messages/store', params.message);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatIsOpened = this.#store.getters['application/isChatOpen'](params.dialogId);\n\t\tconst unreadMessages: ImModelMessage[] = this.#store.getters['messages/getChatUnreadMessages'](params.chatId);\n\t\tif (!chatIsOpened && unreadMessages.length > MessageService.getMessageRequestLimit())\n\t\t{\n\t\t\tconst messageService = new MessageService({ chatId: params.chatId });\n\t\t\tmessageService.reloadMessageList();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#addMessageToModel(params.message);\n\t\tthis.#sendScrollEvent(params.chatId);\n\t}\n\n\t#addMessageToModel(message)\n\t{\n\t\tconst newMessage = { ...message };\n\t\tif (message.senderId === Core.getUserId())\n\t\t{\n\t\t\tnewMessage.unread = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewMessage.unread = true;\n\t\t\tnewMessage.viewed = false;\n\t\t}\n\t\tthis.#store.dispatch('messages/setChatCollection', { messages: [newMessage] });\n\t}\n\n\t#updateDialog(params)\n\t{\n\t\tconst dialog = this.#getDialog(params.dialogId, true);\n\n\t\tconst dialogFieldsToUpdate = {};\n\t\tif (params.message.id > dialog.lastMessageId)\n\t\t{\n\t\t\tdialogFieldsToUpdate.lastMessageId = params.message.id;\n\t\t}\n\n\t\tif (params.message.senderId === Core.getUserId() && params.message.id > dialog.lastReadId)\n\t\t{\n\t\t\tdialogFieldsToUpdate.lastId = params.message.id;\n\t\t}\n\n\t\tdialogFieldsToUpdate.counter = params.counter;\n\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: dialogFieldsToUpdate,\n\t\t});\n\t\tthis.#store.dispatch('chats/clearLastMessageViews', {\n\t\t\tdialogId: params.dialogId,\n\t\t});\n\t}\n\n\t#updateMessageViewedByOthers(params: ReadMessageOpponentParams)\n\t{\n\t\tthis.#store.dispatch('messages/setViewedByOthers', { ids: params.viewedMessages });\n\t}\n\n\t#updateChatLastMessageViews(params: ReadMessageOpponentParams)\n\t{\n\t\tconst dialog = this.#getDialog(params.dialogId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isLastMessage = params.viewedMessages.includes(dialog.lastMessageId);\n\t\tif (!isLastMessage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#checkMessageViewsRegistry(params.userId, dialog.lastMessageId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasFirstViewer = Boolean(dialog.lastMessageViews.firstViewer);\n\t\tif (hasFirstViewer)\n\t\t{\n\t\t\tthis.#store.dispatch('chats/incrementLastMessageViews', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('chats/setLastMessageViews', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tuserId: params.userId,\n\t\t\t\tuserName: params.userName,\n\t\t\t\tdate: params.date,\n\t\t\t\tmessageId: dialog.lastMessageId,\n\t\t\t},\n\t\t});\n\n\t\tthis.#updateMessageViewsRegistry(params.userId, dialog.lastMessageId);\n\t}\n\n\t#checkMessageViewsRegistry(userId: number, messageId: number): boolean\n\t{\n\t\treturn Boolean(this.#messageViews[messageId]?.has(userId));\n\t}\n\n\t#updateMessageViewsRegistry(userId: number, messageId: number): void\n\t{\n\t\tif (!this.#messageViews[messageId])\n\t\t{\n\t\t\tthis.#messageViews[messageId] = new Set();\n\t\t}\n\n\t\tthis.#messageViews[messageId].add(userId);\n\t}\n\n\t#sendScrollEvent(chatId: number)\n\t{\n\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, { chatId, threshold: DialogScrollThreshold.nearTheBottom });\n\t}\n\n\t#getDialog(dialogId: string, temporary: boolean = false): ?ImModelChat\n\t{\n\t\treturn this.#store.getters['chats/get'](dialogId, temporary);\n\t}\n}\n","import { Store } from 'ui.vue3.vuex';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { UserManager } from 'im.v2.lib.user';\nimport { CallManager } from 'im.v2.lib.call';\nimport { WritingManager } from 'im.v2.lib.writing';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport type {\n\tChatOwnerParams,\n\tChatManagersParams,\n\tChatUserAddParams,\n\tChatUserLeaveParams,\n\tStartWritingParams,\n\tChatUnreadParams,\n\tChatMuteNotifyParams,\n\tChatRenameParams,\n\tChatAvatarParams,\n} from '../types/chat';\nimport type { RawUser } from '../types/common';\n\nexport class ChatPullHandler\n{\n\t#store: Store;\n\n\tconstructor()\n\t{\n\t\tthis.#store = Core.getStore();\n\t}\n\n\thandleChatOwner(params: ChatOwnerParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleChatOwner', params);\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\townerId: params.userId,\n\t\t\t},\n\t\t});\n\t}\n\n\thandleChatManagers(params: ChatManagersParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleChatManagers', params);\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmanagerList: params.list,\n\t\t\t},\n\t\t});\n\t}\n\n\thandleChatUserAdd(params: ChatUserAddParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleChatUserAdd', params);\n\t\tthis.#updateChatUsers(params);\n\t}\n\n\thandleChatUserLeave(params: ChatUserLeaveParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleChatUserLeave', params);\n\t\tconst currentUserIsKicked = params.userId === Core.getUserId();\n\n\t\tif (currentUserIsKicked)\n\t\t{\n\t\t\tthis.#store.dispatch('chats/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tinited: false,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.#store.dispatch('messages/clearChatCollection', { chatId: params.chatId });\n\t\t}\n\n\t\tconst chatIsOpened = this.#store.getters['application/isChatOpen'](params.dialogId);\n\t\tif (currentUserIsKicked && chatIsOpened)\n\t\t{\n\t\t\tMessenger.openChat();\n\t\t}\n\n\t\tconst chatHasCall = CallManager.getInstance().getCurrentCallDialogId() === params.dialogId;\n\t\tif (currentUserIsKicked && chatHasCall)\n\t\t{\n\t\t\tCallManager.getInstance().leaveCurrentCall();\n\t\t}\n\n\t\tthis.#updateChatUsers(params);\n\t}\n\n\thandleStartWriting(params: StartWritingParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleStartWriting', params);\n\t\tconst { dialogId, userId, userName } = params;\n\t\tWritingManager.getInstance().startWriting({ dialogId, userId, userName });\n\t\tthis.#store.dispatch('users/update', {\n\t\t\tid: userId,\n\t\t\tfields: {\n\t\t\t\tlastActivityDate: new Date(),\n\t\t\t},\n\t\t});\n\t}\n\n\thandleChatUnread(params: ChatUnreadParams)\n\t{\n\t\tLogger.warn('ChatPullHandler: handleChatUnread', params);\n\t\tlet markedId = 0;\n\t\tif (params.active === true)\n\t\t{\n\t\t\tmarkedId = params.markedId;\n\t\t}\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: { markedId },\n\t\t});\n\t}\n\n\thandleChatMuteNotify(params: ChatMuteNotifyParams)\n\t{\n\t\tif (params.muted)\n\t\t{\n\t\t\tthis.#store.dispatch('chats/mute', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('chats/unmute', {\n\t\t\tdialogId: params.dialogId,\n\t\t});\n\t}\n\n\thandleChatRename(params: ChatRenameParams)\n\t{\n\t\tconst dialog = this.#store.getters['chats/getByChatId'](params.chatId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: dialog.dialogId,\n\t\t\tfields: {\n\t\t\t\tname: params.name,\n\t\t\t},\n\t\t});\n\t}\n\n\thandleChatAvatar(params: ChatAvatarParams)\n\t{\n\t\tconst dialog = this.#store.getters['chats/getByChatId'](params.chatId);\n\t\tif (!dialog)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: dialog.dialogId,\n\t\t\tfields: {\n\t\t\t\tavatar: params.avatar,\n\t\t\t},\n\t\t});\n\t}\n\n\thandleReadAllChats()\n\t{\n\t\tLogger.warn('ChatPullHandler: handleReadAllChats');\n\t\tthis.#store.dispatch('chats/clearCounters');\n\t\tthis.#store.dispatch('recent/clearUnread');\n\t}\n\n\t#updateChatUsers(params: {\n\t\tusers?: {[userId: string]: RawUser},\n\t\tdialogId: string,\n\t\tuserCount: number\n\t})\n\t{\n\t\tif (params.users)\n\t\t{\n\t\t\tconst userManager = new UserManager();\n\t\t\tuserManager.setUsersToModel(Object.values(params.users));\n\t\t}\n\n\t\tthis.#store.dispatch('chats/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: { userCounter: params.userCount },\n\t\t});\n\t}\n}\n","import {Store} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {UserInviteParams} from '../types/user';\n\nexport class UserPullHandler\n{\n\t#store: Store;\n\n\tconstructor()\n\t{\n\t\tthis.#store = Core.getStore();\n\t}\n\n\thandleUserInvite(params: UserInviteParams)\n\t{\n\t\tif (params.invited)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch('users/update', {\n\t\t\tid: params.userId,\n\t\t\tfields: params.user,\n\t\t});\n\t}\n}","import {Logger} from 'im.v2.lib.logger';\nimport {DesktopManager} from 'im.v2.lib.desktop';\nimport {CounterManager} from 'im.v2.lib.counter';\n\nimport type {DesktopOnlineParams} from '../types/desktop';\n\nexport class DesktopPullHandler\n{\n\thandleDesktopOnline(params: DesktopOnlineParams)\n\t{\n\t\tLogger.warn('DesktopPullHandler: handleDesktopOnline', params);\n\t\tconst desktopManager = DesktopManager.getInstance();\n\t\tdesktopManager.setDesktopActive(true);\n\n\t\tCounterManager.getInstance().removeBrowserTitleCounter();\n\t}\n\n\thandleDesktopOffline()\n\t{\n\t\tLogger.warn('DesktopPullHandler: handleDesktopOffline');\n\t\tDesktopManager.getInstance().setDesktopActive(false);\n\t}\n}","import { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport { SettingsUpdateParams } from '../types/settings';\n\nexport class SettingsPullHandler\n{\n\thandleSettingsUpdate(params: SettingsUpdateParams)\n\t{\n\t\tLogger.warn('SettingsPullHandler: handleSettingsUpdate', params);\n\t\tObject.entries(params).forEach(([optionName, optionValue]) => {\n\t\t\tCore.getStore().dispatch('application/settings/set', {\n\t\t\t\t[optionName]: optionValue,\n\t\t\t});\n\t\t});\n\t}\n}\n","import { MessagePullHandler } from './base/message';\nimport { ChatPullHandler } from './base/chat';\nimport { UserPullHandler } from './base/user';\nimport { DesktopPullHandler } from './base/desktop';\nimport { SettingsPullHandler } from './base/settings';\n\nexport class BasePullHandler\n{\n\t#messageHandler: MessagePullHandler;\n\t#chatHandler: ChatPullHandler;\n\t#userHandler: UserPullHandler;\n\t#desktopHandler: DesktopPullHandler;\n\t#settingsHandler: SettingsPullHandler;\n\n\tconstructor()\n\t{\n\t\tthis.#messageHandler = new MessagePullHandler();\n\t\tthis.#chatHandler = new ChatPullHandler();\n\t\tthis.#userHandler = new UserPullHandler();\n\t\tthis.#desktopHandler = new DesktopPullHandler();\n\t\tthis.#settingsHandler = new SettingsPullHandler();\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\t// region 'message'\n\thandleMessage(params)\n\t{\n\t\tthis.#messageHandler.handleMessageAdd(params);\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tthis.#messageHandler.handleMessageAdd(params);\n\t}\n\n\thandleMessageUpdate(params)\n\t{\n\t\tthis.#messageHandler.handleMessageUpdate(params);\n\t}\n\n\thandleMessageDelete(params)\n\t{\n\t\tthis.#messageHandler.handleMessageDelete(params);\n\t}\n\n\thandleMessageDeleteComplete(params)\n\t{\n\t\tthis.#messageHandler.handleMessageDeleteComplete(params);\n\t}\n\n\thandleAddReaction(params)\n\t{\n\t\tthis.#messageHandler.handleAddReaction(params);\n\t}\n\n\thandleDeleteReaction(params)\n\t{\n\t\tthis.#messageHandler.handleDeleteReaction(params);\n\t}\n\n\thandleMessageParamsUpdate(params)\n\t{\n\t\tthis.#messageHandler.handleMessageParamsUpdate(params);\n\t}\n\n\thandleReadMessage(params, extra)\n\t{\n\t\tthis.#messageHandler.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageChat(params, extra)\n\t{\n\t\tthis.#messageHandler.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageOpponent(params)\n\t{\n\t\tthis.#messageHandler.handleReadMessageOpponent(params);\n\t}\n\n\thandleReadMessageChatOpponent(params)\n\t{\n\t\tthis.#messageHandler.handleReadMessageOpponent(params);\n\t}\n\n\thandlePinAdd(params)\n\t{\n\t\tthis.#messageHandler.handlePinAdd(params);\n\t}\n\n\thandlePinDelete(params)\n\t{\n\t\tthis.#messageHandler.handlePinDelete(params);\n\t}\n\t// endregion 'message'\n\n\t// region 'chat'\n\thandleChatOwner(params)\n\t{\n\t\tthis.#chatHandler.handleChatOwner(params);\n\t}\n\n\thandleChatManagers(params)\n\t{\n\t\tthis.#chatHandler.handleChatManagers(params);\n\t}\n\n\thandleChatUserAdd(params)\n\t{\n\t\tthis.#chatHandler.handleChatUserAdd(params);\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tthis.#chatHandler.handleChatUserLeave(params);\n\t}\n\n\thandleStartWriting(params)\n\t{\n\t\tthis.#chatHandler.handleStartWriting(params);\n\t}\n\n\thandleChatUnread(params)\n\t{\n\t\tthis.#chatHandler.handleChatUnread(params);\n\t}\n\n\thandleReadAllChats()\n\t{\n\t\tthis.#chatHandler.handleReadAllChats();\n\t}\n\n\thandleChatMuteNotify(params)\n\t{\n\t\tthis.#chatHandler.handleChatMuteNotify(params);\n\t}\n\n\thandleChatRename(params)\n\t{\n\t\tthis.#chatHandler.handleChatRename(params);\n\t}\n\n\thandleChatAvatar(params)\n\t{\n\t\tthis.#chatHandler.handleChatAvatar(params);\n\t}\n\t// endregion 'chat'\n\n\t// region 'user'\n\thandleUserInvite(params)\n\t{\n\t\tthis.#userHandler.handleUserInvite(params);\n\t}\n\t// endregion 'user'\n\n\t// region 'desktop'\n\thandleDesktopOnline(params)\n\t{\n\t\tthis.#desktopHandler.handleDesktopOnline(params);\n\t}\n\n\thandleDesktopOffline()\n\t{\n\t\tthis.#desktopHandler.handleDesktopOffline();\n\t}\n\t// endregion 'desktop'\n\n\t// region 'settings'\n\thandleSettingsUpdate(params)\n\t{\n\t\tthis.#settingsHandler.handleSettingsUpdate(params);\n\t}\n\t// endregion 'settings'\n}\n","import { Type, Loc } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\nimport { UserManager } from 'im.v2.lib.user';\nimport { MessageStatus, ChatType } from 'im.v2.const';\n\nimport type { JsonObject } from 'main.core';\nimport type { MessageAddParams, AddReactionParams, MessageDeleteCompleteParams, ReadMessageParams, UnreadMessageParams } from './types/message';\nimport type { UserInviteParams } from './types/user';\n\nexport class RecentPullHandler\n{\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'im';\n\t}\n\n\thandleMessage(params)\n\t{\n\t\tthis.handleMessageAdd(params);\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tthis.handleMessageAdd(params);\n\t}\n\n\thandleMessageAdd(params: MessageAddParams)\n\t{\n\t\tif (!this.checkChatType(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentUserId = Core.getUserId();\n\t\tif (currentUserId && params.userInChat[params.chatId] && !params.userInChat[params.chatId].includes(currentUserId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet attach = false;\n\t\tif (Type.isArray(params.message.params['ATTACH']))\n\t\t{\n\t\t\tattach = params.message.params['ATTACH'];\n\t\t}\n\n\t\tlet file = false;\n\t\tif (Type.isArray(params.message.params['FILE_ID']))\n\t\t{\n\t\t\tfile = params.files[params.message.params['FILE_ID'][0]];\n\t\t}\n\n\t\tLogger.warn('RecentPullHandler: handleMessageAdd', params);\n\n\t\tconst newRecentItem = {\n\t\t\tid: params.dialogId,\n\t\t\tmessage: {\n\t\t\t\tid: params.message.id,\n\t\t\t\ttext: params.message.text,\n\t\t\t\tdate: params.message.date,\n\t\t\t\tsenderId: params.message.senderId,\n\t\t\t\tsending: false,\n\t\t\t\tstatus: MessageStatus.received,\n\t\t\t\tattach,\n\t\t\t\tfile,\n\t\t\t},\n\t\t\tdateUpdate: new Date(),\n\t\t};\n\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (recentItem)\n\t\t{\n\t\t\tnewRecentItem.options = {\n\t\t\t\tbirthdayPlaceholder: false\n\t\t\t};\n\n\t\t\tthis.store.dispatch('recent/like', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tliked: false,\n\t\t\t});\n\t\t}\n\n\t\tconst { senderId } = params.message;\n\t\tconst usersModel = this.store.state.users;\n\t\t// if (usersModel?.botList[senderId] && usersModel.botList[senderId].type === 'human')\n\t\t// {\n\t\t// \tconst { text } = params.message;\n\t\t// \tsetTimeout(() => {\n\t\t// \t\tthis.setRecentItem(newRecentItem);\n\t\t// \t}, this.getWaitTimeForHumanBot(text));\n\t\t//\n\t\t// \treturn;\n\t\t// }\n\n\t\tthis.setRecentItem(newRecentItem);\n\t}\n\n\thandleMessageUpdate(params, extra, command)\n\t{\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem || recentItem.message.id !== params.id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('RecentPullHandler: handleMessageUpdate', params, command);\n\n\t\tlet text = params.text;\n\t\tif (command === 'messageDelete')\n\t\t{\n\t\t\ttext = Loc.getMessage('IM_PULL_RECENT_MESSAGE_DELETED');\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: params.id,\n\t\t\t\t\ttext,\n\t\t\t\t\tdate: recentItem.message.date,\n\t\t\t\t\tstatus: recentItem.message.status,\n\t\t\t\t\tsenderId: params.senderId,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\twithFile: false,\n\t\t\t\t\t\twithAttach: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdateUpdate: new Date(),\n\t\t\t},\n\t\t});\n\t}\n\n\thandleMessageDelete(params, extra, command)\n\t{\n\t\tthis.handleMessageUpdate(params, extra, command);\n\t}\n\n\thandleMessageDeleteComplete(params: MessageDeleteCompleteParams)\n\t{\n\t\tconst lastMessageWasDeleted = Boolean(params.newLastMessage);\n\t\tif (lastMessageWasDeleted)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: params.newLastMessage,\n\t\t\t\t\tdateUpdate: new Date(),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\t/* region Counters handling */\n\thandleReadMessage(params: ReadMessageParams)\n\t{\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\thandleReadMessageChat(params: ReadMessageParams)\n\t{\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\thandleUnreadMessage(params: UnreadMessageParams)\n\t{\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\thandleUnreadMessageChat(params: UnreadMessageParams)\n\t{\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\thandleChatMuteNotify(params)\n\t{\n\t\tthis.updateUnloadedChatCounter(params);\n\t}\n\n\thandleChatUnread(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleChatUnread', params);\n\t\tthis.updateUnloadedChatCounter({\n\t\t\tdialogId: params.dialogId,\n\t\t\tchatId: params.chatId,\n\t\t\tcounter: params.counter,\n\t\t\tmuted: params.muted,\n\t\t\tunread: params.active,\n\t\t});\n\n\t\tthis.store.dispatch('recent/unread', {\n\t\t\tid: params.dialogId,\n\t\t\taction: params.active,\n\t\t\tdateUpdate: new Date(),\n\t\t});\n\t}\n\t/* endregion Counters handling */\n\n\thandleReadMessageOpponent(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleReadMessageOpponent', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tconst lastReadMessage = Number.parseInt(params.lastId, 10);\n\t\tif (!recentItem || recentItem.message.id !== lastReadMessage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: { ...recentItem.message, status: MessageStatus.delivered },\n\t\t\t},\n\t\t});\n\t}\n\n\thandleReadMessageChatOpponent(params)\n\t{\n\t\tthis.handleReadMessageOpponent(params);\n\t}\n\n\thandleUnreadMessageOpponent(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleUnreadMessageOpponent', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: { ...recentItem.message, status: MessageStatus.received },\n\t\t\t},\n\t\t});\n\t}\n\n\thandleUnreadMessageChatOpponent(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleUnreadMessageChatOpponent', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmessage: { ...recentItem.message, status: params.chatMessageStatus }\n\t\t\t},\n\t\t});\n\t}\n\n\thandleAddReaction(params: AddReactionParams)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleAddReaction', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatIsOpened = this.store.getters['application/isChatOpen'](params.dialogId);\n\t\tif (chatIsOpened)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isOwnLike = Core.getUserId() === params.userId;\n\t\tconst isOwnLastMessage = Core.getUserId() === recentItem.message.senderId;\n\t\tif (isOwnLike || !isOwnLastMessage)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/like', {\n\t\t\tid: params.dialogId,\n\t\t\tmessageId: params.actualReactions.reaction.messageId,\n\t\t\tliked: true,\n\t\t});\n\t}\n\n\thandleDeleteReaction(params)\n\t{\n\t\t// Logger.warn('RecentPullHandler: handleDeleteReaction', params);\n\t\t// const recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\t// if (!recentItem)\n\t\t// {\n\t\t// \treturn false;\n\t\t// }\n\t}\n\n\thandleChatPin(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleChatPin', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/pin', {\n\t\t\tid: params.dialogId,\n\t\t\taction: params.active,\n\t\t\tdateUpdate: new Date(),\n\t\t});\n\t}\n\n\thandleChatHide(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleChatHide', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: params.dialogId,\n\t\t});\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleChatUserLeave', params);\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.userId !== Core.getUserId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: params.dialogId,\n\t\t});\n\t}\n\n\thandleUserInvite(params: UserInviteParams)\n\t{\n\t\tLogger.warn('RecentPullHandler: handleUserInvite', params);\n\t\tthis.store.dispatch('recent/setRecent', {\n\t\t\tid: params.user.id,\n\t\t\tinvited: params.invited ?? false,\n\t\t\tmessage: {\n\t\t\t\tdate: params.date,\n\t\t\t},\n\t\t});\n\t\tthis.userManager.setUsersToModel([params.user]);\n\t}\n\n\tgetWaitTimeForHumanBot(text): number\n\t{\n\t\tconst INITIAL_WAIT = 1000;\n\t\tconst WAIT_PER_WORD = 300;\n\t\tconst WAIT_LIMIT = 5000;\n\n\t\tlet waitTime = (text.split(' ').length * WAIT_PER_WORD) + INITIAL_WAIT;\n\t\tif (waitTime > WAIT_LIMIT)\n\t\t{\n\t\t\twaitTime = WAIT_LIMIT;\n\t\t}\n\n\t\treturn waitTime;\n\t}\n\n\tupdateUnloadedChatCounter(params: {\n\t\tdialogId: string,\n\t\tchatId: number,\n\t\tcounter: number,\n\t\tmuted: boolean,\n\t\tunread: boolean,\n\t\tlines: boolean\n\t})\n\t{\n\t\tconst { dialogId, chatId, counter, muted, unread, lines = false } = params;\n\t\tif (lines)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tif (recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tLogger.warn('RecentPullHandler: updateUnloadedChatCounter:', { dialogId, chatId, counter, muted, unread });\n\n\t\tlet newCounter = 0;\n\t\tif (muted)\n\t\t{\n\t\t\tnewCounter = 0;\n\t\t}\n\t\telse if (unread && counter === 0)\n\t\t{\n\t\t\tnewCounter = 1;\n\t\t}\n\t\telse if (unread && counter > 0)\n\t\t{\n\t\t\tnewCounter = counter;\n\t\t}\n\t\telse if (!unread)\n\t\t{\n\t\t\tnewCounter = counter;\n\t\t}\n\n\t\tthis.store.dispatch('counters/setUnloadedChatCounters', { [chatId]: newCounter });\n\t}\n\n\tsetRecentItem(newRecentItem: JsonObject)\n\t{\n\t\tthis.store.dispatch('recent/setRecent', newRecentItem);\n\t}\n\n\tcheckChatType(params: MessageAddParams): boolean\n\t{\n\t\tconst CHAT_TYPES_TO_SKIP = new Set([ChatType.copilot]);\n\n\t\tif (params.lines)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newMessageChatType = params.chat[params.chatId]?.type;\n\t\t// noinspection RedundantIfStatementJS\n\t\tif (CHAT_TYPES_TO_SKIP.has(newMessageChatType))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","import { ChatType } from 'im.v2.const';\nimport { RecentPullHandler } from './recent';\n\nimport type { JsonObject } from 'main.core';\nimport type { MessageAddParams } from './types/message';\n\n\nexport class CopilotRecentHandler extends RecentPullHandler\n{\n\tsetRecentItem(newRecentItem: JsonObject)\n\t{\n\t\tthis.store.dispatch('recent/setCopilot', newRecentItem);\n\t}\n\n\tcheckChatType(params: MessageAddParams): boolean\n\t{\n\t\tconst newMessageChatType = params.chat[params.chatId]?.type;\n\n\t\treturn newMessageChatType === ChatType.copilot;\n\t}\n}\n","import {Runtime} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {UserManager} from 'im.v2.lib.user';\n\nimport type {NotifyAddParams} from './types/notification';\n\nexport class NotificationPullHandler\n{\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.userManager = new UserManager();\n\n\t\tthis.updateCounterDebounced = Runtime.debounce(this.updateCounter, 1500, this);\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType(): string\n\t{\n\t\treturn 'server';\n\t}\n\n\thandleNotifyAdd(params: NotifyAddParams)\n\t{\n\t\tif (params.onlyFlash === true)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\t\tthis.store.dispatch('notifications/set', params);\n\n\t\tthis.updateCounterDebounced(params.counter);\n\t}\n\n\thandleNotifyConfirm(params)\n\t{\n\t\tthis.store.dispatch('notifications/delete', {\n\t\t\tid: params.id,\n\t\t});\n\n\t\tthis.updateCounterDebounced(params.counter);\n\t}\n\n\thandleNotifyRead(params)\n\t{\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', {ids: [id], read: true});\n\t\t});\n\n\t\tthis.updateCounterDebounced(params.counter);\n\t}\n\n\thandleNotifyUnread(params)\n\t{\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', {ids: [id], read: false});\n\t\t});\n\n\t\tthis.updateCounterDebounced(params.counter);\n\t}\n\n\thandleNotifyDelete(params)\n\t{\n\t\tconst idsToDelete = Object.keys(params.id).map(id => Number.parseInt(id, 10));\n\n\t\tidsToDelete.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/delete', {id});\n\t\t});\n\n\t\tthis.updateCounterDebounced(params.counter);\n\t}\n\n\tupdateCounter(counter: number)\n\t{\n\t\tthis.store.dispatch('notifications/setCounter', counter);\n\t}\n}\n","import {Type} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {UserManager} from 'im.v2.lib.user';\nimport {SidebarDetailBlock} from 'im.v2.const';\n\nexport class SidebarPullHandler\n{\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType(): string\n\t{\n\t\treturn 'server';\n\t}\n\n\t//region members\n\thandleChatUserAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(Object.values(params.users));\n\n\t\tthis.store.dispatch('sidebar/members/set', {\n\t\t\tchatId: params.chatId,\n\t\t\tusers: params.newUsers\n\t\t});\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/members/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tuserId: params.userId\n\t\t});\n\t}\n\t//endregion\n\n\t//region task\n\thandleTaskAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.link.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\n\t\tthis.store.dispatch('sidebar/tasks/set', {\n\t\t\tchatId: params.link.chatId,\n\t\t\ttasks: [params.link]\n\t\t});\n\t}\n\n\thandleTaskUpdate(params, extra)\n\t{\n\t\tthis.handleTaskAdd(params, extra);\n\t}\n\n\thandleTaskDelete(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/tasks/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tid: params.linkId\n\t\t});\n\t}\n\t//endregion\n\n\t//region meetings\n\thandleCalendarAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.link.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\n\t\tthis.store.dispatch('sidebar/meetings/set', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tmeetings: [params.link]\n\t\t});\n\t}\n\n\thandleCalendarUpdate(params, extra)\n\t{\n\t\tthis.handleCalendarAdd(params, extra);\n\t}\n\n\thandleCalendarDelete(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/meetings/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tid: params.linkId\n\t\t});\n\t}\n\t//endregion\n\n\t//region links\n\thandleUrlAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.link.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\n\t\tthis.store.dispatch('sidebar/links/set', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tlinks: [params.link]\n\t\t});\n\n\t\tconst counter = this.store.getters['sidebar/links/getCounter'](params.link.chatId);\n\t\tthis.store.dispatch('sidebar/links/setCounter', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tcounter: counter + 1\n\t\t});\n\t}\n\n\thandleUrlDelete(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/links/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tid: params.linkId\n\t\t});\n\t}\n\t//endregion\n\n\t//region favorite\n\thandleMessageFavoriteAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.link.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\t\tthis.store.dispatch('files/set', params.files);\n\t\tthis.store.dispatch('messages/store', [params.link.message]);\n\n\t\tthis.store.dispatch('sidebar/favorites/set', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tfavorites: [params.link]\n\t\t});\n\n\t\tconst counter = this.store.getters['sidebar/favorites/getCounter'](params.link.chatId);\n\t\tthis.store.dispatch('sidebar/favorites/setCounter', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tcounter: counter + 1\n\t\t});\n\t}\n\n\thandleMessageFavoriteDelete(params)\n\t{\n\t\tif (!this.isSidebarInited(params.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/favorites/delete', {\n\t\t\tchatId: params.chatId,\n\t\t\tid: params.linkId\n\t\t});\n\t}\n\t//endregion\n\n\t//region files\n\thandleFileAdd(params)\n\t{\n\t\tif (!this.isSidebarInited(params.link.chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(params.users);\n\t\tthis.store.dispatch('files/set', params.files);\n\n\t\tif (!params.link.subType)\n\t\t{\n\t\t\tparams.link.subType = SidebarDetailBlock.fileUnsorted;\n\t\t}\n\n\t\tthis.store.dispatch('sidebar/files/set', {\n\t\t\tchatId: params.link.chatId,\n\t\t\tfiles: [params.link]\n\t\t});\n\t}\n\n\thandleFileDelete(params)\n\t{\n\t\tconst chatId = Type.isNumber(params.chatId) ? params.chatId : Number.parseInt(params.chatId, 10);\n\t\tif (!this.isSidebarInited(chatId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst sidebarFileId = params.linkId ? params.linkId : params.fileId;\n\t\tthis.store.dispatch('sidebar/files/delete', {\n\t\t\tchatId: chatId,\n\t\t\tid: sidebarFileId\n\t\t});\n\t}\n\t//endregion\n\n\t//region files unsorted\n\thandleMessage(params)\n\t{\n\t\t// handle new files while migration is not finished.\n\t\tif (!this.isSidebarInited(params.chatId) || this.isFilesMigrated())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.userManager.setUsersToModel(Object.values(params.users));\n\t\tthis.store.dispatch('files/set', Object.values(params.files));\n\n\t\tObject.values(params.files).forEach(file => {\n\t\t\tfile.subType = SidebarDetailBlock.fileUnsorted;\n\n\t\t\tthis.store.dispatch('sidebar/files/set', {\n\t\t\t\tchatId: file.chatId,\n\t\t\t\tfiles: [file]\n\t\t\t});\n\t\t});\n\t}\n\t//endregion\n\n\tisSidebarInited(chatId: number): boolean\n\t{\n\t\treturn this.store.getters['sidebar/isInited'](chatId);\n\t}\n\n\tisFilesMigrated(): boolean\n\t{\n\t\treturn this.store.state.sidebar.isFilesMigrated;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { SoundType, UserStatus, LocalStorageKey, Settings, RawSettings } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { NotifierManager } from 'im.v2.lib.notifier';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { CallManager } from 'im.v2.lib.call';\nimport { LocalStorageManager } from 'im.v2.lib.local-storage';\nimport { SoundNotificationManager } from 'im.v2.lib.sound-notification';\n\nimport type { MessageAddParams } from './types/message';\nimport type { NotifyAddParams } from './types/notification';\n\nexport class NotifierPullHandler\n{\n\tlastNotificationId: number = 0;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\n\t\tthis.#setCurrentUserStatus();\n\t\tthis.#restoreLastNotificationId();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'im';\n\t}\n\n\thandleMessage(params, extraData)\n\t{\n\t\tthis.handleMessageAdd(params, extraData);\n\t}\n\n\thandleMessageChat(params, extraData)\n\t{\n\t\tthis.handleMessageAdd(params, extraData);\n\t}\n\n\thandleMessageAdd(params: MessageAddParams, extraData: PullExtraData)\n\t{\n\t\tif (!this.#shouldShowNotification(params, extraData))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isChatOpened(params.dialogId))\n\t\t{\n\t\t\tthis.#playOpenedChatMessageSound(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#playMessageSound(params);\n\t\tthis.#flashDesktopIcon();\n\n\t\tconst message = this.store.getters['messages/getById'](params.message.id);\n\t\tconst dialog = this.store.getters['chats/get'](params.dialogId, true);\n\t\tconst user = this.store.getters['users/get'](message.authorId);\n\n\t\tNotifierManager.getInstance().showMessage({\n\t\t\tmessage,\n\t\t\tdialog,\n\t\t\tuser,\n\t\t\tlines: Boolean(params.lines),\n\t\t});\n\n\t\tthis.#updateLastNotificationId(params.message.id);\n\t}\n\n\thandleNotifyAdd(params: NotifyAddParams, extraData: PullExtraData)\n\t{\n\t\tif (extraData.server_time_ago > 10)\n\t\t{\n\t\t\tLogger.warn('NotifierPullHandler: notification arrived to the user 30 seconds after it was actually sent, ignore notification');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.id <= this.lastNotificationId)\n\t\t{\n\t\t\tLogger.warn('NotifierPullHandler: new notification id is smaller than lastNotificationId');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tparams.onlyFlash === true\n\t\t\t|| this.#isUserDnd()\n\t\t\t|| this.#desktopWillShowNotification()\n\t\t\t|| CallManager.getInstance().hasCurrentCall()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (document.hasFocus())\n\t\t{\n\t\t\tconst areNotificationsOpen = this.store.getters['application/areNotificationsOpen'];\n\t\t\tif (areNotificationsOpen)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst notification = this.store.getters['notifications/getById'](params.id);\n\t\tconst user = this.store.getters['users/get'](params.userId);\n\n\t\tif (params.silent !== 'Y')\n\t\t{\n\t\t\tSoundNotificationManager.getInstance().playOnce(SoundType.reminder);\n\t\t}\n\n\t\tthis.#flashDesktopIcon();\n\n\t\tNotifierManager.getInstance().showNotification(notification, user);\n\n\t\tthis.#updateLastNotificationId(params.id);\n\t}\n\n\t#shouldShowNotification(params: MessageAddParams, extraData: PullExtraData): boolean\n\t{\n\t\tif (extraData.server_time_ago > 10)\n\t\t{\n\t\t\tLogger.warn('NotifierPullHandler: message arrived to the user 30 seconds after it was actually sent, ignore message');\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.message.id <= this.lastNotificationId)\n\t\t{\n\t\t\tLogger.warn('NotifierPullHandler: new message id is smaller than lastNotificationId');\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Core.getUserId() === params.message.senderId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.lines && !this.#shouldShowLinesNotification(params))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst messageWithoutNotification = !params.notify || params.message?.params?.NOTIFY === 'N';\n\t\tif (messageWithoutNotification || !this.#shouldShowToUser(params) || this.#desktopWillShowNotification())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst callIsActive = CallManager.getInstance().hasCurrentCall();\n\t\tif (callIsActive && CallManager.getInstance().getCurrentCallDialogId() !== params.dialogId.toString())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst screenSharingIsActive = CallManager.getInstance().hasCurrentScreenSharing();\n\t\tif (screenSharingIsActive)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#shouldShowLinesNotification(params: MessageAddParams): boolean\n\t{\n\t\tif (this.#isLinesChatOpened(params.dialogId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst authorId = params.message.senderId;\n\t\tif (authorId > 0 && params.users[authorId].extranet === false)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst counter = this.store.getters['counters/getSpecificLinesCounter'](params.chatId);\n\n\t\treturn counter === 0;\n\t}\n\n\t#isChatOpened(dialogId: string): boolean\n\t{\n\t\tconst isChatOpen = this.store.getters['application/isChatOpen'](dialogId);\n\n\t\treturn Boolean(document.hasFocus() && isChatOpen);\n\t}\n\n\t#isLinesChatOpened(dialogId: string): boolean\n\t{\n\t\tconst isLinesChatOpen = this.store.getters['application/isLinesChatOpen'](dialogId);\n\n\t\treturn Boolean(document.hasFocus() && isLinesChatOpen);\n\t}\n\n\t#isImportantMessage(params: MessageAddParams): boolean\n\t{\n\t\tconst { message } = params;\n\n\t\treturn message.isImportant || message.importantFor.includes(Core.getUserId());\n\t}\n\n\t#shouldShowToUser(params: MessageAddParams): boolean\n\t{\n\t\tif (this.#isImportantMessage(params))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst dialog = this.store.getters['chats/get'](params.dialogId, true);\n\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\n\t\treturn !this.#isUserDnd() && !isMuted;\n\t}\n\n\t#isUserDnd(): boolean\n\t{\n\t\tconst status = this.store.getters['application/settings/get'](Settings.user.status);\n\n\t\treturn status === UserStatus.dnd;\n\t}\n\n\t#desktopWillShowNotification(): boolean\n\t{\n\t\tconst isDesktopChatWindow = DesktopManager.isChatWindow();\n\n\t\treturn !isDesktopChatWindow && DesktopManager.getInstance().isDesktopActive();\n\t}\n\n\t#flashDesktopIcon(): void\n\t{\n\t\tif (!DesktopManager.isDesktop())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDesktopApi.flashIcon();\n\t}\n\n\t#playOpenedChatMessageSound(params: MessageAddParams)\n\t{\n\t\tif (this.#isImportantMessage(params))\n\t\t{\n\t\t\tSoundNotificationManager.getInstance().forcePlayOnce(SoundType.newMessage2);\n\n\t\t\treturn;\n\t\t}\n\n\t\tSoundNotificationManager.getInstance().playOnce(SoundType.newMessage2);\n\t}\n\n\t#playMessageSound(params: MessageAddParams)\n\t{\n\t\tif (this.#isImportantMessage(params))\n\t\t{\n\t\t\tSoundNotificationManager.getInstance().forcePlayOnce(SoundType.newMessage1);\n\n\t\t\treturn;\n\t\t}\n\n\t\tSoundNotificationManager.getInstance().playOnce(SoundType.newMessage1);\n\t}\n\n\t#restoreLastNotificationId()\n\t{\n\t\tconst rawLastNotificationId = LocalStorageManager.getInstance().get(LocalStorageKey.lastNotificationId, 0);\n\n\t\tthis.lastNotificationId = Number.parseInt(rawLastNotificationId, 10);\n\t}\n\n\t#updateLastNotificationId(notificationId: number)\n\t{\n\t\tconst WRITE_TO_STORAGE_TIMEOUT = 2000;\n\n\t\tthis.lastNotificationId = notificationId;\n\t\tclearTimeout(this.writeToStorageTimeout);\n\t\tthis.writeToStorageTimeout = setTimeout(() => {\n\t\t\tLocalStorageManager.getInstance().set(LocalStorageKey.lastNotificationId, notificationId);\n\t\t}, WRITE_TO_STORAGE_TIMEOUT);\n\t}\n\n\t#setCurrentUserStatus()\n\t{\n\t\tconst applicationData: { settings: RawSettings } = Core.getApplicationData();\n\t\tif (!applicationData.settings?.status)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tCore.getStore().dispatch('application/settings/set', {\n\t\t\t[Settings.user.status]: applicationData.settings.status,\n\t\t});\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport type { MessageAddParams, ReadMessageParams, UnreadMessageParams } from './types/message';\nimport type { ChatHideParams } from './types/chat';\n\nexport class LinesPullHandler\n{\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'im';\n\t}\n\n\thandleMessageChat(params: MessageAddParams)\n\t{\n\t\tthis.updateUnloadedLinesCounter(params);\n\t}\n\n\thandleReadMessageChat(params: ReadMessageParams)\n\t{\n\t\tthis.updateUnloadedLinesCounter(params);\n\t}\n\n\thandleUnreadMessageChat(params: UnreadMessageParams)\n\t{\n\t\tthis.updateUnloadedLinesCounter(params);\n\t}\n\n\thandleChatHide(params: ChatHideParams)\n\t{\n\t\tthis.updateUnloadedLinesCounter({\n\t\t\tdialogId: params.dialogId,\n\t\t\tchatId: params.chatId,\n\t\t\tlines: params.lines,\n\t\t\tcounter: 0,\n\t\t});\n\t}\n\n\tupdateUnloadedLinesCounter(params: {\n\t\tdialogId: string,\n\t\tchatId: number,\n\t\tcounter: number,\n\t\tlines: ?Object<string, any>,\n\t})\n\t{\n\t\tconst { dialogId, chatId, counter, lines } = params;\n\t\tif (!lines || Type.isUndefined(counter))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tLogger.warn('LinesPullHandler: updateUnloadedLinesCounter:', { dialogId, chatId, counter });\n\t\tthis.store.dispatch('counters/setUnloadedLinesCounters', { [chatId]: counter });\n\t}\n}\n","import { Type } from 'main.core';\nimport { Core } from 'im.v2.application.core';\n\nexport class OnlinePullHandler\n{\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'online';\n\t}\n\n\tgetSubscriptionType(): string\n\t{\n\t\treturn 'online';\n\t}\n\n\thandleUserStatus(params: {\n\t\tusers: Object,\n\t})\n\t{\n\t\tconst currentUserId = Core.getUserId();\n\t\tif (Type.isPlainObject(params.users[currentUserId]))\n\t\t{\n\t\t\tconst { status } = params.users[currentUserId];\n\t\t\tthis.store.dispatch('application/settings/set', { status });\n\t\t}\n\n\t\tObject.values(params.users).forEach((userInfo) => {\n\t\t\tthis.store.dispatch('users/update', {\n\t\t\t\tid: userInfo.id,\n\t\t\t\tfields: {\n\t\t\t\t\tlastActivityDate: userInfo.last_activity_date,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n}\n"],"names":["MessagePullHandler","constructor","Core","getStore","handleMessageAdd","params","Logger","warn","messageWithTemplateId","getters","messageId","message","templateId","messageWithRealId","id","dispatch","fields","error","chatId","WritingManager","getInstance","stopWriting","dialogId","userId","senderId","handleMessageUpdate","text","handleMessageDelete","isDeleted","files","attach","replyId","handleMessageDeleteComplete","dialogUpdateFields","counter","lastMessageWasDeleted","Boolean","newLastMessage","lastMessageId","lastMessageViews","handleAddReaction","actualReactions","reaction","actualReactionsState","usersShort","getUserId","ownReactions","userManager","UserManager","addUsersToModel","handleDeleteReaction","handleMessageParamsUpdate","handleReadMessage","extra","uuidManager","UuidManager","hasActionUuid","action_uuid","removeActionUuid","messageIds","viewedMessages","then","lastId","catch","console","handleReadMessageOpponent","handlePinAdd","additionalMessages","pin","authorId","handlePinDelete","chat","chatToAdd","dialogExists","messageWithoutNotification","notify","NOTIFY","role","UserRole","member","users","setUsersToModel","Object","values","forEach","file","templateFileIdExists","fileId","templateFileId","additionalEntities","messages","newMessages","dialog","inited","hasNextPage","chatIsOpened","unreadMessages","length","MessageService","getMessageRequestLimit","messageService","reloadMessageList","newMessage","unread","viewed","dialogFieldsToUpdate","lastReadId","ids","isLastMessage","includes","hasFirstViewer","firstViewer","userName","date","has","Set","add","EventEmitter","emit","EventType","scrollToBottom","threshold","DialogScrollThreshold","nearTheBottom","temporary","ChatPullHandler","handleChatOwner","ownerId","handleChatManagers","managerList","list","handleChatUserAdd","handleChatUserLeave","currentUserIsKicked","Messenger","openChat","chatHasCall","CallManager","getCurrentCallDialogId","leaveCurrentCall","handleStartWriting","startWriting","lastActivityDate","Date","handleChatUnread","markedId","active","handleChatMuteNotify","muted","handleChatRename","name","handleChatAvatar","avatar","handleReadAllChats","userCounter","userCount","UserPullHandler","handleUserInvite","invited","user","DesktopPullHandler","handleDesktopOnline","desktopManager","DesktopManager","setDesktopActive","CounterManager","removeBrowserTitleCounter","handleDesktopOffline","SettingsPullHandler","handleSettingsUpdate","entries","optionName","optionValue","BasePullHandler","getModuleId","handleMessage","handleMessageChat","handleReadMessageChat","handleReadMessageChatOpponent","RecentPullHandler","store","checkChatType","currentUserId","userInChat","Type","isArray","newRecentItem","sending","status","MessageStatus","received","dateUpdate","recentItem","options","birthdayPlaceholder","liked","usersModel","state","setRecentItem","command","Loc","getMessage","withFile","withAttach","updateUnloadedChatCounter","handleUnreadMessage","handleUnreadMessageChat","action","lastReadMessage","Number","parseInt","delivered","handleUnreadMessageOpponent","handleUnreadMessageChatOpponent","chatMessageStatus","isOwnLike","isOwnLastMessage","handleChatPin","handleChatHide","getWaitTimeForHumanBot","INITIAL_WAIT","WAIT_PER_WORD","WAIT_LIMIT","waitTime","split","lines","newCounter","CHAT_TYPES_TO_SKIP","ChatType","copilot","newMessageChatType","type","CopilotRecentHandler","NotificationPullHandler","updateCounterDebounced","Runtime","debounce","updateCounter","getSubscriptionType","handleNotifyAdd","onlyFlash","handleNotifyConfirm","handleNotifyRead","read","handleNotifyUnread","handleNotifyDelete","idsToDelete","keys","map","SidebarPullHandler","isSidebarInited","newUsers","handleTaskAdd","link","tasks","handleTaskUpdate","handleTaskDelete","linkId","handleCalendarAdd","meetings","handleCalendarUpdate","handleCalendarDelete","handleUrlAdd","links","handleUrlDelete","handleMessageFavoriteAdd","favorites","handleMessageFavoriteDelete","handleFileAdd","subType","SidebarDetailBlock","fileUnsorted","handleFileDelete","isNumber","sidebarFileId","isFilesMigrated","sidebar","NotifierPullHandler","lastNotificationId","extraData","NotifierManager","showMessage","server_time_ago","hasCurrentCall","document","hasFocus","areNotificationsOpen","notification","silent","SoundNotificationManager","playOnce","SoundType","reminder","showNotification","callIsActive","toString","screenSharingIsActive","hasCurrentScreenSharing","extranet","isChatOpen","isLinesChatOpen","isImportant","importantFor","isMuted","muteList","Settings","UserStatus","dnd","isDesktopChatWindow","isChatWindow","isDesktopActive","isDesktop","DesktopApi","flashIcon","forcePlayOnce","newMessage2","newMessage1","rawLastNotificationId","LocalStorageManager","get","LocalStorageKey","notificationId","WRITE_TO_STORAGE_TIMEOUT","clearTimeout","writeToStorageTimeout","setTimeout","set","applicationData","getApplicationData","settings","LinesPullHandler","updateUnloadedLinesCounter","isUndefined","OnlinePullHandler","handleUserStatus","isPlainObject","userInfo","last_activity_date"],"mappings":"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"}