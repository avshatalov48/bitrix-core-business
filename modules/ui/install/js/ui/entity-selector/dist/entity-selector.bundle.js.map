{"version":3,"file":"entity-selector.bundle.js","sources":["../src/item/item-node-comparator.js","../src/common/text-node-type.js","../src/common/text-node.js","../src/search/highlighter.js","../src/item/item-badge.js","../src/search/search-field.js","../src/search/match-index.js","../src/search/match-field.js","../src/common/animation.js","../src/common/encode-url.js","../src/item/item-node.js","../src/search/search-field-index.js","../src/search/word-index.js","../src/search/unicode-words.js","../src/search/search-index.js","../src/entity/entity-filter.js","../src/entity/entity.js","../src/common/type-utils.js","../src/item/item.js","../src/dialog/tabs/base-stub.js","../src/dialog/tabs/default-stub.js","../src/dialog/header/base-header.js","../src/dialog/footer/base-footer.js","../src/dialog/tabs/tab.js","../src/tag-selector/tag-item.js","../src/tag-selector/tag-selector.js","../src/dialog/navigation.js","../src/dialog/integration/slider-integration.js","../src/dialog/header/default-header.js","../src/dialog/footer/default-footer.js","../src/dialog/tabs/recent-tab.js","../src/search/match-result.js","../src/search/search-engine.js","../src/search/search-query.js","../src/dialog/tabs/search-loader.js","../src/dialog/footer/search-tab-footer.js","../src/dialog/tabs/search-tab.js","../src/dialog/dialog.js","../src/index.js"],"sourcesContent":["import { Type, Text } from 'main.core';\nimport type ItemNode from './item-node';\n\nexport default class ItemNodeComparator\n{\n\tstatic makeMultipleComparator(order: {[key: string]: 'asc' | 'desc'})\n\t{\n\t\tconst props = Object.keys(order).map(property => `get${Text.capitalize(property)}`);\n\n\t\t/*\n\t\tasc *\n\t\tasc nulls last *\n\t\tasc nulls first\n\n\t\tdesc *\n\t\tdesc nulls first *\n\t\tdesc nulls last\n\t\t*/\n\t\tconst directions: Array<{ ascOrdering: boolean, nullsOrdering: boolean }> = [];\n\n\t\tObject.values(order).forEach((element) => {\n\n\t\t\tconst direction = element.toLowerCase().trim();\n\n\t\t\t// Default sorting: 'asc' || 'asc nulls last'\n\t\t\tlet ascOrdering = true;\n\t\t\tlet nullsOrdering = true;\n\n\t\t\tif (direction === 'desc' || direction === 'desc nulls first')\n\t\t\t{\n\t\t\t\tascOrdering = false;\n\t\t\t}\n\t\t\telse if (direction === 'asc nulls first')\n\t\t\t{\n\t\t\t\tnullsOrdering = false;\n\t\t\t}\n\t\t\telse if (direction === 'desc nulls last')\n\t\t\t{\n\t\t\t\tascOrdering = false;\n\t\t\t\tnullsOrdering = false;\n\t\t\t}\n\n\t\t\tdirections.push({ ascOrdering, nullsOrdering });\n\t\t});\n\n\t\tconst numberOfProperties = props.length;\n\n\t\treturn (nodeA: ItemNode, nodeB : ItemNode) => {\n\t\t\tlet i = 0;\n\t\t\tlet result = 0;\n\n\t\t\twhile (result === 0 && i < numberOfProperties)\n\t\t\t{\n\t\t\t\tconst propertyGetter = props[i];\n\t\t\t\tconst direction = directions[i];\n\n\t\t\t\tresult = this.compareItemNodes(\n\t\t\t\t\tnodeA, nodeB, propertyGetter, direction.ascOrdering, direction.nullsOrdering\n\t\t\t\t);\n\n\t\t\t\ti += 1;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\t}\n\n\tstatic compareItemNodes(\n\t\tnodeA: ItemNode,\n\t\tnodeB: ItemNode,\n\t\tpropertyGetter: string,\n\t\tascOrdering: boolean,\n\t\tnullsOrdering: boolean\n\t)\n\t{\n\t\tconst itemA = nodeA.getItem();\n\t\tconst itemB = nodeB.getItem();\n\n\t\titemA.getCustomData().get();\n\n\t\tconst valueA = itemA[propertyGetter]();\n\t\tconst valueB = itemB[propertyGetter]();\n\n\t\tlet result = 0;\n\n\t\tif (valueA !== null && valueB === null)\n\t\t{\n\t\t\tresult = nullsOrdering ? -1 : 1;\n\t\t}\n\t\telse if (valueA === null && valueB !== null)\n\t\t{\n\t\t\tresult = nullsOrdering ? 1 : -1;\n\t\t}\n\t\telse if (valueA === null && valueB === null)\n\t\t{\n\t\t\tresult = ascOrdering ? -1 : 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isString(valueA))\n\t\t\t{\n\t\t\t\tresult = valueA.localeCompare(valueB);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = valueA - valueB;\n\t\t\t}\n\t\t}\n\n\t\tconst sortOrder = ascOrdering ? 1 : -1;\n\n\t\treturn result * sortOrder;\n\t}\n}","import { Type } from 'main.core';\n\nexport default class TextNodeType\n{\n\tstatic TEXT: string = 'text';\n\tstatic HTML: string = 'html';\n\n\tstatic isValid(type: string)\n\t{\n\t\treturn Type.isString(type) && (type === this.HTML || type === this.TEXT);\n\t}\n}","import { Type } from 'main.core';\nimport TextNodeType from './text-node-type';\nimport type { TextNodeOptions } from './text-node-options';\n\nexport default class TextNode\n{\n\ttext: ?string = null;\n\ttype: ?TextNodeType = null;\n\n\tconstructor(options: TextNodeOptions | string)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tif (Type.isString(options.text))\n\t\t\t{\n\t\t\t\tthis.text = options.text;\n\t\t\t}\n\n\t\t\tif (TextNodeType.isValid(options.type))\n\t\t\t{\n\t\t\t\tthis.type = options.type;\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(options))\n\t\t{\n\t\t\tthis.text = options;\n\t\t}\n\t}\n\n\tgetText(): ?string\n\t{\n\t\treturn this.text;\n\t}\n\n\tgetType(): ?TextNodeType\n\t{\n\t\treturn this.type;\n\t}\n\n\tisNullable(): boolean\n\t{\n\t\treturn this.getText() === null;\n\t}\n\n\trenderTo(element: HTMLElement): void\n\t{\n\t\tconst text = this.getText();\n\t\tif (text === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getType() === null || this.getType() === TextNodeType.TEXT)\n\t\t{\n\t\t\telement.textContent = text;\n\t\t}\n\t\telse if (this.getType() === TextNodeType.HTML)\n\t\t{\n\t\t\telement.innerHTML = text;\n\t\t}\n\t}\n\n\ttoString()\n\t{\n\t\treturn this.getText() ?? '';\n\t}\n\n\ttoJSON()\n\t{\n\t\tif (this.getType() === null)\n\t\t{\n\t\t\treturn this.getText();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.getText(),\n\t\t\t\ttype: this.getType()\n\t\t\t};\n\t\t}\n\t}\n}","import { Type, Text } from 'main.core';\nimport TextNode from '../common/text-node';\nimport type MatchIndex from './match-index';\nimport type { OrderedArray } from 'main.core.collections';\n\nexport default class Highlighter\n{\n\tstatic mark(text: string | TextNode, matches: OrderedArray<MatchIndex>)\n\t{\n\t\tlet encode = true;\n\t\tif (text instanceof TextNode)\n\t\t{\n\t\t\tif (text.getType() === 'html')\n\t\t\t{\n\t\t\t\tencode = false;\n\t\t\t}\n\n\t\t\ttext = text.getText();\n\t\t}\n\n\t\tif (!Type.isStringFilled(text) || !matches || matches.count() === 0)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet result = '';\n\t\tlet offset = 0;\n\t\tlet chunk = '';\n\t\tmatches.forEach((match: MatchIndex) => {\n\n\t\t\tif (offset > match.getStartIndex())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchunk = text.substring(offset, match.getStartIndex());\n\t\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\t\tresult += '<span class=\"ui-selector-highlight-mark\">';\n\n\t\t\tchunk = text.substring(match.getStartIndex(), match.getEndIndex());\n\t\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\t\tresult += '</span>';\n\n\t\t\toffset = match.getEndIndex();\n\n\t\t});\n\n\t\tchunk = text.substring(offset);\n\t\tresult += encode ? Text.encode(chunk) : chunk;\n\n\t\treturn result;\n\t}\n}","import { Type, Dom } from 'main.core';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport TextNode from '../common/text-node';\nimport type { TextNodeOptions } from '../common/text-node-options';\n\nexport default class ItemBadge\n{\n\ttitle: ?TextNode = null;\n\ttextColor: ?string = null;\n\tbgColor: ?string = null;\n\tcontainers: WeakMap<HTMLElement, HTMLElement> = new WeakMap();\n\n\tconstructor(badgeOptions: ItemBadgeOptions)\n\t{\n\t\tconst options: ItemBadgeOptions = Type.isPlainObject(badgeOptions) ? badgeOptions : {};\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor;\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\treturn this.bgColor;\n\t}\n\n\tsetBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\t}\n\n\tgetContainer(target: HTMLElement): HTMLElement\n\t{\n\t\tlet container = this.containers.get(target);\n\t\tif (!container)\n\t\t{\n\t\t\tcontainer = document.createElement('span');\n\t\t\tcontainer.className = 'ui-selector-item-badge';\n\n\t\t\tthis.containers.set(target, container);\n\t\t}\n\n\t\treturn container;\n\t}\n\n\trenderTo(target: HTMLElement): void\n\t{\n\t\tconst container = this.getContainer(target);\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\tthis.getTitleNode().renderTo(container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainer.textContent = '';\n\t\t}\n\n\t\tDom.style(container, 'color', this.getTextColor());\n\t\tDom.style(container, 'background-color', this.getBgColor())\n\t\tDom.append(container, target);\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\ttitle: this.getTitleNode(),\n\t\t\ttextColor: this.getTextColor(),\n\t\t\tbgColor: this.getBgColor()\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport type { SearchFieldOptions } from './search-field-options';\n\nexport default class SearchField\n{\n\tname: string = null;\n\ttype: string = 'string';\n\tsearchable: boolean = true;\n\tsystem: boolean = false;\n\tsort: ?number = null;\n\n\tconstructor(fieldOptions: SearchFieldOptions)\n\t{\n\t\tconst options = Type.isPlainObject(fieldOptions) ? fieldOptions : {};\n\n\t\tif (!Type.isStringFilled(options.name))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.SearchField: \"name\" parameter is required.');\n\t\t}\n\n\t\tthis.name = options.name;\n\t\tthis.setType(options.type);\n\t\tthis.setSystem(options.system);\n\t\tthis.setSort(options.sort);\n\t\tthis.setSearchable(options.searchable);\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.name;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.type;\n\t}\n\n\tsetType(type: string): void\n\t{\n\t\tif (Type.isStringFilled(type))\n\t\t{\n\t\t\tthis.type = type;\n\t\t}\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tsetSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.sort = sort;\n\t\t}\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSystem(flag: boolean)\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.system = flag;\n\t\t}\n\t}\n\n\tisCustom(): boolean\n\t{\n\t\treturn !this.isSystem();\n\t}\n\n\tisSystem(): boolean\n\t{\n\t\treturn this.system;\n\t}\n}","import SearchField from './search-field';\n\nexport default class MatchIndex\n{\n\tfield: SearchField = null;\n\tqueryWord: string = null;\n\tstartIndex: number = null;\n\tendIndex: number = null;\n\n\tconstructor(field: SearchField, queryWord: string, startIndex: number)\n\t{\n\t\tthis.field = field;\n\t\tthis.queryWord = queryWord;\n\t\tthis.startIndex = startIndex;\n\t\tthis.endIndex = startIndex + queryWord.length;\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetQueryWord(): string\n\t{\n\t\treturn this.queryWord;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tgetEndIndex(): number\n\t{\n\t\treturn this.endIndex;\n\t}\n}","import { Type } from 'main.core';\n\nimport type SearchField from './search-field';\nimport MatchIndex from './match-index';\nimport { OrderedArray } from 'main.core.collections';\n\nconst comparator = (a: MatchIndex, b: MatchIndex) => {\n\n\tif (a.getStartIndex() === b.getStartIndex())\n\t{\n\t\treturn a.getEndIndex() > b.getEndIndex() ? -1 : 1;\n\t}\n\telse\n\t{\n\t\treturn a.getStartIndex() > b.getStartIndex() ? 1 : -1;\n\t}\n};\n\nexport default class MatchField\n{\n\tfield: SearchField = null;\n\tmatchIndexes: OrderedArray<MatchIndex> = new OrderedArray(comparator);\n\n\tconstructor(field: SearchField, indexes: MatchIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetMatches(): OrderedArray<MatchIndex>\n\t{\n\t\treturn this.matchIndexes;\n\t}\n\n\taddIndex(matchIndex: MatchIndex): void\n\t{\n\t\tthis.matchIndexes.add(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[]): void\n\t{\n\t\tif (Type.isArray(matchIndexes))\n\t\t{\n\t\t\tmatchIndexes.forEach(matchIndex => {\n\t\t\t\tthis.addIndex(matchIndex);\n\t\t\t});\n\t\t}\n\t}\n}","import { Event, Type } from 'main.core';\n\nexport default class Animation\n{\n\tstatic handleTransitionEnd(element: HTMLElement, propertyName: string | string[]): Promise\n\t{\n\t\tconst properties = Type.isArray(propertyName) ? new Set(propertyName) : new Set([propertyName]);\n\n\t\treturn new Promise(function(resolve) {\n\t\t\tconst handler = (event: TransitionEvent) => {\n\t\t\t\tif (event.target !== element || !properties.has(event.propertyName))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tproperties.delete(event.propertyName);\n\t\t\t\tif (properties.size === 0)\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'transitionend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'transitionend', handler);\n\t\t});\n\t}\n\n\tstatic handleAnimationEnd(element: HTMLElement, animationName: string)\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tconst handler = (event) => {\n\t\t\t\tif (!animationName || (event.animationName === animationName))\n\t\t\t\t{\n\t\t\t\t\tresolve(event);\n\t\t\t\t\tEvent.unbind(element, 'animationend', handler);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(element, 'animationend', handler);\n\t\t});\n\t}\n}","const regexp = /^data:((?:\\w+\\/(?:(?!;).)+)?)((?:;[\\w\\W]*?[^;])*),(.+)$/;\n\nconst isDataUri = (str: string): boolean => {\n\treturn typeof(str) === 'string' ? str.match(regexp) : false;\n};\n\nexport default function encodeUrl(url: string): string\n{\n\tif (isDataUri(url))\n\t{\n\t\treturn url;\n\t}\n\n\treturn encodeURI(url);\n}","import { ajax as Ajax, Cache, Dom, Runtime, Tag, Type, Browser, Event } from 'main.core';\nimport { OrderedArray } from 'main.core.collections';\nimport { Loader } from 'main.loader';\n\nimport ItemNodeComparator from './item-node-comparator';\nimport Highlighter from '../search/highlighter';\nimport ItemBadge from './item-badge';\nimport MatchField from '../search/match-field';\nimport TextNode from '../common/text-node';\nimport Animation from '../common/animation';\nimport Item from './item';\nimport encodeUrl from '../common/encode-url';\n\nimport type Tab from '../dialog/tabs/tab';\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { CaptionOptions } from './caption-options';\nimport type { BadgesOptions } from './badges-options';\nimport type { AvatarOptions } from './avatar-options';\n\nexport class RenderMode\n{\n\tstatic PARTIAL = 'partial';\n\tstatic OVERRIDE = 'override';\n}\n\nexport default class ItemNode\n{\n\titem: Item = null;\n\ttab: Tab = null;\n\tcache = new Cache.MemoryCache();\n\tparentNode: ItemNode = null;\n\n\tchildren: OrderedArray<ItemNode> = null;\n\tchildItems: WeakMap<Item, ItemNode> = new WeakMap(); // for the fast access\n\n\tloaded: boolean = false;\n\tdynamic: boolean = false;\n\tdynamicPromise: ?Promise = null;\n\tloader: Loader = null;\n\topen: boolean = false;\n\tautoOpen: boolean = false;\n\tfocused: boolean = false;\n\n\trenderMode: RenderMode = RenderMode.PARTIAL;\n\ttitle: ?TextNode = null;\n\tsubtitle: ?TextNode = null;\n\tsupertitle: ?TextNode = null;\n\tcaption: ?TextNode = null;\n\tcaptionOptions: CaptionOptions = {};\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\tlink: ?string = null;\n\tlinkTitle: ?TextNode = null;\n\ttextColor: ?string = null;\n\tbadges: ItemBadgeOptions[] = null;\n\tbadgesOptions: BadgesOptions = {};\n\thidden: boolean = false;\n\n\thighlights: MatchField[] = [];\n\n\trendered: false;\n\trenderWithDebounce = Runtime.debounce(this.render, 50, this);\n\n\tconstructor(item: Item, nodeOptions: ItemNodeOptions)\n\t{\n\t\tconst options: ItemNodeOptions = Type.isPlainObject(nodeOptions) ? nodeOptions : {};\n\n\t\tif (Type.isObject(item))\n\t\t{\n\t\t\tthis.item = item;\n\t\t}\n\n\t\tlet comparator = null;\n\t\tif (Type.isFunction(options.itemOrder))\n\t\t{\n\t\t\tcomparator = options.itemOrder;\n\t\t}\n\t\telse if (Type.isPlainObject(options.itemOrder))\n\t\t{\n\t\t\tcomparator = ItemNodeComparator.makeMultipleComparator(options.itemOrder);\n\t\t}\n\n\t\tthis.children = new OrderedArray(comparator);\n\n\t\tthis.renderMode = options.renderMode === RenderMode.OVERRIDE ? RenderMode.OVERRIDE : RenderMode.PARTIAL;\n\t\tif (this.renderMode === RenderMode.OVERRIDE)\n\t\t{\n\t\t\tthis.setTitle('');\n\t\t\tthis.setSubtitle('');\n\t\t\tthis.setSupertitle('');\n\t\t\tthis.setCaption('');\n\t\t\tthis.setLinkTitle('');\n\n\t\t\tthis.avatar = '';\n\t\t\tthis.avatarOptions = {\n\t\t\t\tbgSize: null,\n\t\t\t\tbgColor: null,\n\t\t\t\tbgImage: null,\n\t\t\t\tborder: null,\n\t\t\t\tborderRadius: null,\n\t\t\t};\n\t\t\tthis.textColor = '';\n\t\t\tthis.link = '';\n\t\t\tthis.badges = [];\n\t\t\tthis.captionOptions = {\n\t\t\t\tfitContent: null,\n\t\t\t\tmaxWidth: null,\n\t\t\t};\n\t\t\tthis.badgesOptions = {\n\t\t\t\tfitContent: null,\n\t\t\t\tmaxWidth: null,\n\t\t\t};\n\t\t}\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setCaptionOptions(options.captionOptions);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\t\tthis.setBadgesOptions(options.badgesOptions);\n\n\t\tthis.setDynamic(options.dynamic);\n\t\tthis.setOpen(options.open);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tisRoot(): boolean\n\t{\n\t\treturn this.getParentNode() === null;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.getTab().getDialog();\n\t}\n\n\tsetTab(tab: Tab): void\n\t{\n\t\tthis.tab = tab;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetParentNode(): ?ItemNode\n\t{\n\t\treturn this.parentNode;\n\t}\n\n\tsetParentNode(parentNode: ItemNode): void\n\t{\n\t\tthis.parentNode = parentNode;\n\t}\n\n\tgetNextSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index + 1);\n\t}\n\n\tgetPreviousSibling(): ?ItemNode\n\t{\n\t\tif (!this.getParentNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst siblings = this.getParentNode().getChildren();\n\t\tconst index = siblings.getIndex(this);\n\n\t\treturn siblings.getByIndex(index - 1);\n\t}\n\n\taddChildren(children: ItemOptions[]): void\n\t{\n\t\tif (!Type.isArray(children))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tchildren.forEach((childOptions: ItemOptions) => {\n\t\t\tdelete childOptions.tabs;\n\t\t\tconst childItem = this.getDialog().addItem(childOptions);\n\n\t\t\tconst childNode = this.addItem(childItem, childOptions.nodeOptions);\n\t\t\tchildNode.addChildren(childOptions.children);\n\t\t});\n\t}\n\n\taddChild(child: ItemNode): ItemNode\n\t{\n\t\tif (!(child instanceof ItemNode))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: an item must be an instance of EntitySelector.ItemNode.');\n\t\t}\n\n\t\tif (this.isChildOf(child) || child === this)\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode: a child item cannot be a parent of current item.');\n\t\t}\n\n\t\tif (this.getChildren().has(child) || this.childItems.has(child.getItem()))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.getChildren().add(child);\n\t\tthis.childItems.set(child.getItem(), child);\n\n\t\tchild.setTab(this.getTab());\n\t\tchild.setParentNode(this);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.renderWithDebounce();\n\t\t}\n\n\t\treturn child;\n\t}\n\n\tgetDepthLevel(): number\n\t{\n\t\treturn this.isRoot() ? 0 : this.getParentNode().getDepthLevel() + 1;\n\t}\n\n\taddItem(item: Item, nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tlet itemNode = this.childItems.get(item);\n\t\tif (!itemNode)\n\t\t{\n\t\t\titemNode = item.createNode(nodeOptions);\n\t\t\tthis.addChild(itemNode);\n\t\t}\n\n\t\treturn itemNode;\n\t}\n\n\taddItems(items: Item[] | Array<[Item, ItemNodeOptions]>): void\n\t{\n\t\tif (Type.isArray(items))\n\t\t{\n\t\t\tthis.disableRender();\n\n\t\t\titems.forEach((item: Item | [Item, ItemNodeOptions]) => {\n\t\t\t\tif (Type.isArray(item) && item.length === 2)\n\t\t\t\t{\n\t\t\t\t\tthis.addItem(item[0], item[1]);\n\t\t\t\t}\n\t\t\t\telse if (item instanceof Item)\n\t\t\t\t{\n\t\t\t\t\tthis.addItem(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.enableRender();\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderWithDebounce();\n\t\t\t}\n\t\t}\n\t}\n\n\thasItem(item: Item): boolean\n\t{\n\t\treturn this.childItems.has(item);\n\t}\n\n\tremoveChild(child: ItemNode): boolean\n\t{\n\t\tif (!this.getChildren().has(child))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tchild.removeChildren();\n\n\t\tif (child.isFocused())\n\t\t{\n\t\t\tchild.unfocus();\n\t\t}\n\n\t\tchild.setParentNode(null);\n\t\tchild.getItem().removeNode(child);\n\n\t\tthis.getChildren().delete(child);\n\t\tthis.childItems.delete(child.getItem());\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tDom.remove(child.getOuterContainer());\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tremoveChildren(): void\n\t{\n\t\tif (!this.hasChildren())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getChildren().forEach((node: ItemNode) => {\n\n\t\t\tnode.removeChildren();\n\n\t\t\tif (node.isFocused())\n\t\t\t{\n\t\t\t\tnode.unfocus();\n\t\t\t}\n\n\t\t\tnode.setParentNode(null);\n\t\t\tnode.getItem().removeNode(node);\n\t\t});\n\n\t\tthis.getChildren().clear();\n\t\tthis.childItems = new WeakMap();\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tif (Browser.isIE())\n\t\t\t{\n\t\t\t\tDom.clean(this.getChildrenContainer());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChildrenContainer().textContent = '';\n\t\t\t}\n\t\t}\n\t}\n\n\thasChild(child: ItemNode): boolean\n\t{\n\t\treturn this.getChildren().has(child);\n\t}\n\n\tisChildOf(parent: ItemNode): boolean\n\t{\n\t\tlet parentNode = this.getParentNode();\n\t\twhile (parentNode !== null)\n\t\t{\n\t\t\tif (parentNode === parent)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tparentNode = parentNode.getParentNode();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetFirstChild(): ?ItemNode\n\t{\n\t\treturn this.children.getFirst();\n\t}\n\n\tgetLastChild(): ?ItemNode\n\t{\n\t\treturn this.children.getLast();\n\t}\n\n\tgetChildren(): OrderedArray<ItemNode>\n\t{\n\t\treturn this.children;\n\t}\n\n\thasChildren(): boolean\n\t{\n\t\treturn this.children.count() > 0;\n\t}\n\n\tloadChildren(): Promise\n\t{\n\t\tif (!this.isDynamic())\n\t\t{\n\t\t\tthrow new Error('EntitySelector.ItemNode.loadChildren: an item node is not dynamic.');\n\t\t}\n\n\t\tif (this.dynamicPromise)\n\t\t{\n\t\t\treturn this.dynamicPromise;\n\t\t}\n\n\t\tthis.dynamicPromise = Ajax.runAction('ui.entityselector.getChildren', {\n\t\t\tjson: {\n\t\t\t\tparentItem: this.getItem().getAjaxJson(),\n\t\t\t\tdialog: this.getDialog().getAjaxJson()\n\t\t\t},\n\t\t\tgetParameters: {\n\t\t\t\tcontext: this.getDialog().getContext()\n\t\t\t}\n\t\t});\n\n\t\tthis.dynamicPromise.then((response) => {\n\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t{\n\t\t\t\tthis.addChildren(response.data.dialog.items);\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t\tthis.loaded = true;\n\t\t});\n\n\t\tthis.dynamicPromise.catch((error) => {\n\t\t\tthis.loaded = false;\n\t\t\tthis.dynamicPromise = null;\n\t\t\tconsole.error(error);\n\t\t});\n\n\t\treturn this.dynamicPromise;\n\t}\n\n\tsetOpen(open: boolean): void\n\t{\n\t\tif (Type.isBoolean(open))\n\t\t{\n\t\t\tif (open && this.isDynamic() && !this.isLoaded())\n\t\t\t{\n\t\t\t\tthis.setAutoOpen(true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.open = open;\n\t\t\t}\n\t\t}\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.open;\n\t}\n\n\tisAutoOpen(): boolean\n\t{\n\t\treturn this.autoOpen && this.isDynamic() && !this.isLoaded();\n\t}\n\n\tsetAutoOpen(autoOpen: boolean): void\n\t{\n\t\tif (Type.isBoolean(autoOpen))\n\t\t{\n\t\t\tthis.autoOpen = autoOpen;\n\t\t}\n\t}\n\n\tsetDynamic(dynamic: boolean): void\n\t{\n\t\tif (Type.isBoolean(dynamic))\n\t\t{\n\t\t\tthis.dynamic = dynamic;\n\t\t}\n\t}\n\n\tisDynamic(): boolean\n\t{\n\t\treturn this.dynamic;\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loaded;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIndicatorContainer(),\n\t\t\t\tsize: 30\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t\tDom.addClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tthis.getLoader().destroy();\n\t\tthis.loader = null;\n\t\tDom.removeClass(this.getIndicatorContainer(), 'ui-selector-item-indicator-hidden');\n\t}\n\n\texpand(): void\n\t{\n\t\tif (this.isOpen() || (!this.hasChildren() && !this.isDynamic()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isDynamic() && !this.isLoaded())\n\t\t{\n\t\t\tthis.loadChildren().then(() => {\n\t\t\t\tthis.destroyLoader();\n\t\t\t\tthis.expand();\n\t\t\t});\n\n\t\t\tthis.showLoader();\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\tDom.style(this.getChildrenContainer(), 'height', '0px');\n\t\tDom.style(this.getChildrenContainer(), 'opacity', 0);\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().scrollHeight}px`);\n\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', 1);\n\n\t\t\t\tAnimation.handleTransitionEnd(this.getChildrenContainer(), 'height').then(() => {\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', null);\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\t\t\t\tthis.setOpen(true);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tcollapse(): void\n\t{\n\t\tif (!this.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(this.getChildrenContainer(), 'height', `${this.getChildrenContainer().offsetHeight}px`);\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.getChildrenContainer(), 'height', '0px');\n\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', 0);\n\n\t\t\t\tAnimation.handleTransitionEnd(this.getChildrenContainer(), 'height').then(() => {\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'height', null);\n\t\t\t\t\tDom.style(this.getChildrenContainer(), 'opacity', null);\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-open');\n\t\t\t\t\tthis.setOpen(false);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\trender(appendChildren = false): void\n\t{\n\t\tif (this.isRoot())\n\t\t{\n\t\t\tthis.renderRoot(appendChildren);\n\t\t\treturn;\n\t\t}\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.renderTo(this.getTitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t}\n\n\t\tconst supertitleNode = this.getSupertitleNode();\n\t\tif (supertitleNode)\n\t\t{\n\t\t\tsupertitleNode.renderTo(this.getSupertitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getSupertitleContainer().textContent = '';\n\t\t}\n\n\t\tconst subtitleNode = this.getSubtitleNode();\n\t\tif (subtitleNode)\n\t\t{\n\t\t\tsubtitleNode.renderTo(this.getSubtitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getSubtitleContainer().textContent = '';\n\t\t}\n\n\t\tconst captionNode = this.getCaptionNode();\n\t\tif (captionNode)\n\t\t{\n\t\t\tcaptionNode.renderTo(this.getCaptionContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getCaptionContainer().textContent = '';\n\t\t}\n\n\t\tconst captionFitContent = this.getCaptionOption('fitContent');\n\t\tif (Type.isBoolean(captionFitContent))\n\t\t{\n\t\t\tDom.style(this.getCaptionContainer(), 'flex-shrink', captionFitContent ? 0 : null);\n\t\t}\n\n\t\tconst captionMaxWidth = this.getCaptionOption('maxWidth');\n\t\tif (Type.isString(captionMaxWidth) || Type.isNumber(captionMaxWidth))\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getCaptionContainer(),\n\t\t\t\t'max-width',\n\t\t\t\tType.isNumber(captionMaxWidth) ? `${captionMaxWidth}px` : captionMaxWidth\n\t\t\t);\n\t\t}\n\n\t\tif (Type.isStringFilled(this.getTextColor()))\n\t\t{\n\t\t\tthis.getTitleContainer().style.color = this.getTextColor();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().style.removeProperty('color');\n\t\t}\n\n\t\tconst avatar = this.getAvatar();\n\t\tif (Type.isStringFilled(avatar))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundImage = `url('${encodeUrl(avatar)}')`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst bgImage = this.getAvatarOption('bgImage');\n\t\t\tif (Type.isStringFilled(bgImage))\n\t\t\t{\n\t\t\t\tthis.getAvatarContainer().style.backgroundImage = bgImage;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getAvatarContainer().style.removeProperty('background-image');\n\t\t\t}\n\t\t}\n\n\t\tconst bgColor = this.getAvatarOption('bgColor');\n\t\tif (Type.isStringFilled(bgColor))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundColor = bgColor;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('background-color');\n\t\t}\n\n\t\tconst bgSize = this.getAvatarOption('bgSize');\n\t\tif (Type.isStringFilled(bgSize))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.backgroundSize = bgSize;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('background-size');\n\t\t}\n\n\t\tconst border = this.getAvatarOption('border');\n\t\tif (Type.isStringFilled(border))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.border = border;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('border');\n\t\t}\n\n\t\tconst borderRadius = this.getAvatarOption('borderRadius');\n\t\tif (Type.isStringFilled(borderRadius))\n\t\t{\n\t\t\tthis.getAvatarContainer().style.borderRadius = borderRadius;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getAvatarContainer().style.removeProperty('border-radius');\n\t\t}\n\n\t\tDom.clean(this.getBadgeContainer());\n\t\tthis.getBadges().forEach((badge: ItemBadge) => {\n\t\t\tbadge.renderTo(this.getBadgeContainer());\n\t\t});\n\n\t\tconst badgesFitContent = this.getBadgesOption('fitContent');\n\t\tif (Type.isBoolean(badgesFitContent))\n\t\t{\n\t\t\tDom.style(this.getBadgeContainer(), 'flex-shrink', badgesFitContent ? 0 : null);\n\t\t}\n\n\t\tconst badgesMaxWidth = this.getBadgesOption('maxWidth');\n\t\tif (Type.isString(badgesMaxWidth) || Type.isNumber(badgesMaxWidth))\n\t\t{\n\t\t\tDom.style(\n\t\t\t\tthis.getBadgeContainer(),\n\t\t\t\t'max-width',\n\t\t\t\tType.isNumber(badgesMaxWidth) ? `${badgesMaxWidth}px` : badgesMaxWidth\n\t\t\t);\n\t\t}\n\n\t\tconst linkTitleNode = this.getLinkTitleNode();\n\t\tif (linkTitleNode)\n\t\t{\n\t\t\tlinkTitleNode.renderTo(this.getLinkTextContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getLinkTextContainer().textContent = '';\n\t\t}\n\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-has-children');\n\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t{\n\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-max-depth');\n\t\t\t}\n\t\t}\n\t\telse if (this.getOuterContainer().classList.contains('ui-selector-item-box-has-children'))\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getOuterContainer(),\n\t\t\t\t['ui-selector-item-box-has-children', 'ui-selector-item-box-max-depth']\n\t\t\t);\n\t\t}\n\n\t\tif (this.hasChildren())\n\t\t{\n\t\t\tconst hasVisibleChild = this.getChildren().getAll().some((child: ItemNode) => {\n\t\t\t\treturn child.isHidden() !== true;\n\t\t\t});\n\n\t\t\tif (!hasVisibleChild)\n\t\t\t{\n\t\t\t\tthis.#setHidden(true);\n\t\t\t}\n\t\t}\n\n\t\tthis.toggleVisibility();\n\t\tthis.highlight();\n\t\tthis.renderChildren(appendChildren);\n\n\t\tif (this.isAutoOpen())\n\t\t{\n\t\t\tthis.setAutoOpen(false);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.expand();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.rendered = true;\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderRoot(appendChildren = false): void\n\t{\n\t\tthis.renderChildren(appendChildren);\n\t\tthis.rendered = true;\n\n\t\tconst stub = this.getTab().getStub();\n\t\tif (stub && stub.isAutoShow() && (this.getDialog().isLoaded() || !this.getDialog().hasDynamicLoad()))\n\t\t{\n\t\t\tif (this.hasChildren())\n\t\t\t{\n\t\t\t\tstub.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstub.show();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\trenderChildren(appendChildren = false): void\n\t{\n\t\tif (!appendChildren)\n\t\t{\n\t\t\tif (Browser.isIE())\n\t\t\t{\n\t\t\t\tDom.clean(this.getChildrenContainer());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getChildrenContainer().textContent = '';\n\t\t\t}\n\t\t}\n\n\t\tif (this.hasChildren())\n\t\t{\n\t\t\tlet previousSibling: ItemNode = null;\n\t\t\tthis.getChildren().forEach((child: ItemNode) => {\n\t\t\t\tchild.render(appendChildren);\n\t\t\t\tconst container = child.getOuterContainer();\n\n\t\t\t\tif (!appendChildren)\n\t\t\t\t{\n\t\t\t\t\tDom.append(container, this.getChildrenContainer());\n\t\t\t\t}\n\t\t\t\tif (!container.parentNode)\n\t\t\t\t{\n\t\t\t\t\tif (previousSibling !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.insertAfter(container, previousSibling.getOuterContainer());\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.append(container, this.getChildrenContainer());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tpreviousSibling = child;\n\t\t\t});\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\tenableRender(): void\n\t{\n\t\tthis.rendered = true;\n\t}\n\n\tdisableRender(): void\n\t{\n\t\tthis.rendered = false;\n\t}\n\n\tgetRenderMode(): RenderMode\n\t{\n\t\treturn this.renderMode;\n\t}\n\n\tisHidden(): boolean\n\t{\n\t\treturn this.hidden === true || this.getItem().isHidden() === true;\n\t}\n\n\tsetHidden(flag: boolean): void\n\t{\n\t\tif (!Type.isBoolean(flag) || this.isRoot())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#setHidden(flag);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.toggleVisibility();\n\n\t\t\tlet parentNode = this.getParentNode();\n\t\t\tconst isHidden = this.isHidden();\n\t\t\twhile (parentNode.isRoot() === false)\n\t\t\t{\n\t\t\t\tif (isHidden)\n\t\t\t\t{\n\t\t\t\t\tconst hasVisibleChild = parentNode.getChildren().getAll().some((child: ItemNode) => {\n\t\t\t\t\t\treturn child.isHidden() !== true;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!hasVisibleChild)\n\t\t\t\t\t{\n\t\t\t\t\t\tparentNode.#setHidden(true);\n\t\t\t\t\t}\n\n\t\t\t\t\tparentNode.toggleVisibility();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tparentNode.#setHidden(false);\n\t\t\t\t\tparentNode.toggleVisibility();\n\t\t\t\t\tif (parentNode.isHidden())\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tparentNode = parentNode.getParentNode();\n\t\t\t}\n\t\t}\n\t}\n\n\t#setHidden(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag) && !this.isRoot())\n\t\t{\n\t\t\tthis.hidden = flag;\n\t\t}\n\t}\n\n\ttoggleVisibility(): boolean\n\t{\n\t\tif (this.isHidden())\n\t\t{\n\t\t\tDom.addClass(this.getOuterContainer(), '--hidden');\n\t\t}\n\t\telse if (this.getOuterContainer().classList.contains('--hidden'))\n\t\t{\n\t\t\tDom.removeClass(this.getOuterContainer(), '--hidden');\n\t\t}\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null ? titleNode.getText() : null;\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title !== null ? this.title: this.getItem().getTitleNode();\n\t}\n\n\tsetTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(title) || Type.isPlainObject(title))\n\t\t{\n\t\t\tthis.title = new TextNode(title);\n\t\t}\n\t\telse if (title === null)\n\t\t{\n\t\t\tthis.title = null;\n\t\t}\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\tconst subtitleNode = this.getSubtitleNode();\n\n\t\treturn subtitleNode !== null ? subtitleNode.getText() : null;\n\t}\n\n\tgetSubtitleNode(): ?TextNode\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle: this.getItem().getSubtitleNode();\n\t}\n\n\tsetSubtitle(subtitle: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(subtitle) || Type.isPlainObject(subtitle))\n\t\t{\n\t\t\tthis.subtitle = new TextNode(subtitle);\n\t\t}\n\t\telse if (subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = null;\n\t\t}\n\t}\n\n\tgetSupertitle(): ?string\n\t{\n\t\tconst supertitleNode = this.getSupertitleNode();\n\n\t\treturn supertitleNode !== null ? supertitleNode.getText() : null;\n\t}\n\n\tgetSupertitleNode(): ?TextNode\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle: this.getItem().getSupertitleNode();\n\t}\n\n\tsetSupertitle(supertitle: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(supertitle) || Type.isPlainObject(supertitle))\n\t\t{\n\t\t\tthis.supertitle = new TextNode(supertitle);\n\t\t}\n\t\telse if (supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = null;\n\t\t}\n\t}\n\n\tgetCaption(): ?string\n\t{\n\t\tconst caption = this.getCaptionNode();\n\n\t\treturn caption !== null ? caption.getText() : null;\n\t}\n\n\tgetCaptionNode(): ?TextNode\n\t{\n\t\treturn this.caption !== null ? this.caption: this.getItem().getCaptionNode();\n\t}\n\n\tsetCaption(caption: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(caption) || Type.isPlainObject(caption))\n\t\t{\n\t\t\tthis.caption = new TextNode(caption);\n\t\t}\n\t\telse if (caption === null)\n\t\t{\n\t\t\tthis.caption = null;\n\t\t}\n\t}\n\n\tgetCaptionOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.captionOptions[option]))\n\t\t{\n\t\t\treturn this.captionOptions[option];\n\t\t}\n\n\t\treturn this.getItem().getCaptionOption(option);\n\t}\n\n\tsetCaptionOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.captionOptions[option] = value;\n\t\t}\n\t}\n\n\tsetCaptionOptions(options: {[key: string]: any } | null): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setCaptionOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getItem().getAvatar();\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\treturn (\n\t\t\tthis.avatarOptions === null || Type.isUndefined(this.avatarOptions[option])\n\t\t\t\t? this.getItem().getAvatarOption(option)\n\t\t\t\t: this.avatarOptions[option]\n\t\t);\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t}\n\t}\n\n\tsetAvatarOptions(avatarOptions: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(avatarOptions))\n\t\t{\n\t\t\tObject.keys(avatarOptions).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, avatarOptions[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getItem().getTextColor();\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\treturn this.link !== null ? this.getItem().replaceMacros(this.link) : this.getItem().getLink();\n\t}\n\n\tsetLink(link: string): void\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t}\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\tconst linkTitle = this.getLinkTitleNode();\n\n\t\treturn linkTitle !== null ? linkTitle.getText() : null;\n\t}\n\n\tgetLinkTitleNode(): ?TextNode\n\t{\n\t\treturn this.linkTitle !== null ? this.linkTitle: this.getItem().getLinkTitleNode();\n\t}\n\n\tsetLinkTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(title) || Type.isPlainObject(title))\n\t\t{\n\t\t\tthis.linkTitle = new TextNode(title);\n\t\t}\n\t\telse if (title === null)\n\t\t{\n\t\t\tthis.linkTitle = null;\n\t\t}\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\treturn this.badges !== null ? this.badges : this.getItem().getBadges();\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): void\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t}\n\t}\n\n\tgetBadgesOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.badgesOptions[option]))\n\t\t{\n\t\t\treturn this.badgesOptions[option];\n\t\t}\n\n\t\treturn this.getItem().getBadgesOption(option);\n\t}\n\n\tsetBadgesOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.badgesOptions[option] = value;\n\t\t}\n\t}\n\n\tsetBadgesOptions(options: {[key: string]: any } | null): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setBadgesOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\n\t\t\tlet className = '';\n\n\t\t\tif (this.hasChildren() || this.isDynamic())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-has-children';\n\t\t\t\tif (this.getDepthLevel() >= this.getTab().getItemMaxDepth())\n\t\t\t\t{\n\t\t\t\t\tclassName += ' ui-selector-item-box-max-depth';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.getItem().isSelected())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-selected';\n\t\t\t}\n\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tclassName += ' ui-selector-item-box-open';\n\t\t\t}\n\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = `ui-selector-item-box${className}`;\n\t\t\tdiv.appendChild(this.getContainer());\n\t\t\tdiv.appendChild(this.getChildrenContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetChildrenContainer(): HTMLElement\n\t{\n\t\tif (this.isRoot() && this.getTab())\n\t\t{\n\t\t\treturn this.getTab().getItemsContainer();\n\t\t}\n\n\t\treturn this.cache.remember('children-container', () => {\n\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-children';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item';\n\n\t\t\tEvent.bind(div, 'click', this.handleClick.bind(this))\n\t\t\tEvent.bind(div, 'mouseenter', this.handleMouseEnter.bind(this))\n\t\t\tEvent.bind(div, 'mouseleave', this.handleMouseLeave.bind(this))\n\n\t\t\tdiv.appendChild(this.getAvatarContainer());\n\t\t\tdiv.appendChild(this.getTitlesContainer());\n\t\t\tdiv.appendChild(this.getIndicatorContainer());\n\n\t\t\tif (Type.isStringFilled(this.getLink()))\n\t\t\t{\n\t\t\t\tdiv.appendChild(this.getLinkContainer());\n\t\t\t}\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetAvatarContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-avatar';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitlesContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('titles', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-titles';\n\n\t\t\tdiv.appendChild(this.getSupertitleContainer());\n\t\t\tdiv.appendChild(this.getTitleBoxContainer());\n\t\t\tdiv.appendChild(this.getSubtitleContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitleBoxContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title-box', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-title-box';\n\n\t\t\tdiv.appendChild(this.getTitleContainer());\n\t\t\tdiv.appendChild(this.getBadgeContainer());\n\t\t\tdiv.appendChild(this.getCaptionContainer());\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-title';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetSubtitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('subtitle', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-subtitle';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetSupertitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('supertitle', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-supertitle';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetCaptionContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('caption', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-caption';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetIndicatorContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('indicator', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-indicator';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetBadgeContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('badge', () => {\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.className = 'ui-selector-item-badges';\n\n\t\t\treturn div;\n\t\t});\n\t}\n\n\tgetLinkContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('link', () => {\n\t\t\tconst anchor: HTMLAnchorElement = document.createElement('a');\n\t\t\tanchor.className = 'ui-selector-item-link';\n\t\t\tanchor.href = this.getLink();\n\t\t\tanchor.target = '_blank';\n\t\t\tanchor.title = '';\n\n\t\t\tEvent.bind(anchor, 'click', this.handleLinkClick.bind(this));\n\t\t\tanchor.appendChild(this.getLinkTextContainer());\n\n\t\t\treturn anchor;\n\t\t});\n\t}\n\n\tgetLinkTextContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('link-text', () => {\n\t\t\tconst span = document.createElement('span');\n\t\t\tspan.className = 'ui-selector-item-link-text';\n\n\t\t\treturn span;\n\t\t});\n\t}\n\n\tshowLink(): void\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--show');\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tDom.addClass(this.getLinkContainer(), 'ui-selector-item-link--animate');\n\t\t\t\t});\n\t\t\t});\n\n\t\t}\n\t}\n\n\thideLink(): void\n\t{\n\t\tif (Type.isStringFilled(this.getLink()))\n\t\t{\n\t\t\tDom.removeClass(\n\t\t\t\tthis.getLinkContainer(), ['ui-selector-item-link--show', 'ui-selector-item-link--animate']\n\t\t\t);\n\t\t}\n\t}\n\n\tsetHighlights(highlights: MatchField[]): void\n\t{\n\t\tthis.highlights = highlights;\n\t}\n\n\tgetHighlights(): MatchField[]\n\t{\n\t\treturn this.highlights;\n\t}\n\n\thighlight(): void\n\t{\n\t\tthis.getHighlights().forEach(matchField => {\n\t\t\tconst field = matchField.getField();\n\t\t\tconst fieldName = field.getName();\n\n\t\t\tif (field.isCustom())\n\t\t\t{\n\t\t\t\tconst text = this.getItem().getCustomData().get(fieldName);\n\t\t\t\tthis.getSubtitleContainer().innerHTML = Highlighter.mark(text, matchField.getMatches());\n\t\t\t}\n\t\t\telse if (field.getName() === 'title')\n\t\t\t{\n\t\t\t\tthis.getTitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getTitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t{\n\t\t\t\tthis.getSubtitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getSubtitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (field.getName() === 'supertitle')\n\t\t\t{\n\t\t\t\tthis.getSupertitleContainer().innerHTML =\n\t\t\t\t\tHighlighter.mark(this.getItem().getSupertitleNode(), matchField.getMatches())\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\t}\n\n\tselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-selected');\n\t}\n\n\tfocus(): void\n\t{\n\t\tif (this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = true;\n\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onFocus', { node: this });\n\t}\n\n\tunfocus(): void\n\t{\n\t\tif (!this.isFocused())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focused = false;\n\t\tDom.removeClass(this.getOuterContainer(), 'ui-selector-item-box-focused');\n\n\t\tthis.getDialog().emit('ItemNode:onUnfocus', { node: this });\n\t}\n\n\tisFocused(): boolean\n\t{\n\t\treturn this.focused;\n\t}\n\n\tclick(): void\n\t{\n\t\tif (this.hasChildren() || this.isDynamic())\n\t\t{\n\t\t\tif (this.isOpen())\n\t\t\t{\n\t\t\t\tthis.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.expand();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getItem().isSelected())\n\t\t\t{\n\t\t\t\tif (this.getItem().isDeselectable())\n\t\t\t\t{\n\t\t\t\t\tthis.getItem().deselect();\n\t\t\t\t}\n\n\t\t\t\tif (this.getDialog().shouldHideOnDeselect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getItem().select();\n\n\t\t\t\tif (this.getDialog().shouldClearSearchOnSelect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\t}\n\n\t\t\t\tif (this.getDialog().shouldHideOnSelect())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.getDialog().focusSearch();\n\t}\n\n\tscrollIntoView(): void\n\t{\n\t\tconst tabContainer = this.getTab().getContainer();\n\t\tconst nodeContainer = this.getContainer();\n\n\t\tconst tabRect = Dom.getPosition(tabContainer);\n\t\tconst nodeRect = Dom.getPosition(nodeContainer);\n\t\tconst margin = 9; // 'ui-selector-items' padding - 'ui-selector-item' margin = 10 - 1\n\n\t\tif (nodeRect.top < tabRect.top) // scroll up\n\t\t{\n\t\t\ttabContainer.scrollTop -= (tabRect.top - nodeRect.top + margin);\n\t\t}\n\t\telse if (nodeRect.bottom > tabRect.bottom) // scroll down\n\t\t{\n\t\t\ttabContainer.scrollTop += nodeRect.bottom - tabRect.bottom + margin;\n\t\t}\n\t}\n\n\t#makeEllipsisTitle(): void\n\t{\n\t\tif (this.constructor.#isEllipsisActive(this.getTitleContainer()))\n\t\t{\n\t\t\tthis.getContainer().setAttribute(\n\t\t\t\t'title',\n\t\t\t\tthis.constructor.#sanitizeTitle(this.getTitleContainer().textContent)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.attr(this.getContainer(), 'title', null);\n\t\t}\n\n\t\tconst containers = [\n\t\t\tthis.getSupertitleContainer(),\n\t\t\tthis.getSubtitleContainer(),\n\t\t\tthis.getCaptionContainer(),\n\t\t\t...this.getBadges().map((badge: ItemBadge) => badge.getContainer(this.getBadgeContainer()))\n\t\t];\n\n\t\tcontainers.forEach(container => {\n\t\t\tif (this.constructor.#isEllipsisActive(container))\n\t\t\t{\n\t\t\t\tcontainer.setAttribute('title', this.constructor.#sanitizeTitle(container.textContent));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.attr(container, 'title', null);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #isEllipsisActive(element: HTMLElement): boolean\n\t{\n\t\treturn element.offsetWidth < element.scrollWidth;\n\t}\n\n\tstatic #sanitizeTitle(text: string)\n\t{\n\t\treturn text.replace(/[\\t ]+/gm, ' ').replace(/\\n+/gm, '\\n').trim();\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.click();\n\t}\n\n\thandleLinkClick(event: MouseEvent): void\n\t{\n\t\tthis.getDialog().emit('ItemNode:onLinkClick', { node: this, event });\n\t\tevent.stopPropagation();\n\t}\n\n\thandleMouseEnter(): void\n\t{\n\t\tthis.focus();\n\t\tthis.showLink();\n\t\tthis.#makeEllipsisTitle();\n\t}\n\n\thandleMouseLeave(): void\n\t{\n\t\tthis.unfocus();\n\t\tthis.hideLink();\n\t}\n}","import type SearchField from './search-field';\nimport type WordIndex from './word-index';\n\nexport default class SearchFieldIndex\n{\n\tfield: SearchField = null;\n\tindexes: WordIndex[] = [];\n\n\tconstructor(field: SearchField, indexes: WordIndex[] = [])\n\t{\n\t\tthis.field = field;\n\t\tthis.addIndexes(indexes);\n\t}\n\n\tgetField(): SearchField\n\t{\n\t\treturn this.field;\n\t}\n\n\tgetIndexes(): WordIndex[]\n\t{\n\t\treturn this.indexes;\n\t}\n\n\taddIndex(index: WordIndex)\n\t{\n\t\tthis.getIndexes().push(index);\n\t}\n\n\taddIndexes(indexes: WordIndex[])\n\t{\n\t\tindexes.forEach(index => {\n\t\t\tthis.addIndex(index);\n\t\t});\n\t}\n}","import { Type } from 'main.core';\n\nexport default class WordIndex\n{\n\tword: string = '';\n\tstartIndex: number = 0;\n\n\tconstructor(word: string, startIndex: number)\n\t{\n\t\tthis.setWord(word);\n\t\tthis.setStartIndex(startIndex);\n\t}\n\n\tgetWord(): string\n\t{\n\t\treturn this.word;\n\t}\n\n\tsetWord(word: string): this\n\t{\n\t\tif (Type.isStringFilled(word))\n\t\t{\n\t\t\tthis.word = word;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetStartIndex(): number\n\t{\n\t\treturn this.startIndex;\n\t}\n\n\tsetStartIndex(index: number): this\n\t{\n\t\tif (Type.isNumber(index) && index >= 0)\n\t\t{\n\t\t\tthis.startIndex = index;\n\t\t}\n\n\t\treturn this;\n\t}\n}","/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used to compose unicode character classes. */\nconst rsAstralRange = '\\\\ud800-\\\\udfff';\nconst rsComboMarksRange = '\\\\u0300-\\\\u036f';\nconst reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f';\nconst rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff';\nconst rsComboMarksExtendedRange = '\\\\u1ab0-\\\\u1aff';\nconst rsComboMarksSupplementRange = '\\\\u1dc0-\\\\u1dff';\nconst rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange + rsComboMarksExtendedRange + rsComboMarksSupplementRange;\nconst rsDingbatRange = '\\\\u2700-\\\\u27bf';\nconst rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff';\nconst rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7';\nconst rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf';\nconst rsPunctuationRange = '\\\\u2000-\\\\u206f';\nconst rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000';\nconst rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde';\nconst rsVarRange = '\\\\ufe0e\\\\ufe0f';\nconst rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n/** Used to compose unicode capture groups. */\nconst rsApos = '[\\'\\u2019]';\nconst rsBreak = `[${rsBreakRange}]`;\nconst rsCombo = `[${rsComboRange}]`;\nconst rsDigit = '\\\\d';\nconst rsDingbat = `[${rsDingbatRange}]`;\nconst rsLower = `[${rsLowerRange}]`;\nconst rsMisc = `[^${rsAstralRange}${rsBreakRange + rsDigit + rsDingbatRange + rsLowerRange + rsUpperRange}]`;\nconst rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]';\nconst rsModifier = `(?:${rsCombo}|${rsFitz})`;\nconst rsNonAstral = `[^${rsAstralRange}]`;\nconst rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}';\nconst rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]';\nconst rsUpper = `[${rsUpperRange}]`;\nconst rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nconst rsMiscLower = `(?:${rsLower}|${rsMisc})`;\nconst rsMiscUpper = `(?:${rsUpper}|${rsMisc})`;\nconst rsOptContrLower = `(?:${rsApos}(?:d|ll|m|re|s|t|ve))?`;\nconst rsOptContrUpper = `(?:${rsApos}(?:D|LL|M|RE|S|T|VE))?`;\nconst reOptMod = `${rsModifier}?`;\nconst rsOptVar = `[${rsVarRange}]?`;\nconst rsOptJoin = `(?:${rsZWJ}(?:${[rsNonAstral, rsRegional, rsSurrPair].join('|')})${rsOptVar + reOptMod})*`;\nconst rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])';\nconst rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])';\nconst rsSeq = rsOptVar + reOptMod + rsOptJoin;\nconst rsEmoji = `(?:${[rsDingbat, rsRegional, rsSurrPair].join('|')})${rsSeq}`;\n\nconst unicodeWordsRegExp = new RegExp([\n\t`${rsUpper}?${rsLower}+${rsOptContrLower}(?=${[rsBreak, rsUpper, '$'].join('|')})`,\n\t`${rsMiscUpper}+${rsOptContrUpper}(?=${[rsBreak, rsUpper + rsMiscLower, '$'].join('|')})`,\n\t`${rsUpper}?${rsMiscLower}+${rsOptContrLower}`,\n\t`${rsUpper}+${rsOptContrUpper}`,\n\trsOrdUpper,\n\trsOrdLower,\n\t`${rsDigit}+`,\n\trsEmoji\n].join('|'), 'g');\n\nexport default unicodeWordsRegExp;","import { Type } from 'main.core';\n\nimport SearchFieldIndex from './search-field-index';\nimport WordIndex from './word-index';\n\nimport type Item from '../item/item';\nimport type SearchField from './search-field';\n\nimport unicodeWordsRegExp from './unicode-words';\nconst asciiWordRegExp = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\nconst hasUnicodeWordRegExp = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\nconst nonWhitespaceRegExp = /[^\\s]+/g;\nconst specialChars = `!\"#$%&'()*+,-.\\/:;<=>?@[\\\\]^_\\`{|}`;\nconst specialCharsRegExp = new RegExp(`[${specialChars}]`);\n\nexport default class SearchIndex\n{\n\tindexes: SearchFieldIndex[] = [];\n\n\tconstructor()\n\t{\n\t}\n\n\taddIndex(fieldIndex: SearchFieldIndex)\n\t{\n\t\tif (Type.isObject(fieldIndex))\n\t\t{\n\t\t\tthis.getIndexes().push(fieldIndex);\n\t\t}\n\t}\n\n\tgetIndexes()\n\t{\n\t\treturn this.indexes;\n\t}\n\n\tstatic create(item: Item)\n\t{\n\t\tconst index = new SearchIndex();\n\t\tconst entity = item.getEntity();\n\n\t\tif (!item.isSearchable() || !entity.isSearchable() || item.isHidden())\n\t\t{\n\t\t\treturn index;\n\t\t}\n\n\t\tconst searchFields = entity.getSearchFields();\n\t\tsearchFields.forEach(field => {\n\t\t\tif (!field.isSearchable())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (field.isSystem())\n\t\t\t{\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getTitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getTitle(), stripTags));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getSubtitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getSubtitle(), stripTags));\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'supertitle')\n\t\t\t\t{\n\t\t\t\t\tconst textNode = item.getSupertitleNode();\n\t\t\t\t\tconst stripTags = textNode !== null && textNode.getType() === 'html';\n\t\t\t\t\tindex.addIndex(this.createIndex(field, item.getSupertitle(), stripTags));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst customData = item.getCustomData().get(field.getName());\n\t\t\t\tif (!Type.isUndefined(customData))\n\t\t\t\t{\n\t\t\t\t\tindex.addIndex(this.createIndex(field, customData));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn index;\n\t}\n\n\tstatic createIndex(field: SearchField, text: string, stripTags = false): SearchFieldIndex\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (stripTags)\n\t\t{\n\t\t\ttext = text.replace(/<\\/?[^>]+>/g, (match) => ' '.repeat(match.length));\n\t\t\ttext = text.replace(/&(?:#\\d+|#x[\\da-fA-F]+|[0-9a-zA-Z]+);/g, (match) => ' '.repeat(match.length));\n\t\t}\n\n\t\tlet index: SearchFieldIndex = null;\n\t\tif (field.getType() === 'string')\n\t\t{\n\t\t\tconst wordIndexes = this.splitText(text);\n\t\t\tif (Type.isArrayFilled(wordIndexes))\n\t\t\t{\n\t\t\t\t// \"GoPro111 Leto15\"\n\t\t\t\t// [go, pro, 111, leto, 15] + [gopro111, leto15]\n\t\t\t\tthis.fillComplexWords(wordIndexes);\n\t\t\t\tthis.fillNonCharWords(wordIndexes, text);\n\n\t\t\t\tindex = new SearchFieldIndex(field, wordIndexes);\n\t\t\t}\n\t\t}\n\t\telse if (field.getType() === 'email')\n\t\t{\n\t\t\tconst position = text.indexOf('@');\n\t\t\tif (position !== -1)\n\t\t\t{\n\t\t\t\tindex = new SearchFieldIndex(\n\t\t\t\t\tfield,\n\t\t\t\t\t[\n\t\t\t\t\t\tnew WordIndex(text.toLowerCase(), 0),\n\t\t\t\t\t\tnew WordIndex(text.substr(position + 1).toLowerCase(), position + 1)\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tstatic splitText(text: string): WordIndex[]\n\t{\n\t\tif (!Type.isStringFilled(text))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.hasUnicodeWord(text) ? this.splitUnicodeText(text) : this.splitAsciiText(text);\n\t}\n\n\tstatic splitUnicodeText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, unicodeWordsRegExp);\n\t}\n\n\tstatic splitAsciiText(text: string): WordIndex[]\n\t{\n\t\treturn this.splitTextInternal(text, asciiWordRegExp);\n\t}\n\n\tstatic hasUnicodeWord(text: string): boolean\n\t{\n\t\treturn hasUnicodeWordRegExp.test(text);\n\t}\n\n\tstatic splitTextInternal(text: string, regExp: RegExp): WordIndex[]\n\t{\n\t\tlet match;\n\t\tconst result = [];\n\n\t\tregExp.lastIndex = 0;\n\t\twhile ((match = regExp.exec(text)) !== null)\n\t\t{\n\t\t\tif (match.index === regExp.lastIndex)\n\t\t\t{\n\t\t\t\tregExp.lastIndex++;\n\t\t\t}\n\n\t\t\tresult.push(new WordIndex(match[0].toLowerCase(), match.index));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t *  @private\n\t */\n\tstatic fillComplexWords(indexes: WordIndex[]): void\n\t{\n\t\tif (indexes.length < 2)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet complexWord: ?string = null;\n\t\tlet startIndex: ?number = null;\n\n\t\tindexes.forEach((currentIndex, currentArrayIndex) => {\n\t\t\tconst nextIndex = indexes[currentArrayIndex + 1];\n\t\t\tif (nextIndex)\n\t\t\t{\n\t\t\t\tconst sameWord =\n\t\t\t\t\tcurrentIndex.getStartIndex() + currentIndex.getWord().length === nextIndex.getStartIndex()\n\t\t\t\t;\n\n\t\t\t\tif (sameWord)\n\t\t\t\t{\n\t\t\t\t\tif (complexWord === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tcomplexWord = currentIndex.getWord();\n\t\t\t\t\t\tstartIndex = currentIndex.getStartIndex();\n\t\t\t\t\t}\n\n\t\t\t\t\tcomplexWord += nextIndex.getWord();\n\t\t\t\t}\n\t\t\t\telse if (complexWord !== null)\n\t\t\t\t{\n\t\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\t\tcomplexWord = null;\n\t\t\t\t\tstartIndex = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (complexWord !== null)\n\t\t\t{\n\t\t\t\tindexes.push(new WordIndex(complexWord, startIndex));\n\t\t\t\tcomplexWord = null;\n\t\t\t\tstartIndex = null;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *  @private\n\t */\n\tstatic fillNonCharWords(indexes: WordIndex[], text: string): void\n\t{\n\t\tif (!specialCharsRegExp.test(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet match;\n\t\twhile ((match = nonWhitespaceRegExp.exec(text)) !== null)\n\t\t{\n\t\t\tif (match.index === nonWhitespaceRegExp.lastIndex)\n\t\t\t{\n\t\t\t\tnonWhitespaceRegExp.lastIndex++;\n\t\t\t}\n\n\t\t\tconst word = match[0];\n\t\t\tif (specialCharsRegExp.test(word))\n\t\t\t{\n\t\t\t\tindexes.push(new WordIndex(word.toLowerCase(), match.index));\n\n\t\t\t\tfor (let i = 0; i < word.length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst char = word[i];\n\t\t\t\t\tif (!specialChars.includes(char))\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wordToIndex = word.substr(i + 1);\n\t\t\t\t\tif (wordToIndex.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tindexes.push(new WordIndex(wordToIndex.toLowerCase(), match.index + i + 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnonWhitespaceRegExp.lastIndex = 0;\n\t}\n}","import { Type } from 'main.core';\nimport type { EntityFilterOptions } from './entity-filter-options';\n\nexport default class EntityFilter\n{\n\tid: string = null;\n\toptions: { [key: string]: any } = {};\n\n\tconstructor(filterOptions: EntityFilterOptions)\n\t{\n\t\tconst options = Type.isPlainObject(filterOptions) ? filterOptions : {};\n\n\t\tthis.id = options.id;\n\t\tthis.options = options.options;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetOptions(): { [key: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\toptions: this.getOptions(),\n\t\t}\n\t}\n}","import { Extension, Runtime, Type } from 'main.core';\nimport { OrderedArray } from 'main.core.collections';\n\nimport SearchField from '../search/search-field';\nimport TextNode from '../common/text-node';\n\nimport type Item from '../item/item';\nimport type { EntityOptions } from './entity-options';\nimport type { SearchFieldOptions } from '../search/search-field-options';\nimport type { ItemBadgeOptions } from '../item/item-badge-options';\nimport type { EntityBadgeOptions } from './entity-badge-options';\nimport type { EntityFilterOptions } from \"./entity-filter-options\";\nimport EntityFilter from './entity-filter';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Entity\n{\n\tstatic extensions: string[] = null;\n\tstatic defaultOptions: { [entityId: string]: { [key: string]: any } } = null;\n\n\tid: string = null;\n\toptions: { [key: string]: any } = {};\n\tsearchable: boolean = true;\n\tsearchFields: OrderedArray<SearchField> = null;\n\tdynamicLoad: boolean = false;\n\tdynamicSearch: boolean = false;\n\tsubstituteEntityId: string = null;\n\tsearchCacheLimits: RegExp[] = [];\n\tfilters: Map<string, EntityFilter> = new Map();\n\n\titemOptions: { [key: string]: any } = {};\n\ttagOptions: { [key: string]: any } = {};\n\tbadgeOptions: ItemBadgeOptions[] = [];\n\ttextNodes: Map<string, Map<string, TextNode>> = new Map();\n\n\tconstructor(entityOptions: EntityOptions)\n\t{\n\t\tlet options: EntityOptions = Type.isPlainObject(entityOptions) ? entityOptions : {};\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Entity: \"id\" parameter is required.');\n\t\t}\n\n\t\tconst defaultOptions = this.constructor.getEntityDefaultOptions(options.id) || {};\n\t\toptions = Runtime.merge(JSON.parse(JSON.stringify(defaultOptions)), options);\n\n\t\tthis.id = options.id.toLowerCase();\n\t\tthis.options = Type.isPlainObject(options.options) ? options.options : {};\n\t\tthis.itemOptions = Type.isPlainObject(options.itemOptions) ? options.itemOptions : {};\n\t\tthis.tagOptions = Type.isPlainObject(options.tagOptions) ? options.tagOptions : {};\n\t\tthis.badgeOptions = Type.isArray(options.badgeOptions) ? options.badgeOptions : [];\n\t\tthis.substituteEntityId = Type.isStringFilled(options.substituteEntityId) ? options.substituteEntityId : null;\n\n\t\tif (Type.isArray(options.filters))\n\t\t{\n\t\t\toptions.filters.forEach((filterOptions: EntityFilterOptions) => {\n\t\t\t\tthis.addFilter(filterOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis.searchFields = new OrderedArray((fieldA: SearchField, fieldB: SearchField) => {\n\t\t\tif (fieldA.getSort() !== null && fieldB.getSort() === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse if (fieldA.getSort() === null && fieldB.getSort() !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (fieldA.getSort() === null && fieldB.getSort() === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn fieldA.getSort() - fieldB.getSort();\n\t\t\t}\n\t\t});\n\n\t\tthis.setSearchable(options.searchable);\n\t\tthis.setDynamicLoad(options.dynamicLoad);\n\t\tthis.setDynamicSearch(options.dynamicSearch);\n\t\tthis.setSearchFields(options.searchFields);\n\t\tthis.setSearchCacheLimits(options.searchCacheLimits);\n\t}\n\n\tstatic getDefaultOptions()\n\t{\n\t\tif (this.defaultOptions === null)\n\t\t{\n\t\t\tthis.defaultOptions = {};\n\t\t\tthis.getExtensions().forEach((extension: string) => {\n\t\t\t\tconst settings = Extension.getSettings(extension);\n\t\t\t\tconst entities: [] = settings.get('entities', []);\n\t\t\t\tentities.forEach(entity => {\n\t\t\t\t\tif (Type.isStringFilled(entity.id) && Type.isPlainObject(entity.options))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.defaultOptions[entity.id] = JSON.parse(JSON.stringify(entity.options)); // clone\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn this.defaultOptions;\n\t}\n\n\tstatic getExtensions(): string[]\n\t{\n\t\tif (this.extensions === null)\n\t\t{\n\t\t\tconst settings = Extension.getSettings('ui.entity-selector');\n\t\t\tthis.extensions = settings.get('extensions', []);\n\t\t}\n\n\t\treturn this.extensions;\n\t}\n\n\tstatic getEntityDefaultOptions(entityId: string)\n\t{\n\t\treturn this.getDefaultOptions()[entityId] || null;\n\t}\n\n\tstatic getItemOptions(entityId: string, entityType: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst itemOptions = options && options['itemOptions'] ? options['itemOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn itemOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn itemOptions && !Type.isUndefined(itemOptions[entityType]) ? itemOptions[entityType] : null;\n\t\t}\n\t}\n\n\tstatic getTagOptions(entityId: string, entityType?: string)\n\t{\n\t\tif (!Type.isStringFilled(entityId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst options = this.getEntityDefaultOptions(entityId);\n\t\tconst tagOptions = options && options['tagOptions'] ? options['tagOptions'] : null;\n\n\t\tif (Type.isUndefined(entityType))\n\t\t{\n\t\t\treturn tagOptions;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn tagOptions && !Type.isUndefined(tagOptions[entityType]) ? tagOptions[entityType] : null;\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetOptions(): { [key: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetItemOptions(): { [key: string]: any }\n\t{\n\t\treturn this.itemOptions;\n\t}\n\n\tstatic getItemOption(entityId: string, option: string, entityType?: string): any\n\t{\n\t\treturn this.getOptionInternal(this.getItemOptions(entityId), option, entityType);\n\t}\n\n\tgetItemOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.itemOptions, option, entityType);\n\t}\n\n\tgetTagOptions(): { [key: string]: any }\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tstatic getTagOption(entityId: string, option: string, entityType?: string): any\n\t{\n\t\treturn this.getOptionInternal(this.getTagOptions(entityId), option, entityType);\n\t}\n\n\tgetTagOption(option: string, entityType?: string): any\n\t{\n\t\treturn this.constructor.getOptionInternal(this.tagOptions, option, entityType);\n\t}\n\n\tstatic getOptionInternal(options, option: string, type?: string): any\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (options[type] && !Type.isUndefined(options[type][option]))\n\t\t{\n\t\t\treturn options[type][option];\n\t\t}\n\t\telse if (options['default'] && !Type.isUndefined(options['default'][option]))\n\t\t{\n\t\t\treturn options['default'][option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetBadges(item: Item): EntityBadgeOptions[]\n\t{\n\t\tconst entityTypeBadges = this.getItemOption('badges', item.getEntityType()) || [];\n\t\tconst badges = [...entityTypeBadges];\n\n\t\tthis.badgeOptions.forEach((badge: EntityBadgeOptions) => {\n\t\t\tif (Type.isPlainObject(badge.conditions))\n\t\t\t{\n\t\t\t\tfor (const condition in badge.conditions)\n\t\t\t\t{\n\t\t\t\t\tif (item.getCustomData().get(condition) !== badge.conditions[condition])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbadges.push(badge);\n\t\t\t}\n\t\t});\n\n\t\treturn badges;\n\t}\n\n\tgetOptionTextNode(option: string, entityType?: string): ?TextNode\n\t{\n\t\tif (!Type.isString(option))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!Type.isString(entityType))\n\t\t{\n\t\t\tentityType = 'default';\n\t\t}\n\n\t\tlet optionNodes = this.textNodes.get(option);\n\t\tlet node = optionNodes ? optionNodes.get(entityType) : undefined;\n\n\t\tif (Type.isUndefined(node))\n\t\t{\n\t\t\tif (!optionNodes)\n\t\t\t{\n\t\t\t\toptionNodes = new Map();\n\t\t\t\tthis.textNodes.set(option, optionNodes);\n\t\t\t}\n\n\t\t\tconst itemOption = this.getItemOption(option, entityType);\n\t\t\tnode = Type.isString(itemOption) || Type.isPlainObject(itemOption) ? new TextNode(itemOption) : null;\n\n\t\t\toptionNodes.set(entityType, node);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tgetSearchFields(): OrderedArray<SearchField>\n\t{\n\t\treturn this.searchFields;\n\t}\n\n\tsetSearchFields(searchFields: SearchFieldOptions[]): void\n\t{\n\t\tthis.searchFields.clear();\n\n\t\t// Default Search Fields\n\t\tconst titleField = new SearchField({ name: 'title', searchable: true, system: true, type: 'string' });\n\t\tconst subtitleField = new SearchField({ name: 'subtitle', searchable: true, system: true, type: 'string' });\n\t\tthis.searchFields.add(titleField);\n\t\tthis.searchFields.add(subtitleField);\n\n\t\t// Custom Search Fields\n\t\tconst customFields = Type.isArray(searchFields) ? searchFields : [];\n\t\tcustomFields.forEach(fieldOptions => {\n\t\t\tconst field = new SearchField(fieldOptions);\n\t\t\tif (field.isSystem()) // Entity can override default fields.\n\t\t\t{\n\t\t\t\t// delete a default title field\n\t\t\t\tif (field.getName() === 'title')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(titleField);\n\t\t\t\t}\n\t\t\t\telse if (field.getName() === 'subtitle')\n\t\t\t\t{\n\t\t\t\t\tthis.searchFields.delete(subtitleField);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.searchFields.add(field);\n\t\t});\n\n\t\tthis.searchFields.forEach((field: SearchField, index: number) => {\n\t\t\tfield.setSort(index);\n\t\t});\n\t}\n\n\tsetSearchCacheLimits(limits: string[]): void\n\t{\n\t\tif (Type.isArrayFilled(limits))\n\t\t{\n\t\t\tlimits.forEach((limit: string) => {\n\t\t\t\tif (Type.isStringFilled(limit))\n\t\t\t\t{\n\t\t\t\t\tthis.searchCacheLimits.push(new RegExp(limit, 'i'));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSearchCacheLimits(): RegExp[]\n\t{\n\t\treturn this.searchCacheLimits;\n\t}\n\n\thasDynamicLoad(): boolean\n\t{\n\t\treturn this.dynamicLoad;\n\t}\n\n\tsetDynamicLoad(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicLoad = flag;\n\t\t}\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.dynamicSearch;\n\t}\n\n\tsetDynamicSearch(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.dynamicSearch = flag;\n\t\t}\n\t}\n\n\tgetFilters(): EntityFilter[]\n\t{\n\t\treturn Array.from(this.filters.values());\n\t}\n\n\taddFilters(filters: EntityFilterOptions[]): void\n\t{\n\t\tif (Type.isArray(filters))\n\t\t{\n\t\t\tfilters.forEach((filterOptions: EntityFilterOptions) => {\n\t\t\t\tthis.addFilter(filterOptions);\n\t\t\t});\n\t\t}\n\t}\n\n\taddFilter(filterOptions: EntityFilterOptions): void\n\t{\n\t\tif (Type.isPlainObject(filterOptions))\n\t\t{\n\t\t\tconst filter = new EntityFilter(filterOptions);\n\t\t\tthis.filters.set(filter.getId(), filter);\n\t\t}\n\t}\n\n\tgetFilter(id: string): ?Filter\n\t{\n\t\treturn this.filters.get(id) || null;\n\t}\n\n\tgetSubstituteEntityId(): string | null\n\t{\n\t\treturn this.substituteEntityId;\n\t}\n\n\ttoJSON()\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\toptions: this.getOptions(),\n\t\t\tsearchable: this.isSearchable(),\n\t\t\tdynamicLoad: this.hasDynamicLoad(),\n\t\t\tdynamicSearch: this.hasDynamicSearch(),\n\t\t\tfilters: this.getFilters(),\n\t\t\tsubstituteEntityId: this.getSubstituteEntityId(),\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\n\nexport default class TypeUtils\n{\n\tstatic createMapFromOptions(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn new Map(Object.entries(options));\n\t\t}\n\n\t\tconst map = new Map();\n\t\tif (Type.isArrayFilled(options))\n\t\t{\n\t\t\toptions.forEach((element: Array) => {\n\t\t\t\tif (Type.isArray(element) && element.length === 2 && Type.isString(element[0]))\n\t\t\t\t{\n\t\t\t\t\tmap.set(element[0], element[1]);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\treturn map;\n\t}\n\n\tstatic convertMapToObject(map: Map): object\n\t{\n\t\tconst obj = {};\n\t\tif (Type.isMap(map))\n\t\t{\n\t\t\tmap.forEach((value, key) => {\n\t\t\t\tif (Type.isString(key))\n\t\t\t\t{\n\t\t\t\t\tobj[key] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn obj;\n\t}\n}","import { Type, Loc, Text } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport ItemNode from './item-node';\nimport SearchIndex from '../search/search-index';\nimport Entity from '../entity/entity';\nimport ItemBadge from './item-badge';\nimport TextNode from '../common/text-node';\nimport TypeUtils from '../common/type-utils';\n\nimport type Dialog from '../dialog/dialog';\nimport type { ItemOptions } from './item-options';\nimport type { ItemNodeOptions } from './item-node-options';\nimport type { ItemBadgeOptions } from './item-badge-options';\nimport type { TagItemOptions } from '../tag-selector/tag-item-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { CaptionOptions } from './caption-options';\nimport type { BadgesOptions } from './badges-options';\nimport type { AvatarOptions } from './avatar-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n * @package ui.entity-selector\n */\nexport default class Item\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\n\ttitle: ?TextNode = null;\n\tsubtitle: ?TextNode = null;\n\tsupertitle: ?TextNode = null;\n\tcaption: ?TextNode = null;\n\tcaptionOptions: CaptionOptions = {};\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\ttextColor: ?string = null;\n\tlink: ?string = null;\n\tlinkTitle: ?TextNode = null;\n\ttagOptions: Map<string, any> = null;\n\tbadges: ItemBadgeOptions[] = null;\n\tbadgesOptions: BadgesOptions = {};\n\n\tdialog: Dialog = null;\n\tnodes: Set<ItemNode> = new Set();\n\tselected: boolean = false;\n\tsearchable: boolean = true;\n\tsaveable: boolean = true;\n\tdeselectable: boolean = true;\n\thidden: boolean = false;\n\tsearchIndex: { [key: string]: string[] } = null;\n\tcustomData: Map<string, any> = null;\n\n\tsort: number = null;\n\tcontextSort: number = null;\n\tglobalSort: number = null;\n\n\tconstructor(itemOptions: ItemOptions)\n\t{\n\t\tconst options: ItemOptions = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Item: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId.toLowerCase();\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\t\tthis.selected = Type.isBoolean(options.selected) ? options.selected : false;\n\n\t\tthis.customData = TypeUtils.createMapFromOptions(options.customData);\n\t\tthis.tagOptions = TypeUtils.createMapFromOptions(options.tagOptions);\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setSubtitle(options.subtitle);\n\t\tthis.setSupertitle(options.supertitle);\n\t\tthis.setCaption(options.caption);\n\t\tthis.setCaptionOptions(options.captionOptions);\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setLink(options.link);\n\t\tthis.setLinkTitle(options.linkTitle);\n\t\tthis.setBadges(options.badges);\n\t\tthis.setBadgesOptions(options.badgesOptions);\n\n\t\tthis.setSearchable(options.searchable);\n\t\tthis.setSaveable(options.saveable);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setHidden(options.hidden);\n\t\tthis.setContextSort(options.contextSort);\n\t\tthis.setGlobalSort(options.globalSort);\n\t\tthis.setSort(options.sort);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntity(): Entity\n\t{\n\t\tlet entity = this.getDialog().getEntity(this.getEntityId());\n\t\tif (entity === null)\n\t\t{\n\t\t\tentity = new Entity({ id: this.getEntityId() });\n\t\t\tthis.getDialog().addEntity(entity);\n\t\t}\n\n\t\treturn entity;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\tconst subtitleNode = this.getSubtitleNode();\n\n\t\treturn subtitleNode !== null ? subtitleNode.getText() : null;\n\t}\n\n\tgetSubtitleNode(): ?TextNode\n\t{\n\t\treturn this.subtitle !== null ? this.subtitle : this.getEntityTextNode('subtitle');\n\t}\n\n\tsetSubtitle(subtitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(subtitle) || Type.isPlainObject(subtitle) || subtitle === null)\n\t\t{\n\t\t\tthis.subtitle = subtitle === null ? null : new TextNode(subtitle);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetSupertitle(): ?string\n\t{\n\t\tconst supertitleNode = this.getSupertitleNode();\n\n\t\treturn supertitleNode !== null ? supertitleNode.getText() : null;\n\t}\n\n\tgetSupertitleNode(): ?TextNode\n\t{\n\t\treturn this.supertitle !== null ? this.supertitle : this.getEntityTextNode('supertitle');\n\t}\n\n\tsetSupertitle(supertitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(supertitle) || Type.isPlainObject(supertitle) || supertitle === null)\n\t\t{\n\t\t\tthis.supertitle = supertitle === null ? null : new TextNode(supertitle);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetCaption(): ?string\n\t{\n\t\tconst captionNode = this.getCaptionNode();\n\n\t\treturn captionNode !== null ? captionNode.getText() : null;\n\t}\n\n\tgetCaptionNode(): ?TextNode\n\t{\n\t\treturn this.caption !== null ? this.caption : this.getEntityTextNode('caption');\n\t}\n\n\tsetCaption(caption: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(caption) || Type.isPlainObject(caption) || caption === null)\n\t\t{\n\t\t\tthis.caption = caption === null ? null : new TextNode(caption);\n\n\t\t\tthis.resetSearchIndex();\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetCaptionOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.captionOptions[option]))\n\t\t{\n\t\t\treturn this.captionOptions[option];\n\t\t}\n\n\t\tconst captionOptions = this.getEntityItemOption('captionOptions');\n\t\tif (Type.isPlainObject(captionOptions) && !Type.isUndefined(captionOptions[option]))\n\t\t{\n\t\t\treturn captionOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetCaptionOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.captionOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetCaptionOptions(options: {[key: string]: any }): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setCaptionOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\treturn this.avatar !== null ? this.avatar : this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.avatarOptions !== null && !Type.isUndefined(this.avatarOptions[option]))\n\t\t{\n\t\t\treturn this.avatarOptions[option];\n\t\t}\n\n\t\tconst avatarOptions = this.getEntityItemOption('avatarOptions');\n\t\tif (Type.isPlainObject(avatarOptions) && !Type.isUndefined(avatarOptions[option]))\n\t\t{\n\t\t\treturn avatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\treturn this.textColor !== null ? this.textColor : this.getEntityItemOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\tconst link = this.link !== null ? this.link : this.getEntityItemOption('link');\n\n\t\treturn this.replaceMacros(link);\n\t}\n\n\tsetLink(link: ?string): void\n\t{\n\t\tif (Type.isString(link) || link === null)\n\t\t{\n\t\t\tthis.link = link;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetLinkTitle(): ?string\n\t{\n\t\tconst linkTitleNode = this.getLinkTitleNode();\n\n\t\treturn linkTitleNode !== null ? linkTitleNode.getText() : Loc.getMessage('UI_SELECTOR_ITEM_LINK_TITLE');\n\t}\n\n\tgetLinkTitleNode(): ?TextNode\n\t{\n\t\treturn this.linkTitle !== null ? this.linkTitle : this.getEntityTextNode('linkTitle');\n\t}\n\n\tsetLinkTitle(linkTitle: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isString(linkTitle) || Type.isPlainObject(linkTitle) || linkTitle === null)\n\t\t{\n\t\t\tthis.linkTitle = linkTitle === null ? null : new TextNode(linkTitle);\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetBadges(): ItemBadge[]\n\t{\n\t\tif (this.badges !== null)\n\t\t{\n\t\t\treturn this.badges;\n\t\t}\n\n\t\tconst badges = this.getEntity().getBadges(this);\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.setBadges(badges);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.badges = [];\n\t\t}\n\n\t\treturn this.badges;\n\t}\n\n\tsetBadges(badges: ?ItemBadgeOptions[]): void\n\t{\n\t\tif (Type.isArray(badges))\n\t\t{\n\t\t\tthis.badges = [];\n\t\t\tbadges.forEach(badge => {\n\t\t\t\tthis.badges.push(new ItemBadge(badge));\n\t\t\t});\n\n\t\t\tthis.#renderNodes();\n\t\t}\n\t\telse if (badges === null)\n\t\t{\n\t\t\tthis.badges = null;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tgetBadgesOption(option: string): string | boolean | number | null\n\t{\n\t\tif (!Type.isUndefined(this.badgesOptions[option]))\n\t\t{\n\t\t\treturn this.badgesOptions[option];\n\t\t}\n\n\t\tconst badgesOptions = this.getEntityItemOption('badgesOptions');\n\t\tif (Type.isPlainObject(badgesOptions) && !Type.isUndefined(badgesOptions[option]))\n\t\t{\n\t\t\treturn badgesOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetBadgesOption(option: string, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tthis.badgesOptions[option] = value;\n\t\t\tthis.#renderNodes();\n\t\t}\n\t}\n\n\tsetBadgesOptions(options: {[key: string]: any }): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setBadgesOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tcreateNode(nodeOptions: ItemNodeOptions): ItemNode\n\t{\n\t\tconst itemNode = new ItemNode(this, nodeOptions);\n\t\tthis.nodes.add(itemNode);\n\n\t\treturn itemNode;\n\t}\n\n\tremoveNode(node: ItemNode): void\n\t{\n\t\tthis.nodes.delete(node);\n\t}\n\n\tgetNodes(): Set<ItemNode>\n\t{\n\t\treturn this.nodes;\n\t}\n\n\tselect(preselectedMode: boolean = false): void\n\t{\n\t\tif (this.selected)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tconst emitEvents = dialog && !preselectedMode;\n\n\t\tif (emitEvents)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeSelect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = true;\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemSelect(this, !preselectedMode);\n\t\t}\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.select();\n\t\t\t});\n\t\t}\n\n\t\tif (emitEvents)\n\t\t{\n\t\t\tdialog.emit('Item:onSelect', { item: this });\n\t\t\tdialog.saveRecentItem(this);\n\t\t}\n\t}\n\n\tdeselect(): void\n\t{\n\t\tif (!this.selected)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tconst event = new BaseEvent({ data: { item: this } });\n\t\t\tdialog.emit('Item:onBeforeDeselect', event);\n\t\t\tif (event.isDefaultPrevented())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.selected = false;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach(node => {\n\t\t\t\tnode.deselect();\n\t\t\t});\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.handleItemDeselect(this);\n\t\t\tdialog.emit('Item:onDeselect', { item: this });\n\t\t}\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tsetSearchable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.searchable = flag;\n\t\t}\n\t}\n\n\tisSearchable(): boolean\n\t{\n\t\treturn this.searchable;\n\t}\n\n\tsetSaveable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.saveable = flag;\n\t\t}\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn this.saveable;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (this.getDialog() && this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tconst tag = this.getDialog().getTagSelector().getTag({\n\t\t\t\t\tid: this.getId(),\n\t\t\t\t\tentityId: this.getEntityId()\n\t\t\t\t});\n\n\t\t\t\tif (tag)\n\t\t\t\t{\n\t\t\t\t\ttag.setDeselectable(flag);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tsetHidden(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hidden = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\t\tnode.setHidden(flag);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tisHidden(): boolean\n\t{\n\t\treturn this.hidden;\n\t}\n\n\tsetContextSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.contextSort = sort;\n\t\t}\n\t}\n\n\tgetContextSort(): ?number\n\t{\n\t\treturn this.contextSort;\n\t}\n\n\tsetGlobalSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.globalSort = sort;\n\t\t}\n\t}\n\n\tgetGlobalSort(): ?number\n\t{\n\t\treturn this.globalSort;\n\t}\n\n\tsetSort(sort: ?number): void\n\t{\n\t\tif (Type.isNumber(sort) || sort === null)\n\t\t{\n\t\t\tthis.sort = sort;\n\t\t}\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\tgetSearchIndex(): SearchIndex\n\t{\n\t\tif (this.searchIndex === null)\n\t\t{\n\t\t\tthis.searchIndex = SearchIndex.create(this);\n\t\t}\n\n\t\treturn this.searchIndex;\n\t}\n\n\tresetSearchIndex(): void\n\t{\n\t\tthis.searchIndex = null;\n\t}\n\n\tgetCustomData(): Map<string, any>\n\t{\n\t\treturn this.customData;\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\t#renderNodes(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.render();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetEntityItemOption(option): any\n\t{\n\t\treturn this.getEntity().getItemOption(option, this.getEntityType());\n\t}\n\n\tgetEntityTagOption(option): any\n\t{\n\t\treturn this.getEntity().getTagOption(option, this.getEntityType());\n\t}\n\n\tgetEntityTextNode(option): any\n\t{\n\t\treturn this.getEntity().getOptionTextNode(option, this.getEntityType());\n\t}\n\n\tgetTagOptions(): Map<string, any>\n\t{\n\t\treturn this.tagOptions;\n\t}\n\n\tgetTagOption(option: string): any\n\t{\n\t\tconst value = this.getTagOptions().get(option);\n\n\t\tif (!Type.isUndefined(value))\n\t\t{\n\t\t\treturn value;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetTagGlobalOption(option: string, useItemOptions: boolean = false): any\n\t{\n\t\tif (!Type.isStringFilled(option))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet value = this.getTagOption(option);\n\n\t\tif (value === null && useItemOptions === true && this[option] !== null)\n\t\t{\n\t\t\tvalue = this[option];\n\t\t}\n\n\t\tif (value === null && this.getDialog().getTagSelector())\n\t\t{\n\t\t\tconst fn = `getTag${Text.toPascalCase(option)}`;\n\t\t\tif (Type.isFunction(this.getDialog().getTagSelector()[fn]))\n\t\t\t{\n\t\t\t\tvalue = this.getDialog().getTagSelector()[fn]();\n\t\t\t}\n\t\t}\n\n\t\tif (value === null)\n\t\t{\n\t\t\tvalue = this.getEntityTagOption(option);\n\t\t}\n\n\t\tif (value === null && useItemOptions === true)\n\t\t{\n\t\t\tvalue = this.getEntityItemOption(option);\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('bgColor');\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('textColor');\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.getTagGlobalOption('maxWidth');\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('fontWeight');\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.getTagGlobalOption('avatar', true);\n\t}\n\n\tgetTagAvatarOptions(): ?AvatarOptions\n\t{\n\t\treturn this.getTagGlobalOption('avatarOptions', true);\n\t}\n\n\tgetTagLink(): ?string\n\t{\n\t\treturn this.replaceMacros(this.getTagGlobalOption('link', true));\n\t}\n\n\t/**\n\t * @internal\n\t */\n\treplaceMacros(str: string): string\n\t{\n\t\tif (!Type.isStringFilled(str))\n\t\t{\n\t\t\treturn str;\n\t\t}\n\n\t\treturn (\n\t\t\tstr\n\t\t\t\t.replace(/#id#/i, this.getId())\n\t\t\t\t.replace(/#element_id#/i, this.getId())\n\t\t);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tcreateTag(): TagItemOptions\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\ttitle: this.getTagOption('title') || (this.getTitleNode() && this.getTitleNode().toJSON()) || '',\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\tavatar: this.getTagAvatar(),\n\t\t\tavatarOptions: this.getTagAvatarOptions(),\n\t\t\tlink: this.getTagLink(),\n\t\t\tmaxWidth: this.getTagMaxWidth(),\n\t\t\ttextColor: this.getTagTextColor(),\n\t\t\tbgColor: this.getTagBgColor(),\n\t\t\tfontWeight: this.getTagFontWeight(),\n\t\t};\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn this.toJSON();\n\t}\n\n\ttoJSON(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tentityId: this.getEntityId(),\n\t\t\tentityType: this.getEntityType(),\n\t\t\tselected: this.isSelected(),\n\t\t\tdeselectable: this.isDeselectable(),\n\t\t\tsearchable: this.isSearchable(),\n\t\t\tsaveable: this.isSaveable(),\n\t\t\thidden: this.isHidden(),\n\t\t\ttitle: this.getTitleNode(),\n\t\t\tlink: this.getLink(),\n\t\t\tlinkTitle: this.getLinkTitleNode(),\n\t\t\tsubtitle: this.getSubtitleNode(),\n\t\t\tsupertitle: this.getSupertitleNode(),\n\t\t\tcaption: this.getCaptionNode(),\n\t\t\tavatar: this.getAvatar(),\n\t\t\ttextColor: this.getTextColor(),\n\t\t\tsort: this.getSort(),\n\t\t\tcontextSort: this.getContextSort(),\n\t\t\tglobalSort: this.getGlobalSort(),\n\t\t\tcustomData: TypeUtils.convertMapToObject(this.getCustomData()),\n\t\t\ttagOptions: TypeUtils.convertMapToObject(this.getTagOptions()),\n\t\t\tbadges: this.getBadges()\n\t\t};\n\t}\n}","import { Cache, Dom, Tag, Type } from 'main.core';\nimport type Tab from '../tabs/tab';\n\nexport default class BaseStub\n{\n\ttab: Tab = null;\n\tautoShow: boolean = true;\n\tcache = new Cache.MemoryCache();\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\t\tthis.tab = tab;\n\t\tthis.autoShow = this.getOption('autoShow', true);\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetOuterContainer()\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-stub\">${this.render()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tisAutoShow(): boolean\n\t{\n\t\treturn this.autoShow;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.append(this.getOuterContainer(), this.getTab().getContainer());\n\t\t/*requestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\t});*/\n\t}\n\n\thide(): void\n\t{\n\t\t// Dom.removeClass(this.getOuterContainer(), 'ui-selector-tab-stub--show');\n\t\tDom.remove(this.getOuterContainer());\n\t}\n\n\tgetOptions(): { [option: string]: any }\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n}","import { Tag, Type, Loc } from 'main.core';\nimport type Tab from '../tabs/tab';\nimport BaseStub from './base-stub';\nimport encodeUrl from '../../common/encode-url';\n\nexport default class DefaultStub extends BaseStub\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(tab: Tab, options: { [option: string]: any })\n\t{\n\t\tsuper(tab, options);\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst subtitle = this.getOption('subtitle');\n\t\t\tconst title = Type.isStringFilled(this.getOption('title')) ? this.getOption('title') : this.getDefaultTitle();\n\n\t\t\tconst icon = this.getOption('icon') || this.getTab().getIcon('default');\n\t\t\tlet iconOpacity = 35;\n\t\t\tif (Type.isNumber(this.getOption('iconOpacity')))\n\t\t\t{\n\t\t\t\ticonOpacity = Math.min(100, Math.max(0, this.getOption('iconOpacity')));\n\t\t\t}\n\n\t\t\tconst iconStyle =\n\t\t\t\tType.isStringFilled(icon)\n\t\t\t\t\t? `style=\"background-image: url('${encodeUrl(icon)}'); opacity: ${iconOpacity / 100};\"`\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\tconst arrow = this.getOption('arrow', false) && this.getTab().getDialog().getActiveFooter() !== null;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-default-stub\">\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-icon\" ${iconStyle}></div>\n\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-titles\">\n\t\t\t\t\t\t<div class=\"ui-selector-tab-default-stub-title\">${title}</div>\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tsubtitle ? \n\t\t\t\t\t\t\t\tTag.render`<div class=\"ui-selector-tab-default-stub-subtitle\">${subtitle}</div>` \n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t${arrow ? Tag.render`<div class=\"ui-selector-tab-default-stub-arrow\"></div>` : ''}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDefaultTitle()\n\t{\n\t\tconst titleNode = this.getTab().getTitleNode();\n\n\t\tconst titleContainer = Tag.render`<span class=\"ui-selector-tab-default-stub-title\"></span>`;\n\t\ttitleNode.renderTo(titleContainer);\n\n\t\treturn Loc.getMessage('UI_SELECTOR_TAB_STUB_TITLE').replace(/#TAB_TITLE#/, titleContainer.innerHTML);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.getContainer();\n\t}\n}","import { Tag, Type, Dom, Cache } from 'main.core';\nimport Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { HeaderOptions } from './header-content';\n\nexport default class BaseHeader\n{\n\tdialog: Dialog = null;\n\ttab: Tab = null;\n\tcontainer: ?HTMLElement = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(context: Dialog | Tab, options: HeaderOptions)\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\n\t\tif (context instanceof Dialog)\n\t\t{\n\t\t\tthis.dialog = context;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.tab = context;\n\t\t\tthis.dialog = this.tab.getDialog();\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetTab(): ?Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'ui-selector-header--show');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-header--show');\n\t}\n\n\tgetOptions(): HeaderOptions\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"ui-selector-header\">${this.render()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Tag, Type, Dom, Cache } from 'main.core';\nimport Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class BaseFooter\n{\n\tdialog: Dialog = null;\n\ttab: Tab = null;\n\tcontainer: ?HTMLElement = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(context: Dialog | Tab, options: FooterOptions)\n\t{\n\t\tthis.options = Type.isPlainObject(options) ? options : {};\n\n\t\tif (context instanceof Dialog)\n\t\t{\n\t\t\tthis.dialog = context;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.tab = context;\n\t\t\tthis.dialog = this.tab.getDialog();\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetTab(): ?Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tshow(): void\n\t{\n\t\tDom.addClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\thide(): void\n\t{\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-footer--show');\n\t}\n\n\tgetOptions(): FooterOptions\n\t{\n\t\treturn this.options;\n\t}\n\n\tgetOption(option: string, defaultValue?: any): any\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\t\telse if (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (this.container === null)\n\t\t{\n\t\t\tthis.container = Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer\">${this.render()}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\trender(): HTMLElement\n\t{\n\t\tthrow new Error('You must implement render() method.');\n\t}\n}","import { Type, Tag, Dom, Cache, Reflection } from 'main.core';\nimport ItemNode from '../../item/item-node';\nimport Dialog from '../dialog';\nimport BaseStub from './base-stub';\nimport DefaultStub from './default-stub';\nimport BaseHeader from '../header/base-header';\nimport BaseFooter from '../footer/base-footer';\nimport TextNode from '../../common/text-node';\nimport encodeUrl from '../../common/encode-url';\n\nimport type { TabLabelState, TabLabelStates, TabOptions } from './tab-options';\nimport type { HeaderContent, HeaderOptions } from '../header/header-content';\nimport type { FooterContent, FooterOptions } from '../footer/footer-content';\nimport type { TextNodeOptions } from '../../common/text-node-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Tab\n{\n\tid: string = null;\n\ttitle: ?TextNode = null;\n\trootNode: ItemNode = null;\n\n\tdialog: Dialog = null;\n\tstub: BaseStub = null;\n\n\tvisible: boolean = true;\n\trendered: boolean = false;\n\tlocked: boolean = false;\n\tselected: boolean = false;\n\thovered: boolean = false;\n\n\ticon: TabLabelStates = {};\n\ttextColor: TabLabelStates = {};\n\tbgColor: TabLabelStates = {};\n\n\titemMaxDepth: number = 5;\n\n\theader: BaseHeader = null;\n\tshowDefaultHeader = true;\n\tfooter: BaseFooter = null;\n\tshowDefaultFooter = true;\n\tshowAvatars: ?boolean = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tconst options: TabOptions = Type.isPlainObject(tabOptions) ? tabOptions : {};\n\n\t\tif (!Type.isStringFilled(options.id))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.Tab: \"id\" parameter is required.');\n\t\t}\n\n\t\tthis.setDialog(dialog);\n\t\tthis.id = options.id;\n\t\tthis.showDefaultHeader = options.showDefaultHeader !== false;\n\t\tthis.showDefaultFooter = options.showDefaultFooter !== false;\n\n\t\tthis.rootNode = new ItemNode(null, { itemOrder: options.itemOrder });\n\t\tthis.rootNode.setTab(this);\n\n\t\tthis.setVisible(options.visible);\n\t\tthis.setTitle(options.title);\n\t\tthis.setItemMaxDepth(options.itemMaxDepth);\n\t\tthis.setIcon(options.icon);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setStub(options.stub, options.stubOptions);\n\t\tthis.setHeader(options.header, options.headerOptions);\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t\tthis.setShowAvatars(options.showAvatars);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tsetDialog(dialog: Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tgetStub(): ?BaseStub\n\t{\n\t\treturn this.stub;\n\t}\n\n\tsetStub(stub?: boolean | string | Function, stubOptions?: { [option: string]: any }): void\n\t{\n\t\tlet instance = null;\n\t\tconst options = Type.isPlainObject(stubOptions) ? stubOptions : {};\n\n\t\tif (Type.isString(stub) || Type.isFunction(stub))\n\t\t{\n\t\t\tconst className = Type.isString(stub) ? Reflection.getClass(stub) : stub;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tinstance = new className(this, options);\n\t\t\t\tif (!(instance instanceof BaseStub))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: stub is not an instance of BaseStub.');\n\t\t\t\t\tinstance = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!instance && stub !== false)\n\t\t{\n\t\t\tinstance = new DefaultStub(this, options);\n\t\t}\n\n\t\tthis.stub = instance;\n\t}\n\n\tgetHeader(): ?BaseHeader\n\t{\n\t\treturn this.header;\n\t}\n\n\tsetHeader(headerContent: ?HeaderContent, headerOptions?: HeaderOptions)\n\t{\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tif (headerContent !== null)\n\t\t{\n\t\t\theader = Dialog.createHeader(this, headerContent, headerOptions);\n\t\t\tif (header === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getHeader() !== null)\n\t\t{\n\t\t\tDom.remove(this.getHeader().getContainer());\n\t\t\tthis.getDialog().adjustHeader();\n\t\t}\n\n\t\tthis.header = header;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getDialog().appendHeader(header);\n\t\t\tthis.getDialog().adjustHeader();\n\t\t}\n\t}\n\n\tcanShowDefaultHeader(): boolean\n\t{\n\t\treturn this.showDefaultHeader;\n\t}\n\n\tenableDefaultHeader(): void\n\t{\n\t\tthis.showDefaultHeader = true;\n\t\tthis.getDialog().adjustHeader();\n\t}\n\n\tdisableDefaultHeader(): void\n\t{\n\t\tthis.showDefaultHeader = false;\n\t\tthis.getDialog().adjustHeader();\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions)\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = Dialog.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getDialog().appendFooter(footer);\n\t\t\tthis.getDialog().adjustFooter();\n\t\t}\n\t}\n\n\tcanShowDefaultFooter(): boolean\n\t{\n\t\treturn this.showDefaultFooter;\n\t}\n\n\tenableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = true;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tdisableDefaultFooter(): void\n\t{\n\t\tthis.showDefaultFooter = false;\n\t\tthis.getDialog().adjustFooter();\n\t}\n\n\tsetShowAvatars(flag: ?boolean): void\n\t{\n\t\tif (Type.isBoolean(flag) || flag === null)\n\t\t{\n\t\t\tthis.showAvatars = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderContainer();\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldShowAvatars(): boolean\n\t{\n\t\treturn this.showAvatars ?? this.getDialog().shouldShowAvatars();\n\t}\n\n\tgetRootNode(): ItemNode\n\t{\n\t\treturn this.rootNode;\n\t}\n\n\tsetTitle(title: ?string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.renderLabel();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\n\t\treturn titleNode !== null && !titleNode.isNullable() ? titleNode.getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetIcon(icon: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('icon', icon);\n\t}\n\n\tgetIcon(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('icon', state);\n\t}\n\n\tsetBgColor(bgColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('bgColor', bgColor);\n\t}\n\n\tgetBgColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('bgColor', state);\n\t}\n\n\tsetTextColor(textColor: TabLabelStates | string): void\n\t{\n\t\treturn this.setProperty('textColor', textColor);\n\t}\n\n\tgetTextColor(state?: TabLabelState): ?string\n\t{\n\t\treturn this.getPropertyByState('textColor', state);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetProperty(name: string, states: TabLabelStates | string): void\n\t{\n\t\tconst property = this[name];\n\t\tif (!property)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isPlainObject(states))\n\t\t{\n\t\t\tObject.keys(states).forEach(state => {\n\t\t\t\tif (Type.isStringFilled(states[state]))\n\t\t\t\t{\n\t\t\t\t\tproperty[state] = states[state];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isStringFilled(states))\n\t\t{\n\t\t\tproperty['default'] = states;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetPropertyByState(name: string, state?: TabLabelState): ?string\n\t{\n\t\tconst property = this[name];\n\t\tconst labelState = Type.isStringFilled(state) ? state : 'default';\n\n\t\tif (!Type.isUndefined(property) && !Type.isUndefined(property[labelState]))\n\t\t{\n\t\t\treturn property[labelState];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetPropertyByCurrentState(name: string): ?string\n\t{\n\t\tconst property = this[name];\n\t\tif (this.isSelected() && this.isHovered() && property.selectedHovered)\n\t\t{\n\t\t\treturn property.selectedHovered;\n\t\t}\n\t\telse if (this.isSelected() && property.selected)\n\t\t{\n\t\t\treturn property.selected;\n\t\t}\n\t\telse if (this.isHovered() && property.hovered)\n\t\t{\n\t\t\treturn property.hovered;\n\t\t}\n\t\telse if (property.default)\n\t\t{\n\t\t\treturn property.default;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetItemMaxDepth(depth: number): void\n\t{\n\t\tif (Type.isNumber(depth) && depth > 0)\n\t\t{\n\t\t\tthis.itemMaxDepth = depth;\n\t\t}\n\t}\n\n\tgetItemMaxDepth(): number\n\t{\n\t\treturn this.itemMaxDepth;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-content\">${this.getItemsContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\tconst className = this.isVisible() ? '' : ' ui-selector-tab-label-hidden';\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-tab-label${className}\" \n\t\t\t\t\tonclick=\"${this.handleLabelClick.bind(this)}\"\n\t\t\t\t\tonmouseenter=\"${this.handleLabelMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleLabelMouseLeave.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-icon\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tab-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-items\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\trender(): void\n\t{\n\t\tthis.getRootNode().render();\n\t\tthis.rendered = true;\n\t}\n\n\t/** @internal **/\n\trenderLabel(): void\n\t{\n\t\tDom.style(this.getTitleContainer(), 'color', this.getPropertyByCurrentState('textColor'));\n\t\tDom.style(this.getLabelContainer(), 'background-color', this.getPropertyByCurrentState('bgColor'));\n\n\t\tconst icon = this.getPropertyByCurrentState('icon');\n\t\tDom.style(this.getIconContainer(), 'background-image', icon ? `url('${encodeUrl(icon)}')` : null);\n\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\tthis.getTitleNode().renderTo(this.getTitleContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t}\n\t}\n\n\t/** @internal **/\n\trenderContainer(): void\n\t{\n\t\tconst className = 'ui-selector-tab-content--hide-avatars';\n\t\tif (this.shouldShowAvatars())\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), className);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), className);\n\t\t}\n\t}\n\n\tisVisible(): boolean\n\t{\n\t\treturn this.visible;\n\t}\n\n\tsetVisible(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.visible = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (this.visible)\n\t\t\t\t{\n\t\t\t\t\tDom.remove(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hidden');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getDialog() && this.getDialog().isRendered();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tselect(): void\n\t{\n\t\tif (this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tthis.selected = true;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getHeader())\n\t\t{\n\t\t\tthis.getHeader().show();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().show();\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onSelect', { tab: this });\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tdeselect(): void\n\t{\n\t\tif (!this.isSelected())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-active');\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-active');\n\t\t}\n\n\t\tthis.selected = false;\n\n\t\tif (this.isVisible())\n\t\t{\n\t\t\tthis.renderLabel();\n\t\t}\n\n\t\tif (this.getHeader())\n\t\t{\n\t\t\tthis.getHeader().hide();\n\t\t}\n\n\t\tif (this.getFooter())\n\t\t{\n\t\t\tthis.getFooter().hide();\n\t\t}\n\n\t\tthis.getDialog().emit('Tab:onDeselect', { tab: this\t});\n\t}\n\n\thover(): void\n\t{\n\t\tif (this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = true;\n\n\t\tthis.renderLabel();\n\t}\n\n\tunhover(): void\n\t{\n\t\tif (!this.isHovered())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.getLabelContainer(), 'ui-selector-tab-label-hover');\n\t\tthis.hovered = false;\n\n\t\tthis.renderLabel();\n\t}\n\n\tisSelected(): boolean\n\t{\n\t\treturn this.selected;\n\t}\n\n\tisHovered(): boolean\n\t{\n\t\treturn this.hovered;\n\t}\n\n\tlock(): void\n\t{\n\t\tthis.locked = true;\n\t\tDom.addClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tunlock(): void\n\t{\n\t\tthis.locked = false;\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-tab-content-locked');\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\thandleLabelClick(): void\n\t{\n\t\tthis.getDialog().selectTab(this.getId());\n\t}\n\n\thandleLabelMouseEnter(): void\n\t{\n\t\tthis.hover();\n\t}\n\n\thandleLabelMouseLeave(): void\n\t{\n\t\tthis.unhover();\n\t}\n}","import { Cache, Tag, Type, Dom } from 'main.core';\nimport Entity from '../entity/entity';\nimport TextNode from '../common/text-node';\nimport Animation from '../common/animation';\nimport TypeUtils from '../common/type-utils';\nimport encodeUrl from '../common/encode-url';\n\nimport type TagSelector from './tag-selector';\nimport type { TagItemOptions } from './tag-item-options';\nimport type { TextNodeOptions } from '../common/text-node-options';\nimport type { AvatarOptions } from '../item/avatar-options';\n\nexport default class TagItem\n{\n\tid: string | number = null;\n\tentityId: string = null;\n\tentityType: string = null;\n\ttitle: ?TextNode = null;\n\n\tavatar: ?string = null;\n\tavatarOptions: ?AvatarOptions = null;\n\tmaxWidth: ?number = null;\n\ttextColor: ?string = null;\n\tbgColor: ?string = null;\n\tfontWeight: ?string = null;\n\n\tlink: ?string = null;\n\tonclick: ?Function = null;\n\n\tdeselectable: ?boolean = null;\n\tcustomData: Map<string, any> = null;\n\n\tcache = new Cache.MemoryCache();\n\tselector: TagSelector = null;\n\trendered: ?boolean = false;\n\n\tconstructor(itemOptions: TagItemOptions)\n\t{\n\t\tconst options = Type.isPlainObject(itemOptions) ? itemOptions : {};\n\t\tif (!Type.isStringFilled(options.id) && !Type.isNumber(options.id))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"id\" parameter is required.');\n\t\t}\n\n\t\tif (!Type.isStringFilled(options.entityId))\n\t\t{\n\t\t\tthrow new Error('TagSelector.TagItem: \"entityId\" parameter is required.');\n\t\t}\n\n\t\tthis.id = options.id;\n\t\tthis.entityId = options.entityId.toLowerCase();\n\t\tthis.entityType = Type.isStringFilled(options.entityType) ? options.entityType : 'default';\n\t\tthis.customData = TypeUtils.createMapFromOptions(options.customData);\n\n\t\tthis.onclick = Type.isFunction(options.onclick) ? options.onclick : null;\n\t\tthis.link = Type.isStringFilled(options.link) ? options.link : null;\n\n\t\tthis.setTitle(options.title);\n\t\tthis.setDeselectable(options.deselectable);\n\n\t\tthis.setAvatar(options.avatar);\n\t\tthis.setAvatarOptions(options.avatarOptions);\n\t\tthis.setMaxWidth(options.maxWidth);\n\t\tthis.setTextColor(options.textColor);\n\t\tthis.setBgColor(options.bgColor);\n\t\tthis.setFontWeight(options.fontWeight);\n\t}\n\n\tgetId(): string | number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetEntityId(): string\n\t{\n\t\treturn this.entityId;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.entityType;\n\t}\n\n\tgetSelector(): TagSelector\n\t{\n\t\treturn this.selector;\n\t}\n\n\tsetSelector(selector: TagSelector)\n\t{\n\t\tthis.selector = selector;\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn this.getTitleNode() && !this.getTitleNode().isNullable() ? this.getTitleNode().getText() : '';\n\t}\n\n\tgetTitleNode(): ?TextNode\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title: string | TextNodeOptions): void\n\t{\n\t\tif (Type.isStringFilled(title) || Type.isPlainObject(title) || title === null)\n\t\t{\n\t\t\tthis.title = title === null ? null : new TextNode(title);\n\t\t}\n\t}\n\n\tgetAvatar(): ?string\n\t{\n\t\tif (this.avatar !== null)\n\t\t{\n\t\t\treturn this.avatar;\n\t\t}\n\t\telse if (this.getSelector().getTagAvatar() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagAvatar();\n\t\t}\n\t\telse if (this.getEntityTagOption('avatar') !== null)\n\t\t{\n\t\t\treturn this.getEntityTagOption('avatar');\n\t\t}\n\n\t\treturn this.getEntityItemOption('avatar');\n\t}\n\n\tsetAvatar(avatar: ?string): void\n\t{\n\t\tif (Type.isString(avatar) || avatar === null)\n\t\t{\n\t\t\tthis.avatar = avatar;\n\t\t}\n\t}\n\n\tgetAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.avatarOptions !== null && !Type.isUndefined(this.avatarOptions[option]))\n\t\t{\n\t\t\treturn this.avatarOptions[option];\n\t\t}\n\n\t\tconst selectorAvatarOption = this.getSelector().getTagAvatarOption(option);\n\t\tif (selectorAvatarOption !== null)\n\t\t{\n\t\t\treturn selectorAvatarOption[option];\n\t\t}\n\n\t\tconst entityTagAvatarOptions = this.getEntityTagOption('avatarOptions');\n\t\tif (Type.isPlainObject(entityTagAvatarOptions) && !Type.isUndefined(entityTagAvatarOptions[option]))\n\t\t{\n\t\t\treturn entityTagAvatarOptions[option];\n\t\t}\n\n\t\tconst entityItemAvatarOptions = this.getEntityItemOption('avatarOptions');\n\t\tif (Type.isPlainObject(entityItemAvatarOptions) && !Type.isUndefined(entityItemAvatarOptions[option]))\n\t\t{\n\t\t\treturn entityItemAvatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.avatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.avatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.avatarOptions[option] = value;\n\t\t}\n\t}\n\n\tsetAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTextColor(): ?string\n\t{\n\t\tif (this.textColor !== null)\n\t\t{\n\t\t\treturn this.textColor;\n\t\t}\n\t\telse if (this.getSelector().getTagTextColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagTextColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('textColor');\n\t}\n\n\tsetTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.textColor = textColor;\n\t\t}\n\t}\n\n\tgetBgColor(): ?string\n\t{\n\t\tif (this.bgColor !== null)\n\t\t{\n\t\t\treturn this.bgColor;\n\t\t}\n\t\telse if (this.getSelector().getTagBgColor() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagBgColor();\n\t\t}\n\n\t\treturn this.getEntityTagOption('bgColor');\n\t}\n\n\tsetBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.bgColor = bgColor;\n\t\t}\n\t}\n\n\tgetFontWeight(): ?string\n\t{\n\t\tif (this.fontWeight !== null)\n\t\t{\n\t\t\treturn this.fontWeight;\n\t\t}\n\t\telse if (this.getSelector().getTagFontWeight() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagFontWeight();\n\t\t}\n\n\t\treturn this.getEntityTagOption('fontWeight');\n\t}\n\n\tsetFontWeight(fontWeight: ?string): void\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.fontWeight = fontWeight;\n\t\t}\n\t}\n\n\tgetMaxWidth(): ?number\n\t{\n\t\tif (this.maxWidth !== null)\n\t\t{\n\t\t\treturn this.maxWidth;\n\t\t}\n\t\telse if (this.getSelector().getTagMaxWidth() !== null)\n\t\t{\n\t\t\treturn this.getSelector().getTagMaxWidth();\n\t\t}\n\n\t\treturn this.getEntityTagOption('maxWidth');\n\t}\n\n\tsetMaxWidth(width: ?number): void\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.maxWidth = width;\n\t\t}\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.deselectable = flag;\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable !== null ? this.deselectable : this.getSelector().isDeselectable();\n\t}\n\n\tgetCustomData(): Map<string, any>\n\t{\n\t\treturn this.customData;\n\t}\n\n\tgetLink(): ?string\n\t{\n\t\treturn this.link;\n\t}\n\n\tgetOnclick(): ?Function\n\t{\n\t\treturn this.onclick;\n\t}\n\n\trender(): void\n\t{\n\t\tconst titleNode = this.getTitleNode();\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.renderTo(this.getTitleContainer());\n\n\t\t\t//Dom.attr(this.getContentContainer(), 'title', this.getTitle());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getTitleContainer().textContent = '';\n\t\t\tDom.attr(this.getContentContainer(), 'title', '');\n\t\t}\n\n\t\tconst avatar = this.getAvatar();\n\t\tconst bgImage = this.getAvatarOption('bgImage');\n\t\tif (Type.isStringFilled(avatar))\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', `url('${encodeUrl(avatar)}')`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getAvatarContainer(), 'background-image', bgImage);\n\t\t}\n\n\t\tconst bgColor = this.getAvatarOption('bgColor');\n\t\tconst bgSize = this.getAvatarOption('bgSize');\n\t\tconst border = this.getAvatarOption('border');\n\t\tconst borderRadius = this.getAvatarOption('borderRadius');\n\n\t\tDom.style(this.getAvatarContainer(), 'background-color', bgColor);\n\t\tDom.style(this.getAvatarContainer(), 'background-size', bgSize);\n\t\tDom.style(this.getAvatarContainer(), 'border', border);\n\t\tDom.style(this.getAvatarContainer(), 'border-radius', borderRadius);\n\n\t\tconst hasAvatar = avatar || (bgColor && bgColor !== 'none') || (bgImage && bgImage !== 'none');\n\t\tif (hasAvatar)\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--has-avatar');\n\t\t}\n\n\t\tconst maxWidth = this.getMaxWidth();\n\t\tif (maxWidth > 0)\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', `${maxWidth}px`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getContainer(), 'max-width', null);\n\t\t}\n\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag-readonly');\n\t\t}\n\n\t\tDom.style(this.getTitleContainer(), 'color', this.getTextColor());\n\t\tDom.style(this.getTitleContainer(), 'font-weight', this.getFontWeight());\n\t\tDom.style(this.getContainer(), 'background-color', this.getBgColor());\n\n\t\tthis.rendered = true;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-item ui-tag-selector-tag\">\n\t\t\t\t\t${this.getContentContainer()}\n\t\t\t\t\t${this.getRemoveIcon()}\n\t\t\t\t</div>`\n\t\t\t;\n\t\t});\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('content-container', () => {\n\t\t\tif (Type.isStringFilled(this.getLink()))\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"ui-tag-selector-tag-content\"\n\t\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t\thref=\"${this.getLink()}\"\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst className = Type.isFunction(this.getOnclick()) ? ' ui-tag-selector-tag-content--clickable' : '';\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"ui-tag-selector-tag-content${className}\" \n\t\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${this.getAvatarContainer()}\n\t\t\t\t\t\t${this.getTitleContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t`;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetAvatarContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-avatar\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-title\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetRemoveIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('remove-icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-tag-remove\" onclick=\"${this.handleRemoveIconClick.bind(this)}\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetEntityTagOption(option: string): any\n\t{\n\t\treturn Entity.getTagOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tgetEntityItemOption(option: string): any\n\t{\n\t\treturn Entity.getItemOption(this.getEntityId(), option, this.getEntityType());\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered && this.getSelector() && this.getSelector().isRendered();\n\t}\n\n\tremove(animate: boolean = true): Promise\n\t{\n\t\tif (animate === false)\n\t\t{\n\t\t\tDom.remove(this.getContainer());\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise(resolve => {\n\t\t\tDom.style(this.getContainer(), 'width', `${this.getContainer().offsetWidth}px`);\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--remove');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-remove').then(() => {\n\t\t\t\tDom.remove(this.getContainer());\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(): Promise\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\tAnimation.handleAnimationEnd(this.getContainer(), 'ui-tag-selector-tag-show').then(() => {\n\t\t\t\tDom.removeClass(this.getContainer(), 'ui-tag-selector-tag--show');\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\thandleContainerClick(): void\n\t{\n\t\tconst fn = this.getOnclick();\n\t\tif (Type.isFunction(fn))\n\t\t{\n\t\t\tfn(this);\n\t\t}\n\t}\n\n\thandleRemoveIconClick(event: MouseEvent): void\n\t{\n\t\tevent.stopPropagation();\n\t\tif (this.isDeselectable())\n\t\t{\n\t\t\tthis.getSelector().removeTag(this);\n\t\t}\n\t}\n}","import { Cache, Dom, Tag, Text, Type, Loc, Browser } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport Dialog from '../dialog/dialog';\nimport TagItem from './tag-item';\n\nimport type { TagSelectorOptions } from './tag-selector-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { TagItemOptions } from './tag-item-options';\nimport type { AvatarOptions } from '../item/avatar-options';\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class TagSelector extends EventEmitter\n{\n\ttags: TagItem[] = [];\n\tcache = new Cache.MemoryCache();\n\trendered: false;\n\n\tmultiple: boolean = true;\n\treadonly: boolean = false;\n\tlocked: boolean = false;\n\tdeselectable: boolean = true;\n\n\taddButtonCaption: ?string = null;\n\taddButtonCaptionMore: ?string = null;\n\tcreateButtonCaption: ?string = null;\n\taddButtonVisible: boolean = true;\n\tcreateButtonVisible: boolean = false;\n\ttextBoxVisible: boolean = false;\n\ttextBoxWidth: string | number | null = null;\n\tmaxHeight: ?number = null;\n\n\tplaceholder: string = '';\n\ttextBoxAutoHide: boolean = false;\n\ttextBoxOldValue = '';\n\n\ttagAvatar: ?string = null;\n\ttagAvatarOptions: ?AvatarOptions = null;\n\ttagTextColor: ?string = null;\n\ttagBgColor: ?string = null;\n\ttagFontWeight: ?string = null;\n\ttagMaxWidth: ?number = null;\n\n\tdialog: ?Dialog = null;\n\n\tconstructor(selectorOptions: TagSelectorOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.TagSelector');\n\n\t\tconst options = Type.isPlainObject(selectorOptions) ? selectorOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-tag-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\n\t\tthis.addButtonVisible = options.showAddButton !== false;\n\t\tthis.createButtonVisible = options.showCreateButton === true;\n\t\tthis.textBoxVisible = options.showTextBox === true;\n\n\t\tthis.setReadonly(options.readonly);\n\t\tthis.setLocked(options.locked);\n\t\tthis.setAddButtonCaption(options.addButtonCaption);\n\t\tthis.setAddButtonCaptionMore(options.addButtonCaptionMore);\n\t\tthis.setCreateButtonCaption(options.createButtonCaption);\n\t\tthis.setPlaceholder(options.placeholder);\n\t\tthis.setTextBoxAutoHide(options.textBoxAutoHide);\n\t\tthis.setTextBoxWidth(options.textBoxWidth);\n\t\tthis.setDeselectable(options.deselectable);\n\t\tthis.setMaxHeight(options.maxHeight);\n\n\t\tthis.setTagAvatar(options.tagAvatar);\n\t\tthis.setTagAvatarOptions(options.tagAvatarOptions);\n\t\tthis.setTagMaxWidth(options.tagMaxWidth);\n\t\tthis.setTagTextColor(options.tagTextColor);\n\t\tthis.setTagBgColor(options.tagBgColor);\n\t\tthis.setTagFontWeight(options.tagFontWeight);\n\n\t\tif (Type.isPlainObject(options.dialogOptions))\n\t\t{\n\t\t\tlet selectedItems = Type.isArray(options.items) ? options.items : [];\n\t\t\tif (Type.isArray(options.dialogOptions.selectedItems))\n\t\t\t{\n\t\t\t\tselectedItems = selectedItems.concat(options.dialogOptions.selectedItems);\n\t\t\t}\n\n\t\t\tconst dialogOptions = Object.assign(\n\t\t\t\t{},\n\t\t\t\toptions.dialogOptions,\n\t\t\t\t{\n\t\t\t\t\ttagSelectorOptions: null,\n\t\t\t\t\tselectedItems,\n\t\t\t\t\tmultiple: this.isMultiple(),\n\t\t\t\t\ttagSelector: this\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t(new Dialog(dialogOptions));\n\t\t}\n\t\telse if (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((item) => {\n\t\t\t\tthis.addTag(item);\n\t\t\t});\n\t\t}\n\n\t\tthis.subscribeFromOptions(options.events);\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\t/**\n\t * @internal\n\t * @param dialog\n\t */\n\tsetDialog(dialog: ?Dialog): void\n\t{\n\t\tthis.dialog = dialog;\n\t}\n\n\tsetReadonly(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.readonly = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-readonly');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisReadonly(): boolean\n\t{\n\t\treturn this.readonly;\n\t}\n\n\tsetLocked(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.locked = flag;\n\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\tthis.getTextBox().disabled = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getOuterContainer(), 'ui-tag-selector-container-locked');\n\t\t\t\tthis.getTextBox().disabled = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tlock(): void\n\t{\n\t\tif (!this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(true);\n\t\t}\n\t}\n\n\tunlock(): void\n\t{\n\t\tif (this.isLocked())\n\t\t{\n\t\t\tthis.setLocked(false);\n\t\t}\n\t}\n\n\tisLocked(): boolean\n\t{\n\t\treturn this.locked;\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetDeselectable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tconst changed = this.deselectable !== flag;\n\t\t\tthis.deselectable = flag;\n\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\tthis.updateTags();\n\t\t\t}\n\t\t}\n\t}\n\n\tisDeselectable(): boolean\n\t{\n\t\treturn this.deselectable;\n\t}\n\n\tgetTag(tagItem: TagItem | ItemOptions): ?TagItem\n\t{\n\t\tif (tagItem instanceof TagItem)\n\t\t{\n\t\t\treturn this.getTags().find(tag => tag === tagItem);\n\t\t}\n\t\telse if (Type.isPlainObject(tagItem))\n\t\t{\n\t\t\tconst { id, entityId } = tagItem;\n\t\t\treturn this.getTags().find((tag: TagItem) => tag.getId() === id && tag.getEntityId() === entityId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddTag(tagOptions: TagItemOptions): ?TagItem\n\t{\n\t\tif (!Type.isObjectLike(tagOptions))\n\t\t{\n\t\t\tthrow new Error('TagSelector.addTag: wrong item options.');\n\t\t}\n\n\t\tif (this.getTag(tagOptions))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst tag = new TagItem(tagOptions);\n\t\ttag.setSelector(this);\n\n\t\tconst event = new BaseEvent({ data: { tag } });\n\t\tthis.emit('onBeforeTagAdd', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.removeTags();\n\t\t}\n\n\t\tthis.tags.push(tag);\n\n\t\tthis.emit('onTagAdd', { tag });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\n\t\t\tif (tagOptions.animate !== false)\n\t\t\t{\n\t\t\t\ttag.show().then(() => {\n\t\t\t\t\tthis.getContainer().scrollTop = this.getContainer().scrollHeight - this.getContainer().offsetHeight;\n\t\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t\t}\n\n\t\t\tthis.toggleAddButtonCaption();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagAdd', { tag });\n\t\t}\n\n\t\treturn tag;\n\t}\n\n\tremoveTag(item: TagItem | ItemOptions, animate = true): void\n\t{\n\t\tconst tagItem = this.getTag(item);\n\t\tif (!tagItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { tag: tagItem } });\n\t\tthis.emit('onBeforeTagRemove', event);\n\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tags = this.tags.filter(el => el !== tagItem);\n\n\t\tthis.emit('onTagRemove', { tag: tagItem });\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\ttagItem.remove(animate).then(() => {\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('onAfterTagRemove', { tag: tagItem });\n\t\t}\n\t}\n\n\tremoveTags(): void\n\t{\n\t\tthis.getTags().forEach(tag => {\n\t\t\tthis.removeTag(tag, false);\n\t\t});\n\t}\n\n\tgetTags(): TagItem[]\n\t{\n\t\treturn this.tags;\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tthis.rendered = true;\n\n\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\ttag.render();\n\t\t\tthis.getItemsContainer().insertBefore(tag.getContainer(), this.getTextBox());\n\t\t});\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tDom.append(this.getOuterContainer(), node);\n\t\t}\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tupdateTags(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getTags().forEach((tag: TagItem) => {\n\t\t\t\ttag.render();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOuterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('outer-container', () => {\n\t\t\tlet className = this.isReadonly() ? ' ui-tag-selector-container-readonly' : '';\n\t\t\tclassName += this.isLocked() ? ' ui-tag-selector-container-locked' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-outer-container${className}\">${this.getContainer()}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\tconst style =\n\t\t\t\tthis.getMaxHeight()\n\t\t\t\t\t? ` style=\"max-height: ${this.getMaxHeight()}px; -ms-overflow-style: -ms-autohiding-scrollbar;\"`\n\t\t\t\t\t: ''\n\t\t\t;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-tag-selector-container\" \n\t\t\t\t\tonclick=\"${this.handleContainerClick.bind(this)}\"\n\t\t\t\t\t${style}\n\t\t\t\t>\n\t\t\t\t\t${this.getItemsContainer()}\n\t\t\t\t\t${this.getCreateButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('items-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-items\">\n\t\t\t\t\t${this.getTextBox()}\n\t\t\t\t\t${this.getAddButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTextBox(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('text-box', () => {\n\t\t\tconst className = this.textBoxVisible ? '' : ' ui-tag-selector-item-hidden';\n\t\t\tconst input = Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"ui-tag-selector-item ui-tag-selector-text-box${className}\" \n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\toninput=\"${this.handleTextBoxInput.bind(this)}\"\n\t\t\t\t\tonblur=\"${this.handleTextBoxBlur.bind(this)}\"\n\t\t\t\t\tonkeyup=\"${this.handleTextBoxKeyUp.bind(this)}\"\n\t\t\t\t\tonkeydown=\"${this.handleTextBoxKeyDown.bind(this)}\"\n\t\t\t\t\tvalue=\"\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tconst width = this.getTextBoxWidth();\n\t\t\tif (width !== null)\n\t\t\t{\n\t\t\t\tDom.style(input, 'width', Type.isStringFilled(width) ? width : `${width}px`);\n\t\t\t}\n\n\t\t\tif (this.isLocked())\n\t\t\t{\n\t\t\t\tinput.disabled = true;\n\t\t\t}\n\n\t\t\treturn input;\n\t\t});\n\t}\n\n\tgetItemsHeight(): number\n\t{\n\t\treturn this.getItemsContainer().scrollHeight;\n\t}\n\n\tcalcHeight(): number\n\t{\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\treturn Math.min(this.getItemsHeight(), this.getMaxHeight());\n\t\t}\n\n\t\treturn Math.max(this.getItemsHeight(), this.getMinHeight());\n\t}\n\n\tgetTextBoxValue(): string\n\t{\n\t\treturn this.getTextBox().value;\n\t}\n\n\tclearTextBox(): void\n\t{\n\t\tthis.getTextBox().value = '';\n\t\tthis.textBoxOldValue = '';\n\t}\n\n\tshowTextBox(): void\n\t{\n\t\tthis.textBoxVisible = true;\n\t\tDom.removeClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideTextBox(): void\n\t{\n\t\tthis.textBoxVisible = false;\n\t\tDom.addClass(this.getTextBox(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tfocusTextBox(): void\n\t{\n\t\tthis.getTextBox().focus();\n\t}\n\n\tsetTextBoxAutoHide(autoHide: boolean): void\n\t{\n\t\tif (Type.isBoolean(autoHide))\n\t\t{\n\t\t\tthis.textBoxAutoHide = autoHide;\n\t\t}\n\t}\n\n\tgetTextBoxWidth(): string | number | null\n\t{\n\t\treturn this.textBoxWidth;\n\t}\n\n\tsetTextBoxWidth(width: string | number | null): void\n\t{\n\t\tif (Type.isStringFilled(width) || width === null)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'width', width);\n\t\t\t}\n\t\t}\n\t\telse if (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.textBoxWidth = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getTextBox(), 'width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTagMaxWidth(): ?number\n\t{\n\t\treturn this.tagMaxWidth;\n\t}\n\n\tsetTagMaxWidth(width: ?number): void\n\t{\n\t\tif ((Type.isNumber(width) && width >= 0) || width === null)\n\t\t{\n\t\t\tthis.tagMaxWidth = width;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagAvatar(): ?string\n\t{\n\t\treturn this.tagAvatar;\n\t}\n\n\tsetTagAvatar(tagAvatar: ?string): void\n\t{\n\t\tif (Type.isString(tagAvatar) || tagAvatar === null)\n\t\t{\n\t\t\tthis.tagAvatar = tagAvatar;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagAvatarOptions(): ?AvatarOptions\n\t{\n\t\treturn this.tagAvatarOptions;\n\t}\n\n\tgetTagAvatarOption(option: $Keys<AvatarOptions>): string | boolean | number | null\n\t{\n\t\tif (this.tagAvatarOptions !== null && !Type.isUndefined(this.tagAvatarOptions[option]))\n\t\t{\n\t\t\treturn this.tagAvatarOptions[option];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetTagAvatarOption(option: $Keys<AvatarOptions>, value: string | boolean | number | null): void\n\t{\n\t\tif (Type.isStringFilled(option) && !Type.isUndefined(value))\n\t\t{\n\t\t\tif (this.tagAvatarOptions === null)\n\t\t\t{\n\t\t\t\tthis.tagAvatarOptions = {};\n\t\t\t}\n\n\t\t\tthis.tagAvatarOptions[option] = value;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tsetTagAvatarOptions(options: AvatarOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tObject.keys(options).forEach((option: string) => {\n\t\t\t\tthis.setTagAvatarOption(option, options[option]);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetTagTextColor(): ?string\n\t{\n\t\treturn this.tagTextColor;\n\t}\n\n\tsetTagTextColor(textColor: ?string): void\n\t{\n\t\tif (Type.isString(textColor) || textColor === null)\n\t\t{\n\t\t\tthis.tagTextColor = textColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagBgColor(): ?string\n\t{\n\t\treturn this.tagBgColor;\n\t}\n\n\tsetTagBgColor(bgColor: ?string): void\n\t{\n\t\tif (Type.isString(bgColor) || bgColor === null)\n\t\t{\n\t\t\tthis.tagBgColor = bgColor;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetTagFontWeight(): ?string\n\t{\n\t\treturn this.tagFontWeight;\n\t}\n\n\tsetTagFontWeight(fontWeight: ?string): void\n\t{\n\t\tif (Type.isString(fontWeight) || fontWeight === null)\n\t\t{\n\t\t\tthis.tagFontWeight = fontWeight;\n\t\t\tthis.updateTags();\n\t\t}\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn this.placeholder;\n\t}\n\n\tsetPlaceholder(placeholder: string): void\n\t{\n\t\tif (Type.isStringFilled(placeholder))\n\t\t{\n\t\t\tthis.placeholder = placeholder;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTextBox().placeholder = placeholder;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMaxHeight(): ?number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn 33;\n\t}\n\n\tsetMaxHeight(height: ?number): void\n\t{\n\t\tif ((Type.isNumber(height) && height > 0) || height === null)\n\t\t{\n\t\t\tthis.maxHeight = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'max-height', height > 0 ? `${height}px` : null);\n\t\t\t\tDom.style(this.getContainer(), '-ms-overflow-style', height > 0 ? '-ms-autohiding-scrollbar' : null);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('add-button', () => {\n\t\t\tconst className = this.addButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-tag-selector-item ui-tag-selector-add-button${className}\">\n\t\t\t\t\t${this.getAddButtonLink()}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddButtonLink(): HTMLElement\n\t{\n\t\treturn this.cache.remember('add-button-link', () => {\n\t\t\tconst caption = Text.encode(this.getActualButtonCaption());\n\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"ui-tag-selector-add-button-caption\" \n\t\t\t\t\tonclick=\"${this.handleAddButtonClick.bind(this)}\">${caption}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t: this.addButtonCaption\n\t\t);\n\t}\n\n\tsetAddButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAddButtonCaptionMore(): ?string\n\t{\n\t\treturn (\n\t\t\tthis.addButtonCaptionMore === null\n\t\t\t\t? this.isMultiple()\n\t\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION')\n\t\t\t\t\t: Loc.getMessage('UI_TAG_SELECTOR_ADD_BUTTON_CAPTION_SINGLE')\n\t\t\t\t: this.addButtonCaptionMore\n\t\t);\n\t}\n\n\tsetAddButtonCaptionMore(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.addButtonCaptionMore = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.toggleAddButtonCaption();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleAddButtonCaption(): void\n\t{\n\t\tif (this.getAddButtonCaptionMore() === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getAddButtonLink().textContent = this.getActualButtonCaption();\n\t}\n\n\tgetActualButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.getTags().length > 0 && this.getAddButtonCaptionMore() !== null\n\t\t\t\t? this.getAddButtonCaptionMore()\n\t\t\t\t: this.getAddButtonCaption()\n\t\t);\n\t}\n\n\tshowAddButton(): void\n\t{\n\t\tthis.addButtonVisible = true;\n\t\tDom.removeClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideAddButton(): void\n\t{\n\t\tthis.addButtonVisible = false;\n\t\tDom.addClass(this.getAddButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('create-button', () => {\n\t\t\tconst className = this.createButtonVisible ? '' : ' ui-tag-selector-item-hidden';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-tag-selector-create-button${className}\">\n\t\t\t\t\t<span \n\t\t\t\t\t\tclass=\"ui-tag-selector-create-button-caption\"\n\t\t\t\t\t\tonclick=\"${this.handleCreateButtonClick.bind(this)}\"\n\t\t\t\t\t>${Text.encode(this.getCreateButtonCaption())}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = true;\n\t\tDom.removeClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\thideCreateButton(): void\n\t{\n\t\tthis.createButtonVisible = false;\n\t\tDom.addClass(this.getCreateButton(), 'ui-tag-selector-item-hidden');\n\t}\n\n\tgetCreateButtonCaption(): string\n\t{\n\t\treturn (\n\t\t\tthis.createButtonCaption === null\n\t\t\t\t? Loc.getMessage('UI_TAG_SELECTOR_CREATE_BUTTON_CAPTION')\n\t\t\t\t: this.createButtonCaption\n\t\t);\n\t}\n\n\tsetCreateButtonCaption(caption: string): void\n\t{\n\t\tif (Type.isStringFilled(caption))\n\t\t{\n\t\t\tthis.createButtonCaption = caption;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getCreateButton().children[0].textContent = caption;\n\t\t\t}\n\t\t}\n\t}\n\n\thandleContainerClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onContainerClick', { event });\n\t}\n\n\thandleTextBoxInput(event: InputEvent): void\n\t{\n\t\tconst newValue = this.getTextBoxValue();\n\t\tif (newValue !== this.textBoxOldValue)\n\t\t{\n\t\t\tthis.textBoxOldValue = newValue;\n\t\t\tthis.emit('onInput', { event });\n\t\t}\n\t}\n\n\thandleTextBoxBlur(event: FocusEvent): void\n\t{\n\t\tthis.emit('onBlur', { event });\n\n\t\tif (this.textBoxAutoHide)\n\t\t{\n\t\t\tthis.clearTextBox();\n\t\t\tthis.showAddButton();\n\t\t\tthis.hideTextBox();\n\t\t}\n\t}\n\n\thandleTextBoxKeyUp(event: KeyboardEvent): void\n\t{\n\t\tthis.emit('onKeyUp', { event });\n\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.emit('onEnter', { event });\n\n\t\t\tif (this.textBoxAutoHide)\n\t\t\t{\n\t\t\t\tthis.clearTextBox();\n\t\t\t\tthis.showAddButton();\n\t\t\t\tthis.hideTextBox();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleTextBoxKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tthis.emit('onMetaEnter', { event });\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onKeyDown', { event });\n\t}\n\n\thandleAddButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.hideAddButton();\n\t\tthis.showTextBox();\n\t\tthis.focusTextBox();\n\n\t\tthis.emit('onAddButtonClick', { event });\n\t}\n\n\thandleCreateButtonClick(event: MouseEvent): void\n\t{\n\t\tthis.emit('onCreateButtonClick', { event });\n\t}\n}","import { Event } from 'main.core';\nimport type ItemNode from '../item/item-node';\nimport type Tab from './tabs/tab';\nimport type Dialog from './dialog';\n\nexport default class Navigation\n{\n\tdialog: Dialog = null;\n\tlockedTab: Tab = null;\n\tenabled: boolean = false;\n\n\t// IE/Edge compatible event names\n\tstatic keyMap: Object<string, string> = {\n\t\t'Down': 'ArrowDown',\n\t\t'Up': 'ArrowUp',\n\t\t'Left': 'ArrowLeft',\n\t\t'Right': 'ArrowRight',\n\t\t'Spacebar': 'Space',\n\t\t' ': 'Space' // For all browsers\n\t};\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleDocumentKeyDown = this.handleDocumentKeyDown.bind(this);\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tenable(): void\n\t{\n\t\tif (!this.isEnabled())\n\t\t{\n\t\t\tthis.bindEvents();\n\t\t}\n\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(): void\n\t{\n\t\tif (this.isEnabled())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.enabled = false;\n\t}\n\n\tisEnabled(): boolean\n\t{\n\t\treturn this.enabled;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEvent.bind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.handleDocumentKeyDown);\n\t}\n\n\tgetNextNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet nextNode = null;\n\t\tlet currentNode = this.getActiveNode();\n\n\t\tif (currentNode.hasChildren() && currentNode.isOpen())\n\t\t{\n\t\t\tnextNode = currentNode.getFirstChild();\n\t\t}\n\n\t\twhile (nextNode === null && currentNode !== null)\n\t\t{\n\t\t\tnextNode = currentNode.getNextSibling();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcurrentNode = currentNode.getParentNode();\n\t\t}\n\n\t\treturn nextNode;\n\t}\n\n\tgetPreviousNode(): ?ItemNode\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet previousNode = this.getActiveNode().getPreviousSibling();\n\t\tif (previousNode)\n\t\t{\n\t\t\twhile (previousNode.hasChildren() && previousNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = previousNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tpreviousNode = lastChild;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getActiveNode().getParentNode() && !this.getActiveNode().getParentNode().isRoot())\n\t\t\t{\n\t\t\t\tpreviousNode = this.getActiveNode().getParentNode();\n\t\t\t}\n\t\t}\n\n\t\treturn previousNode;\n\t}\n\n\tgetFirstNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\treturn tab && tab.getRootNode().getFirstChild();\n\t}\n\n\tgetLastNode(): ?ItemNode\n\t{\n\t\tconst tab = this.getDialog().getActiveTab();\n\t\tif (!tab)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet lastNode = tab.getRootNode().getLastChild();\n\t\tif (lastNode !== null)\n\t\t{\n\t\t\twhile (lastNode.hasChildren() && lastNode.isOpen())\n\t\t\t{\n\t\t\t\tconst lastChild = lastNode.getLastChild();\n\t\t\t\tif (lastChild === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tlastNode = lastChild;\n\t\t\t}\n\t\t}\n\n\t\treturn lastNode;\n\t}\n\n\tgetActiveNode(): ?ItemNode\n\t{\n\t\treturn this.getDialog().getFocusedNode();\n\t}\n\n\tfocusOnNode(node: ItemNode): void\n\t{\n\t\tif (node)\n\t\t{\n\t\t\tnode.focus();\n\t\t\tnode.scrollIntoView();\n\t\t}\n\t}\n\n\tlockTab(): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (this.lockedTab === activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\telse if (this.lockedTab !== null)\n\t\t{\n\t\t\tthis.unlockTab();\n\t\t}\n\n\t\tthis.lockedTab = activeTab;\n\t\tthis.lockedTab.lock();\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\tunlockTab(): void\n\t{\n\t\tif (this.lockedTab === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lockedTab.unlock();\n\t\tthis.lockedTab = null;\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t}\n\n\thandleDialogShow(): void\n\t{\n\t\tthis.enable();\n\t}\n\n\thandleDialogHide(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.disable();\n\t}\n\n\thandleDocumentMouseMove(): void\n\t{\n\t\tthis.unlockTab();\n\t}\n\n\thandleDocumentKeyDown(event: KeyboardEvent): void\n\t{\n\t\tif (!this.getDialog().isOpen())\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.metaKey || event.ctrlKey || event.altKey)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst keyName = this.constructor.keyMap[event.key] || event.key;\n\t\tif (activeTab === this.getDialog().getSearchTab() && ['ArrowLeft', 'ArrowRight'].includes(keyName))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler: ?Function = this[`handle${keyName}Press`];\n\t\tif (handler)\n\t\t{\n\t\t\thandler.call(this, event);\n\t\t\tthis.lockTab(activeTab);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\thandleArrowDownPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst firstNode = this.getFirstNode();\n\t\t\tthis.focusOnNode(firstNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextNode = this.getNextNode();\n\t\t\tif (nextNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(nextNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst firstNode = this.getFirstNode();\n\t\t\t\tthis.focusOnNode(firstNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowUpPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\tconst lastNode = this.getLastNode();\n\t\t\tthis.focusOnNode(lastNode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst previousNode = this.getPreviousNode();\n\t\t\tif (previousNode)\n\t\t\t{\n\t\t\t\tthis.focusOnNode(previousNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst lastNode = this.getLastNode();\n\t\t\t\tthis.focusOnNode(lastNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleArrowRightPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().expand();\n\t\t}\n\t}\n\n\thandleArrowLeftPress(): void\n\t{\n\t\tif (!this.getActiveNode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveNode().isOpen())\n\t\t{\n\t\t\tthis.getActiveNode().collapse();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst parentNode = this.getActiveNode().getParentNode();\n\t\t\tif (parentNode && !parentNode.isRoot())\n\t\t\t{\n\t\t\t\tthis.focusOnNode(parentNode);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleEnterPress(): void\n\t{\n\t\tif (this.getActiveNode())\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t}\n\t}\n\n\t/*handleSpacePress(event: KeyboardEvent): void\n\t{\n\t\tconst searchQuery = this.getDialog().getTagSelector() && this.getDialog().getTagSelector().getTextBoxValue();\n\t\tif (this.getActiveNode() && !Type.isStringFilled(searchQuery))\n\t\t{\n\t\t\tthis.getActiveNode().click();\n\t\t\tevent.preventDefault();\n\t\t}\n\t}*/\n\n\thandleTabPress(event: KeyboardEvent): void\n\t{\n\t\tconst activeTab = this.getDialog().getActiveTab();\n\t\tif (!activeTab)\n\t\t{\n\t\t\tthis.getDialog().selectFirstTab();\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.shiftKey)\n\t\t{\n\t\t\tconst previousTab = this.getDialog().getPreviousTab();\n\t\t\tif (previousTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(previousTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectLastTab();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst nextTab = this.getDialog().getNextTab();\n\t\t\tif (nextTab)\n\t\t\t{\n\t\t\t\tthis.getDialog().selectTab(nextTab.getId());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n}","import type { BaseEvent } from 'main.core.events';\nimport type Dialog from '../dialog';\n\nexport default class SliderIntegration\n{\n\tdialog: Dialog = null;\n\tsliders: Set = new Set();\n\n\tconstructor(dialog: Dialog)\n\t{\n\t\tthis.dialog = dialog;\n\n\t\tthis.dialog.subscribe('onShow', this.handleDialogShow.bind(this));\n\t\tthis.dialog.subscribe('onHide', this.handleDialogHide.bind(this));\n\t\tthis.dialog.subscribe('onDestroy', this.handleDialogDestroy.bind(this));\n\n\t\tthis.handleSliderOpen = this.handleSliderOpen.bind(this);\n\t\tthis.handleSliderClose = this.handleSliderClose.bind(this);\n\t\tthis.handleSliderDestroy = this.handleSliderDestroy.bind(this);\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\treturn this.dialog;\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tthis.unbindEvents();\n\n\t\tif (top.BX)\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onDestroy', this.handleSliderDestroy);\n\t\t}\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tif (top.BX)\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onOpen', this.handleSliderOpen);\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onCloseComplete', this.handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.unsubscribe('SidePanel.Slider:onDestroy', this.handleSliderDestroy);\n\t\t}\n\t}\n\n\tisDialogInSlider(slider): boolean\n\t{\n\t\tif (slider.getFrameWindow())\n\t\t{\n\t\t\treturn slider.getFrameWindow().document.contains(this.getDialog().getContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn  slider.getContainer().contains(this.getDialog().getContainer());\n\t\t}\n\t}\n\n\thandleDialogShow(): void\n\t{\n\t\tthis.bindEvents();\n\t}\n\n\thandleDialogHide(): void\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t\tthis.getDialog().unfreeze();\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.sliders.clear();\n\t\tthis.unbindEvents();\n\t\tthis.getDialog().unfreeze();\n\t}\n\n\thandleSliderOpen(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tif (!this.isDialogInSlider(slider))\n\t\t{\n\t\t\tthis.sliders.add(slider);\n\t\t\tthis.getDialog().freeze();\n\t\t}\n\t}\n\n\thandleSliderClose(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tthis.sliders.delete(slider);\n\t\tif (this.sliders.size === 0)\n\t\t{\n\t\t\tthis.getDialog().unfreeze();\n\t\t}\n\t}\n\n\thandleSliderDestroy(event: BaseEvent): void\n\t{\n\t\tconst [sliderEvent] = event.getData();\n\t\tconst slider = sliderEvent.getSlider();\n\n\t\tif (this.isDialogInSlider(slider))\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t\tthis.dialog.destroy();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.sliders.delete(slider);\n\t\t\tif (this.sliders.size === 0)\n\t\t\t{\n\t\t\t\tthis.getDialog().unfreeze();\n\t\t\t}\n\t\t}\n\t}\n}","import { Dom, Tag, Type } from 'main.core';\nimport BaseHeader from './base-header';\nimport type Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { HeaderOptions } from './header-content';\n\nexport default class DefaultHeader extends BaseHeader\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(context: Dialog | Tab, options: HeaderOptions)\n\t{\n\t\tsuper(context, options);\n\n\t\tthis.setContent(this.getOption('content'));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\n\t\tconst className = this.getOption('containerClass', 'ui-selector-header-default');\n\t\tconst containerStyles = this.getOption('containerStyles', {});\n\n\t\tDom.addClass(container, className);\n\t\tDom.style(container, containerStyles);\n\n\t\treturn container;\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.content;\n\t}\n\n\tsetContent(content: string | HTMLElement | HTMLElement[]): void\n\t{\n\t\tif (Type.isStringFilled(content) || Type.isDomNode(content) || Type.isArrayFilled(content))\n\t\t{\n\t\t\tthis.content = content;\n\t\t}\n\t}\n}","import { Dom, Tag, Type } from 'main.core';\nimport BaseFooter from './base-footer';\nimport type Dialog from '../dialog';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class DefaultFooter extends BaseFooter\n{\n\tcontent: HTMLElement = null;\n\n\tconstructor(context: Dialog | Tab, options: FooterOptions)\n\t{\n\t\tsuper(context, options);\n\n\t\tthis.setContent(this.getOption('content'));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\n\t\tconst className = this.getOption('containerClass', 'ui-selector-footer-default');\n\t\tconst containerStyles = this.getOption('containerStyles', {});\n\n\t\tDom.addClass(container, className);\n\t\tDom.style(container, containerStyles);\n\n\t\treturn container;\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.content;\n\t}\n\n\tsetContent(content: string | HTMLElement | HTMLElement[]): void\n\t{\n\t\tif (Type.isStringFilled(content) || Type.isDomNode(content) || Type.isArrayFilled(content))\n\t\t{\n\t\t\tthis.content = content;\n\t\t}\n\t}\n}","import { Loc } from 'main.core';\nimport Tab from './tab';\nimport type { TabOptions } from './tab-options';\nimport type Dialog from '../dialog';\n\nexport default class RecentTab extends Tab\n{\n\tconstructor(dialog: Dialog, tabOptions: TabOptions)\n\t{\n\t\tconst icon =\n\t\t\t'data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2223%22%20height%3D%2223%22%20fill%3D%' +\n\t\t\t'22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20d%3D%22M14.432%2013.985a.96.' +\n\t\t\t'96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.96zM14.432%2011.' +\n\t\t\t'009a.96.96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.96zM14.' +\n\t\t\t'432%208.033a.96.96%200%2000-.96-.96H8.505a.96.96%200%20000%201.92h4.967c.53%200%20.96-.43.96-.' +\n\t\t\t'96z%22%20fill%3D%22%23ABB1B8%22/%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd' +\n\t\t\t'%22%20d%3D%22M10.988%2019.52c1.8%200%203.469-.558%204.844-1.51l2.205%202.204a1.525%201.525%200%20' +\n\t\t\t'102.157-2.157l-2.205-2.205a8.512%208.512%200%2010-7%203.668zm0-2.403a6.108%206.108%200%20100-12.2' +\n\t\t\t'16%206.108%206.108%200%20000%2012.216z%22%20fill%3D%22%23ABB1B8%22/%3E%3C/svg%3E'\n\t\t;\n\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_RECENT_TAB_TITLE'),\n\t\t\titemOrder: { sort: 'asc' },\n\t\t\tvisible: !dialog.isDropdownMode(),\n\t\t\tstub: !dialog.isDropdownMode(),\n\t\t\ticon: {\n\t\t\t\t//default: '/bitrix/js/ui/entity-selector/src/css/images/recent-tab-icon.svg',\n\t\t\t\t//selected: '/bitrix/js/ui/entity-selector/src/css/images/recent-tab-icon-selected.svg'\n\t\t\t\tdefault: icon,\n\t\t\t\tselected: icon.replace(/ABB1B8/g, 'fff'),\n\t\t\t}\n\t\t};\n\n\t\tconst options: TabOptions = Object.assign({}, defaults, tabOptions);\n\t\toptions.id = 'recents';\n\n\t\tsuper(dialog, options);\n\t}\n}","import MatchField from './match-field';\n\nimport type MatchIndex from './match-index';\nimport type SearchField from './search-field';\nimport type Item from '../item/item';\n\nexport default class MatchResult\n{\n\titem: Item = null;\n\tqueryWords: string[] = null;\n\tmatchFields: Map<SearchField, MatchField> = new Map();\n\tsort: ?number = null;\n\n\tconstructor(item: Item, queryWords: string[], matchIndexes: MatchIndex[] = [])\n\t{\n\t\tthis.item = item;\n\t\tthis.queryWords = queryWords;\n\t\tthis.addIndexes(matchIndexes);\n\t}\n\n\tgetItem(): Item\n\t{\n\t\treturn this.item;\n\t}\n\n\tgetQueryWords(): string[]\n\t{\n\t\treturn this.queryWords;\n\t}\n\n\tgetMatchFields(): Map<SearchField, MatchField>\n\t{\n\t\treturn this.matchFields;\n\t}\n\n\tgetSort(): ?number\n\t{\n\t\treturn this.sort;\n\t}\n\n\taddIndex(matchIndex: MatchIndex): void\n\t{\n\t\tlet matchField = this.matchFields.get(matchIndex.getField());\n\t\tif (!matchField)\n\t\t{\n\t\t\tmatchField = new MatchField(matchIndex.getField());\n\t\t\tthis.matchFields.set(matchIndex.getField(), matchField);\n\n\t\t\tconst fieldSort = matchIndex.getField().getSort();\n\t\t\tif (fieldSort !== null)\n\t\t\t{\n\t\t\t\tthis.sort = this.sort === null ? fieldSort : Math.min(this.sort, fieldSort);\n\t\t\t}\n\t\t}\n\n\t\tmatchField.addIndex(matchIndex);\n\t}\n\n\taddIndexes(matchIndexes: MatchIndex[]): void\n\t{\n\t\tmatchIndexes.forEach(matchIndex => {\n\t\t\tthis.addIndex(matchIndex);\n\t\t});\n\t}\n}","import MatchResult from './match-result';\nimport MatchIndex from './match-index';\n\nimport type SearchFieldIndex from './search-field-index';\nimport type Item from '../item/item';\nimport type SearchQuery from './search-query';\n\nconst collator = new Intl.Collator(undefined, { sensitivity: 'base' });\n\nexport default class SearchEngine\n{\n\tstatic matchItems(items: Item[], searchQuery: SearchQuery): MatchResult[]\n\t{\n\t\tconst matchResults = [];\n\t\tconst queryWords = searchQuery.getQueryWords();\n\t\tlet limit = searchQuery.getResultLimit();\n\n\t\tfor (let i = 0; i < items.length; i++)\n\t\t{\n\t\t\tif (limit === 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst item = items[i];\n\t\t\tif (item.isSelected() || !item.isSearchable() || item.isHidden() || !item.getEntity().isSearchable())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst matchResult = this.matchItem(item, queryWords);\n\t\t\tif (matchResult)\n\t\t\t{\n\t\t\t\tmatchResults.push(matchResult);\n\t\t\t\tlimit--;\n\t\t\t}\n\t\t}\n\n\t\treturn matchResults;\n\t}\n\n\tstatic matchItem(item: Item, queryWords: string[]): MatchResult\n\t{\n\t\tlet matches = [];\n\t\tfor (let i = 0; i < queryWords.length; i++)\n\t\t{\n\t\t\tconst queryWord = queryWords[i];\n\t\t\tconst results = this.matchWord(item, queryWord);\n\t\t\t//const match = this.matchWord(item, queryWord);\n\t\t\t//if (match === null)\n\t\t\tif (results.length === 0)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmatches = matches.concat(results);\n\t\t\t\t//matches.push(match);\n\t\t\t}\n\t\t}\n\n\t\tif (matches.length > 0)\n\t\t{\n\t\t\treturn new MatchResult(item, queryWords, matches);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic matchWord(item: Item, queryWord: string): MatchIndex[]\n\t{\n\t\tconst searchIndexes = item.getSearchIndex().getIndexes();\n\t\tconst matches = [];\n\n\t\tfor (let i = 0; i < searchIndexes.length; i++)\n\t\t{\n\t\t\tconst fieldIndex: SearchFieldIndex = searchIndexes[i];\n\t\t\tconst indexes = fieldIndex.getIndexes();\n\t\t\tfor (let j = 0; j < indexes.length; j++)\n\t\t\t{\n\t\t\t\tconst index = indexes[j];\n\t\t\t\tconst word = index.getWord().substring(0, queryWord.length);\n\t\t\t\tif (collator.compare(queryWord, word) === 0)\n\t\t\t\t{\n\t\t\t\t\tmatches.push(new MatchIndex(fieldIndex.getField(), queryWord, index.getStartIndex()));\n\t\t\t\t\t//return new MatchIndex(field, queryWord, index[i][1]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (matches.length > 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\treturn matches;\n\t\t//return null;\n\t}\n}","import { Type } from 'main.core';\n\nexport default class SearchQuery\n{\n\tqueryWords: string[] = [];\n\tquery: string = '';\n\tcacheable: boolean = true;\n\tdynamicSearchEntities: string[] = [];\n\tresultLimit: number = 100;\n\n\tconstructor(query: string)\n\t{\n\t\tthis.query = query.trim().replace(/\\s\\s+/g, ' ');\n\t\tthis.queryWords = Type.isStringFilled(this.query) ? this.query.split(' ') : [];\n\t}\n\n\tgetQueryWords(): string[]\n\t{\n\t\treturn this.queryWords;\n\t}\n\n\tgetQuery(): string\n\t{\n\t\treturn this.query;\n\t}\n\n\tisEmpty(): boolean\n\t{\n\t\treturn this.getQueryWords().length === 0;\n\t}\n\n\tsetCacheable(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.cacheable = flag;\n\t\t}\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetResultLimit(limit: number)\n\t{\n\t\tif (Type.isNumber(limit) && limit >= 0)\n\t\t{\n\t\t\tthis.resultLimit = limit;\n\t\t}\n\t}\n\n\tgetResultLimit(): number\n\t{\n\t\treturn this.resultLimit;\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().length > 0;\n\t}\n\n\thasDynamicSearchEntity(entityId: string): boolean\n\t{\n\t\treturn this.getDynamicSearchEntities().includes(entityId);\n\t}\n\n\tsetDynamicSearchEntities(entities: string[]): void\n\t{\n\t\tif (Type.isArrayFilled(entities))\n\t\t{\n\t\t\tentities.forEach((entityId: string) => {\n\t\t\t\tif (Type.isStringFilled(entityId) && !this.hasDynamicSearchEntity(entityId))\n\t\t\t\t{\n\t\t\t\t\tthis.dynamicSearchEntities.push(entityId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\tgetDynamicSearchEntities(): string[]\n\t{\n\t\treturn this.dynamicSearchEntities;\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn this.toJSON();\n\t}\n\n\ttoJSON(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tqueryWords: this.getQueryWords(),\n\t\t\tquery: this.getQuery(),\n\t\t\tdynamicSearchEntities: this.getDynamicSearchEntities(),\n\t\t};\n\t}\n}","import { Cache, Tag, Loc, Dom } from 'main.core';\nimport { Loader } from 'main.loader';\nimport type Tab from './tab';\n\nexport default class SearchLoader\n{\n\ttab: Tab = null;\n\tloader: Loader = null;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(tab: Tab)\n\t{\n\t\tthis.tab = tab;\n\t}\n\n\tgetTab(): Tab\n\t{\n\t\treturn this.tab;\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getIconContainer(),\n\t\t\t\tsize: 32\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader\">\n\t\t\t\t\t${this.getBoxContainer()}\n\t\t\t\t\t${this.getSpacerContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetBoxContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('box-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-box\">\n\t\t\t\t\t${this.getIconContainer()}\n\t\t\t\t\t${this.getTextContainer()}\n\t\t\t\t</div>`;\n\t\t});\n\t}\n\n\tgetIconContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-icon\"></div>`;\n\t\t});\n\t}\n\n\tgetTextContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('text', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-loader-text\">${\n\t\t\t\t\tLoc.getMessage('UI_SELECTOR_SEARCH_LOADER_TEXT')\n\t\t\t\t}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSpacerContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('spacer', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-search-loader-spacer\"></div>`;\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.getContainer().parentNode)\n\t\t{\n\t\t\tDom.append(this.getContainer(), this.getTab().getContainer());\n\t\t}\n\n\t\tvoid this.getLoader().show();\n\n\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--show');\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getContainer(), 'ui-selector-search-loader--animate');\n\t\t});\n\t}\n\n\thide(): void\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(\n\t\t\tthis.getContainer(),\n\t\t\t['ui-selector-search-loader--show', 'ui-selector-search-loader--animate']\n\t\t);\n\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.loader !== null && this.loader.isShown();\n\t}\n}","import { Tag, Browser, Loc, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport BaseFooter from '../footer/base-footer';\n\nimport type { BaseEvent } from 'main.core.events';\nimport type Tab from '../tabs/tab';\nimport type { FooterOptions } from './footer-content';\n\nexport default class SearchTabFooter extends BaseFooter\n{\n\tloader: Loader = null;\n\n\tconstructor(tab: Tab, options: FooterOptions)\n\t{\n\t\tsuper(tab, options);\n\n\t\tthis.getDialog().subscribe('onSearch', this.handleOnSearch.bind(this));\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.subscribe('onMetaEnter', this.handleMetaEnter.bind(this));\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer\" onclick=\"${this.handleClick.bind(this)}\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t${this.getLabelContainer()}\n\t\t\t\t\t${this.getQueryContainer()}\n\t\t\t\t\t${this.getLoaderContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-selector-search-footer-cmd\">${\n\t\t\t\t\tBrowser.isMac() ? '&#8984;+Enter'  : 'Ctrl+Enter'\n\t\t\t\t}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getLoaderContainer(),\n\t\t\t\tsize: 17,\n\t\t\t\tcolor: 'rgba(82, 92, 105, 0.9)'\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tvoid this.getLoader().hide();\n\t}\n\n\tsetLabel(label: string)\n\t{\n\t\tif (Type.isString(label))\n\t\t{\n\t\t\tthis.getLabelContainer().textContent = label;\n\t\t}\n\t}\n\n\tgetLabelContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('label', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-label\">${\n\t\t\t\t\tthis.getOption('label', Loc.getMessage('UI_SELECTOR_CREATE_ITEM_LABEL'))\n\t\t\t}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetQueryContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('name-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"ui-selector-search-footer-query\"></span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLoaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-search-footer-loader\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tcreateItem(): void\n\t{\n\t\tconst tagSelector = this.getDialog().getTagSelector();\n\t\tif (tagSelector && tagSelector.isLocked())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst finalize = () => {\n\t\t\tthis.hideLoader();\n\t\t\tif (this.getDialog().getTagSelector())\n\t\t\t{\n\t\t\t\tthis.getDialog().getTagSelector().unlock();\n\t\t\t\tthis.getDialog().focusSearch();\n\t\t\t}\n\t\t};\n\n\t\tevent.preventDefault();\n\t\tthis.showLoader();\n\n\t\tif (tagSelector)\n\t\t{\n\t\t\ttagSelector.lock();\n\t\t}\n\n\t\tthis.getDialog()\n\t\t\t.emitAsync('Search:onItemCreateAsync', {\n\t\t\t\tsearchQuery: this.getTab().getLastSearchQuery()\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.getTab().clearResults();\n\t\t\t\tthis.getDialog().clearSearch();\n\t\t\t\tif (this.getDialog().getActiveTab() === this.getTab())\n\t\t\t\t{\n\t\t\t\t\tthis.getDialog().selectFirstTab();\n\t\t\t\t}\n\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tfinalize();\n\t\t\t})\n\t\t;\n\t}\n\n\thandleClick(): void\n\t{\n\t\tthis.createItem();\n\t}\n\n\thandleMetaEnter(event: BaseEvent): void\n\t{\n\t\tif (this.getDialog().getActiveTab() !== this.getTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.handleClick();\n\t}\n\n\thandleOnSearch(event: BaseEvent): void\n\t{\n\t\tconst { query } = event.getData();\n\t\tthis.getQueryContainer().textContent = query;\n\t}\n}","import { Runtime, ajax as Ajax, Type, Loc } from 'main.core';\n\nimport Tab from './tab';\nimport SearchEngine from '../../search/search-engine';\nimport MatchResult from '../../search/match-result';\nimport SearchQuery from '../../search/search-query';\nimport SearchLoader from './search-loader';\nimport SearchTabFooter from '../footer/search-tab-footer';\n\nimport type { ItemOptions } from '../../item/item-options';\nimport type { TabOptions } from './tab-options';\nimport type Entity from '../../entity/entity';\nimport type Dialog from '../dialog';\nimport type { SearchOptions } from '../search-options';\n\nexport default class SearchTab extends Tab\n{\n\tlastSearchQuery: ?SearchQuery = null;\n\tqueryCache = new Set();\n\tqueryXhr = null;\n\tsearchLoader: SearchLoader = new SearchLoader(this);\n\tallowCreateItem: boolean = false;\n\n\tconstructor(dialog: Dialog, tabOptions: TabOptions, searchOptions: SearchOptions)\n\t{\n\t\tconst defaults = {\n\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_TAB_TITLE'),\n\t\t\tvisible: false,\n\t\t\tstub: true,\n\t\t\tstubOptions: {\n\t\t\t\tautoShow: false,\n\t\t\t\ttitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_TITLE'),\n\t\t\t\tsubtitle: Loc.getMessage('UI_SELECTOR_SEARCH_STUB_SUBTITLE')\n\t\t\t}\n\t\t};\n\n\t\tconst options: TabOptions = Object.assign({}, defaults, tabOptions);\n\t\toptions.id = 'search';\n\t\toptions.stubOptions.autoShow = false;\n\n\t\tsuper(dialog, options);\n\n\t\tsearchOptions = Type.isPlainObject(searchOptions) ? searchOptions : {};\n\t\tthis.setAllowCreateItem(searchOptions.allowCreateItem, searchOptions.footerOptions);\n\n\t\tthis.loadWithDebounce = Runtime.debounce(() => {\n\t\t\tthis.load(this.getLastSearchQuery());\n\t\t}, 500);\n\t}\n\n\tsearch(query: string)\n\t{\n\t\tconst searchQuery = new SearchQuery(query);\n\t\tconst dynamicEntities = this.getDynamicEntities(searchQuery);\n\t\tsearchQuery.setDynamicSearchEntities(dynamicEntities);\n\n\t\tif (searchQuery.isEmpty())\n\t\t{\n\t\t\tthis.getSearchLoader().hide();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lastSearchQuery = searchQuery;\n\n\t\tconst matchResults = SearchEngine.matchItems(this.getDialog().getItems(), searchQuery);\n\t\tthis.clearResults();\n\t\tthis.appendResults(matchResults);\n\n\t\tif (this.getDialog().shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t}\n\n\t\tif (this.shouldLoad(searchQuery))\n\t\t{\n\t\t\tthis.loadWithDebounce();\n\t\t\tif (!this.isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.getStub().hide();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!this.getSearchLoader().isShown())\n\t\t\t{\n\t\t\t\tthis.toggleEmptyResult();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLastSearchQuery(): ?SearchQuery\n\t{\n\t\treturn this.lastSearchQuery;\n\t}\n\n\tsetAllowCreateItem(flag: boolean, options?: { [option: string]: any }): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.allowCreateItem = flag;\n\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tthis.setFooter(SearchTabFooter, options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setFooter(null);\n\t\t\t}\n\t\t}\n\t}\n\n\tcanCreateItem(): boolean\n\t{\n\t\treturn this.allowCreateItem;\n\t}\n\n\tappendResults(matchResults: MatchResult[]): void\n\t{\n\t\tmatchResults.sort((a: MatchResult, b: MatchResult) => {\n\n\t\t\tconst matchSortA = a.getSort();\n\t\t\tconst matchSortB = b.getSort();\n\n\t\t\tif (matchSortA !== null && matchSortB !== null && matchSortA !== matchSortB)\n\t\t\t{\n\t\t\t\treturn matchSortA - matchSortB;\n\t\t\t}\n\t\t\tif (matchSortA !== null && matchSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse if (matchSortA === null && matchSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tconst contextSortA = a.getItem().getContextSort();\n\t\t\tconst contextSortB = b.getItem().getContextSort();\n\n\t\t\tif (contextSortA !== null && contextSortB === null)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse if (contextSortA === null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (contextSortA !== null && contextSortB !== null)\n\t\t\t{\n\t\t\t\treturn contextSortB - contextSortA;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst globalSortA = a.getItem().getGlobalSort();\n\t\t\t\tconst globalSortB = b.getItem().getGlobalSort();\n\n\t\t\t\tif (globalSortA !== null && globalSortB === null)\n\t\t\t\t{\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\telse if (globalSortA === null && globalSortB !== null)\n\t\t\t\t{\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\telse if (globalSortA !== null && globalSortB !== null)\n\t\t\t\t{\n\t\t\t\t\treturn globalSortB - globalSortA;\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tthis.getRootNode().disableRender();\n\n\t\tmatchResults.forEach((matchResult: MatchResult) => {\n\t\t\tconst item = matchResult.getItem();\n\t\t\tif (!this.getRootNode().hasItem(item))\n\t\t\t{\n\t\t\t\tconst node = this.getRootNode().addItem(item);\n\t\t\t\tnode.setHighlights(matchResult.getMatchFields());\n\t\t\t}\n\t\t});\n\n\t\tthis.getRootNode().enableRender();\n\t\tthis.getRootNode().render(true);\n\t}\n\n\tgetDynamicEntities(searchQuery: SearchQuery): string[]\n\t{\n\t\tconst result = [];\n\n\t\tthis.getDialog().getEntities().forEach((entity: Entity) => {\n\t\t\tif (entity.isSearchable())\n\t\t\t{\n\t\t\t\tconst hasCacheLimit = entity.getSearchCacheLimits().some((pattern: RegExp) => {\n\t\t\t\t\treturn pattern.test(searchQuery.getQuery());\n\t\t\t\t});\n\n\t\t\t\tif (hasCacheLimit)\n\t\t\t\t{\n\t\t\t\t\tresult.push(entity.getId());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tisQueryCacheable(searchQuery: SearchQuery): boolean\n\t{\n\t\treturn searchQuery.isCacheable() && !searchQuery.hasDynamicSearch();\n\t}\n\n\tisQueryLoaded(searchQuery: SearchQuery): boolean\n\t{\n\t\tlet found = false;\n\t\tthis.queryCache.forEach(query => {\n\t\t\tif (found === false && searchQuery.getQuery().startsWith(query))\n\t\t\t{\n\t\t\t\tfound = true;\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\taddCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tif (this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\tthis.queryCache.add(searchQuery.getQuery());\n\t\t}\n\t}\n\n\tremoveCacheQuery(searchQuery: SearchQuery): void\n\t{\n\t\tthis.queryCache.delete(searchQuery.getQuery());\n\t}\n\n\tshouldLoad(searchQuery: SearchQuery): boolean\n\t{\n\t\tif (!this.isQueryCacheable(searchQuery))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.getDialog().hasDynamicSearch())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.isQueryLoaded(searchQuery);\n\t}\n\n\tload(searchQuery: SearchQuery): void\n\t{\n\t\tif (!this.shouldLoad(searchQuery))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\t/*if (this.queryXhr)\n\t\t{\n\t\t\tthis.queryXhr.abort();\n\t\t}*/\n\n\t\tthis.addCacheQuery(searchQuery);\n\n\t\tthis.getStub().hide();\n\t\tthis.getSearchLoader().show();\n\n\t\tAjax.runAction('ui.entityselector.doSearch', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getDialog().getAjaxJson(),\n\t\t\t\t\tsearchQuery: searchQuery.getAjaxJson()\n\t\t\t\t},\n\t\t\t\tonrequeststart: (xhr) => {\n\t\t\t\t\tthis.queryXhr = xhr;\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getDialog().getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(response => {\n\n\t\t\t\tthis.getSearchLoader().hide();\n\n\t\t\t\tif (!response || !response.data || !response.data.dialog || !response.data.dialog.items)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t\tthis.toggleEmptyResult();\n\t\t\t\t\tthis.getDialog().emit('SearchTab:onLoad', { searchTab: this });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (response.data.searchQuery && response.data.searchQuery.cacheable === false)\n\t\t\t\t{\n\t\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArrayFilled(response.data.dialog.items))\n\t\t\t\t{\n\t\t\t\t\tconst items = new Set();\n\t\t\t\t\tresponse.data.dialog.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\t\t\tdelete itemOptions.tabs;\n\t\t\t\t\t\tdelete itemOptions.children;\n\n\t\t\t\t\t\tconst item = this.getDialog().addItem(itemOptions);\n\t\t\t\t\t\titems.add(item);\n\t\t\t\t\t});\n\n\t\t\t\t\tconst isTabEmpty = this.isEmptyResult();\n\n\t\t\t\t\tconst matchResults = SearchEngine.matchItems(\n\t\t\t\t\t\tArray.from(items.values()),\n\t\t\t\t\t\tthis.getLastSearchQuery()\n\t\t\t\t\t);\n\t\t\t\t\tthis.appendResults(matchResults);\n\n\t\t\t\t\tif (isTabEmpty && this.getDialog().shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getDialog().focusOnFirstNode();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.toggleEmptyResult();\n\n\t\t\t\tthis.getDialog().emit('SearchTab:onLoad', { searchTab: this });\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.removeCacheQuery(searchQuery);\n\t\t\t\tthis.getSearchLoader().hide();\n\t\t\t\tthis.toggleEmptyResult();\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\tgetSearchLoader(): SearchLoader\n\t{\n\t\treturn this.searchLoader;\n\t}\n\n\tclearResults(): void\n\t{\n\t\tthis.getRootNode().removeChildren();\n\t}\n\n\tisEmptyResult(): boolean\n\t{\n\t\treturn !this.getRootNode().hasChildren();\n\t}\n\n\ttoggleEmptyResult(): void\n\t{\n\t\tif (this.isEmptyResult())\n\t\t{\n\t\t\tthis.getStub().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getStub().hide();\n\t\t}\n\t}\n}","import { Type, Text, Tag, Dom, ajax as Ajax, Cache, Loc, Runtime, Reflection } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\n\nimport Item from '../item/item';\nimport Tab from './tabs/tab';\nimport Entity from '../entity/entity';\nimport TagSelector from '../tag-selector/tag-selector';\nimport Navigation from './navigation';\nimport SliderIntegration from './integration/slider-integration';\nimport Animation from '../common/animation';\nimport BaseHeader from './header/base-header';\nimport DefaultHeader from './header/default-header';\nimport BaseFooter from './footer/base-footer';\nimport DefaultFooter from './footer/default-footer';\n\nimport RecentTab from './tabs/recent-tab';\nimport SearchTab from './tabs/search-tab';\n\nimport type ItemNode from '../item/item-node';\nimport type { TabOptions } from './tabs/tab-options';\nimport type { DialogOptions } from './dialog-options';\nimport type { ItemOptions } from '../item/item-options';\nimport type { EntityOptions } from '../entity/entity-options';\nimport type { ItemId } from '../item/item-id';\nimport type { PopupOptions } from 'main.popup';\nimport type { HeaderOptions, HeaderContent } from './header/header-content';\nimport type { FooterOptions, FooterContent } from './footer/footer-content';\nimport type { ItemNodeOptions } from '../item/item-node-options';\nimport type { TagItemOptions } from '../tag-selector/tag-item-options';\n\nclass LoadState\n{\n\tstatic UNSENT: string = 'UNSENT';\n\tstatic LOADING: string = 'LOADING';\n\tstatic DONE: string = 'DONE';\n}\n\nclass TagSelectorMode\n{\n\tstatic INSIDE: string = 'INSIDE';\n\tstatic OUTSIDE: string = 'OUTSIDE';\n}\n\nconst instances = new Map();\n\n/**\n * @memberof BX.UI.EntitySelector\n */\nexport default class Dialog extends EventEmitter\n{\n\tid: string = null;\n\titems: Map<string, Map<string, Item>> = new Map();\n\ttabs: Map<string, Entity> = new Map();\n\tentities: Map<string, Entity> = new Map();\n\ttargetNode: HTMLElement = null;\n\tpopup: Popup = null;\n\tcache = new Cache.MemoryCache();\n\tmultiple: boolean = true;\n\thideOnSelect: boolean = null;\n\thideOnDeselect: boolean = null;\n\taddTagOnSelect: boolean = null;\n\tclearSearchOnSelect: boolean = true;\n\tcontext: string = null;\n\tselectedItems: Set<Item> = new Set();\n\tpreselectedItems: ItemId[] = [];\n\tundeselectedItems: ItemId[] = [];\n\tdropdownMode: boolean = false;\n\n\tfrozen: boolean = false;\n\tfrozenProps: { [propName: string]: any } = {};\n\n\thideByEsc: boolean = true;\n\tautoHide: boolean = true;\n\tautoHideHandler: Function = null;\n\toffsetTop: number = 5;\n\toffsetLeft: number = 0;\n\tcacheable: boolean = true;\n\n\twidth: number = 565;\n\theight: number = 420;\n\n\tmaxLabelWidth: number = 160;\n\tminLabelWidth: number = 45;\n\n\tshowAvatars: boolean = true;\n\tcompactView: boolean = false;\n\n\tactiveTab: Tab = null;\n\trecentTab: Tab = null;\n\tsearchTab: Tab = null;\n\n\trendered: boolean = false;\n\n\tloadState: LoadState = LoadState.UNSENT;\n\tloader: ?Loader = null;\n\n\ttagSelector: ?TagSelector = null;\n\ttagSelectorMode: ?TagSelectorMode = null;\n\ttagSelectorHeight: ?number = null;\n\n\tsaveRecentItemsWithDebounce: Function = Runtime.debounce(this.saveRecentItems, 2000, this);\n\trecentItemsToSave = [];\n\n\tnavigation: Navigation = null;\n\theader: BaseHeader = null;\n\tfooter: BaseFooter = null;\n\tpopupOptions: PopupOptions = {};\n\n\tfocusOnFirst: boolean = true;\n\tfocusedNode: ItemNode = null;\n\n\tclearUnavailableItems: boolean = false;\n\toverlappingObserver: MutationObserver = null;\n\n\tstatic getById(id: string): ?Dialog\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tstatic getInstances(): Dialog[]\n\t{\n\t\treturn Array.from(instances.values());\n\t}\n\n\tconstructor(dialogOptions: DialogOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.EntitySelector.Dialog');\n\n\t\tconst options: DialogOptions = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : `ui-selector-${Text.getRandom().toLowerCase()}`;\n\t\tthis.multiple = Type.isBoolean(options.multiple) ? options.multiple : true;\n\t\tthis.context = Type.isStringFilled(options.context) ? options.context : null;\n\t\tthis.clearUnavailableItems = options.clearUnavailableItems === true;\n\t\tthis.compactView = options.compactView === true;\n\t\tthis.dropdownMode = Type.isBoolean(options.dropdownMode) ? options.dropdownMode : false;\n\n\t\tif (Type.isArray(options.entities))\n\t\t{\n\t\t\toptions.entities.forEach((entity) => {\n\t\t\t\tthis.addEntity(entity);\n\t\t\t});\n\t\t}\n\n\t\tif (options.tagSelector instanceof TagSelector)\n\t\t{\n\t\t\tthis.tagSelectorMode = TagSelectorMode.OUTSIDE;\n\t\t\tthis.setTagSelector(options.tagSelector);\n\t\t}\n\t\telse if (options.enableSearch === true)\n\t\t{\n\t\t\tconst defaultOptions = {\n\t\t\t\tplaceholder: Loc.getMessage('UI_TAG_SELECTOR_SEARCH_PLACEHOLDER'),\n\t\t\t\tmaxHeight: 99,\n\t\t\t\ttextBoxWidth: 105\n\t\t\t};\n\t\t\tconst customOptions = Type.isPlainObject(options.tagSelectorOptions) ? options.tagSelectorOptions : {};\n\t\t\tconst mandatoryOptions = {\n\t\t\t\tdialogOptions: null,\n\t\t\t\tshowTextBox: true,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tmultiple: this.isMultiple()\n\t\t\t};\n\n\t\t\tconst tagSelectorOptions = Object.assign(defaultOptions, customOptions, mandatoryOptions);\n\t\t\tconst tagSelector = new TagSelector(tagSelectorOptions);\n\t\t\tthis.tagSelectorMode = TagSelectorMode.INSIDE;\n\t\t\tthis.setTagSelector(tagSelector);\n\t\t}\n\n\t\tthis.setTargetNode(options.targetNode);\n\t\tthis.setHideOnSelect(options.hideOnSelect);\n\t\tthis.setHideOnDeselect(options.hideOnDeselect);\n\t\tthis.setAddTagOnSelect(options.addTagOnSelect);\n\t\tthis.setClearSearchOnSelect(options.clearSearchOnSelect);\n\t\tthis.setWidth(options.width);\n\t\tvoid this.setHeight(options.height);\n\t\tthis.setAutoHide(options.autoHide);\n\t\tthis.setAutoHideHandler(options.autoHideHandler);\n\t\tthis.setHideByEsc(options.hideByEsc);\n\t\tthis.setOffsetLeft(options.offsetLeft);\n\t\tthis.setOffsetTop(options.offsetTop);\n\t\tthis.setCacheable(options.cacheable);\n\t\tthis.setFocusOnFirst(options.focusOnFirst);\n\t\tthis.setShowAvatars(options.showAvatars);\n\n\t\tthis.recentTab = new RecentTab(this, options.recentTabOptions);\n\t\tthis.searchTab = new SearchTab(this, options.searchTabOptions, options.searchOptions);\n\n\t\tthis.addTab(this.recentTab);\n\t\tthis.addTab(this.searchTab);\n\n\t\tthis.setPreselectedItems(options.preselectedItems);\n\t\tthis.setUndeselectedItems(options.undeselectedItems);\n\n\t\tthis.setOptions(options);\n\n\t\tconst preload = options.preload === true || this.getPreselectedItems().length > 0;\n\t\tif (preload)\n\t\t{\n\t\t\tthis.load();\n\t\t}\n\n\t\tif (Type.isPlainObject(options.popupOptions))\n\t\t{\n\t\t\tconst allowedOptions = ['overlay', 'bindOptions', 'targetContainer', 'zIndexOptions'];\n\t\t\tconst popupOptions = {};\n\n\t\t\tObject.keys(options.popupOptions).forEach((option: string) => {\n\t\t\t\tif (allowedOptions.includes(option))\n\t\t\t\t{\n\t\t\t\t\tpopupOptions[option] = options.popupOptions[option];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.popupOptions = popupOptions;\n\t\t}\n\n\t\tthis.navigation = new Navigation(this);\n\n\t\t(new SliderIntegration(this));\n\n\t\tthis.subscribe('ItemNode:onFocus', this.handleItemNodeFocus.bind(this));\n\t\tthis.subscribe('ItemNode:onUnfocus', this.handleItemNodeUnfocus.bind(this));\n\n\t\tthis.subscribeFromOptions(options.events);\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.load();\n\t\tthis.getPopup().show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroying)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.destroying = true;\n\t\tthis.emit('onDestroy');\n\n\t\tthis.disconnectTabOverlapping();\n\t\tinstances.delete(this.getId());\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().destroy();\n\t\t}\n\n\t\tfor (const property in this)\n\t\t{\n\t\t\tif (this.hasOwnProperty(property))\n\t\t\t{\n\t\t\t\tdelete this[property];\n\t\t\t}\n\t\t}\n\n\t\tObject.setPrototypeOf(this, null);\n\t}\n\n\tisOpen(): boolean\n\t{\n\t\treturn this.popup && this.popup.isShown();\n\t}\n\n\tadjustPosition(): void\n\t{\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tsearch(queryString: string): void\n\t{\n\t\tconst query = Type.isStringFilled(queryString) ? queryString.trim() : '';\n\n\t\tconst event = new BaseEvent({ data: { query } });\n\t\tthis.emit('onBeforeSearch', event);\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isStringFilled(query))\n\t\t{\n\t\t\tthis.selectFirstTab();\n\t\t\tif (this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getSearchTab().clearResults();\n\t\t\t}\n\t\t}\n\t\telse if (this.getSearchTab())\n\t\t{\n\t\t\tthis.selectTab(this.getSearchTab().getId());\n\t\t\tthis.getSearchTab().search(query);\n\t\t}\n\n\t\tthis.emit('onSearch', { query });\n\t}\n\n\taddItem(options: ItemOptions): Item\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\tthrow new Error('EntitySelector.addItem: wrong item options.');\n\t\t}\n\n\t\tlet item = this.getItem(options);\n\t\tif (!item)\n\t\t{\n\t\t\titem = new Item(options);\n\n\t\t\tconst undeselectable = this.getUndeselectedItems().some((itemId: ItemId) => {\n\t\t\t\treturn itemId[0] === item.getEntityId() && String(itemId[1]) === String(item.getId());\n\t\t\t});\n\n\t\t\tif (undeselectable)\n\t\t\t{\n\t\t\t\titem.setDeselectable(false);\n\t\t\t}\n\n\t\t\titem.setDialog(this);\n\n\t\t\tconst entity = this.getEntity(item.getEntityId());\n\t\t\tif (entity === null)\n\t\t\t{\n\t\t\t\tthis.addEntity({ id: item.getEntityId() });\n\t\t\t}\n\n\t\t\tlet entityItems = this.items.get(item.getEntityId());\n\t\t\tif (!entityItems)\n\t\t\t{\n\t\t\t\tentityItems = new Map();\n\t\t\t\tthis.items.set(item.getEntityId(), entityItems);\n\t\t\t}\n\n\t\t\tentityItems.set(String(item.getId()), item);\n\n\t\t\tif (item.isSelected())\n\t\t\t{\n\t\t\t\tthis.handleItemSelect(item);\n\t\t\t}\n\t\t}\n\n\t\tlet tabs = [];\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\ttabs = options.tabs;\n\t\t}\n\t\telse if (Type.isStringFilled(options.tabs))\n\t\t{\n\t\t\ttabs = [options.tabs];\n\t\t}\n\n\t\tconst children = Type.isArray(options.children) ? options.children : [];\n\n\t\ttabs.forEach((tabId) => {\n\t\t\tconst tab = this.getTab(tabId);\n\t\t\tif (tab)\n\t\t\t{\n\t\t\t\tconst itemNode = tab.getRootNode().addItem(item, options.nodeOptions);\n\t\t\t\titemNode.addChildren(children);\n\t\t\t}\n\t\t});\n\n\t\treturn item;\n\t}\n\n\tremoveItem(item: Item | ItemOptions): ?Item\n\t{\n\t\titem = this.getItem(item);\n\t\tif (item)\n\t\t{\n\t\t\tthis.handleItemDeselect(item);\n\n\t\t\titem.getNodes().forEach((node: ItemNode) => {\n\t\t\t\tnode.getParentNode().removeChild(node);\n\t\t\t});\n\n\t\t\tconst entityItems = this.getEntityItemsInternal(item.getEntityId());\n\t\t\tif (entityItems)\n\t\t\t{\n\t\t\t\tentityItems.delete(String(item.getId()));\n\t\t\t\tif (entityItems.size === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.items.delete(item.getEntityId());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tremoveItems(): void\n\t{\n\t\tthis.getItemsInternal().forEach((items: Map<string, Item>) => {\n\t\t\titems.forEach((item: Item) => {\n\t\t\t\tthis.removeItem(item);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetItem(item: ItemId | Item | ItemOptions): ?Item\n\t{\n\t\tlet id = null;\n\t\tlet entityId = null;\n\n\t\tif (Type.isArray(item) && item.length === 2)\n\t\t{\n\t\t\t[entityId, id] = item;\n\t\t}\n\t\telse if (item instanceof Item)\n\t\t{\n\t\t\tid = item.getId();\n\t\t\tentityId = item.getEntityId();\n\t\t}\n\t\telse if (Type.isObjectLike(item))\n\t\t{\n\t\t\t({ id, entityId } = item);\n\t\t}\n\n\t\tconst entityItems = this.getEntityItemsInternal(entityId);\n\t\tif (entityItems)\n\t\t{\n\t\t\treturn entityItems.get(String(id)) || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSelectedItems(): Item[]\n\t{\n\t\treturn Array.from(this.selectedItems);\n\t}\n\n\tgetItems(): Item[]\n\t{\n\t\tconst items = [];\n\t\tthis.getItemsInternal().forEach((entityItems: Map<string, Item>) => {\n\t\t\tArray.prototype.push.apply(items, Array.from(entityItems.values()));\n\t\t});\n\n\t\treturn items;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetItemsInternal(): Map<string, Map<string, Item>>\n\t{\n\t\treturn this.items;\n\t}\n\n\tgetEntityItems(entityId: string): Item[]\n\t{\n\t\tconst items = this.getEntityItemsInternal(entityId);\n\n\t\treturn items === null ? [] : Array.from(items.values());\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetEntityItemsInternal(entityId: string): Map<string, Item> | null\n\t{\n\t\treturn this.items.get(entityId) || null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tvalidateItemIds(itemIds: ItemId[]): ItemId[]\n\t{\n\t\tif (!Type.isArrayFilled(itemIds))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = [];\n\t\titemIds.forEach((itemId: ItemId) => {\n\t\t\tif (!Type.isArray(itemId) || itemId.length !== 2)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst [entityId, id] = itemId;\n\n\t\t\tif (Type.isStringFilled(entityId) && (Type.isStringFilled(id) || Type.isNumber(id)))\n\t\t\t{\n\t\t\t\tresult.push(itemId);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\taddTab(tab: Tab | TabOptions): Tab\n\t{\n\t\tif (Type.isPlainObject(tab))\n\t\t{\n\t\t\ttab = new Tab(this, tab);\n\t\t}\n\n\t\tif (!(tab instanceof Tab))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: a tab must be an instance of EntitySelector.Tab.');\n\t\t}\n\n\t\tif (this.getTab(tab.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${tab.getId()}\" tab is already existed.`);\n\t\t\treturn tab;\n\t\t}\n\n\t\ttab.setDialog(this);\n\t\tthis.tabs.set(tab.getId(), tab);\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.insertTab(tab);\n\t\t}\n\n\t\treturn tab;\n\t}\n\n\tgetTabs(): Tab[]\n\t{\n\t\treturn Array.from(this.tabs.values());\n\t}\n\n\tgetTab(id: string): ?Tab\n\t{\n\t\treturn this.tabs.get(id) || null;\n\t}\n\n\tgetRecentTab(): RecentTab\n\t{\n\t\treturn this.recentTab;\n\t}\n\n\tgetSearchTab(): SearchTab\n\t{\n\t\treturn this.searchTab;\n\t}\n\n\tselectTab(id: string): ?Tab\n\t{\n\t\tconst newActiveTab = this.getTab(id);\n\t\tif (!newActiveTab || newActiveTab === this.getActiveTab())\n\t\t{\n\t\t\treturn newActiveTab;\n\t\t}\n\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tthis.getActiveTab().deselect();\n\t\t}\n\n\t\tthis.activeTab = newActiveTab;\n\t\tnewActiveTab.select();\n\n\t\tif (!newActiveTab.isRendered())\n\t\t{\n\t\t\tnewActiveTab.render();\n\t\t}\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.focusSearch();\n\t\t\t});\n\t\t});\n\n\t\tthis.clearNodeFocus();\n\t\tif (this.shouldFocusOnFirst())\n\t\t{\n\t\t\tthis.focusOnFirstNode();\n\t\t}\n\n\t\tthis.adjustHeader();\n\t\tthis.adjustFooter();\n\n\t\treturn newActiveTab;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tinsertTab(tab: Tab): void\n\t{\n\t\ttab.renderLabel();\n\t\ttab.renderContainer();\n\n\t\tDom.append(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.append(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getHeader())\n\t\t{\n\t\t\tDom.append(tab.getHeader().getContainer(), this.getHeaderContainer());\n\t\t}\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.append(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\tselectFirstTab(onlyVisible = true): ?Tab\n\t{\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tselectLastTab(onlyVisible = true): ?Tab\n\t{\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = tabs.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible === false || tab.isVisible())\n\t\t\t{\n\t\t\t\treturn this.selectTab(tab.getId());\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDropdownMode())\n\t\t{\n\t\t\treturn this.selectTab(this.getRecentTab().getId());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetActiveTab(): ?Tab\n\t{\n\t\treturn this.activeTab;\n\t}\n\n\tgetNextTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet nextTab = null;\n\t\tlet activeFound = false;\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i =  0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tnextTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn nextTab;\n\t}\n\n\tgetPreviousTab(onlyVisible = true): ?Tab\n\t{\n\t\tlet previousTab = null;\n\t\tlet activeFound = false;\n\t\tconst tabs = this.getTabs();\n\t\tfor (let i = tabs.length - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst tab = tabs[i];\n\t\t\tif (onlyVisible && !tab.isVisible())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (tab === this.getActiveTab())\n\t\t\t{\n\t\t\t\tactiveFound = true;\n\t\t\t}\n\t\t\telse if (activeFound)\n\t\t\t{\n\t\t\t\tpreviousTab = tab;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn previousTab;\n\t}\n\n\tremoveTab(id: string): void\n\t{\n\t\tconst tab = this.getTab(id);\n\t\tif (!tab)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttab.getRootNode().removeChildren();\n\n\t\tthis.tabs.delete(id);\n\n\t\tDom.remove(tab.getLabelContainer(), this.getLabelsContainer());\n\t\tDom.remove(tab.getContainer(), this.getTabContentsContainer());\n\n\t\tif (tab.getHeader())\n\t\t{\n\t\t\tDom.remove(tab.getHeader().getContainer(), this.getHeaderContainer());\n\t\t}\n\n\t\tif (tab.getFooter())\n\t\t{\n\t\t\tDom.remove(tab.getFooter().getContainer(), this.getFooterContainer());\n\t\t}\n\n\t\tthis.selectFirstTab();\n\t}\n\n\taddEntity(entity: Entity | EntityOptions): Entity\n\t{\n\t\tif (Type.isPlainObject(entity))\n\t\t{\n\t\t\tentity = new Entity(entity);\n\t\t}\n\n\t\tif (!(entity instanceof Entity))\n\t\t{\n\t\t\tthrow new Error('EntitySelector: an entity must be an instance of EntitySelector.Entity.');\n\t\t}\n\n\t\tif (this.hasEntity(entity.getId()))\n\t\t{\n\t\t\tconsole.error(`EntitySelector: the \"${entity.getId()}\" entity is already existed.`);\n\t\t\treturn entity;\n\t\t}\n\n\t\tthis.entities.set(entity.getId(), entity);\n\n\t\treturn entity;\n\t}\n\n\tgetEntity(id: string): ?Entity\n\t{\n\t\treturn this.entities.get(id) || null;\n\t}\n\n\thasEntity(id: string): boolean\n\t{\n\t\treturn this.entities.has(id);\n\t}\n\n\tgetEntities(): Entity[]\n\t{\n\t\treturn Array.from(this.entities.values());\n\t}\n\n\tremoveEntity(id: string): void\n\t{\n\t\tthis.removeEntityItems(id);\n\t\tthis.entities.delete(id);\n\t}\n\n\tremoveEntityItems(id: string): void\n\t{\n\t\tconst items = this.getEntityItemsInternal(id);\n\t\tif (items)\n\t\t{\n\t\t\titems.forEach((item: Item) => {\n\t\t\t\tthis.removeItem(item);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetHeader(): ?BaseHeader\n\t{\n\t\treturn this.header;\n\t}\n\n\tgetActiveHeader(): ?BaseHeader\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getActiveTab().getHeader())\n\t\t{\n\t\t\treturn this.getActiveTab().getHeader();\n\t\t}\n\n\t\treturn this.getHeader() && this.getActiveTab().canShowDefaultHeader() ? this.getHeader() : null;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tadjustHeader(): void\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveTab().getHeader())\n\t\t{\n\t\t\tif (this.getHeader())\n\t\t\t{\n\t\t\t\tthis.getHeader().hide();\n\t\t\t}\n\n\t\t\tthis.getActiveTab().getHeader().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getHeader())\n\t\t\t{\n\t\t\t\tif (this.getActiveTab().canShowDefaultHeader())\n\t\t\t\t{\n\t\t\t\t\tthis.getHeader().show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getHeader().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetHeader(headerContent: ?HeaderContent, headerOptions?: HeaderOptions): ?BaseHeader\n\t{\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tif (headerContent !== null)\n\t\t{\n\t\t\theader = this.constructor.createHeader(this, headerContent, headerOptions);\n\t\t\tif (header === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getHeader() !== null)\n\t\t{\n\t\t\tDom.remove(this.getHeader().getContainer());\n\t\t\tthis.adjustHeader();\n\t\t}\n\n\t\tthis.header = header;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.appendHeader(header);\n\t\t\tthis.adjustHeader();\n\t\t}\n\n\t\treturn header;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tappendHeader(header: BaseHeader): void\n\t{\n\t\tif (header instanceof BaseHeader)\n\t\t{\n\t\t\tDom.append(header.getContainer(), this.getHeaderContainer());\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tstatic createHeader(context: Dialog | Tab, headerContent: HeaderContent, headerOptions?: HeaderOptions): ?BaseHeader\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(headerContent) &&\n\t\t\t!Type.isArrayFilled(headerContent) &&\n\t\t\t!Type.isDomNode(headerContent) &&\n\t\t\t!Type.isFunction(headerContent)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t/** @var {BaseHeader} */\n\t\tlet header = null;\n\t\tconst options = Type.isPlainObject(headerOptions) ? headerOptions : {};\n\n\t\tif (Type.isFunction(headerContent) || Type.isString(headerContent))\n\t\t{\n\t\t\tconst className = Type.isString(headerContent) ? Reflection.getClass(headerContent) : headerContent;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\theader = new className(context, options);\n\t\t\t\tif (!(header instanceof BaseHeader))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: header is not an instance of BaseHeader.');\n\t\t\t\t\theader = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (headerContent !== null && !header)\n\t\t{\n\t\t\theader = new DefaultHeader(context, Object.assign({}, options, { content: headerContent }));\n\t\t}\n\n\t\treturn header;\n\t}\n\n\tgetFooter(): ?BaseFooter\n\t{\n\t\treturn this.footer;\n\t}\n\n\tgetActiveFooter(): ?BaseFooter\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\treturn this.getActiveTab().getFooter();\n\t\t}\n\n\t\treturn this.getFooter() && this.getActiveTab().canShowDefaultFooter() ? this.getFooter() : null;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tadjustFooter(): void\n\t{\n\t\tif (!this.getActiveTab())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getActiveTab().getFooter())\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tthis.getFooter().hide();\n\t\t\t}\n\n\t\t\tthis.getActiveTab().getFooter().show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.getFooter())\n\t\t\t{\n\t\t\t\tif (this.getActiveTab().canShowDefaultFooter())\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getFooter().hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetFooter(footerContent: ?FooterContent, footerOptions?: FooterOptions): ?BaseFooter\n\t{\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tif (footerContent !== null)\n\t\t{\n\t\t\tfooter = this.constructor.createFooter(this, footerContent, footerOptions);\n\t\t\tif (footer === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tif (this.isRendered() && this.getFooter() !== null)\n\t\t{\n\t\t\tDom.remove(this.getFooter().getContainer());\n\t\t\tthis.adjustFooter();\n\t\t}\n\n\t\tthis.footer = footer;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.appendFooter(footer);\n\t\t\tthis.adjustFooter();\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tappendFooter(footer: BaseFooter): void\n\t{\n\t\tif (footer instanceof BaseFooter)\n\t\t{\n\t\t\tDom.append(footer.getContainer(), this.getFooterContainer());\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tstatic createFooter(context: Dialog | Tab, footerContent: FooterContent, footerOptions?: FooterOptions): ?BaseFooter\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(footerContent) &&\n\t\t\t!Type.isArrayFilled(footerContent) &&\n\t\t\t!Type.isDomNode(footerContent) &&\n\t\t\t!Type.isFunction(footerContent)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t/** @var {BaseFooter} */\n\t\tlet footer = null;\n\t\tconst options = Type.isPlainObject(footerOptions) ? footerOptions : {};\n\n\t\tif (Type.isFunction(footerContent) || Type.isString(footerContent))\n\t\t{\n\t\t\tconst className = Type.isString(footerContent) ? Reflection.getClass(footerContent) : footerContent;\n\t\t\tif (Type.isFunction(className))\n\t\t\t{\n\t\t\t\tfooter = new className(context, options);\n\t\t\t\tif (!(footer instanceof BaseFooter))\n\t\t\t\t{\n\t\t\t\t\tconsole.error('EntitySelector: footer is not an instance of BaseFooter.');\n\t\t\t\t\tfooter = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (footerContent !== null && !footer)\n\t\t{\n\t\t\tfooter = new DefaultFooter(context, Object.assign({}, options, { content: footerContent }));\n\t\t}\n\n\t\treturn footer;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContext(): ?string\n\t{\n\t\treturn this.context;\n\t}\n\n\tgetNavigation(): Navigation\n\t{\n\t\treturn this.navigation;\n\t}\n\n\tdeselectAll(): void\n\t{\n\t\tthis.getSelectedItems().forEach((item: Item) => {\n\t\t\titem.deselect();\n\t\t});\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn this.multiple;\n\t}\n\n\tsetTargetNode(node: HTMLElement | { left: number, top: number } | null | MouseEvent): void\n\t{\n\t\tif (!Type.isDomNode(node) && !Type.isNull(node) && !Type.isObject(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetNode = node;\n\n\t\tif (this.isRendered())\n\t\t{\n\t\t\tthis.getPopup().setBindElement(this.targetNode);\n\t\t\tthis.getPopup().adjustPosition();\n\t\t}\n\t}\n\n\tgetTargetNode(): ?HTMLElement\n\t{\n\t\tif (this.targetNode === null)\n\t\t{\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t\t{\n\t\t\t\treturn this.getTagSelector().getOuterContainer();\n\t\t\t}\n\t\t}\n\n\t\treturn this.targetNode;\n\t}\n\n\tsetHideOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnSelect(): boolean\n\t{\n\t\tif (this.hideOnSelect !== null)\n\t\t{\n\t\t\treturn this.hideOnSelect;\n\t\t}\n\n\t\treturn !this.isMultiple();\n\t}\n\n\tsetHideOnDeselect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.hideOnDeselect = flag;\n\t\t}\n\t}\n\n\tshouldHideOnDeselect(): boolean\n\t{\n\t\tif (this.hideOnDeselect !== null)\n\t\t{\n\t\t\treturn this.hideOnDeselect;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetClearSearchOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.clearSearchOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldClearSearchOnSelect(): boolean\n\t{\n\t\treturn this.clearSearchOnSelect;\n\t}\n\n\tsetAddTagOnSelect(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.addTagOnSelect = flag;\n\t\t}\n\t}\n\n\tshouldAddTagOnSelect(): boolean\n\t{\n\t\tif (this.addTagOnSelect !== null)\n\t\t{\n\t\t\treturn this.addTagOnSelect;\n\t\t}\n\n\t\treturn this.isMultiple() || this.isTagSelectorOutside();\n\t}\n\n\tsetShowAvatars(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.showAvatars = flag;\n\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getTabs().forEach((tab: Tab) => {\n\t\t\t\t\ttab.renderContainer();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldShowAvatars(): boolean\n\t{\n\t\treturn this.showAvatars;\n\t}\n\n\tisCompactView(): boolean\n\t{\n\t\treturn this.compactView;\n\t}\n\n\tsetAutoHide(enable: boolean): void\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.autoHide = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setAutoHide(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tisAutoHide(): boolean\n\t{\n\t\treturn this.autoHide;\n\t}\n\n\tsetAutoHideHandler(handler?: (event: MouseEvent, dialog: Dialog) => boolean): void\n\t{\n\t\tif (Type.isFunction(handler) || handler === null)\n\t\t{\n\t\t\tthis.autoHideHandler = handler;\n\t\t}\n\t}\n\n\tsetHideByEsc(enable: boolean): void\n\t{\n\t\tif (Type.isBoolean(enable))\n\t\t{\n\t\t\tthis.hideByEsc = enable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setClosingByEsc(enable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldHideByEsc(): boolean\n\t{\n\t\treturn this.hideByEsc;\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number): void\n\t{\n\t\tif (Type.isNumber(width) && width > 0)\n\t\t{\n\t\t\tthis.width = width;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'width', `${width}px`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number): Promise\n\t{\n\t\tif (Type.isNumber(height) && height > 0)\n\t\t{\n\t\t\tthis.height = height;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'height', `${height}px`);\n\t\t\t\treturn Animation.handleTransitionEnd(this.getContainer(), 'height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tgetOffsetLeft(): number\n\t{\n\t\treturn this.offsetLeft;\n\t}\n\n\tsetOffsetLeft(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetLeft = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetLeft: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffsetTop(): number\n\t{\n\t\treturn this.offsetTop;\n\t}\n\n\tsetOffsetTop(offset: number): void\n\t{\n\t\tif (Type.isNumber(offset) && offset >= 0)\n\t\t{\n\t\t\tthis.offsetTop = offset;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setOffset({ offsetTop: offset });\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getPopup().getZindex();\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tif (Type.isBoolean(cacheable))\n\t\t{\n\t\t\tthis.cacheable = cacheable;\n\t\t\tif (this.isRendered())\n\t\t\t{\n\t\t\t\tthis.getPopup().setCacheable(cacheable);\n\t\t\t}\n\t\t}\n\t}\n\n\tshouldFocusOnFirst(): boolean\n\t{\n\t\treturn this.focusOnFirst;\n\t}\n\n\tsetFocusOnFirst(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.focusOnFirst = flag;\n\t\t}\n\t}\n\n\tfocusOnFirstNode(): ?ItemNode\n\t{\n\t\tif (this.getActiveTab())\n\t\t{\n\t\t\tconst itemNode = this.getActiveTab().getRootNode().getFirstChild();\n\t\t\tif (itemNode)\n\t\t\t{\n\t\t\t\titemNode.focus();\n\n\t\t\t\treturn itemNode;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetFocusedNode(): ?ItemNode\n\t{\n\t\treturn this.focusedNode;\n\t}\n\n\tclearNodeFocus(): void\n\t{\n\t\tif (this.focusedNode)\n\t\t{\n\t\t\tthis.focusedNode.unfocus();\n\t\t\tthis.focusedNode = null;\n\t\t}\n\t}\n\n\tisDropdownMode(): boolean\n\t{\n\t\treturn this.dropdownMode;\n\t}\n\n\tsetPreselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.preselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetPreselectedItems(): ItemId[]\n\t{\n\t\treturn this.preselectedItems;\n\t}\n\n\tsetUndeselectedItems(itemIds: ItemId[]): void\n\t{\n\t\tthis.undeselectedItems = this.validateItemIds(itemIds);\n\t}\n\n\tgetUndeselectedItems()\n\t{\n\t\treturn this.undeselectedItems;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetOptions(dialogOptions: DialogOptions): void\n\t{\n\t\tconst options = Type.isPlainObject(dialogOptions) ? dialogOptions : {};\n\n\t\tif (Type.isArray(options.tabs))\n\t\t{\n\t\t\toptions.tabs.forEach((tab) => {\n\t\t\t\tthis.addTab(tab);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.selectedItems))\n\t\t{\n\t\t\toptions.selectedItems.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tconst options = Object.assign({}, Type.isPlainObject(itemOptions) ? itemOptions : {});\n\t\t\t\toptions.selected = true;\n\t\t\t\tthis.addItem(options);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(options.items))\n\t\t{\n\t\t\toptions.items.forEach((itemOptions: ItemOptions) => {\n\t\t\t\tthis.addItem(itemOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis.setHeader(options.header, options.headerOptions);\n\t\tthis.setFooter(options.footer, options.footerOptions);\n\t}\n\n\tgetMaxLabelWidth(): number\n\t{\n\t\treturn this.maxLabelWidth;\n\t}\n\n\tgetMinLabelWidth(): number\n\t{\n\t\treturn this.minLabelWidth;\n\t}\n\n\tgetTagSelector(): ?TagSelector\n\t{\n\t\treturn this.tagSelector;\n\t}\n\n\tgetTagSelectorMode(): ?TagSelectorMode\n\t{\n\t\treturn this.tagSelectorMode;\n\t}\n\n\tisTagSelectorInside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.INSIDE;\n\t}\n\n\tisTagSelectorOutside(): boolean\n\t{\n\t\treturn this.getTagSelector() && this.getTagSelectorMode() === TagSelectorMode.OUTSIDE;\n\t}\n\n\tgetTagSelectorQuery(): string\n\t{\n\t\treturn this.getTagSelector() ? this.getTagSelector().getTextBoxValue() : '';\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetTagSelector(tagSelector: TagSelector): void\n\t{\n\t\tthis.tagSelector = tagSelector;\n\n\t\tthis.tagSelector.subscribe('onInput', Runtime.debounce(this.handleTagSelectorInput, 200, this));\n\t\tthis.tagSelector.subscribe('onAddButtonClick', this.handleTagSelectorAddButtonClick.bind(this));\n\t\tthis.tagSelector.subscribe('onTagRemove', this.handleTagSelectorTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagRemove', this.handleTagSelectorAfterTagRemove.bind(this));\n\t\tthis.tagSelector.subscribe('onAfterTagAdd', this.handleTagSelectorAfterTagAdd.bind(this));\n\t\tthis.tagSelector.subscribe('onContainerClick', this.handleTagSelectorClick.bind(this));\n\n\t\tthis.tagSelector.setDialog(this);\n\t}\n\n\tfocusSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tif (this.getActiveTab() !== this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().focusTextBox();\n\t\t}\n\t}\n\n\tclearSearch(): void\n\t{\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().clearTextBox();\n\n\t\t\tif (this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLoader(): Loader\n\t{\n\t\tif (this.loader === null)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getTabsContainer(),\n\t\t\t\tsize: 100\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tvoid this.getLoader().show();\n\t}\n\n\thideLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tvoid this.getLoader().hide();\n\t\t}\n\t}\n\n\tdestroyLoader(): void\n\t{\n\t\tif (this.loader !== null)\n\t\t{\n\t\t\tthis.getLoader().destroy();\n\t\t}\n\n\t\tthis.loader = null;\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (this.popup !== null)\n\t\t{\n\t\t\treturn this.popup;\n\t\t}\n\n\t\tthis.getTabs().forEach((tab: Tab) => {\n\t\t\tthis.insertTab(tab);\n\t\t});\n\n\t\tthis.popup = new Popup(Object.assign({\n\t\t\tcontentPadding: 0,\n\t\t\tpadding: 0,\n\t\t\toffsetTop: this.getOffsetTop(),\n\t\t\toffsetLeft: this.getOffsetLeft(),\n\t\t\tanimation: {\n\t\t\t\tshowClassName: 'ui-selector-popup-animation-show',\n\t\t\t\tcloseClassName: 'ui-selector-popup-animation-close',\n\t\t\t\tcloseAnimationType: 'animation'\n\t\t\t},\n\t\t\tbindElement: this.getTargetNode(),\n\t\t\tbindOptions: {\n\t\t\t\tforceBindPosition: true\n\t\t\t},\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\tautoHideHandler: this.handleAutoHide.bind(this),\n\t\t\tcloseByEsc: this.shouldHideByEsc(),\n\t\t\tcacheable: this.isCacheable(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: this.handlePopupFirstShow.bind(this),\n\t\t\t\tonAfterShow: this.handlePopupAfterShow.bind(this),\n\t\t\t\tonAfterClose: this.handlePopupAfterClose.bind(this),\n\t\t\t\tonDestroy: this.handlePopupDestroy.bind(this)\n\t\t\t},\n\t\t\tcontent: this.getContainer()\n\t\t}, this.popupOptions));\n\n\t\tthis.rendered = true;\n\n\t\tthis.selectFirstTab();\n\n\t\treturn this.popup;\n\t}\n\n\tisRendered(): boolean\n\t{\n\t\treturn this.rendered;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('container', () => {\n\n\t\t\tlet searchContainer = '';\n\t\t\tif (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t\t{\n\t\t\t\tsearchContainer = Tag.render`<div class=\"ui-selector-search\"></div>`;\n\n\t\t\t\tthis.getTagSelector().renderTo(searchContainer);\n\t\t\t}\n\n\t\t\tconst className = this.isCompactView() ? ' ui-selector-dialog--compact-view' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-dialog${className}\" \n\t\t\t\t\tstyle=\"width:${this.getWidth()}px; height:${this.getHeight()}px;\"\n\t\t\t\t>\n\t\t\t\t\t${this.getHeaderContainer()}\n\t\t\t\t\t${searchContainer}\n\t\t\t\t\t${this.getTabsContainer()}\n\t\t\t\t\t${this.getFooterContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tabs-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-tabs\">\n\t\t\t\t\t${this.getTabContentsContainer()}\n\t\t\t\t\t${this.getLabelsContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTabContentsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('tab-contents', () => {\n\t\t\treturn Tag.render`<div class=\"ui-selector-tab-contents\"></div>`;\n\t\t});\n\t}\n\n\tgetLabelsContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('labels-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div \n\t\t\t\t\tclass=\"ui-selector-tab-labels\"\n\t\t\t\t\tonmouseenter=\"${this.handleLabelsMouseEnter.bind(this)}\"\n\t\t\t\t\tonmouseleave=\"${this.handleLabelsMouseLeave.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHeaderContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('header', () => {\n\t\t\tconst header = this.getHeader() && this.getHeader().getContainer();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-header-container\">${header ? header : ''}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFooterContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('footer', () => {\n\t\t\tconst footer = this.getFooter() && this.getFooter().getContainer();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-selector-footer-container\">${footer ? footer : ''}</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tfreeze(): void\n\t{\n\t\tif (this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.frozenProps = {\n\t\t\tautoHide: this.isAutoHide(),\n\t\t\thideByEsc: this.shouldHideByEsc(),\n\t\t};\n\n\t\tthis.setAutoHide(false);\n\t\tthis.setHideByEsc(false);\n\n\t\tthis.getNavigation().disable();\n\t\tDom.addClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = true;\n\t}\n\n\tunfreeze(): void\n\t{\n\t\tif (!this.isFrozen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setAutoHide(this.frozenProps.autoHide !== false);\n\t\tthis.setHideByEsc(this.frozenProps.hideByEsc !== false);\n\n\t\tthis.getNavigation().enable();\n\t\tDom.removeClass(this.getContainer(), 'ui-selector-dialog--freeze');\n\n\t\tthis.frozen = false;\n\t}\n\n\tisFrozen(): boolean\n\t{\n\t\treturn this.frozen;\n\t}\n\n\thasRecentItems(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax\n\t\t\t\t.runAction('ui.entityselector.load', {\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tdialog: this.getAjaxJson()\n\t\t\t\t\t},\n\t\t\t\t\tgetParameters: {\n\t\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tresponse.data && response.data.dialog && Type.isArrayFilled(response.data.dialog.recentItems)\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tload(): void\n\t{\n\t\tif (this.loadState !== LoadState.UNSENT || !this.hasDynamicLoad())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().lock();\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.isLoading())\n\t\t\t{\n\t\t\t\tthis.showLoader();\n\t\t\t}\n\t\t}, 400);\n\n\t\tthis.loadState = LoadState.LOADING;\n\n\t\tAjax.runAction('ui.entityselector.load', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getAjaxJson()\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tif (response && response.data && Type.isPlainObject(response.data.dialog))\n\t\t\t\t{\n\t\t\t\t\tthis.loadState = LoadState.DONE;\n\n\t\t\t\t\tconst entities =\n\t\t\t\t\t\tType.isArrayFilled(response.data.dialog.entities)\n\t\t\t\t\t\t\t? response.data.dialog.entities\n\t\t\t\t\t\t\t: []\n\t\t\t\t\t;\n\n\t\t\t\t\tentities.forEach((entityOptions: EntityOptions) => {\n\t\t\t\t\t\tconst entity = this.getEntity(entityOptions.id);\n\t\t\t\t\t\tif (entity)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentity.setDynamicSearch(entityOptions.dynamicSearch);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.setOptions(response.data.dialog);\n\n\t\t\t\t\tthis.getPreselectedItems().forEach((preselectedItem: ItemId) => {\n\t\t\t\t\t\tconst item = this.getItem(preselectedItem);\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst recentItems = response.data.dialog.recentItems;\n\t\t\t\t\tif (Type.isArray(recentItems))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst nodeOptionsMap: Map<Item, ItemNodeOptions> = new Map();\n\t\t\t\t\t\tconst itemsOptions: ItemOptions[] = response.data.dialog.items;\n\t\t\t\t\t\tif (Type.isArray(itemsOptions))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titemsOptions.forEach((itemOptions: ItemOptions) => {\n\t\t\t\t\t\t\t\tif (itemOptions.nodeOptions)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst item = this.getItem(itemOptions);\n\t\t\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tnodeOptionsMap.set(item, itemOptions.nodeOptions);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst items = recentItems.map((recentItem: ItemId) => {\n\t\t\t\t\t\t\tconst item = this.getItem(recentItem);\n\n\t\t\t\t\t\t\treturn [item, nodeOptionsMap.get(item)];\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.getRecentTab().getRootNode().addItems(items);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.getRecentTab().getRootNode().hasChildren() && this.getRecentTab().getStub())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getRecentTab().getStub().show();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.getTagSelector())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isRendered())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isDropdownMode() && this.getActiveTab() === this.getRecentTab())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectFirstTab();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (!this.getActiveTab())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selectFirstTab();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusSearch();\n\t\t\t\t\tthis.destroyLoader();\n\n\t\t\t\t\tif (this.shouldFocusOnFirst())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusOnFirstNode();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.emit('onLoad');\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tthis.loadState = LoadState.UNSENT;\n\n\t\t\t\tif (this.getTagSelector())\n\t\t\t\t{\n\t\t\t\t\tthis.getTagSelector().unlock();\n\t\t\t\t}\n\n\t\t\t\tthis.focusSearch();\n\t\t\t\tthis.destroyLoader();\n\n\t\t\t\tthis.emit('onLoadError', { error });\n\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t}\n\n\tisLoaded(): boolean\n\t{\n\t\treturn this.loadState === LoadState.DONE;\n\t}\n\n\tisLoading(): boolean\n\t{\n\t\treturn this.loadState === LoadState.LOADING;\n\t}\n\n\thasDynamicLoad(): boolean\n\t{\n\t\tlet hasDynamicLoad = false;\n\t\tthis.entities.forEach((entity: Entity) => {\n\t\t\thasDynamicLoad = hasDynamicLoad || entity.hasDynamicLoad();\n\t\t});\n\n\t\treturn hasDynamicLoad;\n\t}\n\n\thasDynamicSearch(): boolean\n\t{\n\t\tlet hasDynamicSearch = false;\n\t\tthis.entities.forEach((entity: Entity) => {\n\t\t\thasDynamicSearch = hasDynamicSearch || (entity.isSearchable() && entity.hasDynamicSearch());\n\t\t});\n\n\t\treturn hasDynamicSearch;\n\t}\n\n\tsaveRecentItem(item: Item): void\n\t{\n\t\tif (this.getContext() === null || !item.isSaveable())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.recentItemsToSave.push(item);\n\t\tthis.saveRecentItemsWithDebounce();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsaveRecentItems(): void\n\t{\n\t\tif (!Type.isArrayFilled(this.recentItemsToSave))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tAjax.runAction('ui.entityselector.saveRecentItems', {\n\t\t\t\tjson: {\n\t\t\t\t\tdialog: this.getAjaxJson(),\n\t\t\t\t\trecentItems: this.recentItemsToSave.map((item: Item) => item.getAjaxJson())\n\t\t\t\t},\n\t\t\t\tgetParameters: {\n\t\t\t\t\tcontext: this.getContext()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then((response) => {\n\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\n\t\tthis.recentItemsToSave = [];\n\t}\n\n\tshouldClearUnavailableItems(): boolean\n\t{\n\t\treturn this.clearUnavailableItems;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorInput(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE && !this.isOpen())\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\n\t\tconst query = this.getTagSelector().getTextBoxValue();\n\t\tthis.search(query);\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAddButtonClick(): void\n\t{\n\t\tthis.show();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorTagRemove(event: BaseEvent): void\n\t{\n\t\tconst { tag } = event.getData();\n\n\t\tconst item = this.getItem({ id: tag.getId(), entityId: tag.getEntityId() });\n\t\tif (item)\n\t\t{\n\t\t\titem.deselect();\n\t\t}\n\n\t\tthis.focusSearch();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAfterTagRemove(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorAfterTagAdd(): void\n\t{\n\t\tthis.adjustByTagSelector();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tadjustByTagSelector(): void\n\t{\n\t\tif (this.getTagSelectorMode() === TagSelectorMode.OUTSIDE)\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t}\n\t\telse if (this.getTagSelectorMode() === TagSelectorMode.INSIDE)\n\t\t{\n\t\t\tconst newTagSelectorHeight = this.getTagSelector().calcHeight();\n\t\t\tif (newTagSelectorHeight > 0)\n\t\t\t{\n\t\t\t\tconst offset = newTagSelectorHeight - (this.tagSelectorHeight || this.getTagSelector().getMinHeight());\n\t\t\t\tthis.tagSelectorHeight = newTagSelectorHeight;\n\t\t\t\tif (offset !== 0)\n\t\t\t\t{\n\t\t\t\t\tconst height = this.getHeight();\n\t\t\t\t\tthis.setHeight(height + offset).then(() => {\n\t\t\t\t\t\tthis.adjustPosition();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleTagSelectorClick(): void\n\t{\n\t\tthis.focusSearch();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemSelect(item: Item, animate: boolean = true): void\n\t{\n\t\tconst shouldAnimate: boolean =\n\t\t\tthis.isMultiple()\n\t\t\t\t? animate\n\t\t\t\t: this.getSelectedItems().length === 0\n\t\t;\n\n\t\tif (!this.isMultiple())\n\t\t{\n\t\t\tthis.deselectAll();\n\n\t\t\tif (this.getSelectedItems().length > 0)\n\t\t\t{\n\t\t\t\tconsole.error('EntitySelector: some items are still selected.', this.getSelectedItems());\n\t\t\t}\n\t\t}\n\n\t\tif (this.getTagSelector() && this.shouldAddTagOnSelect())\n\t\t{\n\t\t\tconst tag: TagItemOptions = item.createTag();\n\t\t\ttag.animate = shouldAnimate;\n\t\t\tthis.getTagSelector().addTag(tag);\n\t\t}\n\n\t\tthis.selectedItems.add(item);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\thandleItemDeselect(item: Item): void\n\t{\n\t\tconst shouldAnimate: boolean = this.isMultiple();\n\n\t\tthis.selectedItems.delete(item);\n\n\t\tif (this.getTagSelector())\n\t\t{\n\t\t\tthis.getTagSelector().removeTag({\n\t\t\t\tid: item.getId(),\n\t\t\t\tentityId: item.getEntityId()\n\t\t\t}, shouldAnimate);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupAfterShow(): void\n\t{\n\t\tthis.focusSearch();\n\t\tthis.adjustByTagSelector();\n\n\t\tthis.emit('onShow');\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupFirstShow(): void\n\t{\n\t\tthis.emit('onFirstShow');\n\n\t\trequestAnimationFrame(() => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.addClass(this.getPopup().getPopupContainer(), 'ui-selector-popup-container');\n\t\t\t});\n\t\t});\n\n\t\tthis.observeTabOverlapping();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event: MouseEvent): void\n\t{\n\t\tconst target = event.target;\n\t\tconst el = this.getPopup().getPopupContainer();\n\t\tif (target === el || el.contains(target))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tthis.isTagSelectorOutside()\n\t\t\t&& target === this.getTagSelector().getTextBox()\n\t\t\t&& Type.isStringFilled(this.getTagSelector().getTextBoxValue())\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.autoHideHandler !== null)\n\t\t{\n\t\t\tconst result = this.autoHideHandler(event, this);\n\t\t\tif (Type.isBoolean(result))\n\t\t\t{\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tobserveTabOverlapping(): void\n\t{\n\t\tthis.disconnectTabOverlapping();\n\n\t\tthis.overlappingObserver = new MutationObserver(() => {\n\t\t\tif (this.getLabelsContainer().offsetWidth > 0)\n\t\t\t{\n\t\t\t\tconst left = parseInt(this.getPopup().getPopupContainer().style.left, 10);\n\t\t\t\tif (left < this.getMinLabelWidth())\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.getPopup().getPopupContainer(), 'left', `${this.getMinLabelWidth()}px`);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.overlappingObserver.observe(this.getPopup().getPopupContainer(), {\n\t\t\tattributes: true,\n\t\t\tattributeFilter: ['style']\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tdisconnectTabOverlapping(): void\n\t{\n\t\tif (this.overlappingObserver)\n\t\t{\n\t\t\tthis.overlappingObserver.disconnect();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupAfterClose(): void\n\t{\n\t\tif (this.isTagSelectorOutside())\n\t\t{\n\t\t\tif (this.getActiveTab() && this.getActiveTab() === this.getSearchTab())\n\t\t\t{\n\t\t\t\tthis.selectFirstTab();\n\t\t\t}\n\n\t\t\tthis.getTagSelector().clearTextBox();\n\t\t\tthis.getTagSelector().showAddButton();\n\t\t\tthis.getTagSelector().hideTextBox();\n\t\t}\n\n\t\tthis.emit('onHide');\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupDestroy(): void\n\t{\n\t\tthis.destroy();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleLabelsMouseEnter(): void\n\t{\n\t\tconst rect = Dom.getRelativePosition(this.getLabelsContainer(), this.getPopup().getTargetContainer());\n\t\tconst freeSpace = rect.right;\n\n\t\tif (freeSpace > this.getMinLabelWidth())\n\t\t{\n\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\n\t\t\tDom.style(this.getLabelsContainer(), 'max-width', `${Math.min(freeSpace, this.getMaxLabelWidth())}px`);\n\t\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleLabelsMouseLeave(): void\n\t{\n\t\tDom.addClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-show');\n\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--active');\n\n\t\tAnimation.handleTransitionEnd(this.getLabelsContainer(), 'max-width').then(() => {\n\t\t\tDom.removeClass(this.getLabelsContainer(), 'ui-selector-tab-labels--animate-hide');\n\t\t});\n\n\t\tDom.style(this.getLabelsContainer(), 'max-width', null);\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleItemNodeFocus(event: BaseEvent): void\n\t{\n\t\tconst { node } = event.getData();\n\t\tif (this.focusedNode === node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearNodeFocus();\n\n\t\tthis.focusedNode = node;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleItemNodeUnfocus(): void\n\t{\n\t\tthis.clearNodeFocus();\n\t}\n\n\tgetAjaxJson(): { [key: string]: any }\n\t{\n\t\treturn {\n\t\t\tid: this.getId(),\n\t\t\tcontext: this.getContext(),\n\t\t\tentities: this.getEntities(),\n\t\t\tpreselectedItems: this.getPreselectedItems(),\n\t\t\tclearUnavailableItems: this.shouldClearUnavailableItems()\n\t\t};\n\t}\n}","import Dialog from './dialog/dialog';\nimport Item from './item/item';\nimport Tab from './dialog/tabs/tab';\nimport Entity from './entity/entity';\nimport TagSelector from './tag-selector/tag-selector';\nimport BaseHeader from './dialog/header/base-header';\nimport DefaultHeader from './dialog/header/default-header';\nimport BaseFooter from './dialog/footer/base-footer';\nimport DefaultFooter from './dialog/footer/default-footer';\nimport BaseStub from './dialog/tabs/base-stub';\nimport DefaultStub from './dialog/tabs/default-stub';\n\nimport type { DialogOptions } from './dialog/dialog-options';\nimport type { TabOptions } from './dialog/tabs/tab-options';\nimport type { ItemOptions } from './item/item-options';\nimport type { EntityOptions } from './entity/entity-options';\nimport type { TagSelectorOptions } from './tag-selector/tag-selector-options';\n\nimport './css/dialog.css';\nimport './css/tab.css';\nimport './css/item.css';\nimport './css/tag-selector.css';\n\nconst EntitySelector = {\n\tDialog,\n\tItem,\n\tTab,\n\tEntity,\n\tTagSelector,\n\tBaseHeader,\n\tDefaultHeader,\n\tBaseFooter,\n\tDefaultFooter,\n\tBaseStub,\n\tDefaultStub\n};\n\n/**\n * @namespace BX.UI.EntitySelector\n */\nexport {\n\tEntitySelector,\n\tDialog,\n\tItem,\n\tTab,\n\tEntity,\n\tTagSelector,\n\tBaseHeader,\n\tDefaultHeader,\n\tBaseFooter,\n\tDefaultFooter,\n\tBaseStub,\n\tDefaultStub\n}\n\nexport type {\n\tDialogOptions,\n\tTabOptions,\n\tItemOptions,\n\tEntityOptions,\n\tTagSelectorOptions\n}"],"names":["ItemNodeComparator","order","props","Object","keys","map","property","Text","capitalize","directions","values","forEach","element","direction","toLowerCase","trim","ascOrdering","nullsOrdering","push","numberOfProperties","length","nodeA","nodeB","i","result","propertyGetter","compareItemNodes","itemA","getItem","itemB","getCustomData","get","valueA","valueB","Type","isString","localeCompare","sortOrder","TextNodeType","type","HTML","TEXT","TextNode","options","isPlainObject","text","isValid","getText","getType","textContent","innerHTML","Highlighter","matches","encode","isStringFilled","count","offset","chunk","match","getStartIndex","substring","getEndIndex","ItemBadge","badgeOptions","WeakMap","setTitle","title","setTextColor","textColor","setBgColor","bgColor","titleNode","getTitleNode","isNullable","target","container","containers","document","createElement","className","set","getContainer","renderTo","Dom","style","getTextColor","getBgColor","append","SearchField","fieldOptions","name","Error","setType","setSystem","system","setSort","sort","setSearchable","searchable","isNumber","flag","isBoolean","isSystem","MatchIndex","field","queryWord","startIndex","endIndex","comparator","a","b","MatchField","indexes","OrderedArray","addIndexes","matchIndexes","matchIndex","add","isArray","addIndex","Animation","propertyName","properties","Set","Promise","resolve","handler","event","has","size","Event","unbind","bind","animationName","regexp","isDataUri","str","encodeUrl","url","encodeURI","RenderMode","ItemNode","item","nodeOptions","Cache","MemoryCache","PARTIAL","Runtime","debounce","render","isObject","isFunction","itemOrder","makeMultipleComparator","children","renderMode","OVERRIDE","setSubtitle","setSupertitle","setCaption","setLinkTitle","avatar","avatarOptions","bgSize","bgImage","border","borderRadius","link","badges","captionOptions","fitContent","maxWidth","badgesOptions","subtitle","supertitle","caption","setCaptionOptions","setAvatar","setAvatarOptions","setLink","linkTitle","setBadges","setBadgesOptions","setDynamic","dynamic","setOpen","open","getParentNode","getTab","getDialog","tab","parentNode","siblings","getChildren","index","getIndex","getByIndex","childOptions","tabs","childItem","addItem","childNode","addChildren","child","isChildOf","childItems","setTab","setParentNode","isRendered","renderWithDebounce","isRoot","getDepthLevel","itemNode","createNode","addChild","items","disableRender","Item","enableRender","removeChildren","isFocused","unfocus","removeNode","remove","getOuterContainer","hasChildren","node","clear","Browser","isIE","clean","getChildrenContainer","parent","getFirst","getLast","isDynamic","dynamicPromise","Ajax","runAction","json","parentItem","getAjaxJson","dialog","getParameters","context","getContext","then","response","data","loaded","error","console","isLoaded","setAutoOpen","autoOpen","loader","Loader","getIndicatorContainer","getLoader","show","addClass","hide","removeClass","destroy","isOpen","loadChildren","destroyLoader","expand","showLoader","requestAnimationFrame","scrollHeight","handleTransitionEnd","offsetHeight","appendChildren","renderRoot","getTitleContainer","supertitleNode","getSupertitleNode","getSupertitleContainer","subtitleNode","getSubtitleNode","getSubtitleContainer","captionNode","getCaptionNode","getCaptionContainer","captionFitContent","getCaptionOption","captionMaxWidth","color","removeProperty","getAvatar","getAvatarContainer","backgroundImage","getAvatarOption","backgroundColor","backgroundSize","getBadgeContainer","getBadges","badge","badgesFitContent","getBadgesOption","badgesMaxWidth","linkTitleNode","getLinkTitleNode","getLinkTextContainer","getItemMaxDepth","classList","contains","hasVisibleChild","getAll","some","isHidden","toggleVisibility","highlight","renderChildren","isAutoOpen","rendered","stub","getStub","isAutoShow","hasDynamicLoad","previousSibling","insertAfter","hidden","option","isUndefined","value","setCaptionOption","setAvatarOption","replaceMacros","getLink","setBadgesOption","cache","remember","isSelected","div","appendChild","getItemsContainer","handleClick","handleMouseEnter","handleMouseLeave","getTitlesContainer","getLinkContainer","getTitleBoxContainer","anchor","href","handleLinkClick","span","highlights","getHighlights","matchField","getField","fieldName","getName","isCustom","mark","getMatches","focused","emit","collapse","isDeselectable","deselect","shouldHideOnDeselect","select","shouldClearSearchOnSelect","clearSearch","shouldHideOnSelect","focusSearch","tabContainer","nodeContainer","tabRect","getPosition","nodeRect","margin","top","scrollTop","bottom","click","stopPropagation","focus","showLink","hideLink","constructor","setAttribute","attr","offsetWidth","scrollWidth","replace","SearchFieldIndex","getIndexes","WordIndex","word","setWord","setStartIndex","rsAstralRange","rsComboMarksRange","reComboHalfMarksRange","rsComboSymbolsRange","rsComboMarksExtendedRange","rsComboMarksSupplementRange","rsComboRange","rsDingbatRange","rsLowerRange","rsMathOpRange","rsNonCharRange","rsPunctuationRange","rsSpaceRange","rsUpperRange","rsVarRange","rsBreakRange","rsApos","rsBreak","rsCombo","rsDigit","rsDingbat","rsLower","rsMisc","rsFitz","rsModifier","rsNonAstral","rsRegional","rsSurrPair","rsUpper","rsZWJ","rsMiscLower","rsMiscUpper","rsOptContrLower","rsOptContrUpper","reOptMod","rsOptVar","rsOptJoin","join","rsOrdLower","rsOrdUpper","rsSeq","rsEmoji","unicodeWordsRegExp","RegExp","asciiWordRegExp","hasUnicodeWordRegExp","nonWhitespaceRegExp","specialChars","specialCharsRegExp","SearchIndex","fieldIndex","entity","getEntity","isSearchable","searchFields","getSearchFields","textNode","stripTags","createIndex","getTitle","getSubtitle","getSupertitle","customData","repeat","wordIndexes","splitText","isArrayFilled","fillComplexWords","fillNonCharWords","position","indexOf","substr","hasUnicodeWord","splitUnicodeText","splitAsciiText","splitTextInternal","test","regExp","lastIndex","exec","complexWord","currentIndex","currentArrayIndex","nextIndex","sameWord","getWord","char","includes","wordToIndex","EntityFilter","filterOptions","id","getId","getOptions","Entity","entityOptions","Map","defaultOptions","getEntityDefaultOptions","merge","JSON","parse","stringify","itemOptions","tagOptions","substituteEntityId","filters","addFilter","fieldA","fieldB","getSort","setDynamicLoad","dynamicLoad","setDynamicSearch","dynamicSearch","setSearchFields","setSearchCacheLimits","searchCacheLimits","entityType","getOptionInternal","entityTypeBadges","getItemOption","getEntityType","conditions","condition","optionNodes","textNodes","undefined","itemOption","titleField","subtitleField","customFields","limits","limit","Array","from","filter","hasDynamicSearch","getFilters","getSubstituteEntityId","getExtensions","extension","settings","Extension","getSettings","entities","extensions","entityId","getDefaultOptions","getItemOptions","getTagOptions","TypeUtils","entries","obj","isMap","key","_classPrivateMethodInitSpec","selected","createMapFromOptions","setSaveable","saveable","setDeselectable","deselectable","setHidden","setContextSort","contextSort","setGlobalSort","globalSort","getEntityId","addEntity","resetSearchIndex","_classPrivateMethodGet","getEntityTextNode","getEntityItemOption","Loc","getMessage","nodes","preselectedMode","emitEvents","BaseEvent","isDefaultPrevented","handleItemSelect","getNodes","saveRecentItem","handleItemDeselect","getTagSelector","tag","getTag","searchIndex","create","getTagOption","getOptionTextNode","useItemOptions","fn","toPascalCase","getEntityTagOption","getTagGlobalOption","toJSON","getTagAvatar","getTagAvatarOptions","getTagLink","getTagMaxWidth","getTagTextColor","getTagBgColor","fontWeight","getTagFontWeight","isSaveable","getContextSort","getGlobalSort","convertMapToObject","BaseStub","autoShow","getOption","Tag","defaultValue","DefaultStub","getDefaultTitle","icon","getIcon","iconOpacity","Math","min","max","iconStyle","arrow","getActiveFooter","titleContainer","BaseHeader","Dialog","BaseFooter","Tab","tabOptions","setDialog","showDefaultHeader","showDefaultFooter","rootNode","setVisible","visible","setItemMaxDepth","itemMaxDepth","setIcon","setStub","stubOptions","setHeader","header","headerOptions","setFooter","footer","footerOptions","setShowAvatars","showAvatars","instance","Reflection","getClass","headerContent","createHeader","getHeader","adjustHeader","appendHeader","footerContent","createFooter","getFooter","adjustFooter","appendFooter","renderContainer","shouldShowAvatars","renderLabel","setProperty","state","getPropertyByState","states","labelState","isHovered","selectedHovered","hovered","depth","isVisible","handleLabelClick","handleLabelMouseEnter","handleLabelMouseLeave","getIconContainer","getRootNode","getPropertyByCurrentState","getLabelContainer","locked","selectTab","hover","unhover","TagItem","onclick","setMaxWidth","setFontWeight","selector","getSelector","selectorAvatarOption","getTagAvatarOption","entityTagAvatarOptions","entityItemAvatarOptions","width","getContentContainer","hasAvatar","getMaxWidth","getFontWeight","getRemoveIcon","handleContainerClick","getOnclick","handleRemoveIconClick","animate","handleAnimationEnd","removeTag","TagSelector","selectorOptions","setEventNamespace","getRandom","multiple","addButtonVisible","showAddButton","createButtonVisible","showCreateButton","textBoxVisible","showTextBox","setReadonly","readonly","setLocked","setAddButtonCaption","addButtonCaption","setAddButtonCaptionMore","addButtonCaptionMore","setCreateButtonCaption","createButtonCaption","setPlaceholder","placeholder","setTextBoxAutoHide","textBoxAutoHide","setTextBoxWidth","textBoxWidth","setMaxHeight","maxHeight","setTagAvatar","tagAvatar","setTagAvatarOptions","tagAvatarOptions","setTagMaxWidth","tagMaxWidth","setTagTextColor","tagTextColor","setTagBgColor","tagBgColor","setTagFontWeight","tagFontWeight","dialogOptions","selectedItems","concat","assign","tagSelectorOptions","isMultiple","tagSelector","addTag","subscribeFromOptions","events","getTextBox","disabled","isLocked","changed","updateTags","tagItem","getTags","find","isObjectLike","setSelector","removeTags","tags","insertBefore","toggleAddButtonCaption","el","isDomNode","isReadonly","getMaxHeight","getCreateButton","getAddButton","input","getPlaceholder","handleTextBoxInput","handleTextBoxBlur","handleTextBoxKeyUp","handleTextBoxKeyDown","getTextBoxWidth","getItemsHeight","getMinHeight","textBoxOldValue","autoHide","setTagAvatarOption","height","getAddButtonLink","getActualButtonCaption","handleAddButtonClick","getAddButtonCaptionMore","getAddButtonCaption","handleCreateButtonClick","getCreateButtonCaption","newValue","getTextBoxValue","clearTextBox","hideTextBox","preventDefault","isMac","metaKey","ctrlKey","hideAddButton","focusTextBox","EventEmitter","Navigation","subscribe","handleDialogShow","handleDialogHide","handleDialogDestroy","handleDocumentKeyDown","handleDocumentMouseMove","isEnabled","bindEvents","enabled","unbindEvents","unlockTab","getActiveNode","nextNode","currentNode","getFirstChild","getNextSibling","previousNode","getPreviousSibling","lastChild","getLastChild","getActiveTab","lastNode","getFocusedNode","scrollIntoView","activeTab","lockedTab","lock","unlock","enable","disable","altKey","keyName","keyMap","getSearchTab","call","lockTab","firstNode","getFirstNode","focusOnNode","getNextNode","getLastNode","getPreviousNode","selectFirstTab","shiftKey","previousTab","getPreviousTab","selectLastTab","nextTab","getNextTab","SliderIntegration","handleSliderOpen","handleSliderClose","handleSliderDestroy","BX","unsubscribe","slider","getFrameWindow","sliders","unfreeze","getData","sliderEvent","getSlider","isDialogInSlider","freeze","DefaultHeader","setContent","getContent","containerStyles","content","DefaultFooter","RecentTab","defaults","isDropdownMode","MatchResult","queryWords","matchFields","fieldSort","collator","Intl","Collator","sensitivity","SearchEngine","searchQuery","matchResults","getQueryWords","getResultLimit","matchResult","matchItem","results","matchWord","searchIndexes","getSearchIndex","j","compare","SearchQuery","query","split","cacheable","resultLimit","getDynamicSearchEntities","hasDynamicSearchEntity","dynamicSearchEntities","getQuery","SearchLoader","getBoxContainer","getSpacerContainer","getTextContainer","isShown","SearchTabFooter","handleOnSearch","handleMetaEnter","getQueryContainer","getLoaderContainer","label","finalize","hideLoader","emitAsync","getLastSearchQuery","clearResults","createItem","SearchTab","searchOptions","setAllowCreateItem","allowCreateItem","loadWithDebounce","load","dynamicEntities","getDynamicEntities","setDynamicSearchEntities","isEmpty","getSearchLoader","lastSearchQuery","matchItems","getItems","appendResults","shouldFocusOnFirst","focusOnFirstNode","shouldLoad","isEmptyResult","toggleEmptyResult","matchSortA","matchSortB","contextSortA","contextSortB","globalSortA","globalSortB","hasItem","setHighlights","getMatchFields","getEntities","hasCacheLimit","getSearchCacheLimits","pattern","isCacheable","found","queryCache","startsWith","isQueryCacheable","isQueryLoaded","addCacheQuery","onrequeststart","xhr","queryXhr","removeCacheQuery","searchTab","isTabEmpty","searchLoader","LoadState","TagSelectorMode","instances","UNSENT","saveRecentItems","clearUnavailableItems","compactView","dropdownMode","tagSelectorMode","OUTSIDE","setTagSelector","enableSearch","customOptions","mandatoryOptions","INSIDE","setTargetNode","targetNode","setHideOnSelect","hideOnSelect","setHideOnDeselect","hideOnDeselect","setAddTagOnSelect","addTagOnSelect","setClearSearchOnSelect","clearSearchOnSelect","setWidth","setHeight","setAutoHide","setAutoHideHandler","autoHideHandler","setHideByEsc","hideByEsc","setOffsetLeft","offsetLeft","setOffsetTop","offsetTop","setCacheable","setFocusOnFirst","focusOnFirst","recentTab","recentTabOptions","searchTabOptions","addTab","setPreselectedItems","preselectedItems","setUndeselectedItems","undeselectedItems","setOptions","preload","getPreselectedItems","popupOptions","allowedOptions","navigation","handleItemNodeFocus","handleItemNodeUnfocus","getPopup","close","destroying","disconnectTabOverlapping","hasOwnProperty","setPrototypeOf","popup","adjustPosition","queryString","search","undeselectable","getUndeselectedItems","itemId","String","entityItems","tabId","removeChild","getEntityItemsInternal","getItemsInternal","removeItem","prototype","apply","itemIds","insertTab","newActiveTab","clearNodeFocus","getLabelsContainer","getTabContentsContainer","getHeaderContainer","getFooterContainer","onlyVisible","getTabs","getRecentTab","activeFound","hasEntity","removeEntityItems","canShowDefaultHeader","canShowDefaultFooter","getSelectedItems","isNull","setBindElement","getTagSelectorMode","isTagSelectorOutside","setClosingByEsc","setOffset","getZindex","focusedNode","validateItemIds","maxLabelWidth","minLabelWidth","handleTagSelectorInput","handleTagSelectorAddButtonClick","handleTagSelectorTagRemove","handleTagSelectorAfterTagRemove","handleTagSelectorAfterTagAdd","handleTagSelectorClick","getTabsContainer","Popup","contentPadding","padding","getOffsetTop","getOffsetLeft","animation","showClassName","closeClassName","closeAnimationType","bindElement","getTargetNode","bindOptions","forceBindPosition","isAutoHide","handleAutoHide","closeByEsc","shouldHideByEsc","onFirstShow","handlePopupFirstShow","onAfterShow","handlePopupAfterShow","onAfterClose","handlePopupAfterClose","onDestroy","handlePopupDestroy","searchContainer","isCompactView","getWidth","getHeight","handleLabelsMouseEnter","handleLabelsMouseLeave","isFrozen","frozenProps","getNavigation","frozen","reject","recentItems","loadState","setTimeout","isLoading","LOADING","DONE","preselectedItem","nodeOptionsMap","itemsOptions","recentItem","addItems","recentItemsToSave","saveRecentItemsWithDebounce","adjustByTagSelector","newTagSelectorHeight","calcHeight","tagSelectorHeight","shouldAnimate","deselectAll","shouldAddTagOnSelect","createTag","getPopupContainer","observeTabOverlapping","overlappingObserver","MutationObserver","left","parseInt","getMinLabelWidth","observe","attributes","attributeFilter","disconnect","rect","getRelativePosition","getTargetContainer","freeSpace","right","getMaxLabelWidth","shouldClearUnavailableItems","EntitySelector"],"mappings":"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"}