this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(e,t,s,i,a){"use strict";const r=5e3;const l={props:{defaultData:{type:Object,default:null},fetchable:{type:Boolean,default:false},clickable:{type:Boolean,default:false}},data(){return{isFetching:false,timeout:null}},created(){i.EventEmitter.subscribe("landing:widgetvue:engine:onSetData",this.onSetData)},beforeUnmount(){i.EventEmitter.unsubscribe("landing:widgetvue:engine:onSetData",this.onSetData)},methods:{onSetData(e){clearTimeout(this.timeout);this.$bitrix.eventEmitter.emit("landing:widgetvue:engine:endContentLoad");this.$bitrix.eventEmitter.emit("landing:widgetvue:engine:onHideMessage");this.isFetching=false;if(a.Type.isObject(e.getData().data)){const t=e.getData().data;Object.keys(t).forEach((e=>{if(this[e]!==undefined){this[e]=t[e]}}))}},fetch(e={}){if(!this.clickable||this.isFetching){console.info("Events is disabled now");return}if(!this.fetchable){console.info("Fetch data is impossible now (haven`t handler)");return}this.isFetching=true;this.$bitrix.eventEmitter.emit("landing:widgetvue:engine:startContentLoad");this.timeout=setTimeout((()=>{this.$bitrix.eventEmitter.emit("landing:widgetvue:engine:onMessage",{message:a.Loc.getMessage("LANDING_WIDGETVUE_LOADER_TOO_LONG")});this.$bitrix.eventEmitter.emit("landing:widgetvue:engine:endContentLoad")}),r);this.$bitrix.Application.get().fetch(e)},openApplication(e={}){if(!this.clickable){console.info("Events is disabled now");return}this.$bitrix.Application.get().openApplication(e)},openPath(e){if(!this.clickable){console.info("Events is disabled now");return}this.$bitrix.Application.get().openPath(e)}},setup(e){const t={};if(a.Type.isObject(e.defaultData)){Object.keys(e.defaultData).forEach((i=>{t[i]=s.ref(e.defaultData[i])}))}return t}};const n={props:{message:{type:String,default:a.Loc.getMessage("LANDING_WIDGETVUE_LOADER_DEFAULT_MESSAGE")},link:{type:String,default:null},linkText:{type:String,default:a.Loc.getMessage("LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT")}},template:`\n\t\t<div class="w-loader">\n\t\t\t<div class="w-loader-icon"></div>\n\t\t\t<div class="w-loader-text">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const o={props:{message:{type:String,default:a.Loc.getMessage("LANDING_WIDGETVUE_ERROR_DEFAULT_MESSAGE")},link:{type:String,default:null},linkText:{type:String,default:a.Loc.getMessage("LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT")}},template:`\n\t\t<div class="w-error">\n\t\t\t<div class="w-loader-icon --error"></div>\n\t\t\t<div class="w-error-text">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t\t<a class="w-loader-link" :href="link">linkText: link</a>\t\n\t\t\t</div>\n\t\t</div>\n\t`};var d=babelHelpers.classPrivateFieldLooseKey("parentOrigin");var b=babelHelpers.classPrivateFieldLooseKey("id");var c=babelHelpers.classPrivateFieldLooseKey("rootNode");var v=babelHelpers.classPrivateFieldLooseKey("data");var h=babelHelpers.classPrivateFieldLooseKey("error");var g=babelHelpers.classPrivateFieldLooseKey("fetchable");var p=babelHelpers.classPrivateFieldLooseKey("clickable");var u=babelHelpers.classPrivateFieldLooseKey("application");var L=babelHelpers.classPrivateFieldLooseKey("contentComponent");var m=babelHelpers.classPrivateFieldLooseKey("message");var f=babelHelpers.classPrivateFieldLooseKey("bindEvents");var E=babelHelpers.classPrivateFieldLooseKey("onMessage");var P=babelHelpers.classPrivateFieldLooseKey("refreshFrameSize");var w=babelHelpers.classPrivateFieldLooseKey("createApp");class H{constructor(e){Object.defineProperty(this,w,{value:S});Object.defineProperty(this,P,{value:D});Object.defineProperty(this,E,{value:B});Object.defineProperty(this,f,{value:y});Object.defineProperty(this,m,{value:F});Object.defineProperty(this,d,{writable:true,value:""});Object.defineProperty(this,b,{writable:true,value:""});Object.defineProperty(this,c,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:false});Object.defineProperty(this,p,{writable:true,value:false});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,L,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=a.Type.isString(e.id)?e.id:"";babelHelpers.classPrivateFieldLooseBase(this,c)[c]=document.querySelector(`#${babelHelpers.classPrivateFieldLooseBase(this,b)[b]}`);babelHelpers.classPrivateFieldLooseBase(this,d)[d]=a.Type.isString(e.origin)?e.origin:null;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=a.Type.isObject(e.data)?e.data:null;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=a.Type.isString(e.error)?e.error:null;babelHelpers.classPrivateFieldLooseBase(this,g)[g]=a.Type.isBoolean(e.fetchable)?e.fetchable:false;babelHelpers.classPrivateFieldLooseBase(this,p)[p]=a.Type.isBoolean(e.clickable)?e.clickable:false;babelHelpers.classPrivateFieldLooseBase(this,L)[L]=a.Runtime.clone(l)}render(){if(babelHelpers.classPrivateFieldLooseBase(this,c)[c]){this.loader=new t.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,c)[c]});babelHelpers.classPrivateFieldLooseBase(this,L)[L].template=babelHelpers.classPrivateFieldLooseBase(this,c)[c].innerHTML||"";babelHelpers.classPrivateFieldLooseBase(this,L)[L].template=`<div>${babelHelpers.classPrivateFieldLooseBase(this,L)[L].template}</div>`;babelHelpers.classPrivateFieldLooseBase(this,f)[f]();babelHelpers.classPrivateFieldLooseBase(this,w)[w]()}}showLoader(){this.loader.show()}hideLoader(){this.loader.hide()}fetch(e={}){babelHelpers.classPrivateFieldLooseBase(this,m)[m]("fetchData",e)}openApplication(e={}){babelHelpers.classPrivateFieldLooseBase(this,m)[m]("openApplication",e)}openPath(e){babelHelpers.classPrivateFieldLooseBase(this,m)[m]("openPath",e)}}function F(e,t={}){window.parent.postMessage({name:e,params:t},babelHelpers.classPrivateFieldLooseBase(this,d)[d])}function y(){a.Event.bind(window,"message",babelHelpers.classPrivateFieldLooseBase(this,E)[E].bind(this))}function B(e){if(e.data&&e.data.name&&e.data.params){if(e.data.name==="setData"&&a.Type.isObject(e.data.params.data)){i.EventEmitter.emit("landing:widgetvue:engine:onSetData",{data:e.data.params.data})}if(e.data.name==="setError"&&a.Type.isObject(e.data.params.error)&&a.Type.isString(e.data.params.error.message)){i.EventEmitter.emit("landing:widgetvue:engine:onError",{message:e.data.params.error.message})}babelHelpers.classPrivateFieldLooseBase(this,P)[P]()}}function D(){babelHelpers.classPrivateFieldLooseBase(this,m)[m]("setSize",{size:document.body.offsetHeight})}function S(){const e=this;const t=babelHelpers.classPrivateFieldLooseBase(this,h)[h]?{message:babelHelpers.classPrivateFieldLooseBase(this,h)[h]}:null;babelHelpers.classPrivateFieldLooseBase(this,u)[u]=s.BitrixVue.createApp({name:babelHelpers.classPrivateFieldLooseBase(this,b)[b],components:{Message:n,Error:o,Content:babelHelpers.classPrivateFieldLooseBase(this,L)[L]},props:{defaultData:{type:Object,default:null}},data(){return{message:null,error:t}},created(){this.$bitrix.eventEmitter.subscribe("landing:widgetvue:engine:startContentLoad",this.onShowLoader);this.$bitrix.eventEmitter.subscribe("landing:widgetvue:engine:endContentLoad",this.onHideLoader);this.$bitrix.eventEmitter.subscribe("landing:widgetvue:engine:onMessage",this.onShowMessage);this.$bitrix.eventEmitter.subscribe("landing:widgetvue:engine:onHideMessage",this.onHideMessage);this.$bitrix.eventEmitter.subscribe("landing:widgetvue:engine:onError",this.onShowError);i.EventEmitter.subscribe("landing:widgetvue:engine:onError",this.onShowError)},beforeUnmount(){this.$bitrix.eventEmitter.unsubscribe("landing:widgetvue:engine:startContentLoad",this.onShowLoader);this.$bitrix.eventEmitter.unsubscribe("landing:widgetvue:engine:endContentLoad",this.onHideLoader);this.$bitrix.eventEmitter.unsubscribe("landing:widgetvue:engine:onMessage",this.onShowMessage);this.$bitrix.eventEmitter.unsubscribe("landing:widgetvue:engine:onHideMessage",this.onHideMessage);this.$bitrix.eventEmitter.unsubscribe("landing:widgetvue:engine:onError",this.onShowError);i.EventEmitter.unsubscribe("landing:widgetvue:engine:onError",this.onShowError)},methods:{onShowLoader(){this.$bitrix.Application.get().showLoader()},onHideLoader(){this.$bitrix.Application.get().hideLoader()},onShowMessage(e){var t;const s=((t=e.getData())==null?void 0:t.message)||null;this.message=s?{message:s}:null},onHideMessage(){this.message=null},onShowError(e){var t;const s=((t=e.getData())==null?void 0:t.message)||null;this.error=s?{message:s}:null}},beforeCreate(){this.$bitrix.Application.set(e)},template:`\n\t\t\t\t<div>\n\t\t\t\t\t<Error\n\t\t\t\t\t\tv-show="error !== null"\n\t\t\t\t\t\tv-bind="error && error.message !== null ? error : {}"\n\t\t\t\t\t/>\n\t\t\t\t\t<Message\n\t\t\t\t\t\tv-show="message !== null"\n\t\t\t\t\t\tv-bind="message && message.message !== null ? message : {}"\n\t\t\t\t\t/>\n\t\t\t\t\t<Content\n\t\t\t\t\t\tv-show="message === null && error === null"\n\t\t\t\t\t\t\n\t\t\t\t\t\t:defaultData="defaultData"\n\t\t\t\t\t\t:fetchable=${babelHelpers.classPrivateFieldLooseBase(this,g)[g]}\n\t\t\t\t\t\t:clickable=${babelHelpers.classPrivateFieldLooseBase(this,p)[p]}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t`},{defaultData:babelHelpers.classPrivateFieldLooseBase(this,v)[v]});babelHelpers.classPrivateFieldLooseBase(this,u)[u].mount(babelHelpers.classPrivateFieldLooseBase(this,c)[c])}e.Engine=H})(this.BX.Landing.WidgetVue=this.BX.Landing.WidgetVue||{},BX,BX.Vue3,BX.Event,BX);
//# sourceMappingURL=engine.bundle.map.js