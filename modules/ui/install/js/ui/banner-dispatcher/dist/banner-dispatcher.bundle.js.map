{"version":3,"file":"banner-dispatcher.bundle.js","sources":["../src/queue.js","../src/banner-dispatcher.js"],"sourcesContent":["import { LaunchPriority, AutoLauncher } from 'ui.auto-launch'\nimport { Type, Text } from 'main.core';\n\nexport class Queue\n{\n\t#priority: LaunchPriority;\n\t#delay: number;\n\t#itemList: Object = {};\n\t#enough: boolean = false;\n\t#launchPerHit: boolean = false;\n\n\tconstructor(priority: LaunchPriority, delay: number, launchPerHit: boolean = false)\n\t{\n\t\tthis.#delay = parseInt(delay) * 1000;\n\t\tthis.#priority = priority;\n\t\tthis.#launchPerHit = launchPerHit;\n\t}\n\n\tadd(callback: function): void\n\t{\n\t\tif (this.#enough)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isFunction(callback))\n\t\t{\n\t\t\tthrow new TypeError('Unexpected type \"promise\" argument, expected Promise or callback');\n\t\t}\n\t\tconst allowLaunchAfterOthers = !(this.#launchPerHit && Object.values(this.#itemList).length > 0);\n\t\tconst id = Text.getRandom();\n\t\tthis.#itemList[id] = callback;\n\n\t\tAutoLauncher.register(callback, {\n\t\t\tdelay: this.#delay,\n\t\t\tpriority: this.#priority,\n\t\t\tallowLaunchAfterOthers: allowLaunchAfterOthers,\n\t\t\tid: id\n\t\t})\n\t}\n\n\tgetItems(): Object\n\t{\n\t\treturn this.#itemList;\n\t}\n\n\tclean(): void\n\t{\n\t\tObject.keys(this.#itemList).forEach((id) => {\n\t\t\tthis.remove(id);\n\t\t});\n\t}\n\n\tenough(): void\n\t{\n\t\tthis.#enough = true;\n\t}\n\n\tnotEnough(): void\n\t{\n\t\tthis.#enough = false;\n\t}\n\n\tstop()\n\t{\n\t\tthis.clean();\n\t\tthis.enough();\n\t}\n\n\tremove(id: string): void\n\t{\n\t\tAutoLauncher.unregister(id);\n\t}\n}","import { LaunchPriority, } from 'ui.auto-launch';\nimport { Queue } from './queue';\n\nconst criticalQueue = new Queue(LaunchPriority.CRITICAL, 1);\nconst highQueue = new Queue(LaunchPriority.HIGH, 5, true);\nconst normalQueue = new Queue(LaunchPriority.NORMAL, 5, true);\n\nexport const BannerDispatcher = {\n\tcritical: {\n\t\ttoQueue: (promise) => {\n\t\t\tcriticalQueue.add(promise);\n\t\t}\n\t},\n\thigh: {\n\t\ttoQueue: (promise) => {\n\t\t\thighQueue.add(promise);\n\t\t}\n\t},\n\tnormal: {\n\t\ttoQueue: (promise) => {\n\t\t\tnormalQueue.add(promise);\n\t\t}\n\t},\n\n\ttoQueue: (promise) => {\n\t\tnormalQueue.add(promise);\n\t},\n\n\tonly(priorityList: Array<LaunchPriority>)\n\t{\n\t\tconst priorityValues = Object.values(LaunchPriority);\n\t\tpriorityValues.filter((priorityValue) => {\n\t\t\tif (!priorityList.includes(priorityValue))\n\t\t\t{\n\t\t\t\tswitch (priorityValue)\n\t\t\t\t{\n\t\t\t\t\tcase LaunchPriority.CRITICAL:\n\t\t\t\t\t\tcriticalQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase LaunchPriority.HIGH:\n\t\t\t\t\t\thighQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase LaunchPriority.NORMAL:\n\t\t\t\t\t\tnormalQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};"],"names":["Queue","constructor","priority","delay","launchPerHit","Object","writable","value","babelHelpers","parseInt","add","callback","this","Type","isFunction","TypeError","allowLaunchAfterOthers","values","length","id","Text","getRandom","AutoLauncher","register","getItems","clean","keys","forEach","remove","enough","notEnough","stop","unregister","criticalQueue","LaunchPriority","CRITICAL","highQueue","HIGH","normalQueue","NORMAL","BannerDispatcher","critical","toQueue","promise","high","normal","only","priorityList","filter","priorityValue","includes"],"mappings":"iDACuC,4QAEhC,MAAMA,EAQZC,YAAYC,EAA0BC,EAAeC,GAAwB,GAC7EC,8BAAAC,YAAAC,eAAAF,8BAAAC,YAAAC,eAAAF,8BAAAC,YAAAC,MALoB,KAAEF,8BAAAC,YAAAC,OACH,IAAKF,8BAAAC,YAAAC,OACC,IAIxBC,mDAAgC,IAAlBC,SAASN,GACvBK,mDAAiBN,EACjBM,mDAAqBJ,EAGtBM,IAAIC,GAEH,2CAAIC,WAEH,OAGD,IAAKC,OAAKC,WAAWH,GAEpB,MAAM,IAAII,UAAU,oEAErB,MAAMC,IAA2BR,oDAAsBH,OAAOY,+CAAOL,YAAgBM,OAAS,GACxFC,EAAKC,OAAKC,YAChBb,mDAAeW,GAAMR,EAErBW,eAAaC,SAASZ,EAAU,CAC/BR,8CAAOS,WACPV,iDAAUU,WACVI,uBAAwBA,EACxBG,GAAIA,IAINK,WAEC,+CAAOZ,WAGRa,QAECpB,OAAOqB,6CAAKd,YAAgBe,QAASR,IACpCP,KAAKgB,OAAOT,KAIdU,SAECrB,oDAAe,EAGhBsB,YAECtB,oDAAe,EAGhBuB,OAECnB,KAAKa,QACLb,KAAKiB,SAGND,OAAOT,GAENG,eAAaU,WAAWb,ICpE1B,MAAMc,EAAgB,IAAIjC,EAAMkC,iBAAeC,SAAU,GACnDC,EAAY,IAAIpC,EAAMkC,iBAAeG,KAAM,GAAG,GAC9CC,EAAc,IAAItC,EAAMkC,iBAAeK,OAAQ,GAAG,GAE3CC,EAAmB,CAC/BC,SAAU,CACTC,QAAUC,IACTV,EAAcvB,IAAIiC,KAGpBC,KAAM,CACLF,QAAUC,IACTP,EAAU1B,IAAIiC,KAGhBE,OAAQ,CACPH,QAAUC,IACTL,EAAY5B,IAAIiC,KAIlBD,QAAUC,IACTL,EAAY5B,IAAIiC,IAGjBG,KAAKC,GAEmB1C,OAAOY,OAAOiB,kBACtBc,OAAQC,IACtB,IAAKF,EAAaG,SAASD,GAE1B,OAAQA,GAEP,KAAKf,iBAAeC,SACnBF,EAAcF,OACd,MACD,KAAKG,iBAAeG,KACnBD,EAAUL,OACV,MACD,KAAKG,iBAAeK,OACnBD,EAAYP"}