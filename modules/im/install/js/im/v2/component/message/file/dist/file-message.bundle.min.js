this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(e,t,i,s,n,a,r,o,l,d,g,m,h,u,c){"use strict";function f(e,t){const i={10:["1-4","1-1","1-2","1-1","1-1","1-2","1-1","1-1","1-2","1-1"],9:["1-4","1-1","1-2","1-1","1-2","1-2","1-1","1-2","1-1"],8:["1-4","1-2","1-2","1-1","1-2","1-1","1-2","1-2"],7:["1-4","1-2","1-2","1-2","1-2","1-2","1-2"],6:["1-4","1-2","1-2","1-1","1-2","1-1"],5:["1-4","1-2","1-2","1-2","1-2"],4:["2-4","1-1","1-2","1-1"],3:["2-4","1-2","1-2"],2:["2-2","2-2"]};const s=i[e]&&i[e][t];if(!s){return{"grid-row-end":"span 1","grid-column-end":"span 1"}}const[n,a]=s.split("-");return{"grid-row-end":`span ${n}`,"grid-column-end":`span ${a}`}}function p(e){let t="140px 80px";if(e>=7){t="140px 80px 80px 58px"}else if(e>=3){t="140px 80px 80px"}return{gridTemplateRows:t}}const v={name:"ProgressBar",props:{item:{type:Object,required:true},messageId:{type:[String,Number],required:true},withLabels:{type:Boolean,default:true}},computed:{file(){return this.item}},watch:{"file.status":function(){this.getProgressBarManager().update()},"file.progress":function(){this.getProgressBarManager().update()}},mounted(){this.initProgressBar()},beforeUnmount(){this.removeProgressBar()},methods:{initProgressBar(){if(this.file.progress===100){return}let e;if(this.file.progress<0||!this.isImage&&!this.isVideo){e=false}const t={blurElement:e,hasTitle:false};if(!this.withLabels){t.labels={}}this.progressBarManager=new a.ProgressBarManager({container:this.$refs["progress-bar"],uploadState:this.file,customConfig:t});this.progressBarManager.subscribe(a.ProgressBarManager.event.cancel,(()=>{n.EventEmitter.emit(c.EventType.uploader.cancel,{tempFileId:this.file.id,tempMessageId:this.messageId})}));this.progressBarManager.subscribe(a.ProgressBarManager.event.destroy,(()=>{if(this.progressBar){this.progressBar=null}}));this.progressBarManager.start()},removeProgressBar(){if(!this.getProgressBarManager()){return}this.getProgressBarManager().destroy()},getProgressBarManager(){return this.progressBarManager}},template:`\n\t\t<div class="bx-im-progress-bar__container" ref="progress-bar"></div>\n\t`};const M=488;const y=340;const w=200;const I=100;const b={name:"GalleryItem",directives:{lazyload:i.lazyload},components:{ProgressBar:v},props:{id:{type:[String,Number],required:true},message:{type:Object,required:true},isGallery:{type:Boolean,default:false},handleLoading:{type:Boolean,default:true},removable:{type:Boolean,default:false},previewMode:{type:Boolean,default:false}},emits:["onRemoveClick"],computed:{messageItem(){return this.message},file(){return this.$store.getters["files/get"](this.id,true)},imageSize(){if(this.isGallery){return{}}let e=this.file.image.width;let t=this.file.image.height;if(this.file.image.width>M||this.file.image.height>y){const i=this.file.image.width/this.file.image.height;if(this.file.image.width>M){e=M;t=Math.round(M/i)}if(t>y){e=Math.round(y*i);t=y}}const i={width:Math.max(e,w),height:Math.max(t,I)};if(this.previewMode&&i.width>i.height){return{width:`${i.width}px`,"object-fit":i.width<100||i.height<100?"cover":"contain"}}return{width:`${i.width}px`,height:`${i.height}px`,"object-fit":i.width<100||i.height<100?"cover":"contain"}},viewerAttributes(){return d.Utils.file.getViewerDataAttributes(this.file.viewerAttrs)},canBeOpenedWithViewer(){var e;return this.file.viewerAttrs&&((e=BX.UI)==null?void 0:e.Viewer)},imageTitle(){const e=d.Utils.file.formatFileSize(this.file.size);return this.loc("IM_ELEMENTS_MEDIA_IMAGE_TITLE",{"#NAME#":this.file.name,"#SIZE#":e})},isLoaded(){return this.file.progress===100},isForward(){return g.Type.isStringFilled(this.messageItem.forward.id)},isVideo(){return this.file.type===c.FileType.video},previewSourceLink(){return this.isVideo?this.file.urlPreview:this.file.urlShow},allowLazyLoad(){return!this.previewSourceLink.startsWith("blob:")}},methods:{download(){var e;if(this.file.progress!==100||this.canBeOpenedWithViewer){return}const t=(e=this.file.urlDownload)!=null?e:this.file.urlShow;window.open(t,"_blank")},loc(e,t={}){return this.$Bitrix.Loc.getMessage(e,t)},onRemoveClick(){this.$emit("onRemoveClick",{file:this.file})}},template:`\n\t\t<div \n\t\t\tv-bind="viewerAttributes" \n\t\t\tclass="bx-im-gallery-item__container" \n\t\t\t:class="{'--with-forward': isForward}"\n\t\t\t@click="download"\n\t\t\t:style="imageSize"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-if="allowLazyLoad"\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src="previewSourceLink"\n\t\t\t\t:title="imageTitle"\n\t\t\t\t:alt="file.name"\n\t\t\t\tclass="bx-im-gallery-item__source"\n\t\t\t/>\n\t\t\t<img\n\t\t\t\tv-else\n\t\t\t\t:src="previewSourceLink"\n\t\t\t\t:title="imageTitle"\n\t\t\t\t:alt="file.name"\n\t\t\t\tclass="bx-im-gallery-item__source"\n\t\t\t/>\n\t\t\t<ProgressBar v-if="handleLoading && !isLoaded" :item="file" :messageId="messageItem.id" :withLabels="!isGallery" />\n\t\t\t<div v-if="isVideo" class="bx-im-gallery-item__play-icon-container">\n\t\t\t\t<div class="bx-im-gallery-item__play-icon"></div>\n\t\t\t</div>\n\t\t\t<div v-if="removable" class="bx-im-gallery-item__remove" @click="onRemoveClick">\n\t\t\t\t<div class="bx-im-gallery-item__remove-icon"></div>\n\t\t\t</div>\n\t\t</div>\n\t`};const B=5e6;const x=420;const _=340;const F=200;const S=100;const C=320;const T=180;const L={name:"VideoItem",components:{VideoPlayer:m.VideoPlayer,ProgressBar:v},props:{id:{type:[String,Number],required:true},message:{type:Object,required:true},handleLoading:{type:Boolean,default:true}},computed:{messageItem(){return this.message},file(){return this.$store.getters["files/get"](this.id,true)},autoplay(){return this.file.size<B},canBeOpenedWithViewer(){var e;return this.file.viewerAttrs&&((e=BX.UI)==null?void 0:e.Viewer)},viewerAttributes(){return d.Utils.file.getViewerDataAttributes(this.file.viewerAttrs)},imageSize(){let e=this.file.image.width;let t=this.file.image.height;if(!t||!e){return{width:`${C}px`,height:`${T}px`}}if(this.file.image.width>x||this.file.image.height>_){const i=this.file.image.width/this.file.image.height;if(this.file.image.width>x){e=x;t=Math.round(x/i)}if(t>_){e=Math.round(_*i);t=_}}const i={width:Math.max(e,F),height:Math.max(t,S)};return{width:`${i.width}px`,height:`${i.height}px`,"object-fit":i.width<100||i.height<100?"cover":"contain"}},isLoaded(){return this.file.progress===100},isForward(){return g.Type.isStringFilled(this.messageItem.forward.id)}},methods:{download(){var e;if(this.file.progress!==100||this.canBeOpenedWithViewer){return}const t=(e=this.file.urlDownload)!=null?e:this.file.urlShow;window.open(t,"_blank")}},template:`\n\t\t<div\n\t\t\tclass="bx-im-video-item__container bx-im-video-item__scope"\n\t\t\t:class="{'--with-forward': isForward}"\n\t\t\t@click="download"\n\t\t>\n\t\t\t<ProgressBar v-if="!isLoaded && handleLoading" :item="file" :messageId="messageItem.id" />\n\t\t\t<VideoPlayer\n\t\t\t\t:fileId="file.id"\n\t\t\t\t:src="file.urlShow"\n\t\t\t\t:previewImageUrl="file.urlPreview"\n\t\t\t\t:elementStyle="imageSize"\n\t\t\t\t:withAutoplay="autoplay"\n\t\t\t\t:withPlayerControls="isLoaded"\n\t\t\t\t:viewerAttributes="viewerAttributes"\n\t\t\t/>\n\t\t</div>\n\t`};const A=10;const P={name:"MediaContent",components:{GalleryItem:b,VideoItem:L,MessageStatus:h.MessageStatus},props:{item:{type:Object,required:true},previewMode:{type:Boolean,default:false},removable:{type:Boolean,default:false}},emits:["onRemoveItem"],computed:{message(){return this.item},fileIds(){return this.message.files.slice(0,A)},firstFileId(){return this.message.files[0]},isGallery(){return this.message.files.length>1},galleryRowConfig(){return p(this.fileIds.length)},galleryColumnsConfig(){if(this.previewMode){return{gridTemplateColumns:"119px 67px 67px 119px"}}return{}},galleryStyle(){return{...this.galleryRowConfig,...this.galleryColumnsConfig}},hasText(){return this.message.text.length>0},hasAttach(){return this.message.attach.length>0},onlyMedia(){return!this.previewMode&&!this.hasText&&!this.hasAttach},isSingleVideo(){if(this.isGallery){return false}return this.$store.getters["files/get"](this.firstFileId,true).type===c.FileType.video}},methods:{getGalleryElementStyles(e){return f(this.fileIds.length,e)},onRemoveItem(e){this.$emit("onRemoveItem",e)}},template:`\n\t\t<div class="bx-im-message-media-content__container">\n\t\t\t<div v-if="isGallery" class="bx-im-message-media-content__gallery" :style="galleryStyle">\n\t\t\t\t<GalleryItem\n\t\t\t\t\tv-for="(fileId, index) in fileIds"\n\t\t\t\t\t:key="fileId"\n\t\t\t\t\t:id="fileId"\n\t\t\t\t\t:isGallery="true"\n\t\t\t\t\t:message="message"\n\t\t\t\t\t:style="getGalleryElementStyles(index)"\n\t\t\t\t\t:handleLoading="!previewMode"\n\t\t\t\t\t:removable="removable"\n\t\t\t\t\t@onRemoveClick="onRemoveItem"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-else-if="isSingleVideo" class="bx-im-message-media-content__single-video">\n\t\t\t\t<VideoItem\n\t\t\t\t\t:id="firstFileId"\n\t\t\t\t\t:message="message"\n\t\t\t\t\t:handleLoading="!previewMode"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-else class="bx-im-message-media-content__single-image">\n\t\t\t\t<GalleryItem\n\t\t\t\t\t:id="firstFileId"\n\t\t\t\t\t:message="message"\n\t\t\t\t\t:handleLoading="!previewMode"\n\t\t\t\t\t:previewMode="previewMode"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-if="onlyMedia" class="bx-im-message-media-content__status-container">\n\t\t\t\t<MessageStatus :item="message" :isOverlay="true" />\n\t\t\t</div>\n\t\t</div>\n\t`};const E=305;const k=488;const D={name:"MediaMessage",components:{ReactionList:h.ReactionList,BaseMessage:u.BaseMessage,MessageStatus:h.MessageStatus,DefaultMessageContent:h.DefaultMessageContent,MessageHeader:h.MessageHeader,MessageFooter:h.MessageFooter,MediaContent:P},props:{item:{type:Object,required:true},dialogId:{type:String,required:true},withTitle:{type:Boolean,default:true},menuIsActiveForId:{type:[String,Number],default:0}},computed:{message(){return this.item},fileIds(){return this.message.files},dialog(){return this.$store.getters["chats/get"](this.dialogId)},hasText(){return this.message.text.length>0},hasAttach(){return this.message.attach.length>0},hasReply(){return this.message.replyId!==0},showContextMenu(){return this.onlyImage},showBottomContainer(){return this.hasText||this.hasAttach||this.hasReply},isForward(){return g.Type.isStringFilled(this.message.forward.id)},needBackground(){return this.showBottomContainer||this.isChannelPost||this.isForward},isChannelPost(){return[c.ChatType.channel,c.ChatType.openChannel].includes(this.dialog.type)},imageContainerStyles(){let e=k;if(this.fileIds.length>1){e=E}return{"max-width":`${e}px`}}},template:`\n\t\t<BaseMessage :item="item" :dialogId="dialogId" :withBackground="needBackground">\n\t\t\t<div class="bx-im-message-image__container" :style="imageContainerStyles">\n\t\t\t\t<MessageHeader :withTitle="false" :item="item" class="bx-im-message-image__header" />\n\t\t\t\t<MediaContent :item="message" />\n\t\t\t\t<div v-if="showBottomContainer" class="bx-im-message-image__bottom-container">\n\t\t\t\t\t<DefaultMessageContent\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t:withText="hasText"\n\t\t\t\t\t\t:withAttach="hasAttach"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<MessageFooter :item="item" :dialogId="dialogId" />\n\t\t\t</div>\n\t\t\t<template #after-message>\n\t\t\t\t<div v-if="!showBottomContainer" class="bx-im-message-image__reaction-list-container">\n\t\t\t\t\t<ReactionList :messageId="message.id" :contextDialogId="dialogId" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</BaseMessage>\n\t`};var V=babelHelpers.classPrivateFieldLooseKey("getMessageFile");class X extends o.BaseMenu{constructor(){super();Object.defineProperty(this,V,{value:$});this.id=c.PopupType.messageBaseFileMenu;this.id="bx-im-message-file-context-menu";this.diskService=new r.DiskService}getMenuItems(){return[this.getDownloadFileItem(),this.getSaveToDiskItem()]}getDownloadFileItem(){const e=babelHelpers.classPrivateFieldLooseBase(this,V)[V]();if(!e){return null}return{html:d.Utils.file.createDownloadLink(g.Loc.getMessage("IM_MESSAGE_FILE_MENU_DOWNLOAD_FILE"),e.urlDownload,e.name),onclick:function(){this.menuInstance.close()}.bind(this)}}getSaveToDiskItem(){const e=babelHelpers.classPrivateFieldLooseBase(this,V)[V]();if(!e){return null}return{text:g.Loc.getMessage("IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_MSGVER_1"),onclick:function(){void this.diskService.save(this.context.files).then((()=>{BX.UI.Notification.Center.notify({content:g.Loc.getMessage("IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_SUCCESS_MSGVER_1")})}));this.menuInstance.close()}.bind(this)}}}function $(){if(!this.context.fileId){return null}return this.store.getters["files/get"](this.context.fileId)}const O={name:"BaseFileItem",components:{ProgressBar:v},props:{id:{type:[String,Number],required:true},messageId:{type:[String,Number],required:true}},computed:{file(){return this.$store.getters["files/get"](this.id,true)},fileShortName(){const e=20;return d.Utils.file.getShortFileName(this.file.name,e)},fileSize(){return d.Utils.file.formatFileSize(this.file.size)},iconClass(){const e=d.Utils.file.getIconTypeByFilename(this.file.name);return`ui-icon-file-${e}`},canBeOpenedWithViewer(){var e;return this.file.viewerAttrs&&((e=BX.UI)==null?void 0:e.Viewer)},viewerAttributes(){return d.Utils.file.getViewerDataAttributes(this.file.viewerAttrs)},isLoaded(){return this.file.progress===100},imageStyles(){return{backgroundImage:`url(${this.file.urlPreview})`}},hasPreview(){return g.Type.isStringFilled(this.file.urlPreview)}},created(){this.contextMenu=new X},beforeUnmount(){this.contextMenu.destroy()},methods:{download(){var e;if(this.file.progress!==100||this.canBeOpenedWithViewer){return}const t=(e=this.file.urlDownload)!=null?e:this.file.urlShow;window.open(t,"_blank")},loc(e,t={}){return this.$Bitrix.Loc.getMessage(e,t)},openContextMenu(e){this.$emit("openContextMenu",{event:e,fileId:this.id})}},template:`\n\t\t<div class="bx-im-base-file-item__container">\n\t\t\t<div class="bx-im-base-file-item__icon-container" ref="loader-icon" v-bind="viewerAttributes" @click="download">\n\t\t\t\t<ProgressBar v-if="!isLoaded" :item="file" :messageId="messageId" :withLabels="false" />\n\t\t\t\t<div v-if="hasPreview" :style="imageStyles" class="bx-im-base-file-item__image"></div>\n\t\t\t\t<div v-else :class="iconClass" class="bx-im-base-file-item__type-icon ui-icon"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class="bx-im-base-file-item__content" v-bind="viewerAttributes" @click="download">\n\t\t\t\t<span :title="file.name" class="bx-im-base-file-item__title">\n\t\t\t\t\t{{ fileShortName }}\n\t\t\t\t</span>\n\t\t\t\t<div class="bx-im-base-file-item__size">{{ fileSize }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass="bx-im-base-file-item__download-icon"\n\t\t\t\t:class="{'--not-active': !isLoaded}"\n\t\t\t\t@click="openContextMenu"\n\t\t\t></div>\n\t\t</div>\n\t`};const R={name:"BaseFileMessage",components:{BaseMessage:u.BaseMessage,DefaultMessageContent:h.DefaultMessageContent,BaseFileItem:O,MessageHeader:h.MessageHeader,MessageFooter:h.MessageFooter},props:{item:{type:Object,required:true},dialogId:{type:String,required:true},withTitle:{type:Boolean,default:true}},computed:{FileType:()=>c.FileType,message(){return this.item},messageFile(){const e=this.message.files[0];return this.$store.getters["files/get"](e,true)}},created(){this.contextMenu=new X},beforeUnmount(){this.contextMenu.destroy()},methods:{onOpenContextMenu({event:e,fileId:t}){const i={dialogId:this.dialogId,fileId:t,...this.message};this.contextMenu.openMenu(i,e.target)}},template:`\n\t\t<BaseMessage :item="item" :dialogId="dialogId">\n\t\t\t<div class="bx-im-message-base-file__container">\n\t\t\t\t<MessageHeader :withTitle="withTitle" :item="item" class="bx-im-message-base-file__author-title" />\n\t\t\t\t<BaseFileItem\n\t\t\t\t\t:key="messageFile.id"\n\t\t\t\t\t:id="messageFile.id"\n\t\t\t\t\t:messageId="message.id"\n\t\t\t\t\t@openContextMenu="onOpenContextMenu"\n\t\t\t\t/>\n\t\t\t\t<DefaultMessageContent :item="item" :dialogId="dialogId" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item="item" :dialogId="dialogId" />\n\t\t</BaseMessage>\n\t`};const U={name:"AudioItem",components:{AudioPlayer:m.AudioPlayer,ProgressBar:v},props:{item:{type:Object,required:true},messageType:{type:String,required:true},messageId:{type:[String,Number],required:true}},computed:{file(){return this.item},isLoaded(){return this.file.progress===100}},template:`\n\t\t<div class="bx-im-media-audio__container">\n\t\t\t<ProgressBar v-if="!isLoaded" :item="file" :messageId="messageId" />\n\t\t\t<AudioPlayer\n\t\t\t\t:id="file.id"\n\t\t\t\t:messageId="messageId"\n\t\t\t\t:src="file.urlShow"\n\t\t\t\t:file="file"\n\t\t\t\t:timelineType="Math.floor(Math.random() * 5)"\n\t\t\t\t:authorId="file.authorId"\n\t\t\t\t:withContextMenu="false"\n\t\t\t\t:withAvatar="false"\n\t\t\t/>\n\t\t</div>\n\t`};const N={name:"AudioMessage",components:{BaseMessage:u.BaseMessage,MessageHeader:h.MessageHeader,MessageFooter:h.MessageFooter,DefaultMessageContent:h.DefaultMessageContent,AudioItem:U},props:{item:{type:Object,required:true},dialogId:{type:String,required:true},withTitle:{type:Boolean,default:false}},computed:{FileType:()=>c.FileType,message(){return this.item},messageFile(){const e=this.message.files[0];return this.$store.getters["files/get"](e,true)},canSetReactions(){return g.Type.isNumber(this.message.id)},messageType(){return this.$store.getters["messages/getMessageType"](this.message.id)}},template:`\n\t\t<BaseMessage :item="item" :dialogId="dialogId">\n\t\t\t<div class="bx-im-message-audio__container">\n\t\t\t\t<MessageHeader :withTitle="withTitle" :item="item" class="bx-im-message-audio__header"/>\n\t\t\t\t<AudioItem\n\t\t\t\t\t:key="messageFile.id"\n\t\t\t\t\t:item="messageFile"\n\t\t\t\t\t:messageId="message.id"\n\t\t\t\t\t:messageType="messageType"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="bx-im-message-audio__default-message-container">\n\t\t\t\t<DefaultMessageContent :item="item" :dialogId="dialogId" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item="item" :dialogId="dialogId" />\n\t\t</BaseMessage>\n\t`};const q=10;const G={name:"FileCollectionMessage",components:{BaseMessage:u.BaseMessage,DefaultMessageContent:h.DefaultMessageContent,BaseFileItem:O,MessageHeader:h.MessageHeader,MessageFooter:h.MessageFooter},props:{item:{type:Object,required:true},dialogId:{type:String,required:true},withTitle:{type:Boolean,default:true}},computed:{FileType:()=>c.FileType,message(){return this.item},messageId(){return this.message.id},fileIds(){return this.message.files.slice(0,q)}},created(){this.contextMenu=new X},beforeUnmount(){this.contextMenu.destroy()},methods:{onOpenContextMenu({event:e,fileId:t}){const i={dialogId:this.dialogId,fileId:t,...this.message};this.contextMenu.openMenu(i,e.target)}},template:`\n\t\t<BaseMessage :item="item" :dialogId="dialogId">\n\t\t\t<div class="bx-im-message-file-collection__container">\n\t\t\t\t<MessageHeader :withTitle="withTitle" :item="item" class="bx-im-message-file-collection__author-title" />\n\t\t\t\t<div class="bx-im-message-file-collection__items">\n\t\t\t\t\t<BaseFileItem\n\t\t\t\t\t\tv-for="fileId in fileIds"\n\t\t\t\t\t\t:key="fileId"\n\t\t\t\t\t\t:id="fileId"\n\t\t\t\t\t\t:messageId="messageId"\n\t\t\t\t\t\t@openContextMenu="onOpenContextMenu"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<DefaultMessageContent \n\t\t\t\t\t:item="item" \n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\tclass="bx-im-message-file-collection__default-content" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<MessageFooter :item="item" :dialogId="dialogId" />\n\t\t</BaseMessage>\n\t`};const z=Object.freeze({media:"MediaMessage",audio:"AudioMessage",base:"BaseFileMessage",collection:"FileCollectionMessage"});const j={name:"FileMessage",components:{BaseFileMessage:R,MediaMessage:D,AudioMessage:N,UnsupportedMessage:t.UnsupportedMessage,FileCollectionMessage:G},props:{item:{type:Object,required:true},dialogId:{type:String,required:true},withTitle:{type:Boolean,default:true},menuIsActiveForId:{type:[String,Number],default:0}},computed:{FileType:()=>c.FileType,message(){return this.item},messageFiles(){const e=[];if(this.message.files.length===0){return e}this.message.files.forEach((t=>{const i=this.$store.getters["files/get"](t,true);e.push(i)}));return e},isGallery(){const e=new Set([c.FileType.image,c.FileType.video]);const t=this.messageFiles.every((t=>e.has(t.type)));const i=this.messageFiles.some((e=>e.image!==false));return t&&i},componentName(){if(this.messageFiles.length>1){return this.isGallery?z.media:z.collection}const e=this.messageFiles[0];const t=Boolean(e.image);if(e.type===c.FileType.image&&t){return z.media}if(e.type===c.FileType.audio){return z.audio}const i=e.type===c.FileType.video||d.Utils.file.getFileExtension(e.name)==="mkv";if(i&&t){return z.media}return z.base},isRealMessage(){return this.$store.getters["messages/isRealMessage"](this.message.id)}},template:`\n\t\t<component \n\t\t\t:is="componentName" \n\t\t\t:item="message" \n\t\t\t:dialogId="dialogId"\n\t\t\t:withTitle="withTitle" \n\t\t\t:menuIsActiveForId="menuIsActiveForId"\n\t\t\t:withRetryButton="false"\n\t\t\t:withContextMenu="isRealMessage"\n\t\t/>\n\t`};e.FileMessage=j;e.MediaContent=P})(this.BX.Messenger.v2.Component.Message=this.BX.Messenger.v2.Component.Message||{},BX.Messenger.v2.Component.Message,BX.Vue3.Directives,BX.Messenger.v2.Model,BX.Event,BX.Messenger.v2.Lib,BX.Messenger.v2.Service,BX.Messenger.v2.Lib,BX,BX.Messenger.v2.Lib,BX,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Component.Message,BX.Messenger.v2.Component.Message,BX.Messenger.v2.Const);
//# sourceMappingURL=file-message.bundle.map.js