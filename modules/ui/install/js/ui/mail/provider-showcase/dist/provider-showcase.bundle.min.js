this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,s,i,t){"use strict";let a=e=>e,r,o,n,l,d,c,p;const v=BX.SidePanel;const h="mailProviderShowcase";const m="mail-mailbox-config-success";const u="other";const b="mailbox";var I=babelHelpers.classPrivateFieldLooseKey("wasSenderUpdated");var g=babelHelpers.classPrivateFieldLooseKey("createSmtpItemNode");var S=babelHelpers.classPrivateFieldLooseKey("createShowcase");var L=babelHelpers.classPrivateFieldLooseKey("createProvidersList");var E=babelHelpers.classPrivateFieldLooseKey("createPromotionShowcase");var _=babelHelpers.classPrivateFieldLooseKey("getProviderKey");var P=babelHelpers.classPrivateFieldLooseKey("getProviderName");var M=babelHelpers.classPrivateFieldLooseKey("getProviderImgSrcClass");class f{constructor(e=null){var i,t,o,n;Object.defineProperty(this,M,{value:w});Object.defineProperty(this,P,{value:N});Object.defineProperty(this,_,{value:B});Object.defineProperty(this,E,{value:O});Object.defineProperty(this,L,{value:R});Object.defineProperty(this,S,{value:C});Object.defineProperty(this,g,{value:A});Object.defineProperty(this,I,{writable:true,value:false});this.isSender=(i=e.isSender)!=null?i:false;this.setSenderCallback=(t=e.setSenderCallback)!=null?t:null;this.addSenderCallback=(o=e.addSenderCallback)!=null?o:null;this.updateSenderList=(n=e.updateSenderList)!=null?n:null;this.container=s.Tag.render(r||(r=a`
			<div class="showcase-container"></div>
		`))}static openSlider(e){const a=new f(e);const r=function(e){const[i]=e.getData();if(!i){return}const r=v.Instance.getSlider(h);if(!r||i.getEventId()!==m){return}const o=i.data.id;if(!o){return}babelHelpers.classPrivateFieldLooseBase(a,I)[I]=true;r.close();top.BX.SidePanel.Instance.postMessage(window,i.getEventId(),i.data);s.ajax.runAction("main.api.mail.sender.getSenderByMailboxId",{data:{mailboxId:o,getSenderWithoutSmtp:!a.options.isCloud}}).then((e=>{const s=e.data;if(!s){return}a.setSender(s.id,s.name,s.email);if(a.addSenderCallback||s.type===b){return}t.AliasEditor.openSlider({senderId:s.id,email:s.email,setSenderCallback:a.setSenderCallback,updateSenderList:()=>{void a.updateSenderList()}})})).catch((()=>{}))};v.Instance.open(h,{width:790,cacheable:false,contentCallback:()=>i.Layout.createContent({extensions:["ui.mail.provider-showcase"],title:s.Loc.getMessage("UI_MAIL_PROVIDER_SHOWCASE_TITLE"),design:{section:false},content(){return a.load()},buttons:()=>{}}),events:{onClose:()=>{top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onMessage",r);if(a.updateSenderList&&babelHelpers.classPrivateFieldLooseBase(a,I)[I]){a.updateSenderList()}}}});top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onMessage",r)}static renderTo(e,i){const t=new f(i);return new Promise(((i,a)=>{t.load().then((t=>{s.Dom.append(t,e);i(t)})).catch((()=>{a()}))}))}load(){return s.ajax.runAction("main.api.mail.mailproviders.getShowcaseParams",{data:{isSender:this.isSender?1:0}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S](e.data);return this.container})).catch((()=>{}))}setSender(e,s,i){const t=s;const a=i;if(this.setSenderCallback){this.setSenderCallback(e,t,a)}if(!this.addSenderCallback){return}const r=[];r.name=t;r.email=a;this.addSenderCallback(r)}}function A(){this.smtpNode=s.Tag.render(o||(o=a`
			<div class="mail-provider-item mail-provider-item-available">
				<div class="mail-provider-img-container">
					<div class="mail-provider-img-smtp"></div>
				</div>
				<div class="mail-provider-item-title-container">
					<span class="mail-provider-item-title">${0}</span>
				</div>
			</div>
		`),s.Loc.getMessage("UI_MAIL_PROVIDER_SMTP_TITLE"));s.Event.bind(this.smtpNode,"click",(()=>{const e=BX.SidePanel.Instance.getTopSlider();if(e){t.SmtpEditor.openSlider({setSenderCallback:(s,i,t)=>{if(this.setSenderCallback&&s&&i&&t){this.setSenderCallback(s,i,t)}this.updateSenderList();e.close()},addSenderCallback:this.addSenderCallback})}}));if(this.options.isMailToolAvailable&&this.options.canConnectNewMailbox){return}s.Dom.addClass(this.smtpNode,"available-mail-provider-item");s.Dom.attr(this.smtpNode,"data-tag",s.Loc.getMessage("UI_MAIL_PROVIDER_AVAILABLE_TAG"))}function C(e){this.options=e.options;this.providers=e.providers;this.showcaseNode=s.Tag.render(n||(n=a`
			<div class="mail-provider-list"></div>
		`));s.Dom.append(this.showcaseNode,this.container);babelHelpers.classPrivateFieldLooseBase(this,L)[L]();if(!this.isSender||!this.options.isSmtpAvailable){return}babelHelpers.classPrivateFieldLooseBase(this,g)[g]();const i=this.showcaseNode.firstChild;if(!i||this.options.canConnectNewMailbox&&this.options.isMailToolAvailable){s.Dom.append(this.smtpNode,this.showcaseNode)}else{s.Dom.insertBefore(this.smtpNode,i)}if(this.options.isModuleMailInstalled){return}babelHelpers.classPrivateFieldLooseBase(this,E)[E]()}function R(){if(!this.providers){return}this.providers.forEach((e=>{var i;const t=babelHelpers.classPrivateFieldLooseBase(this,_)[_](e.name);const{root:r,title:o}=s.Tag.render(l||(l=a`
				<a class="mail-provider-item mail-provider-item-available">
					<div class="mail-provider-img-container">
						<div class="mail-provider-img ${0}"></div>
					</div>
					<div class="mail-provider-item-title-container" ref="title">
						<span class="mail-provider-item-title">${0}</span>
					</div>
				</a>
			`),babelHelpers.classPrivateFieldLooseBase(this,M)[M](t),s.Text.encode((i=babelHelpers.classPrivateFieldLooseBase(this,P)[P](t))!=null?i:name.charAt(0).toUpperCase()));if(e.name===u){const e=s.Tag.render(d||(d=a`
					<span class="mail-provider-item-subtitle">${0}</span>
				`),s.Loc.getMessage("UI_MAIL_PROVIDER_IMAP_SUBTITLE"));s.Dom.append(e,o)}if(!this.options.isMailToolAvailable){s.Event.bind(r,"click",(()=>{BX.UI.InfoHelper.show(this.options.toolLimitSliderCode)}))}else if(this.options.canConnectNewMailbox){s.Event.bind(r,"click",(()=>{v.Instance.open(e.href,{width:760})}))}else{s.Event.bind(r,"click",(()=>{const e=BX.Intranet?BX.UI.FeaturePromotersRegistry:top.BX.UI.FeaturePromotersRegistry;e.getPromoter({code:this.options.mailboxLimitSliderCode,bindElement:o}).show()}))}s.Dom.append(r,this.showcaseNode);if(!this.isSender||!this.options.isMailToolAvailable||!this.options.canConnectNewMailbox){return}s.Dom.insertBefore(r,this.smtpNode)}))}function O(){if(!this.options.promotionProviders){return}const e=s.Loc.getMessage("UI_MAIL_PROMOTION_TEXT",{"[strong]":"<strong>","[/strong]":"</strong>"});const{root:i,providerList:t}=s.Tag.render(c||(c=a`
			<div class="promotion-showcase">
				<div class="ui-alert ui-alert-icon-info ui-alert-primary">
					<span class="ui-alert-message">${0}</span>
				</div>
				<div class="mail-provider-list" ref="providerList" style="margin-top: 10px"></div>
			</div>
		`),e);this.promotionShowcaseNode=i;this.options.promotionProviders.forEach((e=>{var i;const r=s.Text.encode(e);const o=s.Tag.render(p||(p=a`
				<a class="mail-provider-item mail-provider-item-unavailable">
					<div class="mail-provider-img-container">
						<div class="mail-provider-img ${0}"></div>
					</div>
					<div class="mail-provider-item-title-container">
						<span class="mail-provider-item-title">${0}</span>
					</div>
				</a>
			`),babelHelpers.classPrivateFieldLooseBase(this,M)[M](r),s.Text.encode((i=babelHelpers.classPrivateFieldLooseBase(this,P)[P](r))!=null?i:r.charAt(0).toUpperCase()));s.Dom.append(o,t)}));s.Dom.append(this.promotionShowcaseNode,this.container)}function B(e){switch(e){case"aol":return"aol";case"gmail":return"gmail";case"yahoo":return"yahoo";case"mail.ru":case"mailru":return"mailru";case"icloud":return"icloud";case"outlook.com":case"outlook":return"outlook";case"office365":return"office365";case"exchangeOnline":case"exchange":return"exchange";case"yandex":return"yandex";case"ukr.net":return"ukrnet";case"other":case"imap":return"other";default:return""}}function N(e){switch(e){case"aol":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_AOL");case"gmail":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_GMAIL");case"yahoo":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_YAHOO");case"mailru":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_MAILRU");case"icloud":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_ICLOUD");case"outlook":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_OUTLOOK");case"office365":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_OFFICE365");case"exchange":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_EXCHANGE");case"yandex":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_YANDEX");case"other":return s.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_IMAP");default:return null}}function w(e){return`mail-provider-${e}-img`}e.ProviderShowcase=f})(this.BX.UI.Mail=this.BX.UI.Mail||{},BX,BX.UI.SidePanel,BX.UI.Mail);
//# sourceMappingURL=provider-showcase.bundle.map.js