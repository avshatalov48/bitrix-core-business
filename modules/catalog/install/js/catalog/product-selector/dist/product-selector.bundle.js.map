{"version":3,"file":"product-selector.bundle.js","sources":["../src/models/base.js","../src/product-creation-limited-footer.js","../src/product-search-input.js","../src/product-image-input.js","../src/models/empty.js","../src/models/product.js","../src/models/sku.js","../src/models/simple.js","../src/product-selector.js"],"sourcesContent":["import {Text, Type} from 'main.core';\n\nexport class Base\n{\n\tconstructor(id, config = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.config = config || {};\n\t\tthis.errors = {};\n\t\tthis.setMorePhotoValues(config.morePhoto);\n\t\tthis.setFields(config.fields);\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetProductId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tsetSaveable(value)\n\t{\n\t\tthis.config.saveProductFields = value;\n\t}\n\n\tisNew(): boolean\n\t{\n\t\treturn this.getConfig('isNew', false);\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.config, name, defaultValue);\n\t}\n\n\tgetFields()\n\t{\n\t\treturn this.fields;\n\t}\n\n\tgetField(fieldName, defaultValue = '')\n\t{\n\t\treturn BX.prop.get(this.fields, fieldName, defaultValue);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tthis.fields = Type.isObject(fields) ? fields : {};\n\t}\n\n\tgetErrors()\n\t{\n\t\treturn this.errors;\n\t}\n\n\tsetError(code, text)\n\t{\n\t\tthis.errors[code] = text;\n\t}\n\n\tclearErrors(code, text)\n\t{\n\t\tthis.errors = {};\n\t}\n\n\thasErrors()\n\t{\n\t\treturn Object.keys(this.errors).length > 0;\n\t}\n\n\tisEnableFileSaving(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tgetMorePhotoValues()\n\t{\n\t\treturn this.morePhoto;\n\t}\n\n\tsetMorePhotoValues(values)\n\t{\n\t\tthis.morePhoto = Type.isPlainObject(values) ? values : {};\n\t}\n\n\tremoveMorePhotoItem(fileId): boolean\n\t{\n\t\treturn false;\n\t}\n\n\taddMorePhotoItem(fileId, value)\n\t{\n\t\tthis.morePhoto[fileId] = value;\n\t}\n\n\tsetFileType(value): string\n\t{\n\t\tthis.config.fileType = value || '';\n\t}\n\n\tgetDetailPath(): string\n\t{\n\t\treturn '';\n\t}\n\n\tsetDetailPath(value): string\n\t{\n\t\tthis.config.DETAIL_PATH = value || '';\n\t}\n}","import {DefaultFooter} from 'ui.entity-selector';\nimport {Event, Loc, Tag} from 'main.core';\nimport 'ui.info-helper';\n\nexport default class ProductCreationLimitedFooter extends DefaultFooter\n{\n\tgetContent(): HTMLElement\n\t{\n\t\tconst phrase = Tag.render`\n\t\t\t<div>${Loc.getMessage('CATALOG_SELECTOR_LIMITED_PRODUCT_CREATION')}</div>\n\t\t`;\n\n\t\tconst infoButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-hover ui-btn-round\">\n\t\t\t\t${Loc.getMessage('CATALOG_SELECTOR_LICENSE_EXPLODE')}\n\t\t\t</a>\n\t\t`;\n\n\t\tEvent.bind(infoButton, 'click', () => {\n\t\t\tBX.UI.InfoHelper.show('limit_shop_products');\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t<div class=\"ui-selector-search-footer-box\">\n\t\t\t\t\t<div class=\"tariff-lock\"></div>\n\t\t\t\t\t${phrase}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t${infoButton}\n\t\t\t\t</div>\t\t\t\t\n\t\t\t</div>\n\t\t`;\n\t}\n}","import {ajax, Browser, Cache, Dom, Event, Extension, Loc, Tag, Text, Type} from 'main.core';\nimport {Dialog} from 'ui.entity-selector';\nimport './component.css';\nimport {EventEmitter} from 'main.core.events';\nimport {Base} from './models/base';\nimport {ProductSelector} from 'catalog.product-selector';\nimport ProductCreationLimitedFooter from \"./product-creation-limited-footer\";\n\nexport class ProductSearchInput\n{\n\tmodel: Base;\n\tselector: ProductSelector;\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.model = options.model || {};\n\t\tthis.isEnabledSearch = options.isSearchEnabled;\n\t\tthis.isEnabledDetailLink = options.isEnabledDetailLink;\n\t\tthis.isEnabledEmptyProductError = options.isEnabledEmptyProductError;\n\t\tthis.inputName = options.inputName || '';\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetField(fieldName): string\n\t{\n\t\treturn this.model.getField(fieldName);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.getField(this.inputName);\n\t}\n\n\tisSearchEnabled(): boolean\n\t{\n\t\treturn this.isEnabledSearch;\n\t}\n\n\ttoggleIcon(icon, value)\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\tDom.style(icon, 'display', value);\n\t\t}\n\t}\n\n\tgetNameBlock(): HTMLElement\n\t{\n\t\treturn this.cache.remember('nameBlock', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.getNameTag()}\n\t\t\t\t\t${this.getNameInput()}\n\t\t\t\t\t${this.getHiddenNameInput()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetNameTag(): ?HTMLElement\n\t{\n\t\tif (!this.model.isNew())\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-ctl-tag\">${Loc.getMessage('CATALOG_SELECTOR_NEW_TAG_TITLE')}</div>\n\t\t`;\n\t}\n\n\tgetNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('nameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input type=\"text\" \n\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox\" \n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t\tplaceholder=\"${Text.encode(this.getPlaceholder())}\"\n\t\t\t\t\tonchange=\"${this.handleNameInputHiddenChange.bind(this)}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetHiddenNameInput(): HTMLInputElement\n\t{\n\t\treturn this.cache.remember('hiddenNameInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input\n\t\t\t\t \ttype=\"hidden\" \n\t\t\t\t\tname=\"${Text.encode(this.inputName)}\" \n\t\t\t\t\tvalue=\"${Text.encode(this.getValue())}\"\n\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\thandleNameInputHiddenChange(event: UIEvent)\n\t{\n\t\tthis.getHiddenNameInput().value = event.target.value;\n\t}\n\n\tgetClearIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('closeIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\" \n\t\t\t\t\tonclick=\"${this.handleClearIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetArrowIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('arrowIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<a\n\t\t\t\t\thref=\"${this.model.getDetailPath()}\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-forward\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSearchIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('searchIcon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button\n\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-search\"\n\t\t\t\t\tonclick=\"${this.handleSearchIconClick.bind(this)}\"\n\t\t\t\t></button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tlayout(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"ui-ctl ui-ctl-w100 ui-ctl-after-icon\"></div>`;\n\n\t\tif (!Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t}\n\n\t\tblock.appendChild(this.getClearIcon());\n\n\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\tblock.appendChild(this.getArrowIcon());\n\t\t}\n\n\t\tif (this.isSearchEnabled())\n\t\t{\n\t\t\tconst iconValue = Type.isStringFilled(this.getValue()) ? 'none' : 'block';\n\t\t\tthis.toggleIcon(this.getSearchIcon(), iconValue);\n\t\t\tblock.appendChild(this.getSearchIcon());\n\n\t\t\tEvent.bind(this.getNameInput(), 'click', this.handleShowSearchDialog.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'input', this.handleShowSearchDialog.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'blur', this.handleNameInputBlur.bind(this));\n\t\t\tEvent.bind(this.getNameInput(), 'keydown', this.handleNameInputKeyDown.bind(this));\n\t\t}\n\n\t\tEvent.bind(this.getNameInput(), 'click', this.handleIconsSwitchingOnNameInput.bind(this));\n\t\tEvent.bind(this.getNameInput(), 'input', this.handleIconsSwitchingOnNameInput.bind(this));\n\n\t\tif (this.selector && this.selector.isSaveable())\n\t\t{\n\t\t\tEvent.bind(this.getNameInput(), 'change', this.handleNameInputChange.bind(this));\n\t\t}\n\n\t\tblock.appendChild(this.getNameBlock());\n\t\treturn block;\n\t}\n\n\tshowDetailLink(): string\n\t{\n\t\treturn this.isEnabledDetailLink;\n\t}\n\n\tgetDialog(): ?Dialog\n\t{\n\t\treturn this.cache.remember('dialog', () => {\n\t\t\tconst params = {\n\t\t\t\tid: this.id,\n\t\t\t\theight: 300,\n\t\t\t\tcontext: 'catalog-products',\n\t\t\t\ttargetNode: this.getNameInput(),\n\t\t\t\tenableSearch: false,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_TITLE'}`,\n\t\t\t\t\t\tsubtitle: Tag.message`${'CATALOG_SELECTOR_IS_EMPTY_SUBTITLE'}`,\n\t\t\t\t\t\tarrow: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onProductSelect.bind(this),\n\t\t\t\t\t'Search:onItemCreateAsync': this.createProduct.bind(this)\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'product',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tiblockId: this.selector.getIblockId(),\n\t\t\t\t\t\t\tbasePriceId: this.selector.getBasePriceId()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\n\t\t\tconst settingsCollection = Extension.getSettings('catalog.product-selector');\n\t\t\tif (Type.isObject(settingsCollection.get('limitInfo')))\n\t\t\t{\n\t\t\t\tparams.footer = ProductCreationLimitedFooter;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparams.searchOptions = { allowCreateItem: true };\n\t\t\t}\n\n\t\t\treturn new Dialog(params);\n\t\t});\n\t}\n\n\thandleNameInputKeyDown(event: KeyboardEvent): void\n\t{\n\t\tconst dialog = this.getDialog();\n\t\tif (event.key === 'Enter' && dialog.getActiveTab() === dialog.getSearchTab())\n\t\t{\n\t\t\t// prevent a form submit\n\t\t\tevent.preventDefault();\n\n\t\t\tif ((Browser.isMac() && event.metaKey) || event.ctrlKey)\n\t\t\t{\n\t\t\t\tdialog.getSearchTab().getFooter().createItem();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleIconsSwitchingOnNameInput(event: UIEvent): void\n\t{\n\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\n\t\tif (Type.isStringFilled(event.target.value))\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'block');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t}\n\t}\n\n\thandleClearIconClick(event: UIEvent)\n\t{\n\t\tif (this.selector.isProductSearchEnabled() && !this.selector.isEmptyModel())\n\t\t{\n\t\t\tthis.selector.clearState();\n\t\t\tthis.selector.clearLayout();\n\t\t\tthis.selector.layout();\n\t\t\tthis.selector.searchInDialog();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getNameInput().value = '';\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\t\t}\n\n\t\tthis.selector.focusName();\n\n\t\tthis.selector.emit('onClear', {\n\t\t\tselectorId: this.selector.getId(),\n\t\t\trowId: this.selector.getRowId()\n\t\t});\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\thandleNameInputChange(event: UIEvent)\n\t{\n\t\tconst value = event.target.value;\n\n\t\tEventEmitter.emit('ProductList::onChangeFields', {\n\t\t\trowId: this.selector.getRowId(),\n\t\t\tfields: {\n\t\t\t\t'NAME': value\n\t\t\t}\n\t\t});\n\t}\n\n\tfocusName()\n\t{\n\t\trequestAnimationFrame(() => this.getNameInput().focus());\n\t}\n\n\tsearchInDialog(searchQuery: string = '')\n\t{\n\t\tif (!this.selector.isProductSearchEnabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.show();\n\t\t\tdialog.search(searchQuery);\n\t\t}\n\t}\n\n\thandleShowSearchDialog(event: UIEvent)\n\t{\n\t\tif (this.selector.isEmptyModel() || this.selector.isSimpleModel())\n\t\t{\n\t\t\tthis.selector.searchInDialog(event.target.value);\n\t\t}\n\t}\n\n\thandleNameInputBlur(event: UIEvent)\n\t{\n\t\t// timeout to toggle clear icon handler while cursor is inside of name input\n\t\tsetTimeout(() => {\n\t\t\tthis.toggleIcon(this.getClearIcon(), 'none');\n\n\t\t\tif (this.showDetailLink() && Type.isStringFilled(this.getValue()))\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'block');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.toggleIcon(this.getArrowIcon(), 'none');\n\t\t\t\tthis.toggleIcon(this.getSearchIcon(), 'block');\n\t\t\t}\n\t\t}, 200);\n\n\t\tif (this.isSearchEnabled() && this.isEnabledEmptyProductError)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.selector.isEmptyModel())\n\t\t\t\t{\n\t\t\t\t\tthis.model.setError(\n\t\t\t\t\t\t'NOT_SELECTED_PRODUCT',\n\t\t\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_SELECTED_PRODUCT_TITLE')\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.selector.layoutErrors();\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\thandleSearchIconClick(event: UIEvent)\n\t{\n\t\tthis.selector.searchInDialog();\n\t\tthis.selector.focusName();\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\tresetModel(title)\n\t{\n\t\tconst fields = this.selector.getModel().getFields();\n\t\tconst newModel = this.selector.createModel({isSimpleModel: true});\n\t\tthis.selector.setModel(newModel);\n\t\tfields['NAME'] = title;\n\t\tthis.selector.getModel().setFields(fields);\n\t}\n\n\tonProductSelect(event)\n\t{\n\t\tconst item = event.getData().item;\n\t\titem.getDialog().getTargetNode().value = item.getTitle();\n\t\tthis.toggleIcon(this.getSearchIcon(), 'none');\n\n\t\tthis.resetModel(item.getTitle());\n\n\t\tthis.selector.clearLayout();\n\t\tthis.selector.layout();\n\n\t\tif (this.selector)\n\t\t{\n\t\t\tthis.selector.onProductSelect(item.getId(), {\n\t\t\t\tsaveProductFields: item.getCustomData().get('saveProductFields'),\n\t\t\t\tisNew: item.getCustomData().get('isNew')\n\t\t\t});\n\t\t}\n\n\t\titem.getDialog().hide();\n\t}\n\n\tcreateProduct(event): Promise\n\t{\n\t\tconst {searchQuery} = event.getData();\n\t\tthis.resetModel(searchQuery.getQuery());\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tconst fields = {\n\t\t\t\t\tNAME: searchQuery.getQuery(),\n\t\t\t\t\tIBLOCK_ID: this.selector.getIblockId()\n\t\t\t\t};\n\n\t\t\t\tconst price = this.selector.getModel().getField('PRICE', null);\n\t\t\t\tif (!Type.isNil(price))\n\t\t\t\t{\n\t\t\t\t\tfields['PRICE'] = price;\n\t\t\t\t}\n\n\t\t\t\tconst currency = this.selector.getModel().getField('CURRENCY', null);\n\t\t\t\tif (Type.isStringFilled(currency))\n\t\t\t\t{\n\t\t\t\t\tfields['CURRENCY'] = currency;\n\t\t\t\t}\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.productSelector.createProduct',\n\t\t\t\t\t{\n\t\t\t\t\t\tjson: {\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\tentityId: 'product',\n\t\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\t\tsaveProductFields: true,\n\t\t\t\t\t\t\t\tisNew: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tdialog.hide();\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tgetPlaceholder(): string\n\t{\n\t\treturn (\n\t\t\tthis.isSearchEnabled() && this.selector.isEmptyModel()\n\t\t\t\t? Loc.getMessage('CATALOG_SELECTOR_BEFORE_SEARCH_TITLE')\n\t\t\t\t: Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE')\n\t\t);\n\t}\n}\n","import {Reflection, Runtime, Tag, Text, Type} from 'main.core';\nimport './component.css';\nimport {BaseEvent, EventEmitter} from \"main.core.events\";\nimport {ProductSelector} from 'catalog.product-selector';\n\nexport class ProductImageInput\n{\n\tconstructor(id, options = {})\n\t{\n\t\tthis.id = id || Text.getRandom();\n\t\tthis.selector = options.selector || null;\n\t\tif (!(this.selector instanceof ProductSelector))\n\t\t{\n\t\t\tthrow new Error('Product selector instance not found.');\n\t\t}\n\n\t\tthis.config = options.config || {};\n\t\tthis.setView(options.view);\n\n\t\tif (Type.isStringFilled(options.inputHtml))\n\t\t{\n\t\t\tthis.setInputHtml(options.inputHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restoreDefaultInputHtml();\n\t\t}\n\n\t\tthis.enableSaving = options.enableSaving;\n\n\t\tthis.uploaderFieldMap = {};\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tsetView(html)\n\t{\n\t\tthis.view = Type.isStringFilled(html) ? html : '';\n\t}\n\n\tsetInputHtml(html)\n\t{\n\t\tthis.inputHtml = Type.isStringFilled(html) ? html : '';\n\t}\n\n\trestoreDefaultInputHtml()\n\t{\n\t\tthis.inputHtml = `\n\t\t\t<div class='ui-image-input-container ui-image-input-img--disabled'>\n\t\t\t\t<div class='adm-fileinput-wrapper '>\n\t\t\t\t\t<div class='adm-fileinput-area mode-pict adm-fileinput-drag-area'></div>\n\t\t\t\t</div>\n\t\t\t</div>\n`\t\t;\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.selector && this.selector.isViewMode();\n\t}\n\n\tisEnabledLiveSaving(): boolean\n\t{\n\t\treturn this.enableSaving;\n\t}\n\n\tlayout()\n\t{\n\t\tconst imageContainer = Tag.render`<div></div>`;\n\n\t\tRuntime.html(imageContainer, this.isViewMode() ? this.view : this.inputHtml);\n\n\t\treturn imageContainer;\n\t}\n}","import {Base} from \"./base\";\n\nexport class Empty extends Base\n{\n}","import {Loc, Text, Type} from \"main.core\";\nimport {Base} from './base';\n\nexport class Product extends Base\n{\n\tisSaveable(): boolean\n\t{\n\t\treturn this.getConfig('saveProductFields', false);\n\t}\n\n\tisEnableFileSaving(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tgetDetailPath(): string\n\t{\n\t\treturn this.getConfig('DETAIL_PATH', '');\n\t}\n\n\tremoveMorePhotoItem(fileId): boolean\n\t{\n\t\tfor (const index in this.morePhoto)\n\t\t{\n\t\t\tlet value = this.morePhoto[index];\n\n\t\t\tif (!Type.isObject(value))\n\t\t\t{\n\t\t\t\tvalue = Text.toInteger(value);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(Type.isNumber(value) && value === Text.toInteger(fileId))\n\t\t\t\t|| (Type.isObject(value) && value.fileId === fileId)\n\t\t\t)\n\t\t\t{\n\t\t\t\tdelete this.morePhoto[index];\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetMorePhotoValues(values)\n\t{\n\t\tsuper.setMorePhotoValues(values);\n\n\t\tif (this.isEnabledEmptyImageError() && this.morePhoto.length === 0)\n\t\t{\n\t\t\tthis.setError(\n\t\t\t\t'EMPTY_IMAGE',\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_EMPTY_IMAGE_ERROR')\n\t\t\t);\n\t\t}\n\t}\n\n\tisEnabledEmptyImageError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_IMAGES_ERROR', false);\n\t}\n}","import {Product} from \"./product\";\n\nexport class Sku extends Product\n{\n\tgetProductId()\n\t{\n\t\treturn this.getConfig('productId');\n\t}\n}","import {Base} from \"./base\";\n\nexport class Simple extends Base\n{\n\tgetName(): string\n\t{\n\t\treturn this.getConfig('NAME', '');\n\t}\n}","import {ajax, Cache, Dom, Event, Extension, Loc, Reflection, Runtime, Tag, Text, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {SkuTree} from 'catalog.sku-tree';\nimport {ProductSearchInput} from \"./product-search-input\";\nimport {ProductImageInput} from \"./product-image-input\";\nimport {Empty} from \"./models/empty\";\nimport {Sku} from \"./models/sku\";\nimport {Product} from \"./models/product\";\nimport {Base} from \"./models/base\";\nimport {Simple} from \"./models/simple\";\nimport 'ui.forms';\nimport './component.css';\n\nconst instances = new Map();\n\nexport class ProductSelector extends EventEmitter\n{\n\tstatic MODE_VIEW = 'view';\n\tstatic MODE_EDIT = 'edit';\n\n\tstatic PRODUCT_TYPE = 'product';\n\tstatic SKU_TYPE = 'sku';\n\n\tmode: ProductSelector.MODE_EDIT | ProductSelector.MODE_VIEW = ProductSelector.MODE_EDIT;\n\tcache = new Cache.MemoryCache();\n\tfileInput: ?ProductImageInput;\n\tsearchInput: ?ProductSearchInput;\n\tskuTreeInstance: ?SkuTree;\n\n\tvariationChangeHandler = this.handleVariationChange.bind(this);\n\tonSaveImageHandler = this.onSaveImage.bind(this);\n\tonChangeFieldsHandler = Runtime.debounce(this.onChangeFields, 500, this);\n\n\tstatic getById(id: string): ?ProductSelector\n\t{\n\t\treturn instances.get(id) || null;\n\t}\n\n\tconstructor(id, options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Catalog.ProductSelector');\n\n\t\tthis.id = id || Text.getRandom();\n\t\toptions.inputFieldName = options.inputFieldName || 'NAME';\n\t\tthis.options = options || {};\n\t\tthis.iblockId = Text.toNumber(options.iblockId);\n\t\tthis.basePriceId = Text.toNumber(options.basePriceId);\n\n\t\tthis.setMode(options.mode);\n\n\t\tthis.model = this.createModel(options);\n\t\tthis.model.setFields(options.fields);\n\t\tthis.model.setMorePhotoValues(options.morePhotoValues);\n\t\tthis.model.setDetailPath(this.getConfig('DETAIL_PATH'));\n\n\t\tif (this.isSimpleModel() && this.isEnabledEmptyProductError())\n\t\t{\n\t\t\tthis.model.setError(\n\t\t\t\t'NOT_SELECTED_PRODUCT',\n\t\t\t\tLoc.getMessage('CATALOG_SELECTOR_SELECTED_PRODUCT_TITLE')\n\t\t\t);\n\t\t}\n\n\t\tthis.skuTree = options.skuTree || null;\n\t\tthis.setFileType(options.fileType);\n\n\t\tthis.layout();\n\n\t\tEventEmitter.subscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t\tEventEmitter.subscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\n\t\tinstances.set(this.id, this);\n\t}\n\n\tcreateModel(options = {}): Base\n\t{\n\t\tif (options.isSimpleModel)\n\t\t{\n\t\t\treturn new Simple();\n\t\t}\n\n\t\tconst productId = Text.toInteger(options.productId) || 0;\n\t\tif (productId <= 0)\n\t\t{\n\t\t\treturn new Empty();\n\t\t}\n\n\t\tconst modelConfig = options?.config?.MODEL_CONFIG || {};\n\t\tconst skuId = Text.toInteger(options.skuId) || 0;\n\t\tif (skuId > 0 && skuId !== productId)\n\t\t{\n\t\t\treturn new Sku(skuId, {...modelConfig, ...{productId}});\n\t\t}\n\n\t\treturn new Product(productId, modelConfig);\n\t}\n\n\tsetModel(model: Base): void\n\t{\n\t\tthis.model = model;\n\t}\n\n\tgetModel(): Base\n\t{\n\t\treturn this.model;\n\t}\n\n\tisEmptyModel(): boolean\n\t{\n\t\treturn (this.getModel() instanceof Empty);\n\t}\n\n\tisSimpleModel(): boolean\n\t{\n\t\treturn (this.getModel() instanceof Simple);\n\t}\n\n\tsetMode(mode): void\n\t{\n\t\tif (!Type.isNil(mode))\n\t\t{\n\t\t\tthis.mode = mode === ProductSelector.MODE_VIEW ? ProductSelector.MODE_VIEW : ProductSelector.MODE_EDIT;\n\t\t}\n\t}\n\n\tsetFileType(fileType): void\n\t{\n\t\tthis.fileType = fileType === ProductSelector.SKU_TYPE ? ProductSelector.SKU_TYPE : ProductSelector.PRODUCT_TYPE;\n\t}\n\n\tisViewMode(): boolean\n\t{\n\t\treturn this.mode === ProductSelector.MODE_VIEW;\n\t}\n\n\tisSaveable(): boolean\n\t{\n\t\treturn !this.isViewMode() && this.model.isSaveable();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetIblockId(): number\n\t{\n\t\treturn this.iblockId;\n\t}\n\n\tgetBasePriceId(): number\n\t{\n\t\treturn this.basePriceId;\n\t}\n\n\tgetConfig(name, defaultValue)\n\t{\n\t\treturn BX.prop.get(this.options.config, name, defaultValue);\n\t}\n\n\tgetRowId(): string\n\t{\n\t\treturn this.getConfig('ROW_ID');\n\t}\n\n\tgetFileInput(): ProductImageInput\n\t{\n\t\tif (!this.fileInput)\n\t\t{\n\t\t\tthis.fileInput = new ProductImageInput(\n\t\t\t\tthis.options.fileInputId,\n\t\t\t\t{\n\t\t\t\t\tselector: this,\n\t\t\t\t\tview: this.options.fileView,\n\t\t\t\t\tinputHtml: this.options.fileInput,\n\t\t\t\t\tenableSaving: this.getConfig('ENABLE_IMAGE_CHANGE_SAVING', false)\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.fileInput;\n\t}\n\n\tisProductFileType(): boolean\n\t{\n\t\treturn this.fileType === ProductSelector.PRODUCT_TYPE;\n\t}\n\n\tisProductSearchEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_SEARCH', false) && this.getIblockId() > 0;\n\t}\n\n\tisImageFieldEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_IMAGE_INPUT', true) !== false;\n\t}\n\n\tisEnabledEmptyProductError(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_EMPTY_PRODUCT_ERROR', false);\n\t}\n\n\tisEnabledChangesRendering(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_CHANGES_RENDERING', true);\n\t}\n\n\tisInputDetailLinkEnabled(): boolean\n\t{\n\t\treturn this.getConfig('ENABLE_INPUT_DETAIL_LINK', false) && Type.isStringFilled(this.model.getDetailPath());\n\t}\n\n\tgetWrapper(): HTMLElement\n\t{\n\t\tif (!this.wrapper)\n\t\t{\n\t\t\tthis.wrapper = document.getElementById(this.id);\n\t\t}\n\n\t\treturn this.wrapper;\n\t}\n\n\trenderTo(node)\n\t{\n\t\tthis.clearLayout();\n\t\tthis.wrapper = node;\n\t\tthis.layout();\n\t}\n\n\tlayout()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (!wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.defineWrapperClass(wrapper);\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-inner\"></div>`;\n\t\twrapper.appendChild(block);\n\t\tblock.appendChild(this.layoutNameBlock());\n\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tif (!Reflection.getClass('BX.UI.ImageInput'))\n\t\t\t{\n\t\t\t\tajax\n\t\t\t\t\t.runAction(\t'catalog.productSelector.getFileInput', {\n\t\t\t\t\t\tjson:{\n\t\t\t\t\t\t\tiblockId: this.iblockId\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.layoutImage();\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layoutImage();\n\t\t\t}\n\t\t\tblock.appendChild(this.getImageContainer());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-field-no-image');\n\t\t}\n\n\t\twrapper.appendChild(this.getErrorContainer());\n\t\tthis.layoutErrors();\n\n\t\tthis.layoutSkuTree();\n\t\tthis.subscribeToVariationChange();\n\t}\n\n\tfocusName(): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.focusName();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tsearchInDialog(searchQuery: string = ''): this\n\t{\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tthis.searchInput.searchInDialog(searchQuery);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tgetImageContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('imageContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-img\"></div>`\n\t\t));\n\t}\n\n\tgetErrorContainer(): HTMLElement\n\t{\n\t\treturn this.cache.remember('errorContainer', () => (\n\t\t\tTag.render`<div class=\"catalog-product-error\"></div>`\n\t\t));\n\t}\n\n\tlayoutErrors()\n\t{\n\t\tthis.getErrorContainer().innerHTML = '';\n\t\tif (!this.model.hasErrors())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errors = this.model.getErrors();\n\t\tfor (const code in errors)\n\t\t{\n\t\t\tthis.getErrorContainer().appendChild(\n\t\t\t\tTag.render`<div class=\"catalog-product-error-item\">${errors[code]}</div>`\n\t\t\t);\n\t\t}\n\n\t\tif (this.searchInput)\n\t\t{\n\t\t\tDom.addClass(this.searchInput.getNameBlock(), 'ui-ctl-danger');\n\t\t}\n\t}\n\n\tlayoutImage()\n\t{\n\t\tthis.getImageContainer().innerHTML = '';\n\t\tthis.getImageContainer().appendChild(this.getFileInput().layout());\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearState(): void\n\t{\n\t\tthis.model = this.createModel();\n\t\tthis.fileInput.restoreDefaultInputHtml();\n\t\tthis.skuTree = null;\n\t\tthis.skuTreeInstance = null;\n\t\tthis.refreshImageSelectorId = null;\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif (wrapper)\n\t\t{\n\t\t\tEvent.unbindAll(wrapper);\n\t\t\twrapper.innerHTML = '';\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\t}\n\n\tunsubscribeEvents()\n\t{\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tEventEmitter.unsubscribe('Catalog.ImageInput::save', this.onSaveImageHandler);\n\t\tEventEmitter.unsubscribe('ProductList::onChangeFields', this.onChangeFieldsHandler);\n\t}\n\n\tdefineWrapperClass(wrapper)\n\t{\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-view');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-edit');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(wrapper, 'catalog-product-edit');\n\t\t\tDom.removeClass(wrapper, 'catalog-product-view');\n\t\t}\n\t}\n\n\tgetNameBlockView(): HTMLElement\n\t{\n\t\tconst productName = Text.encode(this.model.getField('NAME'));\n\t\tconst namePlaceholder = Loc.getMessage('CATALOG_SELECTOR_VIEW_NAME_TITLE');\n\n\t\tif (this.getModel().getDetailPath())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${this.getModel().getDetailPath()}\" title=\"${namePlaceholder}\">${productName}</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<span title=\"${namePlaceholder}\">${productName}</span>`;\n\n\t}\n\n\tlayoutNameBlock(): HTMLElement\n\t{\n\t\tconst block = Tag.render`<div class=\"catalog-product-field-input\"></div>`;\n\n\t\tif (this.isViewMode())\n\t\t{\n\t\t\tblock.appendChild(this.getNameBlockView());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.searchInput = new ProductSearchInput(this.id, {\n\t\t\t\tselector: this,\n\t\t\t\tmodel: this.getModel(),\n\t\t\t\tinputName: this.options.inputFieldName,\n\t\t\t\tisSearchEnabled: this.isProductSearchEnabled(),\n\t\t\t\tisEnabledEmptyProductError: this.isEnabledEmptyProductError(),\n\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\tbasePriceId: this.getBasePriceId(),\n\t\t\t\tisEnabledDetailLink: this.isInputDetailLinkEnabled()\n\t\t\t});\n\t\t\tblock.appendChild(this.searchInput.layout());\n\t\t}\n\n\t\treturn block;\n\t}\n\n\tupdateSkuTree(tree): void\n\t{\n\t\tthis.skuTree = tree;\n\t\tthis.skuTreeInstance = null;\n\t}\n\n\tgetSkuTreeInstance(): SkuTree\n\t{\n\t\tif (this.skuTree && !this.skuTreeInstance)\n\t\t{\n\t\t\tthis.skuTreeInstance = new SkuTree({\n\t\t\t\tskuTree: this.skuTree,\n\t\t\t\tselectable: this.getConfig('ENABLE_SKU_SELECTION', true),\n\t\t\t\thideUnselected: this.getConfig('HIDE_UNSELECTED_ITEMS', false),\n\t\t\t});\n\t\t}\n\n\t\treturn this.skuTreeInstance;\n\t}\n\n\tlayoutSkuTree(): void\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tconst wrapper = this.getWrapper();\n\n\t\tif (skuTree && wrapper)\n\t\t{\n\t\t\tconst skuTreeWrapper = skuTree.layout();\n\n\t\t\twrapper.appendChild(skuTreeWrapper);\n\t\t}\n\t}\n\n\tsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.subscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\tunsubscribeToVariationChange()\n\t{\n\t\tconst skuTree = this.getSkuTreeInstance();\n\t\tif (skuTree)\n\t\t{\n\t\t\tskuTree.unsubscribe('SkuProperty::onChange', this.variationChangeHandler);\n\t\t}\n\t}\n\n\thandleVariationChange(event)\n\t{\n\t\tconst [skuFields] = event.getData();\n\t\tconst productId = Text.toNumber(skuFields.PARENT_PRODUCT_ID);\n\t\tconst variationId = Text.toNumber(skuFields.ID);\n\n\t\tif (productId <= 0 || variationId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.model.setSaveable(false);\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.getSelectedSku',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tvariationId,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config}));\n\t}\n\n\tonChangeFields(event)\n\t{\n\t\tconst eventData = event.getData();\n\n\t\tif (!this.isSaveable() || eventData.rowId !== this.getRowId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isNil(eventData.productId) && eventData.productId !== this.getModel().getProductId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst fields = eventData.fields;\n\t\tconst priceValue = Text.toNumber(fields.PRICE);\n\t\tif (priceValue > 0 && Type.isStringFilled(fields.CURRENCY))\n\t\t{\n\t\t\tfields.PRICES = {};\n\t\t\tfields.PRICES[this.getBasePriceId()] = {\n\t\t\t\tPRICE: priceValue,\n\t\t\t\tCURRENCY: fields.CURRENCY\n\t\t\t};\n\t\t}\n\n\t\tthis.updateProduct(fields);\n\t}\n\n\tupdateProduct(fields)\n\t{\n\t\tif (!Type.isPlainObject(fields))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getModel().getId() <= 0 || this.getIblockId() <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction(\n\t\t\t'catalog.productSelector.updateProduct',\n\t\t\t{\n\t\t\t\tjson: {\n\t\t\t\t\tid: this.getModel().getId(),\n\t\t\t\t\tiblockId: this.getIblockId(),\n\t\t\t\t\tupdateFields: fields\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tonSaveImage(event)\n\t{\n\t\tconst [, inputId, response] = event.getData();\n\t\tif (this.isEmptyModel() || this.isSimpleModel() || inputId !== this.getFileInput().getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getFileInput().setId(response.data.id);\n\t\tthis.getFileInput().setInputHtml(response.data.input);\n\t\tthis.getFileInput().setView(response.data.preview);\n\t\tthis.getModel().setMorePhotoValues(response.data.values);\n\t\tif (this.isImageFieldEnabled())\n\t\t{\n\t\t\tthis.layoutImage();\n\t\t}\n\t}\n\n\tonProductSelect(productId, itemConfig)\n\t{\n\t\tthis.emit('onBeforeChange', {\n\t\t\tselectorId: this.getId(),\n\t\t\trowId: this.getRowId()\n\t\t});\n\n\t\tthis.productSelectAjaxAction(productId, itemConfig);\n\t}\n\n\tproductSelectAjaxAction(\n\t\tproductId,\n\t\titemConfig = {\n\t\t\tsaveProductFields: false,\n\t\t\tisNew: false\n\t\t}\n\t)\n\t{\n\t\tajax\n\t\t\t.runAction(\n\t\t\t\t'catalog.productSelector.getProduct',\n\t\t\t\t{\n\t\t\t\t\tjson: {\n\t\t\t\t\t\tproductId,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tpriceId: this.basePriceId,\n\t\t\t\t\t\t\turlBuilder: this.getConfig('URL_BUILDER_CONTEXT')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then(response => this.processResponse(response, {...this.options.config, ...itemConfig}, true));\n\t}\n\n\tprocessResponse(response, config = {}, isProductAction = false)\n\t{\n\t\tconst data = response?.data || null;\n\n\t\tif (data)\n\t\t{\n\t\t\tthis.changeSelectedElement(data, config);\n\t\t}\n\t\telse if (isProductAction)\n\t\t{\n\t\t\tthis.clearState();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.productSelectAjaxAction(this.getModel().getProductId());\n\t\t}\n\n\t\tthis.unsubscribeToVariationChange();\n\n\t\tif (this.isEnabledChangesRendering())\n\t\t{\n\t\t\tthis.clearLayout();\n\t\t\tthis.layout();\n\t\t}\n\n\t\tconst fields = data?.fields || null;\n\n\t\tthis.emit('onChange', {\n\t\t\tselectorId: this.id,\n\t\t\trowId: this.getRowId(),\n\t\t\tisNew: config.isNew || false,\n\t\t\tfields\n\t\t});\n\t}\n\n\tchangeSelectedElement(data, config)\n\t{\n\t\tconst productId = Text.toInteger(data.productId);\n\t\tconst productChanged = this.getModel().getId() !== productId;\n\n\t\tif (productChanged)\n\t\t{\n\t\t\tconst skuId = Text.toInteger(data.skuId);\n\t\t\tif (skuId > 0 && skuId !== productId)\n\t\t\t{\n\t\t\t\tconfig.productId = productId;\n\t\t\t\tthis.model = new Sku(skuId, config);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.model = new Product(productId, config);\n\t\t\t}\n\t\t}\n\n\t\tthis.getModel().setFields(data.fields);\n\n\t\tconst imageField = {\n\t\t\tid: '',\n\t\t\tinput: '',\n\t\t\tpreview: '',\n\t\t\tvalues: []\n\t\t};\n\n\t\tif (Type.isObject(data.image))\n\t\t{\n\t\t\timageField.id = data.image.id;\n\t\t\timageField.input = data.image.input;\n\t\t\timageField.preview = data.image.preview;\n\t\t\timageField.values = data.image.values;\n\t\t\tthis.getModel().setFileType(data.fileType);\n\t\t}\n\n\t\tthis.getFileInput().setId(imageField.id);\n\t\tthis.getFileInput().setInputHtml(imageField.input);\n\t\tthis.getFileInput().setView(imageField.preview);\n\n\t\tthis.getModel().setMorePhotoValues(imageField.values);\n\n\t\tif (data.detailUrl)\n\t\t{\n\t\t\tthis.getModel().setDetailPath(data.detailUrl);\n\t\t}\n\n\t\tif (Type.isObject(data.skuTree))\n\t\t{\n\t\t\tthis.updateSkuTree(data.skuTree);\n\t\t}\n\t}\n}\n"],"names":["Base","id","config","Text","getRandom","errors","setMorePhotoValues","morePhoto","setFields","fields","value","saveProductFields","getConfig","name","defaultValue","BX","prop","get","fieldName","Type","isObject","code","text","Object","keys","length","values","isPlainObject","fileId","fileType","DETAIL_PATH","ProductCreationLimitedFooter","phrase","Tag","render","Loc","getMessage","infoButton","Event","bind","UI","InfoHelper","show","DefaultFooter","ProductSearchInput","options","Cache","MemoryCache","selector","ProductSelector","Error","model","isEnabledSearch","isSearchEnabled","isEnabledDetailLink","isEnabledEmptyProductError","inputName","getField","icon","isDomNode","Dom","style","cache","remember","getNameTag","getNameInput","getHiddenNameInput","isNew","encode","getValue","getPlaceholder","handleNameInputHiddenChange","event","target","handleClearIconClick","getDetailPath","handleSearchIconClick","block","isStringFilled","toggleIcon","getClearIcon","appendChild","showDetailLink","getArrowIcon","iconValue","getSearchIcon","handleShowSearchDialog","handleNameInputBlur","handleNameInputKeyDown","handleIconsSwitchingOnNameInput","isSaveable","handleNameInputChange","getNameBlock","params","height","context","targetNode","enableSearch","multiple","dropdownMode","searchTabOptions","stub","stubOptions","title","message","subtitle","arrow","events","onProductSelect","createProduct","entities","iblockId","getIblockId","basePriceId","getBasePriceId","settingsCollection","Extension","getSettings","footer","searchOptions","allowCreateItem","Dialog","dialog","getDialog","key","getActiveTab","getSearchTab","preventDefault","Browser","isMac","metaKey","ctrlKey","getFooter","createItem","isProductSearchEnabled","isEmptyModel","clearState","clearLayout","layout","searchInDialog","focusName","emit","selectorId","getId","rowId","getRowId","stopPropagation","EventEmitter","requestAnimationFrame","focus","searchQuery","search","isSimpleModel","setTimeout","setError","layoutErrors","getModel","getFields","newModel","createModel","setModel","item","getData","getTargetNode","getTitle","resetModel","getCustomData","hide","getQuery","Promise","resolve","reject","getTarget","NAME","IBLOCK_ID","price","isNil","currency","showLoader","ajax","runAction","json","then","response","hideLoader","addItem","data","entityId","tabs","getRecentTab","customData","select","catch","ProductImageInput","setView","view","inputHtml","setInputHtml","restoreDefaultInputHtml","enableSaving","uploaderFieldMap","html","isViewMode","imageContainer","Runtime","Empty","Product","index","toInteger","isNumber","isEnabledEmptyImageError","Sku","Simple","instances","Map","MODE_EDIT","handleVariationChange","onSaveImage","debounce","onChangeFields","setEventNamespace","inputFieldName","toNumber","setMode","mode","morePhotoValues","setDetailPath","skuTree","setFileType","subscribe","onChangeFieldsHandler","onSaveImageHandler","set","productId","modelConfig","MODEL_CONFIG","skuId","MODE_VIEW","SKU_TYPE","PRODUCT_TYPE","fileInput","fileInputId","fileView","wrapper","document","getElementById","node","getWrapper","defineWrapperClass","layoutNameBlock","isImageFieldEnabled","Reflection","getClass","layoutImage","getImageContainer","addClass","getErrorContainer","layoutSkuTree","subscribeToVariationChange","searchInput","innerHTML","hasErrors","getErrors","getFileInput","refreshImageSelectorId","skuTreeInstance","unbindAll","unsubscribeToVariationChange","unsubscribe","removeClass","productName","namePlaceholder","getNameBlockView","isInputDetailLinkEnabled","tree","SkuTree","selectable","hideUnselected","getSkuTreeInstance","skuTreeWrapper","variationChangeHandler","skuFields","PARENT_PRODUCT_ID","variationId","ID","setSaveable","priceId","urlBuilder","processResponse","eventData","getProductId","priceValue","PRICE","CURRENCY","PRICES","updateProduct","updateFields","inputId","setId","input","preview","itemConfig","productSelectAjaxAction","isProductAction","changeSelectedElement","isEnabledChangesRendering","productChanged","imageField","image","detailUrl","updateSkuTree"],"mappings":"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"}