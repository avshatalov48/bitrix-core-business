this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,i,t,a,o,r,l,n,c,b){"use strict";const v="im-chat";const d="im-lines";const f="im-notify";const p="button_";const u={first:"1",second:"2"};const P="user";var h=babelHelpers.classPrivateFieldLooseKey("instance");var L=babelHelpers.classPrivateFieldLooseKey("store");var B=babelHelpers.classPrivateFieldLooseKey("notificationService");var y=babelHelpers.classPrivateFieldLooseKey("prepareNotificationOptions");var F=babelHelpers.classPrivateFieldLooseKey("subscribeToNotifierEvents");var H=babelHelpers.classPrivateFieldLooseKey("onNotifierClick");var g=babelHelpers.classPrivateFieldLooseKey("onNotifierAction");var M=babelHelpers.classPrivateFieldLooseKey("onNotifierQuickAnswer");var N=babelHelpers.classPrivateFieldLooseKey("onNotifierButtonClick");var O=babelHelpers.classPrivateFieldLooseKey("sendButtonAction");var I=babelHelpers.classPrivateFieldLooseKey("isChatMessage");var X=babelHelpers.classPrivateFieldLooseKey("isLinesMessage");var m=babelHelpers.classPrivateFieldLooseKey("isNotification");var j=babelHelpers.classPrivateFieldLooseKey("isConfirmButtonAction");var K=babelHelpers.classPrivateFieldLooseKey("extractDialogId");var C=babelHelpers.classPrivateFieldLooseKey("extractNotificationId");var T=babelHelpers.classPrivateFieldLooseKey("extractButtonNumber");var _=babelHelpers.classPrivateFieldLooseKey("extractButtonParams");class w{static getInstance(){if(!babelHelpers.classPrivateFieldLooseBase(this,h)[h]){babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new this}return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}static init(){w.getInstance()}constructor(){Object.defineProperty(this,_,{value:z});Object.defineProperty(this,T,{value:q});Object.defineProperty(this,C,{value:U});Object.defineProperty(this,K,{value:Q});Object.defineProperty(this,j,{value:V});Object.defineProperty(this,m,{value:Y});Object.defineProperty(this,X,{value:$});Object.defineProperty(this,I,{value:R});Object.defineProperty(this,O,{value:W});Object.defineProperty(this,N,{value:D});Object.defineProperty(this,M,{value:k});Object.defineProperty(this,g,{value:S});Object.defineProperty(this,H,{value:x});Object.defineProperty(this,F,{value:E});Object.defineProperty(this,y,{value:A});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=o.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,B)[B]=new b.NotificationService;babelHelpers.classPrivateFieldLooseBase(this,F)[F]()}showMessage(e){const{message:i,dialog:t,user:a,lines:o}=e;let n="";if(a&&t.type!==P){n+=`${a.name}: `}n+=r.Parser.purifyMessage(i);let c=`im-chat-${t.dialogId}-${i.id}`;if(o){c=`im-lines-${t.dialogId}-${i.id}`}const b={id:c,title:t.name,icon:t.avatar||(a==null?void 0:a.avatar),text:n};const v=l.DesktopManager.isChatWindow()&&document.hasFocus();if(v){s.Notifier.notifyViaBrowserProvider(b)}else{s.Notifier.notify(b)}}showNotification(e,i){let a;if(e.title){a=e.title}else if(i){a=i.name}else{a=t.Loc.getMessage("IM_LIB_NOTIFIER_NOTIFY_SYSTEM_TITLE")}const o=babelHelpers.classPrivateFieldLooseBase(this,y)[y](a,e,i);const r=l.DesktopManager.isChatWindow()&&document.hasFocus();if(r){s.Notifier.notifyViaBrowserProvider(o)}else{s.Notifier.notify(o)}}}function A(e,s,i){var a;const o={id:`im-notify-${s.id}`,title:e,icon:i?i.avatar:"",text:r.Parser.purifyNotification(s)};if(s.sectionCode===c.NotificationTypesCodes.confirm){const[e,i]=s.notifyButtons;o.button1Text=e.TEXT;o.button2Text=i.TEXT}else if(((a=s.params)==null?void 0:a.CAN_ANSWER)==="Y"){o.inputPlaceholderText=t.Loc.getMessage("IM_LIB_NOTIFIER_NOTIFY_REPLY_PLACEHOLDER")}return o}function E(){s.Notifier.subscribe("click",(e=>{babelHelpers.classPrivateFieldLooseBase(this,H)[H](e.getData())}));s.Notifier.subscribe("action",(e=>{babelHelpers.classPrivateFieldLooseBase(this,g)[g](e.getData())}))}function x(e){const{id:s}=e;if(babelHelpers.classPrivateFieldLooseBase(this,I)[I](s)){const e=babelHelpers.classPrivateFieldLooseBase(this,K)[K](s);n.Messenger.openChat(e)}else if(babelHelpers.classPrivateFieldLooseBase(this,X)[X](s)){const e=babelHelpers.classPrivateFieldLooseBase(this,K)[K](s);n.Messenger.openLines(e)}else if(babelHelpers.classPrivateFieldLooseBase(this,m)[m](s)){n.Messenger.openNotifications()}}function S(e){const{id:s,action:i,userInput:t}=e;if(!babelHelpers.classPrivateFieldLooseBase(this,m)[m](s)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,C)[C](s);const o=babelHelpers.classPrivateFieldLooseBase(this,L)[L].getters["notifications/getById"](a);if(t){babelHelpers.classPrivateFieldLooseBase(this,M)[M](o,t)}else if(babelHelpers.classPrivateFieldLooseBase(this,j)[j](i,o)){babelHelpers.classPrivateFieldLooseBase(this,N)[N](i,o)}}function k(e,s){babelHelpers.classPrivateFieldLooseBase(this,B)[B].sendQuickAnswer({id:e.id,text:s})}function D(e,s){const[i,t]=s.notifyButtons;const a=babelHelpers.classPrivateFieldLooseBase(this,T)[T](e);if(a===u.first){babelHelpers.classPrivateFieldLooseBase(this,O)[O](s,i)}else if(a===u.second){babelHelpers.classPrivateFieldLooseBase(this,O)[O](s,t)}}function W(e,s){const[i,t]=babelHelpers.classPrivateFieldLooseBase(this,_)[_](s);babelHelpers.classPrivateFieldLooseBase(this,B)[B].sendConfirmAction(i,t)}function R(e){return e.startsWith(v)}function $(e){return e.startsWith(d)}function Y(e){return e.startsWith(f)}function V(e,s){const i=s.sectionCode;return e.startsWith(p)&&i===c.NotificationTypesCodes.confirm}function Q(e){return e.split("-")[2]}function U(e){return e.split("-")[2]}function q(e){return e.split("_")[1]}function z(e){return e.COMMAND_PARAMS.split("|")}Object.defineProperty(w,h,{writable:true,value:void 0});e.NotifierManager=w})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.UI.NotificationManager,BX.Vue3.Vuex,BX,BX.Event,BX.Messenger.v2.Application,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Const,BX.Messenger.v2.Provider.Service);
//# sourceMappingURL=notifier.bundle.map.js