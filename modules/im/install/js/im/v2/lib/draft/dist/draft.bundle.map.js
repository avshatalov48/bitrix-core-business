{"version":3,"file":"draft.bundle.map.js","names":["this","BX","Messenger","v2","exports","main_core","main_core_events","im_v2_lib_logger","im_v2_application_core","ui_dexie","im_v2_lib_localStorage","im_v2_const","DB_NAME","recentDraftLocalStorageKey","copilotDraftLocalStorageKey","IndexedDbManager","static","instance","constructor","db","Dexie","version","stores","drafts","async","migrationStatus","get","recentDrafts","LocalStorageManager","getInstance","set","remove","copilotDrafts","setMigrationFinished","key","value","put","result","defaultValue","migrateFromLocalStorage","WRITE_TO_STORAGE_TIMEOUT","SHOW_DRAFT_IN_RECENT_TIMEOUT","STORAGE_KEY","NOT_AVAILABLE_CHAT_TYPES","Set","ChatType","comment","DraftManager","inited","initPromise","Promise","resolve","initPromiseResolver","EventEmitter","subscribe","EventType","layout","onLayoutChange","bind","draftHistory","getStorageKey","error","console","fillDraftsFromStorage","Logger","warn","setRecentListDraftText","ready","Type","isPlainObject","Object","entries","forEach","dialogId","draft","setDraftText","text","trim","refreshSaveTimeout","setDraftPanel","panelType","messageId","panelMessageId","setDraftMentions","mentions","_this$drafts$dialogId","clearDraft","setRecentItemDraftText","_draft$text","canSetRecentItemDraftText","Core","getStore","dispatch","getDraftMethodName","id","event","from","getData","name","getLayoutName","entityId","setTimeout","getDraft","clearTimeout","writeToStorageTimeout","saveToIndexedDb","prepareDrafts","TextareaPanelType","edit","Layout","chat","getters","has","type","STORAGE_KEY$1","CopilotDraftManager","copilot","Lib","Event","Application","Dexie3","Const"],"sources":["draft.bundle.js"],"mappings":"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"}