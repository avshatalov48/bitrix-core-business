{"version":3,"file":"bulk-actions.bundle.js","sources":["../src/bulk-actions.js"],"sourcesContent":["import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Event } from 'main.core';\n\nimport { EventType } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\n\nexport class BulkActionsManager\n{\n\tstatic #instance: BulkActionsManager;\n\n\tstatic getInstance(): BulkActionsManager\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new this();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tinit()\n\t{\n\t\tthis.enableBulkModeHandler = this.enableBulkMode.bind(this);\n\t\tthis.disableBulkModeHandler = this.disableBulkMode.bind(this);\n\t\tthis.keyPressHandler = this.#onKeyPressCloseBulkActions.bind(this);\n\n\t\tEventEmitter.subscribe(EventType.dialog.openBulkActionsMode, this.enableBulkModeHandler);\n\t\tEventEmitter.subscribe(EventType.dialog.closeBulkActionsMode, this.disableBulkModeHandler);\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.openBulkActionsMode, this.enableBulkModeHandler);\n\t\tEventEmitter.unsubscribe(EventType.dialog.closeBulkActionsMode, this.disableBulkModeHandler);\n\n\t\tEvent.unbind(document, 'keydown', this.keyPressHandler);\n\t}\n\n\tenableBulkMode(event: BaseEvent<{messageId: number}>)\n\t{\n\t\tconst { messageId } = event.getData();\n\n\t\tvoid Core.getStore().dispatch('messages/select/toggle', messageId);\n\t\tthis.#toggleBulkActionsMode(true);\n\n\t\tEvent.bind(document, 'keydown', this.keyPressHandler);\n\t}\n\n\tdisableBulkMode()\n\t{\n\t\tvoid Core.getStore().dispatch('messages/select/clear');\n\t\tthis.#toggleBulkActionsMode(false);\n\t}\n\n\t#toggleBulkActionsMode(active: boolean)\n\t{\n\t\tvoid Core.getStore().dispatch('messages/select/toggleBulkActionsMode', active);\n\t}\n\n\t#onKeyPressCloseBulkActions(event: KeyboardEvent)\n\t{\n\t\tif (Utils.key.isCombination(event, 'Escape'))\n\t\t{\n\t\t\tthis.disableBulkMode();\n\t\t}\n\t}\n}\n"],"names":["BulkActionsManager","getInstance","init","enableBulkModeHandler","enableBulkMode","bind","disableBulkModeHandler","disableBulkMode","keyPressHandler","EventEmitter","subscribe","EventType","dialog","openBulkActionsMode","closeBulkActionsMode","destroy","unsubscribe","Event","unbind","document","event","messageId","getData","Core","getStore","dispatch","active","Utils","key","isCombination"],"mappings":";;;;;;;CAKwC;CAAA;CAAA;AAExC,CAAO,MAAMA,kBAAkB,CAC/B;GAAA;KAAA;OAAA;;KAAA;OAAA;;;GAGC,OAAOC,WAAW,GAClB;KACC,IAAI,yCAAC,IAAI,uBAAU,EACnB;OACC,4CAAI,0BAAa,IAAI,IAAI,EAAE;;KAG5B,+CAAO,IAAI;;GAGZC,IAAI,GACJ;KACC,IAAI,CAACC,qBAAqB,GAAG,IAAI,CAACC,cAAc,CAACC,IAAI,CAAC,IAAI,CAAC;KAC3D,IAAI,CAACC,sBAAsB,GAAG,IAAI,CAACC,eAAe,CAACF,IAAI,CAAC,IAAI,CAAC;KAC7D,IAAI,CAACG,eAAe,GAAG,4CAAI,4DAA6BH,IAAI,CAAC,IAAI,CAAC;KAElEI,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACC,mBAAmB,EAAE,IAAI,CAACV,qBAAqB,CAAC;KACxFM,6BAAY,CAACC,SAAS,CAACC,qBAAS,CAACC,MAAM,CAACE,oBAAoB,EAAE,IAAI,CAACR,sBAAsB,CAAC;;GAG3FS,OAAO,GACP;KACCN,6BAAY,CAACO,WAAW,CAACL,qBAAS,CAACC,MAAM,CAACC,mBAAmB,EAAE,IAAI,CAACV,qBAAqB,CAAC;KAC1FM,6BAAY,CAACO,WAAW,CAACL,qBAAS,CAACC,MAAM,CAACE,oBAAoB,EAAE,IAAI,CAACR,sBAAsB,CAAC;KAE5FW,eAAK,CAACC,MAAM,CAACC,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACX,eAAe,CAAC;;GAGxDJ,cAAc,CAACgB,KAAqC,EACpD;KACC,MAAM;OAAEC;MAAW,GAAGD,KAAK,CAACE,OAAO,EAAE;KAErC,KAAKC,2BAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAC,wBAAwB,EAAEJ,SAAS,CAAC;KAClE,4CAAI,kDAAwB,IAAI;KAEhCJ,eAAK,CAACZ,IAAI,CAACc,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACX,eAAe,CAAC;;GAGtDD,eAAe,GACf;KACC,KAAKgB,2BAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAC,uBAAuB,CAAC;KACtD,4CAAI,kDAAwB,KAAK;;CAenC;CAAC,iCAZuBC,MAAe,EACtC;GACC,KAAKH,2BAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAC,uCAAuC,EAAEC,MAAM,CAAC;CAC/E;CAAC,sCAE2BN,KAAoB,EAChD;GACC,IAAIO,qBAAK,CAACC,GAAG,CAACC,aAAa,CAACT,KAAK,EAAE,QAAQ,CAAC,EAC5C;KACC,IAAI,CAACb,eAAe,EAAE;;CAExB;CAAC,sBA3DWP,kBAAkB;GAAA;GAAA;CAAA;;;;;;;;"}