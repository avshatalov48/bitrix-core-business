<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1646486242']= array(base64_decode('aXNfc'.'3R'.'yaW5n'),base64_decode('c'.'3Ry'.'d'.'G'.'9'.'sb3dlcg'.'=='),base64_decode('aXN'.'fYX'.'JyYX'.'k='),base64_decode('a'.'XNfc3R'.'yaW5n'),base64_decode('Z3pkZWN'.'vZGU'.'='),base64_decode('YmFzZ'.'T'.'Y0X2'.'R'.'lY29kZQ'.'=='),base64_decode('dXJsZGVjb2Rl'),base64_decode('YXJ'.'y'.'YX'.'lfcmV2ZXJ'.'zZQ=='),base64_decode('Z'.'3plbmN'.'vZG'.'U='),base64_decode('Ym'.'FzZTY0X2'.'Vu'.'Y'.'2'.'9k'.'ZQ'.'=='),base64_decode(''.'dXJsZW'.'5jb2Rl'),base64_decode('YmluMmhle'.'A'.'='.'='),base64_decode('aXN'.'fYXJyYX'.'k'.'='),base64_decode('c'.'3RydG9sb3dlcg=='),base64_decode('aXNfYXJyYXk='),base64_decode('am9p'.'bg=='),base64_decode('Zm5tYX'.'Rja'.'A=='),base64_decode('cmF3dXJs'.'ZGVjb2R'.'l'),base64_decode('c3Vic'.'3'.'Ry'),base64_decode('c3Vi'.'c3'.'Ry'),base64_decode('c3R'.'yX3'.'JlcGxhY2U='),base64_decode('cHJlZ19xdW90ZQ='.'='),base64_decode('c'.'HJ'.'lZ19tYX'.'R'.'jaA'.'=='));if(!function_exists(__NAMESPACE__.'\\___861844728')){function ___861844728($_1036726058){static $_570715090= false; if($_570715090 == false) $_570715090=array(''.'Y'.'WN'.'0aW9u','aW50dm'.'F'.'s','cGF0aA'.'==',''.'Y29u'.'dGV'.'4dA==','a2V5cw='.'=','cH'.'J'.'v'.'Y'.'2Vzcw'.'==',''.'ZW5jb'.'2Rpb'.'mc=','cHJlZ'.'1'.'9yZX'.'BsYWN'.'l',''.'cGF0aA==','Y29udGV4dA'.'==','a2V5cw==','cHJv'.'Y'.'2Vz'.'cw'.'='.'=','ZW5'.'jb2Rpbmc=','c'.'G'.'F0dG'.'Vybg==','cHJlZ19t'.'YXR'.'j'.'aA==',''.'cGF'.'0aA==','Y29udGV4'.'dA==','a'.'2V'.'5c'.'w'.'==',''.'cHJvY2'.'Vzcw='.'=',''.'Z'.'W5jb2Rpbmc=','cGF0dGV'.'ybg'.'==',''.'cG9zdF9hY3Rpb24=','Y2hl'.'Y2tfY3NyZg==',''.'cG'.'F'.'0aA==','Y29u'.'dGV4dA==','a2V5cw==','cH'.'Jv'.'Y2Vz'.'cw'.'==','ZW5'.'jb'.'2Rpbm'.'c=',''.'cGF0d'.'GVy'.'bg==','YWN0aW'.'9u','YWN'.'0aW9u','YWN'.'0aW9u','YWN0aW9'.'u','Y'.'WN0aW9u','YWN0aW9u','cG9zd'.'F9hY3'.'R'.'p'.'b'.'24'.'=',''.'ZW5jb2Rpbmc=','ZW5jb2Rp'.'b'.'mc'.'=','ZW'.'5j'.'b2Rpb'.'mc=',''.'ZW5'.'jb2Rpbm'.'c=','ZW5jb2Rpbm'.'c=','ZW5'.'jb2Rpb'.'mc=','Z'.'3o=',''.'Y'.'m'.'FzZ'.'TY0','dX'.'Js',''.'aGV4','Lg==','Lw==','aW5'.'k'.'ZX'.'gucGhw','L2luZ'.'GV4'.'L'.'nB'.'ocA='.'=','U0N'.'S'.'SV'.'B'.'UX05B'.'T'.'UU=',''.'L2l'.'uZGV4LnBoc'.'A==','U0N'.'SSVBUX05BTUU=','U0NS'.'S'.'VBUX'.'05BT'.'UU=','U'.'0N'.'S'.'SV'.'B'.'UX05BTUU=','fg==','fl4'.'=','fg==','X'.'H4=','JH4'.'=');return base64_decode($_570715090[$_1036726058]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1186105019; protected $_282870285; protected $_1693633686; protected $_871270499; protected $_245737242; public static function make(array $_766253121):?static{ $_766253121= static::prepareRuleParameters($_766253121); return match($_766253121[___861844728(0)]){ ___861844728(1) => new IntvalRule( $_766253121[___861844728(2)], $_766253121[___861844728(3)], $_766253121[___861844728(4)], $_766253121[___861844728(5)], $_766253121[___861844728(6)]), ___861844728(7) => new PregReplaceRule( $_766253121[___861844728(8)], $_766253121[___861844728(9)], $_766253121[___861844728(10)], $_766253121[___861844728(11)], $_766253121[___861844728(12)], $_766253121[___861844728(13)]), ___861844728(14) => new PregMatchRule( $_766253121[___861844728(15)], $_766253121[___861844728(16)], $_766253121[___861844728(17)], $_766253121[___861844728(18)], $_766253121[___861844728(19)], $_766253121[___861844728(20)], $_766253121[___861844728(21)]), ___861844728(22) => new CsrfRule( $_766253121[___861844728(23)], $_766253121[___861844728(24)], $_766253121[___861844728(25)], $_766253121[___861844728(26)], $_766253121[___861844728(27)], $_766253121[___861844728(28)],), default => null,};} protected static function prepareRuleParameters(array $_157600063): array{ if($GLOBALS['____1646486242'][0]($_157600063[___861844728(29)])){ $_157600063[___861844728(30)]= $GLOBALS['____1646486242'][1]($_157600063[___861844728(31)]);} elseif($GLOBALS['____1646486242'][2]($_157600063[___861844728(32)])){ $_476353003= $_157600063[___861844728(33)]; $_157600063[___861844728(34)]= $_476353003[(810-2*405)]; $_157600063[___861844728(35)]= $_476353003[round(0+1)];} $_157600063[___861844728(36)]=!empty($_157600063[___861844728(37)])? $_157600063[___861844728(38)]:[]; if($GLOBALS['____1646486242'][3]($_157600063[___861844728(39)])){ $_157600063[___861844728(40)]=[$_157600063[___861844728(41)]];} return $_157600063;}  public function __construct($_1186105019, $_282870285, $_1693633686, $_871270499, $_245737242){ $this->_1186105019= $_1186105019; $this->_282870285= $this->castContext($_282870285); $this->_1693633686= $this->castKeys($_1693633686); $this->_871270499= $_871270499; $this->_245737242= $_245737242;} public function evaluateValue($_524161819){ if(!empty($this->_245737242)){ foreach($this->_245737242 as $_348628792){ $_524161819= match($_348628792){ 'gz' => $GLOBALS['____1646486242'][4]($_524161819), 'base64' => $GLOBALS['____1646486242'][5]($_524161819), 'url' => $GLOBALS['____1646486242'][6]($_524161819), 'hex' => hex2bin($_524161819)};}} $_1501116914= $this->evaluate($_524161819); if(!empty($this->_245737242) && $_1501116914 instanceof ModifyResult){ $_687409630= $_1501116914->getCleanValue(); foreach($GLOBALS['____1646486242'][7]($this->_245737242) as $_348628792){ $_687409630= match($_348628792){ ___861844728(42) => $GLOBALS['____1646486242'][8]($_687409630), ___861844728(43) => $GLOBALS['____1646486242'][9]($_687409630), ___861844728(44) => $GLOBALS['____1646486242'][10]($_687409630), ___861844728(45) => $GLOBALS['____1646486242'][11]($_687409630)};} $_1501116914= new ModifyResult($_687409630);} return $_1501116914;} abstract public function evaluate($_524161819); protected function castContext($_282870285){ if(!$GLOBALS['____1646486242'][12]($_282870285)){ $_282870285=[$_282870285];} foreach($_282870285 as $_1708098351 => $_2048807182){ $_282870285[$_1708098351]= $GLOBALS['____1646486242'][13]($_2048807182);} return $_282870285;} protected function castKeys($_1693633686){ if(!$GLOBALS['____1646486242'][14]($_1693633686)){ $_1693633686=[$_1693633686];} return $_1693633686;} public function matchKey(array $_1942795364): bool{ $_1942795364= $GLOBALS['____1646486242'][15](___861844728(46), $_1942795364); foreach($this->_1693633686 as $_1959311746){   if($GLOBALS['____1646486242'][16]($_1959311746, $_1942795364)){ return true;}} return false;}  public function matchPath($_2114725368){ if($this->_1186105019 === '*'){ return true;}  $_1351098315= new Uri($_2114725368); $_1441268698= $_1351098315->getPath(); $_1441268698= $GLOBALS['____1646486242'][17]($_1441268698);      if(str_ends_with($_1441268698, ___861844728(47))){ $_1441268698 .= ___861844728(48);} $_1441268698= Path::normalize($_1441268698);  $_501044199[]= $_1441268698; if(str_ends_with($_1441268698, ___861844728(49))){ $_501044199[]= $GLOBALS['____1646486242'][18]($_1441268698, min(68,0,22.666666666667),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___861844728(50)], ___861844728(51))){ $_501044199[]= $GLOBALS['____1646486242'][19]($_SERVER[___861844728(52)],(159*2-318),-round(0+9));} if($_1441268698 !== $_SERVER[___861844728(53)]){ $_501044199[]= $_SERVER[___861844728(54)];}  if(str_starts_with($this->_1186105019, ___861844728(55))){ $_1667269552= $this->_1186105019;} else{ $_1667269552= ___861844728(56). $GLOBALS['____1646486242'][20](___861844728(57), ___861844728(58), $GLOBALS['____1646486242'][21]($this->_1186105019)). ___861844728(59);} foreach($_501044199 as $_1610351246){ if($this->_1186105019 === $_1610351246 || $GLOBALS['____1646486242'][22]($_1667269552, $_1610351246)){ return true;}} return false;}  public function getPath(){ return $this->_1186105019;}  public function getContext(){ return $this->_282870285;}  public function getKeys(){ return $this->_1693633686;}  public function getProcess(){ return $this->_871270499;}}?>