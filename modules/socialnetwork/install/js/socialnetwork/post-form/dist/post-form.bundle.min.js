this.BX=this.BX||{};(function(e,t,a,i,s,l,r){"use strict";function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t){d(e,t);t.add(e)}function c(e,t,a){d(e,t);t.set(e,a)}function d(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function p(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var v=new WeakMap;var h=new WeakSet;var u=function(){function e(t){babelHelpers.classCallCheck(this,e);b(this,h);c(this,v,{writable:true,value:new r.Cache.MemoryCache});this.setData(t)}babelHelpers.createClass(e,[{key:"setData",value:function e(t){babelHelpers.classPrivateFieldGet(this,v).set("data",t)}},{key:"setFormData",value:function e(t){var a=babelHelpers.classPrivateFieldGet(this,v).get("data");this.setData(o(o({},a),t))}},{key:"prepareRequestData",value:function e(){return{POST_TITLE:p(this,h,H).call(this,"title"),POST_MESSAGE:p(this,h,H).call(this,"message"),DEST_DATA:p(this,h,H).call(this,"recipients"),UF_BLOG_POST_FILE:p(this,h,H).call(this,"fileIds"),TAGS:p(this,h,H).call(this,"tags")}}},{key:"validateRequestData",value:function e(){if(!this.getMessage()){return r.Loc.getMessage("SN_PF_REQUEST_TEXT_VALIDATION_ERROR")}if(!this.getRecipients()){return r.Loc.getMessage("SN_PF_REQUEST_RECIPIENTS_VALIDATION_ERROR")}return""}},{key:"getTitle",value:function e(){return r.Type.isStringFilled(p(this,h,H).call(this,"title"))?p(this,h,H).call(this,"title"):""}},{key:"getMessage",value:function e(){return r.Type.isStringFilled(p(this,h,H).call(this,"message"))?p(this,h,H).call(this,"message"):""}},{key:"getRecipients",value:function e(){return r.Type.isStringFilled(p(this,h,H).call(this,"recipients"))?p(this,h,H).call(this,"recipients"):""}},{key:"setRecipients",value:function e(t){var a=babelHelpers.classPrivateFieldGet(this,v).get("data");var i={recipients:t};this.setData(o(o({},a),i))}},{key:"getAllUsersTitle",value:function e(){return p(this,h,H).call(this,"allUsersTitle")}},{key:"isAllowEmailInvitation",value:function e(){return p(this,h,H).call(this,"allowEmailInvitation")===true}},{key:"isAllowToAll",value:function e(){return p(this,h,H).call(this,"allowToAll")===true}}]);return e}();function H(e){return babelHelpers.classPrivateFieldGet(this,v).get("data")[e]}var f;function P(e,t){w(e,t);t.add(e)}function F(e,t,a){w(e,t);t.set(e,a)}function w(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function T(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var g=new WeakMap;var m=new WeakMap;var S=new WeakMap;var I=new WeakMap;var G=new WeakMap;var k=new WeakMap;var E=new WeakMap;var y=new WeakMap;var z=new WeakMap;var W=new WeakSet;var C=new WeakSet;var M=new WeakSet;var D=new WeakSet;var _=new WeakSet;var R=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));P(babelHelpers.assertThisInitialized(a),_);P(babelHelpers.assertThisInitialized(a),D);P(babelHelpers.assertThisInitialized(a),M);P(babelHelpers.assertThisInitialized(a),C);P(babelHelpers.assertThisInitialized(a),W);F(babelHelpers.assertThisInitialized(a),g,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),m,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),S,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),I,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),G,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),k,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),E,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),y,{writable:true,value:void 0});F(babelHelpers.assertThisInitialized(a),z,{writable:true,value:false});a.setEventNamespace("BX.Socialnetwork.PostFormManager");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),g,e.formId);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),m,e.LHEId);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),S,e.isShownPostTitle===true);l.EventEmitter.subscribe("OnEditorInitedAfter",(function(e){var t=e.getData(),i=babelHelpers.slicedToArray(t,1),s=i[0];T(babelHelpers.assertThisInitialized(a),W,L).call(babelHelpers.assertThisInitialized(a),s)}));l.EventEmitter.subscribe("onMentionAdd",T(babelHelpers.assertThisInitialized(a),C,O).bind(babelHelpers.assertThisInitialized(a)));return a}babelHelpers.createClass(t,[{key:"initLHE",value:function e(){var t=this;if(!window.LHEPostForm){throw new Error("BX.Socialnetwork.PostFormManager: LHEPostForm not found")}babelHelpers.classPrivateFieldSet(this,I,window.LHEPostForm);var a=babelHelpers.classPrivateFieldGet(this,I).getHandler(babelHelpers.classPrivateFieldGet(this,m));babelHelpers.classPrivateFieldSet(this,G,a.eventNode);l.EventEmitter.emit(babelHelpers.classPrivateFieldGet(this,G),"OnShowLHE",["show"]);T(this,D,A).call(this);babelHelpers.classPrivateFieldSet(this,y,BX.Disk.Uploader.UserFieldControl.getById(babelHelpers.classPrivateFieldGet(this,g)));l.EventEmitter.subscribe(babelHelpers.classPrivateFieldGet(this,G),"onShowControllers",(function(e){var a=e.data;if(babelHelpers.classPrivateFieldGet(t,z)===false&&a.toString()==="show"){setTimeout((function(){t.emit("showControllers")}),100)}babelHelpers.classPrivateFieldSet(t,z,false)}));l.EventEmitter.subscribe(babelHelpers.classPrivateFieldGet(this,G),"onShowControllers:File:Increment",(function(e){var a=e.data;babelHelpers.classPrivateFieldSet(t,z,true)}))}},{key:"getEditorText",value:function e(){return babelHelpers.classPrivateFieldGet(this,E).GetContent()}},{key:"clearEditorText",value:function e(){var t=this;l.EventEmitter.subscribeOnce(babelHelpers.classPrivateFieldGet(this,E),"OnSetContentAfter",(function(){babelHelpers.classPrivateFieldGet(t,E).ResizeSceleton()}));babelHelpers.classPrivateFieldGet(this,E).SetContent("")}},{key:"focusToEditor",value:function e(){if(babelHelpers.classPrivateFieldGet(this,E)){babelHelpers.classPrivateFieldGet(this,E).Focus()}}}]);return t}(l.EventEmitter);function L(e){var t=this;if(e.id===babelHelpers.classPrivateFieldGet(this,m)){babelHelpers.classPrivateFieldSet(this,E,e);this.emit("editorInited");l.EventEmitter.subscribe(e,"OnFullscreenExpand",(function(){t.emit("fullscreenExpand")}))}}function O(e){var t=e.getCompatData(),a=babelHelpers.slicedToArray(t,2),i=a[0],s=a[1];var l=T(this,M,B).call(this,s,i);this.emit("addMention",{type:s,entity:i,entityType:l})}function B(e,t){var a="";if(e==="user"){if(t.isExtranet==="Y"){a="extranet"}else if(t.isEmail==="Y"){a="email"}else{a="employee"}}else if(e==="project"){if(t.isExtranet==="Y"){a="extranet"}}return a}function A(){var e=babelHelpers.classPrivateFieldGet(this,S)?"feed-add-post-form-btn-active":"";babelHelpers.classPrivateFieldSet(this,k,r.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div\n\t\t\t\tdata-id="sn-post-form-manager-show-title-btn"\n\t\t\t\tclass="feed-add-post-form-title-btn ','"\n\t\t\t\ttitle="','"\n\t\t\t>\n\t\t\t</div>\n\t\t'])),e,r.Loc.getMessage("SN_PF_TITLE_PLACEHOLDER")));r.Event.bind(babelHelpers.classPrivateFieldGet(this,k),"click",T(this,_,x).bind(this));var t=babelHelpers.classPrivateFieldGet(this,G).querySelector(".feed-add-post-form-but-more-open");r.Dom.append(babelHelpers.classPrivateFieldGet(this,k),t)}function x(){this.emit("toggleVisibilityPostTitle");babelHelpers.classPrivateFieldSet(this,S,!babelHelpers.classPrivateFieldGet(this,S));r.Dom.toggleClass(babelHelpers.classPrivateFieldGet(this,k),"feed-add-post-form-btn-active")}function N(e,t,a){X(e,t);t.set(e,a)}function X(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var j=new WeakMap;var U=new WeakMap;var q=function(){function e(t){babelHelpers.classCallCheck(this,e);N(this,j,{writable:true,value:void 0});N(this,U,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,j,r.Type.isString(t.pathToDefaultRedirect)?t.pathToDefaultRedirect:"");babelHelpers.classPrivateFieldSet(this,U,r.Type.isString(t.pathToGroupRedirect)?t.pathToGroupRedirect:"")}babelHelpers.createClass(e,[{key:"redirectTo",value:function e(t){if(t){if(babelHelpers.classPrivateFieldGet(this,U)){top.BX.Socialnetwork.Spaces.space.reloadPageContent(babelHelpers.classPrivateFieldGet(this,U).replace("#group_id#",t))}else{top.BX.Socialnetwork.Spaces.space.reloadPageContent()}}else{if(babelHelpers.classPrivateFieldGet(this,j)){top.BX.Socialnetwork.Spaces.space.reloadPageContent(babelHelpers.classPrivateFieldGet(this,j))}else{top.BX.Socialnetwork.Spaces.space.reloadPageContent()}}}}]);return e}();function V(e,t){Q(e,t);t.add(e)}function Y(e,t,a){Q(e,t);t.set(e,a)}function Q(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function J(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var K=new WeakMap;var Z=new WeakMap;var $=new WeakSet;var ee=new WeakSet;var te=new WeakSet;var ae=function(){function e(t,a){babelHelpers.classCallCheck(this,e);V(this,te);V(this,ee);V(this,$);Y(this,K,{writable:true,value:void 0});Y(this,Z,{writable:true,value:void 0});if(!r.Type.isString(t)||!t){throw new Error("BX.Socialnetwork.PostFormTags: formId not found")}if(!r.Type.isDomNode(a)){throw new Error("BX.Socialnetwork.PostFormTags: form not found")}babelHelpers.classPrivateFieldSet(this,K,t);babelHelpers.classPrivateFieldSet(this,Z,a)}babelHelpers.createClass(e,[{key:"isFilled",value:function e(){var t=J(this,$,ie).call(this);return r.Type.isDomNode(t)&&t.value}},{key:"getValue",value:function e(){var t=J(this,$,ie).call(this);if(!r.Type.isDomNode(t)){return""}return t.value}},{key:"clear",value:function e(){J(this,ee,se).call(this).querySelectorAll(".feed-add-post-del-but").forEach((function(e){e.click()}));J(this,te,le).call(this)}}]);return e}();function ie(){return J(this,ee,se).call(this).querySelector('input[name="TAGS"]')}function se(){return babelHelpers.classPrivateFieldGet(this,Z).querySelector("#post-tags-block-".concat(babelHelpers.classPrivateFieldGet(this,K)))}function le(){r.Dom.style(J(this,ee,se).call(this),"display","none")}var re,ne,oe,be;function ce(e,t){pe(e,t);t.add(e)}function de(e,t,a){pe(e,t);t.set(e,a)}function pe(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function ve(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var he=r.Reflection.namespace("BX.userOptions");var ue=r.Reflection.namespace("BX.UI.Notification.Center");var He=new WeakMap;var fe=new WeakMap;var Pe=new WeakMap;var Fe=new WeakMap;var we=new WeakMap;var Te=new WeakMap;var ge=new WeakMap;var me=new WeakMap;var Se=new WeakMap;var Ie=new WeakMap;var Ge=new WeakMap;var ke=new WeakMap;var Ee=new WeakMap;var ye=new WeakMap;var ze=new WeakMap;var We=new WeakMap;var Ce=new WeakMap;var Me=new WeakMap;var De=new WeakMap;var _e=new WeakMap;var Re=new WeakSet;var Le=new WeakSet;var Oe=new WeakSet;var Be=new WeakSet;var Ae=new WeakSet;var xe=new WeakSet;var Ne=new WeakSet;var Xe=new WeakSet;var je=new WeakSet;var Ue=new WeakSet;var qe=new WeakSet;var Ve=new WeakSet;var Ye=new WeakSet;var Qe=new WeakSet;var Je=new WeakSet;var Ke=new WeakSet;var Ze=new WeakSet;var $e=new WeakSet;var et=new WeakSet;var tt=new WeakSet;var at=new WeakSet;var it=new WeakSet;var st=new WeakSet;var lt=new WeakSet;var rt=new WeakSet;var nt=new WeakSet;var ot=function(e){babelHelpers.inherits(t,e);function t(e){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));ce(babelHelpers.assertThisInitialized(a),nt);ce(babelHelpers.assertThisInitialized(a),rt);ce(babelHelpers.assertThisInitialized(a),lt);ce(babelHelpers.assertThisInitialized(a),st);ce(babelHelpers.assertThisInitialized(a),it);ce(babelHelpers.assertThisInitialized(a),at);ce(babelHelpers.assertThisInitialized(a),tt);ce(babelHelpers.assertThisInitialized(a),et);ce(babelHelpers.assertThisInitialized(a),$e);ce(babelHelpers.assertThisInitialized(a),Ze);ce(babelHelpers.assertThisInitialized(a),Ke);ce(babelHelpers.assertThisInitialized(a),Je);ce(babelHelpers.assertThisInitialized(a),Qe);ce(babelHelpers.assertThisInitialized(a),Ye);ce(babelHelpers.assertThisInitialized(a),Ve);ce(babelHelpers.assertThisInitialized(a),qe);ce(babelHelpers.assertThisInitialized(a),Ue);ce(babelHelpers.assertThisInitialized(a),je);ce(babelHelpers.assertThisInitialized(a),Xe);ce(babelHelpers.assertThisInitialized(a),Ne);ce(babelHelpers.assertThisInitialized(a),xe);ce(babelHelpers.assertThisInitialized(a),Ae);ce(babelHelpers.assertThisInitialized(a),Be);ce(babelHelpers.assertThisInitialized(a),Oe);ce(babelHelpers.assertThisInitialized(a),Le);ce(babelHelpers.assertThisInitialized(a),Re);de(babelHelpers.assertThisInitialized(a),He,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),fe,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Pe,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Fe,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),we,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Te,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),ge,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),me,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Se,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Ie,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Ge,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),ke,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Ee,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),ye,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),ze,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),We,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Ce,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),Me,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),De,{writable:true,value:void 0});de(babelHelpers.assertThisInitialized(a),_e,{writable:true,value:void 0});a.setEventNamespace("BX.Socialnetwork.PostForm");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),He,r.Type.isInteger(parseInt(e.postId,10))?parseInt(e.postId,10):0);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),fe,r.Type.isInteger(parseInt(e.groupId,10))?parseInt(e.groupId,10):0);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),we,"blogPostForm_".concat(r.Text.getRandom().toLowerCase()));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Te,"oPostFormLHE_blogPostForm".concat(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),we)));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),ge,"idPostFormLHE_".concat(babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),we)));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),me,false);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),Se,babelHelpers.classPrivateFieldGet(babelHelpers.assertThisInitialized(a),He)>0);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),ye,new q({pathToDefaultRedirect:e.pathToDefaultRedirect,pathToGroupRedirect:e.pathToGroupRedirect}));babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),De,{});return a}babelHelpers.createClass(t,[{key:"show",value:function e(){var t=this;if(babelHelpers.classPrivateFieldGet(this,Ie)){return new Promise((function(e,a){babelHelpers.classPrivateFieldGet(t,Ie).subscribeOnce("onShow",(function(){e()}));babelHelpers.classPrivateFieldGet(t,Ie).show()}))}return new Promise((function(e,a){ve(t,Re,bt).call(t).then((function(){ve(t,Le,ct).call(t);babelHelpers.classPrivateFieldGet(t,Ie).subscribeOnce("onShow",(function(){e()}));babelHelpers.classPrivateFieldGet(t,Ie).show()}))["catch"]((function(){return a()}))}))}}]);return t}(l.EventEmitter);function bt(){var e=this;return r.ajax.runAction("socialnetwork.api.livefeed.blogpost.getPostFormInitData",{data:{postId:babelHelpers.classPrivateFieldGet(this,He),groupId:babelHelpers.classPrivateFieldGet(this,fe)}}).then((function(t){babelHelpers.classPrivateFieldSet(e,Fe,t.data);babelHelpers.classPrivateFieldSet(e,ke,new u(babelHelpers.classPrivateFieldGet(e,Fe)));babelHelpers.classPrivateFieldSet(e,Pe,babelHelpers.classPrivateFieldGet(e,Fe).isShownPostTitle==="Y");babelHelpers.classPrivateFieldSet(e,Ee,new R({formId:babelHelpers.classPrivateFieldGet(e,we),LHEId:babelHelpers.classPrivateFieldGet(e,ge),isShownPostTitle:babelHelpers.classPrivateFieldGet(e,Pe)}));babelHelpers.classPrivateFieldGet(e,Ee).subscribe("editorInited",ve(e,at,yt).bind(e));babelHelpers.classPrivateFieldGet(e,Ee).subscribe("toggleVisibilityPostTitle",ve(e,it,zt).bind(e));babelHelpers.classPrivateFieldGet(e,Ee).subscribe("fullscreenExpand",ve(e,st,Wt).bind(e));babelHelpers.classPrivateFieldGet(e,Ee).subscribe("addMention",ve(e,lt,Ct).bind(e));babelHelpers.classPrivateFieldGet(e,Ee).subscribe("showControllers",ve(e,rt,Mt).bind(e));return e}))["catch"]((function(t){ve(e,nt,Dt).call(e,"init",t)}))}function ct(){var e=this;babelHelpers.classPrivateFieldSet(this,Ie,new t.Popup({id:babelHelpers.classPrivateFieldGet(this,we),className:"sn-post-form-popup --normal",content:ve(this,Ye,Tt).call(this),contentNoPaddings:true,minHeight:370,width:720,disableScroll:true,draggable:false,overlay:true,padding:0,buttons:[babelHelpers.classPrivateFieldSet(this,Ge,new i.Button({text:r.Loc.getMessage("SN_PF_SEND_BTN"),color:i.ButtonColor.PRIMARY,onclick:function t(){ve(e,xe,ht).call(e)}})),new i.Button({text:r.Loc.getMessage("SN_PF_CANCEL_BTN"),color:i.ButtonColor.LINK,onclick:function t(){babelHelpers.classPrivateFieldGet(e,Ie).close()}})],events:{onFirstShow:ve(this,Oe,dt).bind(this),onAfterShow:ve(this,Be,pt).bind(this),onAfterClose:ve(this,Ae,vt).bind(this)}}))}function dt(){var e=this;babelHelpers.classPrivateFieldGet(this,Ge).setWaiting(true);ve(this,Ke,St).call(this);ve(this,Ve,wt).call(this).then((function(t){t.then((function(){babelHelpers.classPrivateFieldGet(e,Ee).initLHE()}))}))}function pt(){ve(this,$e,Gt).call(this);babelHelpers.classPrivateFieldGet(this,Ee).focusToEditor()}function vt(){if(babelHelpers.classPrivateFieldGet(this,me)){ve(this,Ne,ut).call(this);if(BX.Livefeed&&BX.Livefeed.PageInstance){BX.Livefeed.PageInstance.refresh()}else{babelHelpers.classPrivateFieldGet(this,ye).redirectTo(babelHelpers.classPrivateFieldGet(this,fe))}}}function ht(){var e=this;if(babelHelpers.classPrivateFieldGet(this,Ge).isWaiting()){return}ve(this,qe,Ft).call(this);babelHelpers.classPrivateFieldGet(this,ke).setFormData(ve(this,Xe,Ht).call(this));var t=babelHelpers.classPrivateFieldGet(this,ke).validateRequestData();if(t){ve(this,Ue,Pt).call(this,t);babelHelpers.classPrivateFieldGet(this,Ee).focusToEditor();return}babelHelpers.classPrivateFieldGet(this,Ge).setWaiting(true);var a="socialnetwork.api.livefeed.blogpost.".concat(babelHelpers.classPrivateFieldGet(this,He)?"update":"add");var i=babelHelpers.classPrivateFieldGet(this,He)?{id:babelHelpers.classPrivateFieldGet(this,He),params:babelHelpers.classPrivateFieldGet(this,ke).prepareRequestData()}:{params:babelHelpers.classPrivateFieldGet(this,ke).prepareRequestData()};r.ajax.runAction(a,{data:i,analyticsLabel:{b24statAction:"addLogEntry",b24statContext:"spaces"}}).then((function(t){babelHelpers.classPrivateFieldSet(e,me,true);babelHelpers.classPrivateFieldGet(e,Ie).close()}))["catch"]((function(t){babelHelpers.classPrivateFieldGet(e,Ge).setWaiting(false);ve(e,nt,Dt).call(e,"sendForm",t)}))}function ut(){babelHelpers.classPrivateFieldGet(this,ke).setData(babelHelpers.classPrivateFieldGet(this,Fe));ve(this,Ze,It).call(this);babelHelpers.classPrivateFieldGet(this,Ce).querySelector("input").value="";babelHelpers.classPrivateFieldGet(this,Ee).clearEditorText();ve(this,je,ft).call(this);babelHelpers.classPrivateFieldGet(this,ze).clear();babelHelpers.classPrivateFieldSet(this,me,false);babelHelpers.classPrivateFieldGet(this,Ge).setWaiting(false)}function Ht(){var e={title:babelHelpers.classPrivateFieldGet(this,Ce).querySelector("input").value,message:babelHelpers.classPrivateFieldGet(this,Ee).getEditorText()};e.recipients=babelHelpers.classPrivateFieldGet(this,ke).getRecipients();var t=[];var a=BX.Disk.Uploader.UserFieldControl.getById(babelHelpers.classPrivateFieldGet(this,we));a.getFiles().forEach((function(e){if(e.getServerFileId()!==null){t.push(e.getServerFileId())}}));e.fileIds=t;if(babelHelpers.classPrivateFieldGet(this,ze).isFilled()){e.tags=babelHelpers.classPrivateFieldGet(this,ze).getValue()}return e}function ft(){var e=BX.Disk.Uploader.UserFieldControl.getById(babelHelpers.classPrivateFieldGet(this,we));e.clear();e.hide()}function Pt(e){r.Dom.removeClass(babelHelpers.classPrivateFieldGet(this,De).container,"--hidden");babelHelpers.classPrivateFieldGet(this,De).message.textContent=r.Text.encode(e)}function Ft(){r.Dom.addClass(babelHelpers.classPrivateFieldGet(this,De).container,"--hidden");babelHelpers.classPrivateFieldGet(this,De).message.textContent=""}function wt(){var e=this;return r.ajax.runAction("socialnetwork.api.livefeed.blogpost.getMainPostForm",{data:{params:{formId:babelHelpers.classPrivateFieldGet(this,we),jsObjName:babelHelpers.classPrivateFieldGet(this,Te),LHEId:babelHelpers.classPrivateFieldGet(this,ge),postId:babelHelpers.classPrivateFieldGet(this,He),text:babelHelpers.classPrivateFieldGet(this,ke).getMessage()}}}).then((function(t){return r.Runtime.html(babelHelpers.classPrivateFieldGet(e,We).querySelector("#sn-post-form"),t.data.html,{htmlFirst:true})}))["catch"]((function(t){ve(e,nt,Dt).call(e,"afterShow",t)}))}function Tt(){babelHelpers.classPrivateFieldSet(this,We,r.Tag.render(re||(re=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-post-form__discussion">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t",'\n\t\t\t\t<div id="sn-post-form"></div>\n\t\t\t</div>\n\t\t'])),ve(this,Qe,gt).call(this),ve(this,Je,mt).call(this),ve(this,tt,Et).call(this)));return babelHelpers.classPrivateFieldGet(this,We)}function gt(){var e=r.Tag.render(ne||(ne=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div\n\t\t\t\tclass="sn-post-form__discussion-error-alert ui-alert ui-alert-danger --hidden"\n\t\t\t\tref="container"\n\t\t\t>\n\t\t\t\t<span class="ui-alert-message" ref="message"></span>\n\t\t\t</div>\n\t\t']))),t=e.container,a=e.message;babelHelpers.classPrivateFieldGet(this,De).container=t;babelHelpers.classPrivateFieldGet(this,De).message=a;return t}function mt(){babelHelpers.classPrivateFieldSet(this,Me,r.Tag.render(oe||(oe=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-post-form__discussion-row"></div>\n\t\t']))));return babelHelpers.classPrivateFieldGet(this,Me)}function St(){var e=this;var t="sn-post-form-recipient-selector";babelHelpers.classPrivateFieldSet(this,_e,new a.TagSelector({id:t,dialogOptions:{id:t,context:"PostForm",preselectedItems:r.Type.isStringFilled(babelHelpers.classPrivateFieldGet(this,ke).getRecipients())?JSON.parse(babelHelpers.classPrivateFieldGet(this,ke).getRecipients()):[],entities:[{id:"meta-user",options:{"all-users":{title:babelHelpers.classPrivateFieldGet(this,ke).getAllUsersTitle(),allowView:babelHelpers.classPrivateFieldGet(this,ke).isAllowToAll()}}},{id:"user",options:{emailUsers:babelHelpers.classPrivateFieldGet(this,ke).isAllowEmailInvitation(),inviteGuestLink:babelHelpers.classPrivateFieldGet(this,ke).isAllowEmailInvitation(),myEmailUsers:true}},{id:"project",options:{features:{blog:["premoderate_post","moderate_post","write_post","full_post"]}}},{id:"department",options:{selectMode:"usersAndDepartments",allowFlatDepartments:false}}],events:{"Item:onSelect":function t(){ve(e,et,kt).call(e,babelHelpers.classPrivateFieldGet(e,_e).getDialog().getSelectedItems())},"Item:onDeselect":function t(){ve(e,et,kt).call(e,babelHelpers.classPrivateFieldGet(e,_e).getDialog().getSelectedItems())}}}}));babelHelpers.classPrivateFieldGet(this,_e).renderTo(babelHelpers.classPrivateFieldGet(this,Me));return babelHelpers.classPrivateFieldGet(this,_e)}function It(){r.Dom.clean(babelHelpers.classPrivateFieldGet(this,Me));ve(this,Ke,St).call(this)}function Gt(){if(!babelHelpers.classPrivateFieldGet(this,ze)){babelHelpers.classPrivateFieldSet(this,ze,new ae(babelHelpers.classPrivateFieldGet(this,we),babelHelpers.classPrivateFieldGet(this,We)))}}function kt(e){var t=[];e.forEach((function(e){t.push([e.entityId,e.id])}));babelHelpers.classPrivateFieldGet(this,ke).setRecipients(t.length>0?JSON.stringify(t):"")}function Et(){var e="ui-ctl ui-ctl-textbox ui-ctl-no-border ui-ctl-w100 ui-ctl-no-padding ui-ctl-xs";var t=babelHelpers.classPrivateFieldGet(this,Pe)?"":"--hidden";babelHelpers.classPrivateFieldSet(this,Ce,r.Tag.render(be||(be=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="sn-post-form__discussion-row ','">\n\t\t\t\t<div class="','">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tclass="ui-ctl-element sn-post-form__discussion_title"\n\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t\tdata-id="sn-post-form-title-input"\n\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),t,e,r.Loc.getMessage("SN_PF_TITLE_PLACEHOLDER"),r.Text.encode(babelHelpers.classPrivateFieldGet(this,ke).getTitle())));return babelHelpers.classPrivateFieldGet(this,Ce)}function yt(){babelHelpers.classPrivateFieldGet(this,Ge).setWaiting(false)}function zt(){r.Dom.toggleClass(babelHelpers.classPrivateFieldGet(this,Ce),"--hidden");var e=!r.Dom.hasClass(babelHelpers.classPrivateFieldGet(this,Ce),"--hidden");if(e){babelHelpers.classPrivateFieldGet(this,Ce).querySelector("input").focus()}he.save("socialnetwork","postEdit","showTitle",e?"Y":"N")}function Wt(){r.Dom.toggleClass(babelHelpers.classPrivateFieldGet(this,Ie).getPopupContainer(),"--normal")}function Ct(e){var t=e.getData(),a=t.type,i=t.entity,s=t.entityType;babelHelpers.classPrivateFieldGet(this,_e).getDialog().addItem({avatar:i.avatar,customData:{email:r.Type.isStringFilled(i.email)?i.email:""},entityId:a,entityType:s,id:i.entityId,title:i.name}).select()}function Mt(e){var t=babelHelpers.classPrivateFieldGet(this,Ie).getContentContainer();t.scrollTo({top:t.scrollHeight-t.clientHeight,behavior:"smooth"})}function Dt(e,t){ue.notify({content:r.Loc.getMessage("SN_PF_REQUEST_ERROR")});console.error("PostForm: ".concat(e," error"),t)}e.PostForm=ot})(this.BX.Socialnetwork=this.BX.Socialnetwork||{},BX.Main,BX.UI.EntitySelector,BX.UI,BX.UI.Uploader,BX.Event,BX);
//# sourceMappingURL=post-form.bundle.map.js