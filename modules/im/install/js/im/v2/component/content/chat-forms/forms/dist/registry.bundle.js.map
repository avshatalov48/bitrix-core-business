{"version":3,"file":"registry.bundle.js","sources":["../src/components/create/group-chat.js","../src/components/create/conference.js","../src/components/create/channel.js","../src/components/create/collab/components/description-banner/description-banner.js","../src/components/create/collab/components/rights-section.js","../src/components/create/collab/collab.js","../src/create-chat-content.js","../src/classes/chat-member-diff-manager.js","../src/helpers/get-collapsed-users-element.js","../src/components/update/group-chat.js","../src/components/update/channel.js","../src/components/update/collab.js","../src/update-chat-content.js"],"sourcesContent":["import 'ui.notification';\n\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ChatService } from 'im.v2.provider.service';\nimport { UserRole, PopupType, ChatType, EventType, Layout, type OnLayoutChangeEvent } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const GroupChatCreation = {\n\tname: 'GroupChatCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [['user', Core.getUserId()]],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.rights.ownerId = Core.getUserId();\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.chat);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CREATE_CHAT_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tthis.exitByCreation = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.chat)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups();\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --chat\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar :avatarFile=\"avatarFile\" :chatTitle=\"chatTitle\" @avatarChange=\"onAvatarChange\" />\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHAT_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector :chatMembers=\"chatMembers\" @membersChange=\"onMembersChange\" />\n\t\t\t</div>\n\t\t\t<SettingsSection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/> \n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CHAT_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import 'ui.notification';\n\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { EmptyAvatarType } from 'im.v2.component.elements';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ChatService } from 'im.v2.provider.service';\nimport { UserRole, PopupType, ChatType, EventType, Layout } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n\tConferenceSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\nimport type { OnLayoutChangeEvent } from 'im.v2.const';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ConferenceCreation = {\n\tname: 'ConferenceCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tConferenceSection,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [['user', Core.getUserId()]],\n\t\t\tconference: {\n\t\t\t\tpasswordNeeded: false,\n\t\t\t\tpassword: '',\n\t\t\t},\n\t\t\tsettings: {\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.rights.ownerId = Core.getUserId();\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.videoconf);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonPasswordNeededChange(passwordNeeded: boolean)\n\t\t{\n\t\t\tthis.conference.passwordNeeded = passwordNeeded;\n\t\t},\n\t\tonPasswordChange(newPassword: string)\n\t\t{\n\t\t\tthis.conference.password = newPassword;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tif (!this.checkPassword())\n\t\t\t{\n\t\t\t\tthis.showPasswordError();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\tentityType: ChatType.videoconf,\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t\tconferencePassword: this.conference.passwordNeeded ? this.conference.password : '',\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CREATE_CHAT_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.videoconf)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t\tconference: this.conference,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, conference, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.conference = conference;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups();\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tcheckPassword(): boolean\n\t\t{\n\t\t\tconst PASSWORD_MIN_LENGTH = 3;\n\t\t\tif (!this.conference.passwordNeeded)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst password = this.conference.password.trim();\n\n\t\t\treturn password !== '' && password.length >= PASSWORD_MIN_LENGTH;\n\t\t},\n\t\tshowPasswordError()\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc('IM_CREATE_CHAT_CONFERENCE_PASSWORD_ERROR'),\n\t\t\t});\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --conference\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\t\n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CONFERENCE_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector :chatMembers=\"chatMembers\" @membersChange=\"onMembersChange\" />\n\t\t\t</div>\n\t\t\t<ConferenceSection\n\t\t\t\t:passwordNeeded=\"conference.passwordNeeded\"\n\t\t\t\t:password=\"conference.password\"\n\t\t\t\t@passwordNeededChange=\"onPasswordNeededChange\"\n\t\t\t\t@passwordChange=\"onPasswordChange\"\n\t\t\t/>\n\t\t\t<SettingsSection\n\t\t\t\t:withSearchOption=\"false\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CONFERENCE_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import 'ui.notification';\n\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { EmptyAvatarType } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\nimport { UserRole, PopupType, ChatType, EventType, Layout, type OnLayoutChangeEvent } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tTextareaInput,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n\tPrivacySection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ChannelCreation = {\n\tname: 'ChannelCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tPrivacySection,\n\t\tButtonPanel,\n\t\tTextareaInput,\n\t\tCreateChatHeading,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [['user', Core.getUserId()]],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue)\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.rights.ownerId = Core.getUserId();\n\t\tthis.initDefaultRolesForRights();\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.channel);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tasync onCreateClick()\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\tconst { newDialogId } = await this.getChatService().createChat({\n\t\t\t\ttype: ChatType.channel,\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tmemberEntities: this.chatMembers,\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tmanagers: this.rights.managerIds,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isCreating = false;\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CREATE_CHAT_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.isCreating = false;\n\t\t\tthis.exitByCreation = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>)\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.channel)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tchatMembers: this.chatMembers,\n\t\t\t\tsettings: this.settings,\n\t\t\t\trights: this.rights,\n\t\t\t});\n\t\t},\n\t\trestoreFields()\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, chatMembers, settings, rights } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.chatMembers = chatMembers;\n\t\t\tthis.settings = settings;\n\t\t\tthis.rights = rights;\n\t\t},\n\t\tinitDefaultRolesForRights()\n\t\t{\n\t\t\tconst {\n\t\t\t\tmanageUsersAdd,\n\t\t\t\tmanageUsersDelete,\n\t\t\t\tmanageUi,\n\t\t\t\tmanageMessages,\n\t\t\t} = PermissionManager.getInstance().getDefaultRolesForActionGroups(ChatType.channel);\n\n\t\t\tthis.rights.manageUsersAdd = manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = manageUsersDelete;\n\t\t\tthis.rights.manageUi = manageUi;\n\t\t\tthis.rights.manageMessages = manageMessages;\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --channel\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHANNEL_TITLE_PLACEHOLDER_V2')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"settings.description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_PLACEHOLDER_V3')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<PrivacySection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t/>\n\t\t\t<CreateChatHeading\n\t\t\t\t:text=\"loc('IM_CREATE_CHANNEL_MEMBERS_TITLE')\"\n\t\t\t\t:hintText=\"loc('IM_CREATE_CHANNEL_MEMBERS_HINT')\"\n\t\t\t/>\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector :chatMembers=\"chatMembers\" @membersChange=\"onMembersChange\" />\n\t\t\t</div>\n\t\t\t<RightsSection\n\t\t\t\t:chatType=\"ChatType.channel\"\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_CHANNEL_CONFIRM')\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { Loc, Dom } from 'main.core';\n\nimport { openHelpdeskArticle } from 'im.v2.lib.helpdesk';\n\nimport './css/description-banner.css';\n\nconst LINK_CSS_CLASS = 'bx-im-create-collab-description-banner__link';\nconst TITLE_LINK_MODIFIER = '--title';\nconst INVITE_LINK_MODIFIER = '--invite';\n\n// @vue/component\nexport const DescriptionBanner = {\n\tname: 'DescriptionBanner',\n\tcomputed:\n\t{\n\t\tpreparedTitle(): string\n\t\t{\n\t\t\treturn Loc.getMessage('IM_CREATE_COLLAB_BANNER_TITLE', {\n\t\t\t\t'[learn-more]': `<span class=\"${LINK_CSS_CLASS} ${TITLE_LINK_MODIFIER} --solid\">`,\n\t\t\t\t'[/learn-more]': '</span>',\n\t\t\t});\n\t\t},\n\t\tpreparedInviteText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('IM_CREATE_COLLAB_BANNER_TEXT_2', {\n\t\t\t\t'[learn-more]': `<span class=\"${LINK_CSS_CLASS} ${INVITE_LINK_MODIFIER} --dashed\">`,\n\t\t\t\t'[/learn-more]': '</span>',\n\t\t\t});\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonTitleClick(event: PointerEvent)\n\t\t{\n\t\t\tif (!Dom.hasClass(event.target, TITLE_LINK_MODIFIER))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ARTICLE_CODE = '22706764';\n\t\t\topenHelpdeskArticle(ARTICLE_CODE);\n\t\t},\n\t\tonInviteClick(event: PointerEvent)\n\t\t{\n\t\t\tif (!Dom.hasClass(event.target, INVITE_LINK_MODIFIER))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ARTICLE_CODE = '22706836';\n\t\t\topenHelpdeskArticle(ARTICLE_CODE);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-create-collab-description-banner__container\" ref=\"container\">\n\t\t\t<div class=\"bx-im-create-collab-description-banner__icon\"></div>\n\t\t\t<div class=\"bx-im-create-collab-description-banner__content\">\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__title\" v-html=\"preparedTitle\" @click=\"onTitleClick\"></div>\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__text\">\n\t\t\t\t\t{{ loc('IM_CREATE_COLLAB_BANNER_TEXT_1') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-create-collab-description-banner__text\" v-html=\"preparedInviteText\" @click=\"onInviteClick\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, BaseEvent } from 'main.core.events';\nimport { AccessRights } from 'socialnetwork.collab.access-rights';\n\nimport { CreateChatExternalSection } from 'im.v2.component.content.chat-forms.elements';\n\nimport type { JsonObject } from 'main.core';\n\nexport type AccessRightsFormResult = {\n\tmoderators: number[],\n\townerId: number,\n\toptions: JsonObject,\n\tpermissions: JsonObject\n};\n\n// @vue/component\nexport const RightsSection = {\n\tname: 'RightsSection',\n\tcomponents: { CreateChatExternalSection },\n\tprops:\n\t{\n\t\tcollabId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: ['change'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tformResult: null,\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tasync onClick()\n\t\t{\n\t\t\tconst sliderParams = {};\n\t\t\tif (this.collabId > 0)\n\t\t\t{\n\t\t\t\tsliderParams.collabId = this.collabId;\n\t\t\t}\n\n\t\t\tif (this.formResult)\n\t\t\t{\n\t\t\t\tsliderParams.formData = this.formResult;\n\t\t\t}\n\t\t\tthis.form = await AccessRights.openForm(sliderParams);\n\t\t\tthis.bindEvents();\n\t\t},\n\t\tbindEvents()\n\t\t{\n\t\t\tEventEmitter.subscribe(this.form, 'save', this.onSave);\n\t\t\tEventEmitter.subscribe(this.form, 'cancel', this.onCancel);\n\t\t},\n\t\tunbindEvents()\n\t\t{\n\t\t\tEventEmitter.unsubscribe(this.form, 'save', this.onSave);\n\t\t\tEventEmitter.unsubscribe(this.form, 'cancel', this.onCancel);\n\t\t},\n\t\tonSave(event: BaseEvent<AccessRightsFormResult>)\n\t\t{\n\t\t\tthis.formResult = event.getData();\n\t\t\tthis.$emit('change', this.formResult);\n\t\t\tthis.unbindEvents();\n\t\t},\n\t\tonCancel()\n\t\t{\n\t\t\tthis.unbindEvents();\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CreateChatExternalSection\n\t\t\t:title=\"loc('IM_CREATE_CHAT_RIGHTS_SECTION')\"\n\t\t\t@click=\"onClick\"\n\t\t\tname=\"rights\"\n\t\t/>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { ChatService } from 'im.v2.provider.service';\nimport { EmptyAvatarType } from 'im.v2.component.elements';\nimport { ChatType, EventType, Layout, Color } from 'im.v2.const';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { TitleInput, ChatAvatar, CreateChatHeading, TextareaInput, ButtonPanel } from 'im.v2.component.content.chat-forms.elements';\n\nimport { DescriptionBanner } from './components/description-banner/description-banner';\nimport { RightsSection } from './components/rights-section';\n\nimport type { JsonObject } from 'main.core';\nimport type { CustomColorScheme } from 'im.v2.component.elements';\nimport type { OnLayoutChangeEvent } from 'im.v2.const';\nimport type { AccessRightsFormResult } from './components/rights-section';\n\nconst CreateCollabErrorCode = {\n\temptyName: 'name',\n\tduplicateName: 'ERROR_GROUP_NAME_EXISTS',\n};\n\nconst NotificationTextByErrorCode = {\n\t[CreateCollabErrorCode.emptyName]: Loc.getMessage('IM_CREATE_COLLAB_ERROR_EMPTY_NAME'),\n\t[CreateCollabErrorCode.duplicateName]: Loc.getMessage('IM_CREATE_COLLAB_ERROR_DUPLICATE_NAME'),\n\tdefault: Loc.getMessage('IM_CREATE_CHAT_ERROR'),\n};\n\nexport const CollabCreation = {\n\tname: 'CollabCreation',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tDescriptionBanner,\n\t\tCreateChatHeading,\n\t\tTextareaInput,\n\t\tButtonPanel,\n\t\tRightsSection,\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisCreating: false,\n\t\t\tavatarFile: null,\n\t\t\tchatTitle: '',\n\t\t\tdescription: '',\n\t\t\tgroupSettings: {\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tmoderatorMembers: [],\n\t\t\t\toptions: null,\n\t\t\t\tpermissions: null,\n\t\t\t},\n\t\t};\n\t},\n\twatch:\n\t{\n\t\tchatTitle(newValue: string): void\n\t\t{\n\t\t\tCreateChatManager.getInstance().setChatTitle(newValue);\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tcreateButtonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: Color.collab60,\n\t\t\t\ticonColor: Color.white,\n\t\t\t\ttextColor: Color.white,\n\t\t\t\thoverColor: Color.collab50,\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tthis.restoreFields();\n\t\tCreateChatManager.getInstance().setChatType(ChatType.collab);\n\t\tCreateChatManager.getInstance().setCreationStatus(true);\n\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.layout.onLayoutChange, this.onLayoutChange);\n\n\t\tif (this.exitByCancel || this.exitByChatTypeSwitch || this.exitByCreation)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.saveFields();\n\t},\n\tmethods:\n\t{\n\t\trestoreFields(): void\n\t\t{\n\t\t\tconst savedFields = CreateChatManager.getInstance().getFields();\n\t\t\tif (!savedFields)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { chatTitle, avatarFile, description } = savedFields;\n\t\t\tthis.chatTitle = chatTitle;\n\t\t\tthis.avatarFile = avatarFile;\n\t\t\tthis.description = description;\n\t\t},\n\t\tsaveFields()\n\t\t{\n\t\t\tCreateChatManager.getInstance().saveFields({\n\t\t\t\tchatTitle: this.chatTitle,\n\t\t\t\tavatarFile: this.avatarFile,\n\t\t\t\tdescription: this.description,\n\t\t\t});\n\t\t},\n\t\tonLayoutChange(event: BaseEvent<OnLayoutChangeEvent>): void\n\t\t{\n\t\t\tconst { to } = event.getData();\n\t\t\tif (to.name === Layout.createChat.name && to.entityId !== ChatType.collab)\n\t\t\t{\n\t\t\t\tthis.exitByChatTypeSwitch = true;\n\t\t\t}\n\t\t},\n\t\tasync onCreateClick(): void\n\t\t{\n\t\t\tthis.isCreating = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst { newDialogId } = await this.getChatService().createCollab({\n\t\t\t\t\ttitle: this.chatTitle,\n\t\t\t\t\tavatar: this.avatarFile,\n\t\t\t\t\tdescription: this.description,\n\t\t\t\t\townerId: this.groupSettings.ownerId,\n\t\t\t\t\tmoderatorMembers: this.groupSettings.moderatorMembers,\n\t\t\t\t\toptions: this.groupSettings.options,\n\t\t\t\t\tpermissions: this.groupSettings.permissions,\n\t\t\t\t});\n\n\t\t\t\tthis.isCreating = false;\n\t\t\t\tthis.exitByCreation = true;\n\t\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\t\tawait Messenger.openChat(newDialogId);\n\t\t\t\tEventEmitter.emit(EventType.header.openAddToChatPopup);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.handleCreationError(error);\n\t\t\t}\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tthis.exitByCancel = true;\n\t\t\tCreateChatManager.getInstance().setCreationStatus(false);\n\t\t\tMessenger.openChat();\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tCreateChatManager.getInstance().setChatAvatar(this.avatarFile);\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.description = description;\n\t\t},\n\t\tonRightsChange(rights: AccessRightsFormResult)\n\t\t{\n\t\t\tconst { ownerId, moderators, permissions, options } = rights;\n\t\t\tthis.groupSettings.ownerId = ownerId;\n\t\t\tthis.groupSettings.moderatorMembers = moderators;\n\t\t\tthis.groupSettings.permissions = permissions;\n\t\t\tthis.groupSettings.options = options;\n\t\t},\n\t\thandleCreationError(error: { code: $Values<typeof CreateCollabErrorCode> })\n\t\t{\n\t\t\tconst { code } = error;\n\t\t\tconst notificationText = NotificationTextByErrorCode[code] ?? NotificationTextByErrorCode.default;\n\t\t\tthis.isCreating = false;\n\t\t\tBX.UI.Notification.Center.notify({ content: notificationText });\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --collab\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar \n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t:type=\"EmptyAvatarType.collab\" \n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_COLLAB_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<DescriptionBanner />\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_COLLAB_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_COLLAB_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection @change=\"onRightsChange\" />\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isCreating\"\n\t\t\t:createButtonTitle=\"loc('IM_CREATE_COLLAB_CONFIRM')\"\n\t\t\t:createButtonColorScheme=\"createButtonColorScheme\"\n\t\t\t@create=\"onCreateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { ChatType } from 'im.v2.const';\n\nimport { GroupChatCreation } from './components/create/group-chat';\nimport { ConferenceCreation } from './components/create/conference';\nimport { ChannelCreation } from './components/create/channel';\nimport { CollabCreation } from './components/create/collab/collab';\n\nimport './css/chat-forms-content.css';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\nexport type CreatableChatType = $Values<typeof CreatableChat>;\n\nexport const CreatableChat = {\n\tchat: 'chat',\n\tvideoconf: 'videoconf',\n\tchannel: 'channel',\n\tcollab: 'collab',\n};\n\nconst CreationComponentByChatType = {\n\t[ChatType.chat]: GroupChatCreation,\n\t[ChatType.videoconf]: ConferenceCreation,\n\t[ChatType.channel]: ChannelCreation,\n\t[ChatType.collab]: CollabCreation,\n\tdefault: GroupChatCreation,\n};\n\n// @vue/component\nexport const CreateChatContent = {\n\tname: 'CreateChatContent',\n\tcomponents: { GroupChatCreation, ConferenceCreation, ChannelCreation, CollabCreation },\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tchatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\treturn this.entityId;\n\t\t},\n\t\tcreationComponent(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn CreationComponentByChatType[this.chatType] ?? CreationComponentByChatType.default;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__container\">\n\t\t\t<component :is=\"creationComponent\" />\n\t\t</div>\n\t`,\n};\n","type MemberElement = [string, number | string];\n\nexport class ChatMemberDiffManager\n{\n\t#initialManagers: number[] = [];\n\t#initialMembers: MemberElement[] = [];\n\n\tsetInitialManagers(initialManagers: number[])\n\t{\n\t\tthis.#initialManagers = initialManagers;\n\t}\n\n\tsetInitialChatMembers(initialMembers: MemberElement)\n\t{\n\t\tthis.#initialMembers = initialMembers;\n\t}\n\n\tgetAddedMemberEntities(modifiedEntities: MemberElement[]): MemberElement[]\n\t{\n\t\tconst originalSet = new Set(this.#initialMembers.map((elem) => JSON.stringify(elem)));\n\n\t\treturn modifiedEntities.filter((elem) => !originalSet.has(JSON.stringify(elem)));\n\t}\n\n\tgetDeletedMemberEntities(modifiedEntities: MemberElement[]): MemberElement[]\n\t{\n\t\tconst modifiedSet = new Set(modifiedEntities.map((elem) => JSON.stringify(elem)));\n\n\t\treturn this.#initialMembers.filter((elem) => !modifiedSet.has(JSON.stringify(elem)));\n\t}\n\n\tgetAddedManagers(modifiedArray: number[]): number[]\n\t{\n\t\tconst originalSet = new Set(this.#initialManagers);\n\n\t\treturn modifiedArray.filter((elem) => !originalSet.has(elem));\n\t}\n\n\tgetDeletedManagers(modifiedArray: number[]): number[]\n\t{\n\t\tconst modifiedSet = new Set(modifiedArray);\n\n\t\treturn this.#initialManagers.filter((elem) => !modifiedSet.has(elem));\n\t}\n}\n","const ENTITY_ID = 'imUpdateChatCollapsedUsers';\nconst AVATAR_URL = '/bitrix/js/im/v2/component/content/chat-forms/src/css/images/collapsed-users-avatar.svg';\n\nexport type TagSelectorElement = {\n\tid: number,\n\tentityId: string,\n\tavatar: string,\n\ttitle: {\n\t\ttext: string,\n\t\ttype: 'html',\n\t},\n\tdeselectable: boolean,\n\ttagOptions: {\n\t\tonclick: Function,\n\t},\n};\n\nexport function getCollapsedUsersElement({ title, onclick }): TagSelectorElement\n{\n\tconst textNode = `\n\t\t<div class=\"bx-im-content-chat-forms__collapsed-users\">\n\t\t\t${title}\n\t\t\t<div class=\"bx-im-content-chat-forms__collapsed-users-icon\"></div>\n\t\t</div>\n\t`;\n\n\treturn {\n\t\tid: 0,\n\t\tentityId: ENTITY_ID,\n\t\tavatar: AVATAR_URL,\n\t\ttitle: {\n\t\t\ttext: textNode,\n\t\t\ttype: 'html',\n\t\t},\n\t\tdeselectable: false,\n\t\ttagOptions: { onclick },\n\t};\n}\n","import 'ui.notification';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service';\nimport { ChatType, EventType, PopupType, SidebarDetailBlock, UserRole } from 'im.v2.const';\nimport { showExitUpdateChatConfirm } from 'im.v2.lib.confirm';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\nimport { getCollapsedUsersElement, type TagSelectorElement } from '../../helpers/get-collapsed-users-element';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const GroupChatUpdating = {\n\tname: 'GroupChatUpdating',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t\tisUpdating: false,\n\t\t\tareUsersCollapsed: false,\n\t\t\tcollapsedUsersCount: 0,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: false,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcollapsedUsers(): TagSelectorElement[]\n\t\t{\n\t\t\tif (!this.areUsersCollapsed)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst title = this.loc('IM_UPDATE_GROUP_CHAT_COLLAPSED_ELEMENT', {\n\t\t\t\t'#COUNT#': this.collapsedUsersCount,\n\t\t\t});\n\n\t\t\tconst element = getCollapsedUsersElement({\n\t\t\t\ttitle,\n\t\t\t\tonclick: this.onCollapsedUsersClick,\n\t\t\t});\n\n\t\t\treturn [element];\n\t\t},\n\t\tcanChangeSearchAvailability(): boolean\n\t\t{\n\t\t\treturn [ChatType.open, ChatType.chat].includes(this.dialog.type);\n\t\t},\n\t\tchangedChatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\tif (!this.canChangeSearchAvailability)\n\t\t\t{\n\t\t\t\treturn this.dialog.type;\n\t\t\t}\n\n\t\t\treturn this.settings.isAvailableInSearch ? ChatType.open : ChatType.chat;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tawait this.fillForm();\n\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\tthis.memberDiffManager.setInitialChatMembers(this.chatMembers);\n\t\tthis.memberDiffManager.setInitialManagers(this.rights.managerIds);\n\n\t\tthis.isLoading = false;\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.settings.description = this.dialog.description;\n\t\t\tthis.chatMembers = await this.getMemberEntities();\n\t\t\tthis.rights.ownerId = this.dialog.ownerId;\n\t\t\tthis.rights.manageMessages = this.dialog.permissions.manageMessages;\n\t\t\tthis.rights.managerIds = this.dialog.managerList;\n\t\t\tthis.rights.manageUi = this.dialog.permissions.manageUi;\n\t\t\tthis.rights.manageUsersAdd = this.dialog.permissions.manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = this.dialog.permissions.manageUsersDelete;\n\t\t\tthis.settings.isAvailableInSearch = this.dialog.type === ChatType.open;\n\t\t},\n\t\tasync getMemberEntities(): Promise<[string, number][]>\n\t\t{\n\t\t\tconst {\n\t\t\t\tmemberEntities,\n\t\t\t\tareUsersCollapsed,\n\t\t\t\tuserCount,\n\t\t\t} = await this.getChatService().getMemberEntities(this.chatId);\n\n\t\t\tif (areUsersCollapsed)\n\t\t\t{\n\t\t\t\tthis.areUsersCollapsed = true;\n\t\t\t\tthis.collapsedUsersCount = userCount;\n\n\t\t\t\treturn memberEntities;\n\t\t\t}\n\n\t\t\treturn memberEntities;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tawait this.getChatService().updateChat(this.chatId, {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\ttype: this.changedChatType,\n\t\t\t\taddedMemberEntities: this.memberDiffManager.getAddedMemberEntities(this.chatMembers),\n\t\t\t\tdeletedMemberEntities: this.memberDiffManager.getDeletedMemberEntities(this.chatMembers),\n\t\t\t\taddedManagers: this.memberDiffManager.getAddedManagers(this.rights.managerIds),\n\t\t\t\tdeletedManagers: this.memberDiffManager.getDeletedManagers(this.rights.managerIds),\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isUpdating = false;\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_UPDATE_CHAT_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.isUpdating = false;\n\n\t\t\treturn Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync onCollapsedUsersClick()\n\t\t{\n\t\t\tconst confirmResult = await showExitUpdateChatConfirm(this.dialogId);\n\t\t\tif (!confirmResult)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.onUpdateClick();\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-content-chat-forms__skeleton\"></div>\n\t\t<div v-else class=\"bx-im-content-chat-forms__content --chat\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\" \n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\" \n\t\t\t\t\t:chatTitle=\"chatTitle\" \n\t\t\t\t\t@avatarChange=\"onAvatarChange\" \n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHAT_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHAT_MEMBERS_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector \n\t\t\t\t\t:customElements=\"collapsedUsers\"\n\t\t\t\t\t:chatMembers=\"chatMembers\" \n\t\t\t\t\t@membersChange=\"onMembersChange\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SettingsSection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t:description=\"settings.description\"\n\t\t\t\t:withSearchOption=\"canChangeSearchAvailability\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t\t@descriptionChange=\"onDescriptionChange\"\n\t\t\t/>\n\t\t\t<RightsSection\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isUpdating || isLoading\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import 'ui.notification';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\n\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service';\nimport { EmptyAvatarType } from 'im.v2.component.elements';\nimport { UserRole, PopupType, ChatType, EventType, SidebarDetailBlock } from 'im.v2.const';\nimport { showExitUpdateChatConfirm } from 'im.v2.lib.confirm';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tChatMembersSelector,\n\tButtonPanel,\n\tTextareaInput,\n\tCreateChatHeading,\n\tSettingsSection,\n\tRightsSection,\n\tAppearanceSection,\n\tPrivacySection,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\nimport { getCollapsedUsersElement, type TagSelectorElement } from '../../helpers/get-collapsed-users-element';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { JsonObject } from 'main.core';\n\ntype UserRoleItem = $Keys<typeof UserRole>;\n\n// @vue/component\nexport const ChannelUpdating = {\n\tname: 'ChannelUpdating',\n\tcomponents: {\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tChatMembersSelector,\n\t\tSettingsSection,\n\t\tRightsSection,\n\t\tAppearanceSection,\n\t\tPrivacySection,\n\t\tButtonPanel,\n\t\tTextareaInput,\n\t\tCreateChatHeading,\n\t},\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t\tisUpdating: false,\n\t\t\tareUsersCollapsed: false,\n\t\t\tcollapsedUsersCount: 0,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tchatMembers: [],\n\t\t\tsettings: {\n\t\t\t\tisAvailableInSearch: true,\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t\trights: {\n\t\t\t\townerId: 0,\n\t\t\t\tmanagerIds: [],\n\t\t\t\tmanageUsersAdd: '',\n\t\t\t\tmanageUsersDelete: '',\n\t\t\t\tmanageUi: '',\n\t\t\t\tmanageMessages: '',\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcollapsedUsers(): TagSelectorElement[]\n\t\t{\n\t\t\tif (!this.areUsersCollapsed)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst title = this.loc('IM_UPDATE_CHANNEL_COLLAPSED_ELEMENT', {\n\t\t\t\t'#COUNT#': this.collapsedUsersCount,\n\t\t\t});\n\n\t\t\tconst element = getCollapsedUsersElement({\n\t\t\t\ttitle,\n\t\t\t\tonclick: this.onCollapsedUsersClick,\n\t\t\t});\n\n\t\t\treturn [element];\n\t\t},\n\t\tchangedChatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\treturn this.settings.isAvailableInSearch ? ChatType.openChannel : ChatType.channel;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tawait this.fillForm();\n\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\tthis.memberDiffManager.setInitialChatMembers(this.chatMembers);\n\t\tthis.memberDiffManager.setInitialManagers(this.rights.managerIds);\n\n\t\tthis.isLoading = false;\n\t},\n\tmethods:\n\t{\n\t\tonMembersChange(currentTags: [string, number | string][])\n\t\t{\n\t\t\tthis.chatMembers = currentTags;\n\t\t},\n\t\tonOwnerChange(ownerId: number)\n\t\t{\n\t\t\tthis.rights.ownerId = ownerId;\n\t\t},\n\t\tonManagersChange(managerIds: number[])\n\t\t{\n\t\t\tthis.rights.managerIds = managerIds;\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.settings.description = description;\n\t\t},\n\t\tonManageUsersAddChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersAdd = newValue;\n\t\t},\n\t\tonManageUsersDeleteChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUsersDelete = newValue;\n\t\t},\n\t\tonManageUiChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageUi = newValue;\n\t\t},\n\t\tonManageMessagesChange(newValue: UserRoleItem)\n\t\t{\n\t\t\tthis.rights.manageMessages = newValue;\n\t\t},\n\t\tonChatTypeChange(isAvailableInSearch: boolean)\n\t\t{\n\t\t\tthis.settings.isAvailableInSearch = isAvailableInSearch;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tawait this.getChatService().updateChat(this.chatId, {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\ttype: this.changedChatType,\n\t\t\t\taddedMemberEntities: this.memberDiffManager.getAddedMemberEntities(this.chatMembers),\n\t\t\t\tdeletedMemberEntities: this.memberDiffManager.getDeletedMemberEntities(this.chatMembers),\n\t\t\t\taddedManagers: this.memberDiffManager.getAddedManagers(this.rights.managerIds),\n\t\t\t\tdeletedManagers: this.memberDiffManager.getDeletedManagers(this.rights.managerIds),\n\t\t\t\townerId: this.rights.ownerId,\n\t\t\t\tisAvailableInSearch: this.settings.isAvailableInSearch,\n\t\t\t\tdescription: this.settings.description,\n\t\t\t\tmanageUsersAdd: this.rights.manageUsersAdd,\n\t\t\t\tmanageUsersDelete: this.rights.manageUsersDelete,\n\t\t\t\tmanageUi: this.rights.manageUi,\n\t\t\t\tmanageMessages: this.rights.manageMessages,\n\t\t\t}).catch(() => {\n\t\t\t\tthis.isUpdating = false;\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_UPDATE_CHAT_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.isUpdating = false;\n\n\t\t\treturn Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonScroll()\n\t\t{\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersAddMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUsersDeleteMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageUiMenu)?.close();\n\t\t\tMenuManager.getMenuById(PopupType.createChatManageMessagesMenu)?.close();\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.settings.description = this.dialog.description;\n\t\t\tthis.chatMembers = await this.getMemberEntities();\n\t\t\tthis.rights.ownerId = this.dialog.ownerId;\n\t\t\tthis.rights.manageMessages = this.dialog.permissions.manageMessages;\n\t\t\tthis.rights.managerIds = this.dialog.managerList;\n\t\t\tthis.rights.manageUi = this.dialog.permissions.manageUi;\n\t\t\tthis.rights.manageUsersAdd = this.dialog.permissions.manageUsersAdd;\n\t\t\tthis.rights.manageUsersDelete = this.dialog.permissions.manageUsersDelete;\n\t\t\tthis.settings.isAvailableInSearch = this.dialog.type === ChatType.openChannel;\n\t\t},\n\t\tasync getMemberEntities(): Promise<[string, number][]>\n\t\t{\n\t\t\tconst {\n\t\t\t\tmemberEntities,\n\t\t\t\tareUsersCollapsed,\n\t\t\t\tuserCount,\n\t\t\t} = await this.getChatService().getMemberEntities(this.chatId);\n\n\t\t\tif (areUsersCollapsed)\n\t\t\t{\n\t\t\t\tthis.areUsersCollapsed = true;\n\t\t\t\tthis.collapsedUsersCount = userCount;\n\n\t\t\t\treturn memberEntities;\n\t\t\t}\n\n\t\t\treturn memberEntities;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync onCollapsedUsersClick()\n\t\t{\n\t\t\tconst confirmResult = await showExitUpdateChatConfirm(this.dialogId);\n\t\t\tif (!confirmResult)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.onUpdateClick();\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isLoading\" class=\"bx-im-content-chat-forms__skeleton\"></div>\n\t\t<div v-else class=\"bx-im-content-chat-forms__content --channel\" @scroll=\"onScroll\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\"\n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\"\n\t\t\t\t\t:type=\"EmptyAvatarType.squared\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\"\n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_CHANNEL_TITLE_PLACEHOLDER_V2')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"settings.description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_CHANNEL_DESCRIPTION_PLACEHOLDER_V3')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<PrivacySection\n\t\t\t\t:isAvailableInSearch=\"settings.isAvailableInSearch\"\n\t\t\t\t@chatTypeChange=\"onChatTypeChange\"\n\t\t\t/>\n\t\t\t<CreateChatHeading\n\t\t\t\t:text=\"loc('IM_CREATE_CHANNEL_MEMBERS_TITLE')\"\n\t\t\t\t:hintText=\"loc('IM_CREATE_CHANNEL_MEMBERS_HINT')\"\n\t\t\t/>\n\t\t\t<div class=\"bx-im-content-chat-forms__members_container\">\n\t\t\t\t<ChatMembersSelector\n\t\t\t\t\t:customElements=\"collapsedUsers\"\n\t\t\t\t\t:chatMembers=\"chatMembers\" \n\t\t\t\t\t@membersChange=\"onMembersChange\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection\n\t\t\t\t:chatType=\"ChatType.channel\"\n\t\t\t\t:ownerId=\"rights.ownerId\"\n\t\t\t\t:managerIds=\"rights.managerIds\"\n\t\t\t\t:manageUsersAdd=\"rights.manageUsersAdd\"\n\t\t\t\t:manageUsersDelete=\"rights.manageUsersDelete\"\n\t\t\t\t:manageUi=\"rights.manageUi\"\n\t\t\t\t:manageMessages=\"rights.manageMessages\"\n\t\t\t\t@ownerChange=\"onOwnerChange\"\n\t\t\t\t@managersChange=\"onManagersChange\"\n\t\t\t\t@manageUsersAddChange=\"onManageUsersAddChange\"\n\t\t\t\t@manageUsersDeleteChange=\"onManageUsersDeleteChange\"\n\t\t\t\t@manageUiChange=\"onManageUiChange\"\n\t\t\t\t@manageMessagesChange=\"onManageMessagesChange\"\n\t\t\t/>\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isLoading || isUpdating\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import 'ui.notification';\nimport { Loc } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChatService } from 'im.v2.provider.service';\nimport { EmptyAvatarType } from 'im.v2.component.elements';\nimport { Color } from 'im.v2.const';\nimport {\n\tTitleInput,\n\tChatAvatar,\n\tButtonPanel,\n\tCreateChatHeading,\n\tTextareaInput,\n} from 'im.v2.component.content.chat-forms.elements';\n\nimport { RightsSection } from '../create/collab/components/rights-section';\nimport { ChatMemberDiffManager } from '../../classes/chat-member-diff-manager';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelCollabInfo } from 'im.v2.model';\nimport type { CustomColorScheme } from 'im.v2.component.elements';\n\nimport type { AccessRightsFormResult } from '../create/collab/components/rights-section';\n\nconst UpdateCollabErrorCode = {\n\temptyName: 'name',\n\tduplicateName: 'ERROR_GROUP_NAME_EXISTS',\n};\n\nconst NotificationTextByErrorCode = {\n\t[UpdateCollabErrorCode.emptyName]: Loc.getMessage('IM_CREATE_COLLAB_ERROR_EMPTY_NAME'),\n\t[UpdateCollabErrorCode.duplicateName]: Loc.getMessage('IM_CREATE_COLLAB_ERROR_DUPLICATE_NAME'),\n\tdefault: Loc.getMessage('IM_UPDATE_CHAT_ERROR'),\n};\n\n// @vue/component\nexport const CollabUpdating = {\n\tname: 'CollabUpdating',\n\tcomponents:\n\t{\n\t\tTitleInput,\n\t\tChatAvatar,\n\t\tTextareaInput,\n\t\tButtonPanel,\n\t\tCreateChatHeading,\n\t\tRightsSection,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisUpdating: false,\n\t\t\tavatarFile: null,\n\t\t\tavatarUrl: '',\n\t\t\tchatTitle: '',\n\t\t\tdescription: '',\n\t\t\tgroupSettings: {\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tmoderatorMembers: [],\n\t\t\t\toptions: null,\n\t\t\t\tpermissions: null,\n\t\t\t\tisModified: false,\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tEmptyAvatarType: () => EmptyAvatarType,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tcollabId(): number\n\t\t{\n\t\t\tconst { collabId }: ImModelCollabInfo = this.$store.getters['chats/collabs/getByChatId'](this.chatId);\n\n\t\t\treturn collabId;\n\t\t},\n\t\tupdateButtonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: Color.collab60,\n\t\t\t\ticonColor: Color.white,\n\t\t\t\ttextColor: Color.white,\n\t\t\t\thoverColor: Color.collab50,\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.fillForm();\n\t\tthis.initDiffManager();\n\t},\n\tmethods:\n\t{\n\t\tinitDiffManager()\n\t\t{\n\t\t\tthis.memberDiffManager = new ChatMemberDiffManager();\n\t\t\tconst managersWithoutOwner = this.dialog.managerList.filter((managerId) => {\n\t\t\t\treturn managerId !== Core.getUserId();\n\t\t\t});\n\t\t\tthis.memberDiffManager.setInitialManagers(managersWithoutOwner);\n\t\t},\n\t\tasync fillForm()\n\t\t{\n\t\t\tthis.chatTitle = this.dialog.name;\n\t\t\tthis.avatarUrl = this.dialog.avatar;\n\t\t\tthis.description = this.dialog.description;\n\t\t},\n\t\tonAvatarChange(newAvatarFile: File)\n\t\t{\n\t\t\tthis.avatarFile = newAvatarFile;\n\t\t\tthis.avatarUrl = '';\n\t\t},\n\t\tonDescriptionChange(description: string)\n\t\t{\n\t\t\tthis.description = description;\n\t\t},\n\t\tonRightsChange(rights: AccessRightsFormResult)\n\t\t{\n\t\t\tconst { ownerId, moderators, permissions, options } = rights;\n\t\t\tthis.groupSettings.ownerId = ownerId;\n\t\t\tthis.groupSettings.moderatorMembers = moderators;\n\t\t\tthis.groupSettings.permissions = permissions;\n\t\t\tthis.groupSettings.options = options;\n\n\t\t\tthis.groupSettings.isModified = true;\n\t\t},\n\t\tasync onUpdateClick(): Promise\n\t\t{\n\t\t\tAnalytics.getInstance().chatEdit.onSubmitForm(this.dialogId);\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\n\t\t\tthis.isUpdating = true;\n\n\t\t\tlet payload = {\n\t\t\t\ttitle: this.chatTitle,\n\t\t\t\tavatar: this.avatarFile,\n\t\t\t\tdescription: this.description,\n\t\t\t};\n\n\t\t\tif (this.groupSettings.isModified)\n\t\t\t{\n\t\t\t\tconst groupSettings = {\n\t\t\t\t\townerId: this.groupSettings.ownerId,\n\t\t\t\t\toptions: this.groupSettings.options,\n\t\t\t\t\tpermissions: this.groupSettings.permissions,\n\t\t\t\t\taddModeratorMembers: this.memberDiffManager.getAddedManagers(this.groupSettings.moderatorMembers),\n\t\t\t\t\tdeleteModeratorMembers: this.memberDiffManager.getDeletedManagers(this.groupSettings.moderatorMembers),\n\t\t\t\t};\n\n\t\t\t\tpayload = {\n\t\t\t\t\t...payload,\n\t\t\t\t\tgroupSettings,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait this.getChatService().updateCollab(this.dialogId, payload);\n\t\t\t\tthis.isUpdating = false;\n\t\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.handleUpdateError(error);\n\t\t\t}\n\t\t},\n\t\tonCancelClick()\n\t\t{\n\t\t\tAnalytics.getInstance().ignoreNextChatOpen(this.dialogId);\n\t\t\tvoid Messenger.openChat(this.dialogId);\n\t\t},\n\t\thandleUpdateError(error: { code: $Values<typeof UpdateCollabErrorCode> })\n\t\t{\n\t\t\tconsole.error('1', error);\n\t\t\tconst { code } = error;\n\t\t\tconst notificationText = NotificationTextByErrorCode[code] ?? NotificationTextByErrorCode.default;\n\t\t\tthis.isUpdating = false;\n\t\t\tBX.UI.Notification.Center.notify({ content: notificationText });\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__content --collab\">\n\t\t\t<div class=\"bx-im-content-chat-forms__header\">\n\t\t\t\t<ChatAvatar\n\t\t\t\t\t:avatarFile=\"avatarFile\"\n\t\t\t\t\t:existingAvatarUrl=\"avatarUrl\"\n\t\t\t\t\t:chatTitle=\"chatTitle\"\n\t\t\t\t\t:type=\"EmptyAvatarType.collab\"\n\t\t\t\t\t@avatarChange=\"onAvatarChange\"\n\t\t\t\t/>\n\t\t\t\t<TitleInput v-model=\"chatTitle\" :placeholder=\"loc('IM_CREATE_COLLAB_TITLE_PLACEHOLDER')\" />\n\t\t\t</div>\n\t\t\t<CreateChatHeading :text=\"loc('IM_CREATE_COLLAB_DESCRIPTION_TITLE')\" />\n\t\t\t<div class=\"bx-im-content-chat-forms__description_container\">\n\t\t\t\t<TextareaInput\n\t\t\t\t\t:value=\"description\"\n\t\t\t\t\t:placeholder=\"loc('IM_CREATE_COLLAB_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t:border=\"false\"\n\t\t\t\t\t@input=\"onDescriptionChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<RightsSection :collabId=\"collabId\" @change=\"onRightsChange\" />\n\t\t</div>\n\t\t<ButtonPanel\n\t\t\t:isCreating=\"isUpdating\"\n\t\t\t:createButtonTitle=\"loc('IM_UPDATE_CONFIRM')\"\n\t\t\t:createButtonColorScheme=\"updateButtonColorScheme\"\n\t\t\t@create=\"onUpdateClick\"\n\t\t\t@cancel=\"onCancelClick\"\n\t\t/>\n\t`,\n};\n","import { ChatType } from 'im.v2.const';\n\nimport { GroupChatUpdating } from './components/update/group-chat';\nimport { ChannelUpdating } from './components/update/channel';\nimport { CollabUpdating } from './components/update/collab';\n\nimport './css/chat-forms-content.css';\n\n// @vue/component\nexport const UpdateChatContent = {\n\tname: 'UpdateChatContent',\n\tcomponents: { GroupChatUpdating, ChannelUpdating, CollabUpdating },\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tChatType: () => ChatType,\n\t\tchatType(): $Values<typeof ChatType>\n\t\t{\n\t\t\tconst chat = this.$store.getters['chats/get'](this.entityId, true);\n\n\t\t\treturn chat.type;\n\t\t},\n\t\tisChannel(): boolean\n\t\t{\n\t\t\tconst editableChannelTypes = new Set([ChatType.channel, ChatType.openChannel]);\n\n\t\t\treturn editableChannelTypes.has(this.chatType);\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\tconst editableChatTypes = new Set([ChatType.chat, ChatType.open, ChatType.videoconf]);\n\n\t\t\treturn editableChatTypes.has(this.chatType);\n\t\t},\n\t\tisCollab(): boolean\n\t\t{\n\t\t\treturn this.chatType === ChatType.collab;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-forms__container\">\n\t\t\t<GroupChatUpdating v-if=\"isChat\" :dialogId=\"this.entityId\" />\n\t\t\t<ChannelUpdating v-else-if=\"isChannel\" :dialogId=\"this.entityId\" />\n\t\t\t<CollabUpdating v-else-if=\"isCollab\" :dialogId=\"this.entityId\" />\n\t\t</div>\n\t`,\n};\n"],"names":["GroupChatCreation","name","components","TitleInput","ChatAvatar","ChatMembersSelector","SettingsSection","RightsSection","AppearanceSection","ButtonPanel","CreateChatHeading","data","isCreating","avatarFile","chatTitle","chatMembers","Core","getUserId","settings","isAvailableInSearch","description","rights","ownerId","managerIds","manageUsersAdd","manageUsersDelete","manageUi","manageMessages","watch","newValue","CreateChatManager","getInstance","setChatTitle","created","EventEmitter","subscribe","EventType","layout","onLayoutChange","initDefaultRolesForRights","restoreFields","setChatType","ChatType","chat","setCreationStatus","setChatAvatar","beforeUnmount","exitByCancel","exitByChatTypeSwitch","exitByCreation","saveFields","methods","onMembersChange","currentTags","onOwnerChange","onManagersChange","onChatTypeChange","onDescriptionChange","onManageUsersAddChange","onManageUsersDeleteChange","onManageUiChange","onManageMessagesChange","onCreateClick","newDialogId","getChatService","createChat","title","avatar","memberEntities","managers","catch","BX","UI","Notification","Center","notify","content","loc","Messenger","openChat","onCancelClick","onAvatarChange","newAvatarFile","onScroll","MenuManager","getMenuById","PopupType","createChatManageUsersAddMenu","close","createChatManageUsersDeleteMenu","createChatManageUiMenu","createChatManageMessagesMenu","event","to","getData","Layout","entityId","savedFields","getFields","PermissionManager","getDefaultRolesForActionGroups","chatService","ChatService","phraseCode","$Bitrix","Loc","getMessage","template","ConferenceCreation","ConferenceSection","conference","passwordNeeded","password","computed","EmptyAvatarType","videoconf","onPasswordNeededChange","onPasswordChange","newPassword","checkPassword","showPasswordError","entityType","conferencePassword","PASSWORD_MIN_LENGTH","trim","length","ChannelCreation","PrivacySection","TextareaInput","channel","unsubscribe","type","replacements","LINK_CSS_CLASS","TITLE_LINK_MODIFIER","INVITE_LINK_MODIFIER","DescriptionBanner","preparedTitle","preparedInviteText","onTitleClick","Dom","hasClass","target","ARTICLE_CODE","openHelpdeskArticle","onInviteClick","CreateChatExternalSection","props","collabId","Number","default","emits","formResult","onClick","sliderParams","formData","form","AccessRights","openForm","bindEvents","onSave","onCancel","unbindEvents","$emit","CreateCollabErrorCode","emptyName","duplicateName","NotificationTextByErrorCode","CollabCreation","groupSettings","moderatorMembers","options","permissions","createButtonColorScheme","borderColor","Color","transparent","backgroundColor","collab60","iconColor","white","textColor","hoverColor","collab50","collab","createCollab","emit","header","openAddToChatPopup","error","handleCreationError","onRightsChange","moderators","code","notificationText","CreatableChat","CreationComponentByChatType","CreateChatContent","String","required","chatType","creationComponent","ChatMemberDiffManager","setInitialManagers","initialManagers","setInitialChatMembers","initialMembers","getAddedMemberEntities","modifiedEntities","originalSet","Set","map","elem","JSON","stringify","filter","has","getDeletedMemberEntities","modifiedSet","getAddedManagers","modifiedArray","getDeletedManagers","ENTITY_ID","AVATAR_URL","getCollapsedUsersElement","onclick","textNode","id","text","deselectable","tagOptions","GroupChatUpdating","dialogId","isLoading","isUpdating","areUsersCollapsed","collapsedUsersCount","avatarUrl","dialog","$store","getters","chatId","collapsedUsers","element","onCollapsedUsersClick","canChangeSearchAvailability","open","includes","changedChatType","fillForm","memberDiffManager","getMemberEntities","managerList","userCount","onUpdateClick","Analytics","chatEdit","onSubmitForm","ignoreNextChatOpen","updateChat","addedMemberEntities","deletedMemberEntities","addedManagers","deletedManagers","confirmResult","showExitUpdateChatConfirm","sidebar","panel","SidebarDetailBlock","members","ChannelUpdating","openChannel","UpdateCollabErrorCode","CollabUpdating","isModified","updateButtonColorScheme","initDiffManager","managersWithoutOwner","managerId","payload","addModeratorMembers","deleteModeratorMembers","updateCollab","handleUpdateError","console","UpdateChatContent","isChannel","editableChannelTypes","isChat","editableChatTypes","isCollab"],"mappings":"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"}