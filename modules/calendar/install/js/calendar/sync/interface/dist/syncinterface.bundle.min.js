this.BX=this.BX||{};this.BX.Calendar=this.BX.Calendar||{};this.BX.Calendar.Sync=this.BX.Calendar.Sync||{};(function(t,e,n,a,s,i,r,l,c){"use strict";var o,d,u,p,h;var g=function(){function t(e){babelHelpers.classCallCheck(this,t);this.status=e.status;this.connections=e.connections;this.withStatusLabel=e.withStatusLabel;this.popupWithUpdateButton=e.popupWithUpdateButton;this.popupId=e.popupId}babelHelpers.createClass(t,[{key:"setStatus",value:function t(e){this.status=e;return this}},{key:"setConnections",value:function t(e){this.connections=e;return this}},{key:"getContent",value:function t(){var e=this;var n;if(this.status==="success"){n=r.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div id="status-info-block" class="ui-alert ui-alert-success calendar-sync-status-info">\n\t\t\t\t\t<span class="ui-alert-message">',"</span>\n\t\t\t\t</div>\n\t\t\t"])),r.Loc.getMessage("SYNC_STATUS_SUCCESS"))}else if(this.status==="failed"){n=r.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div id="status-info-block" class="ui-alert ui-alert-danger calendar-sync-status-info">\n\t\t\t\t\t<span class="ui-alert-message">',"</span>\n\t\t\t\t</div>\n\t\t\t"])),r.Loc.getMessage("SYNC_STATUS_ALERT"))}else{n=r.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div id="status-info-block" class="ui-alert ui-alert-primary calendar-sync-status-info">\n\t\t\t\t\t<span class="ui-alert-message">',"</span>\n\t\t\t\t</div>\n\t\t\t"])),r.Loc.getMessage("SYNC_STATUS_NOT_CONNECTED"))}n.addEventListener("mouseenter",(function(){e.handlerMouseEnter(n)}));n.addEventListener("mouseleave",(function(){e.handlerMouseLeave()}));this.statusBlock=r.Tag.render(p||(p=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-status-block" id="calendar-sync-status-block">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getStatusTextLabel(),n);return this.statusBlock}},{key:"getStatusTextLabel",value:function t(){return this.withStatusLabel?r.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-sync-status-subtitle">\n\t\t\t\t\t<span data-hint=""></span>\n\t\t\t\t\t<span class="calendar-sync-status-text">',":</span>\n\t\t\t\t</div>"])),r.Loc.getMessage("LABEL_STATUS_INFO")):""}},{key:"handlerMouseEnter",value:function t(e){var n=this;clearTimeout(this.statusBlockEnterTimeout);this.buttonEnterTimeout=setTimeout((function(){n.statusBlockEnterTimeout=null;n.showPopup(e)}),500)}},{key:"handlerMouseLeave",value:function t(){var e=this;if(this.statusBlockEnterTimeout!==null){clearTimeout(this.statusBlockEnterTimeout);this.statusBlockEnterTimeout=null;return}this.statusBlockLeaveTimeout=setTimeout((function(){e.hidePopup()}),500)}},{key:"showPopup",value:function t(e){if(this.status!=="not_connected"){this.popup=this.getPopup(e);this.popup.show();this.addPopupHandlers()}}},{key:"hidePopup",value:function t(){if(this.popup){this.popup.hide()}}},{key:"addPopupHandlers",value:function t(){var e=this;this.popup.getPopup().getPopupContainer().addEventListener("mouseenter",(function(){clearTimeout(e.statusBlockEnterTimeout);clearTimeout(e.statusBlockLeaveTimeout)}));this.popup.getPopup().getPopupContainer().addEventListener("mouseleave",(function(){e.hidePopup()}))}},{key:"getPopup",value:function t(n){return e.SyncStatusPopup.createInstance({connections:this.connections,withUpdateButton:this.popupWithUpdateButton,node:n,id:this.popupId})}},{key:"refresh",value:function t(e,n){this.status=e;this.connections=n;return this}}],[{key:"createInstance",value:function t(e){return new this(e)}}]);return t}();var v,C,b,f,y,_,T;var L=function(){function t(e){babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"MAIN_SYNC_SLIDER_NAME","calendar:auxiliary-sync-slider");babelHelpers.defineProperty(this,"SLIDER_WIDTH",684);babelHelpers.defineProperty(this,"LOADER_NAME","calendar:loader");babelHelpers.defineProperty(this,"cache",new r.Cache.MemoryCache);this.status=e.status;this.connectionsProviders=e.connectionsProviders;this.userId=e.userId;this.statusBlockEnterTimeout=null;this.statusBlockLeaveTimeout=null}babelHelpers.createClass(t,[{key:"openSlider",value:function t(){var e=this;BX.SidePanel.Instance.open(this.MAIN_SYNC_SLIDER_NAME,{contentCallback:function t(n){return new Promise((function(t,n){t(e.getContent())}))},allowChangeHistory:false,events:{onLoad:function t(){e.setGridContent()}},cacheable:false,width:this.SLIDER_WIDTH,loader:this.LOADER_NAME})}},{key:"getContent",value:function t(){return r.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-wrap">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getHeader(),this.getMobileHeader(),this.getMobileContentWrapper(),this.getWebHeader(),this.getWebContentWrapper())}},{key:"getHeader",value:function t(){return r.Tag.render(C||(C=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-header">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getMainHeader(),this.getStatusBlockContent(this.getConnections()))}},{key:"getMainHeader",value:function t(){return this.cache.remember("calendar-syncPanel-mainHeader",(function(){return r.Tag.render(b||(b=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span class="calendar-sync-header-text">',"</span>\n\t\t\t"])),r.Loc.getMessage("SYNC_CALENDAR_HEADER"))}))}},{key:"getMobileContentWrapper",value:function t(){return this.cache.remember("calendar-syncPanel-mobileContentWrapper",(function(){return r.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div id="calendar-sync-mobile" class="calendar-sync-mobile"></div>\n\t\t'])))}))}},{key:"getWebContentWrapper",value:function t(){return this.cache.remember("calendar-syncPanel-webContentWrapper",(function(){return r.Tag.render(y||(y=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div id="calendar-sync-web" class="calendar-sync-web"></div>\n\t\t\t'])))}))}},{key:"getMobileHeader",value:function t(){return this.cache.remember("calendar-syncPanel-mobileHeader",(function(){return r.Tag.render(_||(_=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-sync-title">',"</div>\n\t\t\t"])),r.Loc.getMessage("SYNC_MOBILE_HEADER"))}))}},{key:"getWebHeader",value:function t(){return this.cache.remember("calendar-syncPanel-webHeader",(function(){return r.Tag.render(T||(T=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-sync-title">',"</div>\n\t\t"])),r.Loc.getMessage("SYNC_WEB_HEADER"))}))}},{key:"getStatusBlockContent",value:function t(e){this.statusBlock=g.createInstance({status:this.status,connections:e,withStatusLabel:true,popupWithUpdateButton:true,popupId:"calendar-syncPanel-status"});this.statusBlockContent=this.statusBlock.getContent();return this.statusBlockContent}},{key:"getConnections",value:function t(){var n=[];var a=Object.values(this.connectionsProviders);a.forEach((function(t){var a=t.getConnections();if(a.length>0){a.forEach((function(t){if(e.ConnectionItem.isConnectionItem(t)&&t.getConnectStatus()===true){n.push(t)}}))}}));return n}},{key:"setGridContent",value:function t(){var e=Object.values(this.connectionsProviders);this.showWebGridContent(e.filter((function(t){return t.mainPanel===false&&t.getViewClassification()==="web"})));this.showMobileGridContent(e.filter((function(t){return t.mainPanel===false&&t.getViewClassification()==="mobile"})))}},{key:"showWebGridContent",value:function t(e){var n=this.getWebContentWrapper();r.Dom.clean(n);var a=new BX.TileGrid.Grid({id:"calendar_sync",items:e,container:n,sizeRatio:"55%",itemMinWidth:180,tileMargin:7,itemType:"BX.Calendar.Sync.Interface.GridUnit",userId:this.userId});a.draw()}},{key:"showMobileGridContent",value:function t(e){var n=this.getMobileContentWrapper();r.Dom.clean(n);var a=new BX.TileGrid.Grid({id:"calendar_sync",items:e,container:n,sizeRatio:"55%",itemMinWidth:180,tileMargin:7,itemType:"BX.Calendar.Sync.Interface.GridUnit"});a.draw()}},{key:"refresh",value:function t(e,n){this.status=e;this.connectionsProviders=n;this.blockStatusContent=this.statusBlock.refresh(e,this.getConnections()).getContent();r.Dom.replace(document.querySelector("#calendar-sync-status-block"),this.blockStatusContent);this.setGridContent()}}]);return t}();var m,A,E,I,k,H,N;var S=function(){function t(e){babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"logoClassName","");this.options=e;this.connectionProvider=this.options.connection}babelHelpers.createClass(t,[{key:"getConnectionTemplate",value:function t(){if(!this.connectionTemplate){this.connectionTemplate=this.connectionProvider.getClassTemplateItem().createInstance(this.connectionProvider)}return this.connectionTemplate}},{key:"renderTo",value:function t(e){if(r.Type.isElementNode(e)){e.appendChild(this.getContent())}}},{key:"getContent",value:function t(){var e=this.connectionProvider.getStatus()==="success"?"--active":"";if(this.connectionProvider.getStatus()==="pending"){e+="--pending"}this.unitNode=r.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__calendar-item ','">\n\t\t\t\t<div class="calendar-sync__calendar-item--logo">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync__calendar-item--container">\n\t\t\t\t\t<div class="calendar-sync__calendar-item--title">',"</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),e,this.getLogoNode(),this.getTitle(),this.getButtonsWrap());r.Event.bind(this.unitNode,"click",this.handleItemClick.bind(this));return this.unitNode}},{key:"getLogoNode",value:function t(){return r.Tag.render(A||(A=babelHelpers.taggedTemplateLiteral(['<div class="calendar-sync__calendar-item--logo-image ','"></div>'])),this.connectionProvider.getSyncPanelLogo())}},{key:"getTitle",value:function t(){return this.connectionProvider.getSyncPanelTitle()}},{key:"getButtonsWrap",value:function t(){this.buttonsWrap=r.Tag.render(E||(E=babelHelpers.taggedTemplateLiteral(['<div class="calendar-sync__calendar-item--buttons">\n\t\t\t','\n\t\t\t\x3c!--<div class="calendar-sync__calendar-item--more"></div>--\x3e\n\t\t</div>'])),this.getButton());return this.buttonsWrap}},{key:"refreshButton",value:function t(){r.Dom.clean(this.buttonsWrap);this.button=this.buttonsWrap.appendChild(this.getButton())}},{key:"getButton",value:function t(){switch(this.connectionProvider.getStatus()){case"success":this.button=r.Tag.render(I||(I=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a data-role="status-success" class="ui-btn ui-btn-icon-success ui-btn-light-border ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>"])),r.Loc.getMessage("CAL_BUTTON_STATUS_SUCCESS"));break;case"failed":this.button=r.Tag.render(k||(k=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a data-role="status-failed" class="ui-btn ui-btn-icon-fail ui-btn-light-border ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>"])),r.Loc.getMessage("CAL_BUTTON_STATUS_FAILED"));break;case"pending":this.button=r.Tag.render(H||(H=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a data-role="status-pending" class="ui-btn ui-btn-disabled ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>"])),r.Loc.getMessage("CAL_BUTTON_STATUS_PENDING"));break;case"not_connected":this.button=r.Tag.render(N||(N=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<a data-role="status-not_connected" class="ui-btn ui-btn-success ui-btn-round">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>"])),r.Loc.getMessage("CAL_BUTTON_STATUS_NOT_CONNECTED"));break}return this.button}},{key:"handleItemClick",value:function t(e){var n=this.connectionProvider.getStatus();if(["failed","success"].includes(n)){if(this.connectionProvider.hasMenu()){this.connectionProvider.showMenu(this.button)}else if(this.connectionProvider.getConnectStatus()){this.connectionProvider.openActiveConnectionSlider(this.connectionProvider.getConnection())}else{this.connectionProvider.openInfoConnectionSlider()}}else if(n==="not_connected"){this.getConnectionTemplate().handleConnectButton()}}}]);return t}();var B,D,O,P,M,R,w;var x=function(){function t(e){babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"MAIN_SYNC_SLIDER_NAME","calendar:sync-slider");babelHelpers.defineProperty(this,"HELPDESK_CODE",11828176);babelHelpers.defineProperty(this,"SLIDER_WIDTH",770);babelHelpers.defineProperty(this,"LOADER_NAME","calendar:loader");babelHelpers.defineProperty(this,"cache",new r.Cache.MemoryCache);this.status=e.status;this.connectionsProviders=e.connectionsProviders;this.userId=e.userId;this.BX=window.top.BX||window.BX}babelHelpers.createClass(t,[{key:"openSlider",value:function t(){var e=this;BX.SidePanel.Instance.open(this.MAIN_SYNC_SLIDER_NAME,{contentCallback:function t(n){return new Promise((function(t,n){t(e.getContent())}))},allowChangeHistory:false,events:{onLoad:function t(){e.displayConnectionUnits()}},cacheable:false,width:this.SLIDER_WIDTH,loader:this.LOADER_NAME})}},{key:"getContent",value:function t(){return r.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__wrapper calendar-sync__scope">\n\t\t\t\t','\n\t\t\t\t<div class="calendar-sync__content">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.getHeaderWrapper(),this.getUnitsContentWrapper(),this.getFooterWrapper())}},{key:"getHeaderWrapper",value:function t(){return r.Tag.render(D||(D=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__header">\n\t\t\t\t<div class="calendar-sync__header-logo"></div>\n\t\t\t\t<div class="calendar-sync__header-container">\n\t\t\t\t\t<div class="calendar-sync__header-title">','</div>\n\t\t\t\t\t<div class="calendar-sync__header-sub-title">',"</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),r.Loc.getMessage("CAL_SYNC_TITLE"),r.Loc.getMessage("CAL_SYNC_SUB_TITLE"))}},{key:"getUnitsContentWrapper",value:function t(){this.unitsContentWrapper=r.Tag.render(O||(O=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__calendar-list">\n\t\t\t</div>\n\t\t'])));return this.unitsContentWrapper}},{key:"getFooterWrapper",value:function t(){return r.Tag.render(P||(P=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__content-block --space-bottom">\n\t\t\t\t','\n\t\t\t</div>\n\t\t\t<div class="calendar-sync__content-block --space-bottom --space-left">\n\t\t\t\t','\n\t\t\t</div>\n\t\t\t<div class="calendar-sync__content-block --space-left">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.getExtraInfoWithCheckIcon(),this.getOpenAuxiliaryPanelLink(),this.getOpenHelpLink())}},{key:"getExtraInfoWithCheckIcon",value:function t(){var e=Object.values(this.connectionsProviders).filter((function(t){return t.mainPanel&&t.status})).length>0;return r.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__content-text --icon-check','">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),e?" --disabled":"",r.Loc.getMessage("CAL_SYNC_INFO_PROMO"))}},{key:"getOpenAuxiliaryPanelLink",value:function t(){var e=this;var n=r.Tag.render(R||(R=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__content-link">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),r.Loc.getMessage("CAL_OPEN_AUXILIARY_PANEL"));r.Event.bind(n,"click",(function(){e.auxiliarySyncPanel=new L({connectionsProviders:e.connectionsProviders,userId:e.userId,status:e.status});e.auxiliarySyncPanel.openSlider()}));return n}},{key:"getOpenHelpLink",value:function t(){var e=this;var n=r.Tag.render(w||(w=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync__content-link">',"</divclass>\n\t\t"])),r.Loc.getMessage("CAL_SHOW_SYNC_HELP"));r.Event.bind(n,"click",(function(){if(e.BX.Helper){e.BX.Helper.show("redirect=detail&code="+e.HELPDESK_CODE)}}));return n}},{key:"getConnections",value:function t(){var n=[];var a=Object.values(this.connectionsProviders);a.forEach((function(t){var a=t.getConnections();if(a.length>0){a.forEach((function(t){if(e.ConnectionItem.isConnectionItem(t)&&t.getConnectStatus()===true){n.push(t)}}))}}));return n}},{key:"displayConnectionUnits",value:function t(){var e=Object.values(this.connectionsProviders).filter((function(t){return t.mainPanel||t.connected}));this.renderConnectionUnits(e)}},{key:"renderConnectionUnits",value:function t(e){var n=this;r.Dom.clean(this.unitsContentWrapper);e.forEach((function(t){var e=new S({connection:t});e.renderTo(n.unitsContentWrapper)}))}},{key:"showWebGridContent",value:function t(e){var n=this.getWebContentWrapper();r.Dom.clean(n);var a=new BX.TileGrid.Grid({id:"calendar_sync",items:e,container:n,sizeRatio:"55%",itemMinWidth:180,tileMargin:7,itemType:"BX.Calendar.Sync.Interface.GridUnit",userId:this.userId});a.draw()}},{key:"refresh",value:function t(e,n){this.status=e;this.connectionsProviders=n;r.Dom.replace(document.querySelector("#calendar-sync-status-block"),this.blockStatusContent);this.displayConnectionUnits();this.auxiliarySyncPanel.refresh(e,n)}}]);return t}();var U,X,W,G;var Y=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{id:t.type}));n.item=t;return n}babelHelpers.createClass(e,[{key:"getContent",value:function t(){this.gridUnit=r.Tag.render(U||(U=babelHelpers.taggedTemplateLiteral(['<div class="calendar-sync-item ','" style="','">\n\t\t\t<div class="calendar-item-content">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t</div>\n\t\t</div>"])),this.getAdditionalContentClass(),this.getContentStyles(),this.getImage(),this.getTitle(),this.isActive()?this.getStatus():"");this.gridUnit.addEventListener("click",this.onClick.bind(this));return this.gridUnit}},{key:"getTitle",value:function t(){if(!this.layout.title){this.layout.title=r.Tag.render(X||(X=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-sync-item-title">',"</div>"])),BX.util.htmlspecialchars(this.item.getGridTitle()))}return this.layout.title}},{key:"getImage",value:function t(){return r.Tag.render(W||(W=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-item-image">\n\t\t\t\t<div class="calendar-sync-item-image-item" style="background-image: ','"></div>\n\t\t\t</div>'])),"url("+this.item.getGridIcon()+")")}},{key:"getStatus",value:function t(){if(this.isActive()){return r.Tag.render(G||(G=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-sync-item-status"></div>\n\t\t\t'])))}return""}},{key:"isActive",value:function t(){return this.item.getConnectStatus()}},{key:"getAdditionalContentClass",value:function t(){if(this.isActive()){if(this.item.getSyncStatus()){return"calendar-sync-item-selected"}else{return"calendar-sync-item-failed"}}else{return""}}},{key:"getContentStyles",value:function t(){if(this.isActive()){return"background-color:"+this.item.getGridColor()+";"}else{return""}}},{key:"onClick",value:function t(){BX.ajax.runAction("calendar.api.calendarajax.analytical",{analyticsLabel:{open_connection_slider:"Y",sync_connection_type:this.item.getType(),sync_connection_status:this.item.getSyncStatus()?"Y":"N"}});if(this.item.hasMenu()){this.item.showMenu(this.gridUnit)}else if(this.item.getConnectStatus()){this.item.openActiveConnectionSlider(this.item.getConnection())}else{this.item.openInfoConnectionSlider()}}}]);return e}(BX.TileGrid.Item);var j,q,F,Q,K,z;var V=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"userName",null);babelHelpers.defineProperty(this,"server",null);babelHelpers.defineProperty(this,"connectionName",null);this.addButtonText=r.Loc.getMessage("CAL_UPPER_CONNECT");this.removeButtonText=r.Loc.getMessage("CAL_UPPER_DISCONNECT");this.saveButtonText=r.Loc.getMessage("CAL_UPPER_SAVE");if(e!==null){this.userName=BX.util.htmlspecialchars(e.userName);this.server=BX.util.htmlspecialchars(e.server);this.connectionName=BX.util.htmlspecialchars(e.connectionName)}}babelHelpers.createClass(t,[{key:"getWrapper",value:function t(){return r.Tag.render(j||(j=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section calendar-sync-slider-section-form"></div>\n\t\t'])))}},{key:"getForm",value:function t(){return r.Tag.render(q||(q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<form class="calendar-sync-slider-form" action="">\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder="','" name="name" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder="','" name="server" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder="','" name="user_name" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="password" class="ui-ctl-element" name="password" placeholder="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t'],['\n\t\t\t<form class="calendar-sync-slider-form" action="">\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder=\\"','\\" name="name" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder=\\"','\\" name="server" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="text" class="ui-ctl-element" placeholder=\\"','\\" name="user_name" value="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-field">\n\t\t\t\t\t<div class="ui-ctl ui-ctl-w100 ui-ctl-textbox">\n\t\t\t\t\t\t<input type="password" class="ui-ctl-element" name="password" placeholder=\\"','\\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t'])),r.Loc.getMessage("CAL_TEXT_NAME"),this.connectionName||"",r.Loc.getMessage("CAL_TEXT_SERVER_ADDRESS"),this.server||"",r.Loc.getMessage("CAL_TEXT_USER_NAME"),this.userName||"",r.Loc.getMessage("CAL_TEXT_PASSWORD"))}},{key:"getAddButton",value:function t(){return r.Tag.render(F||(F=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button id="connect-button" class="ui-btn ui-btn-light-border">',"</button>\n\t\t"])),this.addButtonText)}},{key:"getDisconnectButton",value:function t(){return r.Tag.render(Q||(Q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button id="disconnect-button" class="calendar-sync-slider-btn ui-btn ui-btn-light-border">',"</button>\n\t\t"])),this.removeButtonText)}},{key:"getSaveButton",value:function t(){return r.Tag.render(K||(K=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<button id="edit-connect-button" class="calendar-sync-slider-btn ui-btn ui-btn-light-border">',"</button>\n\t\t"])),this.saveButtonText)}},{key:"getButtonWrapper",value:function t(){return r.Tag.render(z||(z=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-form-btn"></div>\n\t\t'])))}}]);return t}();var J,Z;var $=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);babelHelpers.defineProperty(this,"zIndex",3100);babelHelpers.defineProperty(this,"DOM",{});babelHelpers.defineProperty(this,"QRCODE_SIZE",186);babelHelpers.defineProperty(this,"QRCODE_COLOR_LIGHT","#ffffff");babelHelpers.defineProperty(this,"QRCODE_COLOR_DARK","#000000");babelHelpers.defineProperty(this,"QRCODE_WRAP_CLASS","calendar-sync-slider-qr-container");babelHelpers.defineProperty(this,"QRC",null);this.type=e.type;this.helpDeskCode=e.helpDeskCode||"11828176"}babelHelpers.createClass(t,[{key:"show",value:function t(){}},{key:"showInPopup",value:function t(){this.popup=new c.Popup({className:"calendar-sync-qr-popup",draggable:true,content:this.getContainer(),width:580,zIndexAbsolute:this.zIndex,cacheable:false,closeByEsc:true,closeIcon:true});this.popup.show();this.initQrCode().then(this.drawQRCode.bind(this))}},{key:"close",value:function t(){this.popup.close()}},{key:"getContainer",value:function t(){this.DOM.container=r.Tag.render(J||(J=babelHelpers.taggedTemplateLiteral(["\n\t\t\t",'\n\t\t\t<div class="calendar-sync-qr-popup-content">\n\t\t\t\t<div class="calendar-sync-qr-popup-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-content">\n\t\t\t\t\t<img class="calendar-sync-slider-phone-img" src="/bitrix/images/calendar/sync/qr-background.svg" alt="">\n\t\t\t\t\t<div class="calendar-sync-slider-qr">\n\t\t\t\t\t\t<div class="','">','</div>\n\t\t\t\t\t\t<span class="calendar-sync-slider-logo"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="calendar-sync-slider-instruction">\n\t\t\t\t\t\t\x3c!--<div class="calendar-sync-slider-instruction-subtitle"></div>--\x3e\n\t\t\t\t\t\t<div class="calendar-sync-slider-instruction-title">'," ",'</div>\n\t\t\t\t\t\t<div class="calendar-sync-slider-instruction-notice">','</div>\n\t\t\t\t\t\t<a href="javascript:void(0);" \n\t\t\t\t\t\t\t\tonclick="BX.Helper.show(\'redirect=detail&code=\' + ',',{zIndex:3100,}); event.preventDefault();" \n\t\t\t\t\t\t\t\tclass="ui-btn ui-btn-success ui-btn-round">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.getSliderContentInfoBlock,this.getTitle(),this.QRCODE_WRAP_CLASS,l.Util.getLoader(this.QRCODE_SIZE),r.Loc.getMessage("SYNC_MOBILE_NOTICE_HOW_TO"),this.type!=="iphone"?r.Tag.render(Z||(Z=babelHelpers.taggedTemplateLiteral(['<span class="calendar-notice-mobile-banner" data-hint="','" data-hint-no-icon="Y"></span>'])),r.Loc.getMessage("CAL_ANDROID_QR_CODE_HINT")):"",r.Loc.getMessage("SYNC_MOBILE_NOTICE"),this.getHelpdeskCode(),r.Loc.getMessage("SYNC_MOBILE_ABOUT_BTN"));l.Util.initHintNode(this.DOM.container.querySelector(".calendar-notice-mobile-banner"));return this.DOM.container}},{key:"getInnerContainer",value:function t(){return this.DOM.container.querySelector("."+this.QRCODE_WRAP_CLASS)}},{key:"initQrCode",value:function t(){return new Promise((function(t){r.Runtime.loadExtension(["main.qrcode"]).then((function(e){if(e&&e.QRCode){t()}}))}))}},{key:"drawQRCode",value:function t(e){var n=this;if(!r.Type.isDomNode(e)){e=this.getInnerContainer()}this.getMobileSyncUrl().then((function(t){r.Dom.clean(e);n.QRC=new QRCode(e,{text:t,width:n.getSize(),height:n.getSize(),colorDark:n.QRCODE_COLOR_DARK,colorLight:n.QRCODE_COLOR_LIGHT,correctLevel:QRCode.CorrectLevel.H})}))}},{key:"getTitle",value:function t(){return r.Loc.getMessage("SYNC_BANNER_MOBILE_TITLE")}},{key:"getMobileSyncUrl",value:function t(){var e=this;return new Promise((function(t,n){BX.ajax.runAction("calendar.api.calendarajax.getAuthLink",{data:{type:e.type?"slider":"banner"}}).then((function(e){t(e.data.link)}),n)}))}},{key:"getSize",value:function t(){return this.QRCODE_SIZE}},{key:"getDetailHelpUrl",value:function t(){return"https://helpdesk.bitrix24.ru/open/"+this.getHelpdeskCode()}},{key:"getHelpdeskCode",value:function t(){return this.helpDeskCode}}]);return t}();var tt,et,nt,at,st,it,rt,lt;var ct=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this));babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"sliderWidth",840);n.setEventNamespace("BX.Calendar.Sync.Interface.InterfaceTemplate");n.title=t.title;n.helpdeskCode=t.helpDeskCode;n.titleInfoHeader=t.titleInfoHeader;n.descriptionInfoHeader=t.descriptionInfoHeader;n.titleActiveHeader=t.titleActiveHeader;n.descriptionActiveHeader=t.descriptionActiveHeader;n.sliderIconClass=t.sliderIconClass;n.iconPath=t.iconPath;n.color=t.color;n.provider=t.provider;n.connection=t.connection;n.popupWithUpdateButton=t.popupWithUpdateButton;return n}babelHelpers.createClass(e,[{key:"getInfoConnectionContent",value:function t(){return r.Tag.render(tt||(tt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-wrap calendar-sync-wrap-detail">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getContentInfoHeader(),this.getContentInfoBody())}},{key:"getActiveConnectionContent",value:function t(){return r.Tag.render(et||(et=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-wrap calendar-sync-wrap-detail">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getContentActiveHeader(),this.getContentActiveBody())}},{key:"getContentInfoHeader",value:function t(){this.statusBlock=g.createInstance({status:"not_connected",connections:[this.connection],withStatusLabel:false,popupWithUpdateButton:this.popupWithUpdateButton,popupId:"calendar-interfaceTemplate-status"});return r.Tag.render(nt||(nt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-header">\n\t\t\t\t<span class="calendar-sync-header-text">',"</span>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getHeaderTitle(),this.statusBlock.getContent())}},{key:"getContentInfoBody",value:function t(){return r.Tag.render(at||(at=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t"])),this.getContentInfoBodyHeader())}},{key:"getContentActiveHeader",value:function t(){this.statusBlock=g.createInstance({status:this.connection.getStatus(),connections:[this.connection],withStatusLabel:false,popupWithUpdateButton:this.popupWithUpdateButton,popupId:"calendar-interfaceTemplate-status"});return r.Tag.render(st||(st=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-header">\n\t\t\t\t<span class="calendar-sync-header-text">',"</span>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.getHeaderTitle(),this.statusBlock.getContent())}},{key:"getContentActiveBody",value:function t(){return r.Tag.render(it||(it=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t"])),this.getContentActiveBodyHeader())}},{key:"showHelp",value:function t(){if(BX.Helper){BX.Helper.show("redirect=detail&code="+this.helpdeskCode);event.preventDefault()}}},{key:"getHelpdeskLink",value:function t(){return"https://helpdesk.bitrix24.ru/open/"+this.helpdeskCode}},{key:"getHeaderTitle",value:function t(){return this.title}},{key:"getContentInfoBodyHeader",value:function t(){return r.Tag.render(rt||(rt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section">\n\t\t\t\t<div class="calendar-sync-slider-header-icon ','"></div>\n\t\t\t\t<div class="calendar-sync-slider-header">\n\t\t\t\t<div class="calendar-sync-slider-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">\n\t\t\t\t\t\t<a class="calendar-sync-slider-info-link" href="javascript:void(0);" onclick="','">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.sliderIconClass,this.titleInfoHeader,this.descriptionInfoHeader,this.showHelp.bind(this),r.Loc.getMessage("CAL_TEXT_ABOUT_WORK_SYNC"))}},{key:"getContentActiveBodyHeader",value:function t(){return r.Tag.render(lt||(lt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section">\n\t\t\t\t<div class="calendar-sync-slider-header-icon ','"></div>\n\t\t\t\t<div class="calendar-sync-slider-header">\n\t\t\t\t<div class="calendar-sync-slider-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">\n\t\t\t\t\t\t<a class="calendar-sync-slider-info-link" href="javascript:void(0);" onclick="','">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.sliderIconClass,this.titleActiveHeader,this.descriptionActiveHeader,this.showHelp.bind(this),r.Loc.getMessage("CAL_TEXT_ABOUT_WORK_SYNC"))}},{key:"setProvider",value:function t(e){this.provider=e}},{key:"sendRequestRemoveConnection",value:function t(e){BX.ajax.runAction("calendar.api.calendarajax.removeConnection",{data:{connectionId:e}}).then((function(){BX.reload()}))}},{key:"runUpdateInfo",value:function t(){var e=this;r.ajax.runAction("calendar.api.calendarajax.setSectionStatus",{data:{sectionStatus:this.sectionStatusObject}}).then((function(t){e.emit("reDrawCalendarGrid",{})}))}},{key:"refresh",value:function t(e){this.connection=e;this.statusBlock.setStatus(this.connection.getStatus()).setConnections([this.connection]);r.Dom.replace(document.getElementById("status-info-block"),this.statusBlock.getContent())}},{key:"handleConnectButton",value:function t(){}}],[{key:"createInstance",value:function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return new this(e,n)}}]);return e}(s.EventEmitter);babelHelpers.defineProperty(ct,"SLIDER_WIDTH",606);babelHelpers.defineProperty(ct,"SLIDER_PREFIX","calendar:connection-sync-");var ot,dt;var ut=function(t){babelHelpers.inherits(e,t);function e(t){babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t))}babelHelpers.createClass(e,[{key:"getContentInfoBody",value:function t(){var e=this;var n=new V;var a=n.getWrapper();var s=n.getForm();var i=n.getAddButton();var l=n.getButtonWrapper();var c=this.getContentInfoBodyHeader();i.addEventListener("click",(function(t){BX.ajax.runAction("calendar.api.calendarajax.analytical",{analyticsLabel:{click_to_connection_button:"Y",connection_type:e.provider.getType()}});r.Dom.addClass(i,["ui-btn-clock","ui-btn-disabled"]);t.preventDefault();e.sendRequestAddConnection(s)}));r.Dom.append(i,l);r.Dom.append(l,s);r.Dom.append(s,a);return r.Tag.render(ot||(ot=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t\t","\n\t\t"])),c,a)}},{key:"getContentActiveBody",value:function t(){var e=this;var n=new V({server:this.connection.addParams.server,userName:this.connection.addParams.userName,connectionName:this.connection.connectionName});var a=n.getWrapper();var s=n.getForm();var i=n.getDisconnectButton();var l=n.getButtonWrapper();var c=this.getContentActiveBodyHeader();i.addEventListener("click",(function(t){r.Dom.addClass(i,["ui-btn-clock","ui-btn-disabled"]);t.preventDefault();e.sendRequestRemoveConnection(e.connection.getId())}));r.Dom.append(i,l);r.Dom.append(l,s);r.Dom.append(s,a);return r.Tag.render(dt||(dt=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t\t","\n\t\t"])),c,a)}},{key:"sendRequestEditConnection",value:function t(e,n){BX.ajax.runAction("calendar.api.calendarajax.editConnection",{data:{form:new FormData(e),connectionId:n.connectionId}}).then((function(){BX.reload()}))}},{key:"sendRequestAddConnection",value:function t(e){var n=this;var a=new FormData(e);BX.ajax.runAction("calendar.api.calendarajax.addConnection",{data:{name:a.get("name"),server:a.get("server"),userName:a.get("user_name"),pass:a.get("password")}}).then((function(t){BX.reload()}),(function(t){var a=e.querySelector("#connect-button");n.showAlertPopup(t.errors[0],a)}))}},{key:"showAlertPopup",value:function t(e,n){var a="";if(e.code==="incorrect_parameters"){a=r.Loc.getMessage("CAL_TEXT_ALERT_INCORRECT_PARAMETERS")}else if(e.code==="tech_problem"){a=r.Loc.getMessage("CAL_TEXT_ALERT_TECH_PROBLEM")}else{a=r.Loc.getMessage("CAL_TEXT_ALERT_DEFAULT")}var s=new BX.UI.Dialogs.MessageBox({message:a,title:e.message,buttons:BX.UI.Dialogs.MessageBoxButtons.OK,okCaption:r.Loc.getMessage("CAL_TEXT_BUTTON_RETURN_TO_SETTINGS"),minWidth:358,mediumButtonSize:false,popupOptions:{zIndex:3021,height:166,width:358,className:"calendar-alert-popup-connection"},onOk:function t(){r.Dom.removeClass(n,["ui-btn-clock","ui-btn-disabled"]);return true}});s.show()}}]);return e}(ct);var pt=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_CALDAV"),helpDeskCode:"5697365",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_CALDAV_CALENDAR"),descriptionInfoHeader:r.Loc.getMessage("CAL_CALDAV_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_CALDAV_CALENDAR_IS_CONNECT"),descriptionActiveHeader:r.Loc.getMessage("CAL_CALDAV_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-caldav",iconPath:"/bitrix/images/calendar/sync/caldav.svg",color:"#1eae43",provider:t,connection:n,popupWithUpdateButton:true}))}return e}(ut);var ht=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_EXCHANGE"),helpDeskCode:"11864622",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_EXCHANGE_CALENDAR_TITLE"),descriptionInfoHeader:r.Loc.getMessage("CAL_EXCHANGE_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_SYNC_CONNECTED_EXCHANGE_TITLE"),descriptionActiveHeader:r.Loc.getMessage("CAL_EXCHANGE_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-office",iconPath:"/bitrix/images/calendar/sync/exchange.svg",color:"#54d0df",provider:t,connection:n,popupWithUpdateButton:true}))}return e}(ct);var gt,vt,Ct,bt,ft;var yt=function(t){babelHelpers.inherits(e,t);function e(t){var n;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_GOOGLE"),helpDeskCode:"6030429",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_GOOGLE_CALENDAR"),descriptionInfoHeader:r.Loc.getMessage("CAL_GOOGLE_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_GOOGLE_CALENDAR_IS_CONNECT"),descriptionActiveHeader:r.Loc.getMessage("CAL_GOOGLE_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-google",iconPath:"/bitrix/images/calendar/sync/google.svg",color:"#387ced",provider:t,connection:a,popupWithUpdateButton:true}));n.sectionStatusObject={};n.sectionList=[];return n}babelHelpers.createClass(e,[{key:"createConnection",value:function t(){BX.ajax.runAction("calendar.api.calendarajax.analytical",{analyticsLabel:{click_to_connection_button:"Y",connection_type:"google"}});BX.util.popup(this.provider.getSyncLink(),500,600)}},{key:"getContentInfoBody",value:function t(){var e=new V;var n=e.getAddButton();var a=e.getButtonWrapper();var s=this.getContentInfoBodyHeader();var i=s.querySelector(".calendar-sync-slider-header");r.Event.bind(n,"click",this.handleConnectButton.bind(this));r.Dom.append(n,a);r.Dom.append(a,i);return r.Tag.render(gt||(gt=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t"])),s)}},{key:"getContentActiveBody",value:function t(){return r.Tag.render(vt||(vt=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t\t","\n\t\t"])),this.getContentActiveBodyHeader(),this.getContentActiveBodySectionsManager())}},{key:"getContentActiveBodyHeader",value:function t(){var e=this;var n=new V;var a=n.getDisconnectButton();a.addEventListener("click",(function(t){t.preventDefault();e.sendRequestRemoveConnection(e.connection.getId())}));return r.Tag.render(Ct||(Ct=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section">\n\t\t\t\t<div class="calendar-sync-slider-header-icon calendar-sync-slider-header-icon-google"></div>\n\t\t\t\t<div class="calendar-sync-slider-header">\n\t\t\t\t\t<div class="calendar-sync-slider-title">','</div>\n\t\t\t\t\t<span class="calendar-sync-slider-account">\n\t\t\t\t\t\t<span class="calendar-sync-slider-account-avatar"></span>\n\t\t\t\t\t\t<span class="calendar-sync-slider-account-email">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">\n\t\t\t\t\t\t\t<a class="calendar-sync-slider-info-link" href="javascript:void(0);" onclick="','">\n\t\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t"])),r.Loc.getMessage("CAL_GOOGLE_CALENDAR_IS_CONNECT"),BX.util.htmlspecialchars(this.connection.getConnectionName()),this.showHelp.bind(this),r.Loc.getMessage("CAL_TEXT_ABOUT_WORK_SYNC"),a)}},{key:"getContentActiveBodySectionsManager",value:function t(){return r.Tag.render(bt||(bt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section calendar-sync-slider-section-col">\n\t\t\t\t<div class="calendar-sync-slider-header">\n\t\t\t\t\t<div class="calendar-sync-slider-subtitle">','</div>\n\t\t\t\t</div>\n\t\t\t\t<ul class="calendar-sync-slider-list">\n\t\t\t\t\t',"\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t"])),r.Loc.getMessage("CAL_AVAILABLE_CALENDAR"),this.getContentActiveBodySections(this.connection.getId()))}},{key:"getContentActiveBodySections",value:function t(e){var n=this;var a=[];this.sectionList.forEach((function(t){a.push(r.Tag.render(ft||(ft=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<li class="calendar-sync-slider-item">\n\t\t\t\t\t<label class="ui-ctl ui-ctl-checkbox ui-ctl-xs">\n\t\t\t\t\t\t<input type="checkbox" class="ui-ctl-element" value="','" onclick="','" ','>\n\t\t\t\t\t\t<div class="ui-ctl-label-text">',"</div>\n\t\t\t\t\t</label>\n\t\t\t\t</li>\n\t\t\t"])),BX.util.htmlspecialchars(t["ID"]),n.onClickCheckSection.bind(n),t["ACTIVE"]==="Y"?"checked":"",BX.util.htmlspecialchars(t["NAME"])))}));return a}},{key:"getSectionsForGoogle",value:function t(){var e=this;return new Promise((function(t){BX.ajax.runAction("calendar.api.calendarajax.getAllSectionsForGoogle").then((function(n){e.sectionList=n.data;t(n.data)}),(function(e){t(e.errors)}))}))}},{key:"onClickCheckSection",value:function t(e){this.sectionStatusObject[e.target.value]=e.target.checked;this.runUpdateInfo()}},{key:"showAlertPopup",value:function t(){var e=new i.MessageBox({className:this.id,message:r.Loc.getMessage("GOOGLE_IS_NOT_CALDAV_SETTINGS_WARNING_MESSAGE"),width:500,offsetLeft:60,offsetTop:5,padding:7,onOk:function t(){e.close()},okCaption:"OK",buttons:BX.UI.Dialogs.MessageBoxButtons.OK,popupOptions:{zIndexAbsolute:4020,autoHide:true}});e.show()}},{key:"handleConnectButton",value:function t(){if(this.provider.hasSetSyncCaldavSettings()){this.createConnection()}else{this.showAlertPopup()}}}]);return e}(ct);var _t,Tt,Lt;var mt=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_MAC"),helpDeskCode:"5684075",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_MAC_CALENDAR_TITLE"),descriptionInfoHeader:r.Loc.getMessage("CAL_MAC_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_MAC_CALENDAR_IS_CONNECT_TITLE"),descriptionActiveHeader:r.Loc.getMessage("CAL_MAC_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-mac",iconPath:"/bitrix/images/calendar/sync/mac.svg",color:"#ff5752",provider:t,connection:n,popupWithUpdateButton:false}))}babelHelpers.createClass(e,[{key:"getPortalAddress",value:function t(){return this.portalAddress}},{key:"getContentInfoBody",value:function t(){return r.Tag.render(_t||(_t=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t\t","\n\t\t"])),this.getContentInfoBodyHeader(),this.getContentBodyConnect())}},{key:"getContentActiveBody",value:function t(){return r.Tag.render(Tt||(Tt=babelHelpers.taggedTemplateLiteral(["\n\t\t\t","\n\t\t\t","\n\t\t"])),this.getContentActiveBodyHeader(),this.getContentBodyConnect())}},{key:"getContentBodyConnect",value:function t(){return r.Tag.render(Lt||(Lt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section calendar-sync-slider-section-col">\n\t\t\t\t<div class="calendar-sync-slider-header calendar-sync-slider-header-divide">\n\t\t\t\t\t<div class="calendar-sync-slider-subtitle">','</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">',':</span>\n\t\t\t\t\t<ol class="calendar-sync-slider-info-list">\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-sync-slider-info-item">\n\t\t\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ol>\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">',"</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),r.Loc.getMessage("CAL_MAC_INSTRUCTION_HEADER"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_DESCRIPTION"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_FIRST"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_SECOND"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_THIRD"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_FOURTH"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_FIFTH").replace(/#PORTAL_ADDRESS#/gi,this.provider.getPortalAddress()),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_SIXTH"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_POINT_SEVENTH"),r.Loc.getMessage("CAL_MAC_INSTRUCTION_CONCLUSION"))}}]);return e}(ct);var At=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_MAC"),helpDeskCode:"5684075",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_MAC_CALENDAR_TITLE"),descriptionInfoHeader:r.Loc.getMessage("CAL_MAC_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_MAC_CALENDAR_IS_CONNECT_TITLE"),descriptionActiveHeader:r.Loc.getMessage("CAL_MAC_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-mac",iconPath:"/bitrix/images/calendar/sync/mac.svg",color:"#ff5752",provider:t,connection:n,popupWithUpdateButton:false}))}return e}(ct);var Et=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_YANDEX"),helpDeskCode:"10930170",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_YANDEX_CALENDAR"),descriptionInfoHeader:r.Loc.getMessage("CAL_YANDEX_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_YANDEX_CALENDAR_IS_CONNECT"),descriptionActiveHeader:r.Loc.getMessage("CAL_YANDEX_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-yandex",iconPath:"/bitrix/images/calendar/sync/yandex.svg",color:"#f9c500",provider:t,connection:n,popupWithUpdateButton:true}))}return e}(ut);var It,kt,Ht;var Nt=function(t){babelHelpers.inherits(e,t);function e(t){var n;babelHelpers.classCallCheck(this,e);n=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,t));n.banner=new $({type:n.provider.getType(),helpDeskCode:t.helpDeskCode});if(n.status){n.syncDate=r.Type.isDate(n.data.syncDate)?n.data.syncDate:l.Util.parseDate(n.data.syncDate)}return n}babelHelpers.createClass(e,[{key:"getContentInfoBody",value:function t(){return r.Tag.render(It||(It=babelHelpers.taggedTemplateLiteral(["\n\t\t\t",'\n\t\t\t<div class="calendar-sync-slider-section calendar-sync-slider-section-banner">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.getContentInfoBodyHeader(),this.getContentBodyConnect())}},{key:"getContentActiveBody",value:function t(){return r.Tag.render(kt||(kt=babelHelpers.taggedTemplateLiteral(["\n\t\t\t",'\n\t\t\t<div class="calendar-sync-slider-section calendar-sync-slider-section-banner">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),this.getContentActiveBodyHeader(),this.getContentBodyConnect())}},{key:"getContentActiveBodyHeader",value:function t(){return r.Tag.render(Ht||(Ht=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-sync-slider-section">\n\t\t\t\t<div class="calendar-sync-slider-header-icon ','"></div>\n\t\t\t\t<div class="calendar-sync-slider-header">\n\t\t\t\t<div class="calendar-sync-slider-title">','</div>\n\t\t\t\t<div class="calendar-sync-slider-info">\n\t\t\t\t\t<span class="calendar-sync-slider-info-text">','</span>\n\t\t\t\t\t<span class="calendar-sync-slider-info-time">','</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-sync-slider-desc">','</div>\n\t\t\t\t\t<a class="calendar-sync-slider-link" href="javascript:void(0);" onclick="','">',"</a>\n\t\t\t\t</div>\n\t\t\t</div>"])),this.sliderIconClass,this.titleActiveHeader,r.Loc.getMessage("CAL_SYNC_LAST_SYNC_DATE"),l.Util.formatDateUsable(this.connection.getSyncTimestamp())+" "+BX.date.format(l.Util.getTimeFormatShort(),this.connection.getSyncTimestamp()),r.Loc.getMessage("CAL_SYNC_DISABLE"),this.showHelp.bind(this),r.Loc.getMessage("CAL_TEXT_ABOUT_WORK_SYNC"))}},{key:"getContentBodyConnect",value:function t(){this.banner.initQrCode().then(this.banner.drawQRCode.bind(this.banner));return this.banner.getContainer()}}]);return e}(ct);var St=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_ANDROID"),helpDeskCode:"5686179",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_ANDROID_CALENDAR_TITLE"),descriptionInfoHeader:r.Loc.getMessage("CAL_ANDROID_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_SYNC_CONNECTED_ANDROID_TITLE"),descriptionActiveHeader:r.Loc.getMessage("CAL_ANDROID_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-android",iconPath:"/bitrix/images/calendar/sync/android.svg",color:"#9ece03",provider:t,connection:n,popupWithUpdateButton:false}))}return e}(Nt);var Bt=function(t){babelHelpers.inherits(e,t);function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;babelHelpers.classCallCheck(this,e);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(e).call(this,{title:r.Loc.getMessage("CALENDAR_TITLE_IPHONE"),helpDeskCode:"5686207",titleInfoHeader:r.Loc.getMessage("CAL_CONNECT_IPHONE_CALENDAR_TITLE"),descriptionInfoHeader:r.Loc.getMessage("CAL_IPHONE_CONNECT_DESCRIPTION"),titleActiveHeader:r.Loc.getMessage("CAL_SYNC_CONNECTED_IPHONE_TITLE"),descriptionActiveHeader:r.Loc.getMessage("CAL_IPHONE_SELECTED_DESCRIPTION"),sliderIconClass:"calendar-sync-slider-header-icon-iphone",iconPath:"/bitrix/images/calendar/sync/iphone.svg",color:"#2fc6f6",provider:t,connection:n,popupWithUpdateButton:false}))}return e}(Nt);var Dt,Ot;function Pt(t,e){Mt(t,e);e.add(t)}function Mt(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Rt(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var wt=new WeakSet;var xt=new WeakSet;var Ut=new WeakSet;var Xt=function(){function t(e){babelHelpers.classCallCheck(this,t);Pt(this,Ut);Pt(this,xt);Pt(this,wt);babelHelpers.defineProperty(this,"LINK_LENGTH",112);this.link=this.getIcalLink(e)}babelHelpers.createClass(t,[{key:"show",value:function t(){this.createPopup().show();this.startSync()}},{key:"startSync",value:function t(){var e=this;BX.ajax.get(this.link+"&check=Y","",(function(t){setTimeout((function(){if(!t||t.length<=0||t.toUpperCase().indexOf("BEGIN:VCALENDAR")===-1){e.showPopupWithSyncDataError()}}),300)}))}},{key:"getContent",value:function t(){return r.Tag.render(Dt||(Dt=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="calendar-ical-popup-wrapper">\n\t\t\t\t<h3>','</h3>\n\t\t\t\t<div class="calendar-ical-popup-label-text"><span>',"</span></div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),r.Loc.getMessage("EC_JS_EXPORT_TILE"),r.Loc.getMessage("EC_EXP_TEXT"),this.getLinkBlock())}},{key:"createPopup",value:function t(){var e=this;return this.popup=new c.Popup({width:400,zIndexOptions:4e3,autoHide:false,closeByEsc:true,draggable:true,closeIcon:{right:"12px",top:"10px"},className:"bxc-popup-window",content:this.getContent(),buttons:[new BX.UI.Button({text:r.Loc.getMessage("EC_JS_ICAL_COPY_ICAL_SYNC_LINK"),color:BX.UI.Button.Color.PRIMARY,onclick:function t(){e.copyLink(event)}}),new BX.UI.Button({text:r.Loc.getMessage("EC_SEC_SLIDER_CLOSE"),color:BX.UI.Button.Color.LINK,onclick:function t(){e.popup.close()}})]})}},{key:"getIcalLink",value:function t(e){return e.calendarPath+(e.calendarPath.indexOf("?")>=0?"&":"?")+"action=export"+e.sectionLink}},{key:"getLinkBlock",value:function t(){return r.Tag.render(Ot||(Ot=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="calendar-ical-popup-link-block">\n\t\t\t\t\t<a class="ui-link ui-link-primary " target="_blank" href="','">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t"])),BX.util.htmlspecialchars(this.link),BX.util.htmlspecialchars(this.getShortenLink(this.link)))}},{key:"showPopupWithSyncDataError",value:function t(){BX.UI.Dialogs.MessageBox.alert(r.Loc.getMessage("EC_EDEV_EXP_WARN"))}},{key:"copyLink",value:function t(e){window.BX.clipboard.copy(this.link)?Rt(this,wt,Wt).call(this):Rt(this,xt,Gt).call(this);e.preventDefault();e.stopPropagation()}},{key:"getShortenLink",value:function t(e){return e.length<this.LINK_LENGTH?e:e.substr(0,105)+"..."+e.slice(-7)}}],[{key:"createInstance",value:function t(e){return new this(e)}},{key:"checkPathes",value:function t(e){return!!e.sectionLink||!!e.calendarPath}},{key:"showPopupWithPathesError",value:function t(){BX.UI.Dialogs.MessageBox.alert(r.Loc.getMessage("EC_JS_ICAL_ERROR_WITH_PATHES"))}}]);return t}();function Wt(){Rt(this,Ut,Yt).call(this,r.Loc.getMessage("EC_JS_ICAL_COPY_ICAL_SYNC_LINK_SUCCESS"))}function Gt(){Rt(this,Ut,Yt).call(this,r.Loc.getMessage("EC_JS_ICAL_COPY_ICAL_SYNC_LINK_FAILED"))}function Yt(t){l.Util.showNotification(t)}var jt=function(){function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,t);this.options=e}babelHelpers.createClass(t,[{key:"loadExtension",value:function t(){return new Promise((function(t){r.Runtime.loadExtension("ui.tour").then((function(e){if(e&&e["Guide"]&&e["Manager"]){t()}else{console.error('Extension "ui.tour" not found')}}))}))}},{key:"show",value:function t(){var e=this;this.loadExtension().then((function(){e.guide=new BX.UI.Tour.Guide({steps:[{target:e.getTarget(),title:r.Loc.getMessage("CAL_AFTER_SYNC_AHA_TITLE"),text:r.Loc.getMessage("CAL_AFTER_SYNC_AHA_TEXT")}],onEvents:true});e.guide.start()}))}},{key:"getTarget",value:function t(){var e;var n=this.options.view;var a=n.getContainer();if(n.getName()==="month"){e=a.querySelectorAll(".calendar-grid-today")[0]}else if(n.getName()==="day"||n.getName()==="week"){var s=l.Util.getDayCode(new Date);e=a.querySelector('div[data-bx-calendar-timeline-day="'+s+'"] .calendar-grid-cell-inner')}else{e=document.querySelector('span[data-role="addButton"]')}return e}}],[{key:"createInstance",value:function t(e){return new this(e)}}]);return t}();t.SyncPanel=x;t.SyncPanelUnit=S;t.AuxiliarySyncPanel=L;t.GridUnit=Y;t.ConnectionControls=V;t.MobileSyncBanner=$;t.YandexTemplate=Et;t.CaldavTemplate=pt;t.MacTemplate=mt;t.ExchangeTemplate=ht;t.GoogleTemplate=yt;t.OutlookTemplate=At;t.IphoneTemplate=Bt;t.AndroidTemplate=St;t.IcalSyncPopup=Xt;t.AfterSyncTour=jt})(this.BX.Calendar.Sync.Interface=this.BX.Calendar.Sync.Interface||{},BX.Calendar.Sync.Manager,BX,BX,BX.Event,BX.UI.Dialogs,BX,BX.Calendar,BX.Main);
//# sourceMappingURL=syncinterface.bundle.map.js