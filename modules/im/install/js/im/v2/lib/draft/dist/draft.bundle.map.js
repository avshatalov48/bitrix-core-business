{"version":3,"file":"draft.bundle.map.js","names":["this","BX","Messenger","v2","exports","main_core","main_core_events","im_v2_lib_logger","im_v2_application_core","ui_dexie","im_v2_lib_localStorage","im_v2_const","DB_NAME","recentDraftLocalStorageKey","copilotDraftLocalStorageKey","IndexedDbManager","getInstance","instance","constructor","db","Dexie","version","stores","drafts","migrateFromLocalStorage","migrationStatus","get","recentDrafts","LocalStorageManager","set","remove","copilotDrafts","setMigrationFinished","key","value","put","result","defaultValue","WRITE_TO_STORAGE_TIMEOUT","SHOW_DRAFT_IN_RECENT_TIMEOUT","STORAGE_KEY","NOT_AVAILABLE_CHAT_TYPES","Set","ChatType","comment","DraftManager","inited","initPromise","Promise","resolve","initPromiseResolver","EventEmitter","subscribe","EventType","layout","onLayoutChange","bind","initDraftHistory","draftHistory","getStorageKey","error","console","fillDraftsFromStorage","Logger","warn","setRecentListDraftText","ready","Type","isPlainObject","Object","entries","forEach","dialogId","draft","setDraftText","text","trim","refreshSaveTimeout","setDraftPanel","panelType","panelContext","setDraftMentions","mentions","getDraft","_this$drafts$dialogId","clearDraft","setRecentItemDraftText","_draft$text","canSetRecentItemDraftText","Core","getStore","dispatch","getDraftMethodName","id","event","from","getData","name","getLayoutName","entityId","setTimeout","async","clearTimeout","writeToStorageTimeout","saveToIndexedDb","prepareDrafts","TextareaPanelType","edit","Layout","chat","getters","has","type","STORAGE_KEY$1","CopilotDraftManager","copilot","Lib","Event","Application","Dexie3","Const"],"sources":["draft.bundle.js"],"mappings":"AACAA,KAAKC,GAAKD,KAAKC,IAAM,CAAC,EACtBD,KAAKC,GAAGC,UAAYF,KAAKC,GAAGC,WAAa,CAAC,EAC1CF,KAAKC,GAAGC,UAAUC,GAAKH,KAAKC,GAAGC,UAAUC,IAAM,CAAC,GAC/C,SAAUC,EAAQC,EAAUC,EAAiBC,EAAiBC,EAAuBC,EAASC,EAAuBC,GACrH,aAEA,MAAMC,EAAU,eAChB,MAAMC,EAA6B,cACnC,MAAMC,EAA8B,eACpC,MAAMC,EACJ,kBAAOC,GACL,IAAKhB,KAAKiB,SAAU,CAClBjB,KAAKiB,SAAW,IAAIjB,IACtB,CACA,OAAOA,KAAKiB,QACd,CACA,WAAAC,GACElB,KAAKmB,GAAK,IAAIV,EAASW,MAAMR,GAC7BZ,KAAKmB,GAAGE,QAAQ,GAAGC,OAAO,CACxBC,OAAQ,IAEZ,CACA,6BAAMC,GACJ,MAAMC,QAAwBzB,KAAKmB,GAAGI,OAAOG,IAAI,oBACjD,GAAID,EAAiB,CACnB,MACF,CACA,MAAME,EAAejB,EAAuBkB,oBAAoBZ,cAAcU,IAAIb,EAA4B,CAAC,GAC/Gb,KAAK6B,IAAIhB,EAA4Bc,GACrCjB,EAAuBkB,oBAAoBZ,cAAcc,OAAOjB,GAChE,MAAMkB,EAAgBrB,EAAuBkB,oBAAoBZ,cAAcU,IAAIZ,EAA6B,CAAC,GACjHd,KAAK6B,IAAIf,EAA6BiB,GACtCrB,EAAuBkB,oBAAoBZ,cAAcc,OAAOhB,GAChEd,KAAKgC,sBACP,CACA,GAAAH,CAAII,EAAKC,GACPlC,KAAKmB,GAAGI,OAAOY,IAAID,EAAOD,EAC5B,CACA,oBAAAD,GACE,MAAMI,EAAS,CACbvB,CAACA,GAA6B,KAC9BC,CAACA,GAA8B,MAEjCd,KAAKmB,GAAGI,OAAOY,IAAIC,EAAQ,mBAC7B,CACA,SAAMV,CAAIO,EAAKI,EAAe,YACtBrC,KAAKwB,0BACX,MAAMU,QAAclC,KAAKmB,GAAGI,OAAOG,IAAIO,GACvC,OAAOC,GAASG,CAClB,EAGF,MAAMC,EAA2B,IACjC,MAAMC,EAA+B,KACrC,MAAMC,EAAc,cACpB,MAAMC,EAA2B,IAAIC,IAAI,CAAC/B,EAAYgC,SAASC,UAC/D,MAAMC,EACJ,kBAAO7B,GACL,IAAK6B,EAAa5B,SAAU,CAC1B4B,EAAa5B,SAAW,IAAI4B,CAC9B,CACA,OAAOA,EAAa5B,QACtB,CACA,WAAAC,GACElB,KAAK8C,OAAS,MACd9C,KAAKuB,OAAS,CAAC,EACfvB,KAAK+C,YAAc,IAAIC,SAAQC,IAC7BjD,KAAKkD,oBAAsBD,CAAO,IAEpC3C,EAAiB6C,aAAaC,UAAUzC,EAAY0C,UAAUC,OAAOC,eAAgBvD,KAAKuD,eAAeC,KAAKxD,MAChH,CACA,sBAAMyD,GACJ,GAAIzD,KAAK8C,OAAQ,CACf,MACF,CACA9C,KAAK8C,OAAS,KACd,IAAIY,EAAe,KACnB,IACEA,QAAqB3C,EAAiBC,cAAcU,IAAI1B,KAAK2D,gBAAiB,CAAC,EACjF,CAAE,MAAOC,GAEPC,QAAQD,MAAM,4CAA6CA,GAC3D5D,KAAKkD,sBACL,MACF,CACAlD,KAAK8D,sBAAsBJ,GAC3BnD,EAAiBwD,OAAOC,KAAK,4BAA6BhE,KAAKuB,QAC/DvB,KAAKkD,sBACLlD,KAAKiE,wBACP,CACA,KAAAC,GACE,OAAOlE,KAAK+C,WACd,CACA,qBAAAe,CAAsBJ,GACpB,IAAKrD,EAAU8D,KAAKC,cAAcV,GAAe,CAC/C,MACF,CACAW,OAAOC,QAAQZ,GAAca,SAAQ,EAAEC,EAAUC,MAC/C,IAAKpE,EAAU8D,KAAKC,cAAcK,GAAQ,CACxC,MACF,CACAzE,KAAKuB,OAAOiD,GAAYC,CAAK,GAEjC,CACA,YAAAC,CAAaF,EAAUG,GACrB,IAAK3E,KAAKuB,OAAOiD,GAAW,CAC1BxE,KAAKuB,OAAOiD,GAAY,CAAC,CAC3B,CACAxE,KAAKuB,OAAOiD,GAAUG,KAAOA,EAAKC,OAClC5E,KAAK6E,oBACP,CACA,aAAAC,CAAcN,EAAUO,EAAWC,GACjC,IAAKhF,KAAKuB,OAAOiD,GAAW,CAC1BxE,KAAKuB,OAAOiD,GAAY,CAAC,CAC3B,CACAxE,KAAKuB,OAAOiD,GAAUO,UAAYA,EAClC/E,KAAKuB,OAAOiD,GAAUQ,aAAeA,EACrChF,KAAK6E,oBACP,CACA,gBAAAI,CAAiBT,EAAUU,GACzB,IAAKlF,KAAKuB,OAAOiD,GAAW,CAC1BxE,KAAKuB,OAAOiD,GAAY,CAAC,CAC3B,CACAxE,KAAKuB,OAAOiD,GAAUU,SAAWA,EACjClF,KAAK6E,oBACP,CACA,cAAMM,CAASX,GACb,IAAIY,QACEpF,KAAK+C,YACX,MAAM0B,GAASW,EAAwBpF,KAAKuB,OAAOiD,KAAc,KAAOY,EAAwB,CAAC,EACjG,OAAOpC,QAAQC,QAAQwB,EACzB,CACA,UAAAY,CAAWb,UACFxE,KAAKuB,OAAOiD,GACnBxE,KAAKsF,uBAAuBd,EAAU,GACxC,CACA,sBAAAP,GACEI,OAAOC,QAAQtE,KAAKuB,QAAQgD,SAAQ,EAAEC,EAAUC,MAC9C,IAAIc,EACJvF,KAAKsF,uBAAuBd,GAAWe,EAAcd,EAAME,OAAS,KAAOY,EAAc,GAAG,GAEhG,CACA,sBAAAD,CAAuBd,EAAUG,GAC/B,IAAK3E,KAAKwF,0BAA0BhB,GAAW,CAC7C,MACF,MACKhE,EAAuBiF,KAAKC,WAAWC,SAAS3F,KAAK4F,qBAAsB,CAC9EC,GAAIrB,EACJG,QAEJ,CACA,cAAApB,CAAeuC,GACb,MAAMC,KACJA,GACED,EAAME,UACV,GAAID,EAAKE,OAASjG,KAAKkG,iBAAmBH,EAAKI,WAAa,GAAI,CAC9D,MACF,CACA,MAAM3B,EAAWuB,EAAKI,SACtBC,YAAWC,UACT,MAAM1B,KACJA,EAAO,UACC3E,KAAKmF,SAASX,GACxBxE,KAAKsF,uBAAuBd,EAAUG,EAAK,GAC1CpC,EACL,CACA,kBAAAsC,GACEyB,aAAatG,KAAKuG,uBAClBvG,KAAKuG,sBAAwBH,YAAW,KACtCpG,KAAKwG,iBAAiB,GACrBlE,EACL,CACA,eAAAkE,GACEzF,EAAiBC,cAAca,IAAI7B,KAAK2D,gBAAiB3D,KAAKyG,gBAChE,CACA,aAAAA,GACE,MAAMrE,EAAS,CAAC,EAChBiC,OAAOC,QAAQtE,KAAKuB,QAAQgD,SAAQ,EAAEC,EAAUC,MAC9C,IAAKA,EAAME,OAASF,EAAMM,UAAW,CACnC,MACF,CACA,GAAIN,EAAMM,YAAcpE,EAAY+F,kBAAkBC,KAAM,CAC1D,MACF,CACAvE,EAAOoC,GAAY,CACjBG,KAAMF,EAAME,KACZO,SAAUT,EAAMS,SACjB,IAEH,OAAO9C,CACT,CACA,aAAA8D,GACE,OAAOvF,EAAYiG,OAAOC,KAAKZ,IACjC,CACA,aAAAtC,GACE,OAAOnB,CACT,CACA,kBAAAoD,GACE,MAAO,uBACT,CACA,yBAAAJ,CAA0BhB,GACxB,MAAMqC,EAAOrG,EAAuBiF,KAAKC,WAAWoB,QAAQ,aAAatC,GACzE,IAAKqC,EAAM,CACT,OAAO,KACT,CACA,OAAQpE,EAAyBsE,IAAIF,EAAKG,KAC5C,EAEFnE,EAAa5B,SAAW,KAExB,MAAMgG,EAAgB,eACtB,MAAMC,UAA4BrE,EAChC,kBAAO7B,GACL,IAAKkG,EAAoBjG,SAAU,CACjCiG,EAAoBjG,SAAW,IAAIiG,CACrC,CACA,OAAOA,EAAoBjG,QAC7B,CACA,aAAAiF,GACE,OAAOvF,EAAYiG,OAAOO,QAAQlB,IACpC,CACA,aAAAtC,GACE,OAAOsD,CACT,CACA,kBAAArB,GACE,MAAO,wBACT,EAEFsB,EAAoBjG,SAAW,KAE/Bb,EAAQyC,aAAeA,EACvBzC,EAAQ8G,oBAAsBA,CAE/B,EAtOA,CAsOGlH,KAAKC,GAAGC,UAAUC,GAAGiH,IAAMpH,KAAKC,GAAGC,UAAUC,GAAGiH,KAAO,CAAC,EAAGnH,GAAGA,GAAGoH,MAAMpH,GAAGC,UAAUC,GAAGiH,IAAInH,GAAGC,UAAUC,GAAGmH,YAAYrH,GAAGsH,OAAOtH,GAAGC,UAAUC,GAAGiH,IAAInH,GAAGC,UAAUC,GAAGqH","ignoreList":[]}