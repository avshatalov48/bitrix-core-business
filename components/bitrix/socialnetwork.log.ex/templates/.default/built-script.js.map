{"version":3,"file":"built-script.js","sources":["src/feed-ai-promo.js"],"sourcesContent":["import { AnglePosition, PromoVideoPopup, PromoVideoPopupEvents } from 'ui.promo-video-popup';\nimport { CopilotPromoPopup } from 'ai.copilot-promo-popup';\nimport { ajax } from 'main.core';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\ntype Promo = {\n\ttype: string,\n\tisShown: boolean,\n};\n\ntype Params = {\n\tfeedPromo: Promo,\n\tchatPromo: Promo,\n};\n\nexport class FeedAiPromo\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#bindPromo(this.#params.feedPromo, this.#getFeedPopup());\n\t\tthis.#bindPromo(this.#params.chatPromo, this.#getChatPopup());\n\t}\n\n\t#bindPromo(promo: Promo, popup: PromoVideoPopup): void\n\t{\n\t\tif (promo.isShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBannerDispatcher.high.toQueue((onDone) => {\n\t\t\tpopup.subscribe(PromoVideoPopupEvents.HIDE, this.onCopilotPromoHide.bind(this, promo, onDone));\n\t\t\tpopup.show();\n\t\t});\n\t}\n\n\t#getFeedPopup(): ?PromoVideoPopup\n\t{\n\t\tconst blogContainer = document.querySelector('#sonet_log_microblog_container');\n\n\t\tif (!blogContainer)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn CopilotPromoPopup.createByPresetId({\n\t\t\tpresetId: CopilotPromoPopup.Preset.LIVE_FEED_EDITOR,\n\t\t\ttargetOptions: blogContainer,\n\t\t\toffset: {\n\t\t\t\tleft: 65,\n\t\t\t\ttop: 0,\n\t\t\t},\n\t\t\tangleOptions: {\n\t\t\t\tposition: AnglePosition.TOP,\n\t\t\t\toffset: 73,\n\t\t\t},\n\t\t});\n\t}\n\n\t#getChatPopup(): ?PromoVideoPopup\n\t{\n\t\tconst copilotChatButton = document.querySelector('#bx-im-bar-copilot');\n\n\t\tif (!copilotChatButton)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn CopilotPromoPopup.createByPresetId({\n\t\t\tpresetId: CopilotPromoPopup.Preset.CHAT,\n\t\t\ttargetOptions: copilotChatButton,\n\t\t\toffset: {\n\t\t\t\tleft: -(PromoVideoPopup.getWidth()),\n\t\t\t\ttop: -67,\n\t\t\t},\n\t\t\tangleOptions: {\n\t\t\t\tposition: AnglePosition.RIGHT,\n\t\t\t\toffset: 30,\n\t\t\t},\n\t\t});\n\t}\n\n\tonCopilotPromoHide(promo: Promo, onDone: Function): void\n\t{\n\t\tajax.runAction('socialnetwork.promotion.setViewed', { data: { promotion: promo.type } })\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.error(err);\n\t\t\t})\n\t\t;\n\n\t\tonDone();\n\t}\n}\n"],"names":["FeedAiPromo","constructor","params","show","feedPromo","chatPromo","onCopilotPromoHide","promo","onDone","ajax","runAction","data","promotion","type","catch","err","console","error","popup","isShown","BannerDispatcher","high","toQueue","subscribe","PromoVideoPopupEvents","HIDE","bind","blogContainer","document","querySelector","CopilotPromoPopup","createByPresetId","presetId","Preset","LIVE_FEED_EDITOR","targetOptions","offset","left","top","angleOptions","position","AnglePosition","TOP","copilotChatButton","CHAT","PromoVideoPopup","getWidth","RIGHT"],"mappings":";;;;;;;CAGwD;CAAA;CAAA;CAAA;AAYxD,CAAO,MAAMA,WAAW,CACxB;GAGCC,WAAW,CAACC,MAAc,EAC1B;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,sBAAWA,MAAM;;GAGtBC,IAAI,GACJ;KACC,4CAAI,0BAAY,4CAAI,oBAASC,SAAS,0CAAE,IAAI;KAC5C,4CAAI,0BAAY,4CAAI,oBAASC,SAAS,0CAAE,IAAI;;GA8D7CC,kBAAkB,CAACC,KAAY,EAAEC,MAAgB,EACjD;KACCC,cAAI,CAACC,SAAS,CAAC,mCAAmC,EAAE;OAAEC,IAAI,EAAE;SAAEC,SAAS,EAAEL,KAAK,CAACM;;MAAQ,CAAC,CACtFC,KAAK,CAAEC,GAAG,IAAK;OACfC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;MAClB,CAAC;KAGHP,MAAM,EAAE;;CAEV;CAAC,qBArEWD,KAAY,EAAEW,KAAsB,EAC/C;GACC,IAAIX,KAAK,CAACY,OAAO,EACjB;KACC;;GAGDC,oCAAgB,CAACC,IAAI,CAACC,OAAO,CAAEd,MAAM,IAAK;KACzCU,KAAK,CAACK,SAAS,CAACC,wCAAqB,CAACC,IAAI,EAAE,IAAI,CAACnB,kBAAkB,CAACoB,IAAI,CAAC,IAAI,EAAEnB,KAAK,EAAEC,MAAM,CAAC,CAAC;KAC9FU,KAAK,CAACf,IAAI,EAAE;IACZ,CAAC;CACH;CAAC,0BAGD;GACC,MAAMwB,aAAa,GAAGC,QAAQ,CAACC,aAAa,CAAC,gCAAgC,CAAC;GAE9E,IAAI,CAACF,aAAa,EAClB;KACC,OAAO,IAAI;;GAGZ,OAAOG,sCAAiB,CAACC,gBAAgB,CAAC;KACzCC,QAAQ,EAAEF,sCAAiB,CAACG,MAAM,CAACC,gBAAgB;KACnDC,aAAa,EAAER,aAAa;KAC5BS,MAAM,EAAE;OACPC,IAAI,EAAE,EAAE;OACRC,GAAG,EAAE;MACL;KACDC,YAAY,EAAE;OACbC,QAAQ,EAAEC,gCAAa,CAACC,GAAG;OAC3BN,MAAM,EAAE;;IAET,CAAC;CACH;CAAC,0BAGD;GACC,MAAMO,iBAAiB,GAAGf,QAAQ,CAACC,aAAa,CAAC,oBAAoB,CAAC;GAEtE,IAAI,CAACc,iBAAiB,EACtB;KACC,OAAO,IAAI;;GAGZ,OAAOb,sCAAiB,CAACC,gBAAgB,CAAC;KACzCC,QAAQ,EAAEF,sCAAiB,CAACG,MAAM,CAACW,IAAI;KACvCT,aAAa,EAAEQ,iBAAiB;KAChCP,MAAM,EAAE;OACPC,IAAI,EAAE,CAAEQ,kCAAe,CAACC,QAAQ,EAAG;OACnCR,GAAG,EAAE,CAAC;MACN;KACDC,YAAY,EAAE;OACbC,QAAQ,EAAEC,gCAAa,CAACM,KAAK;OAC7BX,MAAM,EAAE;;IAET,CAAC;CACH;;;;;;;;"}