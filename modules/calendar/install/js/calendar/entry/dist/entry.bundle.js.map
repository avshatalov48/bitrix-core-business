{"version":3,"file":"entry.bundle.js","sources":["../src/entrymanager.js","../src/entry.js"],"sourcesContent":["import { Entry } from 'calendar.entry';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { Util } from 'calendar.util';\nimport { Event, Loc, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { CompactEventForm } from 'calendar.compacteventform';\nimport 'ui.notification';\nimport { RoomsManager } from 'calendar.roomsmanager';\n\nexport class EntryManager {\n\tstatic newEntryName = '';\n\tstatic userIndex = {};\n\tstatic delayedActionList = [];\n\tstatic DELETE_DELAY_TIMEOUT = 4000;\n\tstatic slidersMap = new WeakMap();\n\n\tstatic getNewEntry(options)\n\t{\n\t\tconst newEntryData = {};\n\t\tconst dateTime = EntryManager.getNewEntryTime(new Date());\n\t\tconst userSettings = Util.getUserSettings();\n\t\tconst userId = Util.getCurrentUserId();\n\n\t\tnewEntryData.ID = null;\n\t\tnewEntryData.NAME = EntryManager.getNewEntryName();\n\t\tnewEntryData.dateFrom = dateTime.from;\n\t\tnewEntryData.dateTo = dateTime.to;\n\t\tif(options.type === 'location')\n\t\t{\n\t\t\tnewEntryData.SECT_ID = RoomsManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewEntryData.SECT_ID = SectionManager.getNewEntrySectionId(options.type, parseInt(options.ownerId));\n\t\t}\n\t\tnewEntryData.REMIND = EntryManager.getNewEntryReminders();\n\n\t\tnewEntryData.attendeesEntityList = [{entityId: 'user', id: userId}];\n\t\tnewEntryData.ATTENDEE_LIST = [{id: Util.getCurrentUserId(), status: \"H\"}];\n\n\t\tif (options.type === 'user' && userId !== options.ownerId)\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'user', id: options.ownerId});\n\t\t\tnewEntryData.ATTENDEE_LIST = [\n\t\t\t\t{id: options.ownerId, status: \"H\"},\n\t\t\t\t{id: Util.getCurrentUserId(), status: \"Y\"}\n\t\t\t];\n\t\t}\n\t\telse if (options.type === 'group')\n\t\t{\n\t\t\tnewEntryData.attendeesEntityList.push({entityId: 'project', id: options.ownerId});\n\t\t}\n\n\t\tnewEntryData.TZ_FROM = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\t\tnewEntryData.TZ_TO = userSettings.timezoneName || userSettings.timezoneDefaultName || '';\n\n\t\treturn new Entry({data: newEntryData});\n\t}\n\n\tstatic getNewEntryTime(date, duration)\n\t{\n\t\tdate = Util.getUsableDateTime(date);\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst displayedViewRange = calendarContext.getDisplayedViewRange();\n\t\t\tif (Type.isDate(displayedViewRange?.start))\n\t\t\t{\n\t\t\t\tconst dateTime = date.getTime();\n\t\t\t\tif (\n\t\t\t\t\tdateTime < displayedViewRange.start.getTime()\n\t\t\t\t\t|| dateTime > displayedViewRange.end.getTime()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst startDate = new Date(displayedViewRange.start.getTime());\n\t\t\t\t\tconst workTime = calendarContext.util.getWorkTime();\n\t\t\t\t\tstartDate.setHours(workTime.start, 0, 0,0);\n\t\t\t\t\tdate = Util.getUsableDateTime(startDate);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tfrom : date,\n\t\t\tto : new Date(date.getTime() + (duration || 3600) * 1000)\n\t\t}\n\t}\n\n\tstatic getNewEntryName(): string\n\t{\n\t\treturn (EntryManager.newEntryName || '');\n\t}\n\n\tstatic setNewEntryName(newEntryName)\n\t{\n\t\tEntryManager.newEntryName = newEntryName;\n\t}\n\n\tstatic showEditEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_SAVE_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: function(event, balloon, action) {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showNewEntryNotification(entryId)\n\t{\n\t\tUtil.showNotification(\n\t\t\tLoc.getMessage('CALENDAR_NEW_EVENT_NOTIFICATION'),\n\t\t\t[{\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\n\t\t\t\t\t\tEntryManager.openViewSlider(entryId);\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t)\n\t}\n\n\tstatic showDeleteEntryNotification(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: 'calendar' + entry.getUniqueId(),\n\t\t\t\tcontent: Loc.getMessage('CALENDAR_DELETE_EVENT_NOTIFICATION'),\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: Loc.getMessage('CALENDAR_EVENT_DO_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\t\tentry.cancelDelete();\n\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReleaseLocationNotification()\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('CALENDAR_RELEASE_LOCATION_NOTIFICATION'),\n\t\t});\n\t}\n\n\tstatic closeDeleteNotificationBalloon(entry)\n\t{\n\t\tif (entry && entry instanceof Entry)\n\t\t{\n\t\t\tconst balloon = BX.UI.Notification.Center.getBalloonById('calendar' + entry.getUniqueId());\n\t\t\tif (balloon)\n\t\t\t{\n\t\t\t\tballoon.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic openEditSlider(options = {})\n\t{\n\t\tconst bx = Util.getBX();\n\n\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t{\n\t\t\tnew bx.Calendar.SliderLoader(\n\t\t\t\toptions.entry ? 'EDIT' + options.entry.id : 'NEW',\n\t\t\t\t{\n\t\t\t\t\tcalendarContext: options.calendarContext,\n\t\t\t\t\tentry: options.entry || null,\n\t\t\t\t\ttype: options.type,\n\t\t\t\t\tisLocationCalendar: options.isLocationCalendar || false,\n\t\t\t\t\troomsManager: options.roomsManager || null,\n\t\t\t\t\tlocationAccess: options.locationAccess || false,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tlocationCapacity: options.locationCapacity || 0,\n\t\t\t\t\townerId: options.ownerId,\n\t\t\t\t\tuserId: options.userId,\n\t\t\t\t\tformDataValue: options.formDataValue || null\n\t\t\t\t}\n\t\t\t).show();\n\t\t}\n\t}\n\n\tstatic openViewSlider(eventId = null, options = {})\n\t{\n\t\tif (!Type.isNull(eventId))\n\t\t{\n\t\t\tconst bx = Util.getBX();\n\t\t\tif (bx.Calendar && bx.Calendar.SliderLoader)\n\t\t\t{\n\t\t\t\tnew bx.Calendar.SliderLoader(eventId, {\n\t\t\t\t\tentryDateFrom: options.from,\n\t\t\t\t\ttimezoneOffset: options.timezoneOffset,\n\t\t\t\t\tdayOfWeekMonthFormat: options.dayOfWeekMonthFormat || false,\n\t\t\t\t\tcalendarContext: options.calendarContext || null,\n\t\t\t\t\tlink: options.link,\n\t\t\t\t}).show();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deleteEntry(entry, calendarContext = null)\n\t{\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\t\tconst beforeDeleteHandler = () => {\n\t\t\t\tif (slider && slider.options.type === 'calendar:slider')\n\t\t\t\t{\n\t\t\t\t\tUtil.getBX().SidePanel.Instance.close();\n\t\t\t\t}\n\t\t\t};\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\n\t\t\tconst deleteHandler = () => {\n\t\t\t\tconst calendar = Util.getCalendarContext();\n\t\t\t\tif (!calendar && !calendarContext)\n\t\t\t\t{\n\t\t\t\t\treturn Util.getBX().reload();\n\t\t\t\t}\n\n\t\t\t\tif (calendar)\n\t\t\t\t{\n\t\t\t\t\tcalendar.reload();\n\t\t\t\t}\n\t\t\t\telse if (calendarContext)\n\t\t\t\t{\n\t\t\t\t\tcalendarContext.reload();\n\t\t\t\t}\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:delete', deleteHandler);\n\t\t\t\tEventEmitter.unsubscribe('BX.Calendar.Entry:beforeDelete', beforeDeleteHandler);\n\t\t\t};\n\n\t\t\tEventEmitter.subscribe('BX.Calendar.Entry:delete', deleteHandler);\n\n\t\t\tentry.delete();\n\t\t}\n\t}\n\n\tstatic setMeetingStatus(entry, status, params = {})\n\t{\n\t\treturn new Promise(resolve => {\n\t\t\tif (!Type.isPlainObject(params))\n\t\t\t{\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\tparams.recursionMode = params.recursionMode || false;\n\n\t\t\tif (status === 'N' && !params.confirmed)\n\t\t\t{\n\t\t\t\tif (entry.isRecursive())\n\t\t\t\t{\n\t\t\t\t\tthis.showConfirmStatusDialog(entry, resolve);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.ajax.runAction('calendar.api.calendarajax.setMeetingStatus', {\n\t\t\t\tdata: {\n\t\t\t\t\tentryId: entry.id,\n\t\t\t\t\tentryParentId: entry.parentId,\n\t\t\t\t\tstatus: status,\n\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\tcurrentDateFrom: Util.formatDate(entry.from)\n\t\t\t\t}\n\t\t\t}).then(\n\t\t\t\t(response) => {\n\t\t\t\t\tBX.Event.EventEmitter.emit(\n\t\t\t\t\t\t'BX.Calendar.Entry:onChangeMeetingStatus',\n\t\t\t\t\t\tnew Event.BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\t\t\tcurrentDateFrom: entry.from,\n\t\t\t\t\t\t\t\tcounters: response.data.counters\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tif (entry instanceof Entry)\n\t\t\t\t\t{\n\t\t\t\t\t\tentry.setCurrentStatus(status);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tentry: entry,\n\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\trecursionMode: params.recursionMode,\n\t\t\t\t\t\tcurrentDateFrom: entry.from\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tstatic showConfirmStatusDialog(entry, resolvePromiseCallback = null)\n\t{\n\t\tif (!this.confirmDeclineDialog)\n\t\t{\n\t\t\tthis.confirmDeclineDialog = this.createConfirmStatusDialog();\n\t\t}\n\n\t\tthis.confirmDeclineDialog.show();\n\t\tthis.confirmDeclineDialog.unsubscribeAll('onDecline');\n\t\tthis.confirmDeclineDialog.subscribe('onDecline', function(event)\n\t\t{\n\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t{\n\t\t\t\tEntryManager.setMeetingStatus(\n\t\t\t\t\tentry,\n\t\t\t\t\t'N',\n\t\t\t\t\t{recursionMode: event.getData().recursionMode, confirmed: true}\n\t\t\t\t).then(() => {\n\t\t\t\t\tif (Type.isFunction(resolvePromiseCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tresolvePromiseCallback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic showConfirmEditDialog(options)\n\t{\n\t\tif (!this.confirmEditDialog)\n\t\t{\n\t\t\tthis.confirmEditDialog = this.createConfirmEditDialog();\n\t\t}\n\t\tthis.confirmEditDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmEditDialog.unsubscribeAll('onEdit');\n\t\t\tthis.confirmEditDialog.subscribe('onEdit', (event) => {\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showReInviteUsersDialog(options)\n\t{\n\t\tif (!this.reinviteUsersDialog)\n\t\t{\n\t\t\tthis.reinviteUsersDialog = this.createReinviteUserDialog();\n\t\t}\n\t\tthis.reinviteUsersDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.reinviteUsersDialog.unsubscribeAll('onSelect');\n\t\t\tthis.reinviteUsersDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showConfirmedEmailDialog(options = {})\n\t{\n\t\tif (!this.confirmedEmailDialog)\n\t\t{\n\t\t\tthis.confirmedEmailDialog = this.createConfirmedEmailDialog();\n\t\t}\n\t\tthis.confirmedEmailDialog.show();\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.confirmedEmailDialog.unsubscribeAll('onSelect');\n\t\t\tthis.confirmedEmailDialog.subscribe('onSelect', function(event)\n\t\t\t{\n\t\t\t\tif (event && Type.isFunction(event.getData))\n\t\t\t\t{\n\t\t\t\t\toptions.callback(event.getData());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showEmailLimitationDialog(options = {})\n\t{\n\t\tif (!this.limitationEmailDialog)\n\t\t{\n\t\t\tthis.limitationEmailDialog = this.createEmailLimitationDialog();\n\t\t}\n\t\tthis.limitationEmailDialog.subscribe('onClose', ()=>{\n\t\t\tif (Type.isFunction(options.callback))\n\t\t\t{\n\t\t\t\toptions.callback();\n\t\t\t}\n\t\t});\n\t\tthis.limitationEmailDialog.show();\n\t}\n\n\tstatic getCompactViewForm(create = true)\n\t{\n\t\tif (!EntryManager.compactEntryForm && create)\n\t\t{\n\t\t\tEntryManager.compactEntryForm = new CompactEventForm();\n\t\t}\n\n\t\treturn EntryManager.compactEntryForm;\n\t}\n\n\tstatic openCompactViewForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInViewMode(options);\n\t\t}\n\t}\n\n\tstatic openCompactEditForm(options = {})\n\t{\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (!compactForm.isShown())\n\t\t{\n\t\t\tcompactForm.unsubscribeAll('onClose');\n\t\t\tif (Type.isFunction(options.closeCallback))\n\t\t\t{\n\t\t\t\tcompactForm.subscribe('onClose', options.closeCallback);\n\t\t\t}\n\t\t\tcompactForm.showInEditMode(options);\n\t\t}\n\t}\n\n\tstatic getEntryInstance(entry, userIndex, options = {})\n\t{\n\t\tlet entryInstance = null;\n\t\tif (entry instanceof Entry)\n\t\t{\n\t\t\tentryInstance = entry;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isObject(entry) && Type.isObject(entry.data))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry.data, userIndex: userIndex});\n\t\t\t}\n\t\t\telse if (Type.isObject(entry))\n\t\t\t{\n\t\t\t\tentryInstance = new Entry({data: entry, userIndex: userIndex});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentryInstance = EntryManager.getNewEntry(options);\n\t\t\t}\n\t\t}\n\n\t\treturn entryInstance;\n\t}\n\n\tstatic getUserIndex(options = {})\n\t{\n\t\treturn EntryManager.userIndex\n\t}\n\n\tstatic setUserIndex(userIndex)\n\t{\n\t\tEntryManager.userIndex = userIndex;\n\t}\n\n\thandlePullChanges(params)\n\t{\n\t\tif (!BX.Calendar.Util.checkRequestId(params.requestUid))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst compactForm = EntryManager.getCompactViewForm();\n\t\tif (\n\t\t\tcompactForm\n\t\t\t&& compactForm.isShown()\n\t\t)\n\t\t{\n\t\t\tcompactForm.handlePull(params);\n\t\t}\n\n\t\tBX.SidePanel.Instance.getOpenSliders().forEach(slider =>\n\t\t{\n\t\t\tconst data = EntryManager.slidersMap.get(slider);\n\t\t\tif (\n\t\t\t\tdata\n\t\t\t\t&& data.entry\n\t\t\t\t&& data.entry.parentId === parseInt(params?.fields?.PARENT_ID)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.command === 'delete_event'\n\t\t\t\t\t&& data.entry.getType() === params?.fields?.CAL_TYPE\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tslider.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (params.command === 'set_meeting_status')\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t}\n\t\telse if (params.command === 'delete_event' || params.command === 'edit_event')\n\t\t{\n\t\t\tif (\n\t\t\t\t!params.fields\n\t\t\t\t||\n\t\t\t\t(params?.fields?.IS_MEETING && params?.fields?.MEETING_STATUS === 'Q')\n\t\t\t)\n\t\t\t{\n\t\t\t\ttop.BX.Event.EventEmitter.emit('BX.Calendar:doReloadCounters');\n\t\t\t}\n\n\t\t\tif (params?.fields?.CAL_TYPE === 'location' && top.BX.Calendar?.Controls?.Location)\n\t\t\t{\n\t\t\t\ttop.BX.Calendar.Controls.Location.handlePull(params);\n\t\t\t}\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tconst entrySectionId = parseInt(params?.fields?.SECTION_ID);\n\t\tlet sectionDisplayed = Type.isArray(params.sections)\n\t\t\t&& params.sections.find(section => {\n\t\t\t\treturn section.id === entrySectionId && section.isShown();\n\t\t\t});\n\n\t\tlet loadedEntry = params?.fields\n\t\t\t? EntryManager.getEntryInstance(\n\t\t\t\tcalendarContext.getView().getEntryById(EntryManager.getEntryUniqueId(params.fields)),\n\t\t\t)\n\t\t\t: null;\n\n\t\tif ((sectionDisplayed || loadedEntry) && calendarContext)\n\t\t{\n\t\t\tcalendarContext.reloadDebounce();\n\t\t}\n\t}\n\n\tstatic registerDeleteTimeout(params)\n\t{\n\t\tEntryManager.delayedActionList.push(params);\n\t}\n\n\tstatic unregisterDeleteTimeout({action, data})\n\t{\n\t\tEntryManager.delayedActionList = EntryManager.delayedActionList.filter((item) => {\n\t\t\treturn item.action !== action\n\t\t\t\t|| item.data.entryId !== data.entryId\n\t\t\t\t|| item.data.recursionMode !== data.recursionMode\n\t\t\t\t|| item.data.excludeDate !== data.excludeDate;\n\t\t});\n\t}\n\n\tstatic doDelayedActions()\n\t{\n\t\tlet requestList = [];\n\t\treturn new Promise(resolve => {\n\t\t\tif(!EntryManager.delayedActionList.length)\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\n\t\t\tEntryManager.delayedActionList.forEach(({action, data, params}) => {\n\n\t\t\t\tconst requestUid = parseInt(data.requestUid);\n\t\t\t\trequestList.push(data.requestUid);\n\n\t\t\t\tif (params.entry)\n\t\t\t\t{\n\t\t\t\t\tEntryManager.closeDeleteNotificationBalloon(params.entry);\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t`calendar.api.calendarajax.${action}`,\n\t\t\t\t\t{data: data}\n\t\t\t\t).then(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tType.isFunction(params.callback)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparams.callback();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\trequestList = requestList.filter(uid => {return uid !== requestUid});\n\t\t\t\t\t\tif (!requestList.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tEntryManager.unregisterDeleteTimeout({action, data, params});\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getEntryUniqueId(entryData, entry)\n\t{\n\t\tlet sid = entryData.PARENT_ID || entryData.ID;\n\t\tif (entryData.RRULE)\n\t\t{\n\t\t\tsid += '|' + (entry ? Util.formatDate(entry.from) : Util.formatDate(BX.parseDate(entryData.DATE_FROM)));\n\t\t}\n\n\t\tif (entryData['~TYPE'] === 'tasks')\n\t\t{\n\t\t\tsid += '|' + 'task';\n\t\t}\n\t\treturn sid;\n\t}\n\n\tstatic registerEntrySlider(entry, control)\n\t{\n\t\tconst slider = Util.getBX().SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tEntryManager.slidersMap.set(slider, {entry, control});\n\t\t}\n\t}\n\n\tstatic getNewEntryReminders(type = 'withTime')\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders)\n\t\t\t&& Type.isArray(userSettings.defaultReminders[type])\n\t\t\t&& userSettings.defaultReminders[type].length)\n\t\t{\n\t\t\treturn userSettings.defaultReminders[type];\n\t\t}\n\n\t\treturn type === 'withTime'\n\t\t\t? [{type: 'min', count: 15}]\n\t\t\t: [{type: 'daybefore', before: 0, time: 480}];\n\t}\n\n\tstatic setNewEntryReminders(type = 'withTime', reminders)\n\t{\n\t\tconst userSettings = Util.getUserSettings();\n\t\tif (Type.isObjectLike(userSettings.defaultReminders))\n\t\t{\n\t\t\tuserSettings.defaultReminders[type] = reminders;\n\t\t}\n\t\tUtil.setUserSettings(userSettings);\n\t}\n\n\t//this is because extensions cant be loaded in iframe with import\n\tstatic createConfirmEditDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmEditDialog();\n\t}\n\n\tstatic createConfirmStatusDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmStatusDialog();\n\t}\n\n\tstatic createReinviteUserDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ReinviteUserDialog();\n\t}\n\n\tstatic createConfirmedEmailDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.ConfirmedEmailDialog();\n\t}\n\n\tstatic createEmailLimitationDialog()\n\t{\n\t\tconst bx = Util.getBX();\n\t\treturn new bx.Calendar.Controls.EmailLimitationDialog();\n\t}\n}","import {Util} from 'calendar.util';\nimport {EntryManager} from \"./entrymanager\";\nimport { Type } from 'main.core';\n\nexport {EntryManager};\n\nexport class Entry\n{\n\tFULL_DAY_LENGTH = 86400;\n\n\tstatic CAL_TYPES = {\n\t\t'user': 'user',\n\t\t'group': 'group',\n\t\t'company': 'company_calendar',\n\t};\n\tconstructor(options = {})\n\t{\n\t\tthis.prepareData(options.data);\n\t\tthis.parts = [];\n\n\t\tif (options.userIndex)\n\t\t{\n\t\t\tthis.setUserIndex(options.userIndex);\n\t\t}\n\n\t\tthis.delayTimeoutMap = new Map();\n\t}\n\n\tprepareData(data)\n\t{\n\t\tthis.data = data;\n\t\tthis.id = parseInt(this.data.ID || 0);\n\t\tthis.parentId = parseInt(this.data.PARENT_ID || 0);\n\n\t\tif (!this.data.DT_SKIP_TIME)\n\t\t{\n\t\t\tthis.data.DT_SKIP_TIME = this.data.SKIP_TIME ? 'Y' : 'N';\n\t\t}\n\n\t\tthis.fullDay = this.data.DT_SKIP_TIME === 'Y';\n\t\tthis.accessibility = this.data.ACCESSIBILITY || 'busy';\n\t\tthis.important = this.data.IMPORTANCE === 'high';\n\t\tthis.private = !!this.data.PRIVATE_EVENT;\n\t\tthis.setSectionId(this.data.SECT_ID);\n\t\tthis.name = this.data.NAME;\n\n\t\tthis.userTimezoneOffsetFrom = parseInt(this.data['~USER_OFFSET_FROM']) || 0;\n\t\tthis.userTimezoneOffsetTo = parseInt(this.data['~USER_OFFSET_TO']) || this.userTimezoneOffsetFrom;\n\n\t\tif (!this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.data.DURATION || 0;\n\t\t}\n\t\tif (this.fullDay && !this.data.DT_LENGTH)\n\t\t{\n\t\t\tthis.data.DT_LENGTH = this.FULL_DAY_LENGTH;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isString(this.data.DATE_FROM) && !Type.isString(this.data.DATE_TO)\n\t\t\t&& Type.isDate(this.data.dateFrom) && Type.isDate(this.data.dateTo)\n\t\t)\n\t\t{\n\t\t\tthis.from = this.data.dateFrom;\n\t\t\tthis.to = this.data.dateTo;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = new Date(this.from.getTime() - (parseInt(this.data['~USER_OFFSET_FROM']) || 0) * 1000);\n\t\t\t\tthis.to = new Date(this.to.getTime() - (parseInt(this.data['~USER_OFFSET_TO']) || 0) * 1000);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.isTask())\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.from = BX.parseDate(this.data.DATE_FROM) || new Date();\n\t\t\t\tthis.to = BX.parseDate(this.data.DATE_TO) || this.from;\n\t\t\t}\n\t\t}\n\n\t\tif (this.fullDay)\n\t\t{\n\t\t\tthis.from.setHours(0, 0, 0, 0);\n\t\t\tthis.to.setHours(0, 0, 0, 0);\n\t\t}\n\n\t\tif (!this.data.ATTENDEES_CODES && !this.isTask())\n\t\t{\n\t\t\tif (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.OWNER_ID];\n\t\t\t}\n\t\t\telse if (this.data.CREATED_BY)\n\t\t\t{\n\t\t\t\tthis.data.ATTENDEES_CODES = ['U' + this.data.CREATED_BY];\n\t\t\t}\n\t\t}\n\n\t\tthis.startDayCode = this.from;\n\t\tthis.endDayCode = this.to;\n\n\t\tif (!Type.isArray(this.data.REMIND) && Type.isArray(this.data.remind))\n\t\t{\n\t\t\tthis.data.REMIND = [];\n\t\t\tthis.data.remind.forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.data.REMIND.push({type: 'min', count: value});\n\t\t\t}, this);\n\t\t\tdelete this.data.remind;\n\t\t}\n\n\t\tif (this.data.permissions)\n\t\t{\n\t\t\tthis.permissions = this.data.permissions;\n\t\t}\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\treturn this.data.ATTENDEES_CODES || [];\n\t}\n\n\tgetAttendeesEntityList()\n\t{\n\t\treturn this.data.attendeesEntityList || [];\n\t}\n\n\tgetAttendees()\n\t{\n\t\tif (!this.attendeeList)\n\t\t{\n\t\t\tthis.attendeeList = [];\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tconst userIndex = this.getUserIndex();\n\t\t\t\tthis.data['ATTENDEE_LIST'].forEach((user) => {\n\t\t\t\t\tif (userIndex[user.id])\n\t\t\t\t\t{\n\t\t\t\t\t\tlet attendee = BX.clone(userIndex[user.id]);\n\t\t\t\t\t\tattendee.STATUS = user.status;\n\t\t\t\t\t\tattendee.ENTRY_ID = user.entryId || false;\n\t\t\t\t\t\tthis.attendeeList.push(attendee);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.attendeeList;\n\t}\n\n\tsetUserIndex(userIndex)\n\t{\n\t\tthis.userIndex = userIndex;\n\t}\n\n\tgetUserIndex()\n\t{\n\t\treturn this.userIndex || EntryManager.getUserIndex();\n\t}\n\n\tcleanParts()\n\t{\n\t\tthis.parts = [];\n\t}\n\n\tstartPart(part)\n\t{\n\t\tpart.partIndex = this.parts.length;\n\t\tthis.parts.push(part);\n\t\treturn this.parts[part.partIndex];\n\t}\n\n\tregisterPartNode(part, params)\n\t{\n\t\tpart.params = params;\n\t}\n\n\tcheckPartIsRegistered(part)\n\t{\n\t\treturn Type.isPlainObject(part.params);\n\t}\n\n\tgetPart(partIndex)\n\t{\n\t\treturn this.parts[partIndex] || false;\n\t}\n\n\tgetWrap(partIndex)\n\t{\n\t\treturn this.parts[partIndex || 0].params.wrapNode;\n\t}\n\n\tgetSectionName()\n\t{\n\t\t//return this.calendar.sectionController.getSection(this.sectionId).name || '';\n\t}\n\n\tgetDescription()\n\t{\n\t\treturn this.data.DESCRIPTION || '';\n\t}\n\n\tapplyViewRange(viewRange)\n\t{\n\t\tlet\n\t\t\tviewRangeStart = viewRange.start.getTime(),\n\t\t\tviewRangeEnd = viewRange.end.getTime(),\n\t\t\tfromTime = this.from.getTime(),\n\t\t\ttoTime = this.to.getTime();\n\n\t\tif (toTime < viewRangeStart || fromTime > viewRangeEnd)\n\t\t\treturn false;\n\n\t\tif (fromTime < viewRangeStart)\n\t\t{\n\t\t\tthis.displayFrom = viewRange.start;\n\t\t\tthis.startDayCode = this.displayFrom;\n\t\t}\n\n\t\tif (toTime > viewRangeEnd)\n\t\t{\n\t\t\tthis.displayTo = viewRange.end;\n\t\t\tthis.endDayCode = this.displayTo;\n\t\t}\n\t\treturn true;\n\t}\n\n\tisPersonal()\n\t{\n\t\t//return (this.data.CAL_TYPE === 'user' && this.data.OWNER_ID == this.calendar.util.userId);\n\t}\n\n\tisMeeting()\n\t{\n\t\treturn !!this.data.IS_MEETING;\n\t}\n\n\tisPrivate()\n\t{\n\t\treturn this.private;\n\t}\n\n\tisResourcebooking()\n\t{\n\t\treturn this.data.EVENT_TYPE === '#resourcebooking#';\n\t}\n\n\tisTask()\n\t{\n\t\treturn this.data['~TYPE'] === 'tasks';\n\t}\n\n\tisSharingEvent()\n\t{\n\t\treturn this.data['EVENT_TYPE'] === '#shared#' || this.data['EVENT_TYPE'] === '#shared_crm#';\n\t}\n\n\tisInvited()\n\t{\n\t\treturn this.getCurrentStatus() === 'Q';\n\t}\n\n\tisLocation()\n\t{\n\t\treturn this.getType() === 'location';\n\t}\n\n\tisFullDay()\n\t{\n\t\treturn this.fullDay;\n\t}\n\n\tisLongWithTime()\n\t{\n\t\treturn !this.fullDay && Util.getDayCode(this.from) !== Util.getDayCode(this.to);\n\t}\n\n\tisExpired()\n\t{\n\t\treturn this.to.getTime() < new Date().getTime();\n\t}\n\n\thasEmailAttendees()\n\t{\n\t\tif (this.emailAttendeesCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t{\n\t\t\t\tlet user = this.data['ATTENDEE_LIST'][i];\n\t\t\t\tif ((user.status === 'Y' || user.status === 'Q')\n\t\t\t\t\t&& userIndex[user.id]\n\t\t\t\t\t&& userIndex[user.id].EMAIL_USER\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.emailAttendeesCache = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.emailAttendeesCache;\n\t}\n\n\townerIsEmailUser()\n\t{\n\t\tif (this.ownerIsEmailUserCache === undefined)\n\t\t{\n\t\t\tconst userIndex = EntryManager.getUserIndex();\n\t\t\tthis.ownerIsEmailUserCache = userIndex[parseInt(this.data.MEETING_HOST)]\n\t\t\t\t&& userIndex[parseInt(this.data.MEETING_HOST)].EMAIL_USER;\n\t\t}\n\t\treturn this.ownerIsEmailUserCache;\n\t}\n\n\tisSelected()\n\t{\n\t\treturn !!this.selected;\n\t}\n\n\tisCrm()\n\t{\n\t\treturn !!this.data.UF_CRM_CAL_EVENT;\n\t}\n\n\tisFirstReccurentEntry()\n\t{\n\t\treturn (this.data.DATE_FROM_TS_UTC === Math.floor(BX.parseDate(this.data['~DATE_FROM']).getTime() / 1000) * 1000\n\t\t\t||\n\t\t\tBX.parseDate(this.data['DATE_FROM']).getTime() === BX.parseDate(this.data['~DATE_FROM']).getTime()\n\t\t) && !this.data.RECURRENCE_ID;\n\t}\n\n\tisRecursive()\n\t{\n\t\treturn !!this.data.RRULE;\n\t}\n\n\tisFirstInstance()\n\t{\n\t\treturn this.data.RRULE && this.data.RINDEX === 0;\n\t}\n\n\tgetMeetingHost()\n\t{\n\t\treturn parseInt(this.data.MEETING_HOST);\n\t}\n\n\tgetMeetingNotify()\n\t{\n\t\treturn this.data.MEETING.NOTIFY;\n\t}\n\n\tgetHideGuests()\n\t{\n\t\treturn this.data.MEETING && BX.Type.isBoolean(this.data.MEETING.HIDE_GUESTS)\n\t\t\t? this.data.MEETING.HIDE_GUESTS\n\t\t\t: true;\n\t}\n\n\tgetRrule()\n\t{\n\t\treturn this.data.RRULE;\n\t}\n\n\tgetRRuleDescription()\n\t{\n\t\treturn this.data['~RRULE_DESCRIPTION'];\n\t}\n\n\thasRecurrenceId()\n\t{\n\t\treturn this.data.RECURRENCE_ID;\n\t}\n\n\twasEverRecursive()\n\t{\n\t\treturn this.data.RRULE || this.data.RECURRENCE_ID;\n\t}\n\n\tdeselect()\n\t{\n\t\tthis.selected = false;\n\t}\n\n\tselect()\n\t{\n\t\tthis.selected = true;\n\t}\n\n\tdeleteParts(recursionMode)\n\t{\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tconst wrap = calendarContext.getView().getContainer();\n\n\t\t\tif (recursionMode === 'all')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif (parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'next')\n\t\t\t{\n\t\t\t\tcalendarContext.getView().entries.forEach((entry) => {\n\t\t\t\t\tif ((parseInt(entry.id) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === this.id\n\t\t\t\t\t\t|| parseInt(entry.data.RECURRENCE_ID) === parseInt(this.data.RECURRENCE_ID)\n\t\t\t\t\t\t|| parseInt(entry.id) === parseInt(this.data.RECURRENCE_ID))\n\t\t\t\t\t\t&& entry.from.getTime() > this.from.getTime()\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst entryPart = wrap.querySelector('div[data-bx-calendar-entry=\"' + entry.uid + '\"]');\n\t\t\t\t\t\tif (entryPart)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (recursionMode === 'this' || !recursionMode)\n\t\t\t{\n\t\t\t\tconst parts = wrap.querySelectorAll('div[data-bx-calendar-entry=\"' + this.getUniqueId() + '\"]');\n\t\t\t\tparts.forEach((entryPart)=>{\n\t\t\t\t\tentryPart.style.opacity = 0;\n\t\t\t\t\tsetTimeout(()=>{entryPart.style.display = 'none';}, 200);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tgetUniqueId()\n\t{\n\t\treturn EntryManager.getEntryUniqueId(this.data, this);\n\t}\n\n\tgetCurrentStatus()\n\t{\n\t\tlet\n\t\t\tuserId = Util.getCurrentUserId(),\n\t\t\tstatus = false,\n\t\t\ti, user;\n\n\t\tif (this.isMeeting())\n\t\t{\n\t\t\tif (userId === parseInt(this.data.CREATED_BY))\n\t\t\t{\n\t\t\t\tstatus = this.data.MEETING_STATUS || 'Q';\n\t\t\t}\n\t\t\telse if (userId === parseInt(this.data.MEETING_HOST))\n\t\t\t{\n\t\t\t\tstatus = 'H';\n\t\t\t\t//status = this.data.MEETING_STATUS || 'H';\n\t\t\t}\n\t\t\telse if (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tuser = this.data['ATTENDEE_LIST'][i];\n\t\t\t\t\tif (parseInt(user.id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus = user.status;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (userId === parseInt(this.data.CREATED_BY))\n\t\t{\n\t\t\tstatus = this.data.MEETING_STATUS || 'H';\n\t\t}\n\n\t\treturn Util.getMeetingStatusList().includes(status) ? status : false;\n\t}\n\n\tsetCurrentStatus(status)\n\t{\n\t\tif (this.isMeeting() && Util.getMeetingStatusList().includes(status))\n\t\t{\n\t\t\tthis.data.MEETING_STATUS = status;\n\n\t\t\tconst userId = Util.getCurrentUserId();\n\t\t\tif (Type.isArray(this.data['ATTENDEE_LIST']))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < this.data['ATTENDEE_LIST'].length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (parseInt(this.data['ATTENDEE_LIST'][i].id) === userId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.data['ATTENDEE_LIST'][i].status = status;\n\t\t\t\t\t\tthis.attendeeList = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetReminders()\n\t{\n\t\tlet res = [];\n\t\tif (this.data && this.data.REMIND)\n\t\t{\n\t\t\tthis.data.REMIND.forEach(function (remind)\n\t\t\t{\n\t\t\t\tswitch(remind.type)\n\t\t\t\t{\n\t\t\t\t\tcase 'min':\n\t\t\t\t\t\tres.push(remind.count);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'hour':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'day':\n\t\t\t\t\t\tres.push(parseInt(remind.count) * 60 * 24);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'daybefore':\n\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'date':\n\t\t\t\t\t\tif (!Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tremind.value = Util.parseDate(remind.value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Type.isDate(remind.value))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tres.push(remind);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn res;\n\t}\n\n\tgetLengthInDays()\n\t{\n\t\tlet\n\t\t\tfrom = new Date(this.from.getFullYear(), this.from.getMonth(), this.from.getDate(), 0, 0, 0),\n\t\t\tto = new Date(this.to.getFullYear(), this.to.getMonth(), this.to.getDate(), 0, 0, 0);\n\n\t\treturn Math.round((to.getTime() - from.getTime()) / Util.getDayLength()) + 1;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn (this.name || '');\n\t}\n\n\tgetColor()\n\t{\n\t\treturn this.data.COLOR;\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.data.CAL_TYPE;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this.data.OWNER_ID;\n\t}\n\n\tdelete(params)\n\t{\n\t\tparams = Type.isPlainObject(params) ? params : {};\n\t\tlet recursionMode = params.recursionMode || false;\n\n\t\tif (this.wasEverRecursive() && !params.confirmed)\n\t\t{\n\t\t\treturn this.showConfirmDeleteDialog({entry: this});\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// Broadcast event\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode, entryData: this.data}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'deleteCalendarEntry';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: params.recursionMode || false,\n\t\t\t\trequestUid: Util.registerRequestId(),\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [{entryId: this.id, recursionMode: recursionMode}]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteThis()\n\t{\n\t\tlet recursionMode = 'this';\n\t\tif (this.isRecursive())\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode, entryData: this.data}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst action = 'excludeRecursionDate';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\texcludeDate: this.data.DATE_FROM,\n\t\t\t};\n\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t\telse if (this.hasRecurrenceId())\n\t\t{\n\t\t\tthis.delete({confirmed: true, recursionMode: 'this'});\n\t\t}\n\t}\n\n\tdeleteNext()\n\t{\n\t\tlet recursionMode = 'next';\n\t\tif (this.isRecursive() && this.isFirstReccurentEntry())\n\t\t{\n\t\t\tthis.deleteAll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.onCustomEvent('BX.Calendar.Entry:beforeDelete', [{entryId: this.id, recursionMode: recursionMode}]);\n\n\t\t\tEntryManager.showDeleteEntryNotification(this);\n\t\t\tthis.deleteParts(recursionMode);\n\n\t\t\tconst calendarContext = Util.getCalendarContext();\n\t\t\tif (calendarContext)\n\t\t\t{\n\n\t\t\t}\n\n\t\t\tconst action = 'changeRecurciveEntryUntil';\n\t\t\tconst data = {\n\t\t\t\tentryId: this.id,\n\t\t\t\trecursionMode: recursionMode,\n\t\t\t\tuntilDate: Util.formatDate(this.from.getTime() - Util.getDayLength()),\n\t\t\t};\n\t\t\tEntryManager.registerDeleteTimeout({\n\t\t\t\taction,\n\t\t\t\tdata,\n\t\t\t\tparams: {\n\t\t\t\t\tentry: this,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:delete', [data]);\n\t\t\t\t\t}\n\t\t\t\t}});\n\n\t\t\tthis.deleteTimeout = setTimeout(EntryManager.doDelayedActions, EntryManager.DELETE_DELAY_TIMEOUT);\n\t\t\tthis.delayTimeoutMap.set(this.deleteTimeout, {action, data});\n\t\t}\n\t}\n\n\tdeleteAll()\n\t{\n\t\treturn this.delete({confirmed: true, recursionMode: 'all'});\n\t}\n\n\tcancelDelete()\n\t{\n\t\tif (this.deleteTimeout)\n\t\t{\n\t\t\tconst deleteTimeoutData = this.delayTimeoutMap.get(this.deleteTimeout);\n\t\t\tif (deleteTimeoutData)\n\t\t\t{\n\t\t\t\tEntryManager.unregisterDeleteTimeout(deleteTimeoutData);\n\t\t\t\tBX.onCustomEvent('BX.Calendar.Entry:cancelDelete', [{entryId: this.id, entryData: this.data}]);\n\t\t\t\tthis.delayTimeoutMap.delete(this.delayTimeoutMap);\n\t\t\t}\n\t\t\tclearTimeout(this.deleteTimeout);\n\t\t\tthis.deleteTimeout = null;\n\t\t}\n\n\t\tconst calendarContext = Util.getCalendarContext();\n\t\tif (calendarContext)\n\t\t{\n\t\t\tcalendarContext.reload();\n\t\t}\n\t}\n\n\tshowConfirmDeleteDialog(params)\n\t{\n\t\tif (!this.confirmDeleteDialog)\n\t\t{\n\t\t\tthis.confirmDeleteDialog = new (window.BX || window.top.BX).Calendar.Controls\n\t\t\t\t.ConfirmDeleteDialog({entry: params.entry});\n\t\t}\n\t\tthis.confirmDeleteDialog.show();\n\t}\n\n\tsave()\n\t{\n\t}\n\n\tgetLocation()\n\t{\n\t\treturn this.data.LOCATION;\n\t}\n\n\tsetTimezone(timezoneFrom, timezoneTo = null)\n\t{\n\t\tif(Type.isString(timezoneFrom))\n\t\t{\n\t\t\tthis.data.TZ_FROM = timezoneFrom;\n\t\t\tif (Type.isNull(timezoneTo))\n\t\t\t{\n\t\t\t\tthis.data.TZ_TO = timezoneFrom;\n\t\t\t}\n\t\t}\n\t\tif(Type.isString(timezoneTo))\n\t\t{\n\t\t\tthis.data.TZ_TO = timezoneTo;\n\t\t}\n\t}\n\n\tgetTimezoneFrom()\n\t{\n\t\treturn this.data.TZ_FROM || '';\n\t}\n\n\tgetTimezoneTo()\n\t{\n\t\treturn this.data.TZ_TO || '';\n\t}\n\n\tsetSectionId(value)\n\t{\n\t\tthis.data.SECT_ID = this.sectionId = this.isTask() ? 'tasks' : parseInt(value);\n\t}\n\n\tsetDateTimeValue({from, to})\n\t{\n\t\tif (Type.isDate(from) && Type.isDate(to))\n\t\t{\n\t\t\tthis.from = this.data.dateFrom = from;\n\t\t\tthis.to = this.data.dateTo = to;\n\n\t\t\tthis.data.DT_LENGTH = Math.round((this.to.getTime() - this.from.getTime()) / 1000);\n\t\t\tthis.data.DURATION = this.data.DT_LENGTH;\n\n\t\t\tif (this.fullDay)\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDate(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDate(this.to.getTime());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.data.DATE_FROM = Util.formatDateTime(this.from.getTime());\n\t\t\t\tthis.data.DATE_TO = Util.formatDateTime(this.to.getTime());\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["EntryManager","getNewEntry","options","newEntryData","dateTime","getNewEntryTime","Date","userSettings","Util","getUserSettings","userId","getCurrentUserId","ID","NAME","getNewEntryName","dateFrom","from","dateTo","to","type","SECT_ID","RoomsManager","getNewEntrySectionId","parseInt","ownerId","SectionManager","REMIND","getNewEntryReminders","attendeesEntityList","entityId","id","ATTENDEE_LIST","status","push","TZ_FROM","timezoneName","timezoneDefaultName","TZ_TO","Entry","data","date","duration","getUsableDateTime","calendarContext","getCalendarContext","displayedViewRange","getDisplayedViewRange","Type","isDate","start","getTime","end","startDate","workTime","util","getWorkTime","setHours","newEntryName","setNewEntryName","showEditEntryNotification","entryId","showNotification","Loc","getMessage","title","events","click","event","balloon","action","openViewSlider","close","showNewEntryNotification","showDeleteEntryNotification","entry","BX","UI","Notification","Center","notify","getUniqueId","content","actions","cancelDelete","showReleaseLocationNotification","closeDeleteNotificationBalloon","getBalloonById","openEditSlider","bx","getBX","Calendar","SliderLoader","isLocationCalendar","roomsManager","locationAccess","dayOfWeekMonthFormat","locationCapacity","formDataValue","show","eventId","isNull","entryDateFrom","timezoneOffset","link","deleteEntry","slider","SidePanel","Instance","getTopSlider","beforeDeleteHandler","EventEmitter","subscribe","deleteHandler","calendar","reload","unsubscribe","delete","setMeetingStatus","params","Promise","resolve","isPlainObject","recursionMode","confirmed","isRecursive","showConfirmStatusDialog","ajax","runAction","entryParentId","parentId","currentDateFrom","formatDate","then","response","Event","emit","BaseEvent","counters","setCurrentStatus","resolvePromiseCallback","confirmDeclineDialog","createConfirmStatusDialog","unsubscribeAll","isFunction","getData","showConfirmEditDialog","confirmEditDialog","createConfirmEditDialog","callback","showReInviteUsersDialog","reinviteUsersDialog","createReinviteUserDialog","showConfirmedEmailDialog","confirmedEmailDialog","createConfirmedEmailDialog","showEmailLimitationDialog","limitationEmailDialog","createEmailLimitationDialog","getCompactViewForm","create","compactEntryForm","CompactEventForm","openCompactViewForm","compactForm","isShown","closeCallback","showInViewMode","openCompactEditForm","showInEditMode","getEntryInstance","userIndex","entryInstance","isObject","getUserIndex","setUserIndex","handlePullChanges","checkRequestId","requestUid","handlePull","getOpenSliders","forEach","slidersMap","get","fields","PARENT_ID","command","getType","CAL_TYPE","top","IS_MEETING","MEETING_STATUS","Controls","Location","entrySectionId","SECTION_ID","sectionDisplayed","isArray","sections","find","section","loadedEntry","getView","getEntryById","getEntryUniqueId","reloadDebounce","registerDeleteTimeout","delayedActionList","unregisterDeleteTimeout","filter","item","excludeDate","doDelayedActions","requestList","length","uid","entryData","sid","RRULE","parseDate","DATE_FROM","registerEntrySlider","control","set","isObjectLike","defaultReminders","count","before","time","setNewEntryReminders","reminders","setUserSettings","ConfirmEditDialog","ConfirmStatusDialog","ReinviteUserDialog","ConfirmedEmailDialog","EmailLimitationDialog","DELETE_DELAY_TIMEOUT","WeakMap","constructor","FULL_DAY_LENGTH","prepareData","parts","delayTimeoutMap","Map","DT_SKIP_TIME","SKIP_TIME","fullDay","accessibility","ACCESSIBILITY","important","IMPORTANCE","private","PRIVATE_EVENT","setSectionId","name","userTimezoneOffsetFrom","userTimezoneOffsetTo","DT_LENGTH","DURATION","isString","DATE_TO","Math","round","isTask","ATTENDEES_CODES","OWNER_ID","CREATED_BY","startDayCode","endDayCode","remind","value","permissions","getAttendeesCodes","getAttendeesEntityList","getAttendees","attendeeList","user","attendee","clone","STATUS","ENTRY_ID","cleanParts","startPart","part","partIndex","registerPartNode","checkPartIsRegistered","getPart","getWrap","wrapNode","getSectionName","getDescription","DESCRIPTION","applyViewRange","viewRange","viewRangeStart","viewRangeEnd","fromTime","toTime","displayFrom","displayTo","isPersonal","isMeeting","isPrivate","isResourcebooking","EVENT_TYPE","isSharingEvent","isInvited","getCurrentStatus","isLocation","isFullDay","isLongWithTime","getDayCode","isExpired","hasEmailAttendees","emailAttendeesCache","undefined","i","EMAIL_USER","ownerIsEmailUser","ownerIsEmailUserCache","MEETING_HOST","isSelected","selected","isCrm","UF_CRM_CAL_EVENT","isFirstReccurentEntry","DATE_FROM_TS_UTC","floor","RECURRENCE_ID","isFirstInstance","RINDEX","getMeetingHost","getMeetingNotify","MEETING","NOTIFY","getHideGuests","isBoolean","HIDE_GUESTS","getRrule","getRRuleDescription","hasRecurrenceId","wasEverRecursive","deselect","select","deleteParts","wrap","getContainer","entries","entryPart","querySelector","style","opacity","setTimeout","display","querySelectorAll","getMeetingStatusList","includes","getReminders","res","getLengthInDays","getFullYear","getMonth","getDate","getDayLength","getName","getColor","COLOR","getOwnerId","showConfirmDeleteDialog","onCustomEvent","registerRequestId","deleteTimeout","deleteThis","deleteNext","deleteAll","untilDate","deleteTimeoutData","clearTimeout","confirmDeleteDialog","window","ConfirmDeleteDialog","save","getLocation","LOCATION","setTimezone","timezoneFrom","timezoneTo","getTimezoneFrom","getTimezoneTo","sectionId","setDateTimeValue","formatDateTime","CAL_TYPES"],"mappings":"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"}