{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, Type, Loc, ajax, Runtime } from 'main.core';\nimport { UI } from 'ui.notification';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass WorkflowInstances\n{\n\t#gridId;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.#gridId = options.gridId;\n\t\t}\n\t}\n\n\tdeleteItem(workflowId)\n\t{\n\t\tconst messageBox = new MessageBox({\n\t\t\tmessage: Loc.getMessage('BPWI_DELETE_MESS_CONFIRM'),\n\t\t\tokCaption: Loc.getMessage('BPWI_DELETE_BTN_LABEL'),\n\t\t\tonOk: () => {\n\t\t\t\tthis.#removeGridRow(workflowId);\n\t\t\t\tthis.#showNotification({\n\t\t\t\t\tcontent: Loc.getMessage('BPWIT_DELETE_NOTIFICATION'),\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterShow: (event) => {\n\t\t\t\t\t\tconst okBtn = event.getTarget().getButton('ok');\n\t\t\t\t\t\tif (okBtn)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tokBtn.getContainer().focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tmessageBox.show();\n\t}\n\n\t#getGrid()\n\t{\n\t\tif (this.#gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.#gridId);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#removeGridRow(workflowId: string): void\n\t{\n\t\tconst grid = this.#getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tgrid.removeRow(workflowId);\n\t\t}\n\t}\n\n\tterminateItem(workflowId: string): void\n\t{\n\t\tajax.runAction('bizproc.workflow.terminate', { data: { workflowId } })\n\t\t\t.then(() => {\n\t\t\t\tthis.#removeGridRow(workflowId);\n\t\t\t\tthis.#showNotification({\n\t\t\t\t\tcontent: Loc.getMessage('BPWIT_TERMINATE_NOTIFICATION'),\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\tthis.#showNotification({ content: error.message });\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tlogItem(workflowId: string): void\n\t{\n\t\tRuntime\n\t\t\t.loadExtension('bizproc.router')\n\t\t\t.then(({ Router }) => {\n\t\t\t\tRouter.openWorkflowLog(workflowId);\n\t\t\t})\n\t\t\t.catch((e) => console.error(e));\n\t}\n\n\t#showNotification(notificationOptions: Object): void\n\t{\n\t\tconst defaultSettings = { autoHideDelay: 5000 };\n\n\t\tUI.Notification.Center.notify(Object.assign(defaultSettings, notificationOptions));\n\t}\n}\n\nnamespace.WorkflowInstances = WorkflowInstances;\n"],"names":["namespace","Reflection","WorkflowInstances","options","Type","isPlainObject","gridId","workflowId","messageBox","MessageBox","message","Loc","getMessage","okCaption","onOk","content","buttons","MessageBoxButtons","OK_CANCEL","popupOptions","events","onAfterShow","event","okBtn","getTarget","getButton","getContainer","focus","show","ajax","runAction","data","then","response","errors","forEach","error","Runtime","loadExtension","Router","openWorkflowLog","e","console","BX","Main","gridManager","getInstanceById","grid","removeRow","notificationOptions","defaultSettings","autoHideDelay","UI","Notification","Center","notify","Object","assign"],"mappings":"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"}