{"version":3,"file":"sectioninterface.bundle.js","sources":["../src/editform.js","../src/trackingusersform.js","../src/trackinggroupsform.js","../src/trackingtypesform.js","../src/sectioninterface.js"],"sourcesContent":["import { Runtime, Dom, Event, Loc, Text, Type, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog as EntitySelectorDialog} from 'ui.entity-selector';\n\n\nexport class EditForm extends EventEmitter\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface.EditForm');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.sectionAccessTasks = options.sectionAccessTasks;\n\t\tthis.sectionManager = options.sectionManager;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.section = params.section;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = '';\n\t\t\tthis.DOM.accessWrap.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = 'none';\n\t\t\tthis.DOM.accessWrap.style.display = 'none';\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.section)\n\t\t{\n\t\t\tif (params.section.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.section.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.section.access || params.section.data.ACCESS || {});\n\n\t\t\tif (params.section.name)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.value = params.section.name;\n\t\t\t}\n\t\t}\n\n\t\tBX.focus(this.DOM.sectionTitleInput);\n\t\tif (this.DOM.sectionTitleInput.value !== '')\n\t\t{\n\t\t\tthis.DOM.sectionTitleInput.select();\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-form-content'}}));\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(\n\t\t\t\tDom.create(\n\t\t\t\t\t'DIV',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content-block'}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.sectionTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-field-container calendar-field-container-string'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-field-block'}}))\n\t\t\t.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {type: 'text', placeholder: Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')},\n\t\t\t\tprops: {className: 'calendar-field calendar-field-string'}\n\t\t\t}));\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-new-calendar-options-container'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-btn-container'}}));\n\n\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\tevents: {click: this.save.bind(this)}\n\t\t});\n\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: {click: this.checkClose.bind(this)}\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckClose()\n\t{\n\t\tthis.close();\n\t}\n\n\tsave()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.sectionManager.saveSection(\n\t\t\tthis.DOM.sectionTitleInput.value,\n\t\t\tthis.color,\n\t\t\tthis.access,\n\t\t\t{section: this.section}\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitSectionColorSelector()\n\t{\n\t\tthis.DOM.colorContWrap = this.DOM.optionsWrap.appendChild(Dom.create('DIV', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_COLOR')\n\t\t}));\n\t\tthis.colorIcon = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-selected' }\n\t\t}));\n\t\tthis.colorChangeLink = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-change' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_CHANGE')\n\t\t}));\n\t\t\n\t\tEvent.bind(this.colorIcon, 'click', this.showSimplePicker.bind(this));\n\t\tEvent.bind(this.colorChangeLink, 'click', this.showSimplePicker.bind(this));\n\t}\n\n\tshowSimplePicker(value)\n\t{\n\t\tconst colors = Runtime.clone(Util.getDefaultColorList(), true);\n\t\tconst innerCont = Dom.create(\n\t\t\t'DIV',\n\t\t\t{\n\t\t\t\tprops: {className: 'calendar-simple-color-wrap calendar-field-container-colorpicker-square'}\n\t\t\t}\n\t\t);\n\t\tconst colorWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\t\tevents: {click: BX.delegate(this.simplePickerClick, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLinkWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link-wrap'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLink = moreLinkWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'SPAN',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link'},\n\t\t\t\t\thtml: Loc.getMessage('EC_COLOR'),\n\t\t\t\t\tevents: {click: BX.delegate(this.showFullPicker, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.simplePickerColorWrap = colorWrap;\n\t\tthis.colors = [];\n\n\t\tif (!colors.includes(this.color))\n\t\t{\n\t\t\tcolors.push(this.color);\n\t\t}\n\n\t\tfor (let i = 0; i < colors.length; i++)\n\t\t{\n\t\t\tthis.colors.push({\n\t\t\t\tcolor: colors[i],\n\t\t\t\tnode: colorWrap.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-field-colorpicker-color-item'},\n\t\t\t\t\tstyle: {backgroundColor: colors[i]},\n\t\t\t\t\tattrs: {'data-bx-calendar-color': colors[i]},\n\t\t\t\t\thtml: '<span class=\"calendar-field-colorpicker-color\"></span>'\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\n\t\tthis.lastActiveNode = this.colors[BX.util.array_search(this.color, colors) || 0].node;\n\t\tDom.addClass(this.lastActiveNode, 'active');\n\n\t\tthis.simpleColorPopup = BX.PopupWindowManager.create(\n\t\t\t\"simple-color-popup-\" + Util.getRandomInt(),\n\t\t\tthis.colorIcon,\n\t\t\t{\n\t\t\t\t//zIndex: this.zIndex,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 9,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: innerCont,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.simpleColorPopup.setAngle({offset: 10});\n\t\tthis.simpleColorPopup.show(true);\n\t}\n\n\tsimplePickerClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tconst value = target.getAttribute('data-bx-calendar-color');\n\t\t\tif(value !== null)\n\t\t\t{\n\t\t\t\tif (this.lastActiveNode)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.lastActiveNode, 'active');\n\t\t\t\t}\n\n\t\t\t\tDom.addClass(target, 'active');\n\t\t\t\tthis.lastActiveNode = target;\n\t\t\t\tthis.setColor(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFullPicker()\n\t{\n\t\tif (this.simpleColorPopup)\n\t\t{\n\t\t\tthis.simpleColorPopup.close();\n\t\t}\n\n\t\tif (!this.fullColorPicker)\n\t\t{\n\t\t\tthis.fullColorPicker = new BX.ColorPicker({\n\t\t\t\tbindElement: this.colorIcon,\n\t\t\t\tonColorSelected: BX.delegate(function(color){\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t}, this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose:BX.delegate(function(){\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.fullColorPicker.open();\n\t}\n\n\tsetColor(value)\n\t{\n\t\tthis.colorIcon.style.backgroundColor = value;\n\t\tthis.color = value;\n\t}\n\n\tsetAccess(value)\n\t{\n\t\tlet rowsCount = 0;\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\trowsCount++;\n\t\t\t}\n\t\t}\n\t\tthis.accessRowsCount = rowsCount;\n\t\tthis.access = value;\n\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\tthis.insertAccessRow(Util.getAccessName(code), code, value[code]);\n\t\t\t}\n\t\t}\n\t\tthis.checkAccessTableHeight();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tif (this.sectionManager && this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\tthis.initDialogGroup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initDialogStandard();\n\t\t}\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tinitAccessSelectorPopup()\n\t{\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\n\t\t\t\t\t\t\t\t\t\t\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildAccessController()\n\t{\n\t\tthis.DOM.accessLink = this.DOM.optionsWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-new-calendar-option-more\">${Loc.getMessage('EC_SEC_SLIDER_ACCESS')}</div>`,\n\t\t);\n\n\t\tthis.DOM.accessWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\"></table>\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,\n\t\t);\n\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.sectionAccessTasks;\n\n\t\tEvent.bind(this.DOM.accessLink, 'click', () => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\tthis.checkAccessTableHeight();\n\t\t});\n\t}\n\n\tinitDialogStandard()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\tinitDialogGroup()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'groupAccess',\n\t\t\t\t\t\ttitle: this.sectionManager.ownerName,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'A',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_ADMIN'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'E',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MODERATORS'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'K',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MEMBERS'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tlet title;\n\t\t\t\tif (entity.entityId === 'group')\n\t\t\t\t{\n\t\t\t\t\ttitle = this.sectionManager.ownerName + ': ' + entity.title.text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = entity.title.text;\n\t\t\t\t}\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\t// todo: refactor it\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor(let taskId in this.sectionAccessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.sectionAccessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.sectionAccessTasks[taskId].name === 'calendar_view'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst\n\t\t\t\trowNode = Dom.adjust(this.DOM.accessTable.insertRow(-1), {props : {className: 'calendar-section-slider-access-table-row'}}),\n\t\t\t\ttitleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\thtml: '<span class=\"calendar-section-slider-access-title\">' + Text.encode(title) + ':</span>'}),\n\t\t\t\tvalueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-selector': code}\n\t\t\t\t}),\n\t\t\t\tselectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-container'}\n\t\t\t\t})),\n\t\t\t\tvalueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-value'}\n\t\t\t\t})),\n\t\t\t\tremoveIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-remove'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-remove': code}\n\t\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode: rowNode,\n\t\t\t\ttitleNode: titleNode,\n\t\t\t\tvalueNode: valueNode,\n\t\t\t\tremoveIcon: removeIcon\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = parseInt(this.DOM.accessTable.offsetHeight) + 100 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor(let taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function (value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(taskId)\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t'section-access-popup' + Util.randomInt(),\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Runtime, Dom, Event, Loc, Type, Tag, Text} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\nimport { Dialog, TagSelector } from 'ui.entity-selector';\n\nexport class TrackingUsersForm\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.trackingUsers = options.trackingUsers || [];\n\t\tthis.trackingUserIdList = this.trackingUsers.map((item) => {\n\t\t\treturn parseInt(item.ID)\n\t\t});\n\n\t\tthis.CHECKED_CLASS = 'calendar-list-slider-item-checkbox-checked';\n\t\tthis.selectorId = 'add-tracking' + Util.getRandomInt();\n\t\tthis.closeCallback = options.closeCallback;\n\n\t\tthis.superposedSections = Type.isArray(options.superposedSections) ? options.superposedSections : [];\n\t\tthis.selected = {};\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tthis.selected[section.id] = true;\n\t\t}, this);\n\n\t\tthis.isCreated = false;\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t\tthis.checkInnerWrapHeight();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.updateSectionList();\n\n\t\tthis.firstTrackingUserIdList = Runtime.clone(this.trackingUserIdList);\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.isOpenedState = false;\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\t\tthis.DOM.outerWrap.style.cssText = '';\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } })\n\t\t);\n\n\t\tthis.userTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingUsers.map((item) => {\n\t\t\t\t\treturn ['user', parseInt(item.ID)]\n\t\t\t\t}),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tthis.userTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tcreateButtons()\n\t{\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-btn-container\">\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\tonclick=\"${this.save.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_SAVE')}</button>\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-link\"\n\t\t\t\t\tonclick=\"${this.close.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_CANCEL')}</button>\n\t\t\t</div>`\n\t\t);\n\t}\n\n\thandleUserSelectorChanges()\n\t{\n\t\tconst selectedItems = this.userTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingUserIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\tthis.trackingUserIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t\t\ttype: 'users'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.close();\n\t}\n\n\tprepareTrackingSections()\n\t{\n\t\tlet sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tsections.push(parseInt(section.id));\n\t\t}, this);\n\n\t\tfor (let id in this.sectionIndex)\n\t\t{\n\t\t\tif (this.sectionIndex.hasOwnProperty(id) && this.sectionIndex[id].checkbox)\n\t\t\t{\n\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t{\n\t\t\t\t\tif (!sections.includes(parseInt(id)))\n\t\t\t\t\t{\n\t\t\t\t\t\tsections.push(parseInt(id));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (sections.includes(parseInt(id)))\n\t\t\t\t{\n\t\t\t\t\tsections = sections.filter((section) => {return parseInt(section) !== parseInt(id)});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sections;\n\t}\n\n\tupdateSectionList(delayExecution)\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tif (delayExecution !== false)\n\t\t{\n\t\t\tthis.updateSectionTimeout = setTimeout(() => {\n\t\t\t\tthis.updateSectionList(false);\n\t\t\t}, 300);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\t\ttype: 'users'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t// Success\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\t// Users calendars\n\t\t\t\t\tresponse.data.users.forEach((user) => {\n\t\t\t\t\t\tconst sections = response.data.sections.filter(function(section)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn parseInt(section.OWNER_ID) === parseInt(user.ID);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t${Text.encode(user.FORMATTED_NAME)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);\n\n\t\t\t\t\t\tif (sections.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\t\tsectionList: sections,\n\t\t\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tcreateSectionBlock(params = {})\n\t{\n\t\tlet result = false;\n\t\tif (Type.isArray(params.sectionList) && params.sectionList.length\n\t\t\t&& Type.isElementNode(params.wrap))\n\t\t{\n\t\t\tlet listWrap;\n\t\t\tparams.wrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${listWrap = Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tEvent.bind(listWrap, 'click', this.sectionClick.bind(this));\n\n\t\t\tparams.sectionList.forEach((section) => {\n\t\t\t\tconst id = section.ID.toString();\n\t\t\t\tlet checkbox;\n\n\t\t\t\tconst li = listWrap.appendChild(Tag.render`\n\t\t\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${id}\">\n\t\t\t\t\t\t${checkbox = Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-list-slider-item-checkbox\" style=\"background: ${section.COLOR}\"></div>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t<div class=\"calendar-list-slider-item-name\">${Text.encode(section.NAME)}</div>\n\t\t\t\t\t</li>\n\t\t\t\t`);\n\n\t\t\t\tthis.sectionIndex[id] = {\n\t\t\t\t\titem: li,\n\t\t\t\t\tcheckbox: checkbox\n\t\t\t\t};\n\n\t\t\t\tif (\n\t\t\t\t\tthis.selected[id]\n\t\t\t\t\t|| !Type.isArray(this.firstTrackingUserIdList)\n\t\t\t\t\t|| !this.firstTrackingUserIdList.includes(parseInt(section.OWNER_ID))\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(checkbox, this.CHECKED_CLASS);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsectionClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tif(target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tconst id = target.getAttribute('data-bx-calendar-section');\n\t\t\t\tif (this.sectionIndex[id] && this.sectionIndex[id].checkbox)\n\t\t\t\t{\n\t\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckInnerWrapHeight()\n\t{\n\t\tif (this.checkHeightTimeout)\n\t\t{\n\t\t\tthis.checkHeightTimeout = clearTimeout(this.checkHeightTimeout);\n\t\t}\n\n\t\tthis.checkHeightTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.outerWrap, 'show'))\n\t\t\t{\n\t\t\t\tif (this.DOM.outerWrap.offsetHeight - this.DOM.innerWrap.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.outerWrap.style.maxHeight = parseInt(this.DOM.innerWrap.offsetHeight) + 200 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\nimport { TrackingUsersForm } from \"./trackingusersform\"\n\nexport class TrackingGroupsForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.trackingGroupIdList = options.trackingGroups || [];\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } })\n\t\t);\n\n\t\tthis.groupTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingGroupIdList.map((id) => {\n\t\t\t\t\treturn ['project', id];\n\t\t\t\t}),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tthis.groupTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\thandleGroupSelectorChanges()\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingGroupIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'project')\n\t\t\t{\n\t\t\t\tthis.trackingGroupIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tgroupIdList: this.trackingGroupIdList,\n\t\t\t\t\ttype: 'groups'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\t// Groups calendars\n\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {TrackingUsersForm} from \"./trackingusersform\"\n\nexport class TrackingTypesForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.trackingGroups = options.trackingGroups || [];\n\t\tthis.selectGroups = true;\n\t\tthis.selectUsers = false;\n\t\tthis.addLinkMessage = Loc.getMessage('EC_SEC_SLIDER_SELECT_GROUPS');\n\t}\n\n\tshow ()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tthis.updateSectionList();\n\t\tthis.isOpenedState = true;\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: 'company'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\tif (Type.isArray(response.data.sections)\n\t\t\t\t\t\t&& response.data.sections.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.checkInnerWrapHeight();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tsections: this.prepareTrackingSections()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.close();\n\t}\n}\n\n\n\n\n\n\n\n\n","// @flow\nimport {Util} from 'calendar.util';\nimport {Type, Event, Loc, Tag, Dom} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {MenuItem} from \"main.popup\";\nimport {EditForm} from \"./editform\"\nimport {TrackingUsersForm} from \"./trackingusersform\"\nimport {TrackingGroupsForm} from \"./trackinggroupsform\"\nimport {TrackingTypesForm} from \"./trackingtypesform\"\n\nexport class SectionInterface extends EventEmitter\n{\n\tname = 'sectioninterface';\n\tuid = null;\n\tDOM = {};\n\tSLIDER_WIDTH = 400;\n\tSLIDER_DURATION = 80;\n\tsliderId = \"calendar:section-slider\";\n\tdenyClose = false;\n\n\tconstructor({calendarContext, readonly, sectionManager})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface');\n\t\tthis.sectionManager = sectionManager;\n\t\tthis.calendarContext = calendarContext;\n\t\tthis.readonly = readonly;\n\t\tthis.BX = Util.getBX();\n\t\tthis.deleteSectionHandlerBinded = this.deleteSectionHandler.bind(this);\n\t\tthis.refreshSectionListBinded = this.refreshSectionList.bind(this);\n\n\t\tif(this.calendarContext !== null)\n\t\t{\n\t\t\tif (this.calendarContext.util.config.accessNames)\n\t\t\t{\n\t\t\t\tUtil.setAccessNames(this.calendarContext?.util?.config?.accessNames);\n\t\t\t}\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION,\n\t\t\tevents: {\n\t\t\t\tonCloseByEsc: this.escHide.bind(this),\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tthis.addEventEmitterSubscriptions();\n\t}\n\n\taddEventEmitterSubscriptions()\n\t{\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded);\n\t\tUtil.getBX().Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-edit',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t}\n\n\tdestroyEventEmitterSubscriptions()\n\t{\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t\tUtil.getBX().Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-edit',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t}\n\n\tescHide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId && this.denyClose)\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.closeForms();\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:delete', this.deleteSectionHandlerBinded);\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:pull-delete', this.deleteSectionHandlerBinded);\n\n\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.sectionListWrap;\n\n\t\t\tif (this.sectionActionMenu)\n\t\t\t{\n\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t}\n\t\t\tif (this.trackingTypesForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingTypesForm;\n\t\t\t}\n\t\t\tif (this.trackingUsersForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingUsersForm;\n\t\t\t}\n\t\t\tif (this.trackingGroupsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingGroupsForm;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\tthis.DOM.outerWrap = Tag.render`\n\t\t\t<div class=\"calendar-list-slider-wrap\"></div>\n\t\t`;\n\t\tthis.DOM.titleWrap = this.DOM.outerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-title-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-title\"> \n\t\t\t\t\t\t${Loc.getMessage('EC_SECTION_BUTTON')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext && !this.readonly)\n\t\t{\n\t\t\tthis.DOM.sectionFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tcalendarContext\n\t\t\t&& !this.readonly\n\t\t\t&&\n\t\t\t(\n\t\t\t\t!calendarContext.util.isUserCalendar()\n\t\t\t\t|| calendarContext.util.userIsOwner()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t// #1. Controls\n\t\t\tthis.createAddButton();\n\n\t\t\t// #2. Forms\n\t\t\tthis.DOM.trackingGroupsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t`\n\t\t\t);\n\t\t\tthis.DOM.trackingUsersFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t\tthis.DOM.trackingTypesFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\t// #3. List of sections\n\t\tthis.createSectionList();\n\n\t\treturn this.DOM.outerWrap;\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tthis.slider = event.getSlider();\n\t\tthis.sliderId = this.slider.getUrl();\n\t\tthis.DOM.content = this.slider.layout.content;\n\t}\n\n\tcreateSectionList()\n\t{\n\t\tlet title;\n\t\tthis.sliderSections = this.sectionManager.getSections();\n\t\tconst type = this.sectionManager.calendarType;\n\n\t\tif (type === 'user')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t}\n\t\telse if (type === 'group')\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_CALENDARS_LIST');\n\t\t}\n\n\t\tif (this.DOM.sectionListWrap)\n\t\t{\n\t\t\tDom.clean(this.DOM.sectionListWrap);\n\t\t\tDom.adjust(this.DOM.sectionListWrap, {\n\t\t\t\tprops: {className: 'calendar-list-slider-card-widget'},\n\t\t\t\thtml: `\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t${title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.sectionListWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-list-slider-card-widget'},\n\t\t\t\thtml: `\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t${title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t}));\n\t\t}\n\n\t\tthis.createSectionBlock({\n\t\t\twrap: this.DOM.sectionListWrap,\n\t\t\tsectionList: this.sliderSections.filter(function(section){\n\t\t\t\treturn section.belongsToView() || section.isPseudo();\n\t\t\t})\n\t\t});\n\n\t\t// Company calendar\n\t\tlet sections = this.sliderSections.filter(function(section)\n\t\t{\n\t\t\treturn section.isCompanyCalendar() && !section.belongsToView();\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.sectionListWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-list-slider-card-section-title'},\n\t\t\t\thtml: '<span class=\"calendar-list-slider-card-section-title-text\">' + Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL') + '</span>'\n\t\t\t}));\n\n\t\t\tthis.createSectionBlock({\n\t\t\t\twrap: this.DOM.sectionListWrap,\n\t\t\t\tsectionList: this.sliderSections.filter(function (section)\n\t\t\t\t{\n\t\t\t\t\treturn section.isCompanyCalendar();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\n\t\t// Users calendars\n\t\tthis.calendarContext.util.getSuperposedTrackedUsers().forEach((user) => {\n\t\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\t\treturn !section.belongsToView()\n\t\t\t\t\t&& section.type === 'user'\n\t\t\t\t\t&& section.data.OWNER_ID === user.ID;\n\t\t\t});\n\n\t\t\tif (sections.length > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionListWrap.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: {className: 'calendar-list-slider-card-section-title'},\n\t\t\t\t\thtml: '<span class=\"calendar-list-slider-card-section-title-text\">' + BX.util.htmlspecialchars(user.FORMATTED_NAME) + '</span>'\n\t\t\t\t}));\n\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\twrap: this.DOM.sectionListWrap,\n\t\t\t\t\tsectionList: sections\n\t\t\t\t});\n\t\t\t}\n\t\t}, this);\n\n\t\t// Groups calendars\n\t\tsections = this.sliderSections.filter((section) => {\n\t\t\treturn !section.belongsToView() && section.type === 'group';\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.sectionListWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-list-slider-card-section-title'},\n\t\t\t\thtml: '<span class=\"calendar-list-slider-card-section-title-text\">' + Loc.getMessage('EC_SEC_SLIDER_TITLE_GROUP_CAL') + '</span>'\n\t\t\t}));\n\t\t\tthis.createSectionBlock({\n\t\t\t\twrap: this.DOM.sectionListWrap,\n\t\t\t\tsectionList: sections\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tif (\n\t\t\tthis.calendarContext.util.config.perm\n\t\t\t&& this.calendarContext.util.config.perm.edit_section\n\t\t)\n\t\t{\n\t\t\tconst addButtonOuter = this.DOM.titleWrap.appendChild(\n\t\t\t\tDom.create('SPAN',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'ui-btn-split ui-btn-light-border'},\n\t\t\t\t\t\tstyle: {marginRight: 0}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tthis.DOM.addButton = addButtonOuter.appendChild(Dom.create('SPAN', {props: {className: 'ui-btn-main'}, text: Loc.getMessage('EC_ADD')}));\n\t\t\tthis.DOM.addButtonMore = addButtonOuter.appendChild(Dom.create('SPAN', {props: {className: 'ui-btn-extra'}}));\n\n\t\t\tEvent.bind(this.DOM.addButtonMore, 'click', this.showAddButtonPopup.bind(this));\n\t\t\tEvent.bind(this.DOM.addButton, 'click', this.showEditSectionForm.bind(this));\n\t\t}\n\t}\n\n\tshowAddButtonPopup()\n\t{\n\t\tif (this.addBtnMenu && this.addBtnMenu.popupWindow && this.addBtnMenu.popupWindow.isShown())\n\t\t{\n\t\t\treturn this.addBtnMenu.close();\n\t\t}\n\n\t\tconst menuItems = [\n\t\t\t\tnew MenuItem({\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_TITLE'),\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}),\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_MENU'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showEditSectionForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnew MenuItem({\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_EXIST_TITLE'),\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}),\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingTypesForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingUsersForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingGroupsForm();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t];\n\n\t\tthis.addBtnMenu = this.BX.PopupMenu.create(\n\t\t\t'add-btn-' + Util.getRandomInt(),\n\t\t\tthis.DOM.addButtonMore,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\tzIndex: this.zIndex,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 15,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.addBtnMenu.show();\n\n\t\t//Dom.addClass(_this.sectionField.select, 'active');\n\t\t// this.denySliderClose();\n\n\t\t// top.BX.addCustomEvent(this.addBtnMenu.popupWindow, 'onPopupClose', function()\n\t\t// {\n\t\t// \t_this.allowSliderClose();\n\t\t// });\n\t}\n\n\tcreateSectionBlock({sectionList, wrap})\n\t{\n\t\tif (Type.isArray(sectionList))\n\t\t{\n\t\t\tconst listWrap = wrap.appendChild(\n\t\t\t\tDom.create('DIV', {props: {className: 'calendar-list-slider-widget-content'}}))\n\t\t\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-widget-content-block'}}))\n\t\t\t\t\t.appendChild(Dom.create('UL', {props: {className: 'calendar-list-slider-container'}}));\n\n\t\t\tEvent.bind(listWrap, 'click', this.sectionClickHandler.bind(this));\n\n\t\t\tsectionList.forEach((section) => {\n\n\t\t\t\tif (!section.DOM)\n\t\t\t\t{\n\t\t\t\t\tsection.DOM = {};\n\t\t\t\t}\n\n\t\t\t\tconst sectionId = section.id.toString();\n\t\t\t\tconst li = listWrap.appendChild(Dom.create('LI', {\n\t\t\t\t\tprops: {className: 'calendar-list-slider-item'},\n\t\t\t\t\tattrs: {'data-bx-calendar-section': sectionId}\n\t\t\t\t}));\n\n\t\t\t\tconst checkbox = li.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-list-slider-item-checkbox'\n\t\t\t\t\t\t\t+ (section.isShown() ? ' calendar-list-slider-item-checkbox-checked' : '')\n\t\t\t\t\t},\n\t\t\t\t\tstyle: {backgroundColor: section.color}\n\t\t\t\t}));\n\n\t\t\t\tconst title = li.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'calendar-list-slider-item-name',\n\t\t\t\t\t\ttitle: section.name,\n\t\t\t\t\t},\n\t\t\t\t\ttext: section.name\n\t\t\t\t}));\n\n\t\t\t\tsection.DOM.item = li;\n\t\t\t\tsection.DOM.checkbox = checkbox;\n\t\t\t\tsection.DOM.title = title;\n\n\t\t\t\tsection.DOM.actionCont = li.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: {className: 'calendar-list-slider-item-actions-container'},\n\t\t\t\t\tattrs: {'data-bx-calendar-section-menu': sectionId},\n\t\t\t\t\thtml: '<span class=\"calendar-list-slider-item-context-menu\"></span>'\n\t\t\t\t}));\n\t\t\t});\n\t\t}\n\t}\n\n\tsectionClickHandler(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\n\t\tif (target && target.getAttribute)\n\t\t{\n\t\t\tif (target.getAttribute('data-bx-calendar-section-menu') !== null)\n\t\t\t{\n\t\t\t\tlet sectionId = target.getAttribute('data-bx-calendar-section-menu');\n\t\t\t\tsectionId = sectionId === 'tasks' ? sectionId : parseInt(sectionId);\n\t\t\t\tthis.showSectionMenu(this.sectionManager.getSection(sectionId), target);\n\t\t\t}\n\t\t\telse if(target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tthis.switchSection(this.sectionManager.getSection(target.getAttribute('data-bx-calendar-section')));\n\t\t\t}\n\t\t}\n\t}\n\n\tfindCheckBoxNodes(id)\n\t{\n\t\treturn this.DOM.sectionListWrap.querySelectorAll(\n\t\t\t'.calendar-list-slider-item[data-bx-calendar-section=\\''\n\t\t\t+ id\n\t\t\t+ '\\'] .calendar-list-slider-item-checkbox'\n\t\t);\n\t}\n\n\tswitchSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id)\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\n\t\t// TODO: should use eventEmtter\n\t\tthis.calendarContext.reload();\n\t}\n\n\n\tswitchOnSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (!section.isShown())\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (!section.isShown())\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\t}\n\n\tswitchOffSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t}\n\n\n\tshowSectionMenu (section, menuItemNode)\n\t{\n\t\tconst menuItems = [];\n\t\tconst itemNode = menuItemNode.closest('[data-bx-calendar-section]');\n\t\tif (Type.isElementNode(itemNode))\n\t\t{\n\t\t\tDom.addClass(itemNode, 'active');\n\t\t}\n\n\t\tif(section.canDo('view_time'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_LEAVE_ONE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showOnlyOneSection(section, this.sectionManager.sections);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!section.isPseudo() && section.getLink() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_OPEN_LINK'),\n\t\t\t\thref: section.getLink()\n\t\t\t});\n\t\t}\n\n\t\tif (!this.readonly && section.canDo('edit_section') && !section.isPseudo())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({section: section});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (section.isSuperposed() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideSuperposedHandler(section);\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (section.canBeConnectedToOutlook())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_CONNECT_TO_OUTLOOK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.connectToOutlook();\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!section.isPseudo() && section.data.EXPORT && section.data.EXPORT.LINK)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXPORT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tconst options = {\n\t\t\t\t\t\tsectionLink: section.data.EXPORT.LINK,\n\t\t\t\t\t\tcalendarPath: this.calendarContext.util.config.path,\n\t\t\t\t\t};\n\t\t\t\t\tif (BX.Calendar.Sync.Interface.IcalSyncPopup.checkPathes(options))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Calendar.Sync.Interface.IcalSyncPopup.createInstance(options).show();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Calendar.Sync.Interface.IcalSyncPopup.showPopupWithPathesError();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tsection.canDo('edit_section')\n\t\t\t&& section.belongsToView()\n\t\t\t&& !section.isPseudo()\n\t\t\t&& (!section.isGoogle() || section.data['EXTERNAL_TYPE'] === 'local')\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_DELETE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.remove();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ((section.isGoogle() || section.isCalDav()) && section.canDo('edit_section'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_ACTION_REFRESH'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.calendarContext.reload({syncGoogle: true});\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif ((section.isGoogle() || section.isCalDav()) && section.canDo('edit_section'))\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext : Loc.getMessage('EC_ACTION_EXTERNAL_ADJUST'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tconst [provider, connection] = this.calendarContext.syncInterface.getProviderById(section.data.CAL_DAV_CON);\n\t\t\t\t\t\tif (provider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprovider.openActiveConnectionSlider(connection);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (section.data['EXTERNAL_TYPE'] !== 'local')\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tsection.hideGoogle();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (section.isPseudo())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({\n\t\t\t\t\t\tsection: section\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_TASK_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tBX.userOptions.save('calendar', 'user_settings', 'showTasks', 'N');\n\n\t\t\t\t\tDom.addClass(section.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tDom.clean(section.DOM.item, true);\n\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (menuItems && menuItems.length > 0)\n\t\t{\n\t\t\tthis.sectionActionMenu = top.BX.PopupMenu.create(\n\t\t\t\t'section-menu-' + Util.getRandomInt(),\n\t\t\t\tmenuItemNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc : true,\n\t\t\t\t\tautoHide : true,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 9,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: false\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.sectionActionMenu.show();\n\t\t\tthis.sectionActionMenu.popupWindow.subscribe('onClose', ()=>{\n\t\t\t\tif (Type.isElementNode(itemNode))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(itemNode, 'active');\n\t\t\t\t}\n\t\t\t\tthis.allowSliderClose();\n\t\t\t});\n\n\t\t\tthis.denySliderClose();\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tcloseForms()\n\t{\n\t\tif (this.addBtnMenu)\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\t\t}\n\n\t\tif (this.editSectionForm)\n\t\t{\n\t\t\tthis.editSectionForm.close();\n\t\t}\n\n\t\tif (this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm.close();\n\t\t}\n\n\t\tif (this.trackingGroupsForm)\n\t\t{\n\t\t\tthis.trackingGroupsForm.close();\n\t\t}\n\n\t\tif (this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm.close();\n\t\t}\n\t}\n\n\tshowEditSectionForm(params ={})\n\t{\n\t\tthis.closeForms();\n\t\tconst formTitleNode = this.DOM.sectionFormWrap.querySelector('.calendar-list-slider-card-widget-title-text');\n\n\t\tthis.editSectionForm = new EditForm({\n\t\t\twrap: this.DOM.sectionFormWrap,\n\t\t\tsectionAccessTasks: this.sectionManager.getSectionAccessTasks(),\n\t\t\tsectionManager: this.sectionManager,\n\t\t\tcloseCallback: () => {\n\t\t\t\tthis.allowSliderClose();\n\t\t\t}\n\t\t});\n\n\t\tlet showAccessControl = true;\n\t\tif (params.section && (!params.section.belongsToView() || params.section.isPseudo()))\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION_PERSONAL');\n\t\t\tshowAccessControl = false;\n\t\t}\n\t\telse if (params.section && params.section.id)\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION');\n\t\t\tshowAccessControl = params.section.canDo('access');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\t\t}\n\n\t\tthis.editSectionForm.show({\n\t\t\tshowAccess: showAccessControl,\n\t\t\tsection: params.section || {\n\t\t\t\tcolor: Util.getRandomColor(),\n\t\t\t\taccess: this.sectionManager.getDefaultSectionAccess()\n\t\t\t}\n\t\t});\n\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingTypesForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm = new TrackingTypesForm({\n\t\t\t\twrap: this.DOM.trackingTypesFormWrap,\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingTypesForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingUsersForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm = new TrackingUsersForm({\n\t\t\t\twrap: this.DOM.trackingUsersFormWrap,\n\t\t\t\ttrackingUsers: this.calendarContext.util.getSuperposedTrackedUsers(),\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingUsersForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingGroupsForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingGroupsForm)\n\t\t{\n\t\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\t\tconst trackingGroups = this.calendarContext.util.getSuperposedTrackedGroups();\n\n\t\t\tsuperposedSections.forEach((section) => {\n\t\t\t\tif (section.getType() === 'group'\n\t\t\t\t\t&& !trackingGroups.includes(section.getOwnerId()))\n\t\t\t\t{\n\t\t\t\t\ttrackingGroups.push(section.getOwnerId());\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.trackingGroupsForm = new TrackingGroupsForm({\n\t\t\t\twrap: this.DOM.trackingGroupsFormWrap,\n\t\t\t\ttrackingGroups: trackingGroups,\n\t\t\t\tsuperposedSections: superposedSections,\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingGroupsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tdeleteSectionHandler(event)\n\t{\n\t\tif (event && event instanceof Util.getBX().Event.BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst sectionId = parseInt(data.sectionId, 10);\n\n\t\t\tthis.sliderSections.forEach((section, index) => {\n\n\t\t\t\tif (parseInt(section.id) === sectionId && section.DOM && section.DOM.item)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(section.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tDom.clean(section.DOM.item, true);\n\t\t\t\t\t\tthis.sliderSections = BX.util.deleteFromArray(this.sliderSections, index);\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.closeForms()\n\t\t}\n\t}\n\n\thideSuperposedHandler(section)\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst sections = [];\n\t\tlet i;\n\n\t\tfor (i = 0; i < superposedSections.length; i++)\n\t\t{\n\t\t\tif (parseInt(section.id) !== parseInt(superposedSections[i].id))\n\t\t\t{\n\t\t\t\tsections.push(parseInt(superposedSections[i].id));\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tsections: sections\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t// Success\n\t\t\t\t(response) => {\n\t\t\t\t\tBX.reload();\n\t\t\t\t},\n\t\t\t\t// Failure\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\trefreshSectionList()\n\t{\n\t\tthis.createSectionList();\n\t}\n\n\tshowOnlyOneSection(section, sections)\n\t{\n\t\tfor (let curSection of sections)\n\t\t{\n\t\t\tif(curSection.id === section.id)\n\t\t\t{\n\t\t\t\tthis.switchOnSection(curSection);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.switchOffSection(curSection);\n\t\t\t}\n\t\t}\n\n\t\tthis.calendarContext.reload();\n\t}\n}"],"names":["EditForm","options","setEventNamespace","DOM","outerWrap","wrap","sectionAccessTasks","sectionManager","closeCallback","BX","Util","getBX","keyHandlerBinded","keyHandler","bind","params","section","create","showAccess","accessLink","style","display","accessWrap","Event","document","Dom","addClass","color","setColor","setAccess","access","data","ACCESS","name","sectionTitleInput","value","focus","select","isOpenedState","unbind","removeClass","Type","isFunction","querySelector","clean","appendChild","props","className","formFieldsWrap","attrs","type","placeholder","Loc","getMessage","optionsWrap","initSectionColorSelector","initAccessController","buttonsWrap","saveBtn","UI","Button","text","events","click","save","renderTo","checkClose","isCreated","e","keyCode","getKeyCode","close","setWaiting","saveSection","then","colorContWrap","html","colorIcon","colorChangeLink","showSimplePicker","colors","Runtime","clone","getDefaultColorList","innerCont","colorWrap","delegate","simplePickerClick","moreLinkWrap","moreLink","showFullPicker","simplePickerColorWrap","includes","push","i","length","node","backgroundColor","lastActiveNode","util","array_search","simpleColorPopup","PopupWindowManager","getRandomInt","autoHide","closeByEsc","offsetTop","offsetLeft","lightShadow","content","cacheable","setAngle","offset","show","target","findTargetNode","srcElement","isElementNode","getAttribute","fullColorPicker","ColorPicker","bindElement","onColorSelected","popupOptions","zIndex","onPopupClose","open","rowsCount","code","hasOwnProperty","accessRowsCount","insertAccessRow","getAccessName","checkAccessTableHeight","buildAccessController","calendarType","initDialogGroup","initDialogStandard","initAccessSelectorPopup","accessControls","showAccessSelectorPopup","removeIcon","setValueCallback","accessTasks","valueNode","innerHTML","Text","encode","title","remove","rowNode","Tag","render","accessTable","accessButton","hasClass","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","targetContainer","body","entities","id","selectMode","tabs","ownerName","items","ownerId","entityId","entityList","getSelectedItems","hide","isArray","forEach","entity","convertEntityToAccessCode","setAccessName","debounce","destroy","undefined","taskId","adjust","insertRow","titleNode","insertCell","valueCell","selectNode","checkTableTimeout","clearTimeout","setTimeout","offsetHeight","maxHeight","parseInt","accessPopupMenu","popupWindow","isShown","_this","menuItems","onclick","PopupMenu","randomInt","angle","EventEmitter","TrackingUsersForm","trackingUsers","trackingUserIdList","map","item","ID","CHECKED_CLASS","selectorId","superposedSections","selected","checkInnerWrapHeight","updateSectionList","firstTrackingUserIdList","cssText","innerWrap","selectorWrap","userTagSelector","TagSelector","dialogOptions","handleUserSelectorChanges","sectionsWrap","createButtons","selectedItems","getDialog","ajax","runAction","userIdList","sections","prepareTrackingSections","response","location","reload","displayError","errors","sectionIndex","checkbox","filter","delayExecution","updateSectionLoader","getLoader","height","updateSectionTimeout","users","user","OWNER_ID","FORMATTED_NAME","createSectionBlock","sectionList","result","listWrap","sectionClick","toString","li","COLOR","NAME","checkHeightTimeout","TrackingGroupsForm","trackingGroupIdList","trackingGroups","groupTagSelector","handleGroupSelectorChanges","groupIdList","TrackingTypesForm","selectGroups","selectUsers","addLinkMessage","SectionInterface","calendarContext","readonly","deleteSectionHandlerBinded","deleteSectionHandler","refreshSectionListBinded","refreshSectionList","config","accessNames","setAccessNames","SidePanel","Instance","sliderId","contentCallback","createContent","width","SLIDER_WIDTH","animationDuration","SLIDER_DURATION","onCloseByEsc","escHide","onClose","onCloseComplete","onLoad","onLoadSlider","addEventEmitterSubscriptions","subscribe","unsubscribe","event","getSlider","getUrl","denyClose","denyAction","closeForms","destroyEventEmitterSubscriptions","removeCustomEvent","proxy","sectionListWrap","sectionActionMenu","trackingTypesForm","trackingUsersForm","trackingGroupsForm","titleWrap","getCalendarContext","sectionFormWrap","isUserCalendar","userIsOwner","createAddButton","trackingGroupsFormWrap","trackingUsersFormWrap","trackingTypesFormWrap","createSectionList","slider","layout","sliderSections","getSections","belongsToView","isPseudo","isCompanyCalendar","getSuperposedTrackedUsers","htmlspecialchars","perm","edit_section","addButtonOuter","marginRight","addButton","addButtonMore","showAddButtonPopup","showEditSectionForm","addBtnMenu","MenuItem","delimiter","showTrackingTypesForm","showTrackingUsersForm","showTrackingGroupsForm","sectionClickHandler","sectionId","actionCont","showSectionMenu","getSection","switchSection","querySelectorAll","checkboxNodes","findCheckBoxNodes","menuItemNode","itemNode","closest","canDo","showOnlyOneSection","getLink","href","isSuperposed","hideSuperposedHandler","canBeConnectedToOutlook","connectToOutlook","EXPORT","LINK","sectionLink","calendarPath","path","Calendar","Sync","Interface","IcalSyncPopup","checkPathes","createInstance","showPopupWithPathesError","isGoogle","isCalDav","syncGoogle","syncInterface","getProviderById","CAL_DAV_CON","provider","connection","openActiveConnectionSlider","hideGoogle","userOptions","top","allowSliderClose","denySliderClose","editSectionForm","formTitleNode","getSectionAccessTasks","showAccessControl","getRandomColor","getDefaultSectionAccess","getSuperposedSectionList","getSuperposedTrackedGroups","getType","getOwnerId","BaseEvent","getData","index","deleteFromArray","curSection","switchOnSection","switchOffSection"],"mappings":"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"}