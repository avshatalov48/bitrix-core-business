{"version":3,"file":"resourcebookinguserfield.bundle.js","sources":["../src/formfieldtunnerabstract.js","../src/formfieldtunnerpopupabstract.js","../src/formfieldtunnervaluepopupabstract.js","../src/controls/userselectorfieldtunner.js","../src/controls/resourceselectorfieldtunner.js","../src/controls/serviceselectorfieldtunner.js","../src/controls/durationselectorfieldtunner.js","../src/controls/dateselectorfieldtunner.js","../src/controls/timeselectorfieldtunner.js","../src/adjustfieldcontroller.js","../src/controls/userselectorfieldeditcontrol.js","../src/controls/resourceselectorfieldeditcontrol.js","../src/controls/plannerpopup.js","../src/editfieldcontroller.js","../src/controls/serviceselector.js","../src/controls/timezoneselector.js","../src/controls/modeselector.js","../src/customizecrmentityeditor.js","../src/calendarviewsettingsslider.js","../src/adminsettingsviewer.js","../src/resourcebookinguserfield.js"],"sourcesContent":["import {Dom, Type} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tthis.label = '';\n\t\tthis.formLabel = '';\n\t\tthis.displayed = false;\n\t\tthis.valuePopup = null;\n\t\tthis.statePopup = null;\n\t\tthis.displayCheckboxDisabled = false;\n\t\tthis.DOM = {};\n\t}\n\n\tbuild(params)\n\t{\n\t\tthis.updateConfig(params.params);\n\n\t\tthis.DOM.fieldWrap = Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-item'}});\n\n\t\tthis.DOM.labelWrap = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field'}\n\t\t}));\n\t\tthis.DOM.labelNode = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-title'}, text: this.getLabel()\n\t\t}));\n\n\t\t// Label in form\n\t\tthis.DOM.formTitleWrap = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle' + (this.isDisplayed() ? ' show' : '')\n\t\t\t}\n\t\t}));\n\t\tthis.DOM.formTitleLabel = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-subtitle-text'},\n\t\t\ttext: this.getFormLabel(),\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\t\tthis.DOM.formTitleEditIcon = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-edit'},\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\n\t\t// Display checkbox\n\t\tthis.DOM.checkboxNode = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-checkbox-container'}})).appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\", value: 'Y', checked: this.isDisplayed(), disabled: this.displayCheckboxDisabled\n\t\t\t}, events: {\n\t\t\t\tclick: this.checkDisplayMode.bind(this)\n\t\t\t}\n\t\t}));\n\n\t\t// State popup\n\t\tthis.buildStatePopup({\n\t\t\twrap: this.DOM.fieldWrap, config: params.config || {}\n\t\t});\n\n\t\t// Value popup\n\t\tthis.buildValuePopup({\n\t\t\twrap: this.DOM.fieldWrap,\n\t\t\tconfig: params.config || {}\n\t\t});\n\n\t\tif (Type.isFunction(params.changeSettingsCallback))\n\t\t{\n\t\t\tthis.changeSettingsCallback = params.changeSettingsCallback;\n\t\t}\n\n\t\tparams.wrap.appendChild(this.DOM.fieldWrap);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.valuePopup && Type.isFunction(this.valuePopup.closePopup))\n\t\t{\n\t\t\tthis.valuePopup.closePopup();\n\t\t}\n\t\tif (this.statePopup && Type.isFunction(this.statePopup.closePopup))\n\t\t{\n\t\t\tthis.statePopup.closePopup();\n\t\t}\n\t}\n\n\tupdateConfig(params = {})\n\t{\n\t\tthis.setFormLabel(params.label || this.formLabel);\n\t\tif (params.show)\n\t\t{\n\t\t\tthis.displayed = params.show !== 'N';\n\t\t}\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t}\n\n\tgetLabel()\n\t{\n\t\treturn this.label;\n\t}\n\n\tgetFormLabel()\n\t{\n\t\treturn this.formLabel;\n\t}\n\n\tsetFormLabel(formLabel)\n\t{\n\t\tthis.formLabel = formLabel || '';\n\t}\n\n\tisDisplayed()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tcheckDisplayMode()\n\t{\n\t\tthis.displayed = !!this.DOM.checkboxNode.checked;\n\t\tif (this.displayed)\n\t\t{\n\t\t\tthis.displayInForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideInForm();\n\t\t}\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tDom.addClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\thideInForm ()\n\t{\n\t\tDom.removeClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tenableFormTitleEditMode()\n\t{\n\t\tif (!this.DOM.formTitleInputNode)\n\t\t{\n\t\t\tthis.DOM.formTitleInputNode = this.DOM.formTitleWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle-text'\n\t\t\t\t},\n\t\t\t\tevents: {blur: this.finishFormTitleEditMode.bind(this)}\n\t\t\t}));\n\t\t}\n\n\t\tthis.DOM.formTitleInputNode.value = this.getFormLabel();\n\t\tthis.DOM.formTitleInputNode.style.display = '';\n\t\tthis.DOM.formTitleLabel.style.display = 'none';\n\t\tthis.DOM.formTitleEditIcon.style.display = 'none';\n\t\tthis.DOM.formTitleInputNode.focus();\n\t}\n\n\tfinishFormTitleEditMode()\n\t{\n\t\tthis.setFormLabel(this.DOM.formTitleInputNode.value);\n\t\tDom.adjust(this.DOM.formTitleLabel, {text: this.getFormLabel()});\n\t\tthis.DOM.formTitleLabel.style.display = '';\n\t\tthis.DOM.formTitleEditIcon.style.display = '';\n\t\tthis.DOM.formTitleInputNode.style.display = 'none';\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tgetSettingsValue()\n\t{\n\n\t}\n\n\ttriggerChangeRefresh()\n\t{\n\t\tsetTimeout(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}.bind(this), 50);\n\t}\n}\n\n\n\n\n","import {Dom, Event} from \"main.core\";\n\nexport class FormFieldTunnerPopupAbstract {\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.menuItems = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t\tthis.handleClickFunc = this.handleClick.bind(this);\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props:{className:'calendar-resbook-webform-settings-popup-select'}}));\n\n\t\tthis.DOM.currentStateLink = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\t\t\ttext: this.getCurrentModeState(),\n\t\t\t\t\tevents: {click: this.showPopup.bind(this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown() || this.disabled)\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tthis.menuItems = this.getMenuItems();\n\n\t\tEvent.unbind(document, 'click', this.handleClickFunc);\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.currentStateLink,\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 30, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\t//this.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\n\t\t// BX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', function()\n\t\t// {\n\t\t// \tBX.PopupMenu.destroy(this.id);\n\t\t// \tthis.popup = null;\n\t\t// }.bind(this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet inputType = false, className, checked, inputNameStr = '';\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = menuItem.dataset.checked;\n\n\t\t\t\tlet menuItemClassName = 'menu-popup-item';\n\t\t\t\tif (menuItem.dataset.type === 'radio')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'radio';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-radio';\n\t\t\t\t\tif (menuItem.dataset.inputName)\n\t\t\t\t\t{\n\t\t\t\t\t\tinputNameStr = ' name=\"' + menuItem.dataset.inputName + '\" ';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (menuItem.dataset.type === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'checkbox';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-checkbox';\n\t\t\t\t}\n\n\t\t\t\tlet innerHtml = '<div class=\"menu-popup-item-inner\">';\n\t\t\t\tif (menuItem.dataset.type === 'submenu-list')\n\t\t\t\t{\n\t\t\t\t\tmenuItemClassName += ' menu-popup-item-submenu';\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource menu-popup-item-resource-wide\">' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-text\">' +\n\t\t\t\t\t\t'<span>' + menuItem.text + '</span>' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-resource-subvalue\">' + (menuItem.dataset.textValue || menuItem.dataset.value) + '</span>' +\n\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t\telse if (inputType)\n\t\t\t\t{\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource\">';\n\t\t\t\t\tif (inputType)\n\t\t\t\t\t{\n\t\t\t\t\t\tinnerHtml += '<input class=\"' + className + '\" type=\"' + inputType + '\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\" ' + inputNameStr + '>' +\n\t\t\t\t\t\t\t'<label class=\"menu-popup-item-text\"  for=\"' + menuItem.id + '\">' + menuItem.text + '</label>';\n\t\t\t\t\t}\n\t\t\t\t\tinnerHtml += '</div>';\n\t\t\t\t}\n\n\t\t\t\tinnerHtml += '</div>';\n\n\t\t\t\tmenuItem.layout.item.className = menuItemClassName;\n\t\t\t\tmenuItem.layout.item.innerHTML = innerHtml;\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(()=>{Event.bind(document, 'click', this.handleClickFunc);}, 50);\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn '';\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props : {className : ''}});\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') ||\n\t\t\tBX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap)\n\t\t)\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tif (this.changesTimeout)\n\t\t{\n\t\t\tthis.changesTimeout = clearTimeout(this.changesTimeout);\n\t\t}\n\t\tthis.changesTimeout = setTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\treturn this.closePopup({animation: true});\n\t\t}\n\t}\n\n\tsetDisabled()\n\t{\n\t\tthis.disabled = true;\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.closePopup();\n\t\t}\n\t\tDom.addClass(this.DOM.innerWrap, 'disabled');\n\t}\n\n\tsetEnabled()\n\t{\n\t\tthis.disabled = false;\n\t\tDom.removeClass(this.DOM.innerWrap, 'disabled');\n\t}\n}","import {BookingUtil, Dom} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerValuePopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-value-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.selectedValues = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-select-result'}}));\n\n\t\tthis.DOM.valueLink = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\ttext: this.getCurrentValueState(),\n\t\t\tevents: {\n\t\t\t\tclick: this.showPopup.bind(this),\n\t\t\t\tmouseover: this.showHoverPopup.bind(this),\n\t\t\t\tmouseout: this.hideHoverPopup.bind(this)\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup && this.popup.isShown())\n\t\t{\n\t\t\treturn this.popup.close();\n\t\t}\n\n\t\tthis.popup = new BX.PopupWindow(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\twidth: this.getPopupWidth(),\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.getPopupContent()\n\t\t\t});\n\t\tthis.popup.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\n\t\tBX.unbind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\t\tBX.bind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', BX.delegate(function ()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tthis.popup.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tshowHoverPopup()\n\t{\n\t}\n\n\thideHoverPopup()\n\t{\n\t}\n\n\thandlePopupCloose()\n\t{\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\treturn BX.message('WEBF_RES_NO_VALUE');\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props: {className: ''}});\n\n\t\tthis.DOM.innerWrap.style.minWidth = '500px';\n\t\tthis.DOM.innerWrap.style.minHeight = '30px';\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\tgetPopupWidth()\n\t{\n\t\treturn null;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') || BX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap))\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsetTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tshowPopupLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hidePopupLoader();\n\t\t\tthis.DOM.popupLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(50));\n\t\t}\n\t}\n\n\thidePopupLoader()\n\t{\n\t\tDom.remove(this.DOM.popupLoader);\n\t}\n}\n\n\texport class FormFieldTunnerMultipleChecknoxPopupAbstract extends FormFieldTunnerValuePopupAbstract{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.id = 'resourcebooking-settings-multiple-checknox-' + Math.round(Math.random() * 100000);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tvar menuItems = [];\n\n\t\tthis.values.forEach(function(item)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\tid: item.id,\n\t\t\t\ttext: BX.util.htmlspecialchars(item.title),\n\t\t\t\tdataset: item.dataset,\n\t\t\t\tonclick: BX.proxy(this.menuItemClick, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tthis.selectAllMessage = this.selectAllMessage || 'select all';\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this.selectAllMessage,\n\t\t\t\tonclick: BX.proxy(this.selectAllItemClick, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tvar checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.id)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(itemId){return itemId === menuItem.id});\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.values.find(function(value){\n\t\t\t\t\treturn !this.selectedValues.find(function(itemId){return itemId === value.id});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar\n\t\t\tselectAllcheckbox,\n\t\t\ttarget = e.target || e.srcElement,\n\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\tfoundValue = this.values.find(function(value){return value.id === menuItem.id;});\n\n\t\tif (foundValue)\n\t\t{\n\t\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\") || Dom.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t{\n\t\t\t\tif (!Dom.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t}\n\n\t\t\t\tif (checkbox.checked)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(foundValue);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deselectItem(foundValue);\n\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\tselectItem(value)\n\t{\n\t\tif (!BX.util.in_array(value.id, this.selectedValues))\n\t\t{\n\t\t\tthis.selectedValues.push(value.id);\n\t\t}\n\t}\n\tdeselectItem(value)\n\t{\n\t\tvar index = BX.util.array_search(value.id, this.selectedValues);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t}\n\t}\n\n\tselectAllItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t{\n\t\t\tvar checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\tif (Dom.hasClass(target, \"menu-popup-item\"))\n\t\t\t{\n\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t}\n\n\t\t\tvar i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t{\n\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t}\n\t\t\tthis.selectedValues = [];\n\t\t\tif (this.selectAllChecked)\n\t\t\t{\n\t\t\t\tthis.values.forEach(function(value){this.selectedValues.push(value.id);}, this);\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\tthis.closePopup({animation: true});\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerValuePopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom, Tag, Text} from \"main.core\";\nimport { Dialog as EntitySelectorDialog } from 'ui.entity-selector';\nimport {EventEmitter} from 'main.core.events';\n\n\nexport class UserSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_USERS');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_USERS_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.selectedUsers = [];\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tthis.statePopup = new UsersStatePopup(params);\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t\tthis.selectedUsers = Type.isArray(params.config.selected)\n\t\t\t? params.config.selected\n\t\t\t: params.config.selected.split('|');\n\n\t\tthis.DOM.valueWrap = params.wrap;\n\n\t\tthis.DOM.valueWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-resbook-webform-settings-popup-select-result\">\n\t\t\t\t\t${this.DOM.usersValueLink = Tag.render`\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"calendar-resbook-webform-settings-popup-select-value\"\n\t\t\t\t\t\t\tonclick=\"${this.showUserSelectorDialog.bind(this)}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t${this.getCurrentUsersValueText()}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`}\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t}\n\n\tgetCurrentUsersValueText()\n\t{\n\t\tconst count = this.selectedUsers.length;\n\t\treturn count\n\t\t\t? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_USER', count))\n\t\t\t: Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\tshowUserSelectorDialog()\n\t{\n\t\tif (!(this.userSelectorDialog instanceof EntitySelectorDialog))\n\t\t{\n\t\t\tthis.userSelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.usersValueLink,\n\t\t\t\tcontext: 'RESOURCEBOOKING',\n\t\t\t\tpreselectedItems: this.selectedUsers.map((userId) => {return ['user', userId]}),\n\t\t\t\tenableSearch: true,\n\t\t\t\tzIndex: this.zIndex + 10,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\n\t\tthis.userSelectorDialog.show();\n\t}\n\n\thandleUserSelectorChanges()\n\t{\n\t\tthis.selectedUsers = [];\n\n\t\tthis.userSelectorDialog.getSelectedItems().forEach((item) => {\n\t\t\tif (item.entityId === \"user\")\n\t\t\t{\n\t\t\t\tthis.selectedUsers.push(item.id);\n\t\t\t}\n\t\t});\n\n\t\tthis.DOM.usersValueLink.innerHTML = this.getCurrentUsersValueText();\n\n\t\tEventEmitter.emit('ResourceBooking.settingsUserSelector:onChanged');\n\t\tsetTimeout(() => {EventEmitter.emit('ResourceBooking.webformSettings:onChanged')}, 50);\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tvalue: this.selectedUsers\n\t\t};\n\t}\n}\n\nclass UsersStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'usersStatePopup';\n\t\tthis.inputName = 'user-select-mode';\n\t\tthis.id = 'users-state-' + Math.round(Math.random() * 1000);\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\thtml: '<span>' + Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'users-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'users-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_FREE_USER'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset && menuItem.dataset.inputName === this.inputName\n\t\t)\n\t\t{\n\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t}\n\t\tthis.handleControlChanges();\n\t\tsetTimeout(this.closePopup.bind(this), 50);\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_USER_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class ResourceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_RESOURCES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_RESOURCES_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t\tthis.multiple = params.multiple === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tparams.multiple = params.multiple == null ? this.multiple : params.multiple;\n\t\tthis.statePopup = new ResourcesStatePopup(params);\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ResourcesValuePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tmultiple: this.statePopup.getMultiple() ? 'Y' : 'N',\n\t\t\tvalue: this.valuePopup.getSelectedId()\n\t\t};\n\t}\n}\n\n\nclass ResourcesStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesStatePopup';\n\t\tthis.inputName = 'resource-select-mode';\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.multiple = !!params.multiple;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tvar submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\thtml: '<span>' + Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_AUTO_SELECT_RES'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-multiple',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_MULTIPLE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.multiple\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_RES_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.inputName)\n\t\t\t{\n\t\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === 'resources-state-multiple')\n\t\t\t{\n\t\t\t\tthis.multiple = !!target.checked;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n\n\tgetMultiple()\n\t{\n\t\treturn this.multiple;\n\t}\n}\n\n\nclass ResourcesValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('USER_TYPE_RESOURCE_SELECT_ALL');\n\n\t\tlet\n\t\t\tselectedItems, selectedIndex = {},\n\t\t\tselectAll = params.config.selected === null;\n\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[selectedItems[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\t\tif (Type.isArray(params.config.resources))\n\t\t{\n\t\t\tparams.config.resources.forEach(function(resource)\n\t\t\t{\n\t\t\t\tlet valueId = this.prepareValueId(resource);\n\t\t\t\tthis.values.push({\n\t\t\t\t\tid: valueId,\n\t\t\t\t\ttitle: resource.title,\n\t\t\t\t\tdataset: resource\n\t\t\t\t});\n\n\t\t\t\tif (selectAll || selectedIndex[resource.id])\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(valueId);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_RESOURCE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\tprepareValueId(resource)\n\t{\n\t\treturn resource.type + '|' + resource.id;\n\t}\n\n\tgetSelectedId()\n\t{\n\t\tlet result = [];\n\t\tthis.getSelectedValues().forEach(function(value)\n\t\t{\n\t\t\tlet val = value.split('|');\n\t\t\tif (val && val[1])\n\t\t\t{\n\t\t\t\tresult.push(parseInt(val[1]));\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n}\n\n\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class ServiceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_SERVICES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_SERVICE_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tif (params && Type.isDomNode(params.wrap))\n\t\t{\n\t\t\tparams.wrap.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className:'calendar-resbook-webform-settings-popup-select disabled'},\n\t\t\t\thtml: '<span class=\"calendar-resbook-webform-settings-popup-select-value\">' + Loc.getMessage('WEBF_RES_FROM_LIST') + '</span>'\n\t\t\t}));\n\t\t}\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ServiceValuePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tvalue: this.valuePopup.getSelectedValues()\n\t\t};\n\t}\n}\n\n\nclass ServiceValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'ServiceValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('WEBF_RES_SELECT_ALL_SERVICES');\n\n\t\tlet selectAll = params.config.selected === null || params.config.selected === '' || params.config.selected === undefined;\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\n\t\tlet selectedItems, selectedIndex = {};\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[BookingUtil.translit(selectedItems[i])] = true;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.config.services))\n\t\t{\n\t\t\tparams.config.services.forEach(function(service)\n\t\t\t{\n\t\t\t\tservice.id = BookingUtil.translit(service.name);\n\t\t\t\tif (service.id !== '')\n\t\t\t\t{\n\t\t\t\t\tthis.values.push({\n\t\t\t\t\t\tid: service.id,\n\t\t\t\t\t\ttitle: service.name + ' - ' + BookingUtil.getDurationLabel(service.duration),\n\t\t\t\t\t\tdataset: service\n\t\t\t\t\t});\n\n\t\t\t\t\tif (selectAll || selectedIndex[BookingUtil.translit(service.name)])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues.push(service.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.config = {};\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues.length ? this.selectedValues : '#EMPTY-SERVICE-LIST#';\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_SERVICE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n}\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\n\nexport class DurationSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DURATION');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DURATION_LABEL');\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.defaultValue = params.defaultValue;\n\t\tthis.manualInput = params.manualInput === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultValue = this.defaultValue;\n\t\tparams.manualInput = this.manualInput;\n\t\tthis.statePopup = new DurationStatePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultValue: this.statePopup.getDefaultValue(),\n\t\t\tmanualInput: this.statePopup.getManualInput() ? 'Y' : 'N'\n\t\t};\n\t}\n}\n\n\nclass DurationStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'durationStatePopup';\n\t\tthis.inputName = 'duration-select-mode';\n\t\tthis.manualInput = !!params.manualInput;\n\t\tthis.defaultValue = params.defaultValue || 60;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.durationList = BookingUtil.getDurationList(params.fullDay);\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'duration-default-value',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DURATION_AUTO'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.defaultValue,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.defaultValue)\n\t\t\t\t},\n\t\t\t\titems: this.getDefaultMenuItems()\n\t\t\t}].concat((this.isDisplayed()\n\t\t\t? [\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'duration-manual-input',\n\t\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_MANUAL_INPUT'),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\t\tchecked: this.manualInput\n\t\t\t\t\t},\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t}\n\t\t\t]\n\t\t\t: []));\n\t}\n\n\tgetDefaultMenuItems()\n\t{\n\t\tlet menuItems = [];\n\n\t\tif (Type.isArray(this.durationList))\n\t\t{\n\t\t\tthis.durationList.forEach(function(item)\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: 'duration-' + item.value,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'duration',\n\t\t\t\t\t\tvalue: item.value\n\t\t\t\t\t},\n\t\t\t\t\ttext: item.label,\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.durationList.find(function(item){return parseInt(item.value) === parseInt(duration)});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_DURATION_FROM_LIST_SHORT')\n\t\t\t\t+ (',<br>' + Loc.getMessage('WEBF_RES_SELECT_DURATION_BY_DEFAULT') + ' ' + this.getDurationLabelByValue(this.defaultValue)))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_DURATION_AUTO') + ' ' + this.getDurationLabelByValue(this.defaultValue);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.id === 'duration-manual-input')\n\t\t\t{\n\t\t\t\tthis.manualInput = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'duration')\n\t\t{\n\t\t\tthis.defaultValue = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetManualInput()\n\t{\n\t\treturn this.manualInput;\n\t}\n\n\tgetDefaultValue()\n\t{\n\t\treturn this.defaultValue;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class DateSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DATE');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DATE_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.start = params.start;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.start = params.start || this.start;\n\t\tthis.statePopup = new DateStatePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tstart: this.statePopup.getStart()\n\t\t};\n\t}\n}\n\n\nclass DateStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'dateStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\t\tthis.startInputName = 'date-select-start';\n\t\tthis.style = params.style === 'popup' ? 'popup' : 'line'; // popup|line\n\t\tthis.start = params.start === 'today' ? 'today' : 'free'; // today|free\n\t\tthis.build();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet submenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\thtml: '<span>' + Loc.getMessage('WEBF_RES_CALENDAR_STYLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-style-popup',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'popup',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'popup'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-style-line',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'line',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'line'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\thtml: '<span>' + Loc.getMessage('WEBF_RES_CALENDAR_START_FROM') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-today',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'today',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'today'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-free',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'free',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'free'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'popup'\n\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP')\n\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'))\n\t\t\t+ ', '\n\t\t\t+ (this.start === 'today'\n\t\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY_SHORT')\n\t\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE_SHORT'));\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.currentStateLink, {text: this.getCurrentModeState()});\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.dataset.inputName === this.startInputName)\n\t\t\t{\n\t\t\t\tthis.start = menuItem.dataset.value;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetStart()\n\t{\n\t\treturn this.start;\n\t}\n}\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\n\nexport class TimeSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_TIME');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_TIME_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.showOnlyFree = params.showOnlyFree === 'Y';\n\t\tthis.showFinishTime = params.showFinishTime === 'Y';\n\t\tthis.scale = parseInt(params.scale);\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.showOnlyFree = this.showOnlyFree;\n\t\tparams.showFinishTime = this.showFinishTime;\n\t\tparams.scale = this.scale;\n\t\tthis.statePopup = new TimeStatePopup(params);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tshowFinishTime: this.statePopup.getShowFinishTime(),\n\t\t\tshowOnlyFree: this.statePopup.getShowOnlyFree(),\n\t\t\tscale: this.statePopup.getScale()\n\t\t};\n\t}\n}\n\n\nclass TimeStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'timeStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\n\t\tthis.showOnlyFree = params.showOnlyFree;\n\t\tthis.showFinishTime = params.showFinishTime;\n\t\tthis.scale = params.scale;\n\t\tthis.stateShowFreeId = 'time-state-show-free';\n\t\tthis.stateShowFinishId = 'time-state-show-finish';\n\t\tthis.style = params.style === 'select' ? 'select' : 'slots'; // select|slots\n\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tlet\n\t\t\tsubmenuClass = 'main-buttons-submenu-separator main-buttons-submenu-item main-buttons-hidden-label';\n\n\t\treturn [\n\t\t\t{\n\t\t\t\thtml: '<span>' + Loc.getMessage('WEBF_RES_TIME_STYLE') + '</span>',\n\t\t\t\tclassName: submenuClass\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-style-select',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'select',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'select'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-style-slots',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'slots',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'slots'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-scale',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.scale,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.scale)\n\t\t\t\t},\n\t\t\t\titems: this.getDurationMenuItems()\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFreeId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FREE_ONLY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showOnlyFree\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFinishId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FINISH_TIME'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showFinishTime\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'select'\n\t\t\t? Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT')\n\t\t\t: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'))\n\t\t\t+ ',<br>'\n\t\t\t+ Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE') + ': '\n\t\t\t+ this.getDurationLabelByValue(this.scale);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFreeId)\n\t\t\t{\n\t\t\t\tthis.showOnlyFree = !!target.checked;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFinishId)\n\t\t\t{\n\t\t\t\tthis.showFinishTime = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'scale')\n\t\t{\n\t\t\tthis.scale = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\n\tgetDurationMenuItems()\n\t{\n\t\tlet\n\t\t\tdurationList = this.getDurationList(),\n\t\t\tmenuItems = [];\n\n\t\tdurationList.forEach(function(duration){\n\t\t\tmenuItems.push({\n\t\t\t\tid: 'duration-' + duration.value,\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'scale',\n\t\t\t\t\tvalue: duration.value\n\t\t\t\t},\n\t\t\t\ttext: duration.label,\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t});\n\t\t}, this);\n\n\t\treturn menuItems;\n\t}\n\n\n\tgetDurationList()\n\t{\n\t\tif (!this.durationList)\n\t\t{\n\t\t\tthis.durationList = BookingUtil.getDurationList(false);\n\t\t\tthis.durationList = this.durationList.filter(function(duration)\n\t\t\t{\n\t\t\t\treturn duration.value && duration.value >= 15 && duration.value <= 240;\n\t\t\t});\n\t\t}\n\t\treturn this.durationList;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.getDurationList().find(function(item){return item.value === duration});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetScale()\n\t{\n\t\treturn this.scale;\n\t}\n\n\tgetShowOnlyFree()\n\t{\n\t\treturn this.showOnlyFree ? 'Y' : 'N';\n\t}\n\n\tgetShowFinishTime()\n\t{\n\t\treturn this.showFinishTime ? 'Y' : 'N';\n\t}\n}\n\n\n","import {BookingUtil, FieldViewControllerEdit, FieldViewControllerPreview, Dom, Loc, Type, BaseEvent, EventEmitter, Runtime} from \"calendar.resourcebooking\";\nimport {ResourcebookingUserfield} from \"./resourcebookinguserfield\";\nimport {UserSelectorFieldTunner} from \"./controls/userselectorfieldtunner\";\nimport {ResourceSelectorFieldTunner} from \"./controls/resourceselectorfieldtunner\";\nimport {ServiceSelectorFieldTunner} from \"./controls/serviceselectorfieldtunner\";\nimport {DurationSelectorFieldTunner} from \"./controls/durationselectorfieldtunner\";\nimport {DateSelectorFieldTunner} from \"./controls/dateselectorfieldtunner\";\nimport {TimeSelectorFieldTunner} from \"./controls/timeselectorfieldtunner\";\nimport 'helper';\n\nexport class AdjustFieldController extends EventEmitter\n{\n\tconstructor(params)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.ResourcebookingUserfield.AdjustFieldController');\n\n\t\tthis.params = params;\n\t\tthis.complexFields = {};\n\t\tthis.userFieldParams = null;\n\t\tthis.id = 'resbook-settings-popup-' + Math.round(Math.random() * 100000);\n\n\t\tthis.settingsData = AdjustFieldController.getSettingsData(this.params.settings.data);\n\t\tthis.params.settings.data = this.settingsData;\n\n\t\tthis.DOM = {\n\t\t\tinnerWrap: this.params.innerWrap,\n\t\t\tsettingsWrap: this.params.innerWrap.appendChild(Dom.create(\"div\", {attrs: {'data-bx-resource-field-settings': 'Y'}})),\n\t\t\tcaptionNode: this.params.captionNode,\n\t\t\tsettingsInputs: {}\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\t// Request field params\n\t\tthis.showFieldLoader();\n\n\t\tResourcebookingUserfield.getUserFieldParams({\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\t(fieldParams) => {\n\t\t\t\tthis.hideFieldLoader();\n\t\t\t\tthis.userFieldParams = fieldParams;\n\n\t\t\t\tthis.fieldLayout = new FieldViewControllerEdit({\n\t\t\t\t\twrap: this.DOM.innerWrap,\n\t\t\t\t\tdisplayTitle: false,\n\t\t\t\t\ttitle: this.getCaption(),\n\t\t\t\t\tsettings: this.getSettings()\n\t\t\t\t});\n\t\t\t\tthis.fieldLayout.build();\n\t\t\t\tthis.updateSettingsDataInputs();\n\n\t\t\t\tthis.emit('afterInit', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfieldName: this.params.entityName,\n\t\t\t\t\t\tsettings: this.getSettings()\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t);\n\t}\n\n\tshowSettingsPopup()\n\t{\n\t\tResourcebookingUserfield.getUserFieldParams(\n\t\t{\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\tfunction(fieldParams)\n\t\t\t{\n\t\t\t\tthis.userFieldParams = fieldParams;\n\t\t\t\tthis.settingsPopupId = 'calendar-resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\t\t\tthis.settingsPopup = new BX.PopupWindow(\n\t\t\t\t\tthis.settingsPopupId,\n\t\t\t\t\tnull,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: this.getSettingsContentNode(),\n\t\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-window',\n\t\t\t\t\t\tautoHide: false,\n\t\t\t\t\t\tlightShadow: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\toverlay: {backgroundColor: 'black', opacity: 500},\n\t\t\t\t\t\tzIndex: -400,\n\t\t\t\t\t\ttitleBar: Loc.getMessage('WEBF_RES_SETTINGS'),\n\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\tbuttons : [new BX.PopupWindowButton({})]\n\t\t\t\t\t});\n\n\t\t\t\tlet buttonNodeWrap = this.settingsPopup.buttons[0].buttonNode.parentNode;\n\t\t\t\tDom.remove(this.settingsPopup.buttons[0].buttonNode);\n\t\t\t\tthis.settingsPopup.buttons[0].buttonNode = buttonNodeWrap.appendChild(Dom.create(\n\t\t\t\t\t\"button\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops : { className : 'ui-btn ui-btn-success'},\n\t\t\t\t\t\tevents: {click: function(){this.settingsPopup.close();}.bind(this)},\n\t\t\t\t\t\ttext : Loc.getMessage('WEBF_RES_CLOSE_SETTINGS_POPUP')\n\t\t\t\t\t}\n\t\t\t\t));\n\n\t\t\t\tBX.removeClass(this.settingsPopup.buttons[0].buttonNode, 'popup-window-button');\n\t\t\t\tthis.settingsPopup.show();\n\n\t\t\t\tBX.addCustomEvent(this.settingsPopup, 'onPopupClose', function(popup)\n\t\t\t\t{\n\t\t\t\t\tthis.destroyControls();\n\t\t\t\t\tthis.settingsPopup.destroy(this.id);\n\t\t\t\t\tthis.settingsPopup = null;\n\t\t\t\t\tif (this.previewFieldLayout)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.previewFieldLayout.destroy();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetSettingsContentNode()\n\t{\n\t\tlet outerWrap = Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup'}});\n\n\t\tlet leftWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-inner'}}));\n\t\tthis.buildSettingsForm({wrap: leftWrap});\n\n\t\tlet previewWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-preview'}}));\n\n\t\tthis.previewFieldLayout = new FieldViewControllerPreview({\n\t\t\twrap: previewWrap,\n\t\t\ttitle: this.getCaption(),\n\t\t\tsettings: this.getSettings()\n\t\t});\n\t\tthis.previewFieldLayout.build();\n\n\t\tBX.addCustomEvent('ResourceBooking.webformSettings:onChanged', this.handleWebformSettingsChanges.bind(this));\n\n\t\treturn outerWrap;\n\t}\n\n\tbuildSettingsForm(params)\n\t{\n\t\tlet\n\t\t\tsettings = this.getSettings(),\n\t\t\twrap = params.wrap,\n\t\t\ttitleId = 'title-' + this.id;\n\n\t\tthis.DOM.captionWrap = wrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-title'},\n\t\t\thtml: '<label for=\"' + titleId + '\" class=\"calendar-resbook-webform-settings-popup-label\">' + Loc.getMessage('WEBF_RES_NAME_LABEL') + '</label>'\n\t\t}));\n\t\tthis.DOM.captionInput = this.DOM.captionWrap.appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tid: titleId,\n\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-input',\n\t\t\t\ttype: 'text',\n\t\t\t\tvalue: this.getCaption()\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tchange: this.updateCaption.bind(this),\n\t\t\t\tblur: this.updateCaption.bind(this),\n\t\t\t\tkeyup: this.updateCaption.bind(this)\n\t\t\t}\n\t\t}));\n\t\tthis.updateCaption();\n\n\t\tthis.DOM.fieldsOuterWrap = wrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-content'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-head\">' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_NAME') + '</span>' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-decs\">' + Loc.getMessage('WEBF_RES_FIELD_NAME_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_SHOW_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>'\n\t\t}));\n\n\t\tthis.DOM.fieldsWrap = this.DOM.fieldsOuterWrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-list'}\n\t\t}));\n\n\t\tif (settings.userfieldSettings.useUsers)\n\t\t{\n\t\t\tthis.buildComplexField('users', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.users,\n\t\t\t\tconfig: {\n\t\t\t\t\tusers: settings.userfieldSettings.users,\n\t\t\t\t\tselected: settings.data.users.value\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('ResourceBooking.settingsUserSelector:onChanged', this.checkBitrix24Limitation.bind(this));\n\t\t}\n\n\t\tif (settings.userfieldSettings.useResources)\n\t\t{\n\t\t\tthis.buildComplexField('resources', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.resources,\n\t\t\t\tconfig: {\n\t\t\t\t\tresources: settings.userfieldSettings.resources,\n\t\t\t\t\tselected: settings.data.resources.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (settings.userfieldSettings.useServices)\n\t\t{\n\t\t\tthis.buildComplexField('services', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.services,\n\t\t\t\tconfig: {\n\t\t\t\t\tservices: settings.userfieldSettings.services,\n\t\t\t\t\tselected: settings.data.services.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildComplexField('duration', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.duration\n\t\t\t});\n\t\t}\n\n\t\tthis.buildComplexField('date', {\n\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\tparams: settings.data.date\n\t\t});\n\n\t\tif (!settings.userfieldSettings.fullDay)\n\t\t{\n\t\t\tthis.buildComplexField('time', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.time\n\t\t\t});\n\t\t}\n\n\t\tthis.DOM.fieldsWrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-item'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-decs\">' +\n\t\t\t\t(Loc.getMessage('WEBF_RES_BOOKING_SETTINGS_HELP')\n\t\t\t\t\t.replace('#START_LINK#', '<a href=\"javascript:void(0);\"' +\n\t\t\t\t\t\t' onclick=\"if (top.BX.Helper){top.BX.Helper.show(\\'redirect=detail&code=8366733\\');}\">')\n\t\t\t\t\t.replace('#END_LINK#', '</a>')) +\n\t\t\t\t'</div>'\n\t\t}));\n\t}\n\n\tdestroyControls()\n\t{\n\t\tfor (let k in this.complexFields)\n\t\t{\n\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].destroy))\n\t\t\t{\n\t\t\t\tthis.complexFields[k].destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleWebformSettingsChanges()\n\t{\n\t\tif (this.refreshLayoutTimeout)\n\t\t{\n\t\t\tthis.refreshLayoutTimeout = clearTimeout(this.refreshLayoutTimeout);\n\t\t}\n\n\t\tthis.refreshLayoutTimeout = setTimeout(function()\n\t\t{\n\t\t\t// Update settings and inputs\n\t\t\tfor (let k in this.complexFields)\n\t\t\t{\n\t\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].getValue))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsData[k] = this.complexFields[k].getValue();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateSettingsDataInputs();\n\n\t\t\t// Refresh preview\n\t\t\tthis.previewFieldLayout.refreshLayout(this.settingsData);\n\t\t\t// Refresh form layout (behind the settings popup)\n\t\t\tthis.fieldLayout.refreshLayout(this.settingsData);\n\n\t\t\t// Small Hack to make form look better - height adjusment\n\t\t\tthis.previewFieldLayout.getOuterWrap().style.maxHeight = Math.round(this.previewFieldLayout.getInnerWrap().offsetHeight * 0.73) + 'px';\n\t\t}.bind(this), 100);\n\t}\n\n\tbuildComplexField(type, params)\n\t{\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'users':\n\t\t\t\tthis.complexFields[type] = new UserSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'resources':\n\t\t\t\tthis.complexFields[type] = new ResourceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'services':\n\t\t\t\tthis.complexFields[type] = new ServiceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'duration':\n\t\t\t\tthis.complexFields[type] = new DurationSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'date':\n\t\t\t \tthis.complexFields[type] = new DateSelectorFieldTunner();\n\t\t\t \tbreak;\n\t\t\tcase 'time':\n\t\t\t\tthis.complexFields[type] = new TimeSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (Type.isObject(this.complexFields[type]))\n\t\t{\n\t\t\tthis.complexFields[type].build(params);\n\t\t}\n\t}\n\n\tstatic getSettingsData(data)\n\t{\n\t\tlet\n\t\t\tfield, option,\n\t\t\tsettingsData = BX.clone(AdjustFieldController.getDefaultSettingsData(), true);\n\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tfor (field in data)\n\t\t\t{\n\t\t\t\tif (data.hasOwnProperty(field) && settingsData[field])\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(data[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (option in data[field])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (data[field].hasOwnProperty(option))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsettingsData[field][option] = data[field][option];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsData[field] = data[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn settingsData;\n\t}\n\n\tstatic getDefaultSettingsData()\n\t{\n\t\treturn {\n\t\t\tusers : {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_USERS_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tresources: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_RESOURCES_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tmultiple: 'N',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tservices: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_SERVICE_LABEL'),\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tduration: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DURATION_LABEL'),\n\t\t\t\tdefaultValue: 60,\n\t\t\t\tmanualInput: 'N'\n\t\t\t},\n\t\t\tdate: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DATE_LABEL'),\n\t\t\t\tstyle: 'line', // line|popup\n\t\t\t\tstart: 'today'\n\t\t\t},\n\t\t\ttime: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_TIME_LABEL'),\n\t\t\t\tstyle: 'slots',\n\t\t\t\tshowOnlyFree: 'Y',\n\t\t\t\tshowFinishTime: 'N',\n\t\t\t\tscale: 60\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedUsers()\n\t{\n\t\treturn this.settingsData && this.settingsData.users && Type.isString(this.settingsData.users.value) ? this.settingsData.users.value.split('|') : [];\n\t}\n\n\tupdateSettingsDataInputs()\n\t{\n\t\tlet field, option;\n\t\tfor (field in this.settingsData)\n\t\t{\n\t\t\tif (this.settingsData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tif (Type.isPlainObject(this.settingsData[field]))\n\t\t\t\t{\n\t\t\t\t\tfor (option in this.settingsData[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.settingsData[field].hasOwnProperty(option))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.updateSettingsInputValue([field, option], this.settingsData[field][option]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.updateSettingsInputValue([field], this.settingsData[field]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSettingsInputValue(key, value)\n\t{\n\t\tlet uniKey = key.join('-');\n\t\tif (!this.DOM.settingsInputs[uniKey])\n\t\t{\n\t\t\tthis.DOM.settingsInputs[uniKey] = this.DOM.settingsWrap.appendChild(Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: this.params.formName + '[SETTINGS_DATA][' + key.join('][') + ']'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue = value.join('|');\n\t\t}\n\n\t\tthis.DOM.settingsInputs[uniKey].value = value;\n\t}\n\n\tshowFieldLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hideFieldLoader();\n\t\t\tthis.DOM.fieldLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(100));\n\t\t}\n\t}\n\n\thideFieldLoader()\n\t{\n\t\tDom.remove(this.DOM.fieldLoader);\n\t}\n\n\tgetSettings()\n\t{\n\t\tif (!this.params.settings.userfieldSettings)\n\t\t{\n\t\t\tthis.params.settings.userfieldSettings = {\n\t\t\t\tresources: this.userFieldParams.SETTINGS.SELECTED_RESOURCES,\n\t\t\t\tusers: this.userFieldParams.SETTINGS.SELECTED_USERS,\n\t\t\t\tservices: this.userFieldParams.SETTINGS.SERVICE_LIST,\n\t\t\t\tfullDay: this.userFieldParams.SETTINGS.FULL_DAY === 'Y',\n\t\t\t\tuseResources: this.userFieldParams.SETTINGS.USE_RESOURCES === 'Y'\n\t\t\t\t\t&& this.userFieldParams.SETTINGS.SELECTED_RESOURCES.length,\n\t\t\t\tuseUsers: this.userFieldParams.SETTINGS.USE_USERS === 'Y',\n\t\t\t\tuseServices: this.userFieldParams.SETTINGS.USE_SERVICES === 'Y',\n\t\t\t\tresourceLimit: this.userFieldParams.SETTINGS.RESOURCE_LIMIT,\n\t\t\t\tuserIndex: this.userFieldParams.SETTINGS.USER_INDEX\n\t\t\t}\n\t\t}\n\n\t\treturn this.params.settings;\n\t}\n\n\tupdateSettings(settings)\n\t{\n\t}\n\n\tgetCaption()\n\t{\n\t\treturn this.params.settings.caption;\n\t}\n\n\tupdateCaption()\n\t{\n\t\tlet caption = this.DOM.captionInput.value;\n\t\tif (this.params.settings.caption !== caption || !this.DOM.settingsInputs.caption)\n\t\t{\n\t\t\tthis.params.settings.caption = caption;\n\t\t\tif (this.previewFieldLayout)\n\t\t\t{\n\t\t\t\tthis.previewFieldLayout.updateTitle(this.params.settings.caption);\n\t\t\t}\n\n\t\t\t// Update title\n\t\t\tif (!this.DOM.settingsInputs.caption)\n\t\t\t{\n\t\t\t\tthis.DOM.settingsInputs.caption = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\t\tname: this.params.formName + '[CAPTION]'\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t\tthis.DOM.settingsInputs.caption.value = this.params.settings.caption;\n\n\t\t\tif (this.DOM.captionNode)\n\t\t\t{\n\t\t\t\tDom.adjust(this.DOM.captionNode, {text: this.params.settings.caption});\n\t\t\t}\n\t\t}\n\t}\n\n\tisRequired()\n\t{\n\t\treturn this.params.settings.required === 'Y';\n\t}\n\n\tupdateRequiredValue()\n\t{\n\t\tthis.params.settings.required = this.DOM.requiredCheckbox.checked ? 'Y' : 'N';\n\t\tif (!this.DOM.settingsInputs.required)\n\t\t{\n\t\t\tthis.DOM.settingsInputs.required = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: this.params.formName + '[REQUIRED]'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tthis.DOM.settingsInputs.required.value = this.params.settings.required;\n\t}\n\n\tcheckBitrix24Limitation()\n\t{\n\t\tlet\n\t\t\tcount = 0,\n\t\t\tsettings = this.getSettings();\n\n\t\tif (Type.isArray(this.params.settings.userfieldSettings.resources))\n\t\t{\n\t\t\tcount += this.params.settings.userfieldSettings.resources.length;\n\t\t}\n\n\t\tif (settings.userfieldSettings.useUsers && this.complexFields.users)\n\t\t{\n\t\t\tlet usersValue = this.complexFields.users.getValue();\n\t\t\tif (usersValue && Type.isArray(usersValue.value))\n\t\t\t{\n\t\t\t\tcount += usersValue.value.length;\n\t\t\t}\n\t\t}\n\n\t\tif (settings.userfieldSettings.resourceLimit > 0 && count > settings.userfieldSettings.resourceLimit)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t}\n\t}\n}","import { BookingUtil, Event, Loc, Dom } from 'calendar.resourcebooking';\n\nexport class UserSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.id = this.params.id || 'user-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.wrapNode = this.params.wrapNode;\n\t\tthis.destinationInputName = this.params.inputName || 'EVENT_DESTINATION';\n\t\tthis.params.selectGroups = false;\n\t\tthis.addMessage = this.params.addMessage || BX.message('USER_TYPE_RESOURCE_ADD_USER');\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\n\t\tif (BX.type.isArray(this.params.itemsSelected))\n\t\t{\n\t\t\tthis.params.itemsSelected = this.convertAttendeesCodes(this.params.itemsSelected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.params.itemsSelected = this.getSocnetDestinationConfig('itemsSelected');\n\t\t}\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\twrapNode: this.params.wrapNode\n\t\t};\n\n\t\tthis.create();\n\t}\n\n\tcreate ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tDom.addClass(this.DOM.outerWrap, 'calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\t\t}\n\n\t\tlet id = this.id;\n\n\t\tBX.bind(this.wrapNode, 'click', BX.delegate(function (e)\n\t\t{\n\t\t\tlet target = e.target || e.srcElement;\n\t\t\tif (target.className === 'calendar-resourcebook-content-block-control-delete') // Delete button\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.deleteItem(target.getAttribute('data-item-id'), target.getAttribute('data-item-type'), id);\n\t\t\t\tlet block = BX.findParent(target, {className: 'calendar-resourcebook-content-block-control-inner'});\n\t\t\t\tif (block && BX.hasClass(block, 'shown'))\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(block, 'shown');\n\t\t\t\t\tsetTimeout(function(){BX.remove(block);}, 300);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.openDialog(id);\n\t\t\t}\n\t\t}, this));\n\n\t\tthis.socnetDestinationInputWrap = this.wrapNode.appendChild(BX.create('SPAN', {props: {className: 'calendar-resourcebook-destination-input-box'}}));\n\t\tthis.socnetDestinationInput = this.socnetDestinationInputWrap.appendChild(BX.create('INPUT', {\n\t\t\tprops: {\n\t\t\t\tid: id + '-inp',\n\t\t\t\tclassName: 'calendar-resourcebook-destination-input'\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tkeydown: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchBeforeHandler(e, {\n\t\t\t\t\t\tformName: id, inputId: id + '-inp'\n\t\t\t\t\t});\n\t\t\t\t}, keyup: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchHandler(e, {\n\t\t\t\t\t\tformName: id,\n\t\t\t\t\t\tinputId: id + '-inp',\n\t\t\t\t\t\tlinkId: 'event-grid-dest-add-link',\n\t\t\t\t\t\tsendAjax: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.socnetDestinationLink = this.wrapNode.appendChild(BX.create('DIV', {\n\t\t\tprops: {className: 'calendar-resourcebook-content-block-control-text calendar-resourcebook-content-block-control-text-add'},\n\t\t\ttext: this.addMessage\n\t\t}));\n\n\t\tthis.init();\n\t}\n\n\tshow ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tDom.addClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\thide ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tisShown ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tinit ()\n\t{\n\t\tif (!this.socnetDestinationInput || !this.wrapNode)\n\t\t\treturn;\n\n\t\tlet _this = this;\n\n\t\tthis.params.items = this.getSocnetDestinationConfig('items');\n\t\tthis.params.itemsLast = this.getSocnetDestinationConfig('itemsLast');\n\n\t\tif (this.params.selectGroups === false)\n\t\t{\n\t\t\tthis.params.items.groups = {};\n\t\t\tthis.params.items.department = {};\n\t\t\tthis.params.items.sonetgroups = {};\n\t\t}\n\n\t\tBX.SocNetLogDestination.init({\n\t\t\tname: this.id,\n\t\t\tsearchInput: this.socnetDestinationInput,\n\t\t\textranetUser: false,\n\t\t\tuserSearchArea: 'I',\n\t\t\tbindMainPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tbindSearchPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tcallback: {\n\t\t\t\tselect: BX.proxy(this.selectCallback, this),\n\t\t\t\tunSelect: BX.proxy(this.unSelectCallback, this),\n\t\t\t\topenDialog: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseDialog: BX.proxy(this.closeDialogCallback, this),\n\t\t\t\topenSearch: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseSearch: function ()\n\t\t\t\t{\n\t\t\t\t\t_this.closeDialogCallback(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\titems: this.params.items,\n\t\t\titemsLast: this.params.itemsLast,\n\t\t\titemsSelected: this.params.itemsSelected,\n\t\t\tdepartmentSelectDisable: this.params.selectGroups === false\n\t\t});\n\t}\n\n\tcloseAll ()\n\t{\n\t\tif (BX.SocNetLogDestination.isOpenDialog())\n\t\t{\n\t\t\tBX.SocNetLogDestination.closeDialog();\n\t\t}\n\t\tBX.SocNetLogDestination.closeSearch();\n\t}\n\n\tselectCallback(item, type)\n\t{\n\t\tif (type === 'users')\n\t\t{\n\t\t\tthis.addUserBlock(item);\n\t\t\tBX.onCustomEvent('OnResourceBookDestinationAddNewItem', [item, this.id]);\n\t\t\tthis.socnetDestinationInput.value = '';\n\t\t}\n\t}\n\n\taddUserBlock(item, animation)\n\t{\n\t\tif (this.checkLimit && !this.checkLimit())\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tif (this.getAttendeesCodesList().includes(item.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blocks = this.wrapNode.querySelectorAll(`calendar-resourcebook-content-block-control-inner[data-id='${item.id}']`);\n\t\tfor (let i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tconst itemWrap = this.wrapNode.appendChild(BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\t'data-id': item.id, className: \"calendar-resourcebook-content-block-control-inner green\"\n\t\t\t},\n\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-control-text\">' + item.name + '</div>' + '<div data-item-id=\"' + item.id + '\" data-item-type=\"users\" class=\"calendar-resourcebook-content-block-control-delete\"></div>' + '<input type=\"hidden\" name=\"' + this.destinationInputName + '[U][]' + '\" value=\"' + item.id + '\">'\n\t\t}));\n\n\t\tif (animation !== false)\n\t\t{\n\t\t\tsetTimeout(BX.delegate(function (){Dom.addClass(itemWrap, 'shown');}, this), 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(itemWrap, 'shown');\n\t\t}\n\n\t\tthis.wrapNode.appendChild(this.socnetDestinationInputWrap);\n\t\tthis.wrapNode.appendChild(this.socnetDestinationLink);\n\t}\n\n\tunSelectCallback(item)\n\t{\n\t\tlet elements = BX.findChildren(this.wrapNode, {attribute: {'data-id': item.id}}, true);\n\t\tif (elements != null)\n\t\t{\n\t\t\tfor (let j = 0; j < elements.length; j++)\n\t\t\t{\n\t\t\t\tBX.remove(elements[j]);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent('OnResourceBookDestinationUnselect', [item, this.id]);\n\t\tthis.socnetDestinationInput.value = '';\n\t\tthis.socnetDestinationLink.innerHTML = this.addMessage;\n\t}\n\n\topenDialogCallback ()\n\t{\n\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'inline-block');\n\t\tBX.style(this.socnetDestinationLink, 'display', 'none');\n\t\tBX.focus(this.socnetDestinationInput);\n\t}\n\n\tcloseDialogCallback(cleanInputValue)\n\t{\n\t\tif (!BX.SocNetLogDestination.isOpenSearch() && this.socnetDestinationInput.value.length <= 0)\n\t\t{\n\t\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'none');\n\t\t\tBX.style(this.socnetDestinationLink, 'display', 'inline-block');\n\t\t\tif (cleanInputValue === true)\n\t\t\t\tthis.socnetDestinationInput.value = '';\n\n\t\t\t// Disable backspace\n\t\t\tif (BX.SocNetLogDestination.backspaceDisable || BX.SocNetLogDestination.backspaceDisable != null)\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\n\t\t\tBX.bind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable = function(e)\n\t\t\t{\n\t\t\t\tif (e.keyCode === 8)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function()\n\t\t\t{\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\t\t\t\tBX.SocNetLogDestination.backspaceDisable = null;\n\t\t\t}, 5000);\n\t\t}\n\t}\n\n\tgetCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tcodes = [], i, value;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalue = BX.util.trim(inputsList[i].value);\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcodes.push(inputsList[i].value);\n\t\t\t}\n\t\t}\n\t\treturn codes;\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tvalues = [],\n\t\t\ti;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalues.push(inputsList[i].value);\n\t\t}\n\n\t\treturn this.convertAttendeesCodes(values);\n\t}\n\n\tconvertAttendeesCodes(values)\n\t{\n\t\tlet attendeesCodes = {};\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(code){\n\t\t\t\tif (code.substr(0, 2) === 'DR')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"department\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'UA')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"groups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'SG')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"sonetgroups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"users\";\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn attendeesCodes;\n\t}\n\n\tgetAttendeesCodesList(codes)\n\t{\n\t\tlet result = [];\n\t\tif (!codes)\n\t\t\tcodes = this.getAttendeesCodes();\n\t\tfor (let i in codes)\n\t\t{\n\t\t\tif (codes.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tresult.push(i);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSocnetDestinationConfig(key)\n\t{\n\t\tlet\n\t\t\tres,\n\t\t\tsocnetDestination = this.params.socnetDestination || {};\n\n\t\tif (key === 'items')\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' || socnetDestination.DENY_TOALL\n\t\t\t\t\t? {}\n\t\t\t\t\t: {UA: {id: 'UA', name: BX.message('USER_TYPE_RESOURCE_TO_ALL_USERS')}},\n\t\t\t\tsonetgroups: socnetDestination.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.DEPARTMENT || {},\n\t\t\t\tdepartmentRelation: socnetDestination.DEPARTMENT_RELATION || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsLast' && socnetDestination.LAST)\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.LAST.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' ? {} : {UA: true},\n\t\t\t\tsonetgroups: socnetDestination.LAST.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.LAST.DEPARTMENT || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsSelected')\n\t\t{\n\t\t\tres = socnetDestination.SELECTED || {};\n\t\t}\n\t\treturn res || {};\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tlet\n\t\t\tresult = [], i,\n\t\t\tinputs = this.wrapNode.querySelectorAll('input');\n\n\t\tfor (i = 0; i < inputs.length; i++)\n\t\t{\n\t\t\tif (inputs[i].type === 'hidden' && inputs[i].value)\n\t\t\t{\n\t\t\t\tif (inputs[i].value.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tresult.push(parseInt(inputs[i].value.substr(1)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetValues(userList, trigerOnChange)\n\t{\n\t\tlet i, user;\n\t\tconst blocks = this.wrapNode.querySelectorAll('.calendar-resourcebook-content-block-control-inner');\n\t\tfor (i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tfor (i = 0; i < userList.length; i++)\n\t\t{\n\t\t\tif (BX.SocNetLogDestination.obItems[this.id]['users'])\n\t\t\t{\n\t\t\t\tuser = BX.SocNetLogDestination.obItems[this.id]['users']['U' + userList[i]];\n\t\t\t\tif (user)\n\t\t\t\t{\n\t\t\t\t\tthis.addUserBlock({\n\t\t\t\t\t\tid: 'U' + userList[i],\n\t\t\t\t\t\tname: user.name\n\t\t\t\t\t}, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t{\n\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n}","import {BookingUtil} from \"calendar.resourcebooking\";\n\nexport class ResourceSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.editMode = !!this.params.editMode;\n\t\tthis.id = this.params.id || 'resource-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.resourceList = BX.type.isArray(params.resourceList) ? params.resourceList : [];\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\t\tthis.checkLimitForNew = BX.type.isFunction(params.checkLimitCallbackForNew) ? params.checkLimitCallbackForNew : false;\n\n\t\tthis.selectedValues = [];\n\t\tthis.selectedValuesIndex = {};\n\n\t\tthis.selectedBlocks = [];\n\t\tthis.newValues = [];\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\tblocksWrap: this.params.blocksWrap || false,\n\t\t\tlistWrap: this.params.listWrap\n\t\t};\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.controlsWrap = this.params.controlsWrap;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.arrowNode = BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-detail-icon calendar-resourcebook-content-block-detail-icon-arrow\"}});\n\t\t}\n\n\t\tthis.onChangeCallback = this.params.onChangeCallback || null;\n\n\t\tthis.create();\n\t\tthis.setValues(params.values);\n\t}\n\n\n\tcreate ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'calendar-resourcebook-resource-list-wrap calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.addButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_ADD'),\n\t\t\t\tevents: {click: BX.delegate(this.addResourceBlock, this)}\n\t\t\t}));\n\n\t\t\tif (this.resourceList.length > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.selectButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT'),\n\t\t\t\t\tevents: {click: BX.delegate(this.openResourcesPopup, this)}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.bind(this.DOM.blocksWrap, 'click', BX.delegate(this.handleBlockClick, this));\n\t\t}\n\t}\n\n\tshow ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thide ()\n\t{\n\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\tisShown ()\n\t{\n\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thandleBlockClick (e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\n\t\tif (target)\n\t\t{\n\t\t\tlet blockValue = target.getAttribute('data-bx-remove-block');\n\t\t\tif (blockValue)\n\t\t\t{\n\t\t\t\t// Remove from blocks\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\t// Remove from values\n\t\t\t\tthis.selectedValues.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.title === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\tif (BX.type.isFunction(this.onChangeCallback))\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t\t}\n\n\t\t\t\tthis.checkBlockWrapState();\n\t\t\t}\n\n\t\t\tif (!blockValue)\n\t\t\t{\n\t\t\t\tthis.openResourcesPopup();\n\t\t\t}\n\t\t}\n\t}\n\n\topenResourcesPopup ()\n\t{\n\t\tif (!this.resourceList.length)\n\t\t{\n\t\t\treturn this.addResourceBlock();\n\t\t}\n\n\t\tif (this.isResourcesPopupShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\n\t\tthis.resourceList.forEach(function(resource)\n\t\t{\n\t\t\tif (resource.deleted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(resource.title),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: resource.type,\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttitle: resource.title\n\t\t\t\t},\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet\n\t\t\t\t\t\tselectAllcheckbox,\n\t\t\t\t\t\ttarget = e.target || e.srcElement,\n\t\t\t\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\t\t\t\tfoundResource = this.resourceList.find(function(resource)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn parseInt(resource.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t\t\t&& resource.type === menuItem.dataset.type;\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\tif (foundResource)\n\t\t\t\t\t{\n\t\t\t\t\t\t// Complete removing of the resource\n\t\t\t\t\t\tif (target && BX.hasClass(target, \"calendar-resourcebook-content-block-control-delete\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet menuItemNode = BX.findParent(target, {className: 'menu-popup-item'});\n\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(menuItemNode, 'menu-popup-item-resource-remove-loader');\n\n\t\t\t\t\t\t\t\tmenuItemNode.appendChild(BookingUtil.getLoader(25));\n\t\t\t\t\t\t\t\tlet textNode = menuItemNode.querySelector('.menu-popup-item-text');\n\t\t\t\t\t\t\t\tif (textNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttextNode.innerHTML = BX.message('USER_TYPE_RESOURCE_DELETING');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfoundResource.deleted = true;\n\t\t\t\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemNode.style.maxHeight = '0';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (!this.resourceList.find(function(resource){return !resource.deleted;}))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\t\t\t\t\t\t\tthis.DOM.selectButton.style.opacity = 0;\n\n\t\t\t\t\t\t\t\t\tsetTimeout(BX.delegate(function(){BX.remove(this.DOM.selectButton);}, this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), 500);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\") || BX.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!BX.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (checkbox.checked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT_ALL'),\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet target = e.target || e.srcElement;\n\t\t\t\t\tif (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\t\t\t\tif (BX.hasClass(target, \"menu-popup-item\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\t\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\t\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.resourceList.forEach(function(resource){\n\t\t\t\t\t\t\tif (resource.deleted)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.selectAllChecked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\tvalue: resource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\tthis.checkResourceInputs();\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.selectButton || this.DOM.blocksWrap,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tthis.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\t\t}\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function(){BX.PopupMenu.destroy(this.id);}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(item)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(item.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t&& item.type === menuItem.dataset.type;\n\t\t\t\t});\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.util.htmlspecialchars(menuItem.dataset.title) + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t(this.editMode ? '<div class=\"calendar-resourcebook-content-block-control-delete\"></div>' : '') +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.resourceList.find(function(resource){\n\t\t\t\t\treturn !this.selectedValues.find(function(item)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn parseInt(item.id) === parseInt(resource.id)\n\t\t\t\t\t\t\t&& item.type === resource.type\n\t\t\t\t\t});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.message('USER_TYPE_RESOURCE_SELECT_ALL') + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\taddResourceBlock(params)\n\t{\n\t\tif (!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif ((params.resource && (this.checkLimit && !this.checkLimit() && window.B24))\n\t\t\t||\n\t\t\t(!params.resource && (this.checkLimitForNew && !this.checkLimitForNew() && window.B24)))\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tlet\n\t\t\t_this = this,\n\t\t\tblockEntry;\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (params.resource && this.selectedValues.find(function(val)\n\t\t\t{\n\t\t\t\treturn val.id && parseInt(val.id) === parseInt(params.resource.id)\n\t\t\t\t\t&& val.type === params.resource.type;\n\t\t\t}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!params.value)\n\t\t\t{\n\t\t\t\tparams.value = '';\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\twrap : this.DOM.listWrap\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail calendar-resourcebook-outer-resource-wrap\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource-inner calendar-resourcebook-content-block-detail-resource-inner-wide\"}}))\n\t\t\t};\n\n\t\t\tblockEntry.input = blockEntry.wrap.appendChild(BX.create(\"input\", {\n\t\t\t\tprops:{\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-input\",\n\t\t\t\t\tvalue: params.value,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tplaceholder: BX.message('USER_TYPE_RESOURCE_NAME')\n\t\t\t\t},\n\t\t\t\tdataset: {\n\t\t\t\t\tresourceType: params.resource ? params.resource.type : '',\n\t\t\t\t\tresourceId: params.resource ? params.resource.id : ''\n\t\t\t\t}\n\t\t\t}));\n\t\t\tblockEntry.delButton = blockEntry.wrap.appendChild(BX.create(\"div\", {\n\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-control-delete\"},\n\t\t\t\tevents: {click(){\n\t\t\t\t\t\tBX.remove(BX.findParent(this, {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t\t\t_this.selectedValues = _this.getSelectedValues();\n\t\t\t\t\t\t_this.checkResourceInputs();\n\t\t\t\t\t}}\n\t\t\t}));\n\n\t\t\tif (params.focusInput !== false)\n\t\t\t{\n\t\t\t\tBX.focus(blockEntry.input);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.value && this.selectedBlocks.find(function(val){return val.value && val.value === params.value;}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\tresource: params.resource || false,\n\t\t\t\twrap : this.DOM.blocksWrap.appendChild(BX.create(\"div\", {\n\t\t\t\t\tprops:{\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-inner\"\n\t\t\t\t\t\t\t+ (params.animation ? '' : ' shown')\n\t\t\t\t\t\t\t+ (params.transparent ? ' transparent' : '')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-text\"},\n\t\t\t\t\t\t\ttext: params.value || ''\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {'data-bx-remove-block': params.value},\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-delete\"}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}))\n\t\t\t};\n\n\t\t\tthis.selectedBlocks.push(blockEntry);\n\n\t\t\t// Show it with animation\n\t\t\tif (params.animation)\n\t\t\t{\n\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(blockEntry.wrap, 'shown');\n\t\t\t\t}, this), 1);\n\t\t\t}\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\n\t\t\tthis.checkBlockWrapState();\n\t\t}\n\n\t\t// Adjust outer wrap max height\n\t\tif (this.DOM.listWrap && this.DOM.outerWrap)\n\t\t{\n\t\t\tif (BX.hasClass(this.DOM.outerWrap, 'shown'))\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = Math.max(10000, this.DOM.listWrap.childNodes.length * 45 + 100) + 'px';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}\n\n\t\treturn blockEntry;\n\t}\n\n\tremoveResourceBlock(params)\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId,\n\t\t\t\ti, inputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType === params.resource.type && parseInt(resourceId) === parseInt(params.resource.id))\n\t\t\t\t{\n\t\t\t\t\tBX.remove(BX.findParent(inputs[i], {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.resource)\n\t\t\t{\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === params.resource.title)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\t\t\tthis.checkBlockWrapState();\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckResourceInputs()\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (!this.selectedValues.length)\n\t\t\t{\n\t\t\t\tthis.addResourceBlock({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckBlockWrapState()\n\t{\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tif (!this.selectedBlocks.length)\n\t\t\t{\n\t\t\t\tif (!this.DOM.emptyPlaceholder)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder = this.DOM.blocksWrap.appendChild(\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops : {className : \"calendar-resourcebook-content-block-control-empty\"},\n\t\t\t\t\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-text\">' + BX.message('USER_TYPE_RESOURCE_LIST_PLACEHOLDER') + '</span>'\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder.className = \"calendar-resourcebook-content-block-control-empty\";\n\t\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.emptyPlaceholder);\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(BX.delegate(function(){\n\t\t\t\t\tif (BX.isNodeInDom(this.DOM.emptyPlaceholder))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this.DOM.emptyPlaceholder, 'show');\n\t\t\t\t\t}\n\t\t\t\t}, this), 50);\n\t\t\t}\n\t\t\telse if (this.DOM.emptyPlaceholder)\n\t\t\t{\n\t\t\t\tBX.remove(this.DOM.emptyPlaceholder);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isResourcesPopupShown() && !BX.isParentForNode(this.popupContainer, target)\n\t\t)\n\t\t{\n\t\t\tthis.closeResourcesPopup({animation: true});\n\t\t}\n\t}\n\n\tisResourcesPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tcloseResourcesPopup(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetValues()\n\t{\n\t\treturn this.resourceList;\n\t}\n\n\taddToSelectedValues(value)\n\t{\n\t\tif (!this.selectedValues.find(function(val){return parseInt(val.id) === parseInt(value.id) && val.type === value.type;}))\n\t\t{\n\t\t\tthis.selectedValues.push(value);\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tthis.selectedValues = [];\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId, i,\n\t\t\t\tinputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType && resourceId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: resourceType, id: resourceId, title: inputs[i].value});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: 'resource', title: inputs[i].value});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectedBlocks.forEach(function(element){\n\t\t\t\tthis.selectedValues.push({type: element.resource.type, id: element.resource.id});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn this.selectedValues;\n\t}\n\n\tgetDeletedValues()\n\t{\n\t\treturn this.resourceList.filter(function(resource){return resource.deleted;});\n\t}\n\n\tsetValues(values, trigerOnChange)\n\t{\n\t\tthis.selectedBlocks.forEach(function(element){BX.remove(element.wrap);});\n\t\tthis.selectedBlocks = [];\n\t\ttrigerOnChange = trigerOnChange !== false;\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(value)\n\t\t\t{\n\t\t\t\tlet foundResource = this.resourceList.find(function(resource)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(resource.id) === parseInt(value.id) && resource.type === value.type;\n\t\t\t\t}, this);\n\n\t\t\t\tif (foundResource)\n\t\t\t\t{\n\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\ttrigerOnChange: trigerOnChange\n\t\t\t\t\t});\n\t\t\t\t\tthis.addToSelectedValues(foundResource);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\tthis.checkResourceInputs();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.DOM.arrowNode)\n\t\t\t{\n\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.arrowNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.checkBlockWrapState();\n\t}\n}","import {Type, Dom, Event, BookingUtil} from \"calendar.resourcebooking\";\n\nexport class PlannerPopup\n{\n\tconstructor(params)\n\t{\n\t}\n\n\tshow (params)\n\t{\n\t\tif (!params)\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\t\tthis.params = params;\n\t\tthis.bindNode = params.bindNode;\n\t\tthis.plannerId = this.params.plannerId;\n\t\tthis.config = this.params.plannerConfig;\n\n\t\tif (this.isShown() || !this.bindNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.lastPlannerIdShown && this.lastPlannerIdShown !== this.plannerId)\n\t\t{\n\t\t\tthis.close({animation: false});\n\t\t}\n\n\t\tthis.currentEntries = [];\n\n\t\tthis.plannerWrap = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\tid: this.plannerId,\n\t\t\t\tclassName: 'calendar-planner-wrapper'\n\t\t\t}\n\t\t});\n\n\t\tthis.popup = new BX.PopupWindow(this.plannerId + \"_popup\",\n\t\t\tthis.bindNode,\n\t\t\t{\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: - parseInt(this.bindNode.offsetHeight) - 20,\n\t\t\t\toffsetLeft: this.bindNode.offsetWidth + 38,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.plannerWrap\n\t\t\t});\n\n\t\tthis.popup.setAngle({offset: 100, position: 'left'});\n\t\tthis.popup.show(true);\n\t\tthis.lastPlannerIdShown = this.plannerId;\n\n\t\tlet\n\t\t\tbindPos = BX.pos(this.bindNode),\n\t\t\twinSize = BX.GetWindowSize();\n\n\t\tthis.plannerWidth = winSize.innerWidth - bindPos.right - 160;\n\t\tthis.config.width = this.plannerWidth;\n\n\t\tsetTimeout(function(){\n\t\t\tif (this.popup && this.popup.popupContainer)\n\t\t\t{\n\t\t\t\tDom.addClass(this.popup.popupContainer, 'calendar-resbook-planner-popup');\n\t\t\t\tthis.popup.popupContainer.style.width = 0;\n\t\t\t}\n\t\t}.bind(this), 1);\n\n\t\tsetTimeout(function(){\n\t\t\tif (this.popup && this.popup.popupContainer)\n\t\t\t{\n\t\t\t\tthis.popup.popupContainer.style.width = (this.plannerWidth + 40) + 'px';\n\t\t\t\tDom.addClass(this.popup.popupContainer, 'show');\n\t\t\t}\n\t\t\tEvent.bind(document, 'click', this.handleClick.bind(this));\n\t\t}.bind(this), 50);\n\t\tsetTimeout(this.showPlanner.bind(this), 350);\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', this.close.bind(this));\n\t}\n\n\tupdate (params, refreshParams)\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet\n\t\t\tcodes = [], i, k, code,\n\t\t\tcodeIndex = {},\n\t\t\tplannerConfig = BX.clone(this.config, true),\n\t\t\tfromTimestamp, toTimestamp,\n\t\t\tdateFrom, dateTo;\n\n\t\tif (Type.isPlainObject(this.lastUpdateParams) && Type.isPlainObject(params) && refreshParams !== true)\n\t\t{\n\t\t\tfor (k in params)\n\t\t\t{\n\t\t\t\tif (params.hasOwnProperty(k))\n\t\t\t\t{\n\t\t\t\t\tthis.lastUpdateParams[k] = params[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tparams = this.lastUpdateParams;\n\t\t}\n\n\t\t// Save selector information\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tthis.lastUpdateParams = params;\n\t\t}\n\n\t\tparams.focusSelector = params.focusSelector !== false;\n\n\t\tif (params.from && params.to)\n\t\t{\n\t\t\tdateFrom = BookingUtil.parseDate(params.from);\n\t\t\tdateTo = BookingUtil.parseDate(params.to);\n\t\t\tfromTimestamp = dateFrom.getTime();\n\t\t\ttoTimestamp = dateTo.getTime();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.selector.fullDay)\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 12;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 14;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 3;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 5;\n\t\t\t}\n\n\t\t\tdateFrom = new Date(fromTimestamp);\n\t\t\tdateTo = new Date(toTimestamp);\n\n\t\t\tplannerConfig.scaleDateFrom = dateFrom;\n\t\t\tplannerConfig.scaleDateTo = dateTo;\n\t\t}\n\n\t\tif (Type.isArray(params.userList))\n\t\t{\n\t\t\tfor (i = 0; i < params.userList.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.userList[i].id;\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.selectedUsers))\n\t\t{\n\t\t\tfor (i = 0; i < params.selectedUsers.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.selectedUsers[i];\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet requestData = {\n\t\t\tcodes: codes,\n\t\t\tresources: params.resourceList,\n\t\t\tfrom: BookingUtil.formatDate(null, fromTimestamp / 1000),\n\t\t\tto: BookingUtil.formatDate(null, toTimestamp / 1000),\n\t\t\tcurrentEventList: this.params.currentEventList || []\n\t\t};\n\n\t\tif (this.checkUpdateParams(requestData) && this.isShown())\n\t\t{\n\t\t\tthis.showPlannerLoader();\n\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getplannerdata', {\n\t\t\t\tdata: requestData\n\t\t\t}).then(function (response)\n\t\t\t\t{\n\t\t\t\t\tthis.hidePlannerLoader();\n\n\t\t\t\t\tif (this.lastRequestData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.lastRequestData.response = response;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.currentEntries = response.data.entries;\n\t\t\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t\t\t{\n\t\t\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\t\t\tshow: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t}\n\t\telse if (Type.isPlainObject(this.lastRequestData.response))\n\t\t{\n\t\t\tlet response = this.lastRequestData.response;\n\t\t\tthis.currentEntries = response.data.entries;\n\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t{\n\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t{\n\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t||\n\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isShown())\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t{\n\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\tshow: false\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckUpdateParams (requestData)\n\t{\n\t\tlet requestPlannerUpdate = false;\n\t\tif (!this.lastRequestData || this.lastRequestPlannerId !== this.plannerId)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 1. Compare dates\n\t\tif (!requestPlannerUpdate && requestData.from !== this.lastRequestData.from)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\t\t// 2. Compare users\n\t\tif (!requestPlannerUpdate\n\t\t\t&& Type.isArray(requestData.codes) && Type.isArray(this.lastRequestData.codes)\n\t\t\t&& BX.util.array_diff(requestData.codes, this.lastRequestData.codes).length > 0\n\t\t)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 3. Compare resources\n\t\tif (!requestPlannerUpdate && Type.isArray(requestData.resources) && Type.isArray(this.lastRequestData.resources))\n\t\t{\n\t\t\tif (requestData.resources.length !== this.lastRequestData.resources.length)\n\t\t\t{\n\t\t\t\trequestPlannerUpdate = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet resIndex = {};\n\t\t\t\trequestData.resources.forEach(function (res)\n\t\t\t\t{\n\t\t\t\t\tresIndex[res.type + '_' + res.id] = true\n\t\t\t\t});\n\n\t\t\t\tthis.lastRequestData.resources.forEach(function(res)\n\t\t\t\t{\n\t\t\t\t\tif (!resIndex[res.type + '_' + res.id])\n\t\t\t\t\t{\n\t\t\t\t\t\trequestPlannerUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Save request data for future comparing\n\t\tif (requestPlannerUpdate)\n\t\t{\n\t\t\tthis.lastRequestData = requestData;\n\t\t\tthis.lastRequestPlannerId = this.plannerId;\n\t\t}\n\n\t\treturn requestPlannerUpdate;\n\t}\n\n\tshowPlanner ()\n\t{\n\t\tthis.planner = new CalendarPlanner(\n\t\t\tthis.params.plannerConfig,\n\t\t\t{\n\t\t\t\tconfig: this.config,\n\t\t\t\tdata: {\n\t\t\t\t\taccessibility: this.currentAccessibility || {},\n\t\t\t\t\tentries: this.currentEntries\n\t\t\t\t},\n\t\t\t\tselector: {\n\t\t\t\t\tfrom: this.params.selector.from,\n\t\t\t\t\tto: this.params.selector.to,\n\t\t\t\t\tfullDay: this.params.selector.fullDay,\n\t\t\t\t\tupdateScaleLimits: true,\n\t\t\t\t\tupdateScaleType: false,\n\t\t\t\t\tfocus: true,\n\t\t\t\t\tRRULE: false,\n\t\t\t\t\tanimation: false\n\t\t\t\t},\n\t\t\t\tloadedDataFrom: this.currentLoadedDataFrom,\n\t\t\t\tloadedDataTo: this.currentLoadedDataTo,\n\t\t\t\tfocusSelector: true,\n\t\t\t\tplannerId: this.plannerId,\n\t\t\t\tshow: true\n\t\t\t}\n\t\t);\n\n\t\t// planner events\n\t\tif (Type.isFunction(this.params.selectorOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorChanged', this.params.selectorOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.selectEntriesOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectedEntriesOnChange', this.params.selectEntriesOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.checkSelectorStatusCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorStatusOnChange', this.params.checkSelectorStatusCallback);\n\t\t}\n\n\t\tBX.addCustomEvent('OnCalendarPlannerScaleChanged', BX.proxy(function(params)\n\t\t{\n\t\t\tthis.update({\n\t\t\t\tfrom: params.from,\n\t\t\t\tto: params.to,\n\t\t\t\tfocusSelector: params.focusSelector === true\n\t\t\t});\n\t\t}, this));\n\n\t}\n\n\tshowPlannerLoader ()\n\t{\n\t\tif (this.planner && this.planner.outerWrap)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tDom.remove(this.loader);\n\t\t\t}\n\t\t\tthis.loader = this.planner.outerWrap.appendChild(BookingUtil.getLoader(150));\n\t\t}\n\t}\n\n\thidePlannerLoader ()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tDom.remove(this.loader);\n\t\t\tthis.loader = false;\n\t\t}\n\t}\n\n\tclose(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tif (params && params.animation)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.popup.popupContainer, 'show');\n\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tparams.animation = false;\n\t\t\t\t\tthis.close(params);\n\t\t\t\t}, this), 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t\t\tBX.removeCustomEvent(this.popup, 'onPopupClose', BX.proxy(this.close, this));\n\t\t\t\tthis.popup.destroy();\n\t\t\t\tthis.planner = null;\n\t\t\t\tthis.popup = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.lastPlannerIdShown === this.plannerId\n\t\t\t&& this.popup && this.popup.isShown && this.popup.isShown();\n\t}\n\n\tgetPlannerId()\n\t{\n\t\tif (typeof this.plannerId === 'undefined')\n\t\t{\n\t\t\tthis.plannerId = 'calendar-planner-' + Math.round(Math.random() * 100000);\n\t\t}\n\t\treturn this.plannerId;\n\t}\n\n\tgetPlannerContainer()\n\t{\n\t\treturn BX('calendar-planner-outer' + this.getPlannerId(), true);\n\t}\n\n\trefreshDateTimeView(params)\n\t{\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isShown()\n\t\t\t&& !BX.isParentForNode(this.bindNode, target)\n\t\t\t&& !BX.isParentForNode(BX('BXSocNetLogDestination'), target)\n\t\t\t&& !BX.isParentForNode(this.popup.popupContainer, target)\n\t\t)\n\t\t{\n\t\t\tif (!document.querySelector('div.popup-window-resource-select'))\n\t\t\t{\n\t\t\t\tthis.close({animation: true});\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\n\n\n","import {BookingUtil, Dom, Loc, Event, Type, SelectInput} from \"calendar.resourcebooking\";\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\nimport {PlannerPopup} from \"./controls/plannerpopup\";\n\nexport class EditFieldController\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.plannerPopup = null;\n\n\t\tthis.DOM = {\n\t\t\touterWrap: BX(params.controlId),\n\t\t\tvalueInputs: []\n\t\t};\n\n\t\tthis.isNew = !this.params.value || !this.params.value.DATE_FROM;\n\n\t\tif (this.params.socnetDestination)\n\t\t{\n\t\t\tResourcebookingUserfield.setSocnetDestination(this.params.socnetDestination);\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.buildUserfieldWrap();\n\t\tthis.createEventHandlers();\n\t\tthis.setControlValues();\n\t}\n\n\tbuildUserfieldWrap()\n\t{\n\t\tthis.buildDateControl();\n\t\tthis.buildTimeControl();\n\t\tthis.buildServiceControl();\n\t\tthis.buildDurationControl();\n\t\tthis.buildUserSelectorControl();\n\t\tthis.buildResourceSelectorControl();\n\t}\n\n\tcreateEventHandlers()\n\t{\n\t\tEvent.bind(this.DOM.outerWrap, 'click',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.fromInput, 'focus',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.durationInput, 'focus',this.showPlannerPopup.bind(this));\n\n\t\tsetTimeout(function(){\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldSetValidator',\n\t\t\t[\n\t\t\t\tthis.params.controlId,\n\t\t\t\tfunction(result)\n\t\t\t\t{\n\t\t\t\t\tif (!this.params.allowOverbooking && this.isOverbooked())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (result && result.addError && BX.Crm && BX.Crm.EntityValidationError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this}));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t}.bind(this)\n\t\t\t]);\n\t\t}.bind(this), 100);\n\n\t\tsetTimeout(this.onChangeValues.bind(this), 100);\n\t}\n\n\tsetControlValues()\n\t{\n\t\tthis.allValuesValue = null;\n\n\t\tlet\n\t\t\tdateFrom,\n\t\t\tduration,\n\t\t\tdefaultDuration = this.params.fullDay ? 1440 : 60, // One day or one hour as default\n\t\t\tdateTo;\n\n\t\tif (this.isNew)\n\t\t{\n\t\t\tlet params = ResourcebookingUserfield.getParamsFromHash(this.params.userfieldId);\n\t\t\tif (params && params.length > 1)\n\t\t\t{\n\t\t\t\tdateFrom = BX.parseDate(params[0]);\n\t\t\t\tdateTo = BX.parseDate(params[1]);\n\t\t\t\tif (dateFrom && dateTo)\n\t\t\t\t{\n\t\t\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!dateFrom)\n\t\t\t{\n\t\t\t\tdateFrom = new Date();\n\t\t\t\tlet\n\t\t\t\t\troundMin = 30,\n\t\t\t\t\tr = (roundMin || 10) * 60 * 1000,\n\t\t\t\t\ttimestamp = Math.ceil(dateFrom.getTime() / r) * r;\n\t\t\t\tdateFrom = new Date(timestamp);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdateFrom = BX.parseDate(this.params.value.DATE_FROM);\n\t\t\tdateTo = BX.parseDate(this.params.value.DATE_TO);\n\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t}\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = defaultDuration;\n\t\t}\n\n\t\tthis.DOM.fromInput.value = BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\t\tif (this.DOM.timeFromInput)\n\t\t{\n\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t}\n\n\t\tif (this.durationList)\n\t\t{\n\t\t\tthis.durationList.setValue(duration);\n\t\t}\n\n\t\tif (this.serviceList)\n\t\t{\n\t\t\tthis.serviceList.setValue(this.params.value.SERVICE_NAME || '');\n\t\t}\n\n\t\tlet selectedUsers = [];\n\t\tlet selectedResources = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.TYPE === 'user')\n\t\t\t\t{\n\t\t\t\t\tselectedUsers.push(parseInt(entry.RESOURCE_ID));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\tid: parseInt(entry.RESOURCE_ID),\n\t\t\t\t\t\ttype: entry.TYPE\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t}\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t}\n\t}\n\n\tbuildDateControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\n\t\tthis.DOM.dateWrap = this.DOM.dateTimeWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.fromInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: EditFieldController.showCalendarPicker,\n\t\t\t\tchange: this.triggerUpdatePlanner.bind(this)\n\t\t\t},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime'}\n\t\t}));\n\n\t\tthis.DOM.emptyInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {attrs: {value: '',type: 'text'}, props: {className: 'calendar-resbook-empty-input'}}));\n\t}\n\n\tbuildTimeControl()\n\t{\n\t\tif (!this.params.fullDay)\n\t\t{\n\t\t\tthis.DOM.timeWrap = this.DOM.dateTimeWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.timeFromInput = this.DOM.timeWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '100px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tthis.fromTime = new SelectInput({\n\t\t\t\tinput: this.DOM.timeFromInput,\n\t\t\t\tvalues: BookingUtil.getSimpleTimeList(),\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tonAfterMenuOpen: (ind, popupMenu) => {\n\t\t\t\t\tif (!ind && popupMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst formatDatetime = BX.isAmPmMode()\n\t\t\t\t\t\t\t? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '')\n\t\t\t\t\t\t\t: Loc.getMessage(\"FORMAT_DATETIME\");\n\t\t\t\t\t\tconst dateFrom = BookingUtil.parseDate(\n\t\t\t\t\t\t\tthis.DOM.fromInput.value + ' ' + this.DOM.timeFromInput.value,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tformatDatetime\n\t\t\t\t\t\t);\n\t\t\t\t\t\tlet i, menuItem;\n\t\t\t\t\t\tconst nearestTimeValue = BookingUtil.adaptTimeValue({\n\t\t\t\t\t\t\th: dateFrom.getHours(),\n\t\t\t\t\t\t\tm: dateFrom.getMinutes()\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (nearestTimeValue && nearestTimeValue.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (i = 0; i < popupMenu.menuItems.length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuItem = popupMenu.menuItems[i];\n\t\t\t\t\t\t\t\tif (menuItem\n\t\t\t\t\t\t\t\t\t&& nearestTimeValue.label === menuItem.text\n\t\t\t\t\t\t\t\t\t&& menuItem.layout)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpopupMenu.layout.menuContainer.scrollTop = menuItem.layout.item.offsetTop - 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildServiceControl()\n\t{\n\t\tif (this.params.useServices && Type.isArray(this.params.serviceList) && this.params.serviceList.length > 0)\n\t\t{\n\t\t\tif (this.params.fullDay)\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\t\t\t}\n\n\t\t\tthis.DOM.servicesWrap = this.DOM.durationWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.serviceInput = this.DOM.servicesWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\t//value: this.params.value.SERVICE_NAME || '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '200px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tlet serviceListValues = [];\n\t\t\tthis.params.serviceList.forEach(function(service)\n\t\t\t{\n\t\t\t\tif (service.name !== '')\n\t\t\t\t{\n\t\t\t\t\tserviceListValues.push({value: service.duration, label: service.name});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.isNew && serviceListValues.length >= 1)\n\t\t\t{\n\t\t\t\tthis.DOM.serviceInput.value = serviceListValues[0].label;\n\t\t\t\t//duration = parseInt(serviceListValues[0].value);\n\t\t\t}\n\n\t\t\tthis.serviceList = new SelectInput({\n\t\t\t\tinput: this.DOM.serviceInput,\n\t\t\t\tvalues: serviceListValues,\n\t\t\t\tonChangeCallback: function(state)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(state) && state.realValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.durationList.setValue(parseInt(state.realValue));\n\t\t\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildDurationControl()\n\t{\n\t\tif (!this.DOM.durationWrap)\n\t\t{\n\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t}\n\n\t\t// region Duration\n\t\tthis.DOM.durationControlWrap = this.DOM.durationWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.durationInput = this.DOM.durationControlWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\t//value: duration,\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tstyle: {width: '90px'},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t}));\n\n\t\t//this.duration = parseInt(duration);\n\t\tthis.durationList = new SelectInput({\n\t\t\tinput: this.DOM.durationInput,\n\t\t\tvalues: BookingUtil.getDurationList(this.params.fullDay),\n\t\t\t//value: duration,\n\t\t\tonChangeCallback: function()\n\t\t\t{\n\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t}.bind(this)\n\t\t});\n\t}\n\n\tbuildUserSelectorControl()\n\t{\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-resbook-users-selector-wrap'}\n\t\t\t}));\n\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-control-field'}}));\n\n\t\t\tlet userSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.userSelectorWrap\n\t\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-title'}}))\n\t\t\t\t.appendChild(Dom.create('SPAN', {props: {className: 'calendar-resourcebook-content-block-title-text'}, text: userSelectorTitle}));\n\t\t\tthis.DOM.userListWrap = this.DOM.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tthis.userSelector = new UserSelectorFieldEditControl({\n\t\t\t\twrapNode: this.DOM.userListWrap,\n\t\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\t\taddMessage: Loc.getMessage('USER_TYPE_RESOURCE_SELECT_USER'),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationAddNewItem', this.triggerUpdatePlanner.bind(this));\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationUnselect', this.triggerUpdatePlanner.bind(this));\n\t\t}\n\t}\n\n\tbuildResourceSelectorControl()\n\t{\n\t\tif (this.params.useResources)\n\t\t{\n\t\t\tthis.DOM.resourcesWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\t\tlet resSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.resourcesWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: resSelectorTitle}));\n\t\t\tthis.DOM.resourcesListWrap = this.DOM.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tthis.resourceSelector = new ResourceSelectorFieldEditControl({\n\t\t\t\touterWrap: this.DOM.resourcesWrap,\n\t\t\t\tblocksWrap: this.DOM.resourcesListWrap,\n\t\t\t\tvalues: [],\n\t\t\t\tresourceList: this.params.resourceList,\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showCalendarPicker(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tBX.calendar({node: target, field: target, bTime: false});\n\t\tBX.focus(target);\n\t}\n\n\tonChangeValues()\n\t{\n\t\tthis.duration = this.duration || BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\tconst duration = this.duration * 60;\n\t\tlet\n\t\t\tallValuesValue = '',\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tdateFrom,\n\t\t\tdateFromValue = '',\n\t\t\tserviceName = this.DOM.serviceInput ? this.DOM.serviceInput.value : '',\n\t\t\tentries = [];\n\n\t\tdateFrom = this.params.fullDay ? BookingUtil.parseDate(this.DOM.fromInput.value) : BookingUtil.parseDate(this.DOM.fromInput.value + ' ' + this.DOM.timeFromInput.value, false, false, formatDatetime);\n\n\t\tif (Type.isDate(dateFrom))\n\t\t{\n\t\t\tif (this.params.useResources)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedResourceList());\n\t\t\t}\n\n\t\t\tif (this.params.useUsers)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedUserList());\n\t\t\t}\n\t\t\tdateFromValue = BookingUtil.formatDate(BookingUtil.getDateTimeFormat(), dateFrom.getTime() / 1000);\n\t\t}\n\n\t\t// Clear inputs\n\t\tthis.DOM.valueInputs.forEach(function(input){BX.remove(input);});\n\t\tthis.DOM.valueInputs = [];\n\n\t\tentries.forEach(function(entry)\n\t\t{\n\t\t\tlet value = entry.type + '|' + entry.id + '|' + dateFromValue + '|' + duration + '|' + serviceName;\n\t\t\tallValuesValue += value + '#';\n\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}, this);\n\n\n\t\tif (!entries.length)\n\t\t{\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: 'empty',\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}\n\n\t\tif (this.allValuesValue !== null && this.allValuesValue !== allValuesValue)\n\t\t{\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldExternalChanged', [this.params.controlId]);\n\t\t\tBX.fireEvent(this.DOM.emptyInput, 'change');\n\t\t}\n\t\tthis.allValuesValue = allValuesValue;\n\t}\n\n\tshowPlannerPopup()\n\t{\n\t\tlet currentEventList = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tcurrentEventList.push(entry.EVENT_ID);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isNull(this.plannerPopup))\n\t\t{\n\t\t\tthis.plannerPopup = new PlannerPopup();\n\t\t}\n\n\t\tthis.plannerPopup.show({\n\t\t\tplannerId: this.params.plannerId,\n\t\t\tbindNode: this.DOM.outerWrap,\n\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\tselector: this.getSelectorData(),\n\t\t\tselectorOnChangeCallback: this.plannerSelectorOnChange.bind(this),\n\t\t\tselectEntriesOnChangeCallback: this.plannerSelectedEntriesOnChange.bind(this),\n\t\t\tcheckSelectorStatusCallback: this.checkSelectorStatusCallback.bind(this),\n\t\t\tcurrentEventList: currentEventList\n\t\t});\n\n\t\tthis.triggerUpdatePlanner();\n\t}\n\n\ttriggerUpdatePlanner()\n\t{\n\t\tif (!Type.isNull(this.plannerPopup)\n\t\t\t&& this.plannerPopup.plannerId === this.params.plannerId\n\t\t\t&& this.plannerPopup.isShown())\n\t\t{\n\t\t\tthis.plannerPopup.update({\n\t\t\t\tplannerId: this.params.plannerId,\n\t\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\t\tselector: this.getSelectorData(),\n\t\t\t\tresourceList: this.getResourceList(),\n\t\t\t\tselectedResources: this.resourceSelector ? this.resourceSelector.getSelectedValues() : false,\n\t\t\t\tuserList: this.getUserList(),\n\t\t\t\tselectedUsers: this.userSelector ? this.userSelector.getSelectedValues() : false\n\t\t\t},\n\t\t\ttrue);\n\t\t}\n\n\t\tthis.onChangeValues();\n\t}\n\n\tgetPlannerConfig()\n\t{\n\t\tif (!this.params.plannerConfig)\n\t\t{\n\t\t\tthis.params.plannerConfig = {\n\t\t\t\tid: this.params.plannerId,\n\t\t\t\tselectEntriesMode: true,\n\t\t\t\tscaleLimitOffsetLeft: 2,\n\t\t\t\tscaleLimitOffsetRight: 2,\n\t\t\t\tmaxTimelineSize: 300,\n\t\t\t\tminEntryRows: 300,\n\t\t\t\tentriesListWidth: 120,\n\t\t\t\ttimelineCellWidth: 49,\n\t\t\t\tminWidth: 300,\n\t\t\t\taccuracy: 300,\n\t\t\t\tworkTime: [parseInt(this.params.workTime[0]), parseInt(this.params.workTime[1])]\n\t\t\t};\n\t\t}\n\n\t\tthis.params.plannerConfig.clickSelectorScaleAccuracy = Math.max((this.duration * 60) || 300, 3600);\n\n\t\treturn this.params.plannerConfig;\n\t}\n\n\tplannerSelectorOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId\n\t\t\t&& Type.isDate(params.dateFrom)\n\t\t\t&& Type.isDate(params.dateTo)\n\t\t)\n\t\t{\n\t\t\tlet\n\t\t\t\tdateFrom = params.dateFrom,\n\t\t\t\tdateTo = params.dateTo;\n\n\t\t\tthis.DOM.fromInput.value =  BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\n\t\t\tif (this.DOM.timeFromInput)\n\t\t\t{\n\t\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t\t}\n\n\t\t\t// Duration in minutes\n\t\t\tthis.duration = (dateTo.getTime() - dateFrom.getTime() + (this.params.fullDay ? BookingUtil.getDayLength() : 0)) / 60000;\n\t\t\tthis.duration = Math.round(Math.max(this.duration, 0));\n\t\t\tthis.durationList.setValue(this.duration);\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tplannerSelectedEntriesOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && Type.isArray(params.entries))\n\t\t{\n\t\t\tlet\n\t\t\t\tselectedResources = [],\n\t\t\t\tselectedUsers = [];\n\n\t\t\tparams.entries.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.selected)\n\t\t\t\t{\n\t\t\t\t\tif (entry.type === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedUsers.push(entry.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\t\tid: entry.id,\n\t\t\t\t\t\t\ttype: entry.type\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.resourceSelector)\n\t\t\t{\n\t\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t\t}\n\t\t\tif (this.userSelector)\n\t\t\t{\n\t\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t\t}\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tcheckSelectorStatusCallback(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && !this.params.allowOverbooking)\n\t\t{\n\t\t\tlet errorClass = 'calendar-resbook-error';\n\t\t\tthis.overbooked = params.status === 'busy';\n\n\t\t\tif (this.overbooked)\n\t\t\t{\n\t\t\t\tif (!this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.errorNode = this.DOM.dateTimeWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\t\t\tprops: {className: \"calendar-resbook-content-error-text\"},\n\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_BOOKED_ERROR')\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tsetTimeout(BX.delegate(function(){BX.focus(this.DOM.fromInput)}, this), 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this.DOM.errorNode);\n\t\t\t\t\tthis.DOM.errorNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectorData()\n\t{\n\t\tlet\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tselector, dateTo,\n\t\t\tduration = this.duration,\n\t\t\tdateFrom = BookingUtil.parseDate(this.DOM.fromInput.value + (this.DOM.timeFromInput ? ' ' + this.DOM.timeFromInput.value : ''), false, false, formatDatetime);\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = this.params.fullDay ? 1440 : 60;\n\t\t}\n\n\t\tif (!Type.isDate(dateFrom))\n\t\t{\n\t\t\tdateFrom = new Date();\n\t\t}\n\n\t\tdateTo = new Date(dateFrom.getTime() + duration * 60000 - (this.params.fullDay ? BookingUtil.getDayLength() : 0));\n\n\t\tselector = {\n\t\t\tfrom: dateFrom,\n\t\t\tto: dateTo,\n\t\t\tfullDay: this.params.fullDay,\n\t\t\tupdateScaleLimits: true\n\t\t};\n\n\t\treturn selector;\n\t}\n\n\tgetResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\tgetSelectedResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetUserList()\n\t{\n\t\tlet entries = [], index = {}, userId;\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tif (Type.isArray(this.params.userList))\n\t\t\t{\n\t\t\t\tthis.params.userList.forEach(function(userId){\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(code.substr(1));\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetSelectedUserList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tentries.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: parseInt(code.substr(1)),\n\t\t\t\t\t\t\ttype : 'user'\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn entries;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.params.resourceLimit <= 0 || this.getTotalResourceCount() <= this.params.resourceLimit;\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\t\tif (this.params.useResources && this.resourceSelector)\n\t\t{\n\t\t\tresult += this.resourceSelector.getValues().length;\n\t\t}\n\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tresult += this.getSelectedUserList().length;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tisOverbooked()\n\t{\n\t\treturn this.overbooked;\n\t}\n}\n","import {BookingUtil, Type, Dom, Loc, SelectInput} from \"calendar.resourcebooking\";\n\nexport class ServiceSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.outerCont = this.params.outerCont;\n\t\tthis.fieldSettings = this.params.fieldSettings || {};\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.serviceListOuterWrap = this.outerCont.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-service-list-wrap\"}}));\n\n\t\tthis.durationTitleId = 'duration-title-wrap-' + Math.round(Math.random() * 100000);\n\t\tthis.servicesTitleWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-inner\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-detail-resource\">' +\n\t\t\t\t\t'<div class=\"calendar-resourcebook-content-block-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"' + this.durationTitleId + '\" class=\"calendar-resourcebook-content-block-title calendar-resourcebook-content-block-duration-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t}));\n\n\t\tthis.serviceListRowsWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-inner\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail\"}}));\n\n\t\tBX.bind(this.serviceListRowsWrap, 'click', this.handlePopupClick.bind(this));\n\t\tif (Type.isArray(this.fieldSettings.SERVICE_LIST) && this.fieldSettings.SERVICE_LIST.length > 0)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST.forEach(function(service)\n\t\t\t{\n\t\t\t\tthis.addRow(service, false);\n\t\t\t}, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRow(false, false);\n\t\t}\n\n\t\tthis.serviceListAddWrap = this.serviceListOuterWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tthis.serviceAddButton = this.serviceListAddWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: \"calendar-resource-content-block-add-link calendar-resource-content-block-add-link-icon\"},\n\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICE'),\n\t\t\tevents: {click: this.addRow.bind(this)}\n\t\t}));\n\t\tBX.bind(window, 'resize', this.checkDurationTitlePosition.bind(this));\n\t\tthis.checkDurationTitlePosition();\n\n\t\tthis.show(this.fieldSettings.USE_SERVICES === 'Y');\n\t}\n\n\tshow(show)\n\t{\n\t\tif (show)\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = '';\n\t\t\tDom.addClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = 'none';\n\t\t\tDom.removeClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t}\n\n\taddRow(row, animation)\n\t{\n\t\tanimation = animation !== false;\n\n\t\tif (!Type.isPlainObject(row))\n\t\t{\n\t\t\trow = {name: '', duration: this.getDefaultDuration()}\n\t\t}\n\n\t\tlet service = {\n\t\t\touterWrap: this.serviceListRowsWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource calendar-resourcebook-service-row\"}}))\n\t\t};\n\n\t\tif (animation)\n\t\t{\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t\t}, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t}\n\n\t\tservice.wrap = service.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource-inner\"}}));\n\n\t\tservice.nameInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resourcebook-content-input calendar-resourcebook-service-input\",\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_PLACEHOLDER'),\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.name\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resbook-duration-input calendar-resbook-field-datetime-menu\",\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.duration\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationList = new SelectInput({\n\t\t\tinput: service.durationInput,\n\t\t\tgetValues: function(){\n\t\t\t\tlet fullday = false;\n\t\t\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t\t\t{\n\t\t\t\t\tfullday = this.params.getFullDayValue();\n\t\t\t\t}\n\t\t\t\treturn BookingUtil.getDurationList(fullday);\n\t\t\t}.bind(this),\n\t\t\tvalue: row.duration\n\t\t});\n\n\t\tservice.deleteWrap = service.wrap.appendChild(Dom.create(\"DIV\", {\n\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-delete\"},\n\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-delete calendar-resourcebook-content-block-control-delete-detail\"></span>'\n\t\t}));\n\n\t\t// Adjust outer wrap max height\n\t\tthis.serviceListOuterWrap.style.maxHeight = Math.max(500, this.serviceListRowsWrap.childNodes.length * 45 + 100) + 'px';\n\t}\n\n\tcheckDurationTitlePosition(timeout)\n\t{\n\t\tif (timeout !== false)\n\t\t{\n\t\t\tif (this.checkDurationTitlePositionTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.checkDurationTitlePositionTimeout);\n\t\t\t}\n\n\t\t\tthis.checkDurationTitlePositionTimeout = setTimeout(function(){\n\n\t\t\t\tthis.checkDurationTitlePosition(false);\n\t\t\t}.bind(this), 100);\n\t\t\treturn;\n\t\t}\n\n\t\tlet durationInput = this.serviceListOuterWrap.querySelector('input.calendar-resbook-duration-input');\n\t\tif (this.durationTitleId && BX(this.durationTitleId) && durationInput)\n\t\t{\n\t\t\tBX(this.durationTitleId).style.left = (durationInput.offsetLeft + 15) + 'px';\n\t\t}\n\t}\n\n\tgetDefaultDuration()\n\t{\n\t\tlet fullday = false;\n\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t{\n\t\t\tfullday = this.params.getFullDayValue();\n\t\t}\n\t\treturn fullday ? 1440 : 30;\n\t}\n\n\tclickHandler(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){Dom.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetValues(e)\n\t{\n\t\tlet\n\t\t\tserviceList = [],\n\t\t\tnameInput, durationInput,\n\t\t\ti, rows = this.serviceListRowsWrap.querySelectorAll('.calendar-resourcebook-service-row');\n\n\t\tfor (i = 0; i < rows.length; i++)\n\t\t{\n\t\t\tif (Dom.hasClass(rows[i], 'show'))\n\t\t\t{\n\t\t\t\tnameInput = rows[i].querySelector('input.calendar-resourcebook-service-input');\n\t\t\t\tdurationInput = rows[i].querySelector('input.calendar-resbook-duration-input');\n\n\t\t\t\tif (nameInput && durationInput)\n\t\t\t\t{\n\t\t\t\t\tserviceList.push({\n\t\t\t\t\t\tname: nameInput.value,\n\t\t\t\t\t\tduration: BookingUtil.parseDuration(durationInput.value)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn serviceList;\n\t}\n\n\tcheckRows()\n\t{\n\t\tlet serviceList = this.getValues();\n\t\tif (!serviceList.length)\n\t\t{\n\t\t\tthis.show(false);\n\t\t\tif (Type.isFunction(this.params.onFullClearHandler))\n\t\t\t{\n\t\t\t\tthis.params.onFullClearHandler();\n\t\t\t}\n\t\t\tthis.addRow(false, false);\n\t\t}\n\t}\n\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tBX.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){BX.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n}","import {Type, Dom, Loc} from \"calendar.resourcebooking\";\nexport class TimezoneSelector\n{\n\tstatic timezoneList;\n\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap\n\t\t};\n\t\tDom.addClass(this.DOM.outerWrap, 'fields enumeration field-item');\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.DOM.select = this.DOM.outerWrap.appendChild(Dom.create('select'));\n\t\tthis.DOM.select.options.add(\n\t\t\tnew Option(\n\t\t\t\tLoc.getMessage('USER_TYPE_LOADING_TIMEZONE_LIST'),\n\t\t\t\tthis.params.selectedValue || '',\n\t\t\t\ttrue,\n\t\t\t\ttrue)\n\t\t);\n\n\t\tthis.getTimezoneList().then(\n\t\t\tfunction(timezoneList)\n\t\t\t{\n\t\t\t\tDom.remove(this.DOM.select.options[0]);\n\t\t\t\ttimezoneList.forEach(function(timezone)\n\t\t\t\t{\n\t\t\t\t\tlet selected = this.params.selectedValue ? this.params.selectedValue === timezone.value : timezone.selected;\n\n\t\t\t\t\tthis.DOM.select.options.add(\n\t\t\t\t\t\tnew Option(\n\t\t\t\t\t\t\ttimezone.label,\n\t\t\t\t\t\t\ttimezone.value,\n\t\t\t\t\t\t\tselected,\n\t\t\t\t\t\t\tselected));\n\t\t\t\t}, this);\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetTimezoneList(params)\n\t{\n\t\tparams = params || {};\n\n\t\treturn new Promise((resolve) => {\n\t\t\tif (!TimezoneSelector.timezoneList || params.clearCache)\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getTimezoneList')\n\t\t\t\t\t.then(function (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tTimezoneSelector.timezoneList = [];\n\t\t\t\t\t\t\tfor (let key in response.data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(key))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tTimezoneSelector.timezoneList.push({\n\t\t\t\t\t\t\t\t\t\tvalue: response.data[key].timezone_id,\n\t\t\t\t\t\t\t\t\t\tlabel: response.data[key].title,\n\t\t\t\t\t\t\t\t\t\tselected: response.data[key].default\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\tfunction (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.DOM.select.value;\n\t}\n}\n\n\n\n\n\n\n\n","import {Type, Dom, Loc, Event} from \"calendar.resourcebooking\";\n\nexport class ModeSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.outerWrap = this.create();\n\t}\n\n\tcreate()\n\t{\n\t\tlet\n\t\t\twrapNode = Dom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-select calendar-resourcebook-mode-selector\"}\n\t\t\t\t}\n\t\t\t),\n\t\t\tmenuItems = [\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResources))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResources();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResourcesAndUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResourcesAndUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t],\n\t\t\tswitcherId = 'mode-switcher-' + Math.round(Math.random() * 100000);\n\n\n\t\tEvent.bind(wrapNode, 'click', function(){\n\t\t\tif (this.modeSwitcherPopup && this.modeSwitcherPopup.popupWindow && this.modeSwitcherPopup.popupWindow.isShown())\n\t\t\t{\n\t\t\t\treturn this.modeSwitcherPopup.close();\n\t\t\t}\n\n\t\t\tthis.modeSwitcherPopup = BX.PopupMenu.create(\n\t\t\t\tswitcherId,\n\t\t\t\twrapNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc : true,\n\t\t\t\t\tautoHide : true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 20,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.modeSwitcherPopup.show();\n\n\t\t\tBX.addCustomEvent(this.modeSwitcherPopup.popupWindow, 'onPopupClose', function()\n\t\t\t{\n\t\t\t\tBX.PopupMenu.destroy(switcherId);\n\t\t\t\tthis.modeSwitcherPopup = null;\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\n\t\tif (this.params.useUsers && !this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS');\n\t\t}\n\t\telse if (this.params.useUsers && this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS');\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES');\n\t\t}\n\n\t\treturn wrapNode;\n\t}\n\n\tgetOuterWrap()\n\t{\n\t\treturn this.outerWrap;\n\t}\n}\n","import {BookingUtil} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {TimezoneSelector} from \"./controls/timezoneselector\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\n\nexport let customizeCrmEntityEditor = function(CrmConfigurator)\n{\n\tlet Configurator = function()\n\t{\n\t\tConfigurator.superclass.constructor.apply(this);\n\t};\n\tBX.extend(Configurator, CrmConfigurator);\n\n\tConfigurator.create = function(id, settings)\n\t{\n\t\tlet self = new Configurator();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t};\n\n\tConfigurator.prototype.layout = function(options, params)\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif(!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {}\n\t\t}\n\n\t\tif(this._mode === BX.Crm.EntityEditorMode.view)\n\t\t{\n\t\t\tthrow \"EntityEditorUserFieldConfigurator. View mode is not supported by this control type.\";\n\t\t}\n\n\t\tthis.getBitrix24Limitation({\n\t\t\tcallback: BX.delegate(function(limit)\n\t\t\t{\n\t\t\t\tthis.RESOURCE_LIMIT = limit;\n\t\t\t}, this)\n\t\t});\n\n\t\tif(this._field)\n\t\t{\n\t\t\tthis.fieldInfo = this._field.getFieldInfo();\n\t\t}\n\t\telse if (!params.settings)\n\t\t{\n\t\t\treturn this.getDefaultUserfieldSettings({\n\t\t\t\tdisplayCallback: BX.delegate(function(settings)\n\t\t\t\t{\n\t\t\t\t\tthis.layout(options, {settings: settings});\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", {props: {className: \"calendar-resourcebook-content\"}});\n\t\tthis._innerWrapper = this._wrapper\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tvar\n\t\t\tfieldSettings = this.fieldInfo ? this.fieldInfo.SETTINGS : params.settings,\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [],\n\t\t\tisNew = this._field === null,\n\t\t\ttitle = this.getMessage(\"labelField\"),\n\t\t\tmanager = this._editor.getUserFieldManager(),\n\t\t\tlabel = this._field ? this._field.getTitle() : manager.getDefaultFieldLabel(this._typeId);\n\n\t\tthis.RESOURCE_LIMIT = fieldSettings.RESOURCE_LIMIT || 0;\n\n\t\t// region Field Title\n\t\tthis._labelInput = BX.create(\"input\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-widget-content-input\",\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tvalue: label\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t// Title\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-widget-content-block-title\" },\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-widget-content-block-title-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Input\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._labelInput ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Hr\n\t\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\t// region Users&Resources Mode selector\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\tvar optionWrapper = this._innerWrapper.appendChild(BX.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (fieldSettings.RESOURCES\n\t\t\t&& BX.type.isPlainObject(fieldSettings.RESOURCES['resource'])\n\t\t\t&& BX.type.isArray(fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tfieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tfieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this),\n\t\t\tcheckLimitCallbackForNew: this.checkResourceCountLimitForNewEntries.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// region Users Selector\n\t\tthis.userSelectorWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control\"}}));\n\n\t\tvar itemsSelected = [];\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tfieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\titemsSelected: itemsSelected,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// Region Data, Time and services\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis.timezoneSettingsWrap = optionWrapper.appendChild(\n\t\t\tBX.create(\"div\", {props: {\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-options\" },\n\t\t\t\tstyle: {display: fieldSettings.FULL_DAY === 'Y' ? 'none' : ''}\n\t\t\t}));\n\n\t\tthis.timezoneSettingsWrap.appendChild(BX.create(\"hr\", {props: {className: \"crm-entity-widget-hr\"}}));\n\t\tthis.timezoneSettingsWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_TIMEZONE_SETTINGS_TITLE') + ':'}));\n\n\t\tthis.timezoneSelectorWrap = this.timezoneSettingsWrap.appendChild(BX.create(\"div\", {\n\t\t\tstyle: {display: fieldSettings.USE_USER_TIMEZONE === 'Y' ? 'none' : ''}\n\t\t}));\n\n\t\tthis.timezoneSelectWrap = this.timezoneSelectorWrap\n\t\t\t.appendChild(BX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" }\n\t\t\t\t}\n\t\t\t));\n\n\n\t\tthis.timezoneSelector = new TimezoneSelector({\n\t\t\touterWrap: this.timezoneSelectWrap,\n\t\t\tselectedValue: fieldSettings.TIMEZONE\n\t\t});\n\n\t\tthis.useUserTimezoneCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_USER_TIMEZONE === 'Y'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.timezoneSettingsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.useUserTimezoneCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_USE_USER_TIMEZONE') })\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: BX.proxy(this.handleUserTimezoneCheckbox, this)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis._fulldayCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.FULL_DAY === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.handleFullDayMode, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._fulldayCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis._servicesCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick : BX.delegate(function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this._servicesCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._servicesCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tonFullClearHandler: function()\n\t\t\t{\n\t\t\t\tthis._servicesCheckBox.checked = false;\n\t\t\t}.bind(this),\n\t\t\tfieldSettings: fieldSettings,\n\t\t\tgetFullDayValue: function(){return this._fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\t//region Checkbox \"Is Required\"\n\t\tthis.additionaOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis._isRequiredCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: this._field && this._field.isRequired() } }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._isRequiredCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"isRequiredField\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Show Always\"\n\t\tthis._showAlwaysCheckBox = BX.create(\"input\", { props: { type: \"checkbox\" } });\n\t\tif(isNew)\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = BX.prop.getBoolean(this._settings, \"showAlways\", true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = this._field.checkOptionFlag(\n\t\t\t\tBX.Crm.EntityEditorControlOptions.showAlways\n\t\t\t);\n\t\t}\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._showAlwaysCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"showAlways\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Overbooking\"\n\t\tthis._overbookingCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: fieldSettings.ALLOW_OVERBOOKING === 'Y'} }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._overbookingCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-btn-container\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-primary\"},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_SAVE\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-light-border\" },\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.fieldSettings = fieldSettings;\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t};\n\n\tConfigurator.prototype.getDefaultUserfieldSettings = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getdefaultuserfieldsettings', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.displayCallback))\n\t\t\t\t{\n\t\t\t\t\tparams.displayCallback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.getBitrix24Limitation = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getbitrix24limitation', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.callback))\n\t\t\t\t{\n\t\t\t\t\tparams.callback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.onSaveButtonClick = function()\n\t{\n\t\tif(this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.RESOURCE_LIMIT > 0 && this.getTotalResourceCount() > this.RESOURCE_LIMIT)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t\treturn;\n\t\t}\n\n\t\tvar params =\n\t\t\t{\n\t\t\t\ttypeId: this._typeId,\n\t\t\t\tlabel: this._labelInput.value,\n\t\t\t\tmandatory: this._isRequiredCheckBox.checked,\n\t\t\t\tshowAlways: this._showAlwaysCheckBox.checked,\n\t\t\t\tmultiple: true\n\t\t\t};\n\n\t\tif(this._field)\n\t\t{\n\t\t\tparams[\"field\"] = this._field;\n\t\t}\n\n\t\tthis.fieldSettings.USE_RESOURCES = this.resourceList.isShown() ? 'Y' : 'N';\n\t\tthis.fieldSettings.USE_USERS = this.userList.isShown() ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES['resource']))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES = [];\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\n\t\t\tthis.resourceList.getDeletedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\t\t}\n\n\n\t\tif (this.fieldSettings && this.userList)\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS = [0];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tthis.fieldSettings.SELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.fieldSettings.USE_SERVICES = this._servicesCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.SERVICE_LIST = [];\n\t\tif (this._servicesCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST = this.serviceList.getValues();\n\t\t}\n\n\t\tthis.fieldSettings.FULL_DAY = this._fulldayCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.ALLOW_OVERBOOKING = this._overbookingCheckBox.checked ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings.FULL_DAY === 'N')\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = this.timezoneSelector.getValue();\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = this.useUserTimezoneCheckBox.checked ? 'Y' : 'N';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = '';\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = 'N';\n\t\t}\n\n\t\tparams[\"settings\"] = this.fieldSettings;\n\n\t\tBX.onCustomEvent(this, \"onSave\", [ this, params]);\n\t};\n\n\tConfigurator.prototype.getTotalResourceCount = function()\n\t{\n\t\tvar result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& BX.type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t{\n\t\t\t\t\tresult++;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimitForNewEntries = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimit = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.handleFullDayMode = function()\n\t{\n\t\tthis.timezoneSettingsWrap.style.display = this._fulldayCheckBox.checked ? 'none' : '';\n\t};\n\n\tConfigurator.prototype.handleUserTimezoneCheckbox = function()\n\t{\n\t\tthis.timezoneSelectorWrap.style.display = this.useUserTimezoneCheckBox.checked ? 'none' : '';\n\t};\n\n\n\treturn Configurator;\n};","export class CalendarViewSettingsSlider\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'calendar_custom_settings_' + Math.round(Math.random() * 1000000);\n\t\tthis.zIndex = 3100;\n\t\tthis.sliderId = \"calendar:resbook-settings-slider\";\n\n\t\tthis.SLIDER_WIDTH = 400;\n\t\tthis.SLIDER_DURATION = 80;\n\t\tthis.DOM = {};\n\n\t\tthis.params = params;\n\t}\n\n\tshow()\n\t{\n\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: BX.delegate(this.create, this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION\n\t\t});\n\n\t\tthis.hideHandler = this.hide.bind(this);\n\t\tthis.destroyHandler = this.destroy.bind(this);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onCloseComplete\", );\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\t// if (this.denyClose)\n\t\t\t// {\n\t\t\t// \tevent.denyAction();\n\t\t\t// }\n\t\t\t// else\n\t\t\t// {\n\t\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\t\t//}\n\t\t}\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", this.destroyHandler);\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t}\n\t}\n\n\tcreate()\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tlet html = '<div class=\"webform-buttons calendar-form-buttons-fixed\">' +\n\t\t\t'<span id=\"' + this.id + '_save\" class=\"webform-small-button webform-small-button-blue\">' + BX.message('USER_TYPE_RESOURCE_SAVE') + '</span>' +\n\t\t\t'<span id=\"' + this.id + '_close\" class=\"webform-button-link\">' + BX.message('USER_TYPE_RESOURCE_CLOSE') + '</span>' +\n\t\t\t'</div>' +\n\t\t\t'<div class=\"calendar-slider-calendar-wrap\">' +\n\t\t\t'<div class=\"calendar-slider-header\"><div class=\"calendar-head-area\"><div class=\"calendar-head-area-inner\"><div class=\"calendar-head-area-title\">' +\n\t\t\t'<span class=\"calendar-head-area-name\">' + BX.message('USER_TYPE_RESOURCE_SETTINGS') + \t\t\t'</span>' +\n\t\t\t'</div></div></div></div>' +\n\t\t\t'<div class=\"resource-booking-slider-workarea\"><div class=\"resource-booking-slider-content\"><div id=\"' + this.id + '_content\" class=\"resource-booking-settings\"></div></div></div></div>';\n\n\t\tpromise.fulfill(html);\n\t\tsetTimeout(this.initControls.bind(this), 100);\n\n\t\treturn promise;\n\t}\n\n\tinitControls()\n\t{\n\t\tthis.DOM.content = BX(this.id + '_content');\n\n\t\tBX.bind(BX(this.id + '_save'), 'click', this.save.bind(this));\n\t\tBX.bind(BX(this.id + '_close'), 'click', this.close.bind(this));\n\n\t\t// 1. Field\n\t\tif (this.params && BX.type.isArray(this.params.filterSelectValues))\n\t\t{\n\t\t\tthis.DOM.fieldOuterWrap = this.DOM.content.appendChild(BX.create('DIV', {attrs: {className: 'calendar-settings-control'}}));\n\t\t\tthis.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {\n\t\t\t\tattrs: {className: 'calendar-settings-control-name'},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_FILTER_NAME')\n\t\t\t}));\n\n\t\t\tthis.DOM.fieldSelect = this.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-container calendar-field-container-select'}}))\n\t\t\t\t.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-block'}}))\n\t\t\t\t.appendChild(BX.create('select', {attrs: {className: 'calendar-field calendar-field-select'}}));\n\n\t\t\tthis.params.filterSelectValues.forEach(function(value){\n\t\t\t\tthis.DOM.fieldSelect.options.add(\n\t\t\t\t\tnew Option(value.TEXT, value.VALUE, this.params.filterSelect === value.VALUE, this.params.filterSelect === value.VALUE));\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tlet entityType = this.params.entityType || 'none';\n\t\tBX.userOptions.save('calendar', 'resourceBooking', entityType, this.DOM.fieldSelect.value);\n\t\tthis.close();\n\t\tBX.reload();\n\t}\n}\n\n\n\n","import {Event, Dom, Loc, Type} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\n\nexport class AdminSettingsViewer\n{\n\tconstructor(params = {})\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.fieldSettings = Type.isPlainObject(this.params.settings) ? this.params.settings : {};\n\n\t\tthis.DOM = {\n\t\t\touterWrap: document.getElementById(this.params.outerWrapId),\n\t\t\tform: document.forms[this.params.formName]\n\t\t};\n\t}\n\n\tshowLayout()\n\t{\n\t\tif (!this.DOM.outerWrap || !this.DOM.form)\n\t\t\treturn;\n\n\t\tEvent.bind(this.DOM.form, 'submit', this.onSubmit.bind(this));\n\n\t\tDom.addClass(this.DOM.outerWrap, 'calendar-resourcebook-content calendar-resourcebook-content-admin-settings');\n\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tlet\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [];\n\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: this.fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.DOM.optionWrap = this.DOM.innerWrap.appendChild(Dom.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (this.fieldSettings.RESOURCES\n\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES['resource'])\n\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tthis.fieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\n\t\tthis.userSelectorWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\tlet itemsSelected = [];\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: this.params.socnetDestination,\n\t\t\titemsSelected: itemsSelected\n\t\t});\n\n\t\t// Region Data, Time and services\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis.DOM.fulldayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: { type: \"checkbox\", checked: this.fieldSettings.FULL_DAY === 'Y'}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.fulldayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis.DOM.useServicedayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: this.fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'click' : function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this.DOM.useServicedayCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.useServicedayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tfieldSettings: this.fieldSettings,\n\t\t\tgetFullDayValue: function(){return this.DOM.fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.DOM.overbookingCheckbox = Dom.create(\"input\", {props: {type: \"checkbox\", checked: this.fieldSettings.ALLOW_OVERBOOKING === 'Y'}});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.overbookingCheckbox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\t}\n\n\tonSubmit(e)\n\t{\n\t\tif (!this.DOM.inputsWrap)\n\t\t{\n\t\t\tthis.DOM.inputsWrap = this.DOM.outerWrap.appendChild(Dom.create(\"DIV\"));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.clean(this.DOM.inputsWrap);\n\t\t}\n\n\t\tlet inputName = this.params.htmlControl.NAME;\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_USERS]',\n\t\t\t\tvalue: this.userList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_RESOURCES]',\n\t\t\t\tvalue: this.resourceList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_SERVICES]',\n\t\t\t\tvalue: this.DOM.useServicedayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[FULL_DAY]',\n\t\t\t\tvalue: this.DOM.fulldayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[ALLOW_OVERBOOKING]',\n\t\t\t\tvalue: this.DOM.overbookingCheckbox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\t// Selected resources\n\t\tif (this.resourceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.resourceList.getSelectedValues().concat(this.resourceList.getDeletedValues()), inputName + '[SELECTED_RESOURCES]');\n\t\t}\n\n\t\t// // Selected users\n\t\tif (this.userList)\n\t\t{\n\t\t\tlet SELECTED_USERS = [];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tSELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, SELECTED_USERS, inputName + '[SELECTED_USERS]');\n\t\t}\n\n\t\tif (this.DOM.useServicedayCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.serviceList.getValues(), inputName + '[SERVICE_LIST]');\n\t\t}\n\t}\n\n\tprepareFormDataInputs(wrap, data, inputName)\n\t{\n\t\tdata.forEach(function(value, ind)\n\t\t{\n\t\t\tif (Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tlet k;\n\t\t\t\tfor (k in value)\n\t\t\t\t{\n\t\t\t\t\tif (value.hasOwnProperty(k))\n\t\t\t\t\t{\n\t\t\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\t\t\tattrs:{\n\t\t\t\t\t\t\t\tname: inputName + '[' + ind + '][' + k + ']',\n\t\t\t\t\t\t\t\tvalue: value[k],\n\t\t\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t\t\t}}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: inputName + '[' + ind + ']',\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}}));\n\t\t\t}\n\t\t}, this);\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (Type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tif (this.resourceList)\n\t\t\t{\n\t\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t\t{\n\t\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult++;\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcheckResourceCountLimitForNewEntries()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t}\n}","import {AdjustFieldController} from \"./adjustfieldcontroller\";\nimport {EditFieldController} from \"./editfieldcontroller\";\nimport {Type} from \"main.core\";\nimport {Resourcebooking, BookingUtil} from \"calendar.resourcebooking\";\nimport {customizeCrmEntityEditor} from \"./customizecrmentityeditor\"\nimport {CalendarViewSettingsSlider} from \"./calendarviewsettingsslider\"\nimport {AdminSettingsViewer} from \"./adminsettingsviewer\"\n\nexport {Resourcebooking, BookingUtil, AdminSettingsViewer};\nexport class ResourcebookingUserfield\n{\n\tstatic fieldParamsCache = {};\n\tstatic socnetDestination = null;\n\n\t/**\n\t * Creates instance of Resourcebooking field for crm form edit interface (not for live form)\n\t * and initialize it with given field params\n\t * Used in CRM webform module to display and adjust resourcebooking field\n\t *\n\t * @param {array} params - incoming data params\n\t */\n\tstatic initCrmFormFieldController(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {\n\t\t\t\tfield:{}\n\t\t\t};\n\t\t}\n\n\t\tlet bookingFieldParams = {};\n\t\tif (Type.isDomNode(params.field.node))\n\t\t{\n\t\t\tbookingFieldParams.outerWrap = params.field.node;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error(\"The argument \\\"params.field.node\\\" must be a DOM node.\");\n\t\t}\n\n\t\tbookingFieldParams.innerWrap = bookingFieldParams.outerWrap.querySelector('.crm-webform-resourcebooking-wrap');\n\t\tif (!bookingFieldParams.innerWrap)\n\t\t{\n\t\t\tthrow new Error(\"Can't find necessary DOM node \\\"div.crm-webform-resourcebooking-wrap\\\"\");\n\t\t}\n\n\t\tbookingFieldParams.name = params.field.name;\n\t\tbookingFieldParams.formName = 'FIELD[' + params.field.name + ']';\n\t\tbookingFieldParams.captionNode = params.field.lblCaption;\n\t\tbookingFieldParams.entityFieldName = params.field.entity_field_name;\n\t\tbookingFieldParams.entityName = params.field.dict.entity_field_name;\n\n\t\tbookingFieldParams.settings = {\n\t\t\tcaption: params.field.captionValue || params.field.dict.caption,\n\t\t\trequired: params.field.isRequired || params.field.dict.required,\n\t\t\tdata: (Type.isPlainObject(params.field.booking) && Type.isPlainObject(params.field.booking.settings_data))\n\t\t\t\t? params.field.booking.settings_data\n\t\t\t\t: (params.field.settingsData || [])\n\t\t};\n\n\t\tlet adjustFieldController = new AdjustFieldController(bookingFieldParams);\n\t\tadjustFieldController.init();\n\n\t\treturn adjustFieldController;\n\t}\n\n\tstatic initEditFieldController(params)\n\t{\n\t\tlet editFieldController = new EditFieldController(params);\n\t\teditFieldController.init();\n\n\t\treturn editFieldController;\n\t}\n\n\tstatic getCrmFieldConfigurator(id, settings)\n\t{\n\t\tif(window.BX && BX.Crm && Type.isFunction(BX.Crm.EntityEditorUserFieldConfigurator))\n\t\t{\n\t\t\treturn customizeCrmEntityEditor(BX.Crm.EntityEditorUserFieldConfigurator).create(id, settings);\n\t\t}\n\t}\n\n\tstatic getUserFieldParams(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet fieldName = params.fieldName || '';\n\n\t\t\tif (params.clearCache || !ResourcebookingUserfield.fieldParamsCache[params.fieldName])\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getfieldparams', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfieldname: params.fieldName,\n\t\t\t\t\t\tselectedUsers: params.selectedUsers || []\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tResourcebookingUserfield.fieldParamsCache[fieldName] = response.data;\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(ResourcebookingUserfield.fieldParamsCache[fieldName]);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getPluralMessage(messageId, number)\n\t{\n\t\tlet pluralForm, langId;\n\n\t\tlangId = BX.message('LANGUAGE_ID') || 'en';\n\t\tnumber = parseInt(number);\n\n\t\tif (number < 0)\n\t\t{\n\t\t\tnumber = -1*number;\n\t\t}\n\n\t\tif (langId)\n\t\t{\n\t\t\tswitch (langId)\n\t\t\t{\n\t\t\t\tcase 'ru':\n\t\t\t\tcase 'ua':\n\n\t\t\t\t\tif ((number % 10 === 1) && (number % 100 !== 11))\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = ((number%10 >= 2) && (number%10 <= 4) && ((number%100 < 10) || (number%100 >= 20)))\n\t\t\t\t\t\t\t? 1\n\t\t\t\t\t\t\t: 2;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pl':\n\t\t\t\t\tif (number <= 4)\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = number === 1 ? 0 : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = 2;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: // en, de and other languages\n\t\t\t\t\tpluralForm = (number !== 1) ? 1 : 0;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpluralForm = 1;\n\t\t}\n\n\t\treturn BX.message(messageId + '_PLURAL_' + pluralForm);\n\t}\n\n\tstatic getParamsFromHash(userfieldId)\n\t{\n\t\tlet\n\t\t\tparams, regRes,\n\t\t\thash = unescape(window.location.hash);\n\n\t\tif (hash)\n\t\t{\n\t\t\tregRes = new RegExp('#calendar:' + userfieldId + '\\\\|(.*)', 'ig').exec(hash);\n\t\t\tif (regRes && regRes.length > 1)\n\t\t\t{\n\t\t\t\tparams = regRes[1].split('|');\n\t\t\t}\n\t\t}\n\t\treturn params;\n\t}\n\n\tstatic openExternalSettingsSlider(params)\n\t{\n\t\tlet settingsSlider = new CalendarViewSettingsSlider(params);\n\t\tsettingsSlider.show();\n\t}\n\n\tstatic setSocnetDestination(socnetDestination)\n\t{\n\t\tResourcebookingUserfield.socnetDestination = socnetDestination;\n\t}\n\n\tstatic getSocnetDestination()\n\t{\n\t\treturn ResourcebookingUserfield.socnetDestination;\n\t}\n}"],"names":["FormFieldTunnerAbstract","label","formLabel","displayed","valuePopup","statePopup","displayCheckboxDisabled","DOM","params","updateConfig","fieldWrap","Dom","create","props","className","labelWrap","appendChild","labelNode","text","getLabel","formTitleWrap","isDisplayed","formTitleLabel","getFormLabel","events","click","enableFormTitleEditMode","bind","formTitleEditIcon","checkboxNode","attrs","type","value","checked","disabled","checkDisplayMode","buildStatePopup","wrap","config","buildValuePopup","Type","isFunction","changeSettingsCallback","closePopup","setFormLabel","show","displayInForm","hideInForm","addClass","triggerChangeRefresh","removeClass","formTitleInputNode","blur","finishFormTitleEditMode","style","display","focus","adjust","setTimeout","BX","onCustomEvent","FormFieldTunnerPopupAbstract","id","Math","round","random","menuItems","outerWrap","handleClickFunc","handleClick","innerWrap","currentStateLink","getCurrentModeState","showPopup","isPopupShown","getMenuItems","Event","unbind","document","popup","PopupMenu","closeByEsc","autoHide","offsetTop","offsetLeft","cacheable","popupWindow","setAngle","offset","position","popupContainer","forEach","menuItem","inputType","inputNameStr","dataset","menuItemClassName","inputName","innerHtml","textValue","layout","item","innerHTML","close","maxHeight","isShown","isNodeInDom","e","target","srcElement","hasAttribute","findParent","attribute","handleControlChanges","changesTimeout","clearTimeout","delegate","isParentForNode","animation","FormFieldTunnerValuePopupAbstract","selectedValues","valueLink","getCurrentValueState","mouseover","showHoverPopup","mouseout","hideHoverPopup","PopupWindow","loseByEsc","width","getPopupWidth","lightShadow","content","getPopupContent","proxy","handlePopupClick","addCustomEvent","handlePopupCloose","destroy","message","minWidth","minHeight","hidePopupLoader","popupLoader","BookingUtil","getLoader","remove","FormFieldTunnerMultipleChecknoxPopupAbstract","values","push","util","htmlspecialchars","title","onclick","menuItemClick","length","selectAllMessage","selectAllItemClick","find","itemId","selectAllChecked","selectAllcheckbox","checkbox","querySelector","foundValue","hasClass","selectItem","deselectItem","in_array","index","array_search","deleteFromArray","i","checkboxes","querySelectorAll","UserSelectorFieldTunner","Loc","getMessage","selectedUsers","defaultMode","UsersStatePopup","isArray","selected","split","valueWrap","Tag","render","usersValueLink","showUserSelectorDialog","getCurrentUsersValueText","count","ResourcebookingUserfield","getPluralMessage","userSelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","map","userId","enableSearch","zIndex","handleUserSelectorChanges","entities","options","inviteGuestLink","emailUsers","getSelectedItems","entityId","EventEmitter","emit","setEnabled","setDisabled","getDefaultMode","name","build","submenuClass","html","isDomNode","nodeName","toLowerCase","ResourceSelectorFieldTunner","multiple","ResourcesStatePopup","ResourcesValuePopup","getMultiple","getSelectedId","delimiter","selectedItems","selectedIndex","selectAll","isString","resources","resource","valueId","prepareValueId","result","getSelectedValues","val","parseInt","ServiceSelectorFieldTunner","ServiceValuePopup","undefined","translit","services","service","getDurationLabel","duration","DurationSelectorFieldTunner","defaultValue","manualInput","DurationStatePopup","getDefaultValue","getManualInput","durationList","getDurationList","fullDay","getDurationLabelByValue","items","getDefaultMenuItems","concat","foundDuration","DateSelectorFieldTunner","start","DateStatePopup","getStyle","getStart","styleInputName","startInputName","TimeSelectorFieldTunner","showOnlyFree","showFinishTime","scale","TimeStatePopup","getShowFinishTime","getShowOnlyFree","getScale","stateShowFreeId","stateShowFinishId","getDurationMenuItems","filter","AdjustFieldController","setEventNamespace","complexFields","userFieldParams","settingsData","getSettingsData","settings","data","settingsWrap","captionNode","settingsInputs","showFieldLoader","getUserFieldParams","fieldName","entityName","getSelectedUsers","then","fieldParams","hideFieldLoader","fieldLayout","FieldViewControllerEdit","displayTitle","getCaption","getSettings","updateSettingsDataInputs","BaseEvent","settingsPopupId","settingsPopup","getSettingsContentNode","overlay","backgroundColor","opacity","titleBar","closeIcon","buttons","PopupWindowButton","buttonNodeWrap","buttonNode","parentNode","destroyControls","previewFieldLayout","leftWrap","buildSettingsForm","previewWrap","FieldViewControllerPreview","handleWebformSettingsChanges","titleId","captionWrap","captionInput","change","updateCaption","keyup","fieldsOuterWrap","fieldsWrap","userfieldSettings","useUsers","buildComplexField","updateSettings","users","checkBitrix24Limitation","useResources","useServices","date","time","replace","k","hasOwnProperty","refreshLayoutTimeout","getValue","refreshLayout","getOuterWrap","getInnerWrap","offsetHeight","isObject","field","option","isPlainObject","updateSettingsInputValue","key","uniKey","join","formName","fieldLoader","SETTINGS","SELECTED_RESOURCES","SELECTED_USERS","SERVICE_LIST","FULL_DAY","USE_RESOURCES","USE_USERS","USE_SERVICES","resourceLimit","RESOURCE_LIMIT","userIndex","USER_INDEX","caption","updateTitle","required","requiredCheckbox","usersValue","showLimitationPopup","clone","getDefaultSettingsData","UserSelectorFieldEditControl","wrapNode","destinationInputName","selectGroups","addMessage","checkLimit","checkLimitCallback","itemsSelected","convertAttendeesCodes","getSocnetDestinationConfig","shown","SocNetLogDestination","deleteItem","getAttribute","block","openDialog","socnetDestinationInputWrap","socnetDestinationInput","keydown","searchBeforeHandler","inputId","searchHandler","linkId","sendAjax","socnetDestinationLink","init","_this","itemsLast","groups","department","sonetgroups","searchInput","extranetUser","userSearchArea","bindMainPopup","node","bindSearchPopup","callback","select","selectCallback","unSelect","unSelectCallback","openDialogCallback","closeDialog","closeDialogCallback","openSearch","closeSearch","departmentSelectDisable","isOpenDialog","addUserBlock","getAttendeesCodesList","includes","blocks","itemWrap","elements","findChildren","j","cleanInputValue","isOpenSearch","backspaceDisable","window","keyCode","preventDefault","inputsList","getElementsByTagName","codes","trim","attendeesCodes","code","substr","getAttendeesCodes","res","socnetDestination","USERS","EXTRANET_USER","DENY_TOALL","UA","SONETGROUPS","DEPARTMENT","departmentRelation","DEPARTMENT_RELATION","LAST","SELECTED","inputs","userList","trigerOnChange","user","obItems","onChangeCallback","ResourceSelectorFieldEditControl","editMode","resourceList","checkLimitForNew","checkLimitCallbackForNew","selectedValuesIndex","selectedBlocks","newValues","blocksWrap","listWrap","controlsWrap","arrowNode","setValues","addButton","addResourceBlock","selectButton","openResourcesPopup","handleBlockClick","blockValue","element","checkBlockWrapState","isResourcesPopupShown","deleted","foundResource","removeResourceBlock","checkResourceInputs","menuItemNode","textNode","offsetWidth","B24","blockEntry","input","placeholder","resourceType","resourceId","delButton","focusInput","transparent","children","max","childNodes","emptyPlaceholder","closeResourcesPopup","addToSelectedValues","PlannerPopup","bindNode","plannerId","plannerConfig","lastPlannerIdShown","currentEntries","plannerWrap","bindPos","pos","winSize","GetWindowSize","plannerWidth","innerWidth","right","showPlanner","refreshParams","codeIndex","fromTimestamp","toTimestamp","dateFrom","dateTo","lastUpdateParams","focusSelector","from","to","parseDate","getTime","selector","getDayLength","Date","scaleDateFrom","scaleDateTo","requestData","formatDate","currentEventList","checkUpdateParams","showPlannerLoader","ajax","runAction","response","hidePlannerLoader","lastRequestData","entries","currentAccessibility","accessibility","currentLoadedDataFrom","currentLoadedDataTo","entry","selectedResources","updateScaleLimits","loadedDataFrom","loadedDataTo","requestPlannerUpdate","lastRequestPlannerId","array_diff","resIndex","planner","CalendarPlanner","updateScaleType","RRULE","selectorOnChangeCallback","selectEntriesOnChangeCallback","checkSelectorStatusCallback","update","loader","removeCustomEvent","getPlannerId","EditFieldController","plannerPopup","controlId","valueInputs","isNew","DATE_FROM","setSocnetDestination","buildUserfieldWrap","createEventHandlers","setControlValues","buildDateControl","buildTimeControl","buildServiceControl","buildDurationControl","buildUserSelectorControl","buildResourceSelectorControl","showPlannerPopup","fromInput","durationInput","allowOverbooking","isOverbooked","addError","Crm","EntityValidationError","Promise","resolve","onChangeValues","allValuesValue","defaultDuration","getParamsFromHash","userfieldId","roundMin","r","timestamp","ceil","DATE_TO","getDateFormat","timeFromInput","getTimeFormatShort","setValue","serviceList","SERVICE_NAME","ENTRIES","TYPE","RESOURCE_ID","resourceSelector","userSelector","dateTimeWrap","dateWrap","showCalendarPicker","triggerUpdatePlanner","emptyInput","timeWrap","fromTime","SelectInput","getSimpleTimeList","onAfterMenuOpen","ind","popupMenu","formatDatetime","isAmPmMode","nearestTimeValue","adaptTimeValue","h","getHours","m","getMinutes","menuContainer","scrollTop","durationWrap","servicesWrap","serviceInput","serviceListValues","state","realValue","parseDuration","durationControlWrap","userSelectorWrap","userSelectorTitle","userListWrap","getSocnetDestination","checkResourceCountLimit","resourcesWrap","resSelectorTitle","resourcesListWrap","dateFromValue","serviceName","isDate","getSelectedResourceList","getSelectedUserList","getDateTimeFormat","fireEvent","EVENT_ID","isNull","getPlannerConfig","getSelectorData","plannerSelectorOnChange","plannerSelectedEntriesOnChange","getResourceList","getUserList","selectEntriesMode","scaleLimitOffsetLeft","scaleLimitOffsetRight","maxTimelineSize","minEntryRows","entriesListWidth","timelineCellWidth","accuracy","workTime","clickSelectorScaleAccuracy","errorClass","overbooked","status","errorNode","getValues","getTotalResourceCount","calendar","bTime","ServiceSelector","outerCont","fieldSettings","serviceListOuterWrap","durationTitleId","servicesTitleWrap","serviceListRowsWrap","addRow","serviceListAddWrap","serviceAddButton","checkDurationTitlePosition","row","getDefaultDuration","nameInput","fullday","getFullDayValue","deleteWrap","timeout","checkDurationTitlePositionTimeout","left","resWrap","checkRows","rows","onFullClearHandler","TimezoneSelector","add","Option","selectedValue","getTimezoneList","timezoneList","timezone","clearCache","timezone_id","default","ModeSelector","showResources","modeSwitcherPopup","showUsers","showResourcesAndUsers","switcherId","angle","customizeCrmEntityEditor","CrmConfigurator","Configurator","superclass","constructor","apply","extend","self","initialize","prototype","_hasLayout","_mode","EntityEditorMode","view","getBitrix24Limitation","limit","_field","fieldInfo","getFieldInfo","getDefaultUserfieldSettings","displayCallback","_wrapper","_innerWrapper","selectedResourceList","manager","_editor","getUserFieldManager","getTitle","getDefaultFieldLabel","_typeId","_labelInput","hide","optionWrapper","resourcesTitleWrap","resourcesListLowControls","RESOURCES","SECTIONS","ID","NAME","CAL_TYPE","checkResourceCountLimitForNewEntries","usersTitleWrap","usersListWrap","datetimeOptionsWrap","datetimeOptionsInnerWrap","timezoneSettingsWrap","timezoneSelectorWrap","USE_USER_TIMEZONE","timezoneSelectWrap","timezoneSelector","TIMEZONE","useUserTimezoneCheckBox","handleUserTimezoneCheckbox","_fulldayCheckBox","handleFullDayMode","_servicesCheckBox","additionaOptionsWrap","_isRequiredCheckBox","isRequired","_showAlwaysCheckBox","prop","getBoolean","_settings","checkOptionFlag","EntityEditorControlOptions","showAlways","_overbookingCheckBox","ALLOW_OVERBOOKING","onSaveButtonClick","onCancelButtonClick","registerLayout","_isLocked","typeId","mandatory","getDeletedValues","CalendarViewSettingsSlider","sliderId","SLIDER_WIDTH","SLIDER_DURATION","SidePanel","Instance","open","contentCallback","animationDuration","hideHandler","destroyHandler","event","getSliderPage","getUrl","promise","fulfill","initControls","save","filterSelectValues","fieldOuterWrap","fieldSelect","TEXT","VALUE","filterSelect","entityType","userOptions","reload","AdminSettingsViewer","getElementById","outerWrapId","form","forms","onSubmit","optionWrap","fulldayCheckBox","useServicedayCheckBox","overbookingCheckbox","inputsWrap","clean","htmlControl","prepareFormDataInputs","bookingFieldParams","Error","lblCaption","entityFieldName","entity_field_name","dict","captionValue","booking","settings_data","adjustFieldController","editFieldController","EntityEditorUserFieldConfigurator","fieldParamsCache","fieldname","messageId","number","pluralForm","langId","regRes","hash","unescape","location","RegExp","exec","settingsSlider"],"mappings":"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"}