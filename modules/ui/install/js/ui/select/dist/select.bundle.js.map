{"version":3,"file":"select.bundle.js","sources":["../src/select.js"],"sourcesContent":["import { Type, Dom, Tag, Loc, bind } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, Popup, MenuItemOptions, PopupOptions } from 'main.popup';\nimport './select.css';\nimport 'ui.';\n\nexport type SelectOption = {\n\tlabel: string;\n\tvalue: string;\n}\n\nexport type SelectOptions = {\n\toptions: SelectOption[];\n\tvalue: string;\n\tplaceholder: string;\n\tisSearchable: boolean;\n\tcontainerClassname: string;\n\tpopupParams: PopupOptions;\n}\n\nconst ScrollDirection = Object.freeze({\n\tTOP: -1,\n\tBOTTOM: 1,\n\tNONE: 0,\n});\n\nexport class Select extends EventEmitter\n{\n\t#placeholder: string = '';\n\t#isSearchable: boolean = false;\n\t#isSearching: boolean = false;\n\t#searchValue: string = '';\n\t#selectedOption: SelectOption | null = null;\n\t#options: SelectOption[] = [];\n\t#container: HTMLElement | null = null;\n\t#containerClassname: string = '';\n\t#menu: Menu | null = null;\n\t#emptySearchPopup: Popup | null = null;\n\t#highlightedOptionIndex: number = 0;\n\t#popupParams: PopupOptions = {};\n\n\tconstructor(options: SelectOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Select');\n\t\tthis.#placeholder = Type.isString(options.placeholder) ? options.placeholder : '';\n\t\tthis.#isSearchable = options.isSearchable === true || false;\n\t\tthis.#options = Array.isArray(options.options) ? options.options : [];\n\t\tthis.#popupParams = Type.isPlainObject(options.popupParams) ? options.popupParams : {};\n\t\tthis.#selectedOption = this.#findOptionByValue(options.value) || null;\n\t\tthis.#containerClassname = Type.isString(options?.containerClassname) ? options.containerClassname : '';\n\t\tthis.#highlightedOptionIndex = this.#getOptionIndex(this.#selectedOption?.value) || 0;\n\t\tthis.#renderContainer();\n\t}\n\n\trenderTo(targetContainer: HTMLElement): HTMLElement | null\n\t{\n\t\tif (Type.isDomNode(targetContainer))\n\t\t{\n\t\t\tDom.clean(targetContainer);\n\t\t\tthis.#renderContainer();\n\t\t\tDom.append(this.#container, targetContainer);\n\n\t\t\treturn targetContainer;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#renderContainer(): HTMLElement\n\t{\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"${this.#getContainerClassname()}\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<input\n\t\t\t\t\tref=\"input\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"${this.#placeholder}\"\n\t\t\t\t\t${this.#isInputReadonly() ? 'readonly' : ''}\n\t\t\t\t\tvalue=\"${this.#selectedOption?.label || ''}\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t`;\n\n\t\tbind(this.#container.input, 'input', this.#handleInput.bind(this));\n\t\tbind(this.#container.input, 'focus', this.#handleFocus.bind(this));\n\t\tbind(this.#container.input, 'blur', this.#handleBlur.bind(this));\n\t\tbind(this.#container.input, 'mouseup', this.#handleInputClick.bind(this));\n\t\tbind(this.#container.input, 'keydown', this.#handleKeyDown.bind(this));\n\n\t\tthis.#container = this.#container.root;\n\n\t\treturn this.#container;\n\t}\n\n\t#isInputReadonly(): boolean\n\t{\n\t\treturn !this.#isSearchable || (!this.isMenuShown() && !this.#emptySearchPopup);\n\t}\n\n\t#handleInputClick(): void\n\t{\n\t\tif (this.getInput() === document.activeElement)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.showMenu();\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\tshowMenu(): void\n\t{\n\t\tif (!this.#menu)\n\t\t{\n\t\t\tthis.#createMenu();\n\t\t}\n\n\t\tthis.#menu.show();\n\t\tthis.#updateMenu();\n\t}\n\n\t#createMenu(): Menu\n\t{\n\t\tconst { width } = Dom.getPosition(this.#container);\n\t\tconst events = this.#popupParams?.events ?? {};\n\t\tthis.#menu = new Menu({\n\t\t\twidth,\n\t\t\tbindElement: this.#container,\n\t\t\titems: this.#getMenuItems(),\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: false,\n\t\t\tclassName: 'select-menu-popup',\n\t\t\t...this.#popupParams,\n\t\t\tevents: {\n\t\t\t\t...events,\n\t\t\t\tonAfterClose: () => {\n\t\t\t\t\tif (!this.#emptySearchPopup)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#searchValue = '';\n\t\t\t\t\t\tthis.#setSelectedOption(this.#selectedOption);\n\t\t\t\t\t\tthis.#updateSelect();\n\t\t\t\t\t\tif (events.onAfterClose)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevents.onAfterClose();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.#menu;\n\t}\n\n\thideMenu(): void\n\t{\n\t\tif (this.#menu)\n\t\t{\n\t\t\tthis.#menu.close();\n\t\t}\n\t}\n\n\t#getMenuItems(): MenuItemOptions[]\n\t{\n\t\tif (this.#isSearching)\n\t\t{\n\t\t\treturn this.#getFilteredOptions()\n\t\t\t\t.map((option, index) => {\n\t\t\t\t\treturn this.#getMenuItemFromOption(option, index === this.#highlightedOptionIndex);\n\t\t\t\t});\n\t\t}\n\n\t\treturn this.#options.map((option, index) => {\n\t\t\treturn this.#getMenuItemFromOption(option, index === this.#highlightedOptionIndex);\n\t\t});\n\t}\n\n\t#handleInput(e): void\n\t{\n\t\te.preventDefault();\n\t\tthis.#highlightedOptionIndex = 0;\n\t\tthis.#isSearching = true;\n\t\tthis.#searchValue = e.target.value;\n\t\tthis.#updateMenu();\n\t}\n\n\t#handleKeyDown(e): void\n\t{\n\t\tconst { keyCode } = e;\n\t\tconst arrowUpKeyCode = 38;\n\t\tconst arrowDownKeyCode = 40;\n\t\tconst enterKeyCode = 13;\n\t\tconst spaceKeyCode = 32;\n\n\t\t// eslint-disable-next-line default-case\n\t\tswitch (keyCode)\n\t\t{\n\t\t\tcase enterKeyCode: this.#handleEnterKey(e); break;\n\t\t\tcase spaceKeyCode: this.#handleSpaceKey(e); break;\n\t\t\tcase arrowUpKeyCode: this.#handleArrowUpKey(e); break;\n\t\t\tcase arrowDownKeyCode: this.#handleArrowDownKey(e); break;\n\t\t}\n\t}\n\n\t#handleSpaceKey(e): void\n\t{\n\t\tif (!this.isMenuShown() && !this.#emptySearchPopup)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\tthis.showMenu();\n\t\t\tthis.#updateSelect();\n\t\t}\n\t}\n\n\t#handleArrowUpKey(e): void\n\t{\n\t\te.preventDefault();\n\t\tif (!this.isMenuShown() || this.#highlightedOptionIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#highlightedOptionIndex--;\n\n\t\tthis.#scrollToHighlightedItem();\n\t\tthis.#highlightOption(this.#highlightedOptionIndex);\n\t}\n\n\t#handleArrowDownKey(e): void\n\t{\n\t\te.preventDefault();\n\t\tif (!this.isMenuShown() || this.#highlightedOptionIndex === this.#getMenuItems().length - 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#highlightedOptionIndex++;\n\t\tthis.#scrollToHighlightedItem();\n\t\tthis.#highlightOption(this.#highlightedOptionIndex);\n\t}\n\n\t#handleEnterKey(e): void\n\t{\n\t\te.preventDefault();\n\t\tconst options = this.#getFilteredOptions();\n\t\tthis.#selectedOption = options[this.#highlightedOptionIndex];\n\t\tthis.hideMenu();\n\t}\n\n\t#updateMenu(): void\n\t{\n\t\tif (!this.#menu)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#options.forEach(({ value }) => {\n\t\t\tthis.#menu.removeMenuItem(value, {\n\t\t\t\tdestroyEmptyPopup: false,\n\t\t\t});\n\t\t});\n\n\t\tconst filteredOptions = this.#getFilteredOptions(this.#searchValue);\n\n\t\tif (filteredOptions.length > 0)\n\t\t{\n\t\t\tif (!this.isMenuShown())\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t\tthis.#hideEmptySearchPopup();\n\t\t\tfilteredOptions.forEach((option, index) => {\n\t\t\t\tthis.#menu.addMenuItem(this.#getMenuItemFromOption(option, index === this.#highlightedOptionIndex), null);\n\t\t\t});\n\n\t\t\tthis.#scrollToHighlightedItem();\n\t\t\tthis.#highlightOption(this.#highlightedOptionIndex);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showEmptySearchPopup();\n\t\t\tthis.hideMenu();\n\t\t}\n\t}\n\n\t#getMenuItemFromOption(option, isHoverOption: boolean = false): MenuItemOptions\n\t{\n\t\tconst isHover = isHoverOption === true;\n\t\tconst className = `ui-select__menu-item menu-popup-no-icon ${isHover ? 'menu-popup-item-open' : ''}`;\n\n\t\treturn ({\n\t\t\tid: option.value,\n\t\t\ttext: option.label,\n\t\t\tonclick: () => {\n\t\t\t\tthis.#selectedOption = option;\n\t\t\t},\n\t\t\tclassName,\n\t\t});\n\t}\n\n\t#getFilteredOptions(): SelectOption[]\n\t{\n\t\treturn this.#options.filter(this.#getOptionFilter(this.#searchValue));\n\t}\n\n\t#getOptionFilter(searchStr): (option: SelectOption) => boolean\n\t{\n\t\tconst lowerCaseSearchStr = Type.isString(searchStr) ? searchStr.toLowerCase() : '';\n\n\t\treturn (option) => {\n\t\t\tconst lowerCaseOptionLabel = option.label.toLowerCase();\n\n\t\t\treturn lowerCaseOptionLabel.indexOf(lowerCaseSearchStr) === 0;\n\t\t};\n\t}\n\n\t#showEmptySearchPopup(): void\n\t{\n\t\tif (!this.#emptySearchPopup || !this.#emptySearchPopup?.isShown())\n\t\t{\n\t\t\tconst { width } = Dom.getPosition(this.#container);\n\t\t\tconst events = this.#popupParams?.events ?? {};\n\n\t\t\tthis.#emptySearchPopup = new Popup({\n\t\t\t\twidth,\n\t\t\t\tbindElement: this.#container,\n\t\t\t\tcontent: Loc.getMessage('UI_SELECT_NOTHING_FOUND'),\n\t\t\t\tcloseByEsc: true,\n\t\t\t\t...this.#popupParams,\n\t\t\t\tevents: {\n\t\t\t\t\t...events,\n\t\t\t\t\tonAfterClose: () => {\n\t\t\t\t\t\tthis.#emptySearchPopup = null;\n\t\t\t\t\t\tthis.#setSelectedOption(this.#selectedOption);\n\t\t\t\t\t\tif (!this.isMenuShown())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#searchValue = '';\n\t\t\t\t\t\t\tthis.#updateSelect();\n\t\t\t\t\t\t\tif (events.onAfterClose)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tevents.onAfterClose();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.#emptySearchPopup.show();\n\t\t}\n\t}\n\n\t#hideEmptySearchPopup(): void\n\t{\n\t\tif (this.#emptySearchPopup)\n\t\t{\n\t\t\tthis.#emptySearchPopup.destroy();\n\t\t\tthis.#emptySearchPopup = null;\n\t\t}\n\t}\n\n\t#setSelectedOption(option: SelectOption): void\n\t{\n\t\tif (!option)\n\t\t{\n\t\t\tthis.#selectedOption = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('update', option.value);\n\t\tthis.#searchValue = '';\n\t\tconst input = this.getInput();\n\t\tinput.value = option.label;\n\t\tthis.#highlightedOptionIndex = this.#getOptionIndex(option.value);\n\t\tthis.#selectedOption = option;\n\t}\n\n\tgetInput(): HTMLElement | null\n\t{\n\t\treturn this.#container.querySelector('input');\n\t}\n\n\tgetValue(): string\n\t{\n\t\treturn this.#selectedOption?.value || '';\n\t}\n\n\tsetValue(value: string): void\n\t{\n\t\tconst option = this.#findOptionByValue(value);\n\t\tthis.#setSelectedOption(option);\n\t}\n\n\t#findOptionByValue(value: string): SelectOption | null\n\t{\n\t\treturn this.#options.find((option) => {\n\t\t\treturn option.value === value;\n\t\t});\n\t}\n\n\t#highlightOption(optionIndex: number): void\n\t{\n\t\tif (!this.#menu)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = this.#menu.itemsContainer.children;\n\n\t\tfor (let i = 0; i < menuItems.length; i++)\n\t\t{\n\t\t\tconst item = menuItems.item(i);\n\t\t\tDom.removeClass(item, 'menu-popup-item-open');\n\t\t\tif (i === optionIndex)\n\t\t\t{\n\t\t\t\tDom.addClass(item, 'menu-popup-item-open');\n\t\t\t}\n\t\t}\n\t}\n\n\t#scrollToHighlightedItem(): void\n\t{\n\t\tconst popupContent: HTMLElement = this.#menu.getPopupWindow().getContentContainer();\n\t\tconst menuItems: HTMLCollection = this.#menu.itemsContainer.children;\n\t\tconst highlightedItem = menuItems.item(this.#highlightedOptionIndex);\n\n\t\tconst {\n\t\t\theight: popupContentHeight,\n\t\t} = Dom.getPosition(popupContent);\n\n\t\tconst {\n\t\t\theight: highlightedItemHeight,\n\t\t} = Dom.getPosition(highlightedItem);\n\n\t\tconst direction = this.#getScrollDirectionToHighlightedItem(popupContent, highlightedItem);\n\n\t\tif (direction !== ScrollDirection.NONE)\n\t\t{\n\t\t\tpopupContent.scroll({\n\t\t\t\tleft: 0,\n\t\t\t\ttop: (highlightedItemHeight * (this.#highlightedOptionIndex) + direction * popupContentHeight),\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t}\n\t}\n\n\t#getScrollDirectionToHighlightedItem(popupContent: HTMLElement, highlightedItem: HTMLElement): number\n\t{\n\t\tconst {\n\t\t\tbottom: popupContentBottom,\n\t\t\ttop: popupContentTop,\n\t\t} = Dom.getPosition(popupContent);\n\n\t\tconst {\n\t\t\tbottom: highlightedItemBottom,\n\t\t\ttop: highlightedItemTop,\n\t\t} = Dom.getPosition(highlightedItem);\n\n\t\tif (popupContentTop > highlightedItemTop)\n\t\t{\n\t\t\treturn ScrollDirection.TOP;\n\t\t}\n\n\t\tif (popupContentBottom < highlightedItemBottom)\n\t\t{\n\t\t\treturn ScrollDirection.BOTTOM;\n\t\t}\n\n\t\treturn ScrollDirection.NONE;\n\t}\n\n\t#getOptionIndex(optionValue: string): number\n\t{\n\t\treturn this.#options.findIndex((option) => {\n\t\t\treturn option.value === optionValue;\n\t\t});\n\t}\n\n\tisMenuShown(): boolean\n\t{\n\t\treturn this.#menu && this.#menu.getPopupWindow().isShown();\n\t}\n\n\t#handleBlur(): void\n\t{\n\t\tthis.hideMenu();\n\t\tthis.#hideEmptySearchPopup();\n\t}\n\n\t#handleFocus(e): void\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.showMenu();\n\t\t\tthis.#updateSelect();\n\t\t}, 100);\n\t\te.preventDefault();\n\t}\n\n\t#updateSelect(): void\n\t{\n\t\tthis.#updateInput();\n\t\tthis.#updateContainerClassname();\n\t}\n\n\t#updateInput(): void\n\t{\n\t\tconst input = this.getInput();\n\n\t\tif (this.#isInputReadonly())\n\t\t{\n\t\t\tinput.setAttribute('readonly', 'readonly');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinput.removeAttribute('readonly');\n\t\t}\n\t}\n\n\t#updateContainerClassname(): void\n\t{\n\t\tthis.#container.className = this.#getContainerClassname();\n\t}\n\n\t#getContainerClassname(): string\n\t{\n\t\tconst openMenuClassnameModifier = this.isMenuShown() || this.#emptySearchPopup ? '--open' : '';\n\n\t\treturn `ui-select ui-ctl ui-ctl-after-icon ui-ctl-dropdown ${this.#containerClassname} ${openMenuClassnameModifier}`;\n\t}\n}\n"],"names":["ScrollDirection","Object","freeze","TOP","BOTTOM","NONE","Select","EventEmitter","constructor","options","setEventNamespace","Type","isString","placeholder","isSearchable","Array","isArray","isPlainObject","popupParams","value","containerClassname","renderTo","targetContainer","isDomNode","Dom","clean","append","showMenu","show","hideMenu","close","getInput","querySelector","getValue","setValue","option","isMenuShown","getPopupWindow","isShown","Tag","render","label","bind","input","root","document","activeElement","setTimeout","width","getPosition","events","Menu","bindElement","items","closeByEsc","autoHide","className","onAfterClose","map","index","e","preventDefault","target","keyCode","arrowUpKeyCode","arrowDownKeyCode","enterKeyCode","spaceKeyCode","length","forEach","removeMenuItem","destroyEmptyPopup","filteredOptions","addMenuItem","isHoverOption","isHover","id","text","onclick","filter","searchStr","lowerCaseSearchStr","toLowerCase","lowerCaseOptionLabel","indexOf","Popup","content","Loc","getMessage","destroy","emit","find","optionIndex","menuItems","itemsContainer","children","i","item","removeClass","addClass","popupContent","getContentContainer","highlightedItem","height","popupContentHeight","highlightedItemHeight","direction","scroll","left","top","behavior","bottom","popupContentBottom","popupContentTop","highlightedItemBottom","highlightedItemTop","optionValue","findIndex","setAttribute","removeAttribute","openMenuClassnameModifier"],"mappings":"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"}