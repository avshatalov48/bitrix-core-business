{"version":3,"file":"script.js","sources":["src/ajaxprocessor.js","src/form.js","src/tabs.js","src/dateend.js","src/grat.js","src/editor.js","src/autosave.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class AjaxProcessor\n{\n\thtmlWasInserted: boolean = false;\n\tscriptsLoaded:boolean = false;\n\n\tconstructor()\n\t{\n\n\t}\n\n\tprocessCSS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.CSS)\n\t\t\t&& block.CSS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.CSS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tprocessExternalJS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.JS)\n\t\t\t&& block.JS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.JS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tprocessAjaxBlockInsertHTML(block, container: HTMLElement, callbackExternal: Function): void\n\t{\n\t\tcontainer.appendChild(BX.create('DIV', {\n\t\t\thtml: block.CONTENT\n\t\t}));\n\n\t\tthis.htmlWasInserted = true;\n\t\tif (this.scriptsLoaded)\n\t\t{\n\t\t\tthis.processInlineJS(block, callbackExternal);\n\t\t}\n\t}\n\n\tprocessInlineJS(block, callbackExternal: Function): void\n\t{\n\t\tthis.scriptsLoaded = true;\n\t\tif (this.htmlWasInserted)\n\t\t{\n\t\t\tBX.ajax.processRequestData(block.CONTENT, {\n\t\t\t\tscriptsRunFirst: false,\n\t\t\t\tdataType: 'HTML'\n\t\t\t});\n\t\t\tcallbackExternal();\n\t\t}\n\t}\n}","import {Type, ajax as Ajax, Loc, Dom, Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport AjaxProcessor from './ajaxprocessor';\n\nexport default class PostForm\n{\n\tstatic instance = null;\n\n\tlazyLoad: boolean = null;\n\tajaxUrl: string = '';\n\tinited: boolean = false;\n\tloaded: boolean = false;\n\tcontainer: HTMLElement = null;\n\tcontainerMicro: HTMLElement = null;\n\tcontainerMicroInner: HTMLElement = null;\n\tclickDisabled: boolean = false;\n\tlastWait: HTMLElement[] = [];\n\tanimationStartHeight: number = 0;\n\tinitedEditorsList: string[] = [];\n\toptions: { [key: string]: any } = {};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostForm.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostForm.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.init(params);\n\t\tPostForm.setInstance(this);\n\t}\n\n\tsetOption(key: string, value: any): void\n\t{\n\t\tif (!Type.isStringFilled(key))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[key] = value;\n\t}\n\n\tonShow(): void\n\t{\n\t\tif(\n\t\t\t!Type.isStringFilled(this.options.startVideoRecorder)\n\t\t\t|| this.options.startVideoRecorder !== 'Y'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (!editorForm)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t}));\n\n\t\t\tBX.VideoRecorder.start('blogPostForm', 'post');\n\t\t}, 500);\n\t};\n\n\tonSliderClose(): void\n\t{\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (!sliderInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.postMessageAll(window, 'SidePanel.Wrapper:onClose', {\n\t\t\tsliderData: sliderInstance.getData(),\n\t\t});\n\t};\n\n\tinit(params: { [key: string]: any }): void\n\t{\n\t\tif (this.inited !== true)\n\t\t{\n\t\t\tthis.inited = true;\n\t\t\tthis.lazyLoad = !Type.isUndefined(params.lazyLoad) ? !!params.lazyLoad : false;\n\t\t\tthis.ajaxUrl = Type.isStringFilled(params.ajaxUrl) ? params.ajaxUrl : '';\n\t\t\tthis.container = Type.isDomNode(params.container) ? params.container : null;\n\t\t\tthis.containerMicro = Type.isDomNode(params.containerMicro) ? params.containerMicro : null;\n\t\t\tthis.containerMicroInner = Type.isDomNode(params.containerMicroInner) ? params.containerMicroInner : null;\n\t\t\tthis.successPostId = !Type.isUndefined(params.successPostId) && parseInt(params.successPostId) > 0 ? parseInt(params.successPostId) : 0;\n\t\t}\n\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (sliderInstance)\n\t\t{\n\t\t\tif (this.successPostId > 0)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, 'Socialnetwork.PostForm:onAdd', {\n\t\t\t\t\toriginatorSliderId: sliderInstance.getData().get('sliderId'),\n\t\t\t\t\tsuccessPostId: this.successPostId,\n\t\t\t\t});\n\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t\telse if (!sliderInstance.getData().get('initialized'))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(sliderInstance, 'BX.Socialnetwork.SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t\tsliderInstance.getData().set('initialized', true);\n\t\t\t}\n\t\t}\n\t};\n\n\tget(params: { [key: string]: any }): void\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.lazyLoad\n\t\t\t&& !this.loaded\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tthis.animationStartHeight = this.containerMicro.offsetHeight;\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.loaderType)\n\t\t\t\t&& params.loaderType === 'tab'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.showWaitTab();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.containerMicroInner.style.display = 'none';\n\t\t\t\tthis.showWait(this.containerMicro);\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'SBPE_get_full_form',\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tthis.loaded = true;\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\n\t\t\t\t\tif(result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.processAjaxBlock(result.PROPS, params.callback);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonfailure: () => {\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\t\t\t\t\tthis.containerMicroInner.style.display = 'block';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isFunction(params.callback))\n\t\t{\n\t\t\tparams.callback();\n\t\t}\n\t};\n\n\tprocessAjaxBlock(block, callbackExternal: Function): void\n\t{\n\t\tif (!block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst processor = new AjaxProcessor();\n\n\t\tprocessor.processCSS(block, () => {\n\t\t\tprocessor.processAjaxBlockInsertHTML(block, this.container, callbackExternal);\n\t\t});\n\t\tprocessor.processExternalJS(block, () => {\n\t\t\tprocessor.processInlineJS(block, callbackExternal);\n\t\t});\n\t};\n\n\tshowWait(node: HTMLElement): HTMLElement\n\t{\n\t\tconst waiterNode = node.bxmsg = document.body.appendChild(Dom.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tid: `wait_${node.id}`,\n\t\t\t\tclassName: 'feed-add-post-loader-cont'\n\t\t\t},\n\t\t\thtml: '<svg class=\"feed-add-post-loader\" viewBox=\"25 25 50 50\"><circle class=\"feed-add-post-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle><circle class=\"feed-add-post-loader-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'\n\t\t}));\n\n\t\tsetTimeout(() => {\n\t\t\tthis.adjustWait(node);\n\t\t}, 10);\n\t\tthis.lastWait.push(waiterNode);\n\n\t\treturn waiterNode;\n\t};\n\n\tshowWaitTab(): void\n\t{\n\t\tif (\n\t\t\t!BX('feed-add-post-more-icon')\n\t\t\t|| !BX('feed-add-post-more-icon-waiter')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX('feed-add-post-more-icon').style.display = 'none';\n\t\tBX('feed-add-post-more-icon-waiter').style.display = 'block';\n\t};\n\n\tcloseWait(): void\n\t{\n\t\tconst waiterNode = this.containerMicro.bxmsg;\n\n\t\tif (waiterNode && waiterNode.parentNode)\n\t\t{\n\t\t\tfor (let i=0, len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (this.containerMicro)\n\t\t\t{\n\t\t\t\tthis.containerMicro.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\n\t\tif (\n\t\t\tBX('feed-add-post-more-icon')\n\t\t\t&& BX('feed-add-post-more-icon-waiter')\n\t\t\t&& BX('feed-add-post-more-icon').style.display === 'none'\n\t\t)\n\t\t{\n\t\t\tBX('feed-add-post-more-icon').style.display = 'block';\n\t\t\tBX('feed-add-post-more-icon-waiter').style.display = 'none';\n\t\t}\n\t};\n\n\tadjustWait(node: HTMLElement): void\n\t{\n\t\tif (!node.bxmsg)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodePosition = BX.pos(node);\n\t\tlet topDelta = nodePosition.top + 15;\n\n\t\tif (topDelta < BX.GetDocElement().scrollTop)\n\t\t{\n\t\t\ttopDelta = BX.GetDocElement().scrollTop + 5;\n\t\t}\n\n\t\tnode.bxmsg.style.top = `${(topDelta + 5)}px`;\n\n\t\tif (node === BX.GetDocElement())\n\t\t{\n\t\t\tnode.bxmsg.style.right = '5px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.bxmsg.style.left = `${(nodePosition.left + parseInt((nodePosition.width - node.bxmsg.offsetWidth) / 2))}px`;\n\t\t}\n\t};\n\n\ttasksTaskEvent(taskId: number): void\n\t{\n\t\tif (!Reflection.getClass('BX.UI.Notification.Center'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskLink = Loc.getMessage('PATH_TO_USER_TASKS_TASK').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId).replace('#action#', 'view');\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_BUTTON_TITLE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t};\n}","import {Type, Loc, Dom, Event, Runtime, ajax as Ajax } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport { MenuManager } from \"main.popup\";\n\nexport default class PostFormTabs extends EventEmitter\n{\n\tstatic instance = null;\n\n\tinited: boolean = false;\n\n\ttabs: { [key: string]: any } = {};\n\tbodies: { [key: string]: any } = {};\n\tactive = null;\n\tanimation = null;\n\tanimationStartHeight:number = 0;\n\tpreviousTab = null;\n\tmenu = null;\n\tlistsMenu = null;\n\tmenuItems = [];\n\tlastWait: HTMLElement[] = [];\n\tclickDisabled: boolean = false;\n\n\ttabContainer: HTMLElement = null;\n\tarrow: HTMLElement = null;\n\n\tconfig = {\n\t\tid: {\n\t\t\tmessage: 'message',\n\t\t\ttask: 'tasks',\n\t\t\tcalendar: 'calendar',\n\t\t\tfile: 'file',\n\t\t\tgratitude: 'grat',\n\t\t\timportant: 'important',\n\t\t\tvote: 'vote',\n\t\t\tmore: 'more',\n\t\t\tlistItem: 'lists',\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormTabs.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (PostFormTabs.instance === null)\n\t\t{\n\t\t\tnew PostFormTabs();\n\t\t}\n\n\t\treturn PostFormTabs.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Socialnetwork.Livefeed.Post.Form.Tabs');\n\t\tthis.init();\n\n\t\tPostFormTabs.setInstance(this);\n\t\twindow.SBPETabs = this;\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.tabContainer = document.getElementById('feed-add-post-form-tab');\n\t\tthis.arrow = document.getElementById('feed-add-post-form-tab-arrow');\n\t\tthis.tabs = {};\n\t\tthis.bodies = {};\n\n\t\tconst tabsList = this.tabContainer && this.tabContainer.querySelectorAll('span.feed-add-post-form-link');\n\t\tif (tabsList)\n\t\t{\n\t\t\tfor (let i = 0; i < tabsList.length; i++)\n\t\t\t{\n\t\t\t\tconst id = tabsList[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\t\t\t\tconst limited = tabsList[i].getAttribute('limited');\n\n\t\t\t\tthis.tabs[id] = tabsList[i];\n\n\t\t\t\tif (this.tabs[id].style.display === 'none')\n\t\t\t\t{\n\t\t\t\t\tthis.menuItems.push({\n\t\t\t\t\t\ttabId : id,\n\t\t\t\t\t\ttext : tabsList[i].getAttribute('data-name'),\n\t\t\t\t\t\tclassName : `menu-popup-no-icon feed-add-post-form-${id} feed-add-post-form-${id}-more`,\n\t\t\t\t\t\tonclick : this.createOnClick(id, tabsList[i].getAttribute('data-name'), tabsList[i].getAttribute('data-onclick'), (tabsList[i].getAttribute('data-limited') === 'Y'))\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.tabs[id] = this.tabs[id].parentNode;\n\t\t\t\t}\n\n\t\t\t\tthis.bodies[id] = document.getElementById(`feed-add-post-content-${id}`);\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.file])\n\t\t{\n\t\t\tthis.bodies[this.config.id.file] = [ this.bodies[this.config.id.message] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.calendar])\n\t\t{\n\t\t\tthis.bodies[this.config.id.calendar] = [ this.bodies[this.config.id.calendar] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.vote])\n\t\t{\n\t\t\tthis.bodies[this.config.id.vote] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.vote],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.more])\n\t\t{\n\t\t\tthis.bodies[this.config.id.more] = null;\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.important])\n\t\t{\n\t\t\tthis.bodies[this.config.id.important] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.important],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.gratitude])\n\t\t{\n\t\t\tthis.bodies[this.config.id.gratitude] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.gratitude],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.listItem])\n\t\t{\n\t\t\tthis.bodies[this.config.id.listItem] = [ this.bodies[this.config.id.listItem] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.task])\n\t\t{\n\t\t\tthis.bodies[this.config.id.task] = [ this.bodies[this.config.id.task] ];\n\t\t}\n\n\t\tfor (let ii in this.bodies)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.bodies.hasOwnProperty(ii)\n\t\t\t\t&& Type.isDomNode(this.bodies[ii])\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.bodies[ii] = [ this.bodies[ii] ];\n\t\t\t}\n\n\t\t}\n\n\t\tthis.inited = true;\n\t\tthis.previousTab = false;\n\n\t\tconst uploadFileNode = document.getElementById('bx-b-uploadfile-blogPostForm');\n\t\tif (uploadFileNode)\n\t\t{\n\t\t\tuploadFileNode.setAttribute('bx-press', 'pressOut');\n\t\t\tEvent.bind(uploadFileNode, 'mousedown', () => {\n\t\t\t\tuploadFileNode.setAttribute(\"bx-press\", (uploadFileNode.getAttribute(\"bx-press\") == \"pressOut\" ? \"pressOn\" : \"pressOut\"));\n\t\t\t});\n\t\t}\n\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tif (!form)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (!form.changePostFormTab)\n\t\t{\n\t\t\tform.appendChild(Dom.create('INPUT', {\n\t\t\t\tprops : {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: 'changePostFormTab',\n\t\t\t\t\tvalue: ''\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis.subscribe('changePostFormTab', (event) => {\n\t\t\tconst { type } = event.getData();\n\n\t\t\tif (type === this.config.id.more)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tform.changePostFormTab.value = type;\n\n\t\t\tif (form['UF_BLOG_POST_IMPRTNT'])\n\t\t\t{\n\t\t\t\tform['UF_BLOG_POST_IMPRTNT'].value = (type === this.config.id.important ? '1' : '0');\n\t\t\t}\n\t\t});\n\t};\n\n\tcreateOnClick(id, name:string, onclick: string, limited: boolean)\n\t{\n\t\treturn () => {\n\t\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\t\tif (!limited)\n\t\t\t{\n\t\t\t\tbtnText.innerHTML = name;\n\t\t\t\tif (id !== this.config.id.listItem)\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-link-active feed-add-post-form-${id}-link`;\n\t\t\t\t\tthis.changePostFormTab(id, false);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-${id}-link`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(onclick))\n\t\t\t{\n\t\t\t\tBX.evalGlobal(onclick);\n\t\t\t}\n\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t};\n\n\tchangePostFormTab(type, iblock)\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.setActive(type, iblock);\n\t};\n\n\tsetActive(type?:string, iblock)\n\t{\n\t\tif (\n\t\t\tType.isNull(type)\n\t\t\t|| (\n\t\t\t\tthis.active === type\n\t\t\t\t&& type !== this.config.id.listItem\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn this.active;\n\t\t}\n\t\telse if (!this.tabs[type])\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst needAnimation = (type !== this.config.id.task || this.isTaskTabLoaded());\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tfor (let ii in this.tabs)\n\t\t{\n\t\t\tif (this.tabs.hasOwnProperty(ii) && ii !== type)\n\t\t\t{\n\t\t\t\tthis.tabs[ii].classList.remove('feed-add-post-form-link-active');\n\t\t\t\tif (\n\t\t\t\t\tthis.bodies[ii] == null\n\t\t\t\t\t|| this.bodies[type] == null\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (let jj = 0; jj < this.bodies[ii].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (this.bodies[type][jj] != this.bodies[ii][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[ii][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[type])\n\t\t{\n\t\t\tthis.active = type;\n\n\t\t\tconst tabPosTab = BX.pos(this.tabs[type], true);\n\n\t\t\tthis.arrow.style.display = 'block';\n\t\t\tthis.arrow.style.top = `${tabPosTab.bottom}px`;\n\n\t\t\tconst leftStart = parseInt(this.arrow.style.left) || 0;\n\t\t\tconst widthStart = parseInt(this.arrow.style.width) || 0;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration : 200,\n\t\t\t\tstart: { left: leftStart, width:  widthStart },\n\t\t\t\tfinish: { left: tabPosTab.left, width: tabPosTab.width },\n\t\t\t\ttransition: BX.easing.makeEaseInOut(BX.easing.transitions.quart),\n\t\t\t\tstep : (state) => {\n\t\t\t\t\tthis.arrow.style.left = `${state.left}px`;\n\t\t\t\t\tthis.arrow.style.width = `${state.width}px`;\n\t\t\t\t},\n\n\t\t\t\tcomplete : () => {\n\t\t\t\t\tthis.arrow.style.display = 'none';\n\t\t\t\t\tthis.tabs[type].classList.add('feed-add-post-form-link-active');\n\t\t\t\t}\n\t\t\t})).animate();\n\n\t\t\tif (\n\t\t\t\tthis.previousTab === this.config.id.file\n\t\t\t\t|| type === this.config.id.file\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet hasValuesFile = false;\n\t\t\t\tlet hasValuesDocs = false;\n\n\t\t\t\tconst messageBody = document.getElementById('divoPostFormLHE_blogPostForm');\n\n\t\t\t\tif (\n\t\t\t\t\t!!messageBody\n\t\t\t\t\t&& !!messageBody.childNodes\n\t\t\t\t\t&& messageBody.childNodes.length > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (let ii in messageBody.childNodes)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!messageBody.childNodes.hasOwnProperty(ii))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (messageBody.childNodes[ii].className === 'file-selectdialog')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nodeFile = messageBody.childNodes[ii];\n\t\t\t\t\t\t\tconst values1 = nodeFile.querySelector('.file-placeholder-tbody');\n\t\t\t\t\t\t\tconst values2 = nodeFile.querySelector('.feed-add-photo-block');\n\t\t\t\t\t\t\tif (values1.rows > 0 || !!values2 && values2.length > 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thasValuesFile = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\tType.isStringFilled(messageBody.childNodes[ii].className)\n\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\tmessageBody.childNodes[ii].className.indexOf('wduf-selectdialog') >= 0\n\t\t\t\t\t\t\t\t|| messageBody.childNodes[ii].className.indexOf('diskuf-selectdialog') >= 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nodeDocs = messageBody.childNodes[ii];\n\t\t\t\t\t\t\tconst webdavValues = nodeDocs.querySelectorAll('wd-inline-file');\n\n\t\t\t\t\t\t\thasValuesDocs = (!!webdavValues && webdavValues.length > 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(\n\t\t\t\t\t\t\tType.isDomNode(messageBody.childNodes[ii])\n\t\t\t\t\t\t\t&& messageBody.childNodes[ii].classList\n\t\t\t\t\t\t\t&& !messageBody.childNodes[ii].classList.contains('urlpreview')\n\t\t\t\t\t\t\t&& !messageBody.childNodes[ii].classList.contains('feed-add-post-strings-blocks')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.adjust(messageBody.childNodes[ii], {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: (type === this.config.id.file ? 'none' : '')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (type === this.config.id.file)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!!window['PlEditorblogPostForm']\n\t\t\t\t\t\t\t&& !window['PlEditorblogPostForm'].SBPEBinded\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].SBPEBinded = true;\n\n\t\t\t\t\t\t\tEventEmitter.subscribe(window[\"PlEditorblogPostForm\"].eventNode, 'onUploadsHasBeenChanged', (event: BaseEvent) => {\n\n\t\t\t\t\t\t\t\tconst wdObj = event.getData()[1];\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\twdObj.dialogName === 'AttachFileDialog'\n\t\t\t\t\t\t\t\t\t&& wdObj.urlUpload.indexOf('&dropped=Y') < 0\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\twdObj.urlUpload = wdObj.agent.uploadFileUrl = wdObj.urlUpload.replace('&random_folder=Y', '&dropped=Y');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdocument.getElementById('bx-b-uploadfile-blogPostForm').setAttribute('bx-press', 'pressOn');\n\t\t\t\t\t\t\t\tif (this.active !== this.config.id.file)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.changePostFormTab(this.config.id.message);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('show');\n\t\t\t\t\t\tmessageBody.classList.add('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmessageBody.classList.remove('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!hasValuesFile\n\t\t\t\t\t\t\t&& !hasValuesDocs\n\t\t\t\t\t\t\t&& document.getElementById('bx-b-uploadfile-blogPostForm').getAttribute('bx-press') === 'pressOut'\n\t\t\t\t\t\t\t&& !!window['PlEditorblogPostForm']\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (\n\t\t\t\teditorForm\n\t\t\t\t&& editorForm.style.display === 'none'\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tif(type === this.config.id.listItem)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('onDisplayClaimLiveFeed', new BaseEvent({\n\t\t\t\t\tcompatData: [ iblock ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tthis.previousTab = type;\n\n\t\t\tif (!!this.bodies[type])\n\t\t\t{\n\t\t\t\tfor (let jj = 0; jj < this.bodies[type].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (!!this.bodies[type][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[type][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\n\t\tif(type !== this.config.id.listItem)\n\t\t{\n\t\t\tthis.restoreMoreMenu();\n\t\t}\n\n\t\tthis.emit('changePostFormTab', { type });\n\n\t\treturn this.active;\n\t};\n\n\tisTaskTabLoaded()\n\t{\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\t\treturn (contentContainer && contentContainer.children.length);\n\t};\n\n\tcollapse()\n\t{\n\t\tthis.active = null;\n\t\tlet postEditSlider = false;\n\n\t\tconst currentSlider = (window !== top.window ? BX.SidePanel.Instance.getSliderByWindow(window) : null);\n\n\t\tif (window !== top.window) // slider\n\t\t{\n\t\t\tif (\n\t\t\t\tcurrentSlider\n\t\t\t\t&& currentSlider.url.match(/\\/user\\/(\\d+)\\/blog\\/edit\\//)\n\t\t\t)\n\t\t\t{\n\t\t\t\tpostEditSlider = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.changePostFormTab(\"message\");\n\t\t\tconst formInstance = PostForm.getInstance();\n\t\t\tif (\n\t\t\t\tformInstance\n\t\t\t\t&& Type.isDomNode(formInstance.containerMicroInner)\n\t\t\t)\n\t\t\t{\n\t\t\t\tformInstance.containerMicroInner.style.display = 'block';\n\t\t\t}\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm')\n\t\tif (editorForm)\n\t\t{\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ false ]\n\t\t\t}));\n\t\t}\n\n\t\tEventEmitter.emit('onExtAutoSaveReset_blogPostForm', new BaseEvent({\n\t\t\tcompatData: [ ]\n\t\t}));\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (currentSlider)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(window.top, 'SidePanel.Slider:onClose', new BaseEvent({\n\t\t\t\t\tcompatData: [ currentSlider.getEvent('onClose') ]\n\t\t\t\t}));\n\t\t\t}\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}\n\t};\n\n\tstartAnimation():void\n\t{\n\t\tif (this.animation)\n\t\t{\n\t\t\tthis.animation.stop();\n\t\t}\n\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (PostForm.getInstance().animationStartHeight > 0)\n\t\t{\n\t\t\tthis.animationStartHeight = PostForm.getInstance().animationStartHeight;\n\t\t\tPostForm.getInstance().animationStartHeight = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.animationStartHeight = container.parentNode.offsetHeight;\n\t\t}\n\n\t\tcontainer.parentNode.style.height = `${this.animationStartHeight}px`;\n\t\tcontainer.parentNode.style.overflowY = 'hidden';\n\t\tcontainer.parentNode.style.position = 'relative';\n\t\tcontainer.style.opacity = 0;\n\t};\n\n\tendAnimation():void\n\t{\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.animation = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {\n\t\t\t\theight: this.animationStartHeight,\n\t\t\t\topacity: 0\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\theight: container.offsetHeight + container.offsetTop,\n\t\t\t\topacity: 100\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tcontainer.parentNode.style.height = `${state.height}px`;\n\t\t\t\tcontainer.style.opacity = state.opacity / 100;\n\t\t\t},\n\n\t\t\tcomplete : () => {\n\t\t\t\tcontainer.style.cssText = '';\n\t\t\t\tcontainer.parentNode.style.cssText = '';\n\t\t\t\tthis.animation = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.animation.animate();\n\t};\n\n\tshowMoreMenu()\n\t{\n\t\tif (!this.menu)\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t'feed-add-post-form-popup',\n\t\t\t\tdocument.getElementById('feed-add-post-form-link-text'),\n\t\t\t\tthis.menuItems,\n\t\t\t\t{\n\t\t\t\t\tclassName: 'feed-add-post-form-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\toffsetTop: 5,\n\t\t\t\t\toffsetLeft: 3,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.menu.popupWindow.show();\n\t};\n\n\trestoreMoreMenu(): void\n\t{\n\t\tconst itemCnt = this.menuItems.length;\n\t\tif (itemCnt < 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < itemCnt; i++)\n\t\t{\n\t\t\tif (this.active === this.menuItems[i]['tabId'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\tbtn.className = 'feed-add-post-form-link feed-add-post-form-link-more';\n\t\tbtnText.innerHTML = Loc.getMessage('SBPE_MORE');\n\t};\n\n\tgetTaskForm()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-tasks').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tconst content = document.getElementById('feed-add-post-content-tasks');\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\n\t\tif (\n\t\t\tcontentContainer\n\t\t\t&& contentContainer.innerHTML.length <= 0\n\t\t\t&& !this.clickDisabled\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tPostForm.getInstance().showWait(contentContainer);\n\t\t\tthis.startAnimation();\n\n\t\t\tconst componentParameters = {\n\t\t\t\tGROUP_ID: Loc.getMessage('TASK_SOCNET_GROUP_ID'),\n\t\t\t\tPATH_TO_USER_TASKS: Loc.getMessage('PATH_TO_USER_TASKS'),\n\t\t\t\tPATH_TO_USER_TASKS_TASK: Loc.getMessage('PATH_TO_USER_TASKS_TASK'),\n\t\t\t\tPATH_TO_GROUP_TASKS: Loc.getMessage('PATH_TO_GROUP_TASKS'),\n\t\t\t\tPATH_TO_GROUP_TASKS_TASK: Loc.getMessage('PATH_TO_GROUP_TASKS_TASK'),\n\t\t\t\tPATH_TO_USER_PROFILE: Loc.getMessage('PATH_TO_USER_PROFILE'),\n\t\t\t\tPATH_TO_GROUP: Loc.getMessage('PATH_TO_GROUP'),\n\t\t\t\tPATH_TO_USER_TASKS_PROJECTS_OVERVIEW: Loc.getMessage('PATH_TO_USER_TASKS_PROJECTS_OVERVIEW'),\n\t\t\t\tPATH_TO_USER_TASKS_TEMPLATES: Loc.getMessage('PATH_TO_USER_TASKS_TEMPLATES'),\n\t\t\t\tPATH_TO_USER_TEMPLATES_TEMPLATE: Loc.getMessage('PATH_TO_USER_TEMPLATES_TEMPLATE'),\n\t\t\t\tENABLE_FOOTER: 'N',\n\t\t\t\tTEMPLATE_CONTROLLER_ID: 'livefeed_task_form',\n\t\t\t\tENABLE_FORM: 'N',\n\t\t\t\tBACKURL: Loc.getMessage('TASK_SUBMIT_BACKURL')\n\t\t\t};\n\n\t\t\tBX.Tasks.Util.Query.runOnce(\n\t\t\t\t'ui.task.edit',\n\t\t\t\t{\n\t\t\t\t\tparameters: {\n\t\t\t\t\t\tCOMPONENT_PARAMETERS: componentParameters\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t(result) => {\n\t\t\t\t\tif(result.isSuccess())\n\t\t\t\t\t{\n\t\t\t\t\t\tRuntime.html(contentContainer, result.getData());\n\t\t\t\t\t\tDom.adjust(content, {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay : 'block'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\t\t\tthis.endAnimation();\n\n\t\t\t\t\t\tthrow new Error(result.getErrors().getMessages().join(' '));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(reason) => {\n\t\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\t\tthis.endAnimation();\n\t\t\t\t\tthrow new Error();\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\t() => {\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\t\tthis.endAnimation();\n\n\t\t\t\t\tEventEmitter.emit(document.getElementById('divlivefeed_task_form'), 'OnShowLHE', new BaseEvent({\n\t\t\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t\tthis.endAnimation();\n\t\t}\n\t};\n\n\tcloseWait(node)\n\t{\n\t\tconst waiterNode = node.bxmsg;\n\n\t\tif (\n\t\t\twaiterNode\n\t\t\t&& waiterNode.parentNode\n\t\t)\n\t\t{\n\t\t\tfor (let i=0,len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\t};\n\n\tgetLists()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tlet tabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tlet tabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tlet menuItemsListsDefault = [];\n\t\tlet menuItemsLists = [];\n\n\t\tif(tabs.length)\n\t\t{\n\t\t\tmenuItemsLists = this.getMenuItems(tabs, this.createOnclickLists);\n\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet siteId = null;\n\n\t\t\tif(document.getElementById('bx-lists-select-site-id'))\n\t\t\t{\n\t\t\t\tsiteId = document.getElementById('bx-lists-select-site-id').value;\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: '/bitrix/components/bitrix/socialnetwork.blog.post.edit/post.ajax.php',\n\t\t\t\tdata: {\n\t\t\t\t\tbitrix_processes: 1,\n\t\t\t\t\tsiteId: siteId,\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tif(result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(let k in result.lists)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!result.lists.hasOwnProperty(k))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t'data-name': result.lists[k].NAME,\n\t\t\t\t\t\t\t\t\t'data-picture': result.lists[k].PICTURE,\n\t\t\t\t\t\t\t\t\t'data-description': result.lists[k].DESCRIPTION,\n\t\t\t\t\t\t\t\t\t'data-picture-small': result.lists[k].PICTURE_SMALL,\n\t\t\t\t\t\t\t\t\t'data-code': result.lists[k].CODE,\n\t\t\t\t\t\t\t\t\t'iblockId': result.lists[k].ID\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists',\n\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(tabs, this.createOnclickLists);\n\n\t\t\t\t\t\tif(!tabsDefault.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(let k in result.permissions)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (!result.permissions.hasOwnProperty(k))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet onclick;\n\t\t\t\t\t\t\t\tif(k === 'new')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}0/edit/\"`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'market')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t\t\tresult.admin\n\t\t\t\t\t\t\t\t\t\t&& document.getElementById('bx-lists-lists-page')\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}?bp_catalog=y\"`;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif(document.getElementById('bx-lists-random-string'))\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tonclick = `BX.Lists[\"LiveFeedClass_${BX('bx-lists-random-string').value}\"].errorPopup(\"${Loc.getMessage('LISTS_CATALOG_PROCESSES_ACCESS_DENIED')}\");`;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'settings')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${BX('bx-lists-lists-page').value}\"`;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t'data-name': result.permissions[k],\n\t\t\t\t\t\t\t\t\t\t'data-picture-small': '',\n\t\t\t\t\t\t\t\t\t\t'data-key': k,\n\t\t\t\t\t\t\t\t\t\t'data-onclick': onclick\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\t\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t'data-name': result.error,\n\t\t\t\t\t\t\t\t'data-picture-small': ''\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(tabs, false);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tgetMenuItems(tabs, createOnclickLists)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst id = tabs[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\n\t\t\tif(createOnclickLists)\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute(\"data-name\")),\n\t\t\t\t\tclassName: `feed-add-post-form-${id} feed-add-post-form-${id}-item`,\n\t\t\t\t\tonclick: createOnclickLists(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\ttabs[i].getAttribute('iblockId'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-name'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-description'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-picture'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-code')\n\t\t\t\t\t\t]\n\t\t\t\t\t)\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: tabs[i].getAttribute('data-name'),\n\t\t\t\t\tclassName: `feed-add-post-form-${id}`,\n\t\t\t\t\tonclick: ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tgetMenuItemsDefault(tabs)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tmenuItemsLists.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute('data-name')),\n\t\t\t\tclassName: `feed-add-post-form-lists-default-${tabs[i].getAttribute('data-key')}`,\n\t\t\t\tonclick: tabs[i].getAttribute('data-onclick')\n\t\t\t});\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tshowMoreMenuLists(menuItemsLists)\n\t{\n\t\tconst menuBindElement = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\n\t\tthis.listsMenu = MenuManager.create(\n\t\t\t'lists',\n\t\t\tmenuBindElement,\n\t\t\tmenuItemsLists,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toffsetLeft: 12,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\n\t\tconst spanIcon = document.getElementById('popup-window-content-menu-popup-lists').querySelectorAll('span.menu-popup-item-icon');\n\t\tlet spanDataPicture = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tconst spanDataPictureDefault = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tspanDataPicture = Array.from(spanDataPicture).concat(Array.from(spanDataPictureDefault));\n\n\t\tfor(let i = 0; i < spanIcon.length; i++)\n\t\t{\n\t\t\tif(!spanDataPicture[i].getAttribute('data-picture-small'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspanIcon[i].innerHTML = spanDataPicture[i].getAttribute('data-picture-small');\n\t\t}\n\n\t\tthis.listsMenu.popupWindow.show();\n\t};\n\n\tcreateOnclickLists(id, iblock)\n\t{\n\t\treturn () =>\n\t\t{\n\t\t\tPostFormTabs.getInstance().changePostFormTab(id, iblock);\n\t\t\tPostFormTabs.getInstance().listsMenu.popupWindow.close();\n\t\t\tPostFormTabs.getInstance().menu.popupWindow.close();\n\t\t}\n\t};\n}\n","import { Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\n\nimport 'main.date';\n\nexport default class PostFormDateEnd\n{\n\tisInitialized: boolean = false;\n\tpopupShowingPeriods = null;\n\tmenuItems = [];\n\tcustomDateStyleModifier: string = 'feed-add-post-expire-date-customize';\n\n\tcustomDatePopupOptionClass: string = 'js-custom-date-end';\n\n\tpostExpireDateBlock: HTMLElement = null;\n\tformUfInputDateCustom: HTMLElement = null;\n\tformDateDuration: HTMLElement = null;\n\tformDateTimeEditing: HTMLElement = null;\n\tpopupTrigger: HTMLElement = null;\n\tcustomDateSelectedTitle: HTMLElement = null;\n\n\tselectors = {\n\t\tpostExpireDateBlock: '.js-post-expire-date-block',\n\t\tpostEndTime: '.js-form-post-end-time',\n\t\tpostEditingEndTime: '.js-form-editing-post-end-time',\n\t\tpostEndPeriod: '.js-form-post-end-period',\n\t\tpopupTrigger: '.js-important-till-popup-trigger',\n\t\tcustomDateFinal: '.js-date-post-showing-custom',\n\t\tdurationOptionsContainer: '.js-post-showing-duration-options-container',\n\t\tdurationOption: '.js-post-showing-duration-option'\n\t};\n\n\tconstructor()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.isInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addEventHandlers();\n\n\t\tif (!this.formDateTimeEditing.value)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.innerText = this.getCurrentDate();\n\t\t}\n\n\t\tthis.isInitialized = true;\n\t};\n\n\taddEventHandlers()\n\t{\n\t\tthis.postExpireDateBlock = document.querySelector(this.selectors.postExpireDateBlock);\n\t\tthis.formUfInputDateCustom = document.querySelector(this.selectors.postEndTime);\n\t\tthis.formDateDuration = document.querySelector(this.selectors.postEndPeriod);\n\t\tthis.formDateTimeEditing = document.querySelector(this.selectors.postEditingEndTime);\n\t\tthis.popupTrigger = document.querySelector(this.selectors.popupTrigger);\n\n\t\tif (this.popupTrigger)\n\t\t{\n\t\t\tthis.popupTrigger.addEventListener('click', () => {\n\t\t\t\tthis.showPostEndPeriodsPopup();\n\t\t\t});\n\t\t}\n\n\t\tthis.customDateSelectedTitle = document.querySelector(this.selectors.customDateFinal);\n\t\tif (this.customDateSelectedTitle)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.addEventListener('click', () => {\n\t\t\t\tlet curDate = new Date();\n\t\t\t\tlet curTimestamp = Math.round(curDate / 1000) - curDate.getTimezoneOffset() * 60;\n\n\t\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t\t{\n\t\t\t\t\tcurDate = BX.parseDate(this.formDateTimeEditing.value);\n\t\t\t\t\tcurTimestamp = BX.date.convertToUTC(curDate);\n\t\t\t\t}\n\n\t\t\t\tBX.calendar({\n\t\t\t\t\tnode: this.customDateSelectedTitle,\n\t\t\t\t\tform: 'blogPostForm',\n\t\t\t\t\tvalue: curTimestamp,\n\t\t\t\t\tbTime: false,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tcallback_after: this.onEndDateSet.bind(this)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\tshowPostEndPeriodsPopup(): void\n\t{\n\t\tif (!this.popupShowingPeriods)\n\t\t{\n\t\t\tthis.createPopupShowingPeriods();\n\t\t}\n\t\tthis.popupShowingPeriods.popupWindow.show();\n\t};\n\n\tcreatePopupShowingPeriods(): void\n\t{\n\t\tif (this.menuItems.length <= 0)\n\t\t{\n\t\t\tthis.menuItems = this.createPopupItems();\n\t\t}\n\n\t\tthis.popupShowingPeriods = MenuManager.create(\n\t\t\t'feed-add-post-form-popup42',\n\t\t\tdocument.getElementById('js-post-expire-date-wrapper'),\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: \"feed-add-post-expire-date-options\",\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\t};\n\n\tcreatePopupItems()\n\t{\n\t\tconst menuPostDurationItems = [];\n\t\tconst selectOptions = document.querySelector(this.selectors.durationOptionsContainer).querySelectorAll(this.selectors.durationOption);\n\n\t\tif (!selectOptions)\n\t\t{\n\t\t\treturn menuPostDurationItems;\n\t\t}\n\n\t\tselectOptions.forEach((element) => {\n\t\t\tmenuPostDurationItems.push({\n\t\t\t\tonclick: this.onPopupItemClick.bind(this),\n\t\t\t\tdataset: {\n\t\t\t\t\tvalue: element.getAttribute('data-value'),\n\t\t\t\t\tclass: element.getAttribute('data-class')\n\t\t\t\t},\n\t\t\t\ttext: element.getAttribute('data-text'),\n\t\t\t\tclassName: `menu-popup-item menu-popup-no-icon ${element.getAttribute('data-class')}`\n\t\t\t});\n\t\t});\n\n\t\treturn menuPostDurationItems;\n\t};\n\n\tonPopupItemClick(event)\n\t{\n\t\tconst element = event.currentTarget;\n\t\tif (element.getAttribute('data-class') === this.customDatePopupOptionClass)\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.add(this.customDateStyleModifier);\n\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.formDateTimeEditing.value;\n\t\t\t\tthis.customDateSelectedTitle.innerText = this.formDateTimeEditing.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.getCurrentDate();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.remove(this.customDateStyleModifier);\n\t\t\tthis.formUfInputDateCustom.value = null;\n\t\t}\n\n\t\tthis.popupTrigger.innerText = element.innerText.toLowerCase();\n\t\tthis.formDateDuration.value = element.getAttribute('data-value').toUpperCase();\n\t\tthis.popupShowingPeriods.popupWindow.close();\n\t};\n\n\tonEndDateSet(value)\n\t{\n\t\tif (!value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formDateTimeEditing.value = this.getFormattedDate(value);\n\t\tthis.formUfInputDateCustom.value = this.getFormattedDate(value);\n\t\tthis.customDateSelectedTitle.innerText = this.getFormattedDate(value);\n\t};\n\n\tgetFormattedDate(value)\n\t{\n\t\treturn BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE')), value);\n\t};\n\n\tgetCurrentDate()\n\t{\n\t\treturn this.getFormattedDate(new Date());\n\t};\n\n}","import { Type, Loc, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { TagSelector } from 'ui.entity-selector';\nimport { EventEmitter } from \"main.core.events\";\nimport 'main.date';\n\nexport default class PostFormGratSelector extends EventEmitter\n{\n\tstatic instance = null;\n\n\tpopupWindow = null;\n\tsendEvent = true;\n\tgratsContentElement = null;\n\titemSelectedImageItem = {};\n\titemSelectedInput = {};\n\tgratsList = {};\n\n\tselector = null;\n\n\tconfig = {\n\t\tfields: {\n\t\t\temployeesValue: {\n\t\t\t\tname: 'GRAT_DEST_DATA',\n\t\t\t},\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormGratSelector.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostFormGratSelector.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tsuper();\n\t\tthis.init(params);\n\t\tPostFormGratSelector.setInstance(this);\n\t}\n\n\tinit(params)\n\t{\n\t\tif(!params.name)\n\t\t{\n\t\t\tparams.name = 'lm';\n\t\t}\n\n\t\tthis.itemSelectedImageItem[params.name] = params.itemSelectedImageItem;\n\t\tthis.itemSelectedInput[params.name] = params.itemSelectedInput;\n\t\tthis.gratsList[params.name] = params.gratsList;\n\n\t\tthis.itemSelectedImageItem[params.name].addEventListener('click', (e) => {\n\t\t\tthis.openDialog(params.name);\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tthis.createEntitySelector(params.entitySelectorParams);\n\t};\n\n\topenDialog(name): boolean\n\t{\n\t\tif(!name)\n\t\t{\n\t\t\tname = 'lm';\n\t\t}\n\n\t\tif (this.popupWindow != null)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst gratItems = [];\n\t\tfor (let i = 0; i < this.gratsList[name].length; i++)\n\t\t{\n\t\t\tgratItems[gratItems.length] = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: `feed-add-grat-box ${this.gratsList[name][i].style}`\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-title': this.gratsList[name][i].title,\n\t\t\t\t\t'data-code': this.gratsList[name][i].code,\n\t\t\t\t\t'data-style': this.gratsList[name][i].style\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\tconst node = e.currentTarget;\n\t\t\t\t\t\tthis.selectItem(name, node.getAttribute('data-code'), node.getAttribute('data-style'), node.getAttribute('data-title'));\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst gratRows = [];\n\t\tlet rownum = 1;\n\n\t\tfor (let i = 0; i < gratItems.length; i++)\n\t\t{\n\t\t\tif (i >= gratItems.length/2)\n\t\t\t{\n\t\t\t\trownum = 2;\n\t\t\t}\n\n\t\t\tif (Type.isNil(gratRows[rownum]))\n\t\t\t{\n\t\t\t\tgratRows[rownum] = Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-row'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tgratRows[rownum].appendChild(gratItems[i]);\n\t\t}\n\n\t\tthis.gratsContentElement = Dom.create('div', {\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-title'\n\t\t\t\t\t},\n\t\t\t\t\thtml: Loc.getMessage('BLOG_GRAT_POPUP_TITLE')\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: gratRows\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tthis.popupWindow = new Popup('BXSocNetGratSelector', document.getElementById('feed-add-post-grat-type-selected'), {\n\t\t\tautoHide: true,\n\t\t\toffsetLeft: 25,\n\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: {\n\t\t\t\ttop: '5px',\n\t\t\t\tright: '10px'\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.popupWindow.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.popupWindow = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontent: this.gratsContentElement,\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t\toffset: 20\n\t\t\t},\n\t\t\tlightShadow: true\n\t\t});\n\t\tthis.popupWindow.setAngle({});\n\t\tthis.popupWindow.show();\n\n\t\treturn true;\n\t};\n\n\tselectItem(name, code, style, title)\n\t{\n\t\tconst gratSpan = this.itemSelectedImageItem[name].querySelector('span');\n\t\tif (gratSpan)\n\t\t{\n\t\t\tgratSpan.className = `feed-add-grat-box ${style}`;\n\t\t}\n\n\t\tthis.itemSelectedImageItem[name].title = title;\n\t\tthis.itemSelectedInput[name].value = code;\n\t\tthis.popupWindow.close();\n\t};\n\n\tcreateEntitySelector(params)\n\t{\n\t\tthis.selector = new TagSelector({\n\n\t\t\tid: params.id,\n\t\t\tdialogOptions: {\n\t\t\t\tid: params.id,\n\t\t\t\tcontext: 'GRATITUDE',\n\t\t\t\tpreselectedItems: (Type.isArray(params.preselectedItems) ? params.preselectedItems : []),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\taddButtonCaption: Loc.getMessage('BLOG_GRATMEDAL_1'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('BLOG_GRATMEDAL_1')\n\t\t});\n\n\t\tthis.selector.renderTo(document.getElementById(params.tagNodeId));\n\t\tthis.selector.subscribe('onContainerClick', () => {\n\t\t\tthis.emit('Selector::onContainerClick');\n\t\t});\n\t};\n\n\trecalcValue(selectedItems, inputNodeId): void\n\t{\n\t\tif (\n\t\t\t!Type.isArray(selectedItems)\n\t\t\t|| !document.getElementById(inputNodeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = [];\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tresult.push([ item.entityId, item.id ]);\n\t\t});\n\n\t\tdocument.getElementById(inputNodeId).value = JSON.stringify(result);\n\t};\n}","import { Dom, Type, Uri, ajax as Ajax, Event, Browser, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport PostFormTabs from './tabs';\nimport PostFormGratSelector from './grat';\nimport PostFormAutoSave from './autosave';\n\nexport default class PostFormEditor extends EventEmitter\n{\n\tstatic instance: { [key: string]: any } = {};\n\n\tdisabled: boolean = false;\n\tformParams: {};\n\tformId: string = '';\n\n\tstatic setInstance(id, instance)\n\t{\n\t\tPostFormEditor.instance[id] = instance;\n\t}\n\n\tstatic getInstance(id)\n\t{\n\t\treturn PostFormEditor.instance[id];\n\t}\n\n\tconstructor(formID, params)\n\t{\n\t\tsuper();\n\t\tthis.init(formID, params);\n\t\tPostFormEditor.setInstance(formID, this);\n\n\t\twindow['setBlogPostFormSubmitted'] = this.setBlogPostFormSubmitted.bind(this);\n\t\twindow['submitBlogPostForm'] = this.submitBlogPostForm.bind(this);\n\t}\n\n\tinit(formID, params)\n\t{\n\t\tthis.disabled = false;\n\t\tthis.formId = formID;\n\n\t\tthis.formParams = {\n\t\t\teditorID: params.editorID,\n\t\t\tshowTitle: !!params.showTitle,\n\t\t\tsubmitted: false,\n\t\t\ttext: params.text,\n\t\t\tautoSave: params.autoSave,\n\t\t\thandler: (LHEPostForm && LHEPostForm.getHandler(params.editorID)),\n\t\t\teditor: (LHEPostForm && LHEPostForm.getEditor(params.editorID)),\n\t\t\trestoreAutosave: !!params.restoreAutosave\n\t\t};\n\n\t\tEventEmitter.subscribe('onInitialized', (event: BaseEvent) => {\n\t\t\tconst [ obj, form ] = event.getData();\n\t\t\tthis.onHandlerInited(obj, form);\n\t\t});\n\t\tif (this.formParams.handler)\n\t\t{\n\t\t\tthis.onHandlerInited(this.formParams.handler, formID);\n\t\t}\n\n\t\tEventEmitter.subscribe('OnEditorInitedAfter', (event: BaseEvent) => {\n\t\t\tconst [ editor ] = event.getData();\n\t\t\tthis.onEditorInited.bind(editor);\n\t\t});\n\n\t\tif (this.formParams.editor)\n\t\t{\n\t\t\tthis.onEditorInited(this.formParams.editor);\n\t\t}\n\n\t\tEventEmitter.subscribe('onSocNetLogMoveBody', (event: BaseEvent) => {\n\t\t\tconst [ p ] = event.getData();\n\t\t\tif (p === 'sonet_log_microblog_container')\n\t\t\t{\n\t\t\t\tthis.reinit();\n\t\t\t}\n\t\t});\n\n\t\tEvent.ready(() => {\n\t\t\tif (\n\t\t\t\tBrowser.isIE()\n\t\t\t\t&& document.getElementById('POST_TITLE')\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst showTitlePlaceholderBlur = () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!node\n\t\t\t\t\t\t|| node.value === node.getAttribute('placeholder')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = node.getAttribute('placeholder');\n\t\t\t\t\t\tnode.classList.remove('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'blur', showTitlePlaceholderBlur);\n\t\t\t\tshowTitlePlaceholderBlur();\n\n\t\t\t\tdocument.getElementById('POST_TITLE').__onchange = (e) => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.className.indexOf('feed-add-post-inp-active') < 0 )\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.classList.add('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'click', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'keydown', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE').form, 'submit', () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif(node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.activeTab !== '')\n\t\t\t{\n\t\t\t\tPostFormTabs.getInstance().changePostFormTab(params.activeTab);\n\t\t\t}\n\n\t\t\tPostFormTabs.getInstance().subscribe('changePostFormTab', this.checkHideAlert.bind(this));\n\t\t\tif (PostFormGratSelector.getInstance())\n\t\t\t{\n\t\t\t\tPostFormGratSelector.getInstance().subscribe('Selector::onContainerClick', this.hideAlert.bind(this));\n\t\t\t}\n\t\t});\n\t}\n\n\tshowPanelTitle(show, saveChanges)\n\t{\n\t\tshow = (\n\t\t\tshow === true\n\t\t\t|| show === false\n\t\t\t\t? show\n\t\t\t\t: (\n\t\t\t\t\tdocument.getElementById('blog-title').style.display\n\t\t\t\t\t&& document.getElementById('blog-title').style.display === 'none'\n\t\t\t\t)\n\t\t);\n\n\t\tsaveChanges = (saveChanges !== false);\n\n\t\tconst showTitleValue = this.formParams.showTitle;\n\t\tconst node = document.getElementById(`lhe_button_title_${this.formId}`);\n\t\tconst nodeBlock = document.getElementById(`feed-add-post-block${this.formId}`);\n\t\tconst stv = (document.getElementById('show_title') || {});\n\n\t\tif(show)\n\t\t{\n\t\t\tBX.show(document.getElementById('blog-title'));\n\t\t\tif (document.getElementById('POST_TITLE'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').focus();\n\t\t\t}\n\n\t\t\tthis.formParams.showTitle = true;\n\t\t\tstv.value = 'Y';\n\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.add('feed-add-post-form-btn-active');\n\t\t\t}\n\n\t\t\tif (nodeBlock)\n\t\t\t{\n\t\t\t\tnodeBlock.classList.add('blog-post-edit-open');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.hide(document.getElementById('blog-title'));\n\t\t\tthis.formParams.showTitle = false;\n\t\t\tstv.value = \"N\";\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.remove('feed-add-post-form-btn-active');\n\t\t\t}\n\t\t}\n\n\t\tif (saveChanges)\n\t\t{\n\t\t\tBX.userOptions.save('socialnetwork', 'postEdit', 'showTitle', (this.formParams.showTitle ? 'Y' : 'N'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.formParams.showTitle = showTitleValue;\n\t\t}\n\t}\n\n\tsetBlogPostFormSubmitted(value)\n\t{\n\t\tif (document.getElementById('blog-submit-button-save'))\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.add('ui-btn-clock');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.remove('ui-btn-clock');\n\t\t\t}\n\t\t}\n\n\t\tthis.formParams.submitted = value;\n\t\tthis.disabled = value;\n\t};\n\n\tsubmitBlogPostForm(editor, value)\n\t{\n\t\tif (this.disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isObject(editor))\n\t\t{\n\t\t\tvalue = editor;\n\t\t\teditor = LHEPostForm.getEditor(this.formParams.editorID);\n\t\t}\n\n\t\tif (\n\t\t\teditor\n\t\t\t&& editor.id === this.formParams.editorID\n\t\t)\n\t\t{\n\t\t\tif(this.formParams.submitted)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\teditor.SaveContent();\n\n\t\t\tif(!value)\n\t\t\t{\n\t\t\t\tvalue = 'save';\n\t\t\t}\n\n\t\t\tif(document.getElementById('blog-title').style.display === 'none')\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').value = '';\n\t\t\t}\n\n\t\t\tconst submitButton = this.getSubmitButton({\n\t\t\t\tbuttonType: value,\n\t\t\t});\n\n\t\t\tif (submitButton)\n\t\t\t{\n\t\t\t\tsubmitButton.classList.add('ui-btn-clock');\n\t\t\t\tthis.disabled = true;\n\n\t\t\t\twindow.addEventListener('beforeunload', (event) => { // is called on every sumbit, with or without dialog\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.removeClass(submitButton, 'ui-btn-clock');\n\t\t\t\t\t\tthis.disabled = false;\n\t\t\t\t\t\tthis.formParams.submitted = false;\n\t\t\t\t\t}, 3000); // timeout needed to process a form on a back-end\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet actionUrl = '';\n\t\t\tconst activeTab = PostFormTabs.getInstance().active;\n\n\t\t\tif (Type.isStringFilled(activeTab))\n\t\t\t{\n\t\t\t\tactionUrl = document.getElementById(this.formId).action;\n\t\t\t\tUri.removeParam(actionUrl, [ 'b24statTab' ]);\n\t\t\t\tUri.addParam(actionUrl, {\n\t\t\t\t\tb24statTab: activeTab\n\t\t\t\t});\n\t\t\t\tdocument.getElementById(this.formId).action = actionUrl;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tactiveTab === PostFormTabs.getInstance().config.id.gratitude\n\t\t\t\t&& PostFormGratSelector.getInstance()\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.checkEmployeesValue({\n\t\t\t\t\tbuttonType: value,\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.submit(document.getElementById(this.formId), value);\n\n\t\t\tthis.formParams.submitted = true;\n\t\t}\n\t};\n\n\tcheckEmployeesValue({ buttonType }): boolean\n\t{\n\t\tconst employeesValueNode = document.getElementById(this.formId).elements[PostFormGratSelector.getInstance().config.fields.employeesValue.name];\n\t\tif (\n\t\t\t!employeesValueNode\n\t\t\t|| !Type.isStringFilled(employeesValueNode.value)\n\t\t\t|| employeesValueNode.value === '[]'\n\t\t)\n\t\t{\n\t\t\tconst submitButton = this.getSubmitButton({\n\t\t\t\tbuttonType,\n\t\t\t});\n\n\t\t\tif (submitButton)\n\t\t\t{\n\t\t\t\tsubmitButton.classList.remove('ui-btn-clock');\n\t\t\t\tthis.disabled = false;\n\t\t\t}\n\n\t\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\t\tif (alertNode)\n\t\t\t{\n\t\t\t\tDom.clean(alertNode);\n\t\t\t\talertNode.appendChild(Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-alert ui-alert-danger',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-alert-message',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BLOG_POST_EDIT_T_GRAT_ERROR_NO_EMPLOYEES'),\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tcheckHideAlert(event) {\n\t\tconst { type } = event.getData();\n\t\tif (type === PostFormTabs.getInstance().config.id.gratitude)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hideAlert();\n\t}\n\n\thideAlert()\n\t{\n\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\tif (!alertNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(alertNode);\n\t}\n\n\tgetSubmitButton({ buttonType })\n\t{\n\t\tlet result = null;\n\n\t\tif (\n\t\t\tbuttonType === 'save'\n\t\t\t&& document.getElementById('blog-submit-button-save')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-save');\n\t\t}\n\t\telse if (\n\t\t\tbuttonType === 'draft'\n\t\t\t&& document.getElementById('blog-submit-button-draft')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-draft');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tonHandlerInited(obj, form)\n\t{\n\t\tif (form !== this.formId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.handler = obj;\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnControlClick', () => {\n\t\t\tPostFormTabs.getInstance().changePostFormTab(PostFormTabs.getInstance().config.id.message);\n\t\t});\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterShowLHE', this.OnAfterShowLHE.bind(this));\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterHideLHE', this.OnAfterHideLHE.bind(this));\n\n\t\tif (obj.eventNode.style.display == 'none')\n\t\t{\n\t\t\tthis.OnAfterHideLHE();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.OnAfterShowLHE();\n\t\t}\n\t};\n\n\tOnAfterShowLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tDom.adjust(div[ii], {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: 'auto',\n\t\t\t\t\topacity: 1\n\t\t\t\t}\n\t\t\t});\n\t\t\tdiv[ii].style.padding = null;\n\t\t}\n\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(true, false);\n\t\t}\n\t};\n\n\tOnAfterHideLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tDom.adjust(div[ii], {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '0',\n\t\t\t\t\topacity: 0,\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(false, false);\n\t\t}\n\t};\n\n\tonEditorInited(editor)\n\t{\n\t\tif (PostForm.getInstance().initedEditorsList.includes(editor.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor.id !== this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.editor = editor;\n\t\tif(this.formParams.autoSave !== 'N')\n\t\t{\n\t\t\tnew PostFormAutoSave(this.formParams.autoSave, this.formParams.restoreAutosave);\n\t\t}\n\n\t\tconst f = window[editor.id + 'Files'];\n\t\tconst handler = LHEPostForm.getHandler(editor.id);\n\t\tconst needToReparse = [];\n\n\t\tlet node = null;\n\t\tlet controller = null;\n\n\t\tfor (let id in handler.controllers)\n\t\t{\n\t\t\tif (!handler.controllers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\thandler.controllers[id].parser\n\t\t\t\t&& handler.controllers[id].parser.bxTag === 'postimage'\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontroller = handler.controllers[id];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst closure = (a, b) => { return () => { a.insertFile(b); } };\n\t\tconst closure2 = (a, b, c) => { return () => {\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.deleteFile(b, {});\n\t\t\t\tDom.remove(document.getElementById(`wd-doc'${b}`));\n\t\t\t\tAjax({ method: 'GET', url: c});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta.deleteFile(b, c, a, { controlID : 'common' });\n\t\t\t}\n\t\t} };\n\n\t\tfor (let intId in f)\n\t\t{\n\t\t\tif (!f.hasOwnProperty(intId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.addFile(f[intId]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet id = handler.checkFile(intId, \"common\", f[intId]);\n\t\t\t\tneedToReparse.push(intId);\n\n\t\t\t\tif (\n\t\t\t\t\t!!id\n\t\t\t\t\t&& document.getElementById(`wd-doc${intId}`)\n\t\t\t\t\t&& !document.getElementById(`wd-doc${intId}`).hasOwnProperty('bx-bound'))\n\t\t\t\t{\n\t\t\t\t\tBX(`wd-doc${intId}`).setAttribute('bx-bound', 'Y');\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-img-wrap'))\n\t\t\t\t\t\t&& node\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.bind(node, 'click', closure(handler, id));\n\t\t\t\t\t\tnode.style.cursor = 'pointer';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-img-title'))\n\t\t\t\t\t\t&& node\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.bind(node, 'click', closure(handler, id));\n\t\t\t\t\t\tnode.style.cursor = 'pointer';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(node = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-post-del-but'))\n\t\t\t\t&& node\n\t\t\t)\n\t\t\t{\n\t\t\t\tEvent.bind(node, 'click', closure2(handler, intId, f[intId].del_url));\n\t\t\t\tnode.style.cursor = \"pointer\";\n\t\t\t}\n\t\t}\n\n\t\tif (needToReparse.length > 0)\n\t\t{\n\t\t\teditor.SaveContent();\n\t\t\tlet content = editor.GetContent();\n\t\t\tcontent = content.replace(new RegExp('\\\\&\\\\#91\\\\;IMG ID=(' + needToReparse.join('|') + ')([WIDTHHEIGHT=0-9 ]*)\\\\&\\\\#93\\\\;','gim'), '[IMG ID=$1$2]');\n\t\t\teditor.SetContent(content);\n\t\t\teditor.Focus();\n\t\t}\n\t\tPostForm.getInstance().initedEditorsList.push(editor.id);\n\t};\n\n\treinit()\n\t{\n\t\tif (!this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFunction(this.formParams.editor))\n\t\t{\n\t\t\tthis.formParams.editor(this.formParams.text);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(this.reinit, 50);\n\t\t}\n\t};\n}\n","import { Event, Type, Dom, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostFormEditor from './editor';\n\nexport default class PostFormAutoSave\n{\n\tconstructor(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tthis.init(autoSaveRestoreMethod, initRestore);\n\t}\n\n\tinit(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tconst formId = 'blogPostForm';\n\t\tconst form = document.getElementById(formId);\n\t\tconst titleID = 'POST_TITLE';\n\t\tconst title = document.getElementById(titleID);\n\t\tconst tags = form.TAGS;\n\n\t\tif (!form)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tinitRestore = (!Type.isUndefined(initRestore) ? !!initRestore : true);\n\n\t\tEventEmitter.subscribe(form, 'onAutoSavePrepare', (event: BaseEvent) => {\n\t\t\tconst [ ob, handler ] = event.getData();\n\n\t\t\tob.DISABLE_STANDARD_NOTIFY = true;\n\t\t\tconst _ob = ob;\n\t\t\tsetTimeout(() => { this.bindLHEEvents(_ob) }, 100);\n\t\t});\n\n\t\tEventEmitter.subscribe(form, 'onAutoSave', (event: BaseEvent) => {\n\t\t\tconst [ ob, formData ] = event.getData();\n\n\t\t\tformData.TAGS = tags.value;\n\t\t\tdelete formData.POST_MESSAGE;\n\t\t});\n\n\t\tif (autoSaveRestoreMethod == 'Y')\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tob.Restore();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst messageBody = document.getElementById('microoPostFormLHE_blogPostForm');\n\t\t\t\tconst textNode = Dom.create('DIV', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'feed-add-successfully'\n\t\t\t\t\t},\n\t\t\t\t\tchildren : [\n\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName : 'feed-add-info-icon'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create('A', {\n\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-info-text',\n\t\t\t\t\t\t\t\thref : '#'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick : () => {\n\t\t\t\t\t\t\t\t\tob.Restore();\n\t\t\t\t\t\t\t\t\ttextNode.parentNode.removeChild(textNode);\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BLOG_POST_AUTOSAVE2')\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\t\tif (messageBody)\n\t\t\t\t{\n\t\t\t\t\tmessageBody.parentNode.insertBefore(textNode, messageBody);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (initRestore)\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestore', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\ttitle.value = data[titleID];\n\t\t\t\tif(\n\t\t\t\t\tType.isStringFilled(data[titleID])\n\t\t\t\t\t&& data[titleID] !== title.getAttribute('placeholder')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif(document.getElementById('divoPostFormLHE_blogPostForm').style.display !== 'none')\n\t\t\t\t\t{\n\t\t\t\t\t\tPostFormEditor.getInstance(formId).showPanelTitle(true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.bShowTitle = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isFunction(title.__onchange))\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle.__onchange();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst formTags = window[`BXPostFormTags_${formId}`];\n\n\t\t\t\tif(\n\t\t\t\t\tdata.TAGS.length > 0\n\t\t\t\t\t&& formTags\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst tags = formTags.addTag(data.TAGS);\n\t\t\t\t\tif (tags.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.show(formTags.tagsArea);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit('onAutoSaveRestoreDestination', new BaseEvent({\n\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}]\n\t\t\t\t}));\n\n\t\t\t\tthis.bindLHEEvents(ob);\n\t\t\t});\n\t\t}\n\t};\n\n\tbindLHEEvents(_ob)\n\t{\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tconst title = document.getElementById('POST_TITLE');\n\t\tconst tags = form.TAGS;\n\n\t\tEvent.bind(title, 'keydown', _ob.Init.bind(_ob));\n\t\tEvent.bind(tags, 'keydown', _ob.Init.bind(_ob));\n\t};\n}"],"names":["AjaxProcessor","block","callback","Type","isArray","CSS","length","BX","load","JS","container","callbackExternal","appendChild","create","html","CONTENT","htmlWasInserted","scriptsLoaded","processInlineJS","ajax","processRequestData","scriptsRunFirst","dataType","PostForm","instance","params","init","setInstance","key","value","isStringFilled","options","startVideoRecorder","setTimeout","editorForm","document","getElementById","EventEmitter","emit","BaseEvent","compatData","VideoRecorder","start","sliderInstance","SidePanel","Instance","getTopSlider","postMessageAll","window","sliderData","getData","inited","lazyLoad","isUndefined","ajaxUrl","isDomNode","containerMicro","containerMicroInner","successPostId","parseInt","postMessage","originatorSliderId","get","close","subscribe","onSliderClose","set","clickDisabled","loaded","animationStartHeight","offsetHeight","loaderType","showWaitTab","style","display","showWait","Ajax","method","url","data","action","sessid","Loc","getMessage","onsuccess","result","closeWait","success","processAjaxBlock","PROPS","onfailure","isFunction","processor","processCSS","processAjaxBlockInsertHTML","processExternalJS","node","waiterNode","bxmsg","body","Dom","props","id","className","adjustWait","lastWait","push","parentNode","i","len","util","deleteFromArray","removeChild","clean","remove","nodePosition","pos","topDelta","top","GetDocElement","scrollTop","right","left","width","offsetWidth","taskId","Reflection","getClass","taskLink","replace","UI","Notification","Center","notify","content","actions","title","events","click","event","balloon","open","PostFormTabs","message","task","calendar","file","gratitude","important","vote","more","listItem","setEventNamespace","SBPETabs","tabContainer","arrow","tabs","bodies","tabsList","querySelectorAll","getAttribute","limited","menuItems","tabId","text","onclick","createOnClick","config","ii","hasOwnProperty","previousTab","uploadFileNode","setAttribute","Event","bind","form","changePostFormTab","type","name","btn","btnText","innerHTML","evalGlobal","menu","popupWindow","iblock","setActive","isNull","active","needAnimation","isTaskTabLoaded","startAnimation","classList","jj","adjust","tabPosTab","bottom","leftStart","widthStart","easing","duration","finish","transition","makeEaseInOut","transitions","quart","step","state","complete","add","animate","hasValuesFile","hasValuesDocs","messageBody","childNodes","nodeFile","values1","querySelector","values2","rows","indexOf","nodeDocs","webdavValues","contains","SBPEBinded","eventNode","wdObj","dialogName","urlUpload","agent","uploadFileUrl","controllerInit","endAnimation","restoreMoreMenu","contentContainer","children","postEditSlider","currentSlider","getSliderByWindow","match","formInstance","getInstance","getEvent","animation","stop","height","overflowY","position","opacity","offsetTop","makeEaseOut","cssText","MenuManager","closeByEsc","offsetLeft","angle","show","itemCnt","componentParameters","GROUP_ID","PATH_TO_USER_TASKS","PATH_TO_USER_TASKS_TASK","PATH_TO_GROUP_TASKS","PATH_TO_GROUP_TASKS_TASK","PATH_TO_USER_PROFILE","PATH_TO_GROUP","PATH_TO_USER_TASKS_PROJECTS_OVERVIEW","PATH_TO_USER_TASKS_TEMPLATES","PATH_TO_USER_TEMPLATES_TEMPLATE","ENABLE_FOOTER","TEMPLATE_CONTROLLER_ID","ENABLE_FORM","BACKURL","Tasks","Util","Query","runOnce","parameters","COMPONENT_PARAMETERS","then","isSuccess","Runtime","Error","getErrors","getMessages","join","reason","tabsDefault","menuItemsListsDefault","menuItemsLists","getMenuItems","createOnclickLists","getMenuItemsDefault","concat","showMoreMenuLists","siteId","bitrix_processes","k","lists","attrs","NAME","PICTURE","DESCRIPTION","PICTURE_SMALL","CODE","ID","permissions","admin","error","htmlspecialchars","menuBindElement","listsMenu","spanIcon","spanDataPicture","spanDataPictureDefault","Array","from","PostFormDateEnd","postExpireDateBlock","postEndTime","postEditingEndTime","postEndPeriod","popupTrigger","customDateFinal","durationOptionsContainer","durationOption","isInitialized","addEventHandlers","formDateTimeEditing","customDateSelectedTitle","innerText","getCurrentDate","selectors","formUfInputDateCustom","formDateDuration","addEventListener","showPostEndPeriodsPopup","curDate","Date","curTimestamp","Math","round","getTimezoneOffset","parseDate","date","convertToUTC","bTime","callback_after","onEndDateSet","popupShowingPeriods","createPopupShowingPeriods","createPopupItems","menuPostDurationItems","selectOptions","forEach","element","onPopupItemClick","dataset","class","currentTarget","customDatePopupOptionClass","customDateStyleModifier","toLowerCase","toUpperCase","getFormattedDate","format","convertBitrixFormat","PostFormGratSelector","fields","employeesValue","itemSelectedImageItem","itemSelectedInput","gratsList","e","openDialog","preventDefault","createEntitySelector","entitySelectorParams","gratItems","code","selectItem","gratRows","rownum","isNil","gratsContentElement","Popup","autoHide","bindOptions","forceBindPosition","closeIcon","onPopupClose","destroy","onPopupDestroy","offset","lightShadow","setAngle","gratSpan","selector","TagSelector","dialogOptions","context","preselectedItems","recalcValue","getTarget","getSelectedItems","inputNodeId","entities","emailUsers","inviteEmployeeLink","intranetUsersOnly","selectMode","addButtonCaption","addButtonCaptionMore","renderTo","tagNodeId","selectedItems","item","entityId","JSON","stringify","PostFormEditor","formID","setBlogPostFormSubmitted","submitBlogPostForm","disabled","formId","formParams","editorID","showTitle","submitted","autoSave","handler","LHEPostForm","getHandler","editor","getEditor","restoreAutosave","obj","onHandlerInited","onEditorInited","p","reinit","ready","Browser","isIE","showTitlePlaceholderBlur","__onchange","activeTab","checkHideAlert","hideAlert","saveChanges","showTitleValue","nodeBlock","stv","focus","hide","userOptions","save","isObject","SaveContent","submitButton","getSubmitButton","buttonType","removeClass","actionUrl","Uri","removeParam","addParam","b24statTab","checkEmployeesValue","submit","employeesValueNode","elements","alertNode","OnAfterShowLHE","OnAfterHideLHE","div","padding","showPanelTitle","initedEditorsList","includes","PostFormAutoSave","f","needToReparse","controller","controllers","parser","bxTag","closure","a","b","insertFile","closure2","c","deleteFile","controlID","intId","addFile","checkFile","cursor","del_url","GetContent","RegExp","SetContent","Focus","autoSaveRestoreMethod","initRestore","titleID","tags","TAGS","ob","DISABLE_STANDARD_NOTIFY","_ob","bindLHEEvents","formData","POST_MESSAGE","trim","Restore","textNode","href","insertBefore","bShowTitle","formTags","addTag","tagsArea","Init"],"mappings":"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"}