{"version":3,"file":"alert.bundle.js","sources":["../src/alert.js"],"sourcesContent":["import {Dom, Tag, Cache} from 'main.core';\nimport {Loc} from 'landing.loc';\nimport {BasePanel} from 'landing.ui.panel.base';\n\nimport './css/style.css';\n\n/**\n * Implements interface for works with alert panel\n * use this panel for show error and info messages\n *\n * Implements singleton design pattern. Don't use it as constructor\n * use BX.Landing.UI.Panel.Alert.getInstance() for get instance of module\n * @memberOf BX.Landing.UI.Panel\n */\nexport class Alert extends BasePanel\n{\n\tstatic staticCache = new Cache.MemoryCache();\n\n\tstatic getInstance(): Alert\n\t{\n\t\treturn this.staticCache.remember('instance', () => {\n\t\t\treturn new Alert();\n\t\t});\n\t}\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.onCloseClick = this.onCloseClick.bind(this);\n\t\tthis.text = this.getText();\n\t\tthis.closeButton = this.getCloseButton();\n\t\tthis.action = this.getAction();\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-alert');\n\n\t\tDom.append(this.text, this.layout);\n\t\tDom.append(this.action, this.layout);\n\t\tDom.append(this.layout, document.body);\n\t}\n\n\tgetText(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('text', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-panel-alert-text\"></div>`;\n\t\t});\n\t}\n\n\tgetCloseButton(): HTMLButtonElement\n\t{\n\t\treturn this.cache.remember('closeButton', () => {\n\t\t\tconst text = Loc.getMessage('LANDING_ALERT_ACTION_CLOSE');\n\t\t\treturn Tag.render`\n\t\t\t\t<button class=\"ui-btn ui-btn-link\" onclick=\"${this.onCloseClick}\">${text}</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAction(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('action', () => {\n\t\t\treturn Tag.render`<div class=\"landing-ui-panel-alert-action\">${this.getCloseButton()}</div>`;\n\t\t});\n\t}\n\n\tshow(type, text, hideSupportLink = false): Promise<Alert>\n\t{\n\t\tlet promise = Promise.resolve(this);\n\n\t\tif (this.isShown())\n\t\t{\n\t\t\tpromise = this.hide();\n\t\t}\n\n\t\treturn promise.then(() => {\n\t\t\tvoid super.show(this);\n\n\t\t\tif (type === 'error')\n\t\t\t{\n\t\t\t\tDom.removeClass(this.layout, 'landing-ui-alert');\n\t\t\t\tDom.addClass(this.layout, 'landing-ui-error');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.layout, 'landing-ui-error');\n\t\t\t\tDom.addClass(this.layout, 'landing-ui-alert');\n\t\t\t}\n\n\t\t\tthis.text.innerHTML = `${text || type} `;\n\n\t\t\tif (!hideSupportLink)\n\t\t\t{\n\t\t\t\tDom.append(this.getSupportLink(), this.text);\n\t\t\t}\n\n\t\t\treturn this;\n\t\t});\n\t}\n\n\tgetSupportLink(): HTMLAnchorElement\n\t{\n\t\treturn this.cache.remember('supportLink', () => {\n\t\t\tlet url = 'https://helpdesk.bitrix24.com/ticket.php';\n\n\t\t\tswitch (Loc.getMessage('LANGUAGE_ID'))\n\t\t\t{\n\t\t\t\tcase 'ru':\n\t\t\t\tcase 'by':\n\t\t\t\tcase 'kz':\n\t\t\t\t\turl = 'https://helpdesk.bitrix24.ru/ticket.php';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'de':\n\t\t\t\t\turl = 'https://helpdesk.bitrix24.de/ticket.php';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'br':\n\t\t\t\t\turl = 'https://helpdesk.bitrix24.com.br/ticket.php';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'es':\n\t\t\t\t\turl = 'https://helpdesk.bitrix24.es/ticket.php';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}\n\n\t\t\tthis.supportLink = BX.create('a', {\n\t\t\t\tprops: {className: 'landing-ui-panel-alert-support-link'},\n\t\t\t\thtml: BX.Landing.Loc.getMessage('LANDING_ALERT_ACTION_SUPPORT_LINK'),\n\t\t\t\tattrs: {href: url, target: '_blank'},\n\t\t\t});\n\n\t\t\tconst text = Loc.getMessage('LANDING_ALERT_ACTION_SUPPORT_LINK');\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${url}\" target=\"_blank\" class=\"landing-ui-panel-alert-support-link\">${text}</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonCloseClick()\n\t{\n\t\tvoid this.hide();\n\t}\n}"],"names":["Alert","staticCache","remember","options","cache","Cache","MemoryCache","onCloseClick","bind","text","getText","closeButton","getCloseButton","action","getAction","Dom","addClass","layout","append","document","body","Tag","render","Loc","getMessage","type","hideSupportLink","promise","Promise","resolve","isShown","hide","then","removeClass","innerHTML","getSupportLink","url","supportLink","BX","create","props","className","html","Landing","attrs","href","target","BasePanel"],"mappings":"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"}