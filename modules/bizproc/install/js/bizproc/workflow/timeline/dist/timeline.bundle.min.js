this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,s,i,a,t,l,r,o,c){"use strict";let n=e=>e,d,b;var p=babelHelpers.classPrivateFieldLooseKey("errors");class v{constructor(e){Object.defineProperty(this,p,{writable:true,value:[]});if(c.Type.isArrayFilled(e.errors)){babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.errors}}render(){return c.Tag.render(d||(d=n`
			<div class="bizproc-workflow-timeline_error-wrapper">
				<div class="bizproc-workflow-timeline_error-inner">
					${0}
					<div class="bizproc-workflow-timeline_error-img"></div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,p)[p].map((({message:e})=>c.Tag.render(b||(b=n`
						<p class="bizproc-workflow-timeline_error-text">${0}</p>
					`),c.Text.encode(e)))))}renderTo(e){c.Dom.append(this.render(),e)}}var u=babelHelpers.classPrivateFieldLooseKey("data");class L{constructor(e){Object.defineProperty(this,u,{writable:true,value:{}});if(c.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e}}canView(){return c.Type.isBoolean(babelHelpers.classPrivateFieldLooseBase(this,u)[u].canView)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].canView:false}get status(){return new o.TaskStatus(babelHelpers.classPrivateFieldLooseBase(this,u)[u].status)}get id(){return c.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].id)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].id:0}get name(){return c.Type.isString(babelHelpers.classPrivateFieldLooseBase(this,u)[u].name)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].name:""}get modified(){return c.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].modified)?Math.max(babelHelpers.classPrivateFieldLooseBase(this,u)[u].modified,0):0}get users(){return c.Type.isArray(babelHelpers.classPrivateFieldLooseBase(this,u)[u].users)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].users:[]}get executionTime(){return c.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,u)[u].executionTime)?Math.max(babelHelpers.classPrivateFieldLooseBase(this,u)[u].executionTime,0):null}get approveType(){return c.Type.isString(babelHelpers.classPrivateFieldLooseBase(this,u)[u].approveType)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].approveType:""}get url(){return c.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,u)[u].url)?babelHelpers.classPrivateFieldLooseBase(this,u)[u].url:null}}let P=e=>e,f,F,h,m,I,B,_,O;const E=60*60*24*3;var T=babelHelpers.classPrivateFieldLooseKey("task");var H=babelHelpers.classPrivateFieldLooseKey("userId");var w=babelHelpers.classPrivateFieldLooseKey("taskNumber");var R=babelHelpers.classPrivateFieldLooseKey("dateFormat");var g=babelHelpers.classPrivateFieldLooseKey("dateFormatShort");var y=babelHelpers.classPrivateFieldLooseKey("users");var k=babelHelpers.classPrivateFieldLooseKey("renderContent");var M=babelHelpers.classPrivateFieldLooseKey("renderButton");var S=babelHelpers.classPrivateFieldLooseKey("renderStatus");var N=babelHelpers.classPrivateFieldLooseKey("getStatusName");var W=babelHelpers.classPrivateFieldLooseKey("renderUsers");var K=babelHelpers.classPrivateFieldLooseKey("renderUser");var z=babelHelpers.classPrivateFieldLooseKey("renderExecutionTime");var D=babelHelpers.classPrivateFieldLooseKey("renderAccessDenied");class C{constructor(e){Object.defineProperty(this,D,{value:G});Object.defineProperty(this,z,{value:X});Object.defineProperty(this,K,{value:U});Object.defineProperty(this,W,{value:A});Object.defineProperty(this,N,{value:Z});Object.defineProperty(this,S,{value:x});Object.defineProperty(this,M,{value:j});Object.defineProperty(this,k,{value:$});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:0});Object.defineProperty(this,w,{writable:true,value:null});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e.task;babelHelpers.classPrivateFieldLooseBase(this,R)[R]=e.dateFormat;babelHelpers.classPrivateFieldLooseBase(this,g)[g]=e.dateFormatShort;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=e.users;if(c.Type.isNumber(e.taskNumber)&&e.taskNumber>0){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=e.taskNumber}if(c.Type.isNumber(e.userId)&&e.userId>0){babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e.userId}}renderTo(e){c.Dom.append(this.render(),e)}render(){return babelHelpers.classPrivateFieldLooseBase(this,T)[T].canView()?babelHelpers.classPrivateFieldLooseBase(this,k)[k]():babelHelpers.classPrivateFieldLooseBase(this,D)[D]()}}function $(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].status.isWaiting();return c.Tag.render(f||(f=P`
			<div class="bizproc-workflow-timeline-item ${0}">
				<div class="bizproc-workflow-timeline-item-inner">
					<div>
						<span class="bizproc-workflow-timeline-icon ${0}">
							${0}
						</span>
						<div class="bizproc-workflow-timeline-title">
							<span>${0}</span>
							${0}
						</div>
					</div>
					<div class="bizproc-workflow-timeline-subject">
						${0}
					</div>
					<div class="bizproc-workflow-timeline-content">
						${0}
						${0}
						${0}
					</div>
				</div>
			</div>
		`),e?"--processing":"",e?"--processing":"--success",e?"":babelHelpers.classPrivateFieldLooseBase(this,w)[w]||"",c.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,T)[T].name),babelHelpers.classPrivateFieldLooseBase(this,M)[M](),c.Text.encode(Le.formatDate(babelHelpers.classPrivateFieldLooseBase(this,T)[T].modified,babelHelpers.classPrivateFieldLooseBase(this,R)[R],babelHelpers.classPrivateFieldLooseBase(this,g)[g])),babelHelpers.classPrivateFieldLooseBase(this,S)[S](),babelHelpers.classPrivateFieldLooseBase(this,W)[W](),babelHelpers.classPrivateFieldLooseBase(this,z)[z]())}function j(){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]===0||!babelHelpers.classPrivateFieldLooseBase(this,T)[T].url){return null}const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.find((e=>e.id===babelHelpers.classPrivateFieldLooseBase(this,H)[H]));if(c.Type.isUndefined(e)){return null}const s=new o.UserStatus(e.status).isWaiting();return c.Tag.render(F||(F=P`
			<a
				class="
					bizproc-workflow-timeline-task-link
					bizproc-workflow-timeline-task-link-${0}
				"
				href="${0}"
			>
				${0}
			</a>
		`),s?"blue":"gray",c.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,T)[T].url||new c.Uri(`/company/personal/bizproc/${babelHelpers.classPrivateFieldLooseBase(this,T)[T].id}/`).toString()),c.Text.encode(s?c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_PROCEED"):c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_SEE")))}function x(){let e=c.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,N)[N](babelHelpers.classPrivateFieldLooseBase(this,T)[T].status,babelHelpers.classPrivateFieldLooseBase(this,T)[T].approveType,babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length));if(babelHelpers.classPrivateFieldLooseBase(this,T)[T].status.isWaiting()&&babelHelpers.classPrivateFieldLooseBase(this,T)[T].approveType==="vote"){let s=0;for(const e of babelHelpers.classPrivateFieldLooseBase(this,T)[T].users){if(!new o.TaskStatus(e.status).isWaiting()){s++}}e=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_VOTED",{"#VOTED#":s,"#TOTAL#":babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length})}return c.Tag.render(h||(h=P`<div class="bizproc-workflow-timeline-caption">${0}</div>`),e)}function Z(e,s,i){if(e.isYes()||e.isOk()){return c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED")}if(e.isNo()||e.isCancel()){return c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED")}if(e.isWaiting()){if(i===1){return c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING")}let e="";switch(s){case"all":e=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ALL");break;case"any":e=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ANY");break;case"vote":e=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING_ALL");break;default:e=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING");break}return e}return e.name}function A(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].users.length>1;return c.Tag.render(m||(m=P`
			<div class="bizproc-workflow-timeline-user-list">
				${0}
			</div>
		`),Object.values(babelHelpers.classPrivateFieldLooseBase(this,T)[T].users).map((s=>babelHelpers.classPrivateFieldLooseBase(this,K)[K](s,e))))}function U(e,s){const i=babelHelpers.classPrivateFieldLooseBase(this,y)[y].get(e.id);if(!i){return null}const a=new o.TaskStatus(e.status);let t="";if(s){if(a.isYes()||a.isOk()){t="--voted-up"}if(a.isNo()){t="--voted-down"}}let l="<i></i>";if(c.Type.isString(i.avatarSize100)){l=`<i style="background-image: url('${encodeURI(c.Text.encode(i.avatarSize100))}')"></i>`}return c.Tag.render(I||(I=P`
			<div class="bizproc-workflow-timeline-user ${0}">
				<div class="bizproc-workflow-timeline-userlogo ui-icon ui-icon-common-user">
					${0}
				</div>
				<div class="bizproc-workflow-timeline-user-block">
					<a class="bizproc-workflow-timeline-link" href="${0}">${0}</a>
					<div class="bizproc-workflow-timeline-user-pos" title="${0}">
						${0}
					</div>
				</div>
			</div>
		`),t,l,i.link,c.Text.encode(i.fullName),c.Text.encode(i.workPosition||""),c.Text.encode(i.workPosition||""))}function X(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].executionTime;if(c.Type.isNil(e)){return null}const s=e>=E;const i=c.Tag.render(B||(B=P`
			<span
				data-hint="${0}"
			></span>
		`),c.Text.encode(c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_TIME_LIMIT_EXCEEDED")));const a=c.Tag.render(_||(_=P`
			<div class="bizproc-workflow-timeline-notice">
				<div class="bizproc-workflow-timeline-subject">
					${0}
				</div>
				<span class="bizproc-workflow-timeline-text">
					${0}
				</span>
				${0}
			</div>
		`),c.Text.encode(c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME")),c.Text.encode(Le.formatTimeInterval(e,2)),s?i:null);if(s){BX.UI.Hint.init(a)}return a}function G(){return c.Tag.render(O||(O=P`
			<div class="bizproc-workflow-timeline-item --tech">
				<div class="bizproc-workflow-timeline-item-inner">
					<div>
						<span class="bizproc-workflow-timeline-icon"></span>
						<div class="bizproc-workflow-timeline-title">
							${0}
						</div>
					</div>
					<div class="bizproc-workflow-timeline-subject">
						${0}
					</div>
				</div>
			</div>
		`),c.Text.encode(c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW")),c.Text.encode(c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW_TIP")))}let V=e=>e,Y,q,Q,J,ee,se,ie,ae,te,le,re,oe,ce,ne,de,be;var pe=babelHelpers.classPrivateFieldLooseKey("limits");var ve=babelHelpers.classPrivateFieldLooseKey("getFormatString");var ue=babelHelpers.classPrivateFieldLooseKey("getMultiplierByFormat");class Le{static formatTimestamp(e){return r.DateTimeFormat.format(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](Date.now()/1e3-e),e)}static formatTimeInterval(e,s=1){if(c.Type.isNil(e)){return c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN")}if(e===0){return c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_ZERO_SECOND_INTERVAL")}let i="";let a=e;for(let e=0;e<s;e++){const e=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve](a);if(i.length>0&&e==="sdiff"){return i}const s=babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](e);i+=r.DateTimeFormat.format(e,0,a);i+=" ";if(s>0){a%=s;if(a===0){return i}}}return i}static formatDate(e,s,i){if(i&&r.DateTimeFormat.format("Y",e)===r.DateTimeFormat.format("Y",Date.now()/1e3)){return r.DateTimeFormat.format(i,e)}return r.DateTimeFormat.format(s,e)}}function Pe(e){for(const s of babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]){if(e>s[0]){return s[1]}}return"sdiff"}function fe(e){for(const s of babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]){if(e===s[1]){return s[0]}}return 0}Object.defineProperty(Le,ue,{value:fe});Object.defineProperty(Le,ve,{value:Pe});Object.defineProperty(Le,pe,{writable:true,value:[[3600*24*365,"Ydiff"],[3600*24*31,"mdiff"],[3600*24,"ddiff"],[3600,"Hdiff"],[60,"idiff"]]});var Fe=babelHelpers.classPrivateFieldLooseKey("workflowId");var he=babelHelpers.classPrivateFieldLooseKey("data");var me=babelHelpers.classPrivateFieldLooseKey("isLoaded");var Ie=babelHelpers.classPrivateFieldLooseKey("errors");var Be=babelHelpers.classPrivateFieldLooseKey("container");var _e=babelHelpers.classPrivateFieldLooseKey("biPopup");var Oe=babelHelpers.classPrivateFieldLooseKey("dateFormat");var Ee=babelHelpers.classPrivateFieldLooseKey("dateFormatShort");var Te=babelHelpers.classPrivateFieldLooseKey("loadTimeline");var He=babelHelpers.classPrivateFieldLooseKey("setDataFromResponse");var we=babelHelpers.classPrivateFieldLooseKey("renderItemTitle");var Re=babelHelpers.classPrivateFieldLooseKey("renderSubject");var ge=babelHelpers.classPrivateFieldLooseKey("renderProceedTaskButton");var ye=babelHelpers.classPrivateFieldLooseKey("renderUser");var ke=babelHelpers.classPrivateFieldLooseKey("renderDoc");var Me=babelHelpers.classPrivateFieldLooseKey("renderCaption");var Se=babelHelpers.classPrivateFieldLooseKey("renderNotice");var Ne=babelHelpers.classPrivateFieldLooseKey("renderStatus");var We=babelHelpers.classPrivateFieldLooseKey("renderMore");var Ke=babelHelpers.classPrivateFieldLooseKey("renderContent");var ze=babelHelpers.classPrivateFieldLooseKey("renderItem");var De=babelHelpers.classPrivateFieldLooseKey("renderItemsList");var Ce=babelHelpers.classPrivateFieldLooseKey("renderFirstBlock");var $e=babelHelpers.classPrivateFieldLooseKey("renderContainer");var je=babelHelpers.classPrivateFieldLooseKey("textCrop");var xe=babelHelpers.classPrivateFieldLooseKey("createEfficiencyPopup");var Ze=babelHelpers.classPrivateFieldLooseKey("getEfficiencyData");var Ae=babelHelpers.classPrivateFieldLooseKey("renderEfficiencyInlineContent");var Ue=babelHelpers.classPrivateFieldLooseKey("renderEfficiencyPopupContent");var Xe=babelHelpers.classPrivateFieldLooseKey("getBiPopup");var Ge=babelHelpers.classPrivateFieldLooseKey("createBiPopup");var Ve=babelHelpers.classPrivateFieldLooseKey("renderBiPopupContent");var Ye=babelHelpers.classPrivateFieldLooseKey("renderLoadingStub");var qe=babelHelpers.classPrivateFieldLooseKey("hasErrors");class Qe{constructor(e,s){Object.defineProperty(this,qe,{value:Os});Object.defineProperty(this,Ye,{value:_s});Object.defineProperty(this,Ve,{value:Bs});Object.defineProperty(this,Ge,{value:Is});Object.defineProperty(this,Xe,{value:ms});Object.defineProperty(this,Ue,{value:hs});Object.defineProperty(this,Ae,{value:Fs});Object.defineProperty(this,Ze,{value:fs});Object.defineProperty(this,xe,{value:Ps});Object.defineProperty(this,je,{value:Ls});Object.defineProperty(this,$e,{value:us});Object.defineProperty(this,Ce,{value:vs});Object.defineProperty(this,De,{value:ps});Object.defineProperty(this,ze,{value:bs});Object.defineProperty(this,Ke,{value:ds});Object.defineProperty(this,We,{value:ns});Object.defineProperty(this,Ne,{value:cs});Object.defineProperty(this,Se,{value:os});Object.defineProperty(this,Me,{value:rs});Object.defineProperty(this,ke,{value:ls});Object.defineProperty(this,ye,{value:ts});Object.defineProperty(this,ge,{value:as});Object.defineProperty(this,Re,{value:is});Object.defineProperty(this,we,{value:ss});Object.defineProperty(this,He,{value:es});Object.defineProperty(this,Te,{value:Je});Object.defineProperty(this,Fe,{writable:true,value:void 0});Object.defineProperty(this,he,{writable:true,value:void 0});Object.defineProperty(this,me,{writable:true,value:void 0});Object.defineProperty(this,Ie,{writable:true,value:[]});Object.defineProperty(this,Be,{writable:true,value:void 0});Object.defineProperty(this,_e,{writable:true,value:void 0});Object.defineProperty(this,Oe,{writable:true,value:void 0});Object.defineProperty(this,Ee,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]=babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]();setTimeout((()=>{babelHelpers.classPrivateFieldLooseBase(this,je)[je]()}),500);if(c.Type.isPlainObject(e)){babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]=e.workflowId;babelHelpers.classPrivateFieldLooseBase(this,me)[me]=false;babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]()}if(c.Type.isPlainObject(s)){babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]=`${s.dateFormat||"j F Y"} ${s.timeFormat||"H:i"}`;babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]=`${s.dateFormatShort||"j F"} ${s.timeFormat||"H:i"}`}}static open(e){c.Runtime.loadExtension("sidepanel").then((()=>{BX.SidePanel.Instance.open(c.Uri.addParam("/bitrix/components/bitrix/bizproc.workflow.timeline.slider/index.php",c.Type.isPlainObject(e)?e:{}),{width:950,allowChangeHistory:false,cacheable:false,loader:"/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg"})})).catch((e=>console.error(e.errors)))}render(){c.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]);if(babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]()){const e=new v({errors:babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]});e.renderTo(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]);return babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]}if(!babelHelpers.classPrivateFieldLooseBase(this,me)[me]){c.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](),babelHelpers.classPrivateFieldLooseBase(this,Be)[Be])}if(c.Type.isPlainObject(babelHelpers.classPrivateFieldLooseBase(this,he)[he])){c.Dom.replace(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be],babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]());babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]().show()}return babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]}showBiPopup(){babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe]().show()}}function Je(){c.ajax.runAction("bizproc.workflow.getTimeline",{data:{workflowId:babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,He)[He](e);babelHelpers.classPrivateFieldLooseBase(this,me)[me]=true;this.render()})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,He)[He](e);babelHelpers.classPrivateFieldLooseBase(this,me)[me]=true;this.render()}))}function es(e){if(c.Type.isPlainObject(e)){const i=(e,s="")=>c.Type.isString(e)?e:s;const a=(e,s=[])=>c.Type.isArray(e)?e:s;const t=(e,s=false)=>c.Type.isBoolean(e)?e:s;const l=(e,s=0)=>c.Type.isInteger(e)?e:s;if(c.Type.isPlainObject(e.data)){babelHelpers.classPrivateFieldLooseBase(this,he)[he]={document:new s.DocumentId({documentId:a(e.data.documentType),entityName:i(e.data.entityName),documentName:i(e.data.documentName),documentUrl:i(e.data.documentUrl),moduleName:i(e.data.moduleName)}),isWorkflowRunning:t(e.data.isWorkflowRunning),timeToStart:l(e.data.timeToStart,null),executionTime:l(e.data.executionTime,null),started:l(e.data.started,null),startedBy:l(e.data.startedBy),tasks:a(e.data.tasks).map((e=>new L(e))),users:new Map,stats:{averageDuration:l(e.data.stats.averageDuration,null),efficiency:i(e.data.stats.efficiency)}};for(const s of a(e.data.users)){babelHelpers.classPrivateFieldLooseBase(this,he)[he].users.set(c.Text.toInteger(s.id),s)}}babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]=a(e.errors)}}function ss(e,s,i,a){const t=c.Type.isString(s)?` ${s}`:"";const l=c.Type.isString(i)?i:"";const r=a?' data-crop="crop"':"";return c.Tag.render(Y||(Y=V`
			<div>
				<span class="bizproc-workflow-timeline-icon${0}">${0}</span>
				<div class="bizproc-workflow-timeline-title"${0}>${0}</div>
			</div>
		`),t,l,r,c.Text.encode(e))}function is(e){return c.Tag.render(q||(q=V`
			<div class="bizproc-workflow-timeline-subject">${0}</div>
		`),c.Text.encode(e))}function as(e){const s=e.url||new c.Uri(`/company/personal/bizproc/${e.id}/`).toString();return c.Tag.render(Q||(Q=V`
			<div class="task-button --hidden">
				<a class="ui-btn ui-btn-xs ui-btn-primary ui-btn-round" href="${0}">
					${0}
				</a>
			</div>
		`),c.Text.encode(s),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_PROCEED"))}function ts(e,s=null,i=null){const a=babelHelpers.classPrivateFieldLooseBase(this,he)[he].users.get(e||s.id);let t="";let l=false;if(s){const e=new o.TaskStatus(s.status);if(e.isYes()||e.isOk()){t=" --voted-up"}if(e.isNo()){t=" --voted-down"}if(e.isWaiting()){l=true}}const r=c.Type.isString(a.workPosition)?`<div class="bizproc-workflow-timeline-user-pos">${c.Text.encode(a.workPosition)}</div>`:"";let n="<i></i>";if(c.Type.isString(a.avatarSize100)){n=`<i style="background-image: url('${a.avatarSize100}')"></i>`}const d=i!=null&&i.id&&l?babelHelpers.classPrivateFieldLooseBase(this,ge)[ge](i):"";return c.Tag.render(J||(J=V`
			<div class="bizproc-workflow-timeline-user${0}">
				<div class="bizproc-workflow-timeline-userlogo ui-icon ui-icon-common-user">
					${0}
				</div>
				<div class="bizproc-workflow-timeline-user-block">
					<a class="bizproc-workflow-timeline-link" href="${0}">${0}</a>
					${0}
				</div>
				${0}
			</div>
		`),t,n,a.link,c.Text.encode(a.fullName),r,d)}function ls(e,s,i,a){return c.Tag.render(ee||(ee=V`
			<div class="bizproc-workflow-timeline-doc">
				${0}
				<div class="bizproc-workflow-timeline-type">
					<span class="ui-icon-set ${0}"></span>
					<span class="bizproc-workflow-timeline-type-text">${0}</span>
				</div>
				<a class="bizproc-workflow-timeline-link" href="${0}" target="_top">${0}</a>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_START_DOC")),a,i,s,c.Text.encode(e))}function rs(e){return c.Tag.render(se||(se=V`
			<div class="bizproc-workflow-timeline-caption">${0}</div>
		`),e)}function os(e,s){return c.Tag.render(ie||(ie=V`
			<div class="bizproc-workflow-timeline-notice">
				<div class="bizproc-workflow-timeline-subject">${0}</div>
				<span class="bizproc-workflow-timeline-text">${0}</span>
			</div>
		`),c.Text.encode(e),c.Text.encode(s))}function cs(e,s){const i=c.Type.isString(s)?` ${s}`:"";return c.Tag.render(ae||(ae=V`
			<div class="bizproc-workflow-timeline-status${0}">${0}</div>
		`),i,c.Text.encode(e))}function ns(){return c.Tag.render(te||(te=V`
			<div class="bizproc-workflow-timeline-item --more">
				<div class="bizproc-workflow-timeline-item-inner">
					<span class="bizproc-workflow-timeline-icon"></span>
					<button class="ui-btn ui-btn-light-border ui-btn-xs" type="button" onclick="expandMore(event)">
						<span class="ui-btn-text">
							${0}
						</span>
					</button>
					<script type="text/javascript">
						function expandMore(event)
						{
							const moreItemBlock = event.target.closest('.--more');
							const hiddenBlocks = document.querySelectorAll('.bizproc-workflow-timeline-item.--hidden:not(.--efficiency)');
							BX.Dom.addClass(moreItemBlock, '--hidden');
							hiddenBlocks.forEach((hiddenBlock) => BX.Dom.removeClass(hiddenBlock, '--hidden'));
						}
					</script>
				</div>
			</div>
		`),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_MORE_TASKS"))}function ds(e){return c.Tag.render(le||(le=V`
			<div class="bizproc-workflow-timeline-content">
				${0}
			</div>
		`),e)}function bs(e,s,i){const a=c.Type.isString(s)?` ${s}`:"";const t=c.Type.isString(i)?` data-efficiency-class="${i}"`:"";return c.Tag.render(re||(re=V`
			<div class="bizproc-workflow-timeline-item${0}"${0}>
				<div class="bizproc-workflow-timeline-item-inner">
					${0}
				</div>
			</div>
		`),a,t,e)}function ps(e){return c.Tag.render(oe||(oe=V`
			<div class="bizproc-workflow-timeline-wrapper">
				<div class="bizproc-workflow-timeline-inner">
					<div class="bizproc-workflow-timeline-list">
						${0}
					</div>
					<script type="text/javascript">
						(function() {
							const buttons = document.querySelectorAll('.task-button.--hidden');
							const showButtons = buttons.length > 1;
							buttons.forEach(function (button) {
								BX.Dom.insertBefore(
									button.closest('.bizproc-workflow-timeline-user'),
									button.closest('.bizproc-workflow-timeline-user-list').firstChild
								);
								if (showButtons)
								{
									BX.Dom.removeClass(button, '--hidden')
								}
							});
						})();
					</script>
				</div>
			</div>
		`),e)}function vs(){const e=[];if(babelHelpers.classPrivateFieldLooseBase(this,he)[he].startedBy){e.push(babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_FROM")),babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](babelHelpers.classPrivateFieldLooseBase(this,he)[he].startedBy))}e.push(babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](babelHelpers.classPrivateFieldLooseBase(this,he)[he].document.name,babelHelpers.classPrivateFieldLooseBase(this,he)[he].document.url,babelHelpers.classPrivateFieldLooseBase(this,he)[he].document.moduleName,"--file-2"));if(!c.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,he)[he].timeToStart)){e.push(babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME"),Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].timeToStart,2)))}return babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]([babelHelpers.classPrivateFieldLooseBase(this,we)[we](babelHelpers.classPrivateFieldLooseBase(this,he)[he].document.entityName,"--success","1"),babelHelpers.classPrivateFieldLooseBase(this,he)[he].started&&babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](Le.formatDate(babelHelpers.classPrivateFieldLooseBase(this,he)[he].started,babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe],babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee])),babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](e)],"--selected")}function us(){const e=[];let s="";let i=false;if(babelHelpers.classPrivateFieldLooseBase(this,he)[he]){let a=null;e.push(babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]());let t=1;let l=babelHelpers.classPrivateFieldLooseBase(this,he)[he].tasks[0]?!babelHelpers.classPrivateFieldLooseBase(this,he)[he].tasks[0].status.isWaiting():true;for(const s of Object.keys(babelHelpers.classPrivateFieldLooseBase(this,he)[he].tasks)){a=babelHelpers.classPrivateFieldLooseBase(this,he)[he].tasks[s];i=a.status.isWaiting();if(!i){++t}const r=new C({task:a,userId:c.Text.toInteger(c.Loc.getMessage("USER_ID")),dateFormat:babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe],dateFormatShort:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee],taskNumber:i?null:t,users:babelHelpers.classPrivateFieldLooseBase(this,he)[he].users});const o=r.render();if(!i&&l){c.Dom.addClass(o,"--hidden")}if(i&&l){e.push(babelHelpers.classPrivateFieldLooseBase(this,We)[We]());l=false}e.push(o)}if(l&&babelHelpers.classPrivateFieldLooseBase(this,he)[he].tasks[0]){e.push(babelHelpers.classPrivateFieldLooseBase(this,We)[We]())}if(babelHelpers.classPrivateFieldLooseBase(this,he)[he].isWorkflowRunning){if(i){e.push(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]([babelHelpers.classPrivateFieldLooseBase(this,we)[we](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS")),babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_TIP"))],"--tech --previous-item"))}else{e.push(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]([babelHelpers.classPrivateFieldLooseBase(this,we)[we](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE")),babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE_TIP"))],"--tech --previous-item"))}}else{const i=!a||a.status.isOk()||a.status.isYes();const t=[babelHelpers.classPrivateFieldLooseBase(this,Me)[Me](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_FINISHED"))];if(babelHelpers.classPrivateFieldLooseBase(this,he)[he].startedBy){t.push(i?babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_APPROVED_FOR")):babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED"),"--failure"),babelHelpers.classPrivateFieldLooseBase(this,ye)[ye](babelHelpers.classPrivateFieldLooseBase(this,he)[he].startedBy))}t.push(babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_EXECUTED"),Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].executionTime)));s=i?"--success":"--declined";e.push(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]([babelHelpers.classPrivateFieldLooseBase(this,we)[we](babelHelpers.classPrivateFieldLooseBase(this,he)[he].document.entityName,i?"--success":null),babelHelpers.classPrivateFieldLooseBase(this,he)[he].started&&babelHelpers.classPrivateFieldLooseBase(this,Re)[Re](Le.formatDate(babelHelpers.classPrivateFieldLooseBase(this,he)[he].started+babelHelpers.classPrivateFieldLooseBase(this,he)[he].executionTime,babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe],babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee])),babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](t)],i?"--success --previous":"--declined --selected --previous",s),babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae]())}}return babelHelpers.classPrivateFieldLooseBase(this,De)[De](e)}function Ls(){const e=document.querySelectorAll('[data-crop="crop"]');for(const s of e){const e=new t.TextCrop({rows:2,target:s});e.init()}}function Ps(){return new l.Popup({width:403,minHeight:345,closeIcon:true,content:babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue](),bindElement:{left:555,top:130},padding:26,borderRadius:"18px",className:"--bizproc-timeline-popup",events:{onPopupClose:()=>{let e=document.querySelector(".--previous-item");if(!e){e=document.querySelector(".bizproc-workflow-timeline-item.--processing")}if(!e){return}BX.Dom.addClass(e,"--previous");let s=e.getAttribute("data-efficiency-class");if(!s){s=""}e.after(babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](s))}}})}function fs(){let e="--first";let s=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_STATS");switch(babelHelpers.classPrivateFieldLooseBase(this,he)[he].stats.efficiency){case"fast":if(Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].stats.averageDuration)===Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].executionTime)){e="--slow";s=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_SLOWLY")}else{e="--fast";s=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_QUICKLY")}break;case"slow":e="--slow";s=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_SLOWLY");break;case"stopped":e="--stopped";s=c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_NO_PROGRESS");break;default:break}return[e,s]}function Fs(e){const[s,i]=babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]();const a=c.Tag.render(ce||(ce=V`
			<div class="bizproc-workflow-timeline-item --efficiency ${0}">
				<div class="bizproc-workflow-timeline-item-inner">
					<div class="bizproc-workflow-timeline-title">
						${0}
					</div>
					<div class="bizproc-workflow-timeline-content">
						<div class="bizproc-workflow-timeline-eff-icon ${0}"></div>
						<div class="bizproc-workflow-timeline-content-inner">
							<div class="bizproc-workflow-timeline-caption">${0}</div>
							<div class="bizproc-workflow-timeline-notice">
								<div class="bizproc-workflow-timeline-subject">
									${0}
								</div>
								<span class="bizproc-workflow-timeline-text">
									${0}
								</span>
								<span
									data-hint="${0}"
								></span>
							</div>
							<div class="bizproc-workflow-timeline-notice">
								<div class="bizproc-workflow-timeline-subject">
									${0}
								</div>
								<span class="bizproc-workflow-timeline-text">
									${0}
								</span>
							</div>
						</div>
					</div>
				</div>	
			</div>
		`),e,c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK"),s,i,c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME"),Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].executionTime),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_TIME_DIFFERENCE_MSGVER_1"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME"),babelHelpers.classPrivateFieldLooseBase(this,he)[he].stats.averageDuration===null?c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN"):Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].stats.averageDuration));BX.UI.Hint.init(a);return a}function hs(){const[e,s]=babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]();const i=c.Tag.render(ne||(ne=V`
			<div class="bizproc-timeline-popup">
				<div class="bizproc-timeline-popup-title">
					${0}
				</div>
				<div class="bizproc-timeline-popup-main">
					<div class="bizproc-timeline-popup-status">
						<div class="bizproc-timeline-popup-logo ${0}"></div>
						<div class="bizproc-timeline-popup-notice">${0}</div>
					</div>
					<div class="bizproc-timeline-popup-content">
						<div class="bizproc-timeline-popup-block">
							<span class="bizproc-timeline-popup-val">
								${0}
							</span>
							<span
								data-hint="${0}"
							></span>
							<div class="bizproc-timeline-popup-prop">
								${0}
							</div>
						</div>
						<div class="bizproc-timeline-popup-block">
							<span class="bizproc-timeline-popup-val">
								${0}
							</span>
							<div class="bizproc-timeline-popup-prop">
								${0}
							</div>
						</div>
					</div>
				</div>
				<div class="bizproc-timeline-popup-footer">
					<p class="bizproc-timeline-popup-text">
						${0}
					</p>
					<a class="bizproc-timeline-popup-text" href="javascript:top.BX.Helper.show('redirect=detail&code=18783714')">
						${0}
					</a>
				</div>
			</div>
		`),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK"),e,s,Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].executionTime),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_TIME_DIFFERENCE_MSGVER_1"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME"),Le.formatTimeInterval(babelHelpers.classPrivateFieldLooseBase(this,he)[he].stats.averageDuration),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_TIP"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_LINK"));BX.UI.Hint.init(i);return i}function ms(){if(!babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]){return babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge]()}return babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]}function Is(){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]=new l.Popup({width:403,minHeight:183,closeIcon:true,content:babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](),bindElement:{left:207,top:482},padding:17,borderRadius:"18px",className:"--bizproc-timeline-popup --bi"});return babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]}function Bs(){return c.Tag.render(de||(de=V`
			<div class="bizproc-timeline-popup">
				<div class="bizproc-timeline-popup-title">${0}</div>
				<p class="bizproc-timeline-popup-info">${0}</p>
				<button class="ui-btn ui-btn-light-border ui-btn-round ui-btn-xs">
					<span class="ui-btn-text">${0}</span>
				</button>
			</div>
		`),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TITLE"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TIP"),c.Loc.getMessage("BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_LINK"))}function _s(){return c.Tag.render(be||(be=V`
			<img src="/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg"
				 style="width:100%; margin: 0; padding: 0;"/>
		`))}function Os(){return babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].length>0}e.DurationFormatter=Le;e.Timeline=Qe})(this.BX.Bizproc.Workflow=this.BX.Bizproc.Workflow||{},BX.Bizproc,BX.Bizproc,BX,BX.UI,BX.Main,BX.Main,BX.Bizproc,BX);
//# sourceMappingURL=timeline.bundle.map.js