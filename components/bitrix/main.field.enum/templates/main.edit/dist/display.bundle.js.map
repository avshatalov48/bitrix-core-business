{"version":3,"file":"display.bundle.js","sources":["../src/dialog.js","../src/ui.js"],"sourcesContent":["import { Dom, Event, Runtime, Tag } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport type { DialogOptions } from 'ui.entity-selector';\nimport { Dialog as EntitySelector, Item, TagItem, TagSelector } from 'ui.entity-selector';\n\ntype Element = {\n\tVALUE: string,\n\tNAME: string,\n\tIS_SELECTED?: boolean,\n};\n\ntype Params = {\n\ttargetNodeId: string,\n\tfieldName: string,\n\tfieldNameForEvent: string,\n\tisMultiple: string,\n\titems: [],\n\temptyValueTitle: ?string,\n\tfieldTitle: string,\n\tcontext: string,\n\tmessages: string[],\n}\n\ntype DialogItem = {\n\tid: string,\n\tentityId: string,\n\ttitle: string,\n\ttabs: string,\n}\n\nexport class Dialog\n{\n\ttargetNode: HTMLElement = null;\n\twrapper: HTMLElement = null;\n\tvaluesWrapper: HTMLElement = null;\n\tinput: HTMLElement = null;\n\tfieldName: string;\n\tfieldNameForEvent: string;\n\tcontext: string;\n\temptyValueTitle: ?string;\n\tfieldTitle: string;\n\tisMultiple: boolean;\n\tdialogSelector: EntitySelector = null;\n\ttagSelector: TagSelector = null;\n\tselectedItems: Set<DialogItem> = new Set();\n\titems: Set<DialogItem> = new Set();\n\tmessages: string[] = [];\n\n\tconstructor(params: Params): void\n\t{\n\t\tthis.targetNode = document.getElementById(params.targetNodeId);\n\n\t\tif (this.targetNode === null)\n\t\t{\n\t\t\tthrow new Error(`Target node: ${params.targetNodeId} not found`);\n\t\t}\n\n\t\tthis.fieldName = params.fieldName.toLowerCase();\n\t\tthis.fieldNameForEvent = params.fieldNameForEvent;\n\t\tthis.emptyValueTitle = params.emptyValueTitle;\n\t\tthis.fieldTitle = params.fieldTitle;\n\t\tthis.context = params.context;\n\t\tthis.messages = params.messages;\n\t\tthis.isMultiple = (params.isMultiple === 'true');\n\n\t\tthis.prepareItems(params);\n\n\t\tthis.createWrappers();\n\t\tif (this.isMultiple)\n\t\t{\n\t\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\t\tthis.tagSelector = this.getTagSelector(exports.TagSelector);\n\t\t\t\tthis.tagSelector.renderTo(this.wrapper);\n\t\t\t\tthis.adjustLayout(false);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\t\tthis.dialogSelector = this.getDialogSelector(exports.Dialog);\n\t\t\t\tthis.prepareInput(this.targetNode);\n\n\t\t\t\tEvent.bind(this.targetNode, 'click', () => {\n\t\t\t\t\tthis.show();\n\t\t\t\t});\n\n\t\t\t\tif (this.selectedItems.size)\n\t\t\t\t{\n\t\t\t\t\tconst selectedItems = [...this.selectedItems];\n\t\t\t\t\tthis.input.value = selectedItems[0].title;\n\t\t\t\t}\n\t\t\t\tthis.adjustLayout(false);\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareItems(params: Params)\n\t{\n\t\tlet values = params.items;\n\t\tif (!Array.isArray(values))\n\t\t{\n\t\t\tif (values === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalues = [values];\n\t\t}\n\n\t\tconst entityId = this.fieldName;\n\t\tvalues.forEach((element: Element) => {\n\t\t\tconst setItem = {\n\t\t\t\tid: element.VALUE,\n\t\t\t\tentityId: entityId,\n\t\t\t\ttitle: element.NAME,\n\t\t\t\ttabs: entityId\n\t\t\t};\n\t\t\tthis.items.add(setItem);\n\t\t\tif (element.IS_SELECTED === true)\n\t\t\t{\n\t\t\t\tthis.selectedItems.add(setItem);\n\t\t\t}\n\t\t});\n\t}\n\n\tprepareInput(node: HTMLElement): void\n\t{\n\t\tthis.input = Tag.render`\n\t\t\t<input \n\t\t\t\tname=\"${node.id}_input\" \n\t\t\t\ttype=\"text\" \n\t\t\t\tclass=\"ui-ctl-element main-ui-control main-enum-dialog-input\" \n\t\t\t\tautocomplete=\"off\"\n\t\t\t\tplaceholder=\"${this.emptyValueTitle}\"\n\t\t\t/>\n\t\t`;\n\t\tDom.append(this.input, node);\n\n\t\tconst dialogSelector = this.dialogSelector;\n\t\tconst input = this.input;\n\n\t\tEvent.bind(this.input, 'keyup', (event: Event) => {\n\t\t\tif (!input.value.length)\n\t\t\t{\n\t\t\t\tdialogSelector.search('');\n\t\t\t\tdialogSelector.clearSearch();\n\t\t\t\tdialogSelector.deselectAll();\n\t\t\t\tdialogSelector.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst selectedItems = dialogSelector.getSelectedItems();\n\t\t\t\tif (!selectedItems.some(item => {\n\t\t\t\t\treturn (item.title.getText() === input.value);\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\tdialogSelector.show();\n\t\t\t\t\tdialogSelector.clearSearch();\n\t\t\t\t\tdialogSelector.search(input.value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateWrappers(): void\n\t{\n\t\tthis.createWrapper();\n\t\tthis.createValuesWrapper();\n\t}\n\n\tcreateWrapper(): void\n\t{\n\t\tthis.wrapper = Tag.render`<div class=\"ui-ctl-w100\"></div>`;\n\t\tthis.targetNode.appendChild(this.wrapper);\n\t}\n\n\tcreateValuesWrapper(): void\n\t{\n\t\tthis.valuesWrapper = Tag.render`<div></div>`;\n\t\tthis.wrapper.appendChild(this.valuesWrapper);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.dialogSelector.show();\n\t}\n\n\tgetDialogSelector(entitySelector: EntitySelector): EntitySelector\n\t{\n\t\tconst options = this.getDialogOptions();\n\t\toptions.targetNode = this.targetNode;\n\t\toptions.events = {\n\t\t\t'Item:onSelect': this.onElementSelect.bind(this),\n\t\t\t'Item:onDeselect': this.onElementDeselect.bind(this),\n\t\t};\n\n\t\treturn new entitySelector(options);\n\t}\n\n\tgetTagSelector(tagSelector: TagSelector): TagSelector\n\t{\n\t\treturn new tagSelector({\n\t\t\taddButtonCaption: this.getMessage('addButtonCaption'),\n\t\t\taddButtonCaptionMore: this.getMessage('addButtonCaptionMore'),\n\t\t\tshowCreateButton: false,\n\t\t\tdialogOptions: this.getDialogOptions(),\n\t\t\titems: this.getDialogSelectedItems(),\n\t\t\theight: 240,\n\t\t\ttextBoxWidth: '100%',\n\t\t\tevents: {\n\t\t\t\tonTagAdd: this.onElementSelect.bind(this),\n\t\t\t\tonTagRemove: this.onElementDeselect.bind(this),\n\t\t\t}\n\t\t});\n\t}\n\n\tgetDialogOptions(): DialogOptions\n\t{\n\t\treturn {\n\t\t\tcontext: this.context,\n\t\t\titems: this.getDialogItems(),\n\t\t\tselectedItems: this.getDialogSelectedItems(),\n\t\t\theight: 240,\n\t\t\tdropdownMode: true,\n\t\t\tshowAvatars: false,\n\t\t\tcompactView: true,\n\t\t\tmultiple: this.isMultiple,\n\t\t\tenableSearch: false,\n\t\t\ttabs: [\n\t\t\t\t{\n\t\t\t\t\tid: this.fieldName,\n\t\t\t\t\ttitle: this.fieldTitle\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\tgetDialogItems(): Array\n\t{\n\t\treturn [...this.items];\n\t}\n\n\tgetDialogSelectedItems(): Array\n\t{\n\t\treturn [...this.selectedItems];\n\t}\n\n\tonElementSelect(event: BaseEvent): void\n\t{\n\t\tconst item = this.getItemFromEventData(event);\n\t\tif (!this.isMultiple)\n\t\t{\n\t\t\tthis.selectedItems.clear();\n\t\t\tthis.input.value = item.getTitle();\n\t\t}\n\n\t\tthis.selectedItems.add(this.createOption(item));\n\t\tthis.adjustLayout();\n\t}\n\n\tonElementDeselect(event: BaseEvent): void\n\t{\n\t\tconst item = this.getItemFromEventData(event);\n\t\tconst unselectedItem = this.createOption(item);\n\t\tif (!this.isMultiple)\n\t\t{\n\t\t\tthis.selectedItems.clear();\n\t\t\tthis.input.value = '';\n\t\t}\n\n\t\t// remove object \"unselectedItem\" from selectedItems array\n\t\tthis.selectedItems = new Set(\n\t\t\t[...this.selectedItems].filter(\n\t\t\t\t(element:DialogItem) => (JSON.stringify(element) !== JSON.stringify(unselectedItem))\n\t\t\t)\n\t\t);\n\t\tthis.adjustLayout();\n\t}\n\n\tgetItemFromEventData(event: BaseEvent): Item|TagItem\n\t{\n\t\treturn (this.isMultiple ? event.getData().tag : event.getData().item);\n\t}\n\n\tcreateOption(item: Item): DialogItem\n\t{\n\t\treturn {\n\t\t\tid: item.id,\n\t\t\tentityId: this.fieldName,\n\t\t\ttitle: item.title,\n\t\t\ttabs: this.fieldName,\n\t\t}\n\t}\n\n\tadjustLayout(isChanged: boolean = true): void\n\t{\n\t\tthis.clearValueItems();\n\t\tif (this.selectedItems.size)\n\t\t{\n\t\t\tthis.selectedItems.forEach(item => {\n\t\t\t\tthis.adjustItem(item.id)\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.adjustItem('');\n\t\t}\n\n\t\tif (isChanged)\n\t\t{\n\t\t\tBX.fireEvent(document.getElementById(this.fieldNameForEvent), 'change');\n\t\t}\n\t}\n\n\tclearValueItems(): void\n\t{\n\t\tthis.valuesWrapper.innerHTML = '';\n\t}\n\n\tadjustItem(id: string): void\n\t{\n\t\tthis.valuesWrapper.appendChild(this.createInputTag(id));\n\t}\n\n\tcreateInputTag(id: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<input name=\"${this.fieldName.toUpperCase()}\" type=\"hidden\" value=\"${id}\"/>\n\t\t`;\n\t}\n\n\tgetMessage(key: string): string|null\n\t{\n\t\treturn (this.messages[key] ?? null);\n\t}\n}\n","import {Event, Type, Text} from \"main.core\";\nimport {BaseEvent} from \"main.core.events\";\nimport {EventEmitter} from 'main.core.events'\n\nexport class Ui\n{\n\tfieldName: string = null;\n\tcontainer: HTMLElement = null;\n\tvalueContainerId: string = null;\n\tvalue = null;\n\titems = null;\n\tdefaultFieldName: string = null;\n\tblock: string = null;\n\tformName: string = null;\n\tparams = {};\n\n\tconstructor(params: Params): void\n\t{\n\t\tthis.fieldName = (params['fieldName'] || '');\n\t\tthis.container = document.getElementById(params['container']);\n\t\tthis.valueContainerId = (params['valueContainerId'] || '');\n\t\tthis.value = params['value'];\n\t\tthis.items = params['items'];\n\t\tthis.block = params['block'];\n\t\tthis.defaultFieldName = (params['defaultFieldName'] || this.fieldName + '_default');\n\t\tthis.formName = (params['formName'] || '');\n\t\tthis.params = (params['params'] || {});\n\t\tthis.bindElement();\n\t}\n\n\tbindElement(): void\n\t{\n\t\tthis.container.appendChild(BX.decl({\n\t\t\tblock: this.block,\n\t\t\tname: this.fieldName,\n\t\t\titems: this.items,\n\t\t\tvalue: this.value,\n\t\t\tparams: this.params,\n\t\t\tvalueDelete: false\n\t\t}));\n\n\t\tthis.onChangeHandler = this.onChange.bind(this);\n\t\tEventEmitter.subscribe('UI::Select::change', this.onChangeHandler);\n\n\t\tBX.bind(\n\t\t\tthis.container,\n\t\t\t'click',\n\t\t\tBX.defer(function(){\n\t\t\t\tthis.onChange({params: this.params, node: this.container.firstChild})\n\t\t\t}.bind(this))\n\t\t);\n\t}\n\n\tonChange(eventNode)\n\t{\n\t\tlet controlObject;\n\n\t\tif (eventNode instanceof BaseEvent)\n\t\t{\n\t\t\tconst data = eventNode.getData();\n\t\t\tcontrolObject = data[0];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontrolObject = eventNode;\n\t\t}\n\n\t\tif (!document.getElementById(this.valueContainerId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet currentValue = null;\n\n\t\tif (\n\t\t\tcontrolObject.node !== null\n\t\t\t&& controlObject.node.getAttribute('data-name') === this.fieldName\n\t\t)\n\t\t{\n\t\t\tcurrentValue = JSON.parse(controlObject.node.getAttribute('data-value'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.changeValue(currentValue);\n\t}\n\n\tchangeValue(currentValue)\n\t{\n\t\tlet s = '';\n\n\t\tif (!Type.isArray(currentValue))\n\t\t{\n\t\t\tif (currentValue === null)\n\t\t\t{\n\t\t\t\tcurrentValue = [{VALUE: ''}];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcurrentValue = [currentValue];\n\t\t\t}\n\t\t}\n\n\t\tif (currentValue.length > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < currentValue.length; i++)\n\t\t\t{\n\t\t\t\ts += `<input type=\"hidden\" name=\"${this.fieldName}\" value=\"${Text.encode(currentValue[i].VALUE)}\" />`;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts += `<input type=\"hidden\" name=\"${this.fieldName}\" value=\"\" />`;\n\t\t}\n\t\tdocument.getElementById(this.valueContainerId).innerHTML = s;\n\t\tBX.fireEvent(document.getElementById(this.defaultFieldName), 'change');\n\t}\n}\n"],"names":["Dialog","params","Set","targetNode","document","getElementById","targetNodeId","Error","fieldName","toLowerCase","fieldNameForEvent","emptyValueTitle","fieldTitle","context","messages","isMultiple","prepareItems","createWrappers","Runtime","loadExtension","then","exports","tagSelector","getTagSelector","TagSelector","renderTo","wrapper","adjustLayout","dialogSelector","getDialogSelector","prepareInput","Event","bind","show","selectedItems","size","input","value","title","values","items","Array","isArray","entityId","forEach","element","setItem","id","VALUE","NAME","tabs","add","IS_SELECTED","node","Tag","render","Dom","append","event","length","search","clearSearch","deselectAll","hide","getSelectedItems","some","item","getText","createWrapper","createValuesWrapper","appendChild","valuesWrapper","entitySelector","options","getDialogOptions","events","onElementSelect","onElementDeselect","addButtonCaption","getMessage","addButtonCaptionMore","showCreateButton","dialogOptions","getDialogSelectedItems","height","textBoxWidth","onTagAdd","onTagRemove","getDialogItems","dropdownMode","showAvatars","compactView","multiple","enableSearch","getItemFromEventData","clear","getTitle","createOption","unselectedItem","filter","JSON","stringify","getData","tag","isChanged","clearValueItems","adjustItem","BX","fireEvent","innerHTML","createInputTag","toUpperCase","key","Ui","container","valueContainerId","block","defaultFieldName","formName","bindElement","decl","name","valueDelete","onChangeHandler","onChange","EventEmitter","subscribe","defer","firstChild","eventNode","controlObject","BaseEvent","data","currentValue","getAttribute","parse","changeValue","s","Type","i","Text","encode"],"mappings":"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"}