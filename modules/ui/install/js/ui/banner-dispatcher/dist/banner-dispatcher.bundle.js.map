{"version":3,"file":"banner-dispatcher.bundle.js","sources":["../src/queue.js","../src/banner-dispatcher.js"],"sourcesContent":["import { LaunchPriority, AutoLauncher, type LaunchItemOptions, type LaunchItemCallback } from 'ui.auto-launch';\nimport { Type, Text } from 'main.core';\n\nexport class Queue\n{\n\t#priority: LaunchPriority;\n\t#delay: number;\n\t#itemList: Object = {};\n\t#enough: boolean = false;\n\t#launchPerHit: boolean = false;\n\n\tconstructor(priority: LaunchPriority, delay: number, launchPerHit: boolean = false)\n\t{\n\t\tthis.#delay = parseInt(delay, 10) * 1000;\n\t\tthis.#priority = priority;\n\t\tthis.#launchPerHit = launchPerHit;\n\t}\n\n\tadd(callback: LaunchItemCallback, options: LaunchItemOptions = {}): void\n\t{\n\t\tif (this.#enough)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isFunction(callback))\n\t\t{\n\t\t\tthrow new TypeError('Unexpected type \"promise\" argument, expected Promise or callback');\n\t\t}\n\t\tconst allowLaunchAfterOthers = !(this.#launchPerHit && Object.values(this.#itemList).length > 0);\n\n\t\tconst id = Type.isStringFilled(options.id) ? options.id : Text.getRandom();\n\t\tthis.#itemList[id] = callback;\n\n\t\tAutoLauncher.register(callback, {\n\t\t\t...options,\n\t\t\tdelay: this.#delay,\n\t\t\tpriority: this.#priority,\n\t\t\tallowLaunchAfterOthers,\n\t\t\tid,\n\t\t});\n\t}\n\n\tgetItems(): Object\n\t{\n\t\treturn this.#itemList;\n\t}\n\n\tclean(): void\n\t{\n\t\tObject.keys(this.#itemList).forEach((id) => {\n\t\t\tthis.remove(id);\n\t\t});\n\t}\n\n\tenough(): void\n\t{\n\t\tthis.#enough = true;\n\t}\n\n\tnotEnough(): void\n\t{\n\t\tthis.#enough = false;\n\t}\n\n\tstop()\n\t{\n\t\tthis.clean();\n\t\tthis.enough();\n\t}\n\n\tremove(id: string): void\n\t{\n\t\tAutoLauncher.unregister(id);\n\t}\n}\n","import { LaunchPriority, type LaunchItemOptions, type LaunchItemCallback } from 'ui.auto-launch';\nimport { Queue } from './queue';\n\nconst criticalQueue = new Queue(LaunchPriority.CRITICAL, 0);\nconst highQueue = new Queue(LaunchPriority.HIGH, 1);\nconst normalQueue = new Queue(LaunchPriority.NORMAL, 1, true);\nconst lowQueue = new Queue(LaunchPriority.LOW, 5, true);\n\nexport const BannerDispatcher = {\n\tcritical: {\n\t\ttoQueue: (callback: LaunchItemCallback, options: LaunchItemOptions = {}) => {\n\t\t\tcriticalQueue.add(callback, {\n\t\t\t\tallowLaunchAfterOthers: true,\n\t\t\t\tforceShowOnTop: true,\n\t\t\t\t...options,\n\t\t\t});\n\t\t},\n\t},\n\thigh: {\n\t\ttoQueue: (callback: LaunchItemCallback, options: LaunchItemOptions = {}) => {\n\t\t\thighQueue.add(callback, {\n\t\t\t\tallowLaunchAfterOthers: true,\n\t\t\t\t...options,\n\t\t\t});\n\t\t},\n\t},\n\tnormal: {\n\t\ttoQueue: (callback: LaunchItemCallback, options: LaunchItemOptions = {}) => {\n\t\t\tnormalQueue.add(callback, options);\n\t\t},\n\t},\n\tlow: {\n\t\ttoQueue: (callback: LaunchItemCallback, options: LaunchItemOptions = {}) => {\n\t\t\tlowQueue.add(callback, options);\n\t\t},\n\t},\n\n\ttoQueue: (callback: LaunchItemCallback, options: LaunchItemOptions = {}) => {\n\t\tnormalQueue.add(callback, options);\n\t},\n\n\tonly(priorityList: Array<LaunchPriority>)\n\t{\n\t\tconst priorityValues = Object.values(LaunchPriority);\n\t\tpriorityValues.forEach((priorityValue) => {\n\t\t\tif (!priorityList.includes(priorityValue))\n\t\t\t{\n\t\t\t\tswitch (priorityValue)\n\t\t\t\t{\n\t\t\t\t\tcase LaunchPriority.CRITICAL:\n\t\t\t\t\t\tcriticalQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase LaunchPriority.HIGH:\n\t\t\t\t\t\thighQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase LaunchPriority.NORMAL:\n\t\t\t\t\t\tnormalQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase LaunchPriority.LOW:\n\t\t\t\t\t\tlowQueue.stop();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n};\n"],"names":["Queue","constructor","priority","delay","launchPerHit","Object","writable","value","babelHelpers","parseInt","add","callback","options","this","Type","isFunction","TypeError","allowLaunchAfterOthers","values","length","id","isStringFilled","Text","getRandom","AutoLauncher","register","getItems","clean","keys","forEach","remove","enough","notEnough","stop","unregister","criticalQueue","LaunchPriority","CRITICAL","highQueue","HIGH","normalQueue","NORMAL","lowQueue","LOW","BannerDispatcher","critical","toQueue","forceShowOnTop","high","normal","low","only","priorityList","priorityValue","includes"],"mappings":"iDACuC,4QAEhC,MAAMA,EAQZC,YAAYC,EAA0BC,EAAeC,GAAwB,GAC7EC,8BAAAC,YAAAC,eAAAF,8BAAAC,YAAAC,eAAAF,8BAAAC,YAAAC,MALoB,KAAEF,8BAAAC,YAAAC,OACH,IAAKF,8BAAAC,YAAAC,OACC,IAIxBC,mDAAoC,IAAtBC,SAASN,EAAO,IAC9BK,mDAAiBN,EACjBM,mDAAqBJ,EAGtBM,IAAIC,EAA8BC,EAA6B,IAE9D,2CAAIC,WAEH,OAGD,IAAKC,OAAKC,WAAWJ,GAEpB,MAAM,IAAIK,UAAU,oEAErB,MAAMC,IAA2BT,oDAAsBH,OAAOa,+CAAOL,YAAgBM,OAAS,GAExFC,EAAKN,OAAKO,eAAeT,EAAQQ,IAAMR,EAAQQ,GAAKE,OAAKC,YAC/Df,mDAAeY,GAAMT,EAErBa,eAAaC,SAASd,EAAU,IAC5BC,EACHT,8CAAOU,WACPX,iDAAUW,WACVI,uBAAAA,EACAG,GAAAA,IAIFM,WAEC,+CAAOb,WAGRc,QAECtB,OAAOuB,6CAAKf,YAAgBgB,QAAST,IACpCP,KAAKiB,OAAOV,KAIdW,SAECvB,oDAAe,EAGhBwB,YAECxB,oDAAe,EAGhByB,OAECpB,KAAKc,QACLd,KAAKkB,SAGND,OAAOV,GAENI,eAAaU,WAAWd,ICtE1B,MAAMe,EAAgB,IAAInC,EAAMoC,iBAAeC,SAAU,GACnDC,EAAY,IAAItC,EAAMoC,iBAAeG,KAAM,GAC3CC,EAAc,IAAIxC,EAAMoC,iBAAeK,OAAQ,GAAG,GAClDC,EAAW,IAAI1C,EAAMoC,iBAAeO,IAAK,GAAG,GAErCC,EAAmB,CAC/BC,SAAU,CACTC,QAAS,CAACnC,EAA8BC,EAA6B,MACpEuB,EAAczB,IAAIC,EAAU,CAC3BM,wBAAwB,EACxB8B,gBAAgB,KACbnC,MAINoC,KAAM,CACLF,QAAS,CAACnC,EAA8BC,EAA6B,MACpE0B,EAAU5B,IAAIC,EAAU,CACvBM,wBAAwB,KACrBL,MAINqC,OAAQ,CACPH,QAAS,CAACnC,EAA8BC,EAA6B,MACpE4B,EAAY9B,IAAIC,EAAUC,KAG5BsC,IAAK,CACJJ,QAAS,CAACnC,EAA8BC,EAA6B,MACpE8B,EAAShC,IAAIC,EAAUC,KAIzBkC,QAAS,CAACnC,EAA8BC,EAA6B,MACpE4B,EAAY9B,IAAIC,EAAUC,IAG3BuC,KAAKC,GAEmB/C,OAAOa,OAAOkB,kBACtBP,QAASwB,IACvB,IAAKD,EAAaE,SAASD,GAE1B,OAAQA,GAEP,KAAKjB,iBAAeC,SACnBF,EAAcF,OACd,MACD,KAAKG,iBAAeG,KACnBD,EAAUL,OACV,MACD,KAAKG,iBAAeK,OACnBD,EAAYP,OACZ,MACD,KAAKG,iBAAeO,IACnBD,EAAST"}