{"version":3,"file":"video-service.bundle.js","sources":["../src/services/base-service.js","../src/services/youtube.js","../src/services/facebook.js","../src/services/vimeo.js","../src/services/instagram.js","../src/services/vk.js","../src/services/rutube.js","../src/video-service.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport interface ServiceStaticMembers {\n\tmatchByUrl(url: string): boolean;\n\tgetDomains(): string[];\n}\n\nexport interface ServiceInterface {}\nexport type ServiceClassConstructor = () => ServiceInterface;\nexport type ServiceConstructor = ServiceClassConstructor & ServiceStaticMembers;\n\nexport class BaseService implements ServiceStaticMembers\n{\n\t#url: string = null;\n\n\tconstructor(url: string)\n\t{\n\t\tthis.#url = url;\n\t}\n\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [];\n\t}\n\n\tgetId(): string | null\n\t{\n\t\treturn null;\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn /^$/;\n\t}\n\n\tgetMatcherReplacement(): string | Function | null\n\t{\n\t\treturn null;\n\t}\n\n\tgetEmbeddedUrl(): string\n\t{\n\t\tconst replacement = this.getMatcherReplacement();\n\t\tif (Type.isStringFilled(replacement) || Type.isFunction(replacement))\n\t\t{\n\t\t\treturn this.getUrl().replace(this.getMatcher(), replacement);\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetUrl(): string\n\t{\n\t\treturn this.#url;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst YOUTUBE_MATCHER = /^((?:https?:)?\\/\\/)?((?:www|m)\\.)?(youtube(-nocookie)?\\.com|youtu\\.be)(\\/(?:[\\w-]+\\?v=|embed\\/|shorts\\/|live\\/|v\\/)?)(?<id>[\\w-]+)(\\S+)?$/;\nconst YOUTUBE_EMBEDDED = 'https://www.youtube-nocookie.com/embed/$<id>';\n\nexport class Youtube extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn YOUTUBE_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'youtube.com',\n\t\t\t'youtu.be',\n\t\t\t'youtube-nocookie.com',\n\t\t\t'www.youtube-nocookie.com',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'youtube';\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn YOUTUBE_MATCHER;\n\t}\n\n\tgetMatcherReplacement(): string | null\n\t{\n\t\treturn YOUTUBE_EMBEDDED;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst FACEBOOK_MATCHER = /^(?:(?:https?:)?\\/\\/)?(?:www.)?facebook\\.com.*\\/(videos?|watch)(\\.php|\\/|\\?).+$/;\n\nexport class Facebook extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn FACEBOOK_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'facebook.com',\n\t\t\t'www.facebook.com',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'facebook';\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn FACEBOOK_MATCHER;\n\t}\n\n\tgetEmbeddedUrl(): string\n\t{\n\t\tconst encodedUrl = encodeURIComponent(this.getUrl().replace(/\\/$/, ''));\n\n\t\treturn `https://www.facebook.com/plugins/video.php?href=${encodedUrl}`;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst VIMEO_MATCHER = /^(?:(?:https?:)?\\/\\/)?(?:www.)?vimeo.com\\/(.*\\/)?(?<id>\\d+)(.*)?/;\nconst VIMEO_EMBEDDED = 'https://player.vimeo.com/video/$<id>';\n\nexport class Vimeo extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn VIMEO_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'vimeo.com',\n\t\t\t'player.vimeo.com',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'vimeo';\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn VIMEO_MATCHER;\n\t}\n\n\tgetMatcherReplacement(): string | null\n\t{\n\t\treturn VIMEO_EMBEDDED;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst INSTAGRAM_MATCHER = /(?:(?:https?:)?\\/\\/)?(?:www.)?(instagr\\.am|instagram\\.com)\\/p\\/(?<id>[\\w-]+)\\/?/;\nconst INSTAGRAM_EMBEDDED = 'https://instagram.com/p/$<id>/embed/captioned';\n\nexport class Instagram extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn INSTAGRAM_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'www.instagram.com',\n\t\t\t'instagram.com',\n\t\t\t'instagr.am',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'instagram';\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn INSTAGRAM_MATCHER;\n\t}\n\n\tgetMatcherReplacement(): string | null\n\t{\n\t\treturn INSTAGRAM_EMBEDDED;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst VK_MATCHER = /(?:(?:https?:)?\\/\\/)?(?:www.)?vk\\.(com|ru)\\/.*(video|clip)((?<oid>-?\\d+)_(?<id>\\d+))\\/?/;\nconst VK_EMBEDDED = 'https://vk.com/video_ext.php?oid=$<oid>&id=$<id>&hd=2';\n\nexport class VK extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn VK_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'vk.com',\n\t\t\t'vk.ru',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'vk';\n\t}\n\n\tgetDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'vk.com',\n\t\t];\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn VK_MATCHER;\n\t}\n\n\tgetMatcherReplacement(): string | null\n\t{\n\t\treturn VK_EMBEDDED;\n\t}\n}\n","import { BaseService } from './base-service';\n\nconst RUTUBE_MATCHER = /(?:(?:https?:)?\\/\\/)?(?:www.)?rutube\\.ru\\/video\\/(private\\/)?(?<id>[\\dA-Za-z]+)\\/?/;\nconst RUTUBE_EMBEDDED = 'https://rutube.ru/play/embed/$<id>';\n\nexport class Rutube extends BaseService\n{\n\tstatic matchByUrl(url: string): boolean\n\t{\n\t\treturn RUTUBE_MATCHER.test(url);\n\t}\n\n\tstatic getDomains(): string[]\n\t{\n\t\treturn [\n\t\t\t'rutube.ru',\n\t\t\t'www.rutube.ru',\n\t\t];\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'rutube';\n\t}\n\n\tgetMatcher(): RegExp\n\t{\n\t\treturn RUTUBE_MATCHER;\n\t}\n\n\tgetMatcherReplacement(): string | null\n\t{\n\t\treturn RUTUBE_EMBEDDED;\n\t}\n}\n","import { ServiceConstructor } from './services/base-service';\nimport { type BaseService } from './services/base-service';\n\nimport { Youtube } from './services/youtube';\nimport { Facebook } from './services/facebook';\nimport { Vimeo } from './services/vimeo';\nimport { Instagram } from './services/instagram';\nimport { VK } from './services/vk';\nimport { Rutube } from './services/rutube';\n\nexport class VideoService\n{\n\tstatic #services: ServiceConstructor[] = [\n\t\tYoutube,\n\t\tFacebook,\n\t\tVimeo,\n\t\tInstagram,\n\t\tVK,\n\t\tRutube,\n\t];\n\n\tstatic createByUrl(url: string): BaseService\n\t{\n\t\tfor (const ServiceClass of this.#services)\n\t\t{\n\t\t\tif (ServiceClass.matchByUrl(url))\n\t\t\t{\n\t\t\t\treturn new ServiceClass(url);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic createByHost(host: string): BaseService\n\t{\n\t\tfor (const ServiceClass of this.#services)\n\t\t{\n\t\t\tif (ServiceClass.getDomains().includes(host))\n\t\t\t{\n\t\t\t\treturn new ServiceClass(host);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic getEmbeddedUrl(url: string): string | null\n\t{\n\t\tconst videoService = this.createByUrl(url);\n\t\tif (videoService)\n\t\t{\n\t\t\treturn videoService.getEmbeddedUrl();\n\t\t}\n\n\t\treturn null;\n\t}\n}\n"],"names":["BaseService","constructor","url","matchByUrl","getDomains","getId","getMatcher","getMatcherReplacement","getEmbeddedUrl","replacement","Type","isStringFilled","isFunction","getUrl","replace","YOUTUBE_MATCHER","YOUTUBE_EMBEDDED","Youtube","test","FACEBOOK_MATCHER","Facebook","encodedUrl","encodeURIComponent","VIMEO_MATCHER","VIMEO_EMBEDDED","Vimeo","INSTAGRAM_MATCHER","INSTAGRAM_EMBEDDED","Instagram","VK_MATCHER","VK_EMBEDDED","VK","RUTUBE_MATCHER","RUTUBE_EMBEDDED","Rutube","VideoService","createByUrl","ServiceClass","createByHost","host","includes","videoService"],"mappings":";;;;;;CAAiC;AAWjC,CAAO,MAAMA,WAAW,CACxB;GAGCC,WAAW,CAACC,GAAW,EACvB;KAAA;OAAA;OAAA,OAHe;;KAId,4CAAI,gBAAQA,GAAG;;GAGhB,OAAOC,UAAU,CAACD,GAAW,EAC7B;KACC,OAAO,KAAK;;GAGb,OAAOE,UAAU,GACjB;KACC,OAAO,EAAE;;GAGVC,KAAK,GACL;KACC,OAAO,IAAI;;GAGZC,UAAU,GACV;KACC,OAAO,IAAI;;GAGZC,qBAAqB,GACrB;KACC,OAAO,IAAI;;GAGZC,cAAc,GACd;KACC,MAAMC,WAAW,GAAG,IAAI,CAACF,qBAAqB,EAAE;KAChD,IAAIG,cAAI,CAACC,cAAc,CAACF,WAAW,CAAC,IAAIC,cAAI,CAACE,UAAU,CAACH,WAAW,CAAC,EACpE;OACC,OAAO,IAAI,CAACI,MAAM,EAAE,CAACC,OAAO,CAAC,IAAI,CAACR,UAAU,EAAE,EAAEG,WAAW,CAAC;;KAG7D,OAAO,EAAE;;GAGVI,MAAM,GACN;KACC,+CAAO,IAAI;;CAEb;;CC1DA,MAAME,eAAe,GAAG,2IAA2I;CACnK,MAAMC,gBAAgB,GAAG,8CAA8C;AAEvE,CAAO,MAAMC,OAAO,SAASjB,WAAW,CACxC;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAOa,eAAe,CAACG,IAAI,CAAChB,GAAG,CAAC;;GAGjC,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,aAAa,EACb,UAAU,EACV,sBAAsB,EACtB,0BAA0B,CAC1B;;GAGFC,KAAK,GACL;KACC,OAAO,SAAS;;GAGjBC,UAAU,GACV;KACC,OAAOS,eAAe;;GAGvBR,qBAAqB,GACrB;KACC,OAAOS,gBAAgB;;CAEzB;;CClCA,MAAMG,gBAAgB,GAAG,iFAAiF;AAE1G,CAAO,MAAMC,QAAQ,SAASpB,WAAW,CACzC;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAOiB,gBAAgB,CAACD,IAAI,CAAChB,GAAG,CAAC;;GAGlC,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,cAAc,EACd,kBAAkB,CAClB;;GAGFC,KAAK,GACL;KACC,OAAO,UAAU;;GAGlBC,UAAU,GACV;KACC,OAAOa,gBAAgB;;GAGxBX,cAAc,GACd;KACC,MAAMa,UAAU,GAAGC,kBAAkB,CAAC,IAAI,CAACT,MAAM,EAAE,CAACC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;KAEvE,OAAQ,mDAAkDO,UAAW,EAAC;;CAExE;;CCjCA,MAAME,aAAa,GAAG,kEAAkE;CACxF,MAAMC,cAAc,GAAG,sCAAsC;AAE7D,CAAO,MAAMC,KAAK,SAASzB,WAAW,CACtC;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAOqB,aAAa,CAACL,IAAI,CAAChB,GAAG,CAAC;;GAG/B,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,WAAW,EACX,kBAAkB,CAClB;;GAGFC,KAAK,GACL;KACC,OAAO,OAAO;;GAGfC,UAAU,GACV;KACC,OAAOiB,aAAa;;GAGrBhB,qBAAqB,GACrB;KACC,OAAOiB,cAAc;;CAEvB;;CChCA,MAAME,iBAAiB,GAAG,iFAAiF;CAC3G,MAAMC,kBAAkB,GAAG,+CAA+C;AAE1E,CAAO,MAAMC,SAAS,SAAS5B,WAAW,CAC1C;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAOwB,iBAAiB,CAACR,IAAI,CAAChB,GAAG,CAAC;;GAGnC,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,mBAAmB,EACnB,eAAe,EACf,YAAY,CACZ;;GAGFC,KAAK,GACL;KACC,OAAO,WAAW;;GAGnBC,UAAU,GACV;KACC,OAAOoB,iBAAiB;;GAGzBnB,qBAAqB,GACrB;KACC,OAAOoB,kBAAkB;;CAE3B;;CCjCA,MAAME,UAAU,GAAG,yFAAyF;CAC5G,MAAMC,WAAW,GAAG,uDAAuD;AAE3E,CAAO,MAAMC,EAAE,SAAS/B,WAAW,CACnC;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAO2B,UAAU,CAACX,IAAI,CAAChB,GAAG,CAAC;;GAG5B,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,QAAQ,EACR,OAAO,CACP;;GAGFC,KAAK,GACL;KACC,OAAO,IAAI;;GAGZD,UAAU,GACV;KACC,OAAO,CACN,QAAQ,CACR;;GAGFE,UAAU,GACV;KACC,OAAOuB,UAAU;;GAGlBtB,qBAAqB,GACrB;KACC,OAAOuB,WAAW;;CAEpB;;CCvCA,MAAME,cAAc,GAAG,oFAAoF;CAC3G,MAAMC,eAAe,GAAG,oCAAoC;AAE5D,CAAO,MAAMC,MAAM,SAASlC,WAAW,CACvC;GACC,OAAOG,UAAU,CAACD,GAAW,EAC7B;KACC,OAAO8B,cAAc,CAACd,IAAI,CAAChB,GAAG,CAAC;;GAGhC,OAAOE,UAAU,GACjB;KACC,OAAO,CACN,WAAW,EACX,eAAe,CACf;;GAGFC,KAAK,GACL;KACC,OAAO,QAAQ;;GAGhBC,UAAU,GACV;KACC,OAAO0B,cAAc;;GAGtBzB,qBAAqB,GACrB;KACC,OAAO0B,eAAe;;CAExB;;CC1B2C;AAE3C,CAAO,MAAME,YAAY,CACzB;GAUC,OAAOC,WAAW,CAAClC,GAAW,EAC9B;KACC,KAAK,MAAMmC,YAAY,4CAAI,IAAI,yBAC/B;OACC,IAAIA,YAAY,CAAClC,UAAU,CAACD,GAAG,CAAC,EAChC;SACC,OAAO,IAAImC,YAAY,CAACnC,GAAG,CAAC;;;KAI9B,OAAO,IAAI;;GAGZ,OAAOoC,YAAY,CAACC,IAAY,EAChC;KACC,KAAK,MAAMF,YAAY,4CAAI,IAAI,yBAC/B;OACC,IAAIA,YAAY,CAACjC,UAAU,EAAE,CAACoC,QAAQ,CAACD,IAAI,CAAC,EAC5C;SACC,OAAO,IAAIF,YAAY,CAACE,IAAI,CAAC;;;KAI/B,OAAO,IAAI;;GAGZ,OAAO/B,cAAc,CAACN,GAAW,EACjC;KACC,MAAMuC,YAAY,GAAG,IAAI,CAACL,WAAW,CAAClC,GAAG,CAAC;KAC1C,IAAIuC,YAAY,EAChB;OACC,OAAOA,YAAY,CAACjC,cAAc,EAAE;;KAGrC,OAAO,IAAI;;CAEb;CAAC,sBA/CY2B,YAAY;GAAA;GAAA,OAEiB,CACxClB,OAAO,EACPG,QAAQ,EACRK,KAAK,EACLG,SAAS,EACTG,EAAE,EACFG,MAAM;CACN;;;;;;;;;;;;;;;"}