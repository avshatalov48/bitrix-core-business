{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nconst namespace = Reflection.namespace('BX.Mail.AddressBook');\nconst gridId = 'MAIL_ADDRESSBOOK_LIST';\n\nimport { Avatar } from 'mail.avatar';\n\nBX.ready(function()\n{\n\tconst addContactButton = document.getElementById('mail-address-book-add-button');\n\n\taddContactButton.onclick = () => {\n\t\ttop.BX.Runtime.loadExtension('mail.dialogeditcontact').then(\n\t\t\t() => top.BX.Mail.AddressBook.DialogEditContact.openCreateDialog(),\n\t\t);\n\t};\n\n\tnamespace.openEditDialog = function(attributes) {\n\t\ttop.BX.Runtime.loadExtension('mail.dialogeditcontact').then(\n\t\t\t() => top.BX.Mail.AddressBook.DialogEditContact.openEditDialog(attributes),\n\t\t);\n\t};\n\n\tnamespace.openRemoveDialog = function(configContact) {\n\t\ttop.BX.Runtime.loadExtension('mail.dialogeditcontact').then(\n\t\t\t() => {\n\t\t\t\ttop.BX.Mail.AddressBook.DialogEditContact.openRemoveDialog(configContact).then(\n\t\t\t\t\t() => reloadGrid(gridId),\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\t};\n\n\tfunction reloadGrid(gridID)\n\t{\n\t\tconst gridObject = BX.Main.gridManager.getById(gridID);\n\n\t\tif (gridObject.hasOwnProperty('instance'))\n\t\t{\n\t\t\tgridObject.instance.reloadTable('POST');\n\t\t}\n\t}\n\n\tAvatar.replaceTagsWithAvatars({\n\t\tclassName: 'mail-ui-avatar',\n\t});\n\n\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\tconst [messageEvent] = event.getCompatData();\n\n\t\tif(messageEvent.getEventId() === 'dialogEditContact::reloadList')\n\t\t{\n\t\t\treloadGrid(gridId);\n\t\t}\n\t});\n\n\tEventEmitter.subscribe('Grid::updated', (event) => {\n\t\tconst [messageEvent] = event.getCompatData();\n\n\t\tif (messageEvent.containerId === 'MAIL_ADDRESSBOOK_LIST')\n\t\t{\n\t\t\tAvatar.replaceTagsWithAvatars({\n\t\t\t\tclassName: 'mail-ui-avatar',\n\t\t\t});\n\t\t}\n\t});\n});"],"names":["namespace","Reflection","gridId","BX","ready","addContactButton","document","getElementById","onclick","top","Runtime","loadExtension","then","Mail","AddressBook","DialogEditContact","openCreateDialog","openEditDialog","attributes","openRemoveDialog","configContact","reloadGrid","gridID","gridObject","Main","gridManager","getById","hasOwnProperty","instance","reloadTable","Avatar","replaceTagsWithAvatars","className","EventEmitter","subscribe","event","getCompatData","messageEvent","getEventId","containerId"],"mappings":";;;CAGA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAX,CAAqB,qBAArB,CAAlB;CACA,IAAME,MAAM,GAAG,uBAAf;AAEA,CAEAC,EAAE,CAACC,KAAH,CAAS,YACT;CACC,MAAMC,gBAAgB,GAAGC,QAAQ,CAACC,cAAT,CAAwB,8BAAxB,CAAzB;;CAEAF,EAAAA,gBAAgB,CAACG,OAAjB,GAA2B,YAAM;CAChCC,IAAAA,GAAG,CAACN,EAAJ,CAAOO,OAAP,CAAeC,aAAf,CAA6B,wBAA7B,EAAuDC,IAAvD,CACC;CAAA,aAAMH,GAAG,CAACN,EAAJ,CAAOU,IAAP,CAAYC,WAAZ,CAAwBC,iBAAxB,CAA0CC,gBAA1C,EAAN;CAAA,KADD;CAGA,GAJD;;CAMAhB,EAAAA,SAAS,CAACiB,cAAV,GAA2B,UAASC,UAAT,EAAqB;CAC/CT,IAAAA,GAAG,CAACN,EAAJ,CAAOO,OAAP,CAAeC,aAAf,CAA6B,wBAA7B,EAAuDC,IAAvD,CACC;CAAA,aAAMH,GAAG,CAACN,EAAJ,CAAOU,IAAP,CAAYC,WAAZ,CAAwBC,iBAAxB,CAA0CE,cAA1C,CAAyDC,UAAzD,CAAN;CAAA,KADD;CAGA,GAJD;;CAMAlB,EAAAA,SAAS,CAACmB,gBAAV,GAA6B,UAASC,aAAT,EAAwB;CACpDX,IAAAA,GAAG,CAACN,EAAJ,CAAOO,OAAP,CAAeC,aAAf,CAA6B,wBAA7B,EAAuDC,IAAvD,CACC,YAAM;CACLH,MAAAA,GAAG,CAACN,EAAJ,CAAOU,IAAP,CAAYC,WAAZ,CAAwBC,iBAAxB,CAA0CI,gBAA1C,CAA2DC,aAA3D,EAA0ER,IAA1E,CACC;CAAA,eAAMS,UAAU,CAACnB,MAAD,CAAhB;CAAA,OADD;CAGA,KALF;CAOA,GARD;;CAUA,WAASmB,UAAT,CAAoBC,MAApB,EACA;CACC,QAAMC,UAAU,GAAGpB,EAAE,CAACqB,IAAH,CAAQC,WAAR,CAAoBC,OAApB,CAA4BJ,MAA5B,CAAnB;;CAEA,QAAIC,UAAU,CAACI,cAAX,CAA0B,UAA1B,CAAJ,EACA;CACCJ,MAAAA,UAAU,CAACK,QAAX,CAAoBC,WAApB,CAAgC,MAAhC;CACA;CACD;;CAEDC,EAAAA,kBAAM,CAACC,sBAAP,CAA8B;CAC7BC,IAAAA,SAAS,EAAE;CADkB,GAA9B;CAIAC,EAAAA,6BAAY,CAACC,SAAb,CAAuB,4BAAvB,EAAqD,UAACC,KAAD,EAAW;CAAA,+BACxCA,KAAK,CAACC,aAAN,EADwC;CAAA;CAAA,QACxDC,YADwD;;CAG/D,QAAGA,YAAY,CAACC,UAAb,OAA8B,+BAAjC,EACA;CACCjB,MAAAA,UAAU,CAACnB,MAAD,CAAV;CACA;CACD,GAPD;CASA+B,EAAAA,6BAAY,CAACC,SAAb,CAAuB,eAAvB,EAAwC,UAACC,KAAD,EAAW;CAAA,gCAC3BA,KAAK,CAACC,aAAN,EAD2B;CAAA;CAAA,QAC3CC,YAD2C;;CAGlD,QAAIA,YAAY,CAACE,WAAb,KAA6B,uBAAjC,EACA;CACCT,MAAAA,kBAAM,CAACC,sBAAP,CAA8B;CAC7BC,QAAAA,SAAS,EAAE;CADkB,OAA9B;CAGA;CACD,GATD;CAUA,CA3DD;;;;"}