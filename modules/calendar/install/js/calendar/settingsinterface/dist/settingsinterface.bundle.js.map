{"version":3,"file":"settingsinterface.bundle.js","sources":["../src/settingsinterface.js"],"sourcesContent":["import { Util } from 'calendar.util';\nimport { EmailSelectorControl } from 'calendar.controls';\nimport { Type, Event, Loc, Tag, Dom, Text, Runtime } from 'main.core';\nimport { Dialog as EntitySelectorDialog } from 'ui.entity-selector';\nimport { EventEmitter } from 'main.core.events';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { MessageCard } from 'ui.messagecard';\n\ntype SettingsInterfaceOptions = {\n\tname: string;\n\tcalendarContext: any,\n\tshowPersonalSettings: boolean,\n\tshowGeneralSettings: boolean,\n\tshowAccessControl: boolean,\n\tsettings: any,\n\tisExtranet: boolean,\n};\n\nexport class SettingsInterface\n{\n\tsliderId: string = 'calendar:settings-slider';\n\tname: string = 'SettingsInterface';\n\tSLIDER_WIDTH: number = 500;\n\tSLIDER_DURATION: number = 80;\n\tDOM: any = {};\n\tHELP_DESK_CODE = 7_218_351;\n\tHELP_DESK_CODE_LOCATION = 14_326_208;\n\n\tconstructor(options: SettingsInterfaceOptions)\n\t{\n\t\tthis.calendarContext = options.calendarContext;\n\t\tthis.showPersonalSettings = options.showPersonalSettings;\n\t\tthis.showGeneralSettings = options.showGeneralSettings;\n\t\tthis.showAccessControl = options.showAccessControl !== false\n\t\t\t&& Type.isObjectLike(this.calendarContext.util.config.TYPE_ACCESS)\n\t\t;\n\t\tthis.isExtranet = options.isExtranet;\n\n\t\tthis.settings = options.settings;\n\t\tthis.BX = Util.getBX();\n\t\tthis.hideMessageBinded = this.hideMessage.bind(this);\n\t}\n\n\tshow()\n\t{\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION,\n\t\t\tevents: {\n\t\t\t\tonCloseByEsc: this.escHide.bind(this),\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this),\n\t\t\t},\n\t\t});\n\t}\n\n\tescHide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId && this.denyClose)\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tBX.removeCustomEvent('SidePanel.Slider:onClose', BX.proxy(this.hide, this));\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\t// this.destroyEventEmitterSubscriptions();\n\n\t\t\t// Util.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:delete', this.deleteSectionHandlerBinded);\n\t\t\t// Util.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:pull-delete', this.deleteSectionHandlerBinded);\n\n\t\t\t// BX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.sectionListWrap;\n\t\t}\n\t}\n\n\tcreateContent(slider: BX.Intranet.Bitrix24.Slider)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\ttop.BX.ajax.runAction('calendar.api.calendarajax.getSettingsSlider', {\n\t\t\t\tdata: {\n\t\t\t\t\tshowPersonalSettings: this.showPersonalSettings ? 'Y' : 'N',\n\t\t\t\t\tshowGeneralSettings: this.showGeneralSettings ? 'Y' : 'N',\n\t\t\t\t\tshowAccessControl: this.showAccessControl ? 'Y' : 'N',\n\t\t\t\t\tuid: this.uid,\n\t\t\t\t},\n\t\t\t}).then(\n\t\t\t\t(response: any) => {\n\t\t\t\t\tslider.getData().set('sliderContent', response.data.html);\n\t\t\t\t\tconst params = response.data.additionalParams;\n\n\t\t\t\t\tthis.mailboxList = params.mailboxList;\n\t\t\t\t\tthis.uid = params.uid;\n\n\t\t\t\t\tresolve(response.data.html);\n\t\t\t\t},\n\t\t\t);\n\t\t});\n\t}\n\n\tonLoadSlider(event: BX.SidePanel.Event)\n\t{\n\t\tconst slider = event.getSlider();\n\t\tthis.DOM.content = slider.layout.content;\n\t\tthis.sliderId = slider.getUrl();\n\n\t\t// Used to execute javasctipt and attach CSS from ajax responce\n\t\tBX.html(slider.layout.content, slider.getData().get('sliderContent'));\n\t\tthis.initControls();\n\t\tthis.setControlsValue();\n\t}\n\n\tinitControls()\n\t{\n\t\tthis.DOM.buttonsWrap = this.DOM.content.querySelector('.calendar-form-buttons-fixed');\n\t\tBX.ZIndexManager.register(this.DOM.buttonsWrap);\n\n\t\tthis.DOM.saveBtn = this.DOM.buttonsWrap.querySelector('[data-role=\"save_btn\"]');\n\t\tthis.DOM.closeBtn = this.DOM.buttonsWrap.querySelector('[data-role=\"close_btn\"]');\n\n\t\tBX.Event.bind(this.DOM.saveBtn, 'click', this.save.bind(this));\n\t\tBX.Event.bind(this.DOM.closeBtn, 'click', this.close.bind(this));\n\n\t\tif (this.showPersonalSettings)\n\t\t{\n\t\t\tthis.DOM.denyBusyInvitation = this.DOM.content.querySelector('[data-role=\"deny_busy_invitation\"]');\n\t\t\tthis.DOM.showWeekNumbers = this.DOM.content.querySelector('[data-role=\"show_week_numbers\"]');\n\n\t\t\tthis.DOM.showDeclined = this.DOM.content.querySelector('[data-role=\"show_declined\"]');\n\t\t\tthis.DOM.showTasks = this.DOM.content.querySelector('[data-role=\"show_tasks\"]');\n\t\t\tthis.DOM.showCompletedTasks = this.DOM.content.querySelector('[data-role=\"show_completed_tasks\"]');\n\t\t\tthis.DOM.timezoneSelect = this.DOM.content.querySelector('[data-role=\"set_tz_sel\"]');\n\n\t\t\tif (!this.isExtranet)\n\t\t\t{\n\t\t\t\tthis.DOM.meetSectionSelect = this.DOM.content.querySelector('[data-role=\"meet_section\"]');\n\t\t\t\tthis.DOM.crmSelect = this.DOM.content.querySelector('[data-role=\"crm_section\"]');\n\t\t\t\tthis.DOM.syncTasks = this.DOM.content.querySelector('[data-role=\"sync_tasks\"]');\n\t\t\t\tthis.DOM.sendFromEmailSelect = this.DOM.content.querySelector('[data-role=\"send_from_email\"]');\n\t\t\t}\n\n\t\t\t// this.DOM.enableLunchTime = this.DOM.content.querySelector('[data-role=\"enable_lunch_time\"]');\n\t\t\t// this.DOM.lunchTimeSettingContainer = this.DOM.content.querySelector('#ec_lunch_time');\n\t\t\t// this.lunchTimeControl = this.initLunchTimeControl(this.DOM.lunchTimeSettingContainer);\n\t\t}\n\n\t\t// General settings\n\t\tif (this.showGeneralSettings)\n\t\t{\n\t\t\tthis.DOM.workTimeStart = this.DOM.content.querySelector('[data-role=\"work_time_start\"]');\n\t\t\tthis.DOM.workTimeEnd = this.DOM.content.querySelector('[data-role=\"work_time_end\"]');\n\t\t\tthis.DOM.weekHolidays = this.DOM.content.querySelector('[data-role=\"week_holidays\"]');\n\t\t\tthis.DOM.yearHolidays = this.DOM.content.querySelector('[data-role=\"year_holidays\"]');\n\t\t\tthis.DOM.yearWorkdays = this.DOM.content.querySelector('[data-role=\"year_workdays\"]');\n\t\t}\n\n\t\tif (this.showAccessControl)\n\t\t{\n\t\t\tthis.DOM.accessMessageWrap = this.DOM.content.querySelector('[data-role=\"type-access-message-card\"]');\n\t\t\tthis.DOM.accessOuterWrap = this.DOM.content.querySelector('[data-role=\"type-access-values-cont\"]');\n\t\t\tthis.DOM.accessHelpIcon = this.DOM.content.querySelector('.calendar-settings-access-hint');\n\t\t\tif(Type.isElementNode(this.DOM.accessHelpIcon) && this.calendarContext.util.type === 'location')\n\t\t\t{\n\t\t\t\tthis.initMessageControl();\n\t\t\t}\n\t\t\telse if(Type.isElementNode(this.DOM.accessHelpIcon))\n\t\t\t{\n\t\t\t\tthis.DOM.accessHelpIcon.remove();\n\t\t\t\tDom.replace(this.DOM.accessMessageWrap, Tag.render`\n\t\t\t\t\t<span onclick=\"${() => this.openHelpDesk(this.HELP_DESK_CODE)}\" class=\"ui-hint\" title=\"${Loc.getMessage('EC_CALENDAR_HOW_DOES_IT_WORK')}\">\n\t\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t\t</span>\n\t\t\t\t`);\n\t\t\t}\n\t\t\tif (Type.isElementNode(this.DOM.accessOuterWrap))\n\t\t\t{\n\t\t\t\tthis.initAccessController();\n\t\t\t}\n\t\t}\n\n\t\tthis.handleRestrictions();\n\t}\n\n\thandleRestrictions()\n\t{\n\t\tif (this.BX.Type.isElementNode(this.DOM.syncTasks) && this.isSettingLocked(this.DOM.syncTasks))\n\t\t{\n\t\t\tthis.DOM.syncTasks.disabled = true;\n\n\t\t\tthis.lockSetting(this.DOM.syncTasks);\n\t\t}\n\n\t\tif (this.BX.Type.isElementNode(this.DOM.sendFromEmailSelect))\n\t\t{\n\t\t\tthis.emailSelectorControl = new EmailSelectorControl({\n\t\t\t\tselectNode: this.DOM.sendFromEmailSelect,\n\t\t\t\tallowAddNewEmail: true,\n\t\t\t\tmailboxList: this.mailboxList,\n\t\t\t});\n\n\t\t\tthis.DOM.emailHelpIcon = this.DOM.content.querySelector('.calendar-settings-question');\n\n\t\t\tif (this.DOM.emailHelpIcon && BX.Helper)\n\t\t\t{\n\t\t\t\tBX.Event.bind(\n\t\t\t\t\tthis.DOM.emailHelpIcon,\n\t\t\t\t\t'click',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tBX.Helper.show('redirect=detail&code=12070142');\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tUtil.initHintNode(this.DOM.emailHelpIcon);\n\t\t\t}\n\n\t\t\tthis.emailSelectorControl.setValue(this.calendarContext.util.getUserOption('sendFromEmail'));\n\n\t\t\tthis.DOM.emailWrap = this.DOM.content.querySelector('.calendar-settings-email-wrap');\n\t\t\tif (BX.Calendar.Util.isEventWithEmailGuestAllowed())\n\t\t\t{\n\t\t\t\tBX.Dom.removeClass(this.DOM.emailWrap, 'lock');\n\t\t\t\tthis.DOM.sendFromEmailSelect.disabled = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Dom.addClass(this.DOM.emailWrap, 'lock');\n\t\t\t\tthis.DOM.sendFromEmailSelect.disabled = true;\n\t\t\t\tBX.Event.bind(\n\t\t\t\t\tthis.DOM.sendFromEmailSelect.parentNode,\n\t\t\t\t\t'click',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'calendar_events_with_email_guests' }).show();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisSettingLocked(node: HTMLElement): boolean\n\t{\n\t\treturn this.BX.Type.isElementNode(node.closest('.calendar-field-block.--locked'));\n\t}\n\n\tgetSettingLockCode(node: HTMLElement): string\n\t{\n\t\treturn ('lockCode' in node.dataset) ? node.dataset.lockCode : '';\n\t}\n\n\tlockSetting(node: HTMLElement): void\n\t{\n\t\tconst lockBindElement = node.closest('.calendar-field-block.--locked');\n\n\t\tthis.getSettingLockCode(node);\n\n\t\tBX.Event.bind(\n\t\t\tlockBindElement,\n\t\t\t'click',\n\t\t\t() => this.showLock(this.getSettingLockCode(node)),\n\t\t);\n\t}\n\n\tshowLock(featureId: string, bindElement: ?HTMLElement = null): void\n\t{\n\t\tFeaturePromotersRegistry.getPromoter({ featureId, bindElement }).show();\n\t}\n\n\tinitMessageControl()\n\t{\n\t\tconst moreMessageButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-primary\">${Loc.getMessage('EC_LOCATION_SETTINGS_MORE_INFO')}</a>\n\t\t`;\n\t\tEvent.bind(moreMessageButton, 'click', () => this.openHelpDesk(this.HELP_DESK_CODE_LOCATION));\n\t\tconst header = '';\n\t\tconst description = Loc.getMessage('EC_LOCATION_SETTINGS_MESSAGE_DESCRIPTION');\n\n\t\tthis.message = new MessageCard({\n\t\t\tid: 'locationSettingsInfo',\n\t\t\theader,\n\t\t\tdescription,\n\t\t\tangle: false,\n\t\t\thidden: true,\n\t\t\tactionElements: [moreMessageButton],\n\t\t});\n\t\tEventEmitter.subscribe(this.message, 'onClose', this.hideMessageBinded);\n\t\tEvent.bind(this.DOM.accessHelpIcon, 'click', () => {\n\t\t\tthis.onClickHint();\n\t\t});\n\n\t\tif (this.DOM.accessMessageWrap)\n\t\t{\n\t\t\tthis.DOM.accessMessageWrap.appendChild(this.message.getLayout());\n\t\t\tif (!this.calendarContext.util.config.hideSettingsHintLocation)\n\t\t\t{\n\t\t\t\tthis.showMessage();\n\t\t\t}\n\t\t}\n\t}\n\n\t// initLunchTimeControl(container)\n\t// {\n\t// \tEvent.bind(this.DOM.enableLunchTime, 'change', () => {\n\t// \t\tthis.updateEnabledLunchTime();\n\t// \t});\n\t//\n\t// \tconst lunchTimeContainer = Tag.render`<div class=\"calendar-field-container calendar-field-container-datetime\"></div>`;\n\t// \tcontainer.append(lunchTimeContainer);\n\t//\n\t// \tconst lunchTimeControl = new DateTimeControl(null, {\n\t// \t\tshowTimezone: false,\n\t// \t\touterWrap: lunchTimeContainer,\n\t// \t\tinlineEditMode: true\n\t// \t});\n\t// \tlunchTimeControl.DOM.fromDate.style.display = 'none';\n\t// \tlunchTimeControl.DOM.toDate.style.display = 'none';\n\t// \tlunchTimeControl.DOM.outerWrap.querySelector('.calendar-event-full-day').style.display = 'none';\n\t// \tlunchTimeControl.setValue({\n\t// \t\tfrom: new Date(),\n\t// \t\tto: new Date(),\n\t// \t\tfullDay: false,\n\t// \t\ttimezoneFrom: '',\n\t// \t\ttimezoneTo: '',\n\t// \t});\n\t// \tlunchTimeControl.setInlineEditMode('edit');\n\t// \tlunchTimeControl.setViewMode(false);\n\t//\n\t// \treturn lunchTimeControl;\n\t// }\n\t//\n\t// setLunchTimeValue()\n\t// {\n\t// \tconst settingEnableLunchTime = this.calendarContext.util.getUserOption('enableLunchTime', 'N') === 'Y';\n\t// \tconst settingLunchStart = this.calendarContext.util.getUserOption('lunchStart', '13:00');\n\t// \tconst settingLunchEnd = this.calendarContext.util.getUserOption('lunchEnd', '14:00');\n\t//\n\t// \tthis.DOM.enableLunchTime.checked = settingEnableLunchTime;\n\t// \tthis.updateEnabledLunchTime();\n\t//\n\t// \tconst date = new Date().toDateString();\n\t// \tconst lunchStart = new Date(`${date} ${settingLunchStart}`);\n\t// \tconst lunchEnd = new Date(`${date} ${settingLunchEnd}`);\n\t//\n\t// \tthis.lunchTimeControl.setValue({\n\t// \t\tfrom: lunchStart,\n\t// \t\tto: lunchEnd,\n\t// \t});\n\t// }\n\t//\n\t// updateEnabledLunchTime()\n\t// {\n\t// \tif (this.DOM.enableLunchTime.checked)\n\t// \t{\n\t// \t\tDom.removeClass(this.DOM.lunchTimeSettingContainer, '--disabled');\n\t// \t}\n\t// \telse\n\t// \t{\n\t// \t\tDom.addClass(this.DOM.lunchTimeSettingContainer, '--disabled');\n\t// \t}\n\t// }\n\n\tonClickHint()\n\t{\n\t\tif (!this.message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.message.isShown())\n\t\t{\n\t\t\tthis.hideMessage();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showMessage();\n\t\t}\n\t}\n\n\tsetControlsValue()\n\t{\n\t\t// Set personal user settings\n\t\tif (this.showPersonalSettings && !this.isExtranet)\n\t\t{\n\t\t\tthis.DOM.meetSectionSelect.options.length = 0;\n\n\t\t\tconst sections = this.calendarContext.sectionManager.getSectionListForEdit();\n\t\t\tlet crmSection = parseInt(this.calendarContext.util.getUserOption('crmSection'), 10);\n\t\t\tlet meetSection = parseInt(this.calendarContext.util.getUserOption('meetSection'), 10);\n\t\t\tlet section;\n\t\t\tlet selected;\n\n\t\t\tfor (let i = 0; i < sections.length; i++)\n\t\t\t{\n\t\t\t\tsection = sections[i];\n\t\t\t\tif (section.belongsToOwner())\n\t\t\t\t{\n\t\t\t\t\tif (!meetSection)\n\t\t\t\t\t{\n\t\t\t\t\t\tmeetSection = section.id;\n\t\t\t\t\t}\n\t\t\t\t\tselected = meetSection === parseInt(section.id, 10);\n\t\t\t\t\tthis.DOM.meetSectionSelect.options.add(new Option(section.name, section.id, selected, selected));\n\n\t\t\t\t\tif (!crmSection)\n\t\t\t\t\t{\n\t\t\t\t\t\tcrmSection = section.id;\n\t\t\t\t\t}\n\t\t\t\t\tselected = crmSection === parseInt(section.id, 10);\n\t\t\t\t\tthis.DOM.crmSelect.options.add(new Option(section.name, section.id, selected, selected));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// this.setLunchTimeValue();\n\t\t}\n\n\t\tif (this.DOM.showDeclined)\n\t\t{\n\t\t\tthis.DOM.showDeclined.checked = this.calendarContext.util.getUserOption('showDeclined');\n\t\t}\n\n\t\tconst showTasks = this.calendarContext.util.getUserOption('showTasks') === 'Y';\n\t\tif (this.DOM.showTasks)\n\t\t{\n\t\t\tthis.DOM.showTasks.checked = showTasks;\n\t\t\tBX.Event.bind(this.DOM.showTasks, 'click', () => {\n\t\t\t\tif (this.DOM.showCompletedTasks)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.showCompletedTasks.disabled = !this.DOM.showTasks.checked;\n\t\t\t\t\tthis.DOM.showCompletedTasks.checked = this.DOM.showCompletedTasks.checked && this.DOM.showTasks.checked;\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.syncTasks)\n\t\t\t\t{\n\t\t\t\t\tif (this.isSettingLocked(this.DOM.syncTasks))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.syncTasks.checked = false;\n\t\t\t\t\t\tthis.DOM.syncTasks.disabled = true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.DOM.syncTasks.disabled = !this.DOM.showTasks.checked;\n\t\t\t\t\t\tthis.DOM.syncTasks.checked = this.DOM.syncTasks.checked && this.DOM.showTasks.checked;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.DOM.showCompletedTasks)\n\t\t{\n\t\t\tthis.DOM.showCompletedTasks.checked = this.calendarContext.util.getUserOption('showCompletedTasks') === 'Y' && this.DOM.showTasks.checked;\n\t\t\tthis.DOM.showCompletedTasks.disabled = !showTasks;\n\t\t}\n\n\t\tif (this.DOM.syncTasks)\n\t\t{\n\t\t\tif (this.isSettingLocked(this.DOM.syncTasks))\n\t\t\t{\n\t\t\t\tthis.DOM.syncTasks.checked = false;\n\t\t\t\tthis.DOM.syncTasks.disabled = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.syncTasks.checked = this.calendarContext.util.getUserOption('syncTasks') === 'Y' && this.DOM.showTasks.checked;\n\t\t\t\tthis.DOM.syncTasks.disabled = !showTasks;\n\t\t\t}\n\t\t}\n\n\t\tif (this.DOM.denyBusyInvitation)\n\t\t{\n\t\t\tthis.DOM.denyBusyInvitation.checked = this.calendarContext.util.getUserOption('denyBusyInvitation');\n\t\t}\n\n\t\tif (this.DOM.showWeekNumbers)\n\t\t{\n\t\t\tthis.DOM.showWeekNumbers.checked = this.calendarContext.util.showWeekNumber();\n\t\t}\n\n\t\tif (this.DOM.timezoneSelect)\n\t\t{\n\t\t\tthis.DOM.timezoneSelect.value = this.calendarContext.util.getUserOption('timezoneName') || '';\n\t\t}\n\n\t\tif (this.showGeneralSettings)\n\t\t{\n\t\t\t// Set access for calendar type\n\t\t\tthis.DOM.workTimeStart.value = this.settings.work_time_start;\n\t\t\tthis.DOM.workTimeEnd.value = this.settings.work_time_end;\n\n\t\t\tif (this.DOM.weekHolidays)\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < this.DOM.weekHolidays.options.length; i++)\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line max-len\n\t\t\t\t\tthis.DOM.weekHolidays.options[i].selected =\tthis.settings.week_holidays.includes(this.DOM.weekHolidays.options[i].value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.DOM.yearHolidays.value = this.settings.year_holidays;\n\t\t\tthis.DOM.yearWorkdays.value = this.settings.year_workdays;\n\t\t}\n\n\t\t// Access\n\t\tif (this.showAccessControl\n\t\t\t&& Type.isElementNode(this.DOM.accessOuterWrap))\n\t\t{\n\t\t\tconst typeAccess = this.calendarContext.util.config.TYPE_ACCESS;\n\t\t\tfor (const code in typeAccess)\n\t\t\t{\n\t\t\t\tif (typeAccess.hasOwnProperty(code))\n\t\t\t\t{\n\t\t\t\t\tthis.insertAccessRow(\n\t\t\t\t\t\tthis.calendarContext.util.getAccessName(code),\n\t\t\t\t\t\tcode,\n\t\t\t\t\t\ttypeAccess[code],\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tconst userSettings = this.calendarContext.util.config.userSettings;\n\n\t\t// Save user settings\n\t\tif (this.DOM.showDeclined)\n\t\t{\n\t\t\tuserSettings.showDeclined = this.DOM.showDeclined.checked ? 1 : 0;\n\t\t}\n\n\t\tif (this.DOM.showWeekNumbers)\n\t\t{\n\t\t\tuserSettings.showWeekNumbers = this.DOM.showWeekNumbers.checked ? 'Y' : 'N';\n\t\t}\n\n\t\tif (this.DOM.showTasks)\n\t\t{\n\t\t\tuserSettings.showTasks = this.DOM.showTasks.checked ? 'Y' : 'N';\n\t\t}\n\n\t\tif (this.DOM.syncTasks)\n\t\t{\n\t\t\tif (this.isSettingLocked(this.DOM.syncTasks))\n\t\t\t{\n\t\t\t\tuserSettings.syncTasks = 'N';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tuserSettings.syncTasks = this.DOM.syncTasks.checked ? 'Y' : 'N';\n\t\t\t}\n\t\t}\n\n\t\tif (this.DOM.showCompletedTasks)\n\t\t{\n\t\t\tuserSettings.showCompletedTasks = this.DOM.showCompletedTasks.checked ? 'Y' : 'N';\n\t\t}\n\n\t\tif (this.DOM.meetSectionSelect)\n\t\t{\n\t\t\tuserSettings.meetSection = this.DOM.meetSectionSelect.value;\n\t\t}\n\n\t\tif (this.DOM.crmSelect)\n\t\t{\n\t\t\tuserSettings.crmSection = this.DOM.crmSelect.value;\n\t\t}\n\n\t\tif (this.DOM.denyBusyInvitation)\n\t\t{\n\t\t\tuserSettings.denyBusyInvitation = this.DOM.denyBusyInvitation.checked ? 1 : 0;\n\t\t}\n\n\t\tuserSettings.userTimezoneName = this.DOM.timezoneSelect\n\t\t\t? this.DOM.timezoneSelect.value\n\t\t\t: userSettings.timezoneName;\n\n\t\tif (this.emailSelectorControl)\n\t\t{\n\t\t\tuserSettings.sendFromEmail = this.emailSelectorControl.getValue();\n\t\t}\n\n\t\t// const lunchTime = this.lunchTimeControl.getValue();\n\t\t// userSettings.enableLunchTime = this.DOM.enableLunchTime.checked ? 'Y' : 'N';\n\t\t// userSettings.lunchStart = Util.formatTime(lunchTime.from);\n\t\t// userSettings.lunchEnd = Util.formatTime(lunchTime.to);\n\n\t\tconst data = {\n\t\t\ttype: this.calendarContext.util.config.type,\n\t\t\tuser_settings: userSettings,\n\t\t\tuser_timezone_name: userSettings.userTimezoneName,\n\t\t};\n\n\t\tif (this.showGeneralSettings && this.DOM.workTimeStart)\n\t\t{\n\t\t\tdata.settings = {\n\t\t\t\twork_time_start: this.DOM.workTimeStart.value,\n\t\t\t\twork_time_end: this.DOM.workTimeEnd.value,\n\t\t\t\tweek_holidays: [],\n\t\t\t\tyear_holidays: this.DOM.yearHolidays.value,\n\t\t\t\tyear_workdays: this.DOM.yearWorkdays.value,\n\t\t\t};\n\n\t\t\tfor (let i = 0; i < this.DOM.weekHolidays.options.length; i++)\n\t\t\t{\n\t\t\t\tif (this.DOM.weekHolidays.options[i].selected)\n\t\t\t\t{\n\t\t\t\t\tdata.settings.week_holidays.push(this.DOM.weekHolidays.options[i].value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.showAccessControl)\n\t\t{\n\t\t\tdata.type_access = this.access;\n\t\t}\n\n\t\tBX.ajax.runAction(\n\t\t\t'calendar.api.calendarajax.saveSettings',\n\t\t\t{ data },\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tBX.reload();\n\t\t\t});\n\n\t\tthis.close();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.DOM.accessWrap = this.DOM.accessOuterWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container shown\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\" />\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\n\t\tthis.access = {};\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.calendarContext?.util?.getTypeAccessTasks();\n\n\t\tif (this.calendarContext?.util?.config?.accessNames)\n\t\t{\n\t\t\tUtil.setAccessNames(this.calendarContext.util.config.accessNames);\n\t\t}\n\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tconst entities = [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department',\n\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tif (Util.isProjectFeatureEnabled())\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'project',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities,\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t\tthis.entitySelectorDialog.subscribe('onHide', this.allowSliderClose.bind(this));\n\t\t\tthis.denySliderClose();\n\t\t});\n\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tconst title = entity.title.text;\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor (const taskId in this.accessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.accessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.accessTasks[taskId].name === 'calendar_type_edit'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst rowNode = Dom.adjust(\n\t\t\t\tthis.DOM.accessTable.insertRow(-1),\n\t\t\t\t{ props: { className: 'calendar-section-slider-access-table-row' } },\n\t\t\t);\n\t\t\tconst titleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\tprops: { className: 'calendar-section-slider-access-table-cell' },\n\t\t\t\thtml: `<span class=\"calendar-section-slider-access-title\" title=\"${Text.encode(title)}\">${Text.encode(title)}:</span>`,\n\t\t\t});\n\t\t\tconst valueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\tprops: { className: 'calendar-section-slider-access-table-cell' },\n\t\t\t\tattrs: { 'data-bx-calendar-access-selector': code },\n\t\t\t});\n\t\t\tconst selectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\tprops: { className: 'calendar-section-slider-access-container' },\n\t\t\t}));\n\t\t\tconst valueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\tprops: { className: 'calendar-section-slider-access-value' },\n\t\t\t}));\n\t\t\tconst removeIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\tprops: { className: 'calendar-section-slider-access-remove' },\n\t\t\t\tattrs: { 'data-bx-calendar-access-remove': code },\n\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode,\n\t\t\t\ttitleNode,\n\t\t\t\tvalueNode,\n\t\t\t\tremoveIcon,\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = `${parseInt(this.DOM.accessTable.offsetHeight) + 100}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.getContentContainer()?.offsetWidth > 0\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tthis.accessPopupMenu?.destroy();\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor (const taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function(value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})(taskId),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t`section-access-popup${Util.randomInt()}`,\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false,\n\t\t\t},\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\t}\n\n\topenHelpDesk(helpDeskCode)\n\t{\n\t\tif (top.BX.Helper)\n\t\t{\n\t\t\ttop.BX.Helper.show(`redirect=detail&code=${helpDeskCode}`);\n\t\t}\n\t}\n\n\tshowMessage()\n\t{\n\t\tif (this.message)\n\t\t{\n\t\t\tthis.message.show();\n\t\t\tthis.DOM.accessMessageWrap.style.maxHeight = `${300}px`;\n\t\t\tDom.addClass(this.DOM.accessHelpIcon, 'calendar-settings-message-arrow-target');\n\t\t}\n\t}\n\n\thideMessage()\n\t{\n\t\tif (this.message)\n\t\t{\n\t\t\tDom.removeClass(this.DOM.accessHelpIcon, 'calendar-settings-message-arrow-target');\n\t\t\tthis.message.hide();\n\t\t\tthis.DOM.accessMessageWrap.style.maxHeight = 0;\n\t\t\tif (!this.calendarContext.util.config.hideSettingsHintLocation)\n\t\t\t{\n\t\t\t\tBX.ajax.runAction(\n\t\t\t\t\t'calendar.api.locationajax.hideSettingsHintLocation',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tvalue: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t\t.then(() => {});\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["SettingsInterface","constructor","options","sliderId","name","SLIDER_WIDTH","SLIDER_DURATION","DOM","HELP_DESK_CODE","HELP_DESK_CODE_LOCATION","calendarContext","showPersonalSettings","showGeneralSettings","showAccessControl","Type","isObjectLike","util","config","TYPE_ACCESS","isExtranet","settings","BX","Util","getBX","hideMessageBinded","hideMessage","bind","show","SidePanel","Instance","open","contentCallback","createContent","width","animationDuration","events","onCloseByEsc","escHide","onClose","hide","onCloseComplete","destroy","onLoad","onLoadSlider","event","getSlider","getUrl","denyClose","denyAction","close","isOpenedState","isOpened","removeCustomEvent","proxy","denySliderClose","allowSliderClose","sectionListWrap","slider","Promise","resolve","top","ajax","runAction","data","uid","then","response","getData","set","html","params","additionalParams","mailboxList","content","layout","get","initControls","setControlsValue","buttonsWrap","querySelector","ZIndexManager","register","saveBtn","closeBtn","Event","save","denyBusyInvitation","showWeekNumbers","showDeclined","showTasks","showCompletedTasks","timezoneSelect","meetSectionSelect","crmSelect","syncTasks","sendFromEmailSelect","workTimeStart","workTimeEnd","weekHolidays","yearHolidays","yearWorkdays","accessMessageWrap","accessOuterWrap","accessHelpIcon","isElementNode","type","initMessageControl","remove","Dom","replace","Tag","render","openHelpDesk","Loc","getMessage","initAccessController","handleRestrictions","isSettingLocked","disabled","lockSetting","emailSelectorControl","EmailSelectorControl","selectNode","allowAddNewEmail","emailHelpIcon","Helper","initHintNode","setValue","getUserOption","emailWrap","Calendar","isEventWithEmailGuestAllowed","removeClass","addClass","parentNode","FeaturePromotersRegistry","getPromoter","featureId","node","closest","getSettingLockCode","dataset","lockCode","lockBindElement","showLock","bindElement","moreMessageButton","header","description","message","MessageCard","id","angle","hidden","actionElements","EventEmitter","subscribe","onClickHint","appendChild","getLayout","hideSettingsHintLocation","showMessage","isShown","length","sections","sectionManager","getSectionListForEdit","crmSection","parseInt","meetSection","section","selected","i","belongsToOwner","add","Option","checked","showWeekNumber","value","work_time_start","work_time_end","week_holidays","includes","year_holidays","year_workdays","typeAccess","code","hasOwnProperty","insertAccessRow","getAccessName","userSettings","userTimezoneName","timezoneName","sendFromEmail","getValue","user_settings","user_timezone_name","push","type_access","access","reload","accessWrap","accessTable","accessButton","accessControls","accessTasks","getTypeAccessTasks","accessNames","setAccessNames","entities","selectMode","isProjectFeatureEnabled","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","popupOptions","targetContainer","document","body","e","target","findTargetNode","srcElement","outerWrap","getAttribute","showAccessSelectorPopup","removeIcon","setValueCallback","valueNode","innerHTML","Text","encode","title","rowNode","entityList","getSelectedItems","isArray","forEach","entity","text","convertEntityToAccessCode","setAccessName","Runtime","debounce","undefined","taskId","adjust","insertRow","props","className","titleNode","insertCell","valueCell","attrs","create","checkAccessTableHeight","checkTableTimeout","clearTimeout","setTimeout","hasClass","offsetHeight","style","maxHeight","accessPopupMenu","popupWindow","getContentContainer","offsetWidth","_this","menuItems","onclick","PopupMenu","randomInt","closeByEsc","autoHide","offsetTop","offsetLeft","cacheable","helpDeskCode"],"mappings":"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"}