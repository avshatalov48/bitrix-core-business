(function(e,t,i,r,a,o){"use strict";function n(e,t,i){s(e,t);t.set(e,i)}function s(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}var l=new WeakMap;var c=function(e){babelHelpers.inherits(i,e);function i(e){var t;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};babelHelpers.classCallCheck(this,i);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this,e,r));n(babelHelpers.assertThisInitialized(t),l,{writable:true,value:false});t.initDocumentTypeSelector();if(r.isCopilotEnabled){t.initCopilot()}return t}babelHelpers.createClass(i,[{key:"initCopilot",value:function e(){var t=this;this.extraMarkers={};r.EventEmitter.subscribe("onHtmlEditorCopilotInit",(function(e){t.copilot=e.data.copilot}));r.EventEmitter.subscribe("onHtmlEditorCopilotShow",(function(e){t.collectExtraMarkers(e);t.copilot.setExtraMarkers(t.extraMarkers)}))}},{key:"collectExtraMarkers",value:function e(t){var i=document.querySelector("#name_text");if(i){this.extraMarkers.product_name=i.value}else{var r=document.querySelector('div[data-cid="NAME-CODE"]').querySelector("p");if(r){this.extraMarkers.product_name=r.innerHTML}}}},{key:"getEntityType",value:function e(){return"Product"}},{key:"onSectionLayout",value:function e(i){var a=this;var n=i.getCompatData(),s=babelHelpers.slicedToArray(n,2),c=s[0],d=s[1];if(d.id==="catalog_parameters"){d.visible=this.isSimpleProduct&&this.isCardSettingEnabled("CATALOG_PARAMETERS")}r.EventEmitter.subscribe("BX.UI.EntityEditorList:onItemSelect",(function(e){var i;var r=!(a.isWithOrdersMode&&!a.isInventoryManagementUsed);if(babelHelpers.classPrivateFieldGet(a,l)||!r){return}var n=(i=e.getData()[1])===null||i===void 0?void 0:i.field;if(!n){return}if(n.getId()!=="QUANTITY_TRACE"||n._selectedValue!=="N"){return}o.MessageBox.show({title:t.Loc.getMessage("CPD_QUANTITY_TRACE_NOTICE_TITLE"),message:t.Loc.getMessage("CPD_QUANTITY_TRACE_NOTICE"),buttons:o.MessageBoxButtons.OK,okCaption:t.Loc.getMessage("CPD_QUANTITY_TRACE_ACCEPT"),onOk:function e(t){babelHelpers.classPrivateFieldSet(a,l,false);t.close()},popupOptions:{closeIcon:true,events:{onAfterClose:function e(){return babelHelpers.classPrivateFieldSet(a,l,false)}}}});babelHelpers.classPrivateFieldSet(a,l,true)}));c===null||c===void 0?void 0:c.getChildren().forEach((function(e){if(a.hiddenFields.includes(e===null||e===void 0?void 0:e.getId())){e.setVisible(false)}}));r.EventEmitter.subscribe("onEntityUpdate",(function(e){var t;var i=(t=e.getData()[0])===null||t===void 0?void 0:t.sender;if(!i){return}var r=i._model.getField("QUANTITY_TRACE","D");var o=!(a.isWithOrdersMode&&!a.isInventoryManagementUsed);if(r!=="N"&&o){var n;(n=i.getControlById("QUANTITY_TRACE"))===null||n===void 0?void 0:n.setVisible(false)}}))}},{key:"onGridUpdatedHandler",value:function e(t){babelHelpers.get(babelHelpers.getPrototypeOf(i.prototype),"onGridUpdatedHandler",this).call(this,t);var r=t.getCompatData(),a=babelHelpers.slicedToArray(r,1),o=a[0];if(o&&o.getId()===this.getVariationGridId()&&o.getRows().getCountDisplayed()<=0){document.location.reload()}}},{key:"onEditorAjaxSubmit",value:function e(r){babelHelpers.get(babelHelpers.getPrototypeOf(i.prototype),"onEditorAjaxSubmit",this).call(this,r);var a=r.getCompatData(),o=babelHelpers.slicedToArray(a,2),n=o[1];if(n.data){if(n.data.NOTIFY_ABOUT_NEW_VARIATION){this.showNotification(t.Loc.getMessage("CPD_NEW_VARIATION_ADDED_MSGVER_1"))}}}},{key:"initDocumentTypeSelector",value:function e(){var t=document.getElementById(this.settings.productTypeSelector);var i=this.settings.productTypeSelectorTypes;if(!t||!i){return}var r=[];Object.keys(i).forEach((function(e){r.push({text:i[e],onclick:function t(i){var r=BX.SidePanel.Instance.getTopSlider();if(r){r.url=BX.Uri.addParam(r.getUrl(),{productTypeId:e});r.requestMethod="post";r.setFrameSrc()}}})}));var o=a.MenuManager.create({id:"productcard-product-type-selector",bindElement:t,items:r,minWidth:t.offsetWidth});t.addEventListener("click",(function(e){e.preventDefault();o.show()}))}}]);return i}(i.EntityCard);t.Reflection.namespace("BX.Catalog").ProductCard=c})(this.window=this.window||{},BX,BX.Catalog.EntityCard,BX.Event,BX.Main,BX.UI.Dialogs);
//# sourceMappingURL=script.map.js