this.BX=this.BX||{};this.BX.Landing=this.BX.Landing||{};(function(t,e,n){"use strict";var o=function(){function t(e){babelHelpers.classCallCheck(this,t);this.node=e;return this}babelHelpers.createClass(t,[{key:"setParent",value:function t(e){this.parent=e;return this}},{key:"setDefaultValue",value:function t(e){this.defaultValue=e;return this}},{key:"setChangeHandler",value:function t(n){e.Event.bind(this.node,"change",n)}},{key:"setClickHandler",value:function t(n){e.Event.bind(this.node,"click",n)}},{key:"getValue",value:function t(){return this.parent&&this.parent.getValue()!==true?this.defaultValue:this.getValueInternal()}},{key:"getValueInternal",value:function t(){return this.node}}]);return t}();function i(){var t=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="landing-design-preview-wrap">\n\t\t\t\t<div class="landing-design-preview">\n\t\t\t\t\t<h2 class="landing-design-preview-title">','</h2>\n\t\t\t\t\t<h4 class="landing-design-preview-subtitle">','</h4>\n\t\t\t\t\t<p class="landing-design-preview-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</p>\n\t\t\t\t\t<p class="landing-design-preview-text">\n\t\t\t\t\t\t','\n\t\t\t\t\t</p>\n\t\t\t\t\t<div class="">\n\t\t\t\t\t\t<a href="#" class="landing-design-preview-button">',"</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"]);i=function e(){return t};return t}var r=function(t){babelHelpers.inherits(r,t);function r(t){var e;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};babelHelpers.classCallCheck(this,r);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(r).call(this));e.setEventNamespace("BX.Landing.SettingsForm.DesignPreview");e.form=t;e.phrase=o;e.initControls(n);e.initLayout();e.applyStyles();e.onApplyStyles=e.applyStyles.bind(babelHelpers.assertThisInitialized(e));return e}babelHelpers.createClass(r,[{key:"initLayout",value:function t(){var n=this;this.layout=r.createLayout(this.phrase);this.styleNode=document.createElement("style");e.Dom.append(this.styleNode,this.layout);e.Dom.append(this.layout,this.form);var o={threshold:1};var i=new IntersectionObserver(function(t){t.forEach(function(t){var e=document.documentElement.clientHeight-r.HEIGHT_PAGE_TITLE_WRAP;if(t.target.getBoundingClientRect().height<=e){if(t.isIntersecting){if(!n.hasOwnProperty("defaultIntersecting")){n.defaultIntersecting=true}if(n.defaultIntersecting){n.unFixElement()}}else{if(!n.hasOwnProperty("defaultIntersecting")){n.defaultIntersecting=false}if(n.defaultIntersecting){n.fixElement()}}}})},o);var s=document.querySelector(".landing-design-preview-wrap");i.observe(s)}},{key:"initControls",value:function t(i){this.controls={};for(var r in i){if(!i.hasOwnProperty(r)){continue}for(var s in i[r]){if(!i[r].hasOwnProperty(s)){continue}if(!this.controls[r]){this.controls[r]={}}var l=new o(i[r][s]["control"]);l.setChangeHandler(this.applyStyles.bind(this));if(r==="theme"&&s!=="use"){l.setClickHandler(this.applyStyles.bind(this))}if(r==="background"&&s==="field"){l.setClickHandler(this.applyStyles.bind(this))}this.controls[r][s]=l}}for(var a in this.controls){if(!this.controls.hasOwnProperty(a)){continue}for(var c in this.controls[a]){if(!this.controls[a].hasOwnProperty(c)){continue}if(c!=="use"&&this.controls[a]["use"]){this.controls[a][c].setParent(this.controls[a]["use"]);if(i[a][c]["defaultValue"]){this.controls[a][c].setDefaultValue(i[a][c]["defaultValue"])}}}}if(this.controls.theme.corporateColor.node){this.controls.theme.corporateColor.node.subscribe("onSelectColor",this.onApplyStyles.bind(this))}if(this.controls.background.image.node){this.controls.background.image.node.subscribe("change",this.onApplyStyles.bind(this))}if(this.controls.typo.textColor.node){n.EventEmitter.subscribe(this.controls.typo.textColor.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));n.EventEmitter.subscribe(this.controls.typo.textColor.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}if(this.controls.typo.hColor.node){n.EventEmitter.subscribe(this.controls.typo.hColor.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));n.EventEmitter.subscribe(this.controls.typo.hColor.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}if(this.controls.background.color.node){n.EventEmitter.subscribe(this.controls.background.color.node,"BX.Landing.ColorPicker:onSelectColor",this.onApplyStyles.bind(this));n.EventEmitter.subscribe(this.controls.background.color.node,"BX.Landing.ColorPicker:onClearColorPicker",this.onApplyStyles.bind(this))}this.panel=BX.Landing.UI.Panel.GoogleFonts.getInstance();e.Dom.append(this.panel.layout,document.body);var u=this.controls.typo.textFont.node;var h=this.controls.typo.hFont.node;if(u&&h){u.setAttribute("value",this.convertFont(u.value));h.setAttribute("value",this.convertFont(h.value));e.Event.bind(u,"click",this.onCodeClick.bind(this));e.Event.bind(h,"click",this.onCodeClick.bind(this))}}},{key:"onCodeClick",value:function t(e){var n=this;this.panel.show({hideOverlay:true,context:window}).then(function(t){var o=e.target;o.setAttribute("value",t.family);n.onApplyStyles()})}},{key:"onApplyStyles",value:function t(){this.applyStyles()}},{key:"applyStyles",value:function t(){this.styleNode.innerHTML=this.generateCss()}},{key:"generateSelectorStart",value:function t(e){return"."+e+" {"}},{key:"generateSelectorEnd",value:function t(e){return e+" }"}},{key:"getCSSPart1",value:function t(e){var n;var o=this.controls.theme.baseColors.node;var i;if(this.controls.theme.corporateColor.node){i=this.controls.theme.corporateColor.node.element}var r;if(o){r=o.querySelector(".active")}var s;if(i){s=i.classList.contains("active")}if(r){n=r.dataset.value}if(s){n=i.dataset.value}if(this.controls.theme.use.node){if(this.controls.theme.use.node.checked===false){n=this.controls.theme.corporateColor.defaultValue}}if(n){if(n[0]!=="#"){n="#"+n}e+="--design-preview-primary: ".concat(n,";")}return e}},{key:"getCSSPart2",value:function t(n){var o;var i;var s;var l;var a;var c;var u;var h;if(this.controls.typo.textColor.node){o=this.controls.typo.textColor.node.input.value}if(this.controls.typo.textFont.node){i=this.controls.typo.textFont.node.value}if(this.controls.typo.hFont.node){s=this.controls.typo.hFont.node.value}if(this.controls.typo.textSize.node){l=Math.round(this.controls.typo.textSize.node.value*r.DEFAULT_FONT_SIZE)+"px"}if(this.controls.typo.textWeight.node){a=this.controls.typo.textWeight.node.value}if(this.controls.typo.textLineHeight.node){c=this.controls.typo.textLineHeight.node.value}if(this.controls.typo.hColor.node){u=this.controls.typo.hColor.node.input.value}if(this.controls.typo.hWeight.node){h=this.controls.typo.hWeight.node.value}if(this.controls.typo.use.node){if(this.controls.typo.use.node.checked===false){o=this.controls.typo.textColor.defaultValue;i=this.controls.typo.textFont.defaultValue;s=this.controls.typo.hFont.defaultValue;l=Math.round(this.controls.typo.textSize.defaultValue*r.DEFAULT_FONT_SIZE)+"px";a=this.controls.typo.textWeight.defaultValue;c=this.controls.typo.textLineHeight.defaultValue;u=this.controls.typo.hColor.defaultValue;h=this.controls.typo.hWeight.defaultValue}}var d;var p;if(i){d=this.createLink(i);e.Dom.append(d,this.form)}if(s){p=this.createLink(s);e.Dom.append(p,this.form)}n+="--design-preview-color: ".concat(o,";");n+="--design-preview-font-theme: ".concat(i,";");n+="--design-preview-font-size: ".concat(l,";");n+="--design-preview-font-weight: ".concat(a,";");n+="--design-preview-line-height: ".concat(c,";");if(u){n+="--design-preview-color-h: ".concat(u,";")}else{n+="--design-preview-color-h: ".concat(o,";")}if(h){n+="--design-preview-font-weight-h: ".concat(h,";")}else{n+="--design-preview-font-weight-h: ".concat(a,";")}if(this.controls.typo.hFont.node){n+="--design-preview-font-h-theme: ".concat(s,";")}else{n+="--design-preview-font-h-theme: ".concat(i,";")}return n}},{key:"createLink",value:function t(e){var n=document.createElement("link");n.rel="stylesheet";n.href="https://fonts.googleapis.com/css2?family=";n.href+=e.replace(" ","+");n.href+=":wght@100;200;300;400;500;600;700;800;900";return n}},{key:"getCSSPart3",value:function t(e){var n=this.controls.background.color.node.input.value;var o=this.controls.background.field.node;var i=o.getElementsByClassName("landing-ui-field-image-hidden");var r=i[0].getAttribute("src");var s=this.controls.background.position.node.value;if(this.controls.background.use.node.checked===true){e+="--design-preview-bg: ".concat(n,";")}else{r="";if(this.controls.background.useSite){if(this.controls.background.useSite.defaultValue==="Y"){n=this.controls.background.color.defaultValue;r=this.controls.background.field.defaultValue;s=this.controls.background.position.defaultValue;e+="--design-preview-bg: ".concat(n,";")}}}if(this.controls.background.position){if(s==="center"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: center;";e+="background-repeat: no-repeat;";e+="background-size: cover;"}if(s==="repeat"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: center;";e+="background-repeat: repeat;";e+="background-size: 50%;"}if(s==="center_repeat_y"){e+="background-image: url(".concat(r,");");e+="background-attachment: scroll;";e+="background-position: top;";e+="background-repeat: repeat-y;";e+="background-size: 100%;"}}return e}},{key:"generateCss",value:function t(){var e;e=this.generateSelectorStart("landing-design-preview");e=this.getCSSPart1(e);e=this.getCSSPart2(e);e=this.getCSSPart3(e);e=this.generateSelectorEnd(e);return e}},{key:"fixElement",value:function t(){var e=20;var n=document.querySelector(".landing-design-form");var o=n.getBoundingClientRect();var i=document.querySelector(".landing-design-preview");var r=i.getBoundingClientRect();var s=document.body.clientWidth;var l=s-o.right+e;var a=25;var c=document.querySelector(".landing-design-preview-wrap");var u=c.getBoundingClientRect();var h=u.width-a*2;if(o.height>r.height){var d;d="position: fixed; ";d+="top: 20px; ";d+="margin-top: 0; ";d+="right: "+l+"px;";d+="max-width: "+h+"px;";i.setAttribute("style",d)}}},{key:"unFixElement",value:function t(){var e=document.querySelector(".landing-design-preview");e.setAttribute("style","")}},{key:"convertFont",value:function t(e){e=e.replace("g-font-","");e=e.replaceAll("-"," ");e=e.replace("ibm ","IBM ");e=e.replace("pt ","PT ");e=e.replace(/sc(?:(?![a-z]))/i,"SC");e=e.replace(/jp(?:(?![a-z]))/i,"JP");e=e.replace(/kr(?:(?![a-z]))/i,"KR");e=e.replace(/tc(?:(?![a-z]))/i,"TC");e=e.replace(/(^|\s)\S/g,function(t){return t.toUpperCase()});return e}}],[{key:"createLayout",value:function t(n){return e.Tag.render(i(),n.title,n.subtitle,n.text1,n.text2,n.button)}}]);return r}(n.EventEmitter);babelHelpers.defineProperty(r,"DEFAULT_FONT_SIZE",14);babelHelpers.defineProperty(r,"HEIGHT_PAGE_TITLE_WRAP",74);t.DesignPreview=r})(this.BX.Landing.SettingsForm=this.BX.Landing.SettingsForm||{},BX,BX.Event);
//# sourceMappingURL=designpreview.bundle.map.js