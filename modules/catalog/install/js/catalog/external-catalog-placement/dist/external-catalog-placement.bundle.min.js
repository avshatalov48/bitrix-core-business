this.BX=this.BX||{};(function(e,t,a){"use strict";let s=e=>e,l,r;var i=babelHelpers.classPrivateFieldLooseKey("instance");var o=babelHelpers.classPrivateFieldLooseKey("CODE");var n=babelHelpers.classPrivateFieldLooseKey("appSid");var c=babelHelpers.classPrivateFieldLooseKey("initializePromise");var d=babelHelpers.classPrivateFieldLooseKey("isInitialized");var P=babelHelpers.classPrivateFieldLooseKey("initializationError");var p=babelHelpers.classPrivateFieldLooseKey("loadPlacement");var b=babelHelpers.classPrivateFieldLooseKey("registerPlacement");var u=babelHelpers.classPrivateFieldLooseKey("loadPlacementLayout");var v=babelHelpers.classPrivateFieldLooseKey("runPlacementLayout");var m=babelHelpers.classPrivateFieldLooseKey("waitForOnReadyEvent");class L{constructor(){Object.defineProperty(this,m,{value:F});Object.defineProperty(this,v,{value:y});Object.defineProperty(this,u,{value:R});Object.defineProperty(this,b,{value:h});Object.defineProperty(this,p,{value:E});Object.defineProperty(this,n,{writable:true,value:null});Object.defineProperty(this,c,{writable:true,value:null});Object.defineProperty(this,d,{writable:true,value:false});Object.defineProperty(this,P,{writable:true,value:null})}static create(){if(babelHelpers.classPrivateFieldLooseBase(this,i)[i]){return babelHelpers.classPrivateFieldLooseBase(this,i)[i]}babelHelpers.classPrivateFieldLooseBase(this,i)[i]=new this;return babelHelpers.classPrivateFieldLooseBase(this,i)[i]}initialize(){if(!babelHelpers.classPrivateFieldLooseBase(this,c)[c]){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=new Promise(((e,t)=>{babelHelpers.classPrivateFieldLooseBase(this,p)[p]().then((e=>babelHelpers.classPrivateFieldLooseBase(this,b)[b](e))).then((e=>babelHelpers.classPrivateFieldLooseBase(this,u)[u](e))).then((e=>babelHelpers.classPrivateFieldLooseBase(this,v)[v](e))).then((()=>babelHelpers.classPrivateFieldLooseBase(this,m)[m]())).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,d)[d]=true;e()})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,d)[d]=true;babelHelpers.classPrivateFieldLooseBase(this,P)[P]=e;t(e)}))}))}return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}reset(){babelHelpers.classPrivateFieldLooseBase(this,c)[c]=null}getAppSidId(){return babelHelpers.classPrivateFieldLooseBase(this,n)[n]}isInitialized(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}isInitializedSuccessfully(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]&&this.getInitializationError()===null}getInitializationError(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P]}}function E(){if(t.Extension.getSettings("catalog.external-catalog-placement").get("is1cPlanRestricted",false)){return Promise.reject({reason:"tariff"})}return new Promise(((e,a)=>{t.ajax.runComponentAction("bitrix:app.placement","getComponent",{data:{placementId:babelHelpers.classPrivateFieldLooseBase(L,o)[o]}}).then((t=>e(t))).catch((()=>{a({reason:L.LOAD_PLACEMENT_ERROR})}))}))}function h(e){return new Promise(((a,r)=>{const i=t.Tag.render(l||(l=s`<div style="display: none; overflow: hidden;"></div>`));t.Dom.append(i,document.body);t.Runtime.html(i,e.data.html,{callback:()=>setTimeout((()=>{const e=BX.Reflection.getClass("BX.rest.AppLayout");const t=e?e.getPlacement(babelHelpers.classPrivateFieldLooseBase(L,o)[o]):null;if(t){a({placement:t,placementInterface:BX.rest.AppLayout.initializePlacement(babelHelpers.classPrivateFieldLooseBase(L,o)[o])});return}r({reason:L.REGISTER_PLACEMENT_ERROR})}),10)})}))}function R(e){return new Promise(((s,l)=>{e.placementInterface.prototype.onReady=e=>{a.EventEmitter.emit("Catalog:ProductSelectorPlacement:onReady",e)};e.placementInterface.prototype.onProductCreated=e=>{a.EventEmitter.emit("Catalog:ProductSelectorPlacement:onProductCreated",e)};e.placementInterface.prototype.onProductUpdated=e=>{a.EventEmitter.emit("Catalog:ProductSelectorPlacement:onProductUpdated",e)};e.placementInterface.prototype.onProductsFound=e=>{a.EventEmitter.emit("Catalog:ProductSelectorPlacement:onProductsFound",e)};e.placementInterface.prototype.events.push("Catalog:ProductSelectorPlacement:onNeedProductCreate","Catalog:ProductSelectorPlacement:onNeedProductUpdate","Catalog:ProductSelectorPlacement:onNeedSearchProducts");t.ajax.runComponentAction("bitrix:app.layout","getComponent",{data:{placementId:e.placement.param.current,placementOptions:null}}).then((e=>{s(e)})).catch((()=>{l({reason:L.LOAD_PLACEMENT_LAYOUT_ERROR})}))}))}function y(e){return new Promise((a=>{babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e.data.componentResult.APP_SID;const l=t.Tag.render(r||(r=s`
				<div
					data-app-sid="${0}"
					style="display: none; overflow: hidden"
				>
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,n)[n]);t.Dom.append(l,document.body);t.Runtime.html(l,e.data.html);a()}))}function F(){return new Promise(((e,t)=>{a.EventEmitter.subscribe("Catalog:ProductSelectorPlacement:onReady",(()=>{e()}));setTimeout((()=>t({reason:"timeout"})),L.RESPONSE_TIMEOUT)}))}Object.defineProperty(L,i,{writable:true,value:null});Object.defineProperty(L,o,{writable:true,value:"CATALOG_EXTERNAL_PRODUCT"});L.LOAD_PLACEMENT_ERROR="LOAD_PLACEMENT_ERROR";L.REGISTER_PLACEMENT_ERROR="REGISTER_PLACEMENT_ERROR";L.LOAD_PLACEMENT_LAYOUT_ERROR="LOAD_PLACEMENT_LAYOUT_ERROR";L.RESPONSE_TIMEOUT=2e4;e.ExternalCatalogPlacement=L})(this.BX.Catalog=this.BX.Catalog||{},BX,BX.Event);
//# sourceMappingURL=external-catalog-placement.bundle.map.js