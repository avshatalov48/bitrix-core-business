this.BX=this.BX||{};(function(e,t,i,a,s,l,r,n){"use strict";var b;var c=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));e.setEventNamespace("BX.Rest.EInvoiceInstaller.Page");return e}babelHelpers.createClass(t,[{key:"getContent",value:function e(){throw new Error("Must be implemented in a child class")}},{key:"getIcon",value:function e(){return i.Tag.render(b||(b=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="bitrix-einvoice-installer-main-icon-wrapper">\n\t\t\t\t<div class="bitrix-einvoice-installer-main-icon"></div>\n\t\t\t</div>\n\t\t'])))}}],[{key:"getType",value:function e(){throw new Error("Must be implemented in a child class")}}]);return t}(l.EventEmitter);var o;function p(e,t){d(e,t);t.add(e)}function v(e,t,i){d(e,t);t.set(e,i)}function d(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function h(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var u=new WeakMap;var H=new WeakMap;var f=new WeakSet;var T=function(e){babelHelpers.inherits(t,e);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));p(babelHelpers.assertThisInitialized(e),f);v(babelHelpers.assertThisInitialized(e),u,{writable:true,value:void 0});v(babelHelpers.assertThisInitialized(e),H,{writable:true,value:void 0});e.setEventNamespace("BX.Rest.EInvoiceInstaller.ErrorPage");return e}babelHelpers.createClass(t,[{key:"getContent",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,u)){babelHelpers.classPrivateFieldSet(this,u,i.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-content --error-content">\n\t\t\t\t\t<div class="bitrix-einvoice-installer-error-icon"></div>\n\t\t\t\t\t<div class="bitrix-einvoice-installer-title-install">',"</div>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"])),i.Loc.getMessage("REST_EINVOICE_INSTALLER_ERROR_TITLE"),h(this,f,w).call(this)))}return babelHelpers.classPrivateFieldGet(this,u)}}],[{key:"getType",value:function e(){return"error"}}]);return t}(c);function w(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,H)){babelHelpers.classPrivateFieldSet(this,H,new s.Button({text:i.Loc.getMessage("REST_EINVOICE_INSTALLER_ERROR_BUTTON"),size:s.Button.Size.LARGE,color:s.Button.Color.SUCCESS,className:"bitrix-einvoice-installer-button-try-again",onclick:function t(){e.emit("go-back")}}).getContainer())}return babelHelpers.classPrivateFieldGet(this,H)}var g,I;function P(e,t){m(e,t);t.add(e)}function E(e,t,i){m(e,t);t.set(e,i)}function m(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function F(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var k=new WeakMap;var z=new WeakMap;var S=new WeakMap;var y=new WeakSet;var C=new WeakSet;var G=new WeakSet;var L=function(e){babelHelpers.inherits(t,e);babelHelpers.createClass(t,null,[{key:"getType",value:function e(){return"install"}}]);function t(){var e;babelHelpers.classCallCheck(this,t);e=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));P(babelHelpers.assertThisInitialized(e),G);P(babelHelpers.assertThisInitialized(e),C);P(babelHelpers.assertThisInitialized(e),y);E(babelHelpers.assertThisInitialized(e),k,{writable:true,value:void 0});E(babelHelpers.assertThisInitialized(e),z,{writable:true,value:void 0});E(babelHelpers.assertThisInitialized(e),S,{writable:true,value:void 0});e.setEventNamespace("BX.Rest.EInvoiceInstaller.InstallPage");e.subscribe("install-app",(function(t){F(babelHelpers.assertThisInitialized(e),G,W).call(babelHelpers.assertThisInitialized(e)).show();var i=t.data.source;t.data.install.then((function(e){if(!e.status){return Promise.reject()}return n.AppForm.buildByApp(e.data.id)})).then((function(t){F(babelHelpers.assertThisInitialized(e),G,W).call(babelHelpers.assertThisInitialized(e)).hide();t.show();i.render("selection")}))["catch"]((function(){F(babelHelpers.assertThisInitialized(e),G,W).call(babelHelpers.assertThisInitialized(e)).hide();F(babelHelpers.assertThisInitialized(e),y,O).call(babelHelpers.assertThisInitialized(e))}))}));return e}babelHelpers.createClass(t,[{key:"getContent",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,k)){babelHelpers.classPrivateFieldSet(this,k,i.Tag.render(g||(g=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-content">\n\t\t\t\t\t','\n\t\t\t\t\t<div class="bitrix-einvoice-installer-loader-wrapper-install"/>\n\t\t\t\t</div>\n\t\t\t'])),F(this,C,R).call(this)))}return babelHelpers.classPrivateFieldGet(this,k)}}]);return t}(c);function O(){this.emit("install-error")}function R(){if(!babelHelpers.classPrivateFieldGet(this,z)){babelHelpers.classPrivateFieldSet(this,z,i.Tag.render(I||(I=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-title-install">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),i.Loc.getMessage("REST_EINVOICE_INSTALLER_INSTALL_TITLE")))}return babelHelpers.classPrivateFieldGet(this,z)}function W(){if(!babelHelpers.classPrivateFieldGet(this,S)){babelHelpers.classPrivateFieldSet(this,S,new t.Loader({target:this.getContent().querySelector(".bitrix-einvoice-installer-loader-wrapper-install"),size:90,color:"#2FC6F6",mode:"inline"}))}return babelHelpers.classPrivateFieldGet(this,S)}var B,M;function _(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function N(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function x(e,t){j(e,t);t.add(e)}function X(e,t,i){j(e,t);t.set(e,i)}function j(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function A(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var D=new WeakMap;var U=new WeakMap;var V=new WeakMap;var q=new WeakMap;var J=new WeakSet;var K=new WeakSet;var Q=new WeakSet;var Y=function(e){babelHelpers.inherits(t,e);function t(e,i){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));x(babelHelpers.assertThisInitialized(a),Q);x(babelHelpers.assertThisInitialized(a),K);x(babelHelpers.assertThisInitialized(a),J);X(babelHelpers.assertThisInitialized(a),D,{writable:true,value:void 0});X(babelHelpers.assertThisInitialized(a),U,{writable:true,value:void 0});X(babelHelpers.assertThisInitialized(a),V,{writable:true,value:void 0});X(babelHelpers.assertThisInitialized(a),q,{writable:true,value:void 0});a.setEventNamespace("BX.Rest.EInvoiceAppButton");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),U,e);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),q,i);return a}babelHelpers.createClass(t,[{key:"getContent",value:function e(){var t=this;var a=new s.Button({text:i.Loc.getMessage("REST_EINVOICE_INSTALLER_SELECTION_BUTTON"),size:s.Button.Size.LARGE,color:s.Button.Color.SUCCESS,dropdown:true,className:"bitrix-einvoice-installer-button-select",onclick:function e(i){var a=A(t,J,Z).call(t,i.button);a.getPopup().setMaxWidth(i.button.offsetWidth);a.getPopup().toggle()}});return a.getContainer()}}]);return t}(l.EventEmitter);function Z(e){var t=this;if(babelHelpers.classPrivateFieldGet(this,D)){return babelHelpers.classPrivateFieldGet(this,D)}babelHelpers.classPrivateFieldSet(this,D,new a.PopupComponentsMaker({target:e,content:A(this,K,$).call(this),useAngle:false}));babelHelpers.classPrivateFieldGet(this,D).getPopup().setOffset({offsetLeft:0,offsetTop:0});this.subscribe("popup-close",(function(){babelHelpers.classPrivateFieldGet(t,D).close()}));return babelHelpers.classPrivateFieldGet(this,D)}function $(){var e=this;if(babelHelpers.classPrivateFieldGet(this,V)){return babelHelpers.classPrivateFieldGet(this,V)}babelHelpers.classPrivateFieldSet(this,V,[]);babelHelpers.classPrivateFieldGet(this,U).forEach((function(t){var a=function i(){e.emit("popup-close");e.emit("click-app",new l.BaseEvent({data:{code:t.code,name:t.name}}))};babelHelpers.classPrivateFieldGet(e,V).push({html:i.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<div onclick="','" class="bitrix-einvoice-installer-app-wrapper">\n\t\t\t\t\t\t<div class="bitrix-einvoice-installer-app-name">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t"])),a,i.Text.encode(t.name))})}));var t=function t(){A(e,Q,ee).call(e);e.emit("popup-close")};babelHelpers.classPrivateFieldGet(this,V).push({html:i.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div onclick="','" class="bitrix-einvoice-installer-app-wrapper --form">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),t,i.Loc.getMessage("REST_EINVOICE_INSTALLER_SELECTION_BUTTON_OFFER"))});return babelHelpers.classPrivateFieldGet(this,V)}function ee(){BX.UI.Feedback.Form.open({id:"b5309667",forms:[{zones:["es"],id:676,lang:"es",sec:"uthphh"},{zones:["de"],id:670,lang:"de",sec:"gk89kt"},{zones:["com.br"],id:668,lang:"br",sec:"kuelnm"}],defaultForm:{id:674,lang:"en",sec:"5iorws"},presets:N(N({},babelHelpers.classPrivateFieldGet(this,q)),{},{sender_page:document.location.href})})}var te,ie,ae,se;function le(e,t){ne(e,t);t.add(e)}function re(e,t,i){ne(e,t);t.set(e,i)}function ne(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function be(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var ce=new WeakMap;var oe=new WeakMap;var pe=new WeakMap;var ve=new WeakMap;var de=new WeakMap;var he=new WeakMap;var ue=new WeakMap;var He=new WeakSet;var fe=new WeakSet;var Te=new WeakSet;var we=new WeakSet;var ge=function(e){babelHelpers.inherits(t,e);function t(e,i){var a;babelHelpers.classCallCheck(this,t);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));le(babelHelpers.assertThisInitialized(a),we);le(babelHelpers.assertThisInitialized(a),Te);le(babelHelpers.assertThisInitialized(a),fe);le(babelHelpers.assertThisInitialized(a),He);re(babelHelpers.assertThisInitialized(a),ce,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),oe,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),pe,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),ve,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),de,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),he,{writable:true,value:void 0});re(babelHelpers.assertThisInitialized(a),ue,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),de,e);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(a),he,i);a.setEventNamespace("BX.Rest.EInvoiceInstaller.SelectionPage");return a}babelHelpers.createClass(t,[{key:"getContent",value:function e(){if(!babelHelpers.classPrivateFieldGet(this,ce)){babelHelpers.classPrivateFieldSet(this,ce,i.Tag.render(te||(te=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-content">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t"])),be(this,He,Ie).call(this),be(this,fe,Pe).call(this),be(this,Te,Ee).call(this),be(this,we,me).call(this)))}return babelHelpers.classPrivateFieldGet(this,ce)}}],[{key:"getType",value:function e(){return"selection"}}]);return t}(c);function Ie(){if(!babelHelpers.classPrivateFieldGet(this,oe)){babelHelpers.classPrivateFieldSet(this,oe,i.Tag.render(ie||(ie=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-title__wrapper">\n\t\t\t\t\t<div class="bitrix-einvoice-installer-title__main-text">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"])),i.Loc.getMessage("REST_EINVOICE_INSTALLER_SELECTION_TITLE")))}return babelHelpers.classPrivateFieldGet(this,oe)}function Pe(){if(!babelHelpers.classPrivateFieldGet(this,pe)){babelHelpers.classPrivateFieldSet(this,pe,i.Tag.render(ae||(ae=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="bitrix-einvoice-installer-description">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),i.Loc.getMessage("REST_EINVOICE_INSTALLER_SELECTION_DESCRIPTION")))}return babelHelpers.classPrivateFieldGet(this,pe)}function Ee(){var e=this;if(babelHelpers.classPrivateFieldGet(this,ve)){return babelHelpers.classPrivateFieldGet(this,ve)}var t=new Y(babelHelpers.classPrivateFieldGet(this,de),babelHelpers.classPrivateFieldGet(this,he));babelHelpers.classPrivateFieldSet(this,ve,t.getContent());t.subscribe("click-app",(function(t){e.emit("start-install-app",t)}));return babelHelpers.classPrivateFieldGet(this,ve)}function me(){if(babelHelpers.classPrivateFieldGet(this,ue)){return babelHelpers.classPrivateFieldGet(this,ue)}var e=function e(){top.BX.Helper.show("redirect=detail&code=19312840")};babelHelpers.classPrivateFieldSet(this,ue,i.Tag.render(se||(se=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="bitrix-einvoice-installer-more-information-wrapper">\n\t\t\t\t<div onclick="','" class="bitrix-einvoice-installer-more-information-link">\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),e,i.Loc.getMessage("REST_EINVOICE_INSTALLER_MORE")));return babelHelpers.classPrivateFieldGet(this,ue)}function Fe(e,t){ze(e,t);t.add(e)}function ke(e,t,i){ze(e,t);t.set(e,i)}function ze(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Se(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var ye=new WeakMap;var Ce=new WeakMap;var Ge=new WeakMap;var Le=new WeakMap;var Oe=new WeakMap;var Re=new WeakSet;var We=new WeakSet;var Be=new WeakSet;var Me=new WeakSet;var _e=function(e){babelHelpers.inherits(t,e);function t(e){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Fe(babelHelpers.assertThisInitialized(i),Me);Fe(babelHelpers.assertThisInitialized(i),Be);Fe(babelHelpers.assertThisInitialized(i),We);Fe(babelHelpers.assertThisInitialized(i),Re);ke(babelHelpers.assertThisInitialized(i),ye,{writable:true,value:void 0});ke(babelHelpers.assertThisInitialized(i),Ce,{writable:true,value:void 0});ke(babelHelpers.assertThisInitialized(i),Ge,{writable:true,value:void 0});ke(babelHelpers.assertThisInitialized(i),Le,{writable:true,value:void 0});ke(babelHelpers.assertThisInitialized(i),Oe,{writable:true,value:void 0});i.setEventNamespace("BX.Rest.EInvoiceInstaller.PageProvider");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(i),Le,e);babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(i),Oe,[ge.getType(),L.getType(),T.getType()]);return i}babelHelpers.createClass(t,[{key:"exist",value:function e(t){return babelHelpers.classPrivateFieldGet(this,Oe).includes(t)}},{key:"getPageByType",value:function e(t){switch(t){case ge.getType():return Se(this,Re,Ne).call(this);case L.getType():return Se(this,We,xe).call(this);case T.getType():return Se(this,Be,Xe).call(this);default:throw new Error("Incorrect page type")}}}]);return t}(l.EventEmitter);function Ne(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,ye)){babelHelpers.classPrivateFieldSet(this,ye,new ge(babelHelpers.classPrivateFieldGet(this,Le).apps,babelHelpers.classPrivateFieldGet(this,Le).formConfiguration));Se(this,Me,je).call(this,babelHelpers.classPrivateFieldGet(this,ye));babelHelpers.classPrivateFieldGet(this,ye).subscribe("start-install-app",(function(){e.emit("render",new l.BaseEvent({data:{type:L.getType()}}))}))}return babelHelpers.classPrivateFieldGet(this,ye)}function xe(){if(!babelHelpers.classPrivateFieldGet(this,Ce)){babelHelpers.classPrivateFieldSet(this,Ce,new L);Se(this,Me,je).call(this,babelHelpers.classPrivateFieldGet(this,Ce))}return babelHelpers.classPrivateFieldGet(this,Ce)}function Xe(){if(!babelHelpers.classPrivateFieldGet(this,Ge)){babelHelpers.classPrivateFieldSet(this,Ge,new T);Se(this,Me,je).call(this,babelHelpers.classPrivateFieldGet(this,Ge))}return babelHelpers.classPrivateFieldGet(this,Ge)}function je(e){var t=this;e.subscribe("go-back",(function(){t.emit("render",new l.BaseEvent({data:{type:ge.getType()}}))}));e.subscribe("install-error",(function(){t.emit("render",new l.BaseEvent({data:{type:T.getType()}}))}))}function Ae(e,t){Ue(e,t);t.add(e)}function De(e,t,i){Ue(e,t);t.set(e,i)}function Ue(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function Ve(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var qe=new WeakMap;var Je=new WeakMap;var Ke=new WeakMap;var Qe=new WeakSet;var Ye=new WeakSet;var Ze=new WeakSet;var $e=function(e){babelHelpers.inherits(t,e);function t(e){var i;babelHelpers.classCallCheck(this,t);i=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this));Ae(babelHelpers.assertThisInitialized(i),Ze);Ae(babelHelpers.assertThisInitialized(i),Ye);Ae(babelHelpers.assertThisInitialized(i),Qe);De(babelHelpers.assertThisInitialized(i),qe,{writable:true,value:void 0});De(babelHelpers.assertThisInitialized(i),Je,{writable:true,value:void 0});De(babelHelpers.assertThisInitialized(i),Ke,{writable:true,value:void 0});i.setEventNamespace("BX.Rest.EInvoiceInstaller");babelHelpers.classPrivateFieldSet(babelHelpers.assertThisInitialized(i),qe,e);i.render("selection");Ve(babelHelpers.assertThisInitialized(i),Ze,it).call(babelHelpers.assertThisInitialized(i)).getPageByType("selection").subscribe("start-install-app",Ve(babelHelpers.assertThisInitialized(i),Ye,tt).bind(babelHelpers.assertThisInitialized(i)));return i}babelHelpers.createClass(t,[{key:"render",value:function e(t){if(Ve(this,Ze,it).call(this).exist(t)){i.Dom.clean(babelHelpers.classPrivateFieldGet(this,qe).wrapper);var a=Ve(this,Ze,it).call(this).getPageByType(t);i.Dom.append(a.getContent(),babelHelpers.classPrivateFieldGet(this,qe).wrapper);if(t!=="error"){i.Dom.append(a.getIcon(),babelHelpers.classPrivateFieldGet(this,qe).wrapper)}}}}]);return t}(l.EventEmitter);function et(e){return i.ajax.runComponentAction("bitrix:rest.einvoice.installer","installApplicationByCode",{mode:"class",data:{code:e}})}function tt(e){Ve(this,Ze,it).call(this).getPageByType("install").emit("install-app",new l.BaseEvent({data:{source:this,code:e.data.code,name:e.data.name,install:Ve(this,Qe,et).call(this,e.data.code)}}))}function it(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,Je)){babelHelpers.classPrivateFieldSet(this,Je,new _e(babelHelpers.classPrivateFieldGet(this,qe)));babelHelpers.classPrivateFieldGet(this,Je).subscribe("render",(function(t){e.render(t.data.type)}))}return babelHelpers.classPrivateFieldGet(this,Je)}e.EInvoiceInstaller=$e})(this.BX.Rest=this.BX.Rest||{},BX,BX,BX.UI,BX.UI,BX.Event,BX.Rest,BX.Rest);
//# sourceMappingURL=script.map.js