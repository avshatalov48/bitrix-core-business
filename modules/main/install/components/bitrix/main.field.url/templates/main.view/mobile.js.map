{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nlet\n\tBX = window.BX,\n\tBXMobileApp = window.BXMobileApp;\n\nlet nodeUrl = (function ()\n{\n\tlet nodeUrl = function (node, container)\n\t{\n\t\tthis.node = node;\n\t\tthis.container = container;\n\t\tthis.nodeLink = this.node.previousElementSibling;\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tBX.bind(this.container, 'click', this.click);\n\t};\n\tnodeUrl.prototype = {\n\t\tclick(e)\n\t\t{\n\t\t\tif (e.toElement.tagName !== 'A')\n\t\t\t{\n\t\t\t\tthis.show();\n\t\t\t\treturn BX.PreventDefault(e);\n\t\t\t}\n\t\t},\n\t\tshow()\n\t\t{\n\t\t\twindow.app.exec('showPostForm', {\n\t\t\t\tattachButton: {items: []},\n\t\t\t\tattachFileSettings: {},\n\t\t\t\tattachedFiles: [],\n\t\t\t\textraData: {},\n\t\t\t\tmentionButton: {},\n\t\t\t\tsmileButton: {},\n\t\t\t\tmessage: {\n\t\t\t\t\ttext: BX.util.htmlspecialcharsback(this.nodeLink.value)\n\t\t\t\t},\n\t\t\t\tokButton: {\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tname: Loc.getMessage('interface_form_save')\n\t\t\t\t},\n\t\t\t\tcancelButton: {\n\t\t\t\t\tcallback: function ()\n\t\t\t\t\t{\n\t\t\t\t\t},\n\t\t\t\t\tname: Loc.getMessage('interface_form_cancel')\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcallback(data)\n\t\t{\n\t\t\tdata.text = (BX.util.htmlspecialchars(data.text) || '');\n\t\t\tif (data.text === '')\n\t\t\t{\n\t\t\t\tthis.node.textContent = this.nodeLink.getAttribute('placeholder');\n\t\t\t\tthis.node.setAttribute('href', '#');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.node.textContent = data.text;\n\t\t\t\tif (this.checkUrl(data.text))\n\t\t\t\t{\n\t\t\t\t\tthis.node.setAttribute('href', data.text);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.node.setAttribute('href', 'http://'+data.text);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.nodeLink.value = data.text;\n\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.nodeLink]);\n\t\t},\n\t\tcheckUrl(url)\n\t\t{\n\t\t\treturn /^(callto:|mailto:|https:\\/\\/|http:\\/\\/)/i.test(url);\n\t\t}\n\t};\n\treturn nodeUrl;\n})();\n\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.Url = function (params)\n{\n\tthis.init(params);\n};\n\nBX.Mobile.Field.Url.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\tresult = new nodeUrl(node, node.parentElement);\n\t\t}\n\t\treturn result;\n\t}\n};"],"names":["BX","window","BXMobileApp","nodeUrl","node","container","nodeLink","previousElementSibling","click","delegate","callback","bind","prototype","e","toElement","tagName","show","PreventDefault","app","exec","attachButton","items","attachFileSettings","attachedFiles","extraData","mentionButton","smileButton","message","text","util","htmlspecialcharsback","value","okButton","name","Loc","getMessage","cancelButton","data","htmlspecialchars","textContent","getAttribute","setAttribute","checkUrl","onCustomEvent","url","test","Mobile","Field","Url","params","init","__proto__","bindElement","result","parentElement"],"mappings":";;;;;;;CAEA,IACCA,EAAE,GAAGC,MAAM,CAACD,EAAE;GACdE,WAAW,GAAGD,MAAM,CAACC,WAAW;CAEjC,IAAIC,OAAO,GAAI,YACf;GACC,IAAIA,OAAO,GAAG,SAAVA,OAAO,CAAaC,IAAI,EAAEC,SAAS,EACvC;KACC,IAAI,CAACD,IAAI,GAAGA,IAAI;KAChB,IAAI,CAACC,SAAS,GAAGA,SAAS;KAC1B,IAAI,CAACC,QAAQ,GAAG,IAAI,CAACF,IAAI,CAACG,sBAAsB;KAChD,IAAI,CAACC,KAAK,GAAGR,EAAE,CAACS,QAAQ,CAAC,IAAI,CAACD,KAAK,EAAE,IAAI,CAAC;KAC1C,IAAI,CAACE,QAAQ,GAAGV,EAAE,CAACS,QAAQ,CAAC,IAAI,CAACC,QAAQ,EAAE,IAAI,CAAC;KAChDV,EAAE,CAACW,IAAI,CAAC,IAAI,CAACN,SAAS,EAAE,OAAO,EAAE,IAAI,CAACG,KAAK,CAAC;IAC5C;GACDL,OAAO,CAACS,SAAS,GAAG;KACnBJ,KAAK,iBAACK,CAAC,EACP;OACC,IAAIA,CAAC,CAACC,SAAS,CAACC,OAAO,KAAK,GAAG,EAC/B;SACC,IAAI,CAACC,IAAI,EAAE;SACX,OAAOhB,EAAE,CAACiB,cAAc,CAACJ,CAAC,CAAC;;MAE5B;KACDG,IAAI,kBACJ;OACCf,MAAM,CAACiB,GAAG,CAACC,IAAI,CAAC,cAAc,EAAE;SAC/BC,YAAY,EAAE;WAACC,KAAK,EAAE;UAAG;SACzBC,kBAAkB,EAAE,EAAE;SACtBC,aAAa,EAAE,EAAE;SACjBC,SAAS,EAAE,EAAE;SACbC,aAAa,EAAE,EAAE;SACjBC,WAAW,EAAE,EAAE;SACfC,OAAO,EAAE;WACRC,IAAI,EAAE5B,EAAE,CAAC6B,IAAI,CAACC,oBAAoB,CAAC,IAAI,CAACxB,QAAQ,CAACyB,KAAK;UACtD;SACDC,QAAQ,EAAE;WACTtB,QAAQ,EAAE,IAAI,CAACA,QAAQ;WACvBuB,IAAI,EAAEC,aAAG,CAACC,UAAU,CAAC,qBAAqB;UAC1C;SACDC,YAAY,EAAE;WACb1B,QAAQ,EAAE,oBACV,EACC;WACDuB,IAAI,EAAEC,aAAG,CAACC,UAAU,CAAC,uBAAuB;;QAE7C,CAAC;MACF;KACDzB,QAAQ,oBAAC2B,IAAI,EACb;OACCA,IAAI,CAACT,IAAI,GAAI5B,EAAE,CAAC6B,IAAI,CAACS,gBAAgB,CAACD,IAAI,CAACT,IAAI,CAAC,IAAI,EAAG;OACvD,IAAIS,IAAI,CAACT,IAAI,KAAK,EAAE,EACpB;SACC,IAAI,CAACxB,IAAI,CAACmC,WAAW,GAAG,IAAI,CAACjC,QAAQ,CAACkC,YAAY,CAAC,aAAa,CAAC;SACjE,IAAI,CAACpC,IAAI,CAACqC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC;QACnC,MAED;SACC,IAAI,CAACrC,IAAI,CAACmC,WAAW,GAAGF,IAAI,CAACT,IAAI;SACjC,IAAI,IAAI,CAACc,QAAQ,CAACL,IAAI,CAACT,IAAI,CAAC,EAC5B;WACC,IAAI,CAACxB,IAAI,CAACqC,YAAY,CAAC,MAAM,EAAEJ,IAAI,CAACT,IAAI,CAAC;UACzC,MAED;WACC,IAAI,CAACxB,IAAI,CAACqC,YAAY,CAAC,MAAM,EAAE,SAAS,GAACJ,IAAI,CAACT,IAAI,CAAC;;;OAGrD,IAAI,CAACtB,QAAQ,CAACyB,KAAK,GAAGM,IAAI,CAACT,IAAI;OAC/B5B,EAAE,CAAC2C,aAAa,CAAC,IAAI,EAAE,UAAU,EAAE,CAAC,IAAI,EAAE,IAAI,CAACrC,QAAQ,CAAC,CAAC;MACzD;KACDoC,QAAQ,oBAACE,GAAG,EACZ;OACC,OAAO,0CAA0C,CAACC,IAAI,CAACD,GAAG,CAAC;;IAE5D;GACD,OAAOzC,OAAO;CACf,CAAC,EAAG;CAEJF,MAAM,CAACiB,GAAG,CAACC,IAAI,CAAC,uBAAuB,EAAE,IAAI,CAAC;CAE9CnB,EAAE,CAAC8C,MAAM,CAACC,KAAK,CAACC,GAAG,GAAG,UAAUC,MAAM,EACtC;GACC,IAAI,CAACC,IAAI,CAACD,MAAM,CAAC;CAClB,CAAC;CAEDjD,EAAE,CAAC8C,MAAM,CAACC,KAAK,CAACC,GAAG,CAACpC,SAAS,GAAG;GAC/BuC,SAAS,EAAEnD,EAAE,CAAC8C,MAAM,CAACC,KAAK,CAACnC,SAAS;GACpCwC,WAAW,EAAE,qBAAUhD,IAAI,EAC3B;KACC,IAAIiD,MAAM,GAAG,IAAI;KACjB,IAAIrD,EAAE,CAACI,IAAI,CAAC,EACZ;OACCiD,MAAM,GAAG,IAAIlD,OAAO,CAACC,IAAI,EAAEA,IAAI,CAACkD,aAAa,CAAC;;KAE/C,OAAOD,MAAM;;CAEf,CAAC;;;;"}