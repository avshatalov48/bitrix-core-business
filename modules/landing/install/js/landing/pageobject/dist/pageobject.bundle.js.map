{"version":3,"file":"pageobject.bundle.js","sources":["../src/pageobject.js"],"sourcesContent":["import {Type, Cache} from 'main.core';\n\n/**\n * @memberOf BX.Landing\n */\nexport class PageObject\n{\n\tstatic cache = new Cache.MemoryCache();\n\tstatic instance = null;\n\tstore = {};\n\n\tstatic getInstance(): PageObject\n\t{\n\t\tif (Type.isNil(PageObject.instance))\n\t\t{\n\t\t\tPageObject.instance = new PageObject();\n\t\t}\n\n\t\treturn PageObject.instance;\n\t}\n\n\tstatic getRootWindow(): ?Window\n\t{\n\t\treturn this.cache.remember('rootWindow', () => {\n\t\t\tif (document.body.querySelector('.landing-ui-view'))\n\t\t\t{\n\t\t\t\treturn window;\n\t\t\t}\n\n\t\t\tif (window.parent.document.body.querySelector('.landing-ui-view'))\n\t\t\t{\n\t\t\t\treturn window.parent;\n\t\t\t}\n\n\t\t\treturn window.top;\n\t\t});\n\t}\n\n\tstatic getEditorWindow(): ?Window\n\t{\n\t\treturn this.cache.remember('editorWindow', () => {\n\t\t\tconst rootWindow = this.getRootWindow();\n\t\t\tconst rootDocument = rootWindow.document;\n\t\t\tconst editorFrame: HTMLIFrameElement = rootDocument.querySelector('.landing-ui-view');\n\n\t\t\tif (editorFrame && editorFrame.contentWindow)\n\t\t\t{\n\t\t\t\treturn editorFrame.contentWindow;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t});\n\t}\n\n\tstatic getTopPanel(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('topPanel', () => {\n\t\t\treturn this.getRootWindow().document.querySelector('.landing-ui-panel-top');\n\t\t});\n\t}\n\n\tstatic getEditPanelContent(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('editPanel', () => {\n\t\t\treturn this.getRootWindow()\n\t\t\t\t.document\n\t\t\t\t.querySelector(\n\t\t\t\t\t'.landing-ui-panel-content.landing-ui-panel-content-edit .landing-ui-panel-content-body-content'\n\t\t\t\t);\n\t\t});\n\t}\n\n\tstatic getStylePanelContent(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('stylePanel', () => {\n\t\t\treturn this.getRootWindow()\n\t\t\t\t.document\n\t\t\t\t.querySelector(\n\t\t\t\t\t'.landing-ui-panel-content.landing-ui-panel-style .landing-ui-panel-content-body-content'\n\t\t\t\t);\n\t\t});\n\t}\n\n\tstatic getBlocks(): BX.Landing.Collection.BlockCollection\n\t{\n\t\treturn this.getRootWindow().BX.Landing.Block.storage;\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see PageObject.getTopPanel()\n\t * @return {Promise}\n\t */\n\ttop(): ?HTMLDivElement\n\t{\n\t\treturn new Promise(((resolve, reject) => {\n\t\t\tif (!this.store.topPanel)\n\t\t\t{\n\t\t\t\tthis.store.topPanel = PageObject.getTopPanel();\n\t\t\t}\n\n\t\t\tif (this.store.topPanel)\n\t\t\t{\n\t\t\t\tresolve(this.store.topPanel);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treject(new Error('Top panel unavailable'));\n\t\t\tconsole.warn('Top panel unavailable');\n\t\t}));\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see BX.Landing.UI.Panel.StylePanel.getInstance()\n\t * @return {Promise}\n\t */\n\tdesign(): Promise<any>\n\t{\n\t\treturn Promise.resolve(BX.Landing.UI.Panel.StylePanel.getInstance());\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see BX.Landing.UI.Panel.ContentEdit.getInstance()\n\t * @return {Promise}\n\t */\n\tcontent(): Promise<any>\n\t{\n\t\treturn Promise.resolve(BX.Landing.UI.Panel.ContentEdit.getInstance());\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see BX.Landing.UI.Panel.EditorPanel.getInstance()\n\t * @return {Promise}\n\t */\n\tinlineEditor(): Promise<any>\n\t{\n\t\treturn Promise.resolve(BX.Landing.UI.Panel.EditorPanel.getInstance());\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see PageObject.getEditorWindow()\n\t * @return {Promise}\n\t */\n\tview(): HTMLIFrameElement\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!this.store.view)\n\t\t\t{\n\t\t\t\tconst rootWindow = PageObject.getRootWindow();\n\t\t\t\tthis.store.view = rootWindow.document.querySelector('.landing-ui-view');\n\t\t\t}\n\n\t\t\tif (this.store.view)\n\t\t\t{\n\t\t\t\tresolve(this.store.view);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treject(new Error('View iframe unavailable'));\n\t\t\tconsole.warn('View iframe unavailable');\n\t\t});\n\t}\n\n\t/**\n\t * @deprecated\n\t * @see BX.Landing.Block.storage\n\t * @return {Promise}\n\t */\n\tblocks(): Promise<Array<BX.Landing.Block>>\n\t{\n\t\treturn Promise.resolve(PageObject.getRootWindow().BX.Landing.Block.storage);\n\t}\n}\n"],"names":["PageObject","Promise","resolve","reject","store","topPanel","getTopPanel","Error","console","warn","BX","Landing","UI","Panel","StylePanel","getInstance","ContentEdit","EditorPanel","view","rootWindow","getRootWindow","document","querySelector","Block","storage","Type","isNil","instance","cache","remember","body","window","parent","top","rootDocument","editorFrame","contentWindow","Cache","MemoryCache"],"mappings":"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"}