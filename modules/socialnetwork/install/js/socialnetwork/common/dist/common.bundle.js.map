{"version":3,"file":"common.bundle.js","sources":["../src/waiter.js","../src/sonetgroupmenu.js","../src/recalljoinrequest.js","../src/common.js","../src/widget.js","../src/workgroupwidget.js","../src/index.js"],"sourcesContent":["import {Type} from 'main.core';\n\nexport class Waiter\n{\n\tstatic instance = null;\n\n\tstatic getInstance()\n\t{\n\t\tif (Type.isNull(Waiter.instance))\n\t\t{\n\t\t\tWaiter.instance = new Waiter();\n\t\t}\n\n\t\treturn Waiter.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.waitTimeout = null;\n\t\tthis.waitPopup = null;\n\n\t}\n\n\tshow(timeout)\n\t{\n\t\tif (timeout !== 0)\n\t\t{\n\t\t\treturn (this.waitTimeout = setTimeout(() => {\n\t\t\t\tthis.show(0);\n\t\t\t}, 50));\n\t\t}\n\n\t\tif (!this.waitPopup)\n\t\t{\n\t\t\tthis.waitPopup = new BX.PopupWindow('sonet_common_wait_popup', window, {\n\t\t\t\tautoHide: true,\n\t\t\t\tlightShadow: true,\n\t\t\t\tzIndex: 2,\n\t\t\t\tcontent: BX.create('DIV', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'sonet-wait-cont'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('DIV', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'sonet-wait-icon'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('DIV', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'sonet-wait-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.message('SONET_EXT_COMMON_WAIT')\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.waitPopup.setBindElement(window);\n\t\t}\n\n\t\tthis.waitPopup.show();\n\t}\n\n\thide()\n\t{\n\t\tif (this.waitTimeout)\n\t\t{\n\t\t\tclearTimeout(this.waitTimeout);\n\t\t\tthis.waitTimeout = null;\n\t\t}\n\n\t\tif (this.waitPopup)\n\t\t{\n\t\t\tthis.waitPopup.close();\n\t\t}\n\t}\n}\n","import {Type, Loc} from 'main.core';\n\nexport class SonetGroupMenu\n{\n\tstatic instance = null;\n\n\tconstructor()\n\t{\n\t\tthis.menuPopup = null;\n\t\tthis.menuItem = null;\n\t\tthis.favoritesValue = null;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (Type.isNull(this.instance))\n\t\t{\n\t\t\tthis.instance = new SonetGroupMenu();\n\n\t\t\tBX.addCustomEvent('SidePanel.Slider:onClose', () => {\n\t\t\t\tif (this.instance.menuPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.instance.menuPopup.close();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('BX.Socialnetwork.WorkgroupMenuIcon:onSetFavorites', (params) => {\n\t\t\t\tthis.getInstance().setItemTitle(params.value);\n\t\t\t});\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tsetItemTitle(value)\n\t{\n\t\tif (!Type.isDomNode(this.menuItem))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuItem.innerHTML = (value ? Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_REMOVE') : Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_ADD'));\n\t}\n}\n","import {Type, Loc, Dom, ajax} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {Button} from 'ui.buttons';\nimport {Waiter} from \"./waiter\";\n\nexport class RecallJoinRequest\n{\n\tconstructor(params)\n\t{\n\t\tthis.successPopup = null;\n\n\t\tthis.groupId = !Type.isUndefined(params.GROUP_ID) ? Number(params.GROUP_ID) : 0;\n\t\tthis.relationId = !Type.isUndefined(params.RELATION_ID) ? Number(params.RELATION_ID) : 0;\n\n\t\tthis.urls = {\n\t\t\trejectOutgoingRequest: Type.isStringFilled(params.URL_REJECT_OUTGOING_REQUEST) ? params.URL_REJECT_OUTGOING_REQUEST : '',\n\t\t\tgroupsList: Type.isStringFilled(params.URL_GROUPS_LIST) ? params.URL_GROUPS_LIST : '',\n\t\t};\n\t\tthis.project = Type.isBoolean(params.PROJECT) ? params.PROJECT : false;\n\t\tthis.scrum = Type.isBoolean(params.SCRUM) ? params.SCRUM : false;\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (\n\t\t\tthis.relationId <= 0\n\t\t\t|| !Type.isStringFilled(this.urls.rejectOutgoingRequest)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet recallTitle = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TITLE2');\n\t\tlet recallText = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TEXT2');\n\n\t\tif (this.scrum)\n\t\t{\n\t\t\trecallTitle = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TITLE2_SCRUM');\n\t\t\trecallText = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TEXT2_SCRUM');\n\t\t}\n\t\telse if (this.project)\n\t\t{\n\t\t\trecallTitle = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TITLE2_PROJECT');\n\t\t\trecallText = Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_TEXT2_PROJECT');\n\t\t}\n\n\t\tthis.successPopup = new Popup('bx-group-join-successfull-request-popup', window, {\n\t\t\twidth: 420,\n\t\t\tautoHide: false,\n\t\t\tlightShadow: false,\n\t\t\tzIndex: 1000,\n\t\t\toverlay: true,\n\t\t\tcachable: false,\n\t\t\tcontent: Dom.create('DIV', {\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('DIV', {\n\t\t\t\t\t\ttext: recallTitle,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'sonet-group-join-successfull-request-popup-title',\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tDom.create('DIV', {\n\t\t\t\t\t\ttext: recallText,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'sonet-group-join-successfull-request-popup-text',\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t}),\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\tsize: Button.Size.MEDIUM,\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_CLOSE_BUTTON'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (button) => {\n\t\t\t\t\t\t\tthis.onClose(button.getContainer());\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\tsize: Button.Size.MEDIUM,\n\t\t\t\t\tcolor: Button.Color.LINK,\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_COMMON_RECALL_JOIN_POPUP_CANCEL_BUTTON'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (button) => {\n\t\t\t\t\t\t\tthis.onCancelRequest(button.getContainer());\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t\tcloseByEsc: false,\n\t\t\tcloseIcon: false,\n\t\t});\n\n\t\tthis.successPopup.show();\n\t}\n\n\tonClose(button)\n\t{\n\t\tif (\n\t\t\tthis.groupId <= 0\n\t\t\t|| !Type.isDomNode(button)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tRecallJoinRequest.showButtonWait(button);\n\n\t\tajax.runAction('socialnetwork.api.usertogroup.setHideRequestPopup', {\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tRecallJoinRequest.hideButtonWait(button);\n\t\t\tthis.successPopup.close();\n\t\t}, () => {\n\t\t\tRecallJoinRequest.hideButtonWait(button);\n\t\t});\n\t}\n\n\tonCancelRequest(button)\n\t{\n\t\tif (\n\t\t\tthis.groupId <= 0\n\t\t\t|| !Type.isDomNode(button)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorNode = document.getElementById('bx-group-delete-request-error');\n\n\t\tRecallJoinRequest.hideError(errorNode);\n\t\tRecallJoinRequest.showButtonWait(button);\n\n\t\tajax.runAction('socialnetwork.api.usertogroup.cancelIncomingRequest', {\n\t\t\tdata: {\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tuserId: parseInt(Loc.getMessage('USER_ID')),\n\t\t\t},\n\t\t}).then((response) => {\n\n\t\t\tRecallJoinRequest.hideButtonWait(button);\n\n\t\t\tthis.successPopup.destroy();\n\t\t\tif (Type.isStringFilled(this.urls.groupsList))\n\t\t\t{\n\t\t\t\ttop.location.href = this.urls.groupsList;\n\t\t\t}\n\n\t\t\tthis.reload();\n\t\t}).catch((response) => {\n\t\t\tRecallJoinRequest.showError(Loc.getMessage('SONET_EXT_COMMON_AJAX_ERROR'), errorNode);\n//\t\t\tRecallJoinRequest.showError(deleteResponseData.ERROR_MESSAGE, errorNode);\n\t\t\tRecallJoinRequest.hideButtonWait(button);\n\t\t});\n\t}\n\n\tstatic showButtonWait(buttonNode)\n\t{\n\t\tif (Type.isStringFilled(buttonNode))\n\t\t{\n\t\t\tbuttonNode = document.getElementById(buttonNode);\n\t\t}\n\n\t\tif (!Type.isDomNode(buttonNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbuttonNode.classList.add('ui-btn-clock');\n\t\tbuttonNode.disabled = true;\n\t\tbuttonNode.style.cursor = 'auto';\n\t}\n\n\tstatic hideButtonWait(buttonNode)\n\t{\n\t\tif (Type.isStringFilled(buttonNode))\n\t\t{\n\t\t\tbuttonNode = document.getElementById(buttonNode);\n\t\t}\n\n\t\tif (!Type.isDomNode(buttonNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbuttonNode.classList.remove('ui-btn-clock');\n\t\tbuttonNode.disabled = false;\n\t\tbuttonNode.style.cursor = 'cursor';\n\t}\n\n\tstatic showError(errorText, errorNode)\n\t{\n\t\tif (Type.isStringFilled(errorNode))\n\t\t{\n\t\t\terrorNode = document.getElementById(errorNode);\n\t\t}\n\n\t\tif (!Type.isDomNode(errorNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\terrorNode.innerHTML = errorText;\n\t\terrorNode.classList.remove('sonet-ui-form-error-block-invisible');\n\t}\n\n\tstatic hideError(errorNode)\n\t{\n\t\tif (Type.isStringFilled(errorNode))\n\t\t{\n\t\t\terrorNode = document.getElementById(errorNode);\n\t\t}\n\n\t\tif (!Type.isDomNode(errorNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\terrorNode.classList.add('sonet-ui-form-error-block-invisible');\n\t}\n}\n","import { Type, Loc, ajax, Runtime } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport { Messenger } from 'im.public';\nimport { Waiter } from './waiter.js';\nimport { SonetGroupMenu } from './sonetgroupmenu.js';\nimport { RecallJoinRequest } from './recalljoinrequest.js';\n\nclass Common\n{\n\tstatic showGroupMenuPopup(params)\n\t{\n\t\tlet bindElement = params.bindElement;\n\t\tif (Type.isStringFilled(bindElement))\n\t\t{\n\t\t\tbindElement = document.getElementById(bindElement);\n\t\t}\n\n\t\tconst currentUserId = parseInt(Loc.getMessage('USER_ID'));\n\t\tconst sonetGroupMenu = SonetGroupMenu.getInstance();\n\n\t\tif (bindElement.tagName === 'BUTTON')\n\t\t{\n\t\t\tbindElement.classList.add('ui-btn-active');\n\t\t}\n\n\t\tconst menu = [];\n\t\tlet itemTitle = '';\n\n\t\tif (currentUserId > 0)\n\t\t{\n\t\t\tmenu.push({\n\t\t\t\ttext: (!!sonetGroupMenu.favoritesValue ? Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_REMOVE') : Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_ADD')),\n\t\t\t\ttitle: (!!sonetGroupMenu.favoritesValue ? Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_REMOVE') : Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FAVORITES_ADD')),\n\t\t\t\tid: 'set-group-favorite',\n\t\t\t\tonclick: () => {\n\n\t\t\t\t\tconst favoritesValue = sonetGroupMenu.favoritesValue;\n\n\t\t\t\t\tsonetGroupMenu.setItemTitle(!favoritesValue);\n\t\t\t\t\tsonetGroupMenu.favoritesValue = !favoritesValue;\n\n\t\t\t\t\tthis.setFavoritesAjax({\n\t\t\t\t\t\tgroupId: params.groupId,\n\t\t\t\t\t\tfavoritesValue: favoritesValue,\n\t\t\t\t\t\tcallback: {\n\t\t\t\t\t\t\tsuccess: (data) => {\n\n\t\t\t\t\t\t\t\tBX.onCustomEvent(window, 'BX.Socialnetwork.WorkgroupFavorites:onSet', [{\n\t\t\t\t\t\t\t\t\tid: params.groupId,\n\t\t\t\t\t\t\t\t\tname: data.NAME,\n\t\t\t\t\t\t\t\t\turl: data.URL,\n\t\t\t\t\t\t\t\t\textranet: (!Type.isUndefined(data.EXTRANET) ? data.EXTRANET : 'N'),\n\t\t\t\t\t\t\t\t}, !favoritesValue]);\n\n\t\t\t\t\t\t\t\tBX.onCustomEvent(window, 'BX.Socialnetwork.WorkgroupMenu:onSetFavorites', [{\n\t\t\t\t\t\t\t\t\tgroupId: params.groupId,\n\t\t\t\t\t\t\t\t\tvalue: !favoritesValue,\n\t\t\t\t\t\t\t\t}]);\n\n\t\t\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\t\t\t\t\t\tcode: 'afterSetFavorites',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tgroupId: data.ID,\n\t\t\t\t\t\t\t\t\t\tvalue: (data.RESULT === 'Y')\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfailure: () => {\n\t\t\t\t\t\t\t\tsonetGroupMenu.favoritesValue = favoritesValue;\n\t\t\t\t\t\t\t\tsonetGroupMenu.setItemTitle(favoritesValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (params.perms.canInitiate)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQU');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQU_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQU_PROJECT');\n\t\t\t\t}\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\thref: params.urls.requestUser,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.perms.canModify)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EDIT');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EDIT_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EDIT_PROJECT');\n\t\t\t\t}\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\thref: params.urls.edit,\n\t\t\t\t});\n\n\t\t\t\tif (!params.hideArchiveLinks)\n\t\t\t\t{\n\t\t\t\t\tconst featuresItem = {\n\t\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FEAT'),\n\t\t\t\t\t\ttitle: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_FEAT'),\n\t\t\t\t\t};\n\n\t\t\t\t\tif (params.editFeaturesAllowed)\n\t\t\t\t\t{\n\t\t\t\t\t\tfeaturesItem.href = params.urls.features;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfeaturesItem.className = 'menu-popup-item menu-popup-no-icon sonet-common-tariff-lock';\n\n\t\t\t\t\t\tfeaturesItem.onclick = () => {\n\t\t\t\t\t\t\tRuntime.loadExtension('socialnetwork.limit').then((exports) => {\n\t\t\t\t\t\t\t\tconst { Limit } = exports;\n\t\t\t\t\t\t\t\tLimit.showInstance({\n\t\t\t\t\t\t\t\t\tfeatureId: 'socialnetwork_projects_access_permissions',\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tmenu.push(featuresItem);\n\t\t\t\t}\n\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_DELETE');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_DELETE_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_DELETE_PROJECT');\n\t\t\t\t}\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\thref: params.urls.delete,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tmenu.push({\n\t\t\t\ttext: (params.perms.canModerate ? Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_MEMBERS_EDIT') : Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_MEMBERS_VIEW')),\n\t\t\t\ttitle: (params.perms.canModerate ? Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_MEMBERS_EDIT') : Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_MEMBERS_VIEW')),\n\t\t\t\thref: params.urls.members,\n\t\t\t});\n\n\t\t\tif (params.perms.canInitiate)\n\t\t\t{\n\t\t\t\tif (params.perms.canProcessRequestsIn)\n\t\t\t\t{\n\t\t\t\t\tmenu.push({\n\t\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQ_IN'),\n\t\t\t\t\t\ttitle: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQ_IN'),\n\t\t\t\t\t\thref: params.urls.requests,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQ_OUT');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQ_OUT_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_REQ_OUT_PROJECT');\n\t\t\t\t}\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\thref: params.urls.requestsOut,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.perms.canCreate)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_COPY');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_COPY_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_COPY_PROJECT');\n\t\t\t\t}\n\t\t\t\tconst copyGroupItem = {\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t}\n\t\t\t\tif (params.copyFeatureAllowed)\n\t\t\t\t{\n\t\t\t\t\tcopyGroupItem.href = params.urls.copy;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcopyGroupItem.className = 'menu-popup-item menu-popup-no-icon sonet-common-tariff-lock';\n\n\t\t\t\t\tcopyGroupItem.onclick = () => {\n\t\t\t\t\t\tRuntime.loadExtension('socialnetwork.limit').then((exports) => {\n\t\t\t\t\t\t\tconst { Limit } = exports;\n\t\t\t\t\t\t\tLimit.showInstance({\n\t\t\t\t\t\t\t\tfeatureId: 'socialnetwork_copy_project',\n\t\t\t\t\t\t\t\tlimitAnalyticsLabels: {\n\t\t\t\t\t\t\t\t\tmodule: 'socialnetwork',\n\t\t\t\t\t\t\t\t\tsource: 'projectCardActions',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (!params.isScrumProject) // todo remove after scrum copy will done\n\t\t\t\t{\n\t\t\t\t\tmenu.push(copyGroupItem);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\t!Type.isStringFilled(params.userRole)\n\t\t\t\t\t|| (\n\t\t\t\t\t\tparams.userRole === Loc.getMessage('USER_TO_GROUP_ROLE_REQUEST')\n\t\t\t\t\t\t&& params.initiatedByType === Loc.getMessage('USER_TO_GROUP_INITIATED_BY_GROUP')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t&& !params.hideArchiveLinks\n\t\t\t)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_JOIN');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_JOIN_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_JOIN_PROJECT');\n\t\t\t\t}\n\t\t\t\tconst userRequestItem = {\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t};\n\n\t\t\t\tif (!!params.isOpened)\n\t\t\t\t{\n\t\t\t\t\tuserRequestItem.onclick = () => {\n\t\t\t\t\t\tthis.sendJoinRequest(params);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuserRequestItem.href = params.urls.userRequestGroup;\n\t\t\t\t}\n\t\t\t\tmenu.push(userRequestItem);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.userRole)\n\t\t\t\t&& params.userRole === Loc.getMessage('USER_TO_GROUP_ROLE_REQUEST')\n\t\t\t\t&& params.initiatedByType === Loc.getMessage('USER_TO_GROUP_INITIATED_BY_USER')\n\t\t\t\t&& parseInt(params.initiatedByUserId) === currentUserId\n\t\t\t)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_DELETE_REQUEST');\n\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.cancelIncomingRequest(params);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\tType.isBoolean(params.perms.canLeave)\n\t\t\t\t\t&& params.perms.canLeave\n\t\t\t\t)\n\t\t\t\t||\n\t\t\t\t(\n\t\t\t\t\t!Type.isBoolean(params.perms.canLeave)\n\t\t\t\t\t&& params.userIsMember\n\t\t\t\t\t&& !params.userIsAutoMember\n\t\t\t\t\t&& params.userRole !== Loc.getMessage('USER_TO_GROUP_ROLE_OWNER')\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EXIT');\n\t\t\t\tif (!!params.isScrumProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EXIT_SCRUM');\n\t\t\t\t}\n\t\t\t\telse if (!!params.isProject)\n\t\t\t\t{\n\t\t\t\t\titemTitle = Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_EXIT_PROJECT');\n\t\t\t\t}\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: itemTitle,\n\t\t\t\t\ttitle: itemTitle,\n\t\t\t\t\thref: params.urls.userLeaveGroup\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.canPickTheme)\n\t\t\t{\n\t\t\t\tmenu.push({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_THEME_DIALOG'),\n\t\t\t\t\ttitle: Loc.getMessage('SONET_EXT_COMMON_GROUP_MENU_THEME_DIALOG'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst popup = MenuManager.create('group-profile-menu', bindElement, menu, {\n\t\t\toffsetTop: 5,\n\t\t\toffsetLeft : (bindElement.offsetWidth - 18),\n\t\t\tangle : true,\n\t\t\tevents : {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tif (bindElement.tagName === 'BUTTON')\n\t\t\t\t\t{\n\t\t\t\t\t\tbindElement.classList.remove('ui-btn-active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst item = popup.getMenuItem('set-group-favorite');\n\t\tif (item)\n\t\t{\n\t\t\tsonetGroupMenu.menuItem = item.layout.text;\n\t\t}\n\n\t\tpopup.popupWindow.show();\n\t\tsonetGroupMenu.menuPopup = popup;\n\t}\n\n\tstatic sendJoinRequest(params)\n\t{\n\t\tWaiter.getInstance().show();\n\n\t\tif (\n\t\t\tSonetGroupMenu.getInstance()\n\t\t\t&& SonetGroupMenu.getInstance().menuPopup\n\t\t)\n\t\t{\n\t\t\tSonetGroupMenu.getInstance().menuPopup.close();\n\t\t}\n\n\t\tajax({\n\t\t\turl: params.urls.userRequestGroup,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tgroupID: params.groupId,\n\t\t\t\tMESSAGE: '',\n\t\t\t\tajax_request: 'Y',\n\t\t\t\tsave: 'Y',\n\t\t\t\tsessid: Loc.getMessage('bitrix_sessid'),\n\t\t\t},\n\t\t\tonsuccess: (responseData) => {\n\t\t\t\tWaiter.getInstance().hide();\n\t\t\t\tif (\n\t\t\t\t\tType.isStringFilled(responseData.MESSAGE)\n\t\t\t\t\t&& responseData.MESSAGE === 'SUCCESS'\n\t\t\t\t\t&& Type.isStringFilled(responseData.URL)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tBX.onCustomEvent(window.top, 'sonetGroupEvent', [ {\n\t\t\t\t\t\tcode: 'afterJoinRequestSend',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tgroupId: params.groupId\n\t\t\t\t\t\t}\n\t\t\t\t\t} ]);\n\t\t\t\t\ttop.location.href = responseData.URL;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonfailure: () => {\n\t\t\t\tWaiter.getInstance().hide();\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic cancelIncomingRequest(params)\n\t{\n\t\tWaiter.getInstance().show();\n\n\t\tif (\n\t\t\tSonetGroupMenu.getInstance()\n\t\t\t&& SonetGroupMenu.getInstance().menuPopup\n\t\t)\n\t\t{\n\t\t\tSonetGroupMenu.getInstance().menuPopup.close();\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.usertogroup.cancelIncomingRequest', {\n\t\t\tdata: {\n\t\t\t\tgroupId: params.groupId,\n\t\t\t\tuserId: parseInt(Loc.getMessage('USER_ID')),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tWaiter.getInstance().hide();\n\n\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\tcode: 'afterIncomingRequestCancel',\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: params.groupId,\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.reload();\n\t\t}).catch((response) => {\n\t\t\tWaiter.getInstance().hide();\n\t\t});\n\t}\n\n\tstatic setFavoritesAjax(params)\n\t{\n\t\tajax.runAction('socialnetwork.api.workgroup.setFavorites', {\n\t\t\tdata: {\n\t\t\t\tparams: {\n\t\t\t\t\tgroupId: params.groupId,\n\t\t\t\t\tvalue: (params.favoritesValue === false ? 'Y' : 'N'),\n\t\t\t\t\tgetAdditionalResultData: true,\n\t\t\t\t}\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (params.favoritesValue ? 'removeFavSonetGroup' : 'addFavSonetGroup')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tparams.callback.success(response.data);\n\t\t}).catch((response) => {\n\t\t\tparams.callback.failure({\n\t\t\t\tERROR: response.errors[0].message,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic reload()\n\t{\n\t\tif (top !== window) // current page in slider\n\t\t{\n\t\t\tif (!Type.isUndefined(top.BX.SidePanel))\n\t\t\t{\n\t\t\t\ttop.BX.SidePanel.Instance.getSliderByWindow(window).showLoader();\n\t\t\t}\n\t\t\twindow.location.reload();\n\t\t}\n\t\telse if (\n\t\t\t!Type.isUndefined(top.BX.SidePanel)\n\t\t\t&& top.BX.SidePanel.Instance.isOpen()\n\t\t) // there's an open slider\n\t\t{\n\t\t\ttop.location.href = top.BX.SidePanel.Instance.getPageUrl();\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttop.location.reload();\n\t\t}\n\t}\n\n\tstatic reloadBlock(params)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| !Type.isStringFilled(params.blockId)\n\t\t\t|| !document.getElementById(params.blockId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet url = '';\n\n\t\tif (\n\t\t\t!Type.isUndefined(top.BX.SidePanel)\n\t\t\t&& top.BX.SidePanel.Instance.isOpen()\n\t\t) // there's an open slider\n\t\t{\n\t\t\turl = top.BX.SidePanel.Instance.getPageUrl();\n\t\t}\n\t\telse\n\t\t{\n\t\t\turl = window.location.href;\n\t\t}\n\n\t\tajax.promise({\n\t\t\turl: url,\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata: {\n\t\t\t\tBLOCK_RELOAD: 'Y',\n\t\t\t\tBLOCK_ID: params.blockId\n\t\t\t}\n\t\t}).then((data) => {\n\t\t\tif (!Type.isUndefined(data.CONTENT))\n\t\t\t{\n\t\t\t\tdocument.getElementById(params.blockId).innerHTML = data.CONTENT;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tajax.processRequestData(data.CONTENT, {\n\t\t\t\t\t\tdataType: 'HTML'\n\t\t\t\t\t});\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic closeGroupCardMenu(node)\n\t{\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst doc = node.ownerDocument;\n\t\tconst win = doc.defaultView || doc.parentWindow;\n\n\t\tif (\n\t\t\t!win\n\t\t\t|| Type.isUndefined(win.BX.Socialnetwork.UIGroupMenu)\n\t\t\t|| !win.BX.Socialnetwork.UIGroupMenu.getInstance().menuPopup\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\twin.BX.Socialnetwork.UIGroupMenu.getInstance().menuPopup.close();\n\t}\n\n\tstatic openMessenger(groupId: number): Promise\n\t{\n\t\treturn ajax.runAction('socialnetwork.api.workgroup.getChatId', {\n\t\t\tdata: {\n\t\t\t\tgroupId: parseInt(groupId, 10),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tMessenger.openChat(`chat${parseInt(response.data, 10)}`);\n\t\t\t}\n\t\t}).catch(() => {});\n\t}\n\n\tstatic showError = RecallJoinRequest.showError;\n\tstatic hideError = RecallJoinRequest.hideError;\n\tstatic showButtonWait = RecallJoinRequest.showButtonWait;\n\tstatic hideButtonWait = RecallJoinRequest.hideButtonWait;\n}\n\nexport {\n\tCommon,\n\tRecallJoinRequest,\n}\n\n","import {Type} from 'main.core';\n\nexport class Widget\n{\n\tconstructor()\n\t{\n\t\tthis.widget = null;\n\t}\n\n\tshow(targetNode: HTMLElement)\n\t{\n\t\tif (this.widget)\n\t\t{\n\t\t\tif (this.widget.isShown())\n\t\t\t{\n\t\t\t\tthis.widget.close();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst data = this.getData({\n\t\t\ttargetNode: targetNode,\n\t\t});\n\n\t\tif (Type.isNull(data))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.widget = this.getWidget({\n\t\t\ttargetNode: targetNode,\n\t\t\tdata: data,\n\t\t});\n\n\t\tif (this.widget)\n\t\t{\n\t\t\tthis.widget.show();\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tif (\n\t\t\tthis.widget\n\t\t\t&& this.widget.isShown()\n\t\t)\n\t\t{\n\t\t\tthis.widget.close();\n\t\t}\n\t}\n\n\tgetData(params)\n\t{\n\t\treturn {};\n\t}\n\n\tgetWidget(params)\n\t{\n\t\treturn null;\n\t}\n}\n","import { Type, Tag, Loc, Event, Runtime } from 'main.core';\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\n\nimport {Widget} from './widget';\n\nexport class WorkgroupWidget extends Widget\n{\n\tconstructor(params) {\n\t\tsuper();\n\n\t\tthis.groupId = (!Type.isUndefined(params.groupId) ? parseInt(params.groupId) : 0);\n\t\tthis.avatarPath = (Type.isStringFilled(params.avatarPath) ? params.avatarPath : '');\n\t\tthis.avatarType = (Type.isStringFilled(params.avatarType) ? params.avatarType : '');\n\t\tthis.projectTypeCode = (Type.isStringFilled(params.projectTypeCode) ? params.projectTypeCode : '');\n\t\tthis.urls = (Type.isPlainObject(params.urls) ? params.urls : {});\n\t\tthis.perms = (Type.isPlainObject(params.perms) ? params.perms : {});\n\t\tthis.editRolesAllowed = Type.isBoolean(params.editRolesAllowed) ? params.editRolesAllowed : false;\n\t}\n\n\tgetData(params)\n\t{\n\t\tlet data = null;\n\n\t\tconst targetNode = params.targetNode;\n\t\tif (!Type.isDomNode(targetNode))\n\t\t{\n\t\t\treturn data;\n\t\t}\n\n\t\tdata = targetNode.getAttribute('data-workgroup');\n\t\ttry\n\t\t{\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tdata = null;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tgetWidget(params)\n\t{\n\t\tconst targetNode = (Type.isDomNode(params.targetNode) ? params.targetNode : null);\n\t\tif (!targetNode)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst data = (Type.isPlainObject(params.data) ? params.data : {});\n\n\t\treturn new PopupComponentsMaker({\n\t\t\ttarget: targetNode,\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderAbout(data)\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderMembers(data),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.renderRoles(data),\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\t}\n\n\trenderAbout()\n\t{\n\t\tlet avatar = '<i></i>';\n\t\tif (Type.isStringFilled(this.avatarPath))\n\t\t{\n\t\t\tavatar = `<i style=\"background: #fff url('${encodeURI(this.avatarPath)}') no-repeat; background-size: cover;\"></i>`;\n\t\t}\n\n\t\tlet title = '';\n\t\tlet description = '';\n\n\t\tswitch (this.projectTypeCode.toLowerCase())\n\t\t{\n\t\t\tcase 'project':\n\t\t\t\ttitle = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_TITLE_PROJECT');\n\t\t\t\tdescription = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_DESCRIPTION_PROJECT');\n\t\t\t\tbreak;\n\t\t\tcase 'scrum':\n\t\t\t\ttitle = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_TITLE_SCRUM');\n\t\t\t\tdescription = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_DESCRIPTION_SCRUM');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttitle = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_TITLE_GROUP');\n\t\t\t\tdescription = Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ABOUT_DESCRIPTION_GROUP');\n\t\t}\n\n\t\tconst classList = [\n\t\t\t'sonet-common-widget-avatar',\n\t\t];\n\t\tif (\n\t\t\t!Type.isStringFilled(this.avatarPath)\n\t\t\t&& Type.isStringFilled(this.avatarType)\n\t\t)\n\t\t{\n\t\t\tclassList.push('sonet-common-workgroup-avatar');\n\t\t\tclassList.push(`--${this.avatarType}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tclassList.push('ui-icon');\n\t\t\tclassList.push('ui-icon-common-user-group');\n\t\t}\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sonet-common-widget-item\">\n\t\t\t\t<div class=\"sonet-common-widget-item-container\">\n\t\t\t\t\t<div class=\"${classList.join(' ')}\">${avatar}</div>\n\t\t\t\t\t<div class=\"sonet-common-widget-item-content\">\n\t\t\t\t\t\t<div class=\"sonet-common-widget-item-title\">${title}</div>\n\t\t\t\t\t\t<div class=\"sonet-common-widget-item-description\">${description}</div>\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => {\n\t\t\tif (!Type.isStringFilled(this.urls.card))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.SidePanel.Instance.open(this.urls.card, {\n\t\t\t\twidth: 900,\n\t\t\t\tloader: 'socialnetwork:group-card',\n\t\t\t});\n\n\t\t\tthis.hide();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\trenderMembers()\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sonet-common-widget-item\">\n\t\t\t\t<div class=\"sonet-common-widget-item-container\">\n\t\t\t\t\t<div class=\"sonet-common-widget-icon ui-icon ui-icon-common-light-company\"><i></i></div>\n\t\t\t\t\t<div class=\"sonet-common-widget-item-content\">\n\t\t\t\t\t\t<div class=\"sonet-common-widget-item-title\">${Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_MEMBERS_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => {\n\t\t\tif (!Type.isStringFilled(this.urls.members))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.SidePanel.Instance.open(this.urls.members, {\n\t\t\t\twidth: 1200,\n\t\t\t\tloader: 'group-users-loader'\n\t\t\t});\n\n\t\t\tthis.hide();\n\t\t});\n\n\t\treturn node;\n\t}\n\n\trenderRoles()\n\t{\n\t\tconst canOpen = (\n\t\t\tType.isBoolean(this.perms.canModify)\n\t\t\t&& this.perms.canModify\n\t\t);\n\n\t\tconst hint = (!canOpen ? `data-hint=\"${Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ROLES_TITLE_NO_PERMISSIONS')}\" data-hint-no-icon` : '');\n\n\t\tconst contentClass = (\n\t\t\tthis.editRolesAllowed\n\t\t\t\t? 'sonet-common-widget-item-content'\n\t\t\t\t: 'sonet-common-widget-item-content-lock'\n\t\t);\n\t\tconst hiddenClass = (\n\t\t\tthis.editRolesAllowed\n\t\t\t\t? '--hidden'\n\t\t\t\t: ''\n\t\t);\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sonet-common-widget-item\" ${hint}>\n\t\t\t\t<div class=\"sonet-common-widget-item-container\">\n\t\t\t\t\t<div class=\"sonet-common-widget-icon ui-icon ui-icon-service-light-roles-rights\"><i></i></div>\n\t\t\t\t\t<div class=\"${contentClass}\">\n\t\t\t\t\t\t<div class=\"sonet-common-widget-item-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('SONET_EXT_COMMON_WORKGROUP_WIDGET_ROLES_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"sonet-common-widget-item-tariff-lock ${hiddenClass}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => {\n\t\t\tif (\n\t\t\t\t!canOpen\n\t\t\t\t|| !Type.isStringFilled(this.urls.features)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.editRolesAllowed)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(this.urls.features, {\n\t\t\t\t\twidth: 800,\n\t\t\t\t\tloader: 'group-features-loader',\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\tRuntime.loadExtension('socialnetwork.limit').then((exports) => {\n\t\t\t\t\tconst { Limit } = exports;\n\t\t\t\t\tLimit.showInstance({\n\t\t\t\t\t\tfeatureId: 'socialnetwork_projects_access_permissions',\n\t\t\t\t\t\tlimitAnalyticsLabels: {\n\t\t\t\t\t\t\tmodule: 'socialnetwork',\n\t\t\t\t\t\t\tsource: 'projectWidget',\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.hide();\n\t\t});\n\n\t\treturn node;\n\t}\n}\n","import {Common} from './common.js';\nimport {Waiter} from './waiter.js';\nimport {SonetGroupMenu} from './sonetgroupmenu.js';\nimport {WorkgroupWidget} from './workgroupwidget.js';\nimport {RecallJoinRequest} from './recalljoinrequest.js';\n\nexport {\n\tCommon,\n\tWaiter,\n\tSonetGroupMenu,\n\tWorkgroupWidget,\n\tRecallJoinRequest,\n}\n\n/** @deprecated use BX.Socialnetwork.UI.Common */\nBX.SocialnetworkUICommon = Common;\n\n/** @deprecated use BX.Socialnetwork.UI.Waiter */\nBX.SocialnetworkUICommon.Waiter = Waiter;\n\n/** @deprecated use BX.Socialnetwork.UI.GroupMenu */\nBX.SocialnetworkUICommon.SonetGroupMenu = SonetGroupMenu;\n\n/** @deprecated use BX.Socialnetwork.UI.WorkgroupWidget */\nBX.Socialnetwork.UIWorkgroupWidget = WorkgroupWidget;\n"],"names":["Waiter","Type","isNull","instance","waitTimeout","waitPopup","timeout","setTimeout","show","BX","PopupWindow","window","autoHide","lightShadow","zIndex","content","create","props","className","children","html","message","setBindElement","clearTimeout","close","SonetGroupMenu","menuPopup","menuItem","favoritesValue","value","isDomNode","innerHTML","Loc","getMessage","addCustomEvent","params","getInstance","setItemTitle","RecallJoinRequest","successPopup","groupId","isUndefined","GROUP_ID","Number","relationId","RELATION_ID","urls","rejectOutgoingRequest","isStringFilled","URL_REJECT_OUTGOING_REQUEST","groupsList","URL_GROUPS_LIST","project","isBoolean","PROJECT","scrum","SCRUM","recallTitle","recallText","Popup","width","overlay","cachable","Dom","text","buttons","Button","size","Size","MEDIUM","events","click","button","onClose","getContainer","color","Color","LINK","onCancelRequest","closeByEsc","closeIcon","showButtonWait","ajax","runAction","data","then","response","hideButtonWait","errorNode","document","getElementById","hideError","userId","parseInt","destroy","top","location","href","reload","showError","buttonNode","classList","add","disabled","style","cursor","remove","errorText","Common","bindElement","currentUserId","sonetGroupMenu","tagName","menu","itemTitle","push","title","id","onclick","setFavoritesAjax","callback","success","onCustomEvent","name","NAME","url","URL","extranet","EXTRANET","SidePanel","Instance","postMessageAll","code","ID","RESULT","failure","perms","canInitiate","isScrumProject","isProject","requestUser","canModify","edit","hideArchiveLinks","featuresItem","editFeaturesAllowed","features","Runtime","loadExtension","exports","Limit","showInstance","featureId","canModerate","members","canProcessRequestsIn","requests","requestsOut","canCreate","copyGroupItem","copyFeatureAllowed","copy","limitAnalyticsLabels","module","source","userRole","initiatedByType","userRequestItem","isOpened","sendJoinRequest","userRequestGroup","initiatedByUserId","cancelIncomingRequest","canLeave","userIsMember","userIsAutoMember","userLeaveGroup","canPickTheme","Intranet","Bitrix24","ThemePicker","Singleton","showDialog","popup","MenuManager","offsetTop","offsetLeft","offsetWidth","angle","onPopupClose","item","getMenuItem","layout","popupWindow","method","dataType","groupID","MESSAGE","ajax_request","save","sessid","onsuccess","responseData","hide","onfailure","getAdditionalResultData","analyticsLabel","b24statAction","ERROR","errors","getSliderByWindow","showLoader","isOpen","getPageUrl","isPlainObject","blockId","promise","BLOCK_RELOAD","BLOCK_ID","CONTENT","processRequestData","node","doc","ownerDocument","win","defaultView","parentWindow","Socialnetwork","UIGroupMenu","Messenger","openChat","Widget","widget","targetNode","isShown","getData","getWidget","WorkgroupWidget","avatarPath","avatarType","projectTypeCode","editRolesAllowed","getAttribute","JSON","parse","err","PopupComponentsMaker","target","renderAbout","renderMembers","renderRoles","avatar","encodeURI","description","toLowerCase","Tag","render","join","Event","bind","card","open","loader","canOpen","hint","contentClass","hiddenClass","SocialnetworkUICommon","UIWorkgroupWidget"],"mappings":"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"}