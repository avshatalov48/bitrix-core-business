{"version":3,"file":"binding.bundle.js","sources":["../src/item.js","../src/binding.js"],"sourcesContent":["import { Loc, Tag } from 'main.core';\nimport {UI} from 'ui.notification';\n\nexport class Item\n{\n\t#text;\n\t#active = false;\n\t#id;\n\t#href;\n\t#bindingType;\n\t#wait = false;\n\t#node;\n\t#messageId;\n\t#messageSimpleId;\n\t#createHref;\n\t#waitCSSClassName = 'ui-btn-wait';\n\t#errorType;\n\n\t#phrases = {\n\t\t'crm' : 'MAIL_BINDING_CRM_',\n\t\t'chat' : 'MAIL_BINDING_CHAT_',\n\t\t'task' : 'MAIL_BINDING_TASK_',\n\t\t'post' : 'MAIL_BINDING_POST_',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_'\n\t}\n\n\tstatic #errorPhrases = {\n\t\t'crm-install-error' : 'MAIL_BINDING_CRM_ERROR',\n\t\t'calendar-install-error' : 'MAIL_BINDING_MEETING_ERROR_MSGVER_1',\n\t\t'tasks-install-error' : 'MAIL_BINDING_TASK_ERROR',\n\t\t'chat-install-error' : 'MAIL_BINDING_CHAT_ERROR_MSGVER_1',\n\t\t'socialnetwork-install-error' : 'MAIL_BINDING_POST_ERROR_MSGVER_1',\n\t\t'crm-install-permission-error' : 'MAIL_BINDING_CRM_PERMISSION_SAVE_ERROR',\n\t\t'crm-install-permission-open-error' : 'MAIL_BINDING_CRM_PERMISSION_OPEN_ERROR',\n\t\t'crm-install-permission-working-error' :'MAIL_BINDING_CRM_PERMISSION_WORKING_ERROR',\n\t}\n\n\t#phrasesFull = {\n\t\t'crm' : 'MAIL_BINDING_CRM_TITLE',\n\t\t'chat' : 'MAIL_BINDING_CHAT_TITLE',\n\t\t'task' : 'MAIL_BINDING_TASK_TITLE',\n\t\t'post' : 'MAIL_BINDING_POST_TITLE',\n\t\t'meeting' : 'MAIL_BINDING_MEETING_TITLE'\n\t}\n\n\t#classes = {\n\t\t'crm' : 'mail-binding-crm',\n\t\t'chat' : 'mail-binding-chat',\n\t\t'task' : 'mail-binding-task',\n\t\t'post' : 'mail-binding-post',\n\t\t'meeting' : 'mail-binding-meeting'\n\t}\n\n\tisError(errorKey)\n\t{\n\t\tif(Item.#errorPhrases[errorKey] !== undefined)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.#active;\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetMessageId(simple = false)\n\t{\n\t\tif(!simple)\n\t\t{\n\t\t\treturn this.#messageId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#messageSimpleId;\n\t\t}\n\t}\n\n\tconstructor(config = {\n\t\ttype: '',\n\t\tid: '',\n\t})\n\t{\n\t\tthis.#errorType = config['errorType'];\n\t\tthis.#messageId = config['messageId'];\n\t\tthis.#id = config['id'];\n\t\tthis.#href = config['href'];\n\t\tthis.#bindingType = config['type'];\n\t\tthis.#messageSimpleId = config['messageSimpleId'];\n\t\tthis.#createHref =  config['createHref'];\n\n\t\tif(this.#id)\n\t\t{\n\t\t\tthis.#active = true;\n\t\t}\n\n\t\tif(this.isActive())\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'ACTIVE');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#text = Loc.getMessage(this.#phrases[this.#bindingType]+'NOT_ACTIVE' + this.getVersionNotActivePhrase());\n\t\t}\n\t}\n\n\tgetType()\n\t{\n\t\treturn this.#bindingType;\n\t}\n\n\tstatic showError(key)\n\t{\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage(Item.#errorPhrases[key]),\n\t\t});\n\t}\n\n\tonClick(event)\n\t{\n\t\tif (this.isError(this.#errorType))\n\t\t{\n\t\t\tItem.showError(this.#errorType);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isActive())\n\t\t{\n\t\t\tswitch (this.getType())\n\t\t\t{\n\t\t\t\t//to join the chat if you left it\n\t\t\t\tcase 'chat':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'task':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).onTaskAction('task_view', 'view_button');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse if (!this.#wait)\n\t\t{\n\t\t\tswitch (this.getType())\n\t\t\t{\n\t\t\t\tcase 'crm':\n\t\t\t\t\tthis.startWait();\n\t\t\t\t\tBX.Mail.Client.Message.List[\"mail-client-list-manager\"].onCrmClick(this.getMessageId());\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'chat':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openChat();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'task':\n\t\t\t\t\tconst uri = BX.Uri.addParam(this.#createHref, {\n\t\t\t\t\t\tta_sec: 'mail',\n\t\t\t\t\t\tta_el: 'create_button',\n\t\t\t\t\t});\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(uri);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'post':\n\t\t\t\t\ttop.BX.SidePanel.Instance.open(this.#createHref);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'meeting':\n\t\t\t\t\tBX.Mail.Secretary.getInstance(this.getMessageId(true)).openCalendarEvent();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHref()\n\t{\n\t\treturn this.#href;\n\t}\n\n\tsetText(text)\n\t{\n\t\tthis.#node.textContent = text;\n\t}\n\n\tgetNode()\n\t{\n\t\treturn this.#node;\n\t}\n\n\tstartWait()\n\t{\n\t\tthis.#wait = true;\n\t\tthis.getNode().classList.add(this.#waitCSSClassName);\n\t}\n\n\tstopWait()\n\t{\n\t\tthis.#wait = false;\n\t\tthis.getNode().classList.remove(this.#waitCSSClassName);\n\t}\n\n\tsetActive(href)\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.remove(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.add(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(this.#phrases[this.getType()]+'ACTIVE'));\n\t\tthis.getNode().setAttribute(\"href\", href);\n\t\tthis.#active = true;\n\t\tthis.updateTitle();\n\t}\n\n\tdeactivation()\n\t{\n\t\tthis.stopWait();\n\t\tthis.getNode().classList.add(\"mail-ui-not-active\");\n\t\tthis.getNode().classList.remove(\"mail-ui-active\");\n\t\tthis.setText(Loc.getMessage(`${this.#phrases[this.getType()]}NOT_ACTIVE${this.getVersionNotActivePhrase()}`));\n\t\tthis.getNode().removeAttribute(\"href\");\n\t\tthis.#active = false;\n\t\tthis.updateTitle();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn Loc.getMessage(this.#phrasesFull[this.getType()]+(this.isActive() ? '_ACTIVE' :''));\n\t}\n\n\tupdateTitle()\n\t{\n\t\tthis.getNode().removeAttribute(\"title\");\n\t\tthis.getNode().setAttribute(\"title\", this.getTitle());\n\t}\n\n\trender()\n\t{\n\t\tconst activeClass = this.isActive() ? 'mail-ui-active' : 'mail-ui-not-active';\n\t\tconst item = Tag.render`\n\t\t\t<a class=\"mail-ui-binding ui-btn-light-border ui-btn ui-btn-xs ui-btn-round ui-btn-no-caps ${this.#classes[this.getType()]} ${activeClass} js-bind-${this.getMessageId(true)}\">\n\t\t\t\t${this.#text}\n\t\t\t</a>`\n\n\t\tthis.#node = item;\n\t\tthis.#node.object = this;\n\n\t\tthis.updateTitle();\n\n\t\titem.onclick = function()\n\t\t{\n\t\t\tthis.object.onClick();\n\t\t};\n\n\t\titem.ondblclick = event => {\n\t\t\tevent.stopPropagation();\n\t\t};\n\n\t\titem.setActive = function(href)\n\t\t{\n\t\t\tthis.object.setActive(href);\n\t\t};\n\n\t\titem.deactivation = function()\n\t\t{\n\t\t\tthis.object.deactivation();\n\t\t};\n\n\t\titem.startWait = function()\n\t\t{\n\t\t\tthis.object.startWait();\n\t\t};\n\n\t\titem.stopWait = function()\n\t\t{\n\t\t\tthis.object.stopWait();\n\t\t};\n\n\t\tif(this.#errorType === 'crm-install-permission-error' && this.getHref())\n\t\t{\n\t\t\tthis.#errorType = 'crm-install-permission-open-error';\n\t\t}\n\n\t\tif(this.isActive() && !this.isError(this.#errorType))\n\t\t{\n\t\t\titem.setAttribute(\"href\", this.getHref());\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tgetVersionNotActivePhrase()\n\t{\n\t\treturn {\n\t\t\t'meeting': '_MSG_1',\n\t\t}[this.getType()] || '';\n\t}\n}\n\n","import { Tag } from 'main.core';\nimport { Loc } from 'main.core';\nimport { Item } from './item.js';\nimport { EventEmitter } from \"main.core.events\";\n\nexport class Binding\n{\n\t#mailboxId;\n\n\t#selectors = {\n\t\tCRM_ACTIVITY: '.mail-binding-crm',\n\t\tTASKS_TASK: '.mail-binding-task',\n\t\tIM_CHAT: '.mail-binding-chat',\n\t\tBLOG_POST: '.mail-binding-post',\n\t\tCALENDAR_EVENT: '.mail-binding-meeting',\n\t};\n\n\tgetMailbox()\n\t{\n\t\treturn this.#mailboxId;\n\t}\n\n\tconstructor(mailboxId)\n\t{\n\t\tthis.#mailboxId = mailboxId;\n\n\t\tthis.#subscribeEvent();\n\n\t\tEventEmitter.subscribe('onPullEvent-mail', (event) => {\n\n\t\t\tlet data = event.getData();\n\n\t\t\tif(data[0] === \"messageBindingCreated\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.setActive(binding['bindingEntityLink']);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(data[0] === \"messageBindingDeleted\" && (data[1]['mailboxId'] === this.getMailbox() || data[1]['mailboxId'] === String(this.getMailbox())))\n\t\t\t{\n\t\t\t\tconst binding = data[1];\n\t\t\t\tconst messageSimpleId = binding['messageId'];\n\n\t\t\t\tconst bindingWrapper = document.querySelector(\"\"+('.js-bind-' + messageSimpleId) + this.#selectors[binding['entityType']] + \"\");\n\n\t\t\t\tif (bindingWrapper)\n\t\t\t\t{\n\t\t\t\t\tbindingWrapper.deactivation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic build(config)\n\t{\n\t\tconst item = new Item(config);\n\t\treturn item.render();\n\t}\n\n\tstatic replaceElement(object)\n\t{\n\t\tconst parent = object.parentNode;\n\n\t\tlet newObject = this.build({\n\t\t\ttype: object.getAttribute('bind-type'),\n\t\t\tid:  object.getAttribute('bind-id'),\n\t\t\tmessageId: object.getAttribute('message-id'),\n\t\t\tmessageSimpleId: object.getAttribute('message-simple-id'),\n\t\t\thref:  object.getAttribute('bind-href'),\n\t\t\tcreateHref: object.getAttribute('create-href'),\n\t\t\terrorType: object.getAttribute('error-type'),\n\t\t});\n\t\tparent.replaceChild(newObject,object);\n\t}\n\n\tstatic initButtons(context: HTMLElement = document.body)\n\t{\n\t\tconst elements = Array.from(context.getElementsByClassName('mail-ui-binding-data'));\n\t\tfor (let element of elements)\n\t\t{\n\t\t\tthis.replaceElement(element);\n\t\t}\n\t}\n\n\t#subscribeEvent()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\tmoduleId: 'mail',\n\t\t\tcommand: 'unbindItem',\n\t\t\tcallback: (data) => this.#unbindItem(data),\n\t\t});\n\t}\n\n\t#unbindItem(data)\n\t{\n\t\tconst selector = `.js-bind-${data.messageId}.mail-binding-${data.type}.mail-ui-active`;\n\t\tconst bindingWrapper = document.querySelector(selector);\n\t\tif (!bindingWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tbindingWrapper.deactivation();\n\t\tthis.#updateGridByUnbindFilter();\n\t}\n\n\t#updateGridByUnbindFilter()\n\t{\n\t\tBX.Mail.Home.Grid.reloadTable();\n\t}\n}\n"],"names":["Item","errorKey","undefined","simple","config","type","id","isActive","Loc","getMessage","getVersionNotActivePhrase","event","isError","showError","getType","BX","Mail","Secretary","getInstance","getMessageId","openChat","onTaskAction","startWait","Client","Message","List","onCrmClick","uri","Uri","addParam","ta_sec","ta_el","top","SidePanel","Instance","open","openCalendarEvent","text","textContent","getNode","classList","add","remove","href","stopWait","setText","setAttribute","updateTitle","removeAttribute","getTitle","activeClass","item","Tag","render","object","onclick","onClick","ondblclick","stopPropagation","setActive","deactivation","getHref","key","UI","Notification","Center","notify","content","Binding","mailboxId","_classPrivateFieldInitSpec","CRM_ACTIVITY","TASKS_TASK","IM_CHAT","BLOG_POST","CALENDAR_EVENT","EventEmitter","subscribe","data","getData","getMailbox","String","binding","messageSimpleId","bindingWrapper","document","querySelector","parent","parentNode","newObject","build","getAttribute","messageId","createHref","errorType","replaceChild","context","body","elements","Array","from","getElementsByClassName","element","replaceElement","PULL","PullClient","SubscriptionType","Server","moduleId","command","callback","selector","Home","Grid","reloadTable"],"mappings":"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"}