{"version":3,"file":"bottomsheet.bundle.js","sources":["../src/touchdraglistener.js","../src/bottomsheet.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class TouchDragListener\n{\n\tconstructor({\n\t\telement,\n\t\ttouchStartCallback,\n\t\ttouchEndCallback,\n\t\ttouchMoveCallback\n\t})\n\t{\n\t\tthis.element = Type.isDomNode(element) ? element : null;\n\t\tthis.touchStartCallback = touchStartCallback;\n\t\tthis.touchEndCallback = touchEndCallback;\n\t\tthis.touchMoveCallback = touchMoveCallback;\n\n\t\tthis.active = false;\n\t\tthis.currentY = null;\n\t\tthis.initialY = null;\n\t\tthis.yOffset = 0;\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tif (this.element)\n\t\t{\n\t\t\tthis.element.addEventListener('touchstart', this.#dragStart.bind(this));\n\t\t\tthis.element.addEventListener('touchend', this.#dragEnd.bind(this));\n\t\t\tthis.element.addEventListener('touchmove', this.#dragMove.bind(this));\n\t\t}\n\t}\n\n\t#dragStart(ev)\n\t{\n\t\tthis.active = true;\n\t\tthis.element.classList.add('--ondrag');\n\n\t\tif (ev.type === 'touchstart')\n\t\t{\n\t\t\tthis.initialY = ev.touches[0].clientY - this.yOffset;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initialY = ev.clientY - this.yOffset;\n\t\t}\n\n\t\tif (!this.touchStartCallback)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.touchStartCallback({\n\t\t\telement: this.element,\n\t\t\tactive: this.active,\n\t\t\tcurrentY: this.currentY,\n\t\t\tinitialY: this.initialY,\n\t\t\tyOffset: this.offSetY\n\t\t});\n\t}\n\n\t#dragEnd(ev)\n\t{\n\t\tthis.active = true;\n\t\tthis.element.classList.remove('--ondrag');\n\n\t\tthis.yOffset = 0;\n\n\t\tthis.initialY = this.currentY;\n\n\t\tif (!this.touchEndCallback) return;\n\n\t\tthis.touchEndCallback({\n\t\t\telement: this.element,\n\t\t\tactive: this.active,\n\t\t\tcurrentY: this.currentY,\n\t\t\tinitialY: this.initialY,\n\t\t\tyOffset: this.offSetY\n\t\t});\n\t}\n\t\n\t#dragMove(ev)\n\t{\n\t\tif (!this.active)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tev.preventDefault();\n\n\t\tif (ev.type === 'touchmove')\n\t\t{\n\t\t\tthis.currentY = ev.touches[0].clientY - this.initialY;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.currentY = ev.clientY - this.initialY;\n\t\t}\n\n\t\tthis.yOffset = this.currentX;\n\n\t\tif (!this.touchMoveCallback)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.touchMoveCallback({\n\t\t\telement: this.element,\n\t\t\tactive: this.active,\n\t\t\tcurrentY: this.currentY,\n\t\t\tinitialY: this.initialY,\n\t\t\tyOffset: this.offSetY\n\t\t});\n\t}\n}","import { Type, Tag, Dom, Loc } from 'main.core';\nimport TouchDragListener from './touchdraglistener';\n\nimport 'ui.design-tokens';\nimport './style.css';\n\nexport default class BottomSheet\n{\n\tconstructor({\n\t\tcontent,\n\t\thelp,\n\t\tclassName,\n\t\tpadding\n\t})\n\t{\n\t\tthis.content = Type.isDomNode(content) ? content : null;\n\t\tthis.className = Type.isString(className) ? className : '';\n\t\tthis.padding = Type.isString(padding) || Type.isNumber(padding) ? padding : null;\n\n\t\tthis.help = null;\n\t\tswitch (true)\n\t\t{\n\t\t\tcase Type.isString(help):\n\t\t\t\tthis.help = help;\n\t\t\t\tbreak;\n\t\t\tcase Type.isFunction(help):\n\t\t\t\tthis.help = help;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.layout = {\n\t\t\twrapper: null,\n\t\t\tcontainer: null,\n\t\t\tcontent: null,\n\t\t\toverlay: null,\n\t\t\tclose: null,\n\t\t\thelp: null\n\t\t};\n\n\t\tthis.halfOfHeight = 0;\n\t\tthis.currentHeight = null;\n\n\t\tthis.sheetListener = new TouchDragListener({\n\t\t\telement: this.#getPanel(),\n\t\t\ttouchStartCallback: ({element, active, initialY, currentY, yOffset}) => {\n\t\t\t\telement.style.setProperty('--translateY', 'translateY(0)');\n\t\t\t\telement.style.setProperty('transition', 'unset');\n\t\t\t},\n\t\t\ttouchEndCallback: ({element, active, initialY, currentY, yOffset}) => {\n\t\t\t\telement.style.setProperty(\n\t\t\t\t\t'transition',\n\t\t\t\t\t'transform .3s'\n\t\t\t\t);\n\t\t\t\telement.style.setProperty(\n\t\t\t\t\t'--translateY',\n\t\t\t\t\t'translateY(' + currentY + 'px)'\n\t\t\t\t);\n\n\t\t\t\tif (parseInt(currentY) > this.halfOfHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttouchMoveCallback: ({element, active, initialY, currentY, yOffset}) => {\n\t\t\t\t\n\t\t\t\tif (currentY <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentY <= -40)\n\t\t\t\t{\n\t\t\t\t\tcurrentY = -41 + currentY / 10;\n\t\t\t\t}\n\n\t\t\t\telement.style.setProperty(\n\t\t\t\t\t'--translateY',\n\t\t\t\t\t'translateY(' + currentY + 'px)'\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\tif (this.content)\n\t\t{\n\t\t\tthis.setContent(this.content);\n\t\t}\n\t}\n\n\t#getOverlay()\n\t{\n\t\tif (!this.layout.overlay)\n\t\t{\n\t\t\tthis.layout.overlay = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet__overlay\"></div>\n\t\t\t`;\n\n\t\t\tthis.layout.overlay.addEventListener('click', this.close.bind(this));\n\t\t}\n\n\t\treturn this.layout.overlay;\n\t}\n\n\t#getHelp()\n\t{\n\t\tif (!this.layout.help)\n\t\t{\n\t\t\tif (Type.isString(this.help))\n\t\t\t{\n\t\t\t\tthis.layout.help = Tag.render`\n\t\t\t\t\t<a href=\"${this.help}\" class=\"ui-bottomsheet__panel-control--item --cursor-pointer\">\n\t\t\t\t\t\t<span class=\"ui-bottomsheet__panel-control--item-text\">${Loc.getMessage('UI_BOTTOMSHEET_HELP')}</span>\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tif (Type.isFunction(this.help))\n\t\t\t{\n\t\t\t\tthis.layout.help = Tag.render`\n\t\t\t\t\t<div class=\"ui-bottomsheet__panel-control--item --cursor-pointer\">\n\t\t\t\t\t\t<div class=\"ui-bottomsheet__panel-control--item-text\">${Loc.getMessage('UI_BOTTOMSHEET_HELP')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tthis.layout.help.addEventListener('click', ()=> {\n\t\t\t\t\tthis.help();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.layout.help;\n\t}\n\n\t#getClose()\n\t{\n\t\tif (!this.layout.close)\n\t\t{\n\t\t\tthis.layout.close = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet__panel-control--item --cursor-pointer --close\">\n\t\t\t\t\t<div class=\"ui-bottomsheet__panel-control--item-text\">${Loc.getMessage('UI_BOTTOMSHEET_CLOSE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.layout.close.addEventListener('click', this.close.bind(this));\n\t\t}\n\n\t\treturn this.layout.close;\n\t}\n\n\t#getPanel()\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tconst panelWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet__panel-wrapper\">\n\t\t\t\t\t${this.#getContent()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.padding || this.padding === 0)\n\t\t\t{\n\t\t\t\tlet padding;\n\n\t\t\t\tswitch(true)\n\t\t\t\t{\n\t\t\t\t\tcase Type.isString(this.padding):\n\t\t\t\t\t\tpadding = this.padding;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase Type.isNumber(this.padding):\n\t\t\t\t\t\tpadding = this.padding + 'px';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tpanelWrapper.style.setProperty(\n\t\t\t\t\t'padding',\n\t\t\t\t\tpadding\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.layout.container = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet__panel\">\n\t\t\t\t\t<div class=\"ui-bottomsheet__panel-control\">\n\t\t\t\t\t\t${this.help ? this.#getHelp() : ''}\n\t\t\t\t\t\t<div class=\"ui-bottomsheet__panel-handler\"></div>\n\t\t\t\t\t\t${this.#getClose()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${panelWrapper}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.container;\n\t}\n\n\t#getContent()\n\t{\n\t\tif (!this.layout.content)\n\t\t{\n\t\t\tthis.layout.content = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet__panel-content\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.content;\n\t}\n\n\t#getWrapper()\n\t{\n\t\tif (!this.layout.wrapper)\n\t\t{\n\t\t\tthis.layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"ui-bottomsheet ${this.className}\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.wrapper;\n\t}\n\t\n\tsetContent(content: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(content))\n\t\t{\n\t\t\tDom.clean(this.#getContent());\n\t\t\tthis.#getContent().appendChild(content);\n\t\t}\n\n\t\tif (Type.isString(content))\n\t\t{\n\t\t\tDom.clean(this.#getContent());\n\t\t\tthis.#getContent().innerText = content;\n\t\t}\n\t}\n\n\tadjustPosition()\n\t{\n\n\t}\n\n\tadjustSize()\n\t{\n\t\tif (this.currentHeight !== this.#getPanel().offsetHeight)\n\t\t{\n\t\t\tlet currentHeight = this.currentHeight;\n\t\t\tlet newHeight = this.#getPanel().offsetHeight;\n\t\t\tthis.#getPanel().style.setProperty(\n\t\t\t\t'height',\n\t\t\t\tcurrentHeight + 'px'\n\t\t\t);\n\n\t\t\tsetTimeout(()=> {\n\t\t\t\tcurrentHeight = this.#getPanel().offsetHeight;\n\t\t\t\tthis.#getPanel().style.setProperty(\n\t\t\t\t\t'height',\n\t\t\t\t\tnewHeight + 'px'\n\t\t\t\t);\n\n\t\t\t\tconst adjustHeight = ()=> {\n\t\t\t\t\tthis.#getPanel().style.removeProperty(\n\t\t\t\t\t\t'height',\n\t\t\t\t\t\tnewHeight + 'px'\n\t\t\t\t\t);\n\t\t\t\t\tthis.#getPanel().removeEventListener('transitionend', adjustHeight)\n\t\t\t\t};\n\n\t\t\t\tthis.#getPanel().addEventListener('transitionend', adjustHeight);\n\n\t\t\t\tthis.currentHeight = newHeight;\n\t\t\t\tthis.halfOfHeight = this.currentHeight / 2;\n\t\t\t});\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tif (this.#getWrapper().parentNode)\n\t\t{\n\t\t\tthis.#getPanel().classList.remove('--show');\n\t\t\tthis.#getOverlay().classList.remove('--show');\n\n\t\t\tconst animationProgress = () => {\n\t\t\t\tthis.#getWrapper().classList.remove('--show');\n\t\t\t\tthis.#getPanel().removeEventListener('transitionend', animationProgress);\n\t\t\t}\n\n\t\t\tthis.#getPanel().addEventListener('transitionend', animationProgress)\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (!this.#getWrapper().parentNode)\n\t\t{\n\t\t\tthis.#getWrapper().appendChild(this.#getOverlay());\n\t\t\tthis.#getWrapper().appendChild(this.#getPanel());\n\t\t\tdocument.body.appendChild(this.#getWrapper());\n\t\t}\n\n\t\tthis.#getWrapper().classList.add('--show');\n\n\t\tsetTimeout(()=> {\n\t\t\tthis.currentHeight = this.#getPanel().offsetHeight;\n\t\t\tthis.halfOfHeight = this.currentHeight / 2;\n\t\t\tthis.#getPanel().classList.add('--show');\n\t\t\tthis.#getOverlay().classList.add('--show');\n\t\t});\n\t}\n}"],"names":["TouchDragListener","constructor","element","touchStartCallback","touchEndCallback","touchMoveCallback","Type","isDomNode","active","currentY","initialY","yOffset","addEventListener","bind","ev","classList","add","type","touches","clientY","offSetY","remove","preventDefault","currentX","BottomSheet","content","help","className","padding","isString","isNumber","isFunction","layout","wrapper","container","overlay","close","halfOfHeight","currentHeight","sheetListener","style","setProperty","parseInt","setContent","Dom","clean","appendChild","innerText","adjustPosition","adjustSize","offsetHeight","newHeight","setTimeout","adjustHeight","removeProperty","removeEventListener","parentNode","animationProgress","show","document","body","Tag","render","Loc","getMessage","panelWrapper"],"mappings":"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"}