{"version":3,"file":"dialogeditcontact.bundle.js","sources":["../src/dialogeditcontact.js"],"sourcesContent":["import { Tag, Loc, Validation } from 'main.core';\nimport { SidePanelWrapper } from 'mail.sidepanelwrapper';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { Avatar } from 'mail.avatar';\nimport { BaseEvent, EventEmitter } from \"main.core.events\";\n\nimport './css/style.css';\nimport '/bitrix/js/ui/forms/ui.forms.css';\nimport 'ui.forms';\nimport 'ui.alerts';\n\nexport class DialogEditContact\n{\n\tstatic getCheckedFields(contentElement)\n\t{\n\t\tconst emailContainer = contentElement.querySelector('[data-role=\"email-container\"]');\n\t\tconst emailInput = emailContainer.querySelector('[data-role=\"input-field\"]');\n\t\tconst email = emailInput.value;\n\n\t\tconst nameItem = contentElement.querySelector('[data-role=\"name-container\"]');\n\t\tconst nameInput = nameItem.querySelector('[data-role=\"input-field\"]');\n\t\tlet name = nameInput.value;\n\n\t\tlet fieldsAreFilledCorrectly = true;\n\n\t\tif (!Validation.isEmail(email))\n\t\t{\n\t\t\tfieldsAreFilledCorrectly = false;\n\t\t\temailContainer.showError(0);\n\t\t}\n\t\telse if (name.length < 1)\n\t\t{\n\t\t\tname = email.split('@')[0];\n\t\t}\n\n\t\tconst checkedFields = {\n\t\t\tname: name,\n\t\t\temail: email,\n\t\t};\n\n\t\tif (fieldsAreFilledCorrectly)\n\t\t{\n\t\t\treturn checkedFields;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic openRemoveDialog(config = {\n\t\tid: '',\n\t})\n\t{\n\t\tlet promiseRemoveContact = new BX.Promise();\n\t\tlet removeContact = this.removeContact;\n\t\tconst topSlider = BX.SidePanel.Instance.getTopSlider();\n\t\tlet messageBoxZIndex = 1;\n\n\t\tif (topSlider != null)\n\t\t{\n\t\t\tmessageBoxZIndex += topSlider.getZindex();\n\t\t}\n\n\t\tconst messageBox = new MessageBox({\n\t\t\ttitle: Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_REMOVE_DIALOG_TITLE\"),\n\t\t\tmessage: Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_REMOVE_DIALOG_MESSAGE\"),\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,\n\t\t\tpopupOptions: {\n\t\t\t\tzIndex: messageBoxZIndex,\n\t\t\t},\n\t\t\tonOk: function() {\n\t\t\t\tremoveContact(config['id']).then(() => promiseRemoveContact.fulfill());\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tonCancel: function() {\n\t\t\t\tpromiseRemoveContact.reject();\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t});\n\n\t\tmessageBox.show();\n\n\t\treturn promiseRemoveContact;\n\t}\n\n\tstatic removeContact(id)\n\t{\n\t\treturn BX.ajax.runAction('mail.addressbook.removecontacts', {\n\t\t\tdata: {\n\t\t\t\tidSet: [id],\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic saveContact(name, email, id = 'new')\n\t{\n\t\tconst data = Avatar.getAvatarData({\n\t\t\tfullName: name,\n\t\t\temail: email,\n\t\t});\n\n\t\tlet contactData = {\n\t\t\tNAME: name,\n\t\t\tEMAIL: email,\n\t\t\tCOLOR: data['color'],\n\t\t\tINITIALS: data['abbreviation'],\n\t\t};\n\n\t\tif (id !== undefined)\n\t\t{\n\t\t\tcontactData['ID'] = id;\n\t\t}\n\n\t\treturn BX.ajax.runAction('mail.addressbook.savecontact', {\n\t\t\tdata: {\n\t\t\t\tcontactData: contactData,\n\t\t\t},\n\t\t});\n\t}\n\n\tstatic showError(id=0)\n\t{\n\t\tthis.emailInputWrapper.classList.add('ui-ctl-danger');\n\t\tBX.show(this.errorTitle[id]);\n\t}\n\n\tstatic hideError(id = 'all')\n\t{\n\t\tthis.emailInputWrapper.classList.remove('ui-ctl-danger');\n\t\tif(id === 'all'){\n\t\t\tthis.errorTitle.forEach(element => {\n\t\t\t\tBX.hide(element)\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tBX.hide(this.errorTitle[id]);\n\t}\n\n\tstatic showErrorEmailAlreadyExists(responseError, errorAlreadyExistLink, emailContainer): boolean\n\t{\n\t\tconst contact = this.getLastOfMatchingContactFromError(responseError);\n\n\t\tconst {\n\t\t\tcontactID,\n\t\t\tcontactData,\n\t\t} = contact;\n\n\t\tif(contact !== null)\n\t\t{\n\t\t\terrorAlreadyExistLink.onclick = () => {\n\t\t\t\tthis.openEditDialog({\n\t\t\t\t\tcontactID,\n\t\t\t\t\tcontactData,\n\t\t\t\t})\n\t\t\t};\n\t\t\temailContainer.showError(1);\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic openDialog(titleText, contactConfig)\n\t{\n\t\tconst {\n\t\t\tcontactID = 'new',\n\t\t\tshowEmailError = false,\n\t\t\tprefixId,\n\t\t\tcontactData,\n\t\t\tresponseError,\n\t\t} = contactConfig;\n\n\t\tlet sliderId = 'dialogEditContact_' + contactID;\n\n\t\tif (prefixId !== undefined)\n\t\t{\n\t\t\tsliderId += '_' + prefixId;\n\t\t}\n\n\t\tlet currentEmail = '';\n\t\tlet currentName = '';\n\t\tlet disablingEmailInputClass = '';\n\t\tlet disablingEmailInputAttribute = '';\n\n\t\tif (contactData !== undefined)\n\t\t{\n\t\t\tcurrentName = contactData.name;\n\t\t\tcurrentEmail = contactData.email;\n\n\t\t\tif (contactID !== 'new')\n\t\t\t{\n\t\t\t\tdisablingEmailInputClass = 'ui-ctl-disabled';\n\t\t\t\tdisablingEmailInputAttribute = 'disabled';\n\t\t\t}\n\t\t}\n\n\t\tconst emailInput = Tag.render`<input data-role=\"input-field\" type=\"text\" class=\"ui-ctl-element\" value=\"\" placeholder=\"info@example.com\"  ${disablingEmailInputAttribute}>`;\n\t\tconst emailInputWrapper = Tag.render`<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ${disablingEmailInputClass}\">\n\t\t\t${emailInput}\n\t\t</div>`;\n\t\temailInput.value = currentEmail;\n\n\t\tconst errorTitleEmailIsIncorrect = Tag.render`<div class=\"ui-alert ui-alert-danger mail-addressbook-error-box\">\n\t\t\t<span class=\"ui-alert-message\">${Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_EMAIL_ERROR\")}</span>\n\t\t</div>`;\n\n\t\tconst errorTitleEmailIsAlreadyExists = Tag.render`<div class=\"ui-alert ui-alert-danger mail-addressbook-error-box\">\n\t\t\t<span class=\"ui-alert-message\">${Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_EMAIL_ERROR_EMAIL_IS_ALREADY_EXISTS\")}</span>\n\t\t\t<br>\n\t\t</div>`;\n\n\t\tconst errorAlreadyExistLink = errorTitleEmailIsAlreadyExists.querySelector('[data-role=\"contact-email\"]')\n\n\t\tconst emailContainer = Tag.render`<div data-role=\"email-container\" class=\"mail-addressbook-dialogeditcontact-item\">\n\t\t\t<label class=\"mail-addressbook-dialogeditcontact-lable\">${Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_EMAIL_TITLE\")}\n\t\t\t\t<div id=\"mail-addressbook-dialogeditcontact-contact-email-container\" class=\"ui-ctl ui-ctl-textbox mail-addressbook-dialogeditcontact-field\">\n\t\t\t\t\t${emailInputWrapper}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t${errorTitleEmailIsIncorrect}\n\t\t\t${errorTitleEmailIsAlreadyExists}\n\t\t</div>`;\n\n\t\tconst nameInput = Tag.render`<input data-role=\"input-field\" type=\"text\" class=\"ui-ctl-element\" value=\"\" placeholder=\"\">`;\n\t\tconst nameInputWrapper = Tag.render`<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t${nameInput}\n\t\t</div>`;\n\t\tnameInput.value = currentName;\n\n\t\tconst nameItem = Tag.render`<div data-role=\"name-container\" class=\"mail-addressbook-dialogeditcontact-item\">\n\t\t\t<label class=\"mail-addressbook-dialogeditcontact-lable\">${Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_NAME_TITLE\")}\n\t\t\t\t<div id=\"mail-addressbook-dialogeditcontact-contact-email-container\" class=\"ui-ctl ui-ctl-textbox mail-addressbook-dialogeditcontact-field\">\n\t\t\t\t\t${nameInputWrapper}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t</div>`;\n\n\t\tlet content = Tag.render`\n\t\t<div>\n\t\t\t${nameItem}\n\t\t\t${emailContainer}\n\t\t</div>`;\n\n\t\temailContainer.errorTitle = [\n\t\t\terrorTitleEmailIsIncorrect,\n\t\t\terrorTitleEmailIsAlreadyExists\n\t\t];\n\n\t\temailContainer.emailInputWrapper = emailInputWrapper;\n\t\temailContainer.showError = this.showError;\n\t\temailContainer.hideError = this.hideError;\n\t\temailContainer.hideError();\n\n\t\tif (showEmailError === true)\n\t\t{\n\t\t\temailContainer.showError();\n\t\t}\n\n\t\temailInput.oninput = () => emailContainer.hideError();\n\n\t\tif(responseError !== undefined)\n\t\t{\n\t\t\tthis.showErrorEmailAlreadyExists(responseError, errorAlreadyExistLink, emailContainer);\n\t\t}\n\n\t\tSidePanelWrapper.open({\n\t\t\tid: sliderId,\n\t\t\ttitleText: titleText,\n\t\t\tfooterIsActive: true,\n\t\t\tcontent,\n\t\t\tcancelButton: {\n\t\t\t\ttext: Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_BUTTON_CANCEL\"),\n\t\t\t},\n\t\t\tconsentButton: {\n\t\t\t\ttext: Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_BUTTON_SAVE\"),\n\t\t\t\tfunction: (eventObject) => {\n\t\t\t\t\tconst checkedFields = this.getCheckedFields(content);\n\n\t\t\t\t\tif (checkedFields)\n\t\t\t\t\t{\n\t\t\t\t\t\teventObject.setClocking(true);\n\n\t\t\t\t\t\tthis.saveContact(checkedFields['name'], checkedFields['email'], contactConfig['contactID']).then((response) => {\n\n\t\t\t\t\t\t\tEventEmitter.emit('BX.DialogEditContact:onSaveContact', new BaseEvent(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\titems: response.data,\n\t\t\t\t\t\t\t\t\t\tprefixId: contactConfig.prefixId,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tBX.SidePanel.Instance.postMessageAll(sliderId, 'dialogEditContact::reloadList', {});\n\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\t\tif(this.showErrorEmailAlreadyExists(response, errorAlreadyExistLink, emailContainer))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\teventObject.setClocking(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.SidePanel.Instance.postMessageAll(sliderId, 'dialogEditContact::reloadList', {});\n\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn contactID;\n\t}\n\n\tstatic openCreateDialog(config = {})\n\t{\n\t\tconst {\n\t\t\tresponseError,\n\t\t\tprefixId,\n\t\t} = config;\n\n\t\tif(responseError !== undefined)\n\t\t{\n\t\t\tconst contact = this.getLastOfMatchingContactFromError(responseError);\n\t\t\treturn this.openEditDialog({\n\t\t\t\tprefixId,\n\t\t\t\t...contact,\n\t\t\t});\n\t\t}\n\n\t\treturn this.openDialog(Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_TITLE_BAR_ADD_MSGVER_1\"), config);\n\n\t}\n\n\tstatic getLastOfMatchingContactFromError(responseError)\n\t{\n\t\tlet lastMessage = null;\n\n\t\tfor (const error of responseError.errors)\n\t\t{\n\t\t\tif (error.code === 'ALL_CONTACTS_ALREADY_ADDED')\n\t\t\t{\n\t\t\t\tlastMessage = error.customData.lastFound[0];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(lastMessage !== null)\n\t\t{\n\t\t\treturn {\n\t\t\t\tcontactID: Number(lastMessage['ID']),\n\t\t\t\tcontactData: {\n\t\t\t\t\tname: lastMessage['NAME'],\n\t\t\t\t\temail: lastMessage['EMAIL'],\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic openEditDialog(config = {\n\t\tcontactID: '',\n\t\tcontactData: {\n\t\t\tname: '',\n\t\t\temail: '',\n\t\t},\n\t})\n\t{\n\t\treturn this.openDialog(Loc.getMessage(\"MAIL_DIALOG_EDIT_CONTACT_TITLE_BAR_EDIT_MSGVER_1\"), config);\n\t}\n}"],"names":["DialogEditContact","contentElement","emailContainer","querySelector","emailInput","email","value","nameItem","nameInput","name","fieldsAreFilledCorrectly","Validation","isEmail","showError","length","split","checkedFields","config","id","promiseRemoveContact","BX","Promise","removeContact","topSlider","SidePanel","Instance","getTopSlider","messageBoxZIndex","getZindex","messageBox","MessageBox","title","Loc","getMessage","message","buttons","UI","Dialogs","MessageBoxButtons","OK_CANCEL","popupOptions","zIndex","onOk","then","fulfill","close","onCancel","reject","show","ajax","runAction","data","idSet","Avatar","getAvatarData","fullName","contactData","NAME","EMAIL","COLOR","INITIALS","undefined","emailInputWrapper","classList","add","errorTitle","remove","forEach","element","hide","responseError","errorAlreadyExistLink","contact","getLastOfMatchingContactFromError","contactID","onclick","openEditDialog","titleText","contactConfig","showEmailError","prefixId","sliderId","currentEmail","currentName","disablingEmailInputClass","disablingEmailInputAttribute","Tag","render","errorTitleEmailIsIncorrect","errorTitleEmailIsAlreadyExists","nameInputWrapper","content","hideError","oninput","showErrorEmailAlreadyExists","SidePanelWrapper","open","footerIsActive","cancelButton","text","consentButton","eventObject","getCheckedFields","setClocking","saveContact","response","EventEmitter","emit","BaseEvent","items","postMessageAll","openDialog","lastMessage","errors","error","code","customData","lastFound","Number"],"mappings":"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"}