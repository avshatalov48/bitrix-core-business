{"version":3,"file":"date-formatter.bundle.js","sources":["../src/date-template.js","../src/date-formatter.js"],"sourcesContent":["import {DateTimeFormat} from 'main.date';\n\nimport type {DateTemplateType} from './types/date-template-type';\n\nexport const DateCode = {\n\tshortTimeFormat: DateTimeFormat.getFormat('SHORT_TIME_FORMAT'),\n\tshortDateFormat: DateTimeFormat.getFormat('SHORT_DATE_FORMAT'),\n\tdayMonthFormat: DateTimeFormat.getFormat('DAY_MONTH_FORMAT'),\n\tlongDateFormat: DateTimeFormat.getFormat('LONG_DATE_FORMAT'),\n\tdayOfWeekMonthFormat: DateTimeFormat.getFormat('DAY_OF_WEEK_MONTH_FORMAT'),\n\tfullDateFormat: DateTimeFormat.getFormat('FULL_DATE_FORMAT'),\n\tdayShortMonthFormat: DateTimeFormat.getFormat('DAY_SHORT_MONTH_FORMAT'),\n\tmediumDateFormat: DateTimeFormat.getFormat('MEDIUM_DATE_FORMAT'),\n\tdefaultDateTime: DateTimeFormat.getFormat('FORMAT_DATETIME')\n};\n\nexport const Interval = {\n\ttomorrow: 'tomorrow',\n\ttoday: 'today',\n\tyesterday: 'yesterday',\n\tweek: 'week',\n\tyear: 'year',\n\tolderThanYear: 'olderThanYear'\n};\n\nexport const DateTemplate: {\n\t[templateName: string]: DateTemplateType\n} = {\n\tnotification: {\n\t\t[Interval.today]: `today, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.yesterday]: `yesterday, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.year]: `${DateCode.dayMonthFormat}, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.olderThanYear]: `${DateCode.longDateFormat}, ${DateCode.shortTimeFormat}`\n\t},\n\tdateGroup: {\n\t\t[Interval.today]: 'today',\n\t\t[Interval.yesterday]: 'yesterday',\n\t\t[Interval.year]: DateCode.dayOfWeekMonthFormat,\n\t\t[Interval.olderThanYear]: DateCode.fullDateFormat\n\t},\n\tmeeting: {\n\t\t[Interval.tomorrow]: `tomorrow, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.today]: `today, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.yesterday]: `yesterday, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.year]: `${DateCode.dayShortMonthFormat}, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.olderThanYear]: `${DateCode.mediumDateFormat}, ${DateCode.shortTimeFormat}`\n\t},\n\trecent: {\n\t\t[Interval.today]: DateCode.shortTimeFormat,\n\t\t[Interval.week]: 'D',\n\t\t[Interval.year]: DateCode.dayShortMonthFormat,\n\t\t[Interval.olderThanYear]: DateCode.mediumDateFormat\n\t},\n\tmessageReadStatus: {\n\t\t[Interval.today]: `today, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.yesterday]: `yesterday, ${DateCode.shortTimeFormat}`,\n\t\t[Interval.year]: `${DateCode.dayMonthFormat},  ${DateCode.shortTimeFormat}`,\n\t\t[Interval.olderThanYear]: `${DateCode.dayMonthFormat} Y, ${DateCode.shortTimeFormat}`\n\t}\n};","import {DateTimeFormat} from 'main.date';\n\nimport {Interval} from './date-template';\n\nimport type {DateTemplateType} from './types/date-template-type';\n\nexport {DateTemplate, DateCode} from './date-template';\n\nexport class DateFormatter\n{\n\t#date: Date;\n\t#matchingFunctions: {[key: $Values<typeof Interval>]: Function};\n\n\tstatic formatByCode(date: Date, formatCode: string): string\n\t{\n\t\treturn new DateFormatter(date).formatByCode(formatCode);\n\t}\n\n\tstatic formatByTemplate(date: Date, template: DateTemplateType = {}): string\n\t{\n\t\treturn new DateFormatter(date).formatByTemplate(template);\n\t}\n\n\tformatByCode(formatCode: string): string\n\t{\n\t\treturn DateTimeFormat.format(formatCode, this.#date);\n\t}\n\n\tformatByTemplate(template: DateTemplateType = {}): string\n\t{\n\t\tconst intervals = Object.keys(Interval);\n\n\t\tconst matchingInterval = intervals.find(interval => {\n\t\t\tconst templateHasInterval = !!template[interval];\n\t\t\tif (!templateHasInterval)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst matchingFunction = this.#matchingFunctions[interval];\n\t\t\tconst intervalIsMatching = matchingFunction();\n\n\t\t\tif (!intervalIsMatching)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// it's a matching code from provided template\n\t\t\treturn true;\n\t\t});\n\n\t\tif (!matchingInterval)\n\t\t{\n\t\t\tconsole.error('DateFormatter: no matching intervals were found for', template);\n\t\t\treturn;\n\t\t}\n\n\t\tconst matchingCode = template[matchingInterval];\n\n\t\treturn this.formatByCode(matchingCode);\n\t}\n\n\tconstructor(date: Date)\n\t{\n\t\tthis.#date = date;\n\t\tthis.#matchingFunctions = {\n\t\t\t[Interval.tomorrow]: () => this.#isTomorrow(),\n\t\t\t[Interval.today]: () => this.#isToday(),\n\t\t\t[Interval.yesterday]: () => this.#isYesterday(),\n\t\t\t[Interval.week]: () => this.#isCurrentWeek(),\n\t\t\t[Interval.year]: () => this.#isCurrentYear(),\n\t\t\t[Interval.olderThanYear]: () => !this.#isCurrentYear()\n\t\t};\n\t}\n\n\t#isYesterday(): boolean\n\t{\n\t\tconst yesterday = this.#shiftDate(-1);\n\n\t\treturn this.#isSame(yesterday);\n\t}\n\n\t#isToday(): boolean\n\t{\n\t\treturn this.#isSame(new Date());\n\t}\n\n\t#isTomorrow(): boolean\n\t{\n\t\tconst tomorrow = this.#shiftDate(1);\n\n\t\treturn this.#isSame(tomorrow);\n\t}\n\n\t#isCurrentWeek(): boolean\n\t{\n\t\tconst date = new Date();\n\t\tconst currentWeekNumber = +DateTimeFormat.format('W', date);\n\t\tconst setWeekNumber = +DateTimeFormat.format('W', this.#date);\n\t\tconst sameYear = this.#isCurrentYear();\n\n\t\treturn currentWeekNumber === setWeekNumber && sameYear;\n\t}\n\n\t#isCurrentYear(): boolean\n\t{\n\t\tconst date = new Date();\n\t\tconst currentYear = date.getFullYear();\n\t\tconst setYear = this.#date.getFullYear();\n\n\t\treturn currentYear === setYear;\n\t}\n\n\t#isSame(date): boolean\n\t{\n\t\tconst dateLocale = date.toLocaleDateString();\n\t\tconst setDateLocale = this.#date.toLocaleDateString();\n\n\t\treturn dateLocale === setDateLocale;\n\t}\n\n\t#shiftDate(shift): Date\n\t{\n\t\tconst date = new Date();\n\t\tdate.setDate(date.getDate() + shift);\n\n\t\treturn date;\n\t}\n}"],"names":["DateCode","shortTimeFormat","DateTimeFormat","getFormat","shortDateFormat","dayMonthFormat","longDateFormat","dayOfWeekMonthFormat","fullDateFormat","dayShortMonthFormat","mediumDateFormat","defaultDateTime","Interval","tomorrow","today","yesterday","week","year","olderThanYear","DateTemplate","notification","dateGroup","meeting","recent","messageReadStatus","DateFormatter","formatByCode","date","formatCode","formatByTemplate","template","format","intervals","Object","keys","matchingInterval","find","interval","templateHasInterval","matchingFunction","intervalIsMatching","console","error","matchingCode","constructor","Date","currentWeekNumber","setWeekNumber","sameYear","currentYear","getFullYear","setYear","dateLocale","toLocaleDateString","setDateLocale","shift","setDate","getDate"],"mappings":"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"}