this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,s,a,l,t){"use strict";const i={LOW:1,NORMAL:2,HIGH:3,CRITICAL:4};const r={IDLE:"idle",RUNNING:"running",DONE:"done"};var o=babelHelpers.classPrivateFieldLooseKey("id");var b=babelHelpers.classPrivateFieldLooseKey("callback");var c=babelHelpers.classPrivateFieldLooseKey("priority");var n=babelHelpers.classPrivateFieldLooseKey("delay");var d=babelHelpers.classPrivateFieldLooseKey("allowLaunchAfterOthers");var p=babelHelpers.classPrivateFieldLooseKey("forceShowOnTop");var u=babelHelpers.classPrivateFieldLooseKey("state");class h extends t.EventEmitter{constructor(e){super();Object.defineProperty(this,o,{writable:true,value:null});Object.defineProperty(this,b,{writable:true,value:null});Object.defineProperty(this,c,{writable:true,value:i.NORMAL});Object.defineProperty(this,n,{writable:true,value:5e3});Object.defineProperty(this,d,{writable:true,value:false});Object.defineProperty(this,p,{writable:true,value:false});Object.defineProperty(this,u,{writable:true,value:r.IDLE});const s=l.Type.isPlainObject(e)?e:{};if(!l.Type.isFunction(s.callback)){throw new TypeError('BX.Launcher: "callback" parameter is required.')}babelHelpers.classPrivateFieldLooseBase(this,b)[b]=s.callback;babelHelpers.classPrivateFieldLooseBase(this,o)[o]=l.Type.isStringFilled(s.id)?s.id:`launch-item-${BX.Text.getRandom().toLowerCase()}`;babelHelpers.classPrivateFieldLooseBase(this,c)[c]=l.Type.isNumber(s.priority)?s.priority:babelHelpers.classPrivateFieldLooseBase(this,c)[c];babelHelpers.classPrivateFieldLooseBase(this,n)[n]=l.Type.isNumber(s.delay)&&s.delay>=0?s.delay:babelHelpers.classPrivateFieldLooseBase(this,n)[n];babelHelpers.classPrivateFieldLooseBase(this,d)[d]=s.allowLaunchAfterOthers===true;babelHelpers.classPrivateFieldLooseBase(this,p)[p]=l.Type.isBoolean(s.forceShowOnTop)||l.Type.isFunction(s.forceShowOnTop)?s.forceShowOnTop:babelHelpers.classPrivateFieldLooseBase(this,p)[p];this.setEventNamespace("BX.Main.Launcher.Item")}launch(e){if(babelHelpers.classPrivateFieldLooseBase(this,u)[u]!==r.IDLE){return}babelHelpers.classPrivateFieldLooseBase(this,u)[u]=r.RUNNING;const s=()=>{babelHelpers.classPrivateFieldLooseBase(this,u)[u]=r.DONE;e()};babelHelpers.classPrivateFieldLooseBase(this,b)[b](s)}getId(){return babelHelpers.classPrivateFieldLooseBase(this,o)[o]}getState(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u]}getPriority(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}getDelay(){return babelHelpers.classPrivateFieldLooseBase(this,n)[n]}canLaunchAfterOthers(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}canShowOnTop(){if(l.Type.isFunction(babelHelpers.classPrivateFieldLooseBase(this,p)[p])){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]()}return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}}const v={IDLE:"idle",WAITING_READY:"waiting_ready",READY:"ready"};var P=babelHelpers.classPrivateFieldLooseKey("enabled");var L=babelHelpers.classPrivateFieldLooseKey("queue");var F=babelHelpers.classPrivateFieldLooseKey("currentItem");var B=babelHelpers.classPrivateFieldLooseKey("state");var H=babelHelpers.classPrivateFieldLooseKey("documentReady");var f=babelHelpers.classPrivateFieldLooseKey("launchCount");var y=babelHelpers.classPrivateFieldLooseKey("launchTimeoutId");var w=babelHelpers.classPrivateFieldLooseKey("startDebounced");var O=babelHelpers.classPrivateFieldLooseKey("start");var I=babelHelpers.classPrivateFieldLooseKey("tryDequeue");class m{constructor(){Object.defineProperty(this,I,{value:T});Object.defineProperty(this,O,{value:g});Object.defineProperty(this,P,{writable:true,value:true});Object.defineProperty(this,L,{writable:true,value:null});Object.defineProperty(this,F,{writable:true,value:null});Object.defineProperty(this,B,{writable:true,value:v.IDLE});Object.defineProperty(this,H,{writable:true,value:false});Object.defineProperty(this,f,{writable:true,value:0});Object.defineProperty(this,y,{writable:true,value:null});Object.defineProperty(this,w,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=new s.OrderedArray(((e,s)=>{const a=s.getPriority()-e.getPriority();return a===0?-1:a}));babelHelpers.classPrivateFieldLooseBase(this,w)[w]=l.Runtime.debounce(babelHelpers.classPrivateFieldLooseBase(this,O)[O],1e3,this)}static canShowOnTop(){const e=l.Reflection.getClass("BX.Main.PopupManager");if(e){const s=e.getPopups();for(const e of s){if(!e.isShown()){continue}if(e.getId().startsWith("timeman_weekly_report_popup_")||e.getId().startsWith("timeman_daily_report_popup_")||BX.Dom.hasClass(e.getPopupContainer(),"b24-whatsnew__popup")){return false}}}const s=l.Reflection.getClass("BX.UI.Viewer.Instance");if(s&&s.isOpen()){return false}const t=l.Reflection.getClass("BX.SidePanel.Instance");if(t&&t.getOpenSlidersCount()>0){return false}const i=a.ZIndexManager.getStack(document.body);const r=i===null?[]:i.getComponents();for(const e of r){if(e.getOverlay()!==null&&e.getOverlay().offsetWidth>0){return false}}return true}register(e,s={}){const a=new h({callback:e,...s});babelHelpers.classPrivateFieldLooseBase(this,L)[L].add(a);babelHelpers.classPrivateFieldLooseBase(this,w)[w]()}unregister(e){for(const s of babelHelpers.classPrivateFieldLooseBase(this,L)[L]){if(s.getId()===e){babelHelpers.classPrivateFieldLooseBase(this,L)[L].delete(s);break}}if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]!==null&&babelHelpers.classPrivateFieldLooseBase(this,F)[F].getId()===e){babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}}isEnabled(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P]}enable(){babelHelpers.classPrivateFieldLooseBase(this,P)[P]=true;babelHelpers.classPrivateFieldLooseBase(this,w)[w]()}disable(){babelHelpers.classPrivateFieldLooseBase(this,P)[P]=false;babelHelpers.classPrivateFieldLooseBase(this,B)[B]=v.IDLE}}function g(){if(!this.isEnabled()||babelHelpers.classPrivateFieldLooseBase(this,B)[B]!==v.IDLE){return}const e=()=>{babelHelpers.classPrivateFieldLooseBase(this,H)[H]=true;babelHelpers.classPrivateFieldLooseBase(this,B)[B]=v.READY;setTimeout((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}),1e3)};if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]){e()}else{babelHelpers.classPrivateFieldLooseBase(this,B)[B]=v.WAITING_READY;if(l.Type.isUndefined(window.frameCacheVars)){l.Event.ready(e)}else{var s,a;const i=((s=BX)==null?void 0:(a=s.frameCache)==null?void 0:a.frameDataInserted)===true||!l.Type.isUndefined(window.frameRequestFail);if(i){e()}else{t.EventEmitter.subscribe("onFrameDataProcessed",e);t.EventEmitter.subscribe("onFrameDataRequestFail",e)}}}}function T(){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,y)[y]);babelHelpers.classPrivateFieldLooseBase(this,F)[F]=babelHelpers.classPrivateFieldLooseBase(this,L)[L].getFirst();if(babelHelpers.classPrivateFieldLooseBase(this,F)[F]===null){return}babelHelpers.classPrivateFieldLooseBase(this,L)[L].delete(babelHelpers.classPrivateFieldLooseBase(this,F)[F]);if(!babelHelpers.classPrivateFieldLooseBase(this,F)[F].canLaunchAfterOthers()&&babelHelpers.classPrivateFieldLooseBase(this,f)[f]>0){babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}else if(this.constructor.canShowOnTop()||babelHelpers.classPrivateFieldLooseBase(this,F)[F].canShowOnTop()){babelHelpers.classPrivateFieldLooseBase(this,y)[y]=setTimeout((()=>{if(this.constructor.canShowOnTop()||babelHelpers.classPrivateFieldLooseBase(this,F)[F].canShowOnTop()){babelHelpers.classPrivateFieldLooseBase(this,f)[f]++;babelHelpers.classPrivateFieldLooseBase(this,F)[F].launch((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}))}else{babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}}),babelHelpers.classPrivateFieldLooseBase(this,F)[F].getDelay())}else{babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}}const E=new m;e.AutoLauncher=E;e.Launcher=m;e.LaunchItem=h;e.LaunchPriority=i})(this.BX.UI.AutoLaunch=this.BX.UI.AutoLaunch||{},BX.Collections,BX,BX,BX.Event);
//# sourceMappingURL=auto-launch.bundle.map.js