{"version":3,"file":"registry.bundle.js","sources":["../src/base.js","../src/call.js","../src/notifications.js","../src/registry.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Im base pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {EventType} from \"im.const\";\nimport {Logger} from \"im.lib.logger\";\n\nimport {EventEmitter} from 'main.core.events';\n\nexport class ImBasePullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof this.option.handlingDialog === 'object'\n\t\t\t\t&& this.option.handlingDialog\n\t\t\t\t&& this.option.handlingDialog.chatId\n\t\t\t\t&& this.option.handlingDialog.dialogId\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tthis.option.handlingDialog = false;\n\t\t}\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\tskipExecute(params, extra = {})\n\t{\n\t\tif (!extra.optionImportant)\n\t\t{\n\t\t\tif (this.option.skip)\n\t\t\t{\n\t\t\t\tLogger.info('Pull: command skipped while loading messages', params);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!this.option.handlingDialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof params.chatId !== 'undefined' || typeof params.dialogId !== 'undefined' )\n\t\t{\n\t\t\tif (\n\t\t\t\ttypeof params.chatId !== 'undefined'\n\t\t\t\t&& parseInt(params.chatId) === parseInt(this.option.handlingDialog.chatId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof params.dialogId !== 'undefined'\n\t\t\t\t&& params.dialogId.toString() === this.option.handlingDialog.dialogId.toString()\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\thandleMessage(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageChat(params, extra)\n\t{\n\t\tthis.handleMessageAdd(params, extra);\n\t}\n\n\thandleMessageAdd(params, extra)\n\t{\n\t\tLogger.warn('handleMessageAdd', params);\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet collection = this.store.state.messages.collection[params.chatId];\n\t\tif (!collection)\n\t\t{\n\t\t\tcollection = [];\n\t\t}\n\n\t\t//search for message with message id from params\n\t\tconst message = collection.find(element => {\n\t\t\tif (params.message.templateId && element.id === params.message.templateId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn element.id === params.message.id;\n\t\t});\n\n\t\t//stop if it's message with 'push' (pseudo push message in mobile)\n\t\tif (message && params.message.push)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.chat && params.chat[params.chatId])\n\t\t{\n\t\t\tconst existingChat = this.store.getters['dialogues/getByChatId'](params.chatId);\n\t\t\t//add new chat if there is no one\n\t\t\tif (!existingChat)\n\t\t\t{\n\t\t\t\tconst chatToAdd = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tparams.chat[params.chatId],\n\t\t\t\t\t{dialogId: params.dialogId}\n\t\t\t\t);\n\t\t\t\tthis.store.dispatch('dialogues/set', chatToAdd);\n\t\t\t}\n\t\t\t//otherwise - update it\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\tfields: params.chat[params.chatId]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\t//add recent item if there is no one\n\t\tif (!recentItem)\n\t\t{\n\t\t\tconst newRecentItem = this.prepareRecentItem(params);\n\t\t\tthis.store.dispatch('recent/set', [newRecentItem]);\n\t\t}\n\t\t//otherwise - update it\n\t\telse\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tlines: params.lines || {id: 0},message: {\n\t\t\t\t\t\tid: params.message.id,\n\t\t\t\t\t\ttext: params.message.text,\n\t\t\t\t\t\tdate: params.message.date,\n\t\t\t\t\t\tsenderId: params.message.senderId\n\t\t\t\t\t},\n\t\t\t\t\tcounter: params.counter\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//set users\n\t\tif (params.users)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', VuexBuilderModel.convertToArray(params.users));\n\t\t}\n\n\t\t//set files\n\t\tif (params.files)\n\t\t{\n\t\t\tlet files = this.controller.application.prepareFilesBeforeSave(\n\t\t\t\tVuexBuilderModel.convertToArray(params.files)\n\t\t\t);\n\t\t\tfiles.forEach(file =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tfiles.length === 1\n\t\t\t\t\t&& params.message.templateFileId\n\t\t\t\t\t&& this.store.state.files.index[params.chatId]\n\t\t\t\t\t&& this.store.state.files.index[params.chatId][params.message.templateFileId]\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/update', {\n\t\t\t\t\t\tid: params.message.templateFileId,\n\t\t\t\t\t\tchatId: params.chatId,\n\t\t\t\t\t\tfields: file\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.store.dispatch('files/set', file);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//if we already have message - update it and scrollToBottom\n\t\tif (message)\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we already have this message', params.message);\n\t\t\tthis.store.dispatch('messages/update', {\n\t\t\t\tid: message.id,\n\t\t\t\tchatId: message.chatId,\n\t\t\t\tfields: {\n\t\t\t\t\t...params.message,\n\t\t\t\t\tsending: false,\n\t\t\t\t\terror: false,\n\t\t\t\t}\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\t\t\tchatId: message.chatId,\n\t\t\t\t\t\tcancelIfScrollChange: params.message.senderId !== this.controller.application.getUserId()\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//if we dont have message and we have all pages - add new message and send newMessage event (handles scroll stuff)\n\t\t//we dont do anything if we dont have message and there are unloaded messages\n\t\telse if (this.controller.application.isUnreadMessagesLoaded())\n\t\t{\n\t\t\tLogger.warn('New message pull handler: we dont have this message', params.message);\n\t\t\tthis.store.dispatch('messages/setAfter', {\n\t\t\t\t...params.message,\n\t\t\t\tunread: true\n\t\t\t}).then(() => {\n\t\t\t\tif (!params.message.push)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.newMessage, {\n\t\t\t\t\t\tchatId: params.message.chatId,\n\t\t\t\t\t\tmessageId: params.message.id\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//stop writing event\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.message.senderId\n\t\t});\n\n\t\t//if we sent message and there are no unloaded unread pages - read all messages on server and client, set counter to 0\n\t\t//TODO: to think about it during new chat development\n\t\tif (\n\t\t\tparams.message.senderId === this.controller.application.getUserId()\n\t\t\t&& this.controller.application.isUnreadMessagesLoaded()\n\t\t)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.store.state.dialogues.collection[params.dialogId]\n\t\t\t\t&& this.store.state.dialogues.collection[params.dialogId].counter !== 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.controller.restClient.callMethod('im.dialog.read', {\n\t\t\t\t\tdialog_id: params.dialogId\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\t\t\t\tchatId: params.chatId\n\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: false});\n\t\t\t\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\t\t\t\tdialogId: params.dialogId,\n\t\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t//increase the counter if message is not ours\n\t\telse if (params.message.senderId !== this.controller.application.getUserId())\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/increaseCounter', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tcount: 1,\n\t\t\t});\n\t\t}\n\n\t\t//set new lastMessageId (used for pagination)\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tlastMessageId: params.message.id\n\t\t\t}\n\t\t});\n\n\t\t//increase total message count\n\t\tthis.store.dispatch('dialogues/increaseMessageCounter', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tcount: 1,\n\t\t});\n\t}\n\n\thandleMessageUpdate(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\thandleMessageDelete(params, extra, command)\n\t{\n\t\tthis.execMessageUpdateOrDelete(params, extra, command);\n\t}\n\n\texecMessageUpdateOrDelete(params, extra, command)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId\n\t\t});\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {\n\t\t\t\ttext: command === \"messageUpdate\"? params.text: '',\n\t\t\t\ttextOriginal: command === \"messageUpdate\"? params.textOriginal: '',\n\t\t\t\tparams: params.params,\n\t\t\t\tblink: true\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\n\t\tlet recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (\n\t\t\tcommand === 'messageUpdate' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: params.text,\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tcommand === 'messageDelete' &&\n\t\t\trecentItem.element &&\n\t\t\trecentItem.element.message.id === params.id\n\t\t)\n\t\t{\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tmessage: {\n\t\t\t\t\t\tid: params.id,\n\t\t\t\t\t\ttext: 'Message deleted',\n\t\t\t\t\t\tdate: recentItem.element.message.date\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleMessageDeleteComplete(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/delete', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t});\n\n\t\tthis.controller.application.stopOpponentWriting({\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.senderId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleMessageLike(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: {LIKE: params.users}}\n\t\t});\n\t}\n\n\thandleChatOwner(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\townerId: params.userId,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatManagers(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmanagerList: params.list,\n\t\t\t}\n\t\t});\n\t}\n\n\thandleChatUpdateParams(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: params.params\n\t\t});\n\t}\n\n\thandleChatUserAdd(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleChatUserLeave(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {userCounter: params.userCount}\n\t\t});\n\t}\n\n\thandleMessageParamsUpdate(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/update', {\n\t\t\tid: params.id,\n\t\t\tchatId: params.chatId,\n\t\t\tfields: {params: params.params}\n\t\t}).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: params.chatId, cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleStartWriting(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.controller.application.startOpponentWriting(params);\n\t}\n\n\thandleReadMessage(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('messages/readMessages', {\n\t\t\tchatId: params.chatId,\n\t\t\treadId: params.lastId\n\t\t}).then(result => {\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleReadMessageChat(params, extra)\n\t{\n\t\tthis.handleReadMessage(params, extra);\n\t}\n\n\thandleReadMessageOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\thandleReadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execReadMessageOpponent(params, extra);\n\t}\n\n\texecReadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\tuserName: params.userName,\n\t\t\tmessageId: params.lastId,\n\t\t\tdate: params.date,\n\t\t\taction: true\n\t\t});\n\n\t\tconst recentItem = this.store.getters['recent/get'](params.dialogId);\n\t\tif (recentItem)\n\t\t{\n\t\t\tconst message = recentItem.element.message;\n\t\t\tthis.store.dispatch('recent/update', {\n\t\t\t\tid: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tcounter: params.counter,\n\t\t\t\t\tmessage: {...message, status: 'delivered'}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\thandleUnreadMessageOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\thandleUnreadMessageChatOpponent(params, extra)\n\t{\n\t\tthis.execUnreadMessageOpponent(params, extra);\n\t}\n\n\texecUnreadMessageOpponent(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/updateReaded', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tuserId: params.userId,\n\t\t\taction: false\n\t\t});\n\t}\n\n\thandleFileUpload(params, extra)\n\t{\n\t\tif (this.skipExecute(params, extra))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('files/set', this.controller.application.prepareFilesBeforeSave(\n\t\t\t VuexBuilderModel.convertToArray({file: params.fileParams})\n\t\t)).then(() => {\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {cancelIfScrollChange: true});\n\t\t});\n\t}\n\n\thandleChatPin(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/pin', {\n\t\t\tid: params.dialogId,\n\t\t\taction: params.active\n\t\t});\n\t}\n\n\thandleChatHide(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/delete', {\n\t\t\tid: params.dialogId\n\t\t});\n\t}\n\n\thandleChatMuteNotify(params, extra)\n\t{\n\t\tconst existingChat = this.store.getters['dialogues/get'](params.dialogId);\n\t\tif (!existingChat)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst existingMuteList = existingChat.muteList;\n\t\tlet newMuteList = [];\n\t\tconst currentUser = this.store.state.application.common.userId;\n\t\tif (params.mute)\n\t\t{\n\t\t\tnewMuteList = [...existingMuteList, currentUser];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewMuteList = existingMuteList.filter(element => {\n\t\t\t\treturn element !== currentUser;\n\t\t\t});\n\t\t}\n\n\t\tthis.store.dispatch('dialogues/update', {\n\t\t\tdialogId: params.dialogId,\n\t\t\tfields: {\n\t\t\t\tmuteList: newMuteList\n\t\t\t}\n\t\t});\n\t}\n\n\thandleReadNotifyList(params, extra)\n\t{\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: 'notify',\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleUserInvite(params, extra)\n\t{\n\t\tif (!params.invited)\n\t\t{\n\t\t\tthis.store.dispatch('users/update', {\n\t\t\t\tid: params.userId,\n\t\t\t\tfields: params.user\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareRecentItem(params)\n\t{\n\t\tlet type = 'user';\n\t\tif (params.dialogId.toString().startsWith('chat'))\n\t\t{\n\t\t\ttype = 'chat';\n\t\t}\n\t\tparams.dialogId.toString().startsWith('chat');\n\t\tconst title = type === 'chat'? params.chat[params.chatId].name: params.users[params.dialogId].name;\n\t\tconst chat = params.chat[params.chatId]? params.chat[params.chatId]: {};\n\t\tif (!params.users)\n\t\t{\n\t\t\tparams.users = {};\n\t\t}\n\t\tconst user = params.users[params.dialogId]? params.users[params.dialogId]: {};\n\t\tconst userId = type === 'user'? params.dialogId: 0;\n\n\t\treturn {\n\t\t\tid: params.dialogId,\n\t\t\ttype: type,\n\t\t\ttitle: title,\n\t\t\tcounter: params.counter,\n\t\t\tchatId: params.chatId,\n\t\t\tchat: chat,\n\t\t\tuser: user,\n\t\t\tuserId: userId,\n\t\t\tmessage: {\n\t\t\t\tid: params.message.id,\n\t\t\t\ttext: params.message.text,\n\t\t\t\tdate: params.message.date,\n\t\t\t\tsenderId: params.message.senderId\n\t\t\t}\n\t\t};\n\t}\n}","/**\n * Bitrix Messenger\n * Im call pull commands (Pull Command Handler)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {PullClient} from \"pull.client\";\nimport {ConferenceRightPanelMode as RightPanelMode} from 'im.const';\n\nexport class ImCallPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store? params.store: {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleChatUserAdd(params)\n\t{\n\t\tconst users = Object.values(params.users).map(user => {\n\t\t\treturn {...user, lastActivityDate: new Date()};\n\t\t});\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('users/set', users);\n\t\tthis.store.dispatch('conference/setUsers', {users: users.map(user => user.id)});\n\t}\n\n\thandleChatUserLeave(params)\n\t{\n\t\tif (params.userId === this.controller.getUserId() && params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.application.kickFromCall();\n\t\t}\n\n\t\tthis.store.commit('conference/common', {userCount: params.userCount});\n\t\tthis.store.dispatch('conference/removeUsers', {users: [params.userId]});\n\t}\n\n\thandleCallUserNameUpdate(params)\n\t{\n\t\tconst currentUser = this.store.getters['users/get'](params.userId);\n\t\tif (!currentUser)\n\t\t{\n\t\t\tthis.store.dispatch('users/set', {\n\t\t\t\tid: params.userId,\n\t\t\t\tlastActivityDate: new Date()\n\t\t\t});\n\t\t}\n\t\tthis.store.dispatch('users/update', {\n\t\t\tid: params.userId,\n\t\t\tfields: {name: params.name, lastActivityDate: new Date()}\n\t\t});\n\t}\n\n\thandleVideoconfShareUpdate(params)\n\t{\n\t\tif (params.dialogId === this.store.state.application.dialog.dialogId)\n\t\t{\n\t\t\tthis.store.dispatch('dialogues/update', {\n\t\t\t\tdialogId: params.dialogId,\n\t\t\t\tfields: {\n\t\t\t\t\tpublic: {\n\t\t\t\t\t\tcode: params.newCode,\n\t\t\t\t\t\tlink:  params.newLink\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.application.changeVideoconfUrl(params.newLink);\n\t\t}\n\t}\n\n\thandleMessageChat(params)\n\t{\n\t\tconst rightPanelMode = this.store.state.conference.common.rightPanelMode;\n\t\tif (\n\t\t\tparams.chatId === this.application.getChatId() &&\n\t\t\t(rightPanelMode !== RightPanelMode.chat && rightPanelMode !== RightPanelMode.split) &&\n\t\t\tparams.message.senderId !== this.controller.getUserId() &&\n\t\t\t!this.store.state.conference.common.error\n\t\t)\n\t\t{\n\t\t\tlet text = '';\n\n\t\t\tif (params.message.senderId === 0 || params.message.system === 'Y')\n\t\t\t{\n\t\t\t\ttext = params.message.text;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst userName = params.users[params.message.senderId].name;\n\n\t\t\t\tif (params.message.text === '' && Object.keys(params.files).length > 0)\n\t\t\t\t{\n\t\t\t\t\ttext = `${userName}: ${this.controller.localize['BX_IM_COMPONENT_CALL_FILE']}`;\n\t\t\t\t}\n\t\t\t\telse if (params.message.text !== '')\n\t\t\t\t{\n\t\t\t\t\ttext = `${userName}: ${params.message.text}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.application.sendNewMessageNotify(text);\n\t\t}\n\t}\n\n\thandleChatRename(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('conference/setConferenceTitle', {conferenceTitle: params.name});\n\t}\n\n\thandleConferenceUpdate(params)\n\t{\n\t\tif (params.chatId !== this.application.getChatId())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (params.isBroadcast !== '')\n\t\t{\n\t\t\tthis.store.dispatch('conference/setBroadcastMode', {broadcastMode: params.isBroadcast});\n\t\t}\n\n\t\tif (params.presenters.length > 0)\n\t\t{\n\t\t\tthis.store.dispatch('conference/setPresenters', {presenters: params.presenters, replace: true});\n\t\t}\n\t}\n}","import {PullClient} from \"pull.client\";\n\nexport class ImNotificationsPullHandler\n{\n\tstatic create(params = {})\n\t{\n\t\treturn new this(params);\n\t}\n\n\tconstructor(params = {})\n\t{\n\t\tif (typeof params.application === 'object' && params.application)\n\t\t{\n\t\t\tthis.application = params.application;\n\t\t}\n\t\tif (typeof params.controller === 'object' && params.controller)\n\t\t{\n\t\t\tthis.controller = params.controller;\n\t\t}\n\t\tif (typeof params.store === 'object' && params.store)\n\t\t{\n\t\t\tthis.store = params.store;\n\t\t}\n\n\t\tthis.option = typeof params.store === 'object' && params.store ? params.store : {};\n\t}\n\n\tgetModuleId()\n\t{\n\t\treturn 'im';\n\t}\n\n\tgetSubscriptionType()\n\t{\n\t\treturn PullClient.SubscriptionType.Server;\n\t}\n\n\thandleNotifyAdd(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30 || params.onlyFlash === true)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user = this.store.getters['users/get'](params.userId);\n\t\tif (!user)\n\t\t{\n\t\t\tconst users = [];\n\t\t\tusers.push({\n\t\t\t\tid: params.userId,\n\t\t\t\tavatar: params.userAvatar,\n\t\t\t\tcolor: params.userColor,\n\t\t\t\tname: params.userName\n\t\t\t});\n\n\t\t\tthis.store.dispatch('users/set', users);\n\t\t}\n\n\t\tthis.store.dispatch('notifications/add', { data: params });\n\t\tthis.store.dispatch('notifications/setCounter', { unreadTotal: params.counter });\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: {\n\t\t\t\t\tid: params.id,\n\t\t\t\t\ttext: params.text,\n\t\t\t\t\tdate: params.date\n\t\t\t\t},\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyConfirm(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.store.dispatch('notifications/delete', {\n\t\t\tid: params.id,\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t\tthis.updateRecentListOnDelete(params.counter);\n\t}\n\n\thandleNotifyRead(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: true });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\n\t}\n\n\thandleNotifyUnread(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tparams.list.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/read', { ids: [id], action: false });\n\t\t});\n\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tcounter: params.counter\n\t\t\t}\n\t\t});\n\t}\n\n\thandleNotifyDelete(params, extra)\n\t{\n\t\tif (extra.server_time_ago > 30)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst idsToDelete = Object.keys(params.id).map(id => parseInt(id, 10));\n\n\t\tidsToDelete.forEach(id => {\n\t\t\tthis.store.dispatch('notifications/delete', { id: id });\n\t\t});\n\n\t\tthis.updateRecentListOnDelete(params.counter)\n\t\tthis.store.dispatch('notifications/setCounter', {\n\t\t\tunreadTotal: params.counter\n\t\t});\n\t}\n\n\tupdateRecentListOnDelete(counterValue)\n\t{\n\t\tlet message;\n\t\tconst latestNotification = this.getLatest();\n\t\tif (latestNotification !== null)\n\t\t{\n\t\t\tmessage = {\n\t\t\t\tid: latestNotification.id,\n\t\t\t\ttext: latestNotification.text,\n\t\t\t\tdate: latestNotification.date\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst notificationChat = this.store.getters['recent/get']('notify');\n\t\t\tif (notificationChat === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmessage = notificationChat.element.message;\n\t\t\tmessage.text = this.controller.localize['IM_NOTIFICATIONS_DELETED_ITEM_STUB'];\n\t\t}\n\n\t\tthis.store.dispatch('recent/update', {\n\t\t\tid: \"notify\",\n\t\t\tfields: {\n\t\t\t\tmessage: message,\n\t\t\t\tcounter: counterValue\n\t\t\t}\n\t\t});\n\t}\n\n\tgetLatest()\n\t{\n\t\tlet latestNotification = {\n\t\t\tid: 0\n\t\t};\n\n\t\tfor (const notification of this.store.state.notifications.collection)\n\t\t{\n\t\t\tif (notification.id > latestNotification.id)\n\t\t\t{\n\t\t\t\tlatestNotification = notification;\n\t\t\t}\n\t\t}\n\n\t\tif (latestNotification.id === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn latestNotification;\n\t}\n}\n","/**\n * Bitrix Messenger\n * Bundle pull command handlers\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport {ImBasePullHandler} from \"./base\";\nimport {ImCallPullHandler} from \"./call\";\nimport {ImNotificationsPullHandler} from \"./notifications\";\n\nexport {\n\tImBasePullHandler,\n\tImCallPullHandler,\n\tImNotificationsPullHandler\n}"],"names":["ImBasePullHandler","params","controller","store","option","handlingDialog","chatId","dialogId","PullClient","SubscriptionType","Server","extra","optionImportant","skip","Logger","info","parseInt","toString","handleMessageAdd","warn","skipExecute","collection","state","messages","message","find","element","templateId","id","push","chat","existingChat","getters","chatToAdd","Object","assign","dispatch","fields","recentItem","newRecentItem","prepareRecentItem","lines","text","date","senderId","counter","users","VuexBuilderModel","convertToArray","files","application","prepareFilesBeforeSave","forEach","file","length","templateFileId","index","then","EventEmitter","emit","EventType","dialog","scrollToBottom","cancelIfScrollChange","sending","error","getUserId","isUnreadMessagesLoaded","unread","newMessage","messageId","stopOpponentWriting","userId","dialogues","restClient","callMethod","dialog_id","result","count","lastMessageId","command","execMessageUpdateOrDelete","textOriginal","blink","action","LIKE","ownerId","managerList","list","userCounter","userCount","startOpponentWriting","readId","lastId","handleReadMessage","execReadMessageOpponent","userName","status","execUnreadMessageOpponent","fileParams","active","existingMuteList","muteList","newMuteList","currentUser","common","mute","filter","invited","user","type","startsWith","title","name","ImCallPullHandler","values","map","lastActivityDate","Date","commit","kickFromCall","public","code","newCode","link","newLink","changeVideoconfUrl","rightPanelMode","conference","getChatId","RightPanelMode","split","system","keys","localize","sendNewMessageNotify","conferenceTitle","isBroadcast","broadcastMode","presenters","replace","ImNotificationsPullHandler","server_time_ago","onlyFlash","avatar","userAvatar","color","userColor","data","unreadTotal","updateRecentListOnDelete","ids","idsToDelete","counterValue","latestNotification","getLatest","notificationChat","notifications","notification"],"mappings":"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"}