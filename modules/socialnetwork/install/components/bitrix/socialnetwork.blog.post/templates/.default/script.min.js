function showHiddenDestination(t,e){BX.hide(e);BX("blog-destination-hidden-"+t).style.display="inline"}function showMenuLinkInput(t,e){var s="post-menu-"+t+"-link",i=BX(s+"-text"),o=BX(s+"-icon-done");if(BX.clipboard.isCopySupported()){if(i&&i.getAttribute("data-block-click")=="Y"){return}BX.clipboard.copy(e);if(i&&o){o.style.display="inline-block";BX.removeClass(BX(s+"-icon-animate"),"post-menu-link-icon-animate");BX.adjust(i,{attrs:{"data-block-click":"Y"}});setTimeout(function(){BX.addClass(BX(s+"-icon-animate"),"post-menu-link-icon-animate")},1);setTimeout(function(){BX.adjust(i,{attrs:{"data-block-click":"N"}})},500)}return}var n=BX.proxy_context,a=parseInt(!!n.getAttribute("bx-height")?n.getAttribute("bx-height"):n.offsetHeight);if(n.getAttribute("bx-status")!="shown"){n.setAttribute("bx-status","shown");if(!BX(s)&&!!BX(s+"-text")){var p=BX(s+"-text"),r=BX.pos(p),u=BX.pos(p.parentNode);pos3=BX.pos(BX.findParent(p,{className:"menu-popup-item"},true));r["height"]=u["height"]-1;BX.adjust(n,{attrs:{"bx-height":n.offsetHeight},style:{overflow:"hidden",display:"block"},children:[BX.create("BR"),BX.create("DIV",{attrs:{id:s},children:[BX.create("SPAN",{attrs:{className:"menu-popup-item-left"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-icon"}}),BX.create("SPAN",{attrs:{className:"menu-popup-item-text"},children:[BX.create("INPUT",{attrs:{id:s+"-input",type:"text",value:e},style:{height:r["height"]+"px",width:pos3["width"]-21+"px"},events:{click:function(t){this.select();BX.PreventDefault(t)}}})]})]}),BX.create("SPAN",{className:"menu-popup-item-right"})]})}new BX.fx({time:.2,step:.05,type:"linear",start:a,finish:a*2,callback:BX.delegate(function(t){this.style.height=t+"px"},n)}).start();BX.fx.show(BX(s),.2);BX(s+"-input").select()}else{n.setAttribute("bx-status","hidden");new BX.fx({time:.2,step:.05,type:"linear",start:n.offsetHeight,finish:a,callback:BX.delegate(function(t){this.style.height=t+"px"},n)}).start();BX.fx.hide(BX(s),.2)}}function deleteBlogPost(t){var e=BX("blg-post-"+t);if(BX.findChild(e,{attr:{id:"form_c_del"}},true,false)){BX.hide(BX("form_c_del"));BX(e.parentNode.parentNode).appendChild(BX("form_c_del"))}BX.ajax.get(BX.message("sonetBPDeletePath").replace("#del_post_id#",t),function(s){if(window.deletePostEr&&window.deletePostEr=="Y"){BX.findChild(e,{className:"feed-post-cont-wrap"},true,false).insertBefore(BX.create("SPAN",{html:s}),BX.findChild(e,{className:"feed-user-avatar"},true,false))}else{__logDeleteSuccess(BX("blg-post-"+t))}});return false}var waitPopupBlogImage=null;function blogShowImagePopup(t){if(!waitPopupBlogImage){waitPopupBlogImage=new BX.PopupWindow("blogwaitPopupBlogImage",window,{autoHide:true,lightShadow:false,zIndex:2,content:BX.create("IMG",{props:{src:t,id:"blgimgppp"}}),closeByEsc:true,closeIcon:true})}else{BX("blgimgppp").src="/bitrix/images/1.gif";BX("blgimgppp").src=t}waitPopupBlogImage.setOffset({offsetTop:0,offsetLeft:0});setTimeout(function(){waitPopupBlogImage.adjustPosition()},100);waitPopupBlogImage.show()}function __blogPostSetFollow(t){var e=BX("log_entry_follow_"+t).getAttribute("data-follow")=="Y"?"Y":"N",s=e=="Y"?"N":"Y",i=BX("log_entry_follow_"+t);if(i){BX.findChild(i,{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+s);i.setAttribute("data-follow",s)}var o=BX.message("sonetBPSetPath");o=BX.util.add_url_param(o,{b24statAction:s=="Y"?"setFollow":"setUnfollow"});BX.ajax({url:o,method:"POST",dataType:"json",data:{log_id:t,action:"change_follow",follow:s,sessid:BX.bitrix_sessid(),site:BX.message("sonetBPSiteId")},onsuccess:function(t){if(t["SUCCESS"]!="Y"&&i){BX.findChild(i,{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+e);i.setAttribute("data-follow",e)}},onfailure:function(t){if(i){BX.findChild(i,{tagName:"a"}).innerHTML=BX.message("sonetBPFollow"+e);i.setAttribute("data-follow",e)}}});return false}(function(){if(!!BX.SBPostMenu)return false;BX.SBPostMenu=function(t){};BX.SBPostMenu.showMenu=function(params){if(typeof params=="undefined"||typeof params.postId=="undefined"||parseInt(params.postId)<=0||typeof params.bindNode=="undefined"||!BX(params.bindNode)){return false}BX.PopupMenu.destroy("blog-post-"+params.postId);var isPublicPage=typeof params.publicPage!="undefined"&&!!params.publicPage,isTasksAvailable=typeof params.tasksAvailable!="undefined"&&!!params.tasksAvailable,pathToPost=typeof params.pathToPost!="undefined"?params.pathToPost:"",urlToEdit=typeof params.urlToEdit!="undefined"?params.urlToEdit:"",urlToHide=typeof params.urlToHide!="undefined"?params.urlToHide:"",urlToDelete=typeof params.urlToDelete!="undefined"?params.urlToDelete:"",voteId=typeof params.voteId!="undefined"?parseInt(params.voteId):false,postType=typeof params.postType!="undefined"?params.postType:false;if(BX.type.isNotEmptyString(urlToHide)){urlToHide=BX.util.remove_url_param(urlToHide,["b24statAction"]);urlToHide=BX.util.add_url_param(urlToHide,{b24statAction:"hidePost"})}if(isPublicPage){return false}var menuWaiterPopup=new BX.PopupWindow("blog-post-"+params.postId+"-waiter",params.bindNode,{offsetLeft:-14,offsetTop:4,lightShadow:false,angle:{position:"top",offset:50},content:BX.create("SPAN",{props:{className:"bx-ilike-wait"}})});setTimeout(function(){if(menuWaiterPopup){menuWaiterPopup.show()}},300);BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.blog.post/ajax.php",method:"POST",dataType:"json",data:{sessid:BX.bitrix_sessid(),siteId:BX.message("SITE_ID"),action:"get_data",postId:parseInt(params.postId),public:isPublicPage?"Y":"N",mobile:"N",group_readonly:typeof params.group_readonly!="undefined"&&!!params.group_readonly?"Y":"N",pathToPost:pathToPost,voteId:voteId},onsuccess:function(postData){if(typeof postData=="undefined"||typeof postData.perms=="undefined"||postData.perms<="D"&&(typeof params.items=="undefined"||params.items.length<=0)){menuWaiterPopup.destroy();return false}var menuItems=[];if(!BX.util.in_array(postType,["DRAFT","MODERATION"])){if(postData.isGroupReadOnly!="Y"&&parseInt(BX.message("USER_ID"))>0&&parseInt(postData.logId)>0){var isFavorites=parseInt(postData.logFavoritesUserId)>0;menuItems.push({text:BX.message(isFavorites?"sonetLMenuFavoritesTitleY":"sonetLMenuFavoritesTitleN"),onclick:function(t){__logChangeFavorites(parseInt(postData.logId),"log_entry_favorites_"+parseInt(postData.logId),isFavorites?"N":"Y",true);return false}})}var serverName=params.serverName;menuItems.push({text:BX.message("BLOG_HREF"),href:postData.urlToPost,class:"feed-entry-popup-menu-link"});menuItems.push({text:'<span id="post-menu-'+postData.logId+'-link-text">'+BX.message("BLOG_LINK")+"</span>"+'<span id="post-menu-'+postData.logId+'-link-icon-animate" class="post-menu-link-icon-wrap">'+'<span class="post-menu-link-icon" id="post-menu-'+postData.logId+'-link-icon-done" style="display: none;">'+"</span>"+"</span>",onclick:function(t){showMenuLinkInput(parseInt(postData.logId),serverName+postData.urlToPost);return false},class:"feed-entry-popup-menu-link"});if(parseInt(BX.message("USER_ID"))>0&&postData.isGroupReadOnly!="Y"&&postData.isShareForbidden!="Y"){menuItems.push({text:BX.message("BLOG_SHARE"),onclick:function(){showSharing(parseInt(params.postId),parseInt(postData.authorId));this.popupWindow.close()}})}if(postData.perms>="W"||postData.perms>="P"&&postData.authorId==BX.message("USER_ID")){menuItems.push({text:BX.message("BLOG_BLOG_BLOG_EDIT"),href:urlToEdit})}if(postData.perms>="T"){menuItems.push({text:BX.message("BLOG_MES_HIDE"),onclick:function(){if(confirm(BX.message("BLOG_MES_HIDE_POST_CONFIRM"))){window.location=urlToHide;this.popupWindow.close()}}})}if(postData.perms>="W"){menuItems.push({text:BX.message("BLOG_BLOG_BLOG_DELETE"),onclick:function(){if(confirm(BX.message("BLOG_MES_DELETE_POST_CONFIRM"))){if(urlToDelete.length>0){window.location=urlToDelete.replace("#del_post_id#",parseInt(params.postId))}else{window.deleteBlogPost(parseInt(params.postId))}this.popupWindow.close()}}})}if(isTasksAvailable&&postData.perms>"D"){menuItems.push({text:BX.message("BLOG_POST_CREATE_TASK"),onclick:function(t){var e=t.target||t.srcElement;oLF.createTask({entityType:"BLOG_POST",entityId:parseInt(params.postId)});this.popupWindow.close();return t.preventDefault()}})}if(postData.urlToVoteExport.length>0){menuItems.push({text:BX.message("BLOG_POST_VOTE_EXPORT"),href:postData.urlToVoteExport})}}var onclickHandler=null,menuItem=null,item=null;if(typeof params.items!="undefined"){for(var key in params.items){if(params.items.hasOwnProperty(key)){item=params.items[key];menuItem={};if(typeof item.text_php!="undefined"){menuItem.text=item.text_php}if(typeof item.onclick!="undefined"){eval("onclickHandler = "+item.onclick);menuItem.onclick=onclickHandler}else if(typeof item.href!="undefined"){menuItem.href=item.href}menuItems.push(menuItem)}}}var popupEvents=typeof params.logId!="undefined"&&parseInt(params.logId)>0?{onPopupShow:function(t){if(BX("log_entry_favorites_"+parseInt(params.logId))){var e=BX.findChildren(t.contentContainer,{className:"menu-popup-item-text"},true);if(e!=null){for(var s=0;s<e.length;s++){if(e[s].innerHTML==BX.message("sonetLMenuFavoritesTitleY")||e[s].innerHTML==BX.message("sonetLMenuFavoritesTitleN")){var i=e[s];break}}}if(typeof i!="undefined"){BX(i).innerHTML=BX.hasClass(BX("log_entry_favorites_"+parseInt(params.logId)),"feed-post-important-switch-active")?BX.message("sonetLMenuFavoritesTitleY"):BX.message("sonetLMenuFavoritesTitleN")}}if(BX("post-menu-"+parseInt(params.logId)+"-link")){var o=BX.findChild(t.popupContainer,{className:"feed-entry-popup-menu-link"},true,false);if(o){var n=parseInt(!!o.getAttribute("bx-height")?o.getAttribute("bx-height"):0);if(n>0){BX("post-menu-"+parseInt(params.logId)+"-link").style.display="none";o.setAttribute("bx-status","hidden");o.style.height=n+"px"}}}}}:{};menuWaiterPopup.destroy();BX.PopupMenu.show("blog-post-"+params.postId,params.bindNode,menuItems,{offsetLeft:-14,offsetTop:4,lightShadow:false,angle:{position:"top",offset:50},events:popupEvents});return false},onfailure:function(t){menuWaiterPopup.destroy();return false}})}})();(function(){if(!!window.SBPImpPost)return false;window.SBPImpPost=function(t){if(t.getAttribute("sbpimppost")=="Y")return false;this.CID="sbpimppost"+(new Date).getTime();this.busy=false;this.node=t;this.btn=t.parentNode;this.block=t.parentNode.parentNode;this.postId=t.getAttribute("bx-blog-post-id");t.setAttribute("sbpimppost","Y");BX.onCustomEvent(this.node,"onInit",[this]);if(this.postId>0)this.onclick();return false};window.SBPImpPost.prototype.onclick=function(){this.sendData()};window.SBPImpPost.prototype.showClick=function(){var t=this.btn.offsetWidth,e=BX.message("BLOG_ALREADY_READ"),s=BX.create("span",{props:{className:"have-read-text-block"},html:"<i></i>"+e+'<span class="feed-imp-post-footer-comma">,</span>'});this.block.style.minWidth=this.btn.offsetWidth-27+"px";var i=new BX.easing({duration:250,start:{width:t},finish:{width:1},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate(function(t){this.btn.style.width=t.width+"px"},this),complete:BX.delegate(function(){this.btn.innerHTML="";this.btn.appendChild(s);var t=s.offsetWidth,e=new BX.easing({duration:300,start:{width_2:0},finish:{width_2:t},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:BX.delegate(function(t){this.btn.style.width=t.width_2+"px"},this)});e.animate()},this)});i.animate()};window.SBPImpPost.prototype.wait=function(t){t=t=="show"?"show":"hide";if(t=="show"){this.node.disabled=true;BX.addClass(this.node,"ui-btn-clock")}else{BX.removeClass(this.node,"ui-btn-clock")}};window.SBPImpPost.prototype.sendData=function(){if(this.busy)return false;this.busy=true;window["node"]=this.node;window["obj"]=this;this.wait("show");var t={options:[{post_id:this.postId,name:"BLOG_POST_IMPRTNT",value:"Y"}],sessid:BX.bitrix_sessid()},e=this.node.getAttribute("bx-url");BX.onCustomEvent(this.node,"onSend",[t]);t=BX.ajax.prepareData(t);if(t){e+=(e.indexOf("?")!==-1?"&":"?")+t;t=""}BX.ajax({method:"GET",url:e,dataType:"json",onsuccess:BX.delegate(function(t){this.busy=false;this.wait("hide");this.showClick();BX.onCustomEvent(this.node,"onUserVote",[t]);BX.onCustomEvent("onImportantPostRead",[this.postId,this.CID])},this),onfailure:BX.delegate(function(t){this.busy=false;this.wait("hide")},this)})};top.SBPImpPostCounter=function(t,e,s){this.parentNode=t;this.node=BX.findChild(t,{tagName:"A"});if(!this.node)return false;BX.addCustomEvent(this.node,"onUserVote",BX.delegate(function(t){this.change(t)},this));this.parentNode.SBPImpPostCounter=this;this.node.setAttribute("status","ready");this.node.setAttribute("inumpage",0);this.postId=e;this.popup=null;this.data=[];BX.bind(t,"click",BX.proxy(function(){this.get()},this));BX.bind(t,"mouseover",BX.proxy(function(t){this.init(t)},this));BX.bind(t,"mouseout",BX.proxy(function(t){this.init(t)},this));this.pathToUser=s["pathToUser"];this.nameTemplate=s["nameTemplate"];this.onPullEvent=BX.delegate(function(t,e){if(t=="read"&&!!e&&e["POST_ID"]==this.postId){if(!!e["data"]){this.change(e["data"]);if(this.popup!=null){this.popup.isNew=true}}}},this);BX.addCustomEvent("onPullEvent-socialnetwork",this.onPullEvent)};top.SBPImpPostCounter.prototype.click=function(t){t.uController=this;BX.addCustomEvent(t.node,"onUserVote",BX.proxy(this.change,this));BX.addCustomEvent(t.node,"onSend",BX.proxy(function(t){t["PATH_TO_USER"]=this.pathToUser;t["NAME_TEMPLATE"]=this.nameTemplate;t["iNumPage"]=0;t["ID"]=this.postId;t["post_id"]=this.postId;t["name"]="BLOG_POST_IMPRTNT";t["value"]="Y";t["return"]="users"},this));this.btnObj=t};top.SBPImpPostCounter.prototype.change=function(t){if(!!t&&!!t.items){var e=false;this.data=[];for(var s in t.items){if(t.items.hasOwnProperty(s)){this.data.push(t.items[s])}}if(t["StatusPage"]=="done"){this.node.setAttribute("inumpage","done")}else this.node.setAttribute("inumpage",1);BX.adjust(this.parentNode,{style:{display:"inline-block"}})}else{this.node.setAttribute("inumpage","done");BX.hide(this.parentNode)}this.node.firstChild.innerHTML=t["RecordCount"]};top.SBPImpPostCounter.prototype.init=function(t){if(!!this.node.timeoutOver){clearTimeout(this.node.timeoutOver);this.node.timeoutOver=false}if(t.type=="mouseover"){if(!this.node.mouseoverFunc){this.node.mouseoverFunc=BX.delegate(function(){this.get();if(this.popup){BX.bind(this.popup.popupContainer,"mouseout",BX.proxy(function(){this.popup.timeoutOut=setTimeout(BX.proxy(function(){if(!!this.popup){this.popup.close()}},this),400)},this));BX.bind(this.popup.popupContainer,"mouseover",BX.proxy(function(){if(this.popup.timeoutOut)clearTimeout(this.popup.timeoutOut)},this))}},this)}this.node.timeoutOver=setTimeout(this.node.mouseoverFunc,400)}};top.SBPImpPostCounter.prototype.get=function(){if(this.node.getAttribute("inumpage")!="done")this.node.setAttribute("inumpage",parseInt(this.node.getAttribute("inumpage"))+1);this.show();if(this.data.length>0){this.make(this.node.getAttribute("inumpage")!="done")}if(this.node.getAttribute("inumpage")!="done"){this.node.setAttribute("status","busy");BX.ajax({url:"/bitrix/components/bitrix/socialnetwork.blog.blog/users.php",method:"POST",dataType:"json",data:{ID:this.postId,post_id:this.postId,name:"BLOG_POST_IMPRTNT",value:"Y",iNumPage:this.node.getAttribute("inumpage"),PATH_TO_USER:this.pathToUser,NAME_TEMPLATE:this.nameTemplate,sessid:BX.bitrix_sessid(),lang:BX.message("LANGUAGE_ID"),site:BX.message("SITE_ID")},onsuccess:BX.proxy(function(t){if(!!t&&!!t.items){var e=false;for(var s in t.items){this.data.push(t.items[s])}if(t.StatusPage=="done"){this.node.setAttribute("inumpage","done")}this.make(this.node.getAttribute("inumpage")!="done")}else{this.node.setAttribute("inumpage","done")}this.node.firstChild.innerHTML=t["RecordCount"];this.node.setAttribute("status","ready")},this),onfailure:BX.proxy(function(t){this.node.setAttribute("status","ready")},this)})}};top.SBPImpPostCounter.prototype.show=function(){if(this.popup==null){this.popup=new BX.PopupWindow("bx-vote-popup-cont-"+this.postId,this.node,{lightShadow:true,offsetTop:-2,offsetLeft:3,autoHide:true,closeByEsc:true,bindOptions:{position:"top"},events:{onPopupClose:function(){this.destroy()},onPopupDestroy:BX.proxy(function(){this.popup=null},this)},content:BX.create("SPAN",{props:{className:"bx-ilike-wait"}})});this.popup.isNew=true;this.popup.show()}this.popup.setAngle({position:"bottom"});this.popup.bindOptions.forceBindPosition=true;this.popup.adjustPosition();this.popup.bindOptions.forceBindPosition=false};top.SBPImpPostCounter.prototype.make=function(t){if(!this.popup)return true;t=t!==false;var e=this.popup&&this.popup.contentContainer?this.popup.contentContainer:BX("popup-window-content-bx-vote-popup-cont-"+this.postId),s=false,i=false,o=this.data;if(this.popup.isNew){s=BX.create("SPAN",{props:{className:"bx-ilike-popup"},children:[BX.create("SPAN",{props:{className:"bx-ilike-bottom_scroll"}})]});i=BX.create("SPAN",{props:{className:"bx-ilike-wrap-block"},children:[s]})}else{s=BX.findChild(this.popup.contentContainer,{className:"bx-ilike-popup"},true)}if(!!s){var n=null;for(var a in o){if(o.hasOwnProperty(a)){if(!BX.findChild(s,{tag:"A",attr:{id:"u"+o[a]["ID"]}},true)){if(o[a]["PHOTO_SRC"].length>0){n=BX.create("IMG",{attrs:{src:o[a]["PHOTO_SRC"]},props:{className:"bx-ilike-popup-avatar-img"}})}else{n=BX.create("IMG",{attrs:{src:"/bitrix/images/main/blank.gif"},props:{className:"bx-ilike-popup-avatar-img bx-ilike-popup-avatar-img-default"}})}s.appendChild(BX.create("A",{attrs:{id:"u"+o[a]["ID"]},props:{href:o[a]["URL"].length>0?o[a]["URL"]:"#",target:"_blank",className:"bx-ilike-popup-img"+(!!o[a]["TYPE"]?" bx-ilike-popup-img-"+o[a]["TYPE"]:"")},text:"",children:[BX.create("SPAN",{props:{className:"bx-ilike-popup-avatar-new"},children:[n,BX.create("SPAN",{props:{className:"bx-ilike-popup-avatar-status-icon"}})]}),BX.create("SPAN",{props:{className:"bx-ilike-popup-name-new"},html:o[a]["FULL_NAME"]})],events:{click:o[a]["URL"].length>0?function(t){return true}:function(t){BX.PreventDefault(t)}}}))}}}if(t){BX.bind(s,"scroll",BX.proxy(this.popupScrollCheck,this))}}if(this.popup.isNew){this.popup.isNew=false;if(!!e){try{e.removeChild(e.firstChild)}catch(t){}e.appendChild(i)}}if(this.popup!=null){this.popup.bindOptions.forceBindPosition=true;this.popup.adjustPosition();this.popup.bindOptions.forceBindPosition=false}};top.SBPImpPostCounter.prototype.popupScrollCheck=function(){var t=BX.proxy_context;if(t.scrollTop>(t.scrollHeight-t.offsetHeight)/1.5){BX.unbind(t,"scroll",BX.proxy(this.popupScrollCheck,this));this.get()}}})(window);window.showSharing=function(t,e){BX("sharePostId").value=t;BX("shareUserId").value=e;var s=BX("blogShare").getAttribute("bx-selector-id");if(!BX.type.isNotEmptyString(s)){return}var i=BX.UI.SelectorManager.instances[s];if(!BX.type.isNotEmptyObject(i)){return}var o={},n=[],a=null;if(window["postDest"+t]){for(var p=0;p<window["postDest"+t].length;p++){a=window["postDest"+t][p];o[a.id]=a.type;n.push(a.id)}BX.onCustomEvent("BX.Main.SelectorV2:reInitDialog",[{selectorId:s,selectedItems:o,undeletableItems:n}]);var r=BX("destination-sharing");if(BX("blg-post-destcont-"+t)){BX("blg-post-destcont-"+t).appendChild(r)}r.style.height=0;r.style.opacity=0;r.style.overflow="hidden";r.style.display="inline-block";new BX.easing({duration:500,start:{opacity:0,height:0},finish:{opacity:100,height:r.scrollHeight-40},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){r.style.height=t.height+"px";r.style.opacity=t.opacity/100},complete:function(){r.style.cssText=""}}).animate()}};window.closeSharing=function(){var t=BX("destination-sharing");if(BX("sharePostSubmitButton")){BX.removeClass(BX("sharePostSubmitButton"),"ui-btn-clock")}new BX.easing({duration:500,start:{opacity:100,height:t.scrollHeight-40},finish:{opacity:0,height:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(e){t.style.height=e.height+"px";t.style.opacity=e.opacity/100},complete:function(){BX.hide(t)}}).animate()};window.sharingPost=function(){var t=BX("sharePostId").value;var e=BX("shareUserId").value;var s=BX("blogShare");var i=socBPDest.shareUrl.replace(/#post_id#/,t).replace(/#user_id#/,e);i=BX.util.remove_url_param(i,["b24statAction"]);i=BX.util.add_url_param(i,{b24statAction:"sharePost"});if(BX("sharePostSubmitButton")){BX.addClass(BX("sharePostSubmitButton"),"ui-btn-clock")}s.action=i;s.target="";var o,n="";var a=s.elements.length;var p="";for(o=0;o<a;o++){if(n!="")p="&";var r=s.elements[o];if(r.disabled)continue;switch(r.type.toLowerCase()){case"text":case"hidden":n+=p+r.name+"="+BX.util.urlencode(r.value);break;default:break}}n+="&save=Y&MODE=RECORD&AJAX_POST=Y&ENTITY_XML_ID=BLOG_"+t;var u=renderSharingPost(t);BX.ajax({method:"POST",dataType:"json",url:i,data:n,onsuccess:function(e){if(typeof e=="undefined"||typeof e.status=="undefined"||e.status!="success"){hideRenderedSharingNodes(u);if(typeof e.status!="undefined"&&e.status=="error"&&typeof e.errorMessage!="undefined"){var s=new BX.PopupWindow("error_popup",BX("blg-post-inform-"+t),{lightShadow:true,offsetTop:-10,offsetLeft:100,autoHide:true,closeByEsc:true,closeIcon:{right:"5px",top:"5px"},draggable:{restrict:true},contentColor:"white",contentNoPaddings:true,bindOptions:{position:"bottom"},content:BX.create("DIV",{props:{className:"feed-create-task-popup-content"},children:[BX.create("DIV",{props:{className:"feed-create-task-popup-description"},text:e.errorMessage})]})});s.show()}}else{var i=e;BX.onCustomEvent(window,"OnUCAfterRecordAdd",["BLOG_"+t,e,i])}},onfailure:function(t){hideRenderedSharingNodes(u)}});closeSharing()};window.renderSharingPost=function(t){var e=[];var s="";var i=BX.findChildren(BX("feed-add-post-destination-item-post"),{className:"feed-add-post-destination"},true);if(i!=null){var o=BX("blog-destination-hidden-"+t);if(!o){var n=BX.findChildren(BX("blg-post-img-"+t),{className:"feed-add-post-destination-new"},true);var a=n[n.length-1]}for(var p=0;p<i.length;p++){if(!BX.hasClass(i[p],"feed-add-post-destination-undelete")){var r=BX.findChild(i[p],{className:"feed-add-post-destination-text"},false,false).innerHTML;var u=BX.findChild(i[p],{tag:"input"},false,false);var d=u.value;var l="feed-add-post-destination-new";if(BX.hasClass(i[p],"feed-add-post-destination-email")){l+=" feed-add-post-destination-new-email"}else if(BX.hasClass(i[p],"feed-add-post-destination-extranet")){l+=" feed-add-post-destination-new-extranet"}var h;if(u.name=="SPERM[SG][]")h="sonetgroups";else if(u.name=="SPERM[DR][]")h="department";else if(u.name=="SPERM[G][]")h="groups";else if(u.name=="SPERM[U][]")h="users";else if(u.name=="SPERM[UE][]")h="users";else if(u.name=="SPERM[UA][]")h="groups";if(h.length>0){window["postDest"+t].push({id:d,name:r,type:h});s="post_"+t+"_dest_"+d;e.push(s);var f=BX.create("span",{props:{id:s},children:[BX.create("span",{html:", "}),BX.create("a",{props:{className:l},href:"",html:r})]});if(o){o.appendChild(f)}else if(a){BX(a.parentNode).insertBefore(f,a.nextSibling)}}}}}return e};window.hideRenderedSharingNodes=function(t){var e=false;for(i=0;i<t.length;i++){e=t[i];if(BX(e)){BX.cleanNode(BX(e),true)}}};(function(){if(!!BX.SBPostManager)return false;BX.SBPostManager=function(){this.inited=false;this.tagLinkPattern=""};BX.SBPostManager.prototype.init=function(t){this.tagLinkPattern=BX.type.isNotEmptyString(t.tagLinkPattern)?t.tagLinkPattern:"";this.inited=true};BX.SBPostManager.prototype.clickTag=function(t){var e=false;if(BX.type.isNotEmptyString(t)&&BX.type.isNotEmptyString(this.tagLinkPattern)){top.location.href=this.tagLinkPattern.replace("#tag#",t);e=true}return e}})();if(typeof oSBPostManager=="undefined"){oSBPostManager=new BX.SBPostManager;window.oSBPostManager=oSBPostManager}
//# sourceMappingURL=script.map.js