this.BX=this.BX||{};(function(t,e,i,n,a,s,r,c,o,l,d){"use strict";var u={name:"conference-field-title",component:{props:{mode:{type:String},title:{type:String},defaultValue:{type:String}},data:function t(){return{name:"title"}},computed:{isViewMode:function t(){return this.mode===l.ConferenceFieldState.view},localize:function t(){return BX.message}},methods:{switchToEdit:function t(){this.$emit("switchToEdit",this.name)},onInput:function t(e){this.$emit("titleChange",e.target.value)},onFocus:function t(e){var i=this;if(this.name===e){this.$nextTick((function(){i.$refs["input"].focus()}))}}},created:function t(){this.$root.$on("focus",this.onFocus)},template:'\n\t\t\t\t\t<div class="im-conference-create-section">\n\t\t\t\t\t\t<div class="im-conference-create-field">\n\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-title">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_TITLE_LABEL\'] }}</label>\n\t\t\t\t\t\t\t<div v-if="!isViewMode" class="im-conference-create-field-title-container ui-ctl">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tid="im-conference-create-field-title"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t:name="name"\n\t\t\t\t\t\t\t\t\t:placeholder="defaultValue"\n\t\t\t\t\t\t\t\t\t:value="title"\n\t\t\t\t\t\t\t\t\t@input="onInput"\n\t\t\t\t\t\t\t\t\tref="input"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-else @click="switchToEdit" class="im-conference-create-field-view">{{ title }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t'}};var f={name:"conference-field-password",component:{props:{mode:{type:String},password:{type:String},passwordNeeded:{type:Boolean}},data:function t(){return{name:"password"}},computed:{isViewMode:function t(){return this.mode===l.ConferenceFieldState.view},codedValue:function t(){if(this.passwordNeeded){return"".concat(this.localize["BX_IM_COMPONENT_CONFERENCE_PASSWORD_EXISTS"]," (").concat(this.password.replace(/./g,"*"),")")}else{return this.localize["BX_IM_COMPONENT_CONFERENCE_NO_PASSWORD"]}},localize:function t(){return BX.message}},methods:{switchToEdit:function t(){this.$emit("switchToEdit",this.name)},onInput:function t(e){this.$emit("passwordChange",e.target.value)},onPasswordNeededChange:function t(){this.$emit("passwordNeededChange")},onFocus:function t(e){var i=this;if(this.name===e){this.$nextTick((function(){if(i.$refs["input"]){i.$refs["input"].focus()}}))}}},created:function t(){this.$root.$on("focus",this.onFocus)},template:'\n\t\t\t\t\t<div class="im-conference-create-section im-conference-create-password-section">\n\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-password">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_PASSWORD_LABEL\'] }}</label>\n\t\t\t\t\t\t<template v-if="!isViewMode">\n\t\t\t\t\t\t\t<div class="im-conference-create-field-inline">\n\t\t\t\t\t\t\t\t<input @input="onPasswordNeededChange" type="checkbox" id="im-conference-create-field-password-checkbox" :checked="passwordNeeded">\n\t\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-password-checkbox">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_PASSWORD_CHECKBOX_LABEL\'] }}</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if="passwordNeeded" class="im-conference-create-field-password-container ui-ctl">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tid="im-conference-create-field-password"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t:name="name"\n\t\t\t\t\t\t\t\t\t:placeholder="localize[\'BX_IM_COMPONENT_CONFERENCE_PASSWORD_PLACEHOLDER\']"\n\t\t\t\t\t\t\t\t\t:value="password"\n\t\t\t\t\t\t\t\t\t@input="onInput"\n\t\t\t\t\t\t\t\t\tref="input"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<div v-else @click="switchToEdit" class="im-conference-create-field-view">{{ codedValue }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t'}};var h={name:"conference-field-invitation",component:{props:{invitation:{type:Object},chatHost:{type:Object},title:{type:String},defaultTitle:{type:String},publicLink:{type:String},formMode:{type:String}},data:function t(){return{initialValue:null,editedValue:null}},computed:{isViewMode:function t(){return this.invitation.mode===l.ConferenceFieldState.view},isFormCreateMode:function t(){return this.formMode===l.ConferenceFieldState.create},avatarClasses:function t(){var e=["im-conference-create-invitation-user-avatar"];if(!this.chatHost.AVATAR){e.push("im-conference-create-invitation-user-avatar-default")}return e},avatarStyles:function t(){var e={};if(this.chatHost.AVATAR){e.backgroundImage="url(".concat(this.chatHost.AVATAR,")")}return e},formattedInvitation:function t(){var e=this.title?this.title:"";if(this.isFormCreateMode&&!this.title){e=this.defaultTitle}return this.invitation.value.replace(/#CREATOR#/gm,a.Text.encode(this.chatHost.FULL_NAME)).replace(/#TITLE#/gm,'"'.concat(a.Text.encode(e),'"')).replace(/#LINK#/gm,'<a href="'.concat(this.publicLink,'" target="_blank">').concat(this.publicLink,"</a>"))},localize:function t(){return BX.message}},methods:{onEditClick:function t(){var e=this;var i=this.$refs["view"].offsetWidth;var n=this.$refs["view"].offsetHeight;this.invitation.mode=l.ConferenceFieldState.edit;this.invitation.value=a.Text.decode(this.invitation.value);this.$nextTick((function(){e.$refs["editor"].style.width=i+20+"px";e.$refs["editor"].style.height=n+30+"px";e.$refs["editor"].focus()}))},onInput:function t(e){if(!this.initialValue){this.initialValue=this.invitation.value}this.editedValue=a.Text.encode(e.target.value)},saveChanges:function t(){if(this.editedValue&&this.initialValue&&this.initialValue!==this.editedValue){this.invitation.value=this.editedValue;this.initialValue=null;this.editedValue=null;this.$emit("invitationUpdate",this.invitation.value)}else{this.invitation.value=a.Text.encode(this.invitation.value)}this.invitation.mode=l.ConferenceFieldState.view},discardChanges:function t(){if(this.initialValue){this.invitation.value=this.initialValue;this.initialValue=null;this.editedValue=null}this.invitation.value=a.Text.encode(this.invitation.value);this.invitation.mode=l.ConferenceFieldState.view}},created:function t(){if(this.isFormCreateMode||!this.invitation.value){this.invitation.value=this.localize["BX_IM_COMPONENT_CONFERENCE_DEFAULT_INVITATION"]}if(!this.isFormCreateMode&&this.invitation.value){this.invitation.value=a.Text.encode(this.invitation.value)}},template:'\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="im-conference-create-section im-conference-create-invitation-title">\n\t\t\t\t\t\t\t{{ localize[\'BX_IM_COMPONENT_CONFERENCE_INVITATION_TITLE\'] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="im-conference-create-section im-conference-create-invitation-wrap">\n\t\t\t\t\t\t\t<div class="im-conference-create-invitation-user">\n\t\t\t\t\t\t\t\t<div :class="avatarClasses" :style="avatarStyles"></div>\n\t\t\t\t\t\t\t\t<div class="im-conference-create-invitation-user-name">{{ chatHost.FIRST_NAME }}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="im-conference-create-invitation-content">\n\t\t\t\t\t\t\t\t<template v-if="isViewMode">\n\t\t\t\t\t\t\t\t\t<div @click="onEditClick" v-html="formattedInvitation" contenteditable="false" ref="view" class="im-conference-create-invitation-content-text"></div>\n\t\t\t\t\t\t\t\t\t<div @click="onEditClick" class="im-conference-create-invitation-edit"></div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<textarea @input="onInput" :value="invitation.value" class="im-conference-create-invitation-editor" ref="editor"></textarea>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<button @click="saveChanges" class="ui-btn ui-btn-sm ui-btn-primary">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_SAVE\'] }}</button>\n\t\t\t\t\t\t\t\t\t\t<button @click="discardChanges" class="ui-btn ui-btn-sm ui-btn-light">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_CANCEL\'] }}</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t'}};var m={name:"conference-field-planner",component:{props:{mode:{type:String},selectedUsers:{type:Array,default:[]},chatHost:{type:Object,default:[]},selectedDate:{type:String,default:""},selectedTime:{type:String,default:""},selectedDuration:{type:String,default:"30"},selectedDurationType:{type:String,default:"m"}},data:function t(){return{name:"planner",clockInstance:null,planner:null}},computed:{isViewMode:function t(){return this.mode===l.ConferenceFieldState.view},userListForPlanner:function t(){return this.selectedUsers.map((function(t){return"U".concat(t.id)}))},userListForSelector:function t(){return this.selectedUsers.map((function(t){return["user",t.id]}))},formattedDateForView:function t(){return"".concat(this.selectedDate,", ").concat(this.selectedTime)},formattedDurationForView:function t(){var e;if(this.selectedDurationType==="m"){e=this.localize("BX_IM_COMPONENT_CONFERENCE_DURATION_MINUTES")}else if(this.selectedDurationType==="h"){e=this.localize("BX_IM_COMPONENT_CONFERENCE_DURATION_HOURS")}return"".concat(this.selectedDuration," ").concat(e)},startDateTime:function t(){return BX.parseDate("".concat(this.selectedDate," ").concat(this.selectedTime))},endDateTime:function t(){var e=Number(this.selectedDuration);var i=this.selectedDurationType;if(i==="h"){e*=60*60*1e3}else{e*=60*1e3}var t=new Date;t.setTime(this.startDateTime.getTime()+e);return t},localize:function t(){return BX.message}},methods:{switchToEdit:function t(){this.$emit("switchToEdit",this.name);this.$nextTick((function(){}))},onDateFieldClick:function t(e){var i=this;if(a.Reflection.getClass("BX.calendar")){BX.calendar({node:e.currentTarget,field:this.$refs["dateInput"],bTime:false,callback_after:function t(e){i.$emit("dateChange",e)}})}return false},onTimeFieldClick:function t(){var e=this;this.clockInstance.setNode(this.$refs["timeInput"]);this.clockInstance.setTime(this.convertToSeconds(this.selectedTime));this.clockInstance.setCallback((function(t){e.$emit("timeChange",t);BX.fireEvent(e.$refs["timeInput"],"change");e.clockInstance.closeWnd()}));this.clockInstance.Show()},onUpdateDateTime:function t(){var e=this;setTimeout((function(){e.planner.updateSelector(e.startDateTime,e.endDateTime,false)}),0)},onDurationChange:function t(e){this.$emit("durationChange",e.target.value);this.onUpdateDateTime()},onDurationTypeChange:function t(e){this.$emit("durationTypeChange",e.target.value);this.onUpdateDateTime()},convertToSeconds:function t(e){var i=e.split(/[\s:]+/);var n=parseInt(i[0],10);var a=parseInt(i[1],10);if(i.length===3){var s=i[2];if(s==="pm"&&n<12){n=n+12}if(s==="am"&&n===12){n=0}}var r=n*3600;var c=a*60;return r+c},onUserSelect:function t(e){this.$emit("userSelect",e)},onUserDeselect:function t(e){this.$emit("userDeselect",e)},onUpdateUserSelector:function t(){var e=this;this.$nextTick((function(){e.$refs["userSelector"].innerHTML="";e.initUserSelector();e.userSelector.renderTo(e.$refs["userSelector"])}))},onSwitchModeForAll:function t(e){if(e===l.ConferenceFieldState.edit){this.switchToEdit()}},initUserSelector:function t(){var e=this;this.userSelector=new d.TagSelector({id:"user-tag-selector",dialogOptions:{id:"user-tag-selector",preselectedItems:this.userListForSelector,undeselectedItems:[["user",this.chatHost.ID]],events:{"Item:onSelect":function t(i){e.onUserSelect(i)},"Item:onDeselect":function t(i){e.onUserDeselect(i)}},entities:[{id:"user"},{id:"department"}]}})},initClock:function t(){this.clockInstance=new BX.CClockSelector({start_time:this.convertToSeconds(this.selectedTime),node:this.$refs["timeInput"],callback:function t(){}})},initPlanner:function t(){var e=this;this.planner=new s.Planner({wrap:this.$refs["plannerNode"],showEntryName:true,showEntriesHeader:false,entriesListWidth:200,compactMode:false});this.planner.show();this.planner.subscribe("onDateChange",(function(t){e.onPlannerSelectorChange(t)}))},updatePlanner:function t(){var e=this;if(this.selectedUsers.length>0){a.ajax.runAction("calendar.api.calendarajax.updatePlanner",{data:{codes:this.userListForPlanner,dateFrom:r.Util.formatDate(this.startDateTime.getTime()-r.Util.getDayLength()*3),dateTo:r.Util.formatDate(this.startDateTime.getTime()+r.Util.getDayLength()*10)}}).then((function(t){e.planner.update(t.data.entries,t.data.accessibility);e.planner.updateSelector(e.startDateTime,e.endDateTime,false)}))["catch"]((function(t){}))}},onPlannerSelectorChange:function t(e){if(e instanceof c.BaseEvent){var i=e.getData();var n=i.dateFrom;var a=(i.dateTo-i.dateFrom)/1e3/60;var s=this.selectedDurationType;this.$emit("dateChange",n);this.$emit("timeChange",this.$parent.formatTime(n));if(s==="h"&&a%60===0){this.$emit("durationChange",a/60);this.$emit("durationTypeChange","h")}else{this.$emit("durationChange",a);this.$emit("durationTypeChange","m")}}},getUserAvatarStyle:function t(e){if(e.avatar){return{backgroundImage:"url('".concat(encodeURI(e.avatar),"')")}}return{}}},created:function t(){},mounted:function t(){var e=this;this.initUserSelector();this.userSelector.renderTo(this.$refs["userSelector"]);this.$root.$on("switchModeForAll",(function(t){e.onSwitchModeForAll(t)}));this.$root.$on("updateUserSelector",(function(){e.onUpdateUserSelector()}))},template:'\n\t\t\t\t\t<div class="im-conference-create-section im-conference-create-planner-block">\n\t\t\t\t\t\t\x3c!-- Date block --\x3e\n\x3c!--\t\t\t\t\t\t<div v-if="!isViewMode" class="im-conference-create-date-block">--\x3e\n\x3c!--\t\t\t\t\t\t\t<div class="im-conference-create-date-block-left">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-date-time">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_START_DATE_AND_TIME\'] }}</label>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div class="im-conference-create-date-block-left-fields">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t&lt;!&ndash; Date field &ndash;&gt;--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t<div @click="onDateFieldClick" class="ui-ctl ui-ctl-after-icon ui-ctl-date im-conference-create-field-date-container">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<div class="ui-ctl-after ui-ctl-icon-calendar"></div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<input @change="onUpdateDateTime" type="text" class="ui-ctl-element" ref="dateInput" :value="selectedDate">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t&lt;!&ndash; Time field &ndash;&gt;--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t<div @click="onTimeFieldClick" class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown im-conference-create-field-time-container">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<div class="ui-ctl-after ui-ctl-icon-angle"></div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<div @change="onUpdateDateTime" class="ui-ctl-element" ref="timeInput">{{ selectedTime }}</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t<div class="im-conference-create-date-block-right">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-date-time">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_DURATION\'] }}</label>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div class="im-conference-create-date-block-right-fields">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t&lt;!&ndash; Duration field &ndash;&gt;--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t<div class="ui-ctl im-conference-create-field-duration-container">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<input @change="onDurationChange" type="text" class="ui-ctl-element" :value="selectedDuration">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t&lt;!&ndash; Duration type field &ndash;&gt;--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown im-conference-create-field-duration-type-container">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<div class="ui-ctl-after ui-ctl-icon-angle"></div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t<select @change="onDurationTypeChange" class="ui-ctl-element">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t\t<option value="m" :selected="selectedDurationType === \'m\'">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_DURATION_MINUTES\'] }}</option>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t\t<option value="h" :selected="selectedDurationType === \'h\'">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_DURATION_HOURS\'] }}</option>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t\t</select>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t<template v-else-if="isViewMode">--\x3e\n\x3c!--\t\t\t\t\t\t\t<div class="im-conference-create-field">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div class="im-conference-create-label">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_START_DATE_AND_TIME\'] }}</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div @click="switchToEdit" class="im-conference-create-field-view">{{ formattedDateForView }}</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t<div class="im-conference-create-field">--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div class="im-conference-create-label">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_DURATION\'] }}</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t\t<div @click="switchToEdit" class="im-conference-create-field-view">{{ formattedDurationForView }}</div>--\x3e\n\x3c!--\t\t\t\t\t\t\t</div>--\x3e\n\x3c!--\t\t\t\t\t\t</template>--\x3e\n\t\t\t\t\t\t<div v-show="!isViewMode">\n\x3c!--\t\t\t\t\t\t\t<div class="im-conference-create-delimiter"></div>--\x3e\n\t\t\t\t\t\t\t\x3c!-- User selector block --\x3e\n\t\t\t\t\t\t\t<div class="im-conference-create-user-selector-block">\n\t\t\t\t\t\t\t\t<div class="im-conference-create-field">\n\t\t\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-user-selector">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_USER_SELECTOR_LABEL\'] }}</label>\n\t\t\t\t\t\t\t\t\t<div class="im-conference-create-user-selector" ref="userSelector"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!-- Planner block --\x3e\n\x3c!--\t\t\t\t\t\t\t<div v-show="selectedUsers.length > 0" class="im-conference-create-planner-block" ref="plannerNode"></div>--\x3e\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-show="isViewMode" class="im-conference-create-field im-conference-create-users-view">\n\t\t\t\t\t\t\t<div class="im-conference-create-label">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_USER_SELECTOR_LABEL\'] }}</div>\n\t\t\t\t\t\t\t<div @click="switchToEdit" class="im-conference-create-users-view-content">\n\t\t\t\t\t\t\t\t<div v-for="user in selectedUsers" :key="user.id" class="im-conference-create-users-view-item">\n\t\t\t\t\t\t\t\t\t<div class="im-conference-create-users-view-avatar" :style="getUserAvatarStyle(user)"></div>\n\t\t\t\t\t\t\t\t\t<div class="im-conference-create-users-view-title">{{ user.title }}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t'}};var v={name:"conference-field-broadcast",component:{props:{mode:{type:String},broadcastMode:{type:Boolean},chatHost:{type:Object},selectedPresenters:{type:Array}},data:function t(){return{name:"broadcast"}},computed:{isViewMode:function t(){return this.mode===l.ConferenceFieldState.view},codedValue:function t(){if(this.broadcastMode){return this.localize["BX_IM_COMPONENT_CONFERENCE_BROADCAST_MODE_ON"]}else{return this.localize["BX_IM_COMPONENT_CONFERENCE_BROADCAST_MODE_OFF"]}},presenterListForSelector:function t(){return this.selectedPresenters.map((function(t){return["user",t.id]}))},localize:function t(){return BX.message}},methods:{switchToEdit:function t(){this.$emit("switchToEdit",this.name)},onBroadcastModeChange:function t(){this.$emit("broadcastModeChange")},onSwitchModeForAll:function t(e){if(e===l.ConferenceFieldState.edit){this.switchToEdit()}},onPresenterSelect:function t(e){this.$emit("presenterSelect",e)},onPresenterDeselect:function t(e){this.$emit("presenterDeselect",e)},getUserAvatarStyle:function t(e){if(e.avatar){return{backgroundImage:"url('".concat(encodeURI(e.avatar),"')")}}return{}},initPresenterSelector:function t(){var e=this;this.presenterSelector=new d.TagSelector({id:"presenter-tag-selector",dialogOptions:{id:"presenter-tag-selector",preselectedItems:this.presenterListForSelector,events:{"Item:onSelect":function t(i){e.onPresenterSelect(i)},"Item:onDeselect":function t(i){e.onPresenterDeselect(i)}},entities:[{id:"user"},{id:"department"}]}})},onUpdatePresenterSelector:function t(){var e=this;this.$nextTick((function(){e.$refs["presenterSelector"].innerHTML="";e.initPresenterSelector();e.presenterSelector.renderTo(e.$refs["presenterSelector"])}))}},mounted:function t(){var e=this;this.initPresenterSelector();this.presenterSelector.renderTo(this.$refs["presenterSelector"]);this.$root.$on("switchModeForAll",(function(t){e.onSwitchModeForAll(t)}));this.$root.$on("updatePresenterSelector",(function(){e.onUpdatePresenterSelector()}))},template:'\n\t\t\t\t<div class="im-conference-create-section im-conference-create-broadcast-section">\n\t\t\t\t\t<div class="im-conference-create-broadcast-section-title">\n\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-broadcast">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BROADCAST_LABEL\'] }}</label>\n\t\t\t\t\t\t<bx-hint :text="localize[\'BX_IM_COMPONENT_CONFERENCE_BROADCAST_HINT\']"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show="!isViewMode">\n\t\t\t\t\t\t<div class="im-conference-create-field-inline im-conference-create-field-broadcast">\n\t\t\t\t\t\t\t<input @input="onBroadcastModeChange" type="checkbox" id="im-conference-create-field-broadcast-checkbox" :checked="broadcastMode">\n\t\t\t\t\t\t\t<label class="im-conference-create-label" for="im-conference-create-field-broadcast-checkbox">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BROADCAST_CHECKBOX_LABEL\'] }}</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-show="broadcastMode" class="im-conference-create-user-selector-block">\n\t\t\t\t\t\t\t<div class="im-conference-create-field">\n\t\t\t\t\t\t\t\t<label class="im-conference-create-label im-conference-create-label-broadcast" for="im-conference-create-field-user-selector">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_PRESENTER_SELECTOR_LABEL\'] }}</label>\n\t\t\t\t\t\t\t\t<div class="im-conference-create-user-selector" ref="presenterSelector"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show="isViewMode">\n\t\t\t\t\t\t<div @click="switchToEdit" class="im-conference-create-field-view">{{ codedValue }}</div>\n\t\t\t\t\t\t<div v-if="broadcastMode" @click="switchToEdit" class="im-conference-create-field im-conference-create-users-view">\n\t\t\t\t\t\t\t<div class="im-conference-create-label">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_PRESENTER_SELECTOR_LABEL\'] }}</div>\n\t\t\t\t\t\t\t<div class="im-conference-create-users-view-content">\n\t\t\t\t\t\t\t\t<div v-for="user in selectedPresenters" :key="user.id" class="im-conference-create-users-view-item">\n\t\t\t\t\t\t\t\t\t<div class="im-conference-create-users-view-avatar" :style="getUserAvatarStyle(user)"></div>\n\t\t\t\t\t\t\t\t\t<div class="im-conference-create-users-view-title">{{ user.title }}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'}};var p=[u,f,h,m,v];var E={};p.forEach((function(t){E[t.name]=t.component}));e.BitrixVue.component("bx-im-component-conference-edit",{props:{conferenceId:{type:Number,default:0},fieldsData:{type:Object,default:{}},mode:{type:String,default:l.ConferenceFieldState.create},chatHost:{type:Object,default:{}},chatUsers:{type:Array,default:[]},presenters:{type:Array,default:[]},publicLink:{type:String,default:""},chatId:{type:Number,default:0},invitationText:{type:String,default:""},gridId:{type:String,default:""},pathToList:{type:String,default:""},broadcastingEnabled:{type:Boolean,default:false}},data:function t(){return{fieldsMode:{title:this.mode,password:this.mode,planner:this.mode,broadcast:this.mode},fields:{},initialValues:{},title:{currentValue:"",initialValue:"",defaultValue:""},invitation:{value:"",mode:l.ConferenceFieldState.view,edited:false},password:{currentValue:"",initialValue:""},passwordNeeded:{currentValue:false,initialValue:false},selectedUsers:{currentValue:[],initialValue:[]},broadcastMode:{currentValue:false,initialValue:false},selectedPresenters:{currentValue:[],initialValue:[]},selectedDate:{currentValue:"",initialValue:""},selectedTime:{currentValue:"",initialValue:""},selectedDuration:{currentValue:"30",initialValue:"30"},selectedDurationType:{currentValue:"m",initialValue:"m"},errors:[],linkGenerated:false,aliasData:{},isSubmitting:false}},created:function t(){if(this.isFormViewMode){this.title.initialValue=this.fieldsData["TITLE"];this.password.initialValue=this.fieldsData["PASSWORD"];this.broadcastMode.currentValue=this.fieldsData["BROADCAST"];this.invitation.value=this.invitationText;this.passwordNeeded.currentValue=!!this.fieldsData["PASSWORD"];this.publicLink=a.Text.encode(this.publicLink);this.selectedUsers.currentValue=babelHelpers.toConsumableArray(this.chatUsers);if(this.fieldsData["BROADCAST"]){this.selectedPresenters.currentValue=babelHelpers.toConsumableArray(this.presenters)}}else if(this.isFormCreateMode){this.generateLink();this.title.initialValue="";this.password.initialValue="";this.passwordNeeded.currentValue=false;this.broadcastMode.currentValue=false;var e={id:this.chatHost.ID,title:this.chatHost.FULL_NAME,avatar:this.chatHost.AVATAR};this.selectedUsers.currentValue.push(e);this.selectedPresenters.currentValue.push(e)}this.title.currentValue=this.title.initialValue;this.password.currentValue=this.password.initialValue;this.passwordNeeded.initialValue=this.passwordNeeded.currentValue;this.broadcastMode.initialValue=this.broadcastMode.currentValue;this.selectedUsers.initialValue=babelHelpers.toConsumableArray(this.selectedUsers.currentValue);this.selectedPresenters.initialValue=babelHelpers.toConsumableArray(this.selectedPresenters.currentValue);this.setDefaultDateAndTime();this.setDefaultDuration()},mounted:function t(){if(this.isFormCreateMode){this.checkRequirements()}},computed:{isFormCreateMode:function t(){return this.mode===l.ConferenceFieldState.create},isFormViewMode:function t(){return this.mode===l.ConferenceFieldState.view},isTitleEdited:function t(){return this.fieldsMode["title"]===l.ConferenceFieldState.edit},isPasswordEdited:function t(){return this.fieldsMode["password"]===l.ConferenceFieldState.edit},isPlannerEdited:function t(){return this.fieldsMode["planner"]===l.ConferenceFieldState.edit},isPasswordCheckboxEdited:function t(){return this.passwordNeeded.currentValue!==this.passwordNeeded.initialValue},isBroadcastEdited:function t(){return this.fieldsMode["broadcast"]===l.ConferenceFieldState.edit},isEditing:function t(){return this.isFormViewMode&&(this.isTitleEdited||this.isPasswordEdited||this.invitation.edited||this.isPasswordCheckboxEdited||this.isPlannerEdited||this.isBroadcastEdited)},conferenceLink:function t(){if(this.isFormCreateMode){if(this.linkGenerated){return this.aliasData["LINK"]}else{return"#LINK#"}}else if(this.isFormViewMode){return this.publicLink}},submitFormButtonClasses:function t(){var e=["ui-btn","ui-btn-success"];if(this.isSubmitting){e.push("ui-btn-disabled")}return e},localize:function t(){return BX.message}},methods:{switchToEdit:function t(e){this.fieldsMode[e]=l.ConferenceFieldState.edit;this.$root.$emit("focus",e)},switchModeForAllFields:function t(e){for(var i in this.fieldsMode){if(this.fieldsMode.hasOwnProperty(i)){this.fieldsMode[i]=e}}this.$root.$emit("switchModeForAll",e)},onTitleChange:function t(e){this.title.currentValue=e},onPasswordChange:function t(e){this.password.currentValue=e},onPasswordNeededChange:function t(){this.passwordNeeded.currentValue=!this.passwordNeeded.currentValue;if(this.passwordNeeded.currentValue){this.$root.$emit("focus","password")}},onBroadcastModeChange:function t(){this.broadcastMode.currentValue=!this.broadcastMode.currentValue},onInvitationUpdate:function t(e){this.invitation.value=e;this.invitation.edited=true},onUserSelect:function t(e){var i=this.selectedUsers.currentValue.findIndex((function(t){return t.id===e.data.item.id}));if(i===-1){this.selectedUsers.currentValue.push({id:e.data.item.id,title:e.data.item.title,avatar:e.data.item.avatar})}},onUserDeselect:function t(e){var i=this.selectedUsers.currentValue.findIndex((function(t){return t.id===e.data.item.id}));if(i>-1){this.selectedUsers.currentValue.splice(i,1)}},onPresenterSelect:function t(e){var i=this.selectedPresenters.currentValue.findIndex((function(t){return t.id===e.data.item.id}));if(i===-1){this.selectedPresenters.currentValue.push({id:e.data.item.id,title:e.data.item.title,avatar:e.data.item.avatar})}},onPresenterDeselect:function t(e){var i=this.selectedPresenters.currentValue.findIndex((function(t){return t.id===e.data.item.id}));if(i>-1){this.selectedPresenters.currentValue.splice(i,1)}},onDateChange:function t(e){this.selectedDate.currentValue=BX.formatDate(e,BX.message("FORMAT_DATE"))},onTimeChange:function t(e){this.selectedTime.currentValue=e},onDurationChange:function t(e){this.selectedDuration.currentValue=String(e)},onDurationTypeChange:function t(e){this.selectedDurationType.currentValue=e},discardChanges:function t(){this.clearErrors();this.title.currentValue=this.title.initialValue;this.password.currentValue=this.password.initialValue;this.passwordNeeded.currentValue=this.passwordNeeded.initialValue;this.broadcastMode.currentValue=this.broadcastMode.initialValue;this.selectedUsers.currentValue=babelHelpers.toConsumableArray(this.selectedUsers.initialValue);this.$root.$emit("updateUserSelector");this.selectedPresenters.currentValue=babelHelpers.toConsumableArray(this.selectedPresenters.initialValue);this.$root.$emit("updatePresenterSelector");this.selectedDate.currentValue=this.selectedDate.initialValue;this.selectedTime.currentValue=this.selectedTime.initialValue;this.selectedDuration.currentValue=this.selectedDuration.initialValue;this.selectedDurationType.currentValue=this.selectedDurationType.initialValue;this.switchModeForAllFields(l.ConferenceFieldState.view)},copyInvitation:function t(){var e="";if(this.isFormCreateMode&&this.linkGenerated){e=a.Text.decode(this.aliasData["LINK"])}else if(this.isFormViewMode){e=a.Text.decode(this.publicLink)}var i=this.localize["BX_IM_COMPONENT_CONFERENCE_DEFAULT_TITLE"];if(this.title.currentValue){i=this.title.currentValue}var s=a.Text.decode(this.invitation.value).replace(/#CREATOR#/gm,this.chatHost.FULL_NAME).replace(/#TITLE#/gm,'"'.concat(i,'"')).replace(/#LINK#/gm,"".concat(e));n.Clipboard.copy(s);if(a.Reflection.getClass("BX.UI.Notification.Center")){top.BX.UI.Notification.Center.notify({content:this.localize["BX_IM_COMPONENT_CONFERENCE_INVITATION_COPIED"]})}},openChat:function t(){if(window.top["BXIM"]){window.top["BXIM"].openMessenger("chat"+this.chatId)}},editAll:function t(){this.switchModeForAllFields(l.ConferenceFieldState.edit)},submitForm:function t(){var e=this;if(this.isSubmitting){return false}this.isSubmitting=true;var i={};i["title"]=this.title.currentValue;i["password_needed"]=this.passwordNeeded.currentValue;i["password"]=this.password.currentValue;i["id"]=this.conferenceId;i["invitation"]=a.Text.decode(this.invitation.value);i["users"]=this.selectedUsers.currentValue.map((function(t){return t.id}));i["broadcast_mode"]=this.broadcastMode.currentValue;i["presenters"]=this.selectedPresenters.currentValue.map((function(t){return t.id}));this.clearErrors();if(this.isFormViewMode||this.linkGenerated){a.ajax.runAction("im.conference.create",{json:{fields:i,aliasData:this.aliasData},analyticsLabel:{creationType:"section"}}).then((function(t){e.onSuccessfulSubmit()}))["catch"]((function(t){e.onFailedSubmit(t)}))}},onSuccessfulSubmit:function t(){if(this.isFormCreateMode){this.copyInvitation()}this.isSubmitting=false;this.closeSlider();this.reloadGrid()},onFailedSubmit:function t(e){this.isSubmitting=false;var i=e["errors"][0].message;if(e["errors"][0].code==="NETWORK_ERROR"){i=this.localize["BX_IM_COMPONENT_CONFERENCE_NETWORK_ERROR"]}this.addError(i)},checkRequirements:function t(){if(!top.BX.PULL.isPublishingEnabled()){this.disableButton();this.addError(this.localize["BX_IM_COMPONENT_CONFERENCE_PUSH_ERROR"])}if(!top.BX.Call.Util.isCallServerAllowed()){this.disableButton();this.addError(this.localize["BX_IM_COMPONENT_CONFERENCE_VOXIMPLANT_ERROR_WITH_LINK"])}},disableButton:function t(){var e=document.querySelector("#im-conference-create-wrap #ui-button-panel-save");if(e){a.Dom.addClass(e,["ui-btn-disabled","ui-btn-icon-lock"])}},generateLink:function t(){var e=this;a.ajax.runAction("im.conference.prepare",{json:{},analyticsLabel:{creationType:"section"}}).then((function(t){e.aliasData=t.data["ALIAS_DATA"];e.aliasData["LINK"]=a.Text.encode(e.aliasData["LINK"]);e.title.defaultValue=t.data["DEFAULT_TITLE"];e.linkGenerated=true}))["catch"]((function(t){i.Logger.warn("error",t["errors"][0].message)}))},addError:function t(e){this.errors.push(e)},clearErrors:function t(){this.errors=[]},closeSlider:function t(){if(a.Reflection.getClass("BX.SidePanel")){BX.SidePanel.Instance.close()}},reloadGrid:function t(){if(a.Reflection.getClass("top.BX.Main.gridManager")){top.BX.Main.gridManager.reload(this.gridId)}else{top.window.location=this.pathToList}},setDefaultDateAndTime:function t(){var e=new Date;var i=e.getMinutes();var n=i%5;if(n>0){e.setMinutes(i-n+(n>2?5:0))}this.selectedDate.currentValue=BX.formatDate(e,BX.message("FORMAT_DATE"));this.selectedDate.initialValue=this.selectedDate.currentValue;this.selectedTime.currentValue=this.formatTime(e);this.selectedTime.initialValue=this.selectedTime.currentValue},setDefaultDuration:function t(){this.selectedDuration.currentValue="30";this.selectedDuration.initialValue=this.selectedDuration.currentValue;this.selectedDurationType.currentValue="m";this.selectedDurationType.initialValue=this.selectedDurationType.currentValue},formatTime:function t(e){var i=BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")).replace(/:?\s*s/,"");var n=BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:?\s*s/,"");var a=BX.date.format(i,e);var s=BX.date.format(n,e);return BX.util.trim(s.replace(a,""))}},components:E,template:'\n\t\t<div>\n\t\t\t<template v-if="errors.length > 0">\n\t\t\t\t<div class="ui-alert ui-alert-danger" id="im-conference-create-errors">\n\t\t\t\t\t<span v-for="error in errors" class="ui-alert-message" v-html="error"></span>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class="im-conference-create-block im-conference-create-fields-wrapper">\n\t\t\t\t\x3c!-- Form fields --\x3e\n\t\t\t\t<conference-field-title\n\t\t\t\t\t:mode="fieldsMode[\'title\']"\n\t\t\t\t\t:title="title.currentValue"\n\t\t\t\t\t:defaultValue="title.defaultValue"\n\t\t\t\t\t@titleChange="onTitleChange"\n\t\t\t\t\t@switchToEdit="switchToEdit"\n\t\t\t\t/>\n\t\t\t\t<conference-field-planner\n\t\t\t\t\t:mode="fieldsMode[\'planner\']"\n\t\t\t\t\t:selectedUsers="selectedUsers.currentValue"\n\t\t\t\t\t:selectedDate="selectedDate.currentValue"\n\t\t\t\t\t:selectedTime="selectedTime.currentValue"\n\t\t\t\t\t:selectedDuration="selectedDuration.currentValue"\n\t\t\t\t\t:selectedDurationType="selectedDurationType.currentValue"\n\t\t\t\t\t:chatHost="chatHost"\n\t\t\t\t\t@userSelect="onUserSelect"\n\t\t\t\t\t@userDeselect="onUserDeselect"\n\t\t\t\t\t@dateChange="onDateChange"\n\t\t\t\t\t@timeChange="onTimeChange"\n\t\t\t\t\t@durationChange="onDurationChange"\n\t\t\t\t\t@durationTypeChange="onDurationTypeChange"\n\t\t\t\t\t@switchToEdit="switchToEdit"\n\t\t\t\t/>\n\t\t\t\t<conference-field-password\n\t\t\t\t\t:mode="fieldsMode[\'password\']"\n\t\t\t\t\t:password="password.currentValue"\n\t\t\t\t\t:passwordNeeded="passwordNeeded.currentValue"\n\t\t\t\t\t@passwordChange="onPasswordChange"\n\t\t\t\t\t@passwordNeededChange="onPasswordNeededChange"\n\t\t\t\t\t@switchToEdit="switchToEdit"\n\t\t\t\t/>\n\x3c!--\t\t\t\t<div v-if="isFormCreateMode" class="im-conference-create-delimiter im-conference-create-delimiter-small"></div>--\x3e\n\t\t\t\t<template v-if="broadcastingEnabled">\n\t\t\t\t\t<conference-field-broadcast\n\t\t\t\t\t\t:mode="fieldsMode[\'broadcast\']"\n\t\t\t\t\t\t:broadcastMode="broadcastMode.currentValue"\n\t\t\t\t\t\t:selectedPresenters="selectedPresenters.currentValue"\n\t\t\t\t\t\t:chatHost="chatHost"\n\t\t\t\t\t\t@broadcastModeChange="onBroadcastModeChange"\n\t\t\t\t\t\t@switchToEdit="switchToEdit"\n\t\t\t\t\t\t@presenterSelect="onPresenterSelect"\n\t\t\t\t\t\t@presenterDeselect="onPresenterDeselect"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t\x3c!-- Action buttons --\x3e\n\t\t\t\t<template v-if="!isFormCreateMode">\n\t\t\t\t\t<div class="im-conference-create-section im-conference-create-actions">\n\t\t\t\t\t\t<a :href="publicLink" target="_blank" class="ui-btn ui-btn-sm ui-btn-primary ui-btn-icon-camera">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_START\'] }}</a>\n\t\t\t\t\t\t<button @click="copyInvitation" class="ui-btn ui-btn-sm ui-btn-light-border ui-btn-icon-share">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_INVITATION_COPY\'] }}</button>\n\t\t\t\t\t\t<button @click="openChat" class="ui-btn ui-btn-sm ui-btn-light-border ui-btn-icon-chat">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_CHAT\'] }}</button>\n\t\t\t\t\t\t<button @click="editAll" class="ui-btn ui-btn-sm ui-btn-light">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_EDIT\'] }}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t\x3c!-- Bottom button panel --\x3e\n\t\t\t\t<div v-if="isEditing" class="im-conference-create-button-panel-edit ui-button-panel-wrapper ui-pinner ui-pinner-bottom ui-pinner-full-width">\n\t\t\t\t\t<div class="ui-button-panel ui-button-panel-align-center">\n\t\t\t\t\t\t<button @click="submitForm" id="ui-button-panel-save" :class="submitFormButtonClasses">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_SAVE\'] }}</button>\n\t\t\t\t\t\t<a @click="discardChanges" id="ui-button-panel-cancel" class="ui-btn ui-btn-link">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_CANCEL\'] }}</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if="isFormCreateMode" class="im-conference-create-button-panel-add ui-button-panel-wrapper ui-pinner ui-pinner-bottom ui-pinner-full-width">\n\t\t\t\t\t<div class="ui-button-panel ui-button-panel-align-center">\n\t\t\t\t\t\t<button @click="submitForm" id="ui-button-panel-save" name="save" value="Y" :class="submitFormButtonClasses">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_CREATE\'] }}</button>\n\t\t\t\t\t\t<a @click="closeSlider" id="ui-button-panel-cancel" class="ui-btn ui-btn-link">{{ localize[\'BX_IM_COMPONENT_CONFERENCE_BUTTON_CANCEL\'] }}</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="im-conference-create-delimiter"></div>\n\t\t\t\t\x3c!-- Invitation --\x3e\n\t\t\t\t<conference-field-invitation\n\t\t\t\t\t:invitation="invitation"\n\t\t\t\t\t:chatHost="chatHost"\n\t\t\t\t\t:title="title.currentValue"\n\t\t\t\t\t:defaultTitle="title.defaultValue"\n\t\t\t\t\t:publicLink="conferenceLink"\n\t\t\t\t\t:formMode="mode"\n\t\t\t\t\t@invitationUpdate="onInvitationUpdate"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t'})})(this.BX.Messenger=this.BX.Messenger||{},BX,BX.Messenger.Lib,BX.Messenger.Lib,BX,BX.Calendar,BX.Calendar,BX.Event,window,BX.Messenger.Const,BX.UI.EntitySelector);
//# sourceMappingURL=conference-edit.bundle.map.js