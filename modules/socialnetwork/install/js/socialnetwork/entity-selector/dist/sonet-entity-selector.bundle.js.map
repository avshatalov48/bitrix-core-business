{"version":3,"file":"sonet-entity-selector.bundle.js","sources":["../src/footer.js","../src/text-footer.js"],"sourcesContent":["import { Type, Tag, Loc, Runtime, Dom, Validation } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { DefaultFooter } from 'ui.entity-selector';\nimport type { Dialog, TabOptions } from 'ui.entity-selector';\n\nexport default class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.handleDialogDestroy = this.handleDialogDestroy.bind(this);\n\t\tthis.handleSliderMessage = this.handleSliderMessage.bind(this);\n\n\t\tthis.bindEvents();\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\treturn this.cache.remember('content', () => {\n\t\t\tif (this.getOption('tagCreationLabel', false))\n\t\t\t{\n\t\t\t\treturn this.createTagCreationLabel();\n\t\t\t}\n\n\t\t\tconst inviteEmployeeLink = this.getOption('inviteEmployeeLink');\n\t\t\tconst inviteGuestLink = this.getOption('inviteGuestLink');\n\t\t\tconst inviteEmployeeScope = this.getOption('inviteEmployeeScope');\n\t\t\tconst createProjectLink = this.getOption('createProjectLink');\n\n\t\t\tconst complexPhrases = {\n\t\t\t\t'111': 'SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT_OR_GUEST',\n\t\t\t\t'110': 'SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE_OR_GUEST',\n\t\t\t\t'101': 'SOCNET_ENTITY_SELECTOR_EMPLOYEE_OR_PROJECT',\n\t\t\t\t'011': 'SOCNET_ENTITY_SELECTOR_PROJECT_OR_GUEST',\n\t\t\t};\n\n\t\t\tconst complexCode =\n\t\t\t\tNumber(Boolean(inviteEmployeeLink)).toString() +\n\t\t\t\tNumber(Boolean(inviteGuestLink)).toString() +\n\t\t\t\tNumber(Boolean(createProjectLink)).toString()\n\t\t\t;\n\n\t\t\tconst complexPhrase = complexPhrases[complexCode] ? complexPhrases[complexCode] : null;\n\t\t\tif (complexPhrase)\n\t\t\t{\n\t\t\t\tconst phrase = Tag.render`<div>${Loc.getMessage(complexPhrase)}</div>`;\n\t\t\t\tconst employee = phrase.querySelector('employee');\n\t\t\t\tconst guest = phrase.querySelector('guest');\n\t\t\t\tconst project = phrase.querySelector('project');\n\t\t\t\tconst spans = Array.from(phrase.querySelectorAll('span'));\n\n\t\t\t\tconst firstTag = Array.from(phrase.children).find(element => {\n\t\t\t\t\treturn [employee, guest, project].includes(element);\n\t\t\t\t});\n\n\t\t\t\tconst hideIcon = employee && guest && project;\n\n\t\t\t\tif (employee)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === employee;\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tthis.createInviteEmployeeLink(employee.innerHTML, showIcon),\n\t\t\t\t\t\temployee\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (guest)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === guest;\n\t\t\t\t\tconst guestLink = this.createInviteGuestLink(guest.innerHTML, showIcon);\n\t\t\t\t\tphrase.replaceChild(guestLink, guest);\n\t\t\t\t\tthis.createHint(guestLink);\n\t\t\t\t}\n\n\t\t\t\tif (project)\n\t\t\t\t{\n\t\t\t\t\tconst showIcon = !hideIcon && firstTag === project;\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tthis.createProjectLink(project.innerHTML, showIcon),\n\t\t\t\t\t\tproject\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tspans.forEach(span => {\n\t\t\t\t\tphrase.replaceChild(\n\t\t\t\t\t\tTag.render`<span class=\"ui-selector-footer-conjunction\">${span.innerHTML}</span>`,\n\t\t\t\t\t\tspan\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\t// Get rid of the outer <div>\n\t\t\t\tconst fragment = document.createDocumentFragment();\n\t\t\t\tArray.from(phrase.childNodes).forEach(element => {\n\t\t\t\t\tfragment.appendChild(element);\n\t\t\t\t});\n\n\t\t\t\treturn fragment;\n\t\t\t}\n\t\t\telse if (inviteEmployeeLink)\n\t\t\t{\n\t\t\t\tlet phrase = '';\n\t\t\t\tswitch (inviteEmployeeScope)\n\t\t\t\t{\n\t\t\t\t\tcase 'I':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EXTRANET');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'IE':\n\t\t\t\t\t\tphrase = Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_EMPLOYEE_OR_EXTRANET');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\n\t\t\t\treturn this.createInviteEmployeeLink(phrase, true);\n\t\t\t}\n\t\t\telse if (inviteGuestLink)\n\t\t\t{\n\t\t\t\tconst guestLink =\n\t\t\t\t\tthis.createInviteGuestLink(Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITE_GUEST'), true)\n\t\t\t\t;\n\n\t\t\t\tthis.createHint(guestLink);\n\n\t\t\t\treturn guestLink;\n\t\t\t}\n\t\t\telse if (createProjectLink)\n\t\t\t{\n\t\t\t\treturn this.createProjectLink(Loc.getMessage('SOCNET_ENTITY_SELECTOR_CREATE_PROJECT'), true);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t});\n\t}\n\n\tcreateTagCreationLabel()\n\t{\n\t\treturn Loc.getMessage('SOCNET_ENTITY_SELECTOR_TAG_FOOTER_LABEL');\n\t}\n\n\tcreateInviteEmployeeLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleInviteEmployeeClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateInviteGuestLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleInviteGuestClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateProjectLink(text: string, icon: boolean): string\n\t{\n\t\tconst className = `ui-selector-footer-link${icon ? ' ui-selector-footer-link-add' : ''}`;\n\n\t\treturn Tag.render`\n\t\t\t<span class=\"${className}\" onclick=\"${this.handleCreateProjectClick.bind(this)}\">${text}</span>\n\t\t`;\n\t}\n\n\tcreateHint(link: HTMLElement): void\n\t{\n\t\tRuntime.loadExtension('ui.hint').then(() => {\n\t\t\tconst hint = BX.UI.Hint.createInstance();\n\t\t\tconst node = hint.createNode(Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITED_GUEST_HINT'));\n\t\t\tDom.insertAfter(node, link);\n\t\t});\n\t}\n\n\thandleInviteEmployeeClick(): void\n\t{\n\t\tconst inviteEmployeeLink = this.getOption('inviteEmployeeLink');\n\n\t\tif (Type.isStringFilled(inviteEmployeeLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('user');\n\t\t\tconst userOptions = entity.getOptions() || {};\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tinviteEmployeeLink,\n\t\t\t\t{\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tcomponentParams: JSON.stringify({\n\t\t\t\t\t\t\t'USER_OPTIONS': userOptions\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\thandleInviteGuestClick(): void\n\t{\n\t\tconst inviteGuestLink = this.getOption('inviteGuestLink');\n\n\t\tif (Type.isStringFilled(inviteGuestLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('user');\n\t\t\tconst userOptions = entity.getOptions() || {};\n\n\t\t\tconst rows = [];\n\t\t\tconst searchQuery = this.getDialog().getTagSelectorQuery();\n\t\t\tif (Validation.isEmail(searchQuery))\n\t\t\t{\n\t\t\t\trows.push({ 'email': searchQuery });\n\t\t\t}\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tinviteGuestLink,\n\t\t\t\t{\n\t\t\t\t\twidth: 1200,\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tcomponentParams: JSON.stringify({\n\t\t\t\t\t\t\t'USER_OPTIONS': userOptions,\n\t\t\t\t\t\t\t'ROWS': rows\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\thandleCreateProjectClick(): void\n\t{\n\t\tconst createProjectLink = this.getOption('createProjectLink');\n\n\t\tif (Type.isStringFilled(createProjectLink))\n\t\t{\n\t\t\tconst entity = this.getDialog().getEntity('project');\n\t\t\tconst projectOptions = entity.getOptions() || {};\n\n\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\tcreateProjectLink,\n\t\t\t\t{\n\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: {\n\t\t\t\t\t\tPROJECT_OPTIONS: projectOptions,\n\t\t\t\t\t\trefresh: 'N'\n\t\t\t\t\t},\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentitySelectorId: this.getDialog().getId()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tthis.getDialog().subscribe('onDestroy', this.handleDialogDestroy);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tthis.getDialog().unsubscribe('onDestroy', this.handleDialogDestroy);\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.unbindEvents();\n\t}\n\n\thandleSliderMessage(event: BaseEvent): void\n\t{\n\t\tconst [messageEvent] = event.getData();\n\t\tconst slider = messageEvent.getSender();\n\n\t\tif (slider.getData().get('entitySelectorId') !== this.getDialog().getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tmessageEvent.getEventId() === 'BX.Intranet.Invitation:onAdd' ||\n\t\t\tmessageEvent.getEventId() === 'BX.Intranet.Invitation.Guest:onAdd'\n\t\t)\n\t\t{\n\t\t\tconst { users } = messageEvent.getData();\n\t\t\tthis.addUsers(users);\n\t\t}\n\n\t\tif (messageEvent.getEventId() === 'BX.Socialnetwork.Workgroup:onAdd')\n\t\t{\n\t\t\tconst { projects } = messageEvent.getData();\n\t\t\tthis.addProjects(projects);\n\t\t}\n\t}\n\n\taddUsers(users: Array): void\n\t{\n\t\tif (!Type.isArrayFilled(users))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet tab = this.getDialog().getRecentTab() || this.getDialog().getTab('invited-users');\n\t\tif (!tab)\n\t\t{\n\t\t\ttab = this.getDialog().addTab(this.createInvitedUsersTab());\n\t\t}\n\n\t\tusers.forEach(user => {\n\t\t\tif (!Type.isPlainObject(user))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.getDialog().addItem(\n\t\t\t\tObject.assign({}, user, { tabs: tab.getId(), sort: 2 })\n\t\t\t);\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t});\n\n\t\tthis.getDialog().selectTab(tab.getId());\n\t}\n\n\taddProjects(projects: Array): void\n\t{\n\t\tif (!Type.isArrayFilled(projects))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tab = this.getDialog().getRecentTab() || this.getDialog().getTab('projects');\n\t\tconst tabId = tab ? tab.getId() : null;\n\n\t\tprojects.forEach(project => {\n\t\t\tif (!Type.isPlainObject(project))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.getDialog().addItem(\n\t\t\t\tObject.assign({}, project, { tabs: tabId, sort: 2 })\n\t\t\t);\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\t\t});\n\n\t\tthis.getDialog().selectTab(tabId);\n\t}\n\n\tcreateInvitedUsersTab(): TabOptions\n\t{\n\t\tconst icon =\n\t\t\t'data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2223%22%20height%3D%2223%22%20' +\n\t\t\t'fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20fill-rule%3D%22evenodd' +\n\t\t\t'%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.447%202.984a8.447%208.447%200%20100%2016.893%208.447%2' +\n\t\t\t'08.447%200%20000-16.893zM5.785%2016.273c-.02.018-.116.09-.234.177a7.706%207.706%200%2001-1.846-5.02' +\n\t\t\t'c0-.36.025-.717.073-1.069.442.573.927%201.347%201.094%201.579.272.379.575.75.84%201.136.444.648.91%' +\n\t\t\t'201.534.673%202.34-.102.346-.328.627-.6.857zm8.92-6.27s.402%201.575%202.122%201.444c.544-.04.509%20' +\n\t\t\t'1.414.162%202.015-.43.743-.318%201.627-.725%202.37-.256.467-.69.814-1.035%201.213-.43.501-.913.984-' +\n\t\t\t'1.631.922-.474-.04-.67-.565-.763-.939-.23-.928-.39-2.828-.39-2.828s-.668-1.443-2.177-1.003c-1.509.' +\n\t\t\t'44-1.816-.728-1.859-1.84-.102-2.742%202.204-3.032%202.472-2.984.383.069%201.507.262%201.79.418.956' +\n\t\t\t'.528%201.935-.2%201.858-.585-.077-.385-2.453-.939-3.296-.999-.843-.06-.92.24-1.151-.014-.187-.205-' +\n\t\t\t'.015-.53.116-.703.93-1.225%202.48-1.522%203.791-2.16.02-.01.051-.08.087-.184a7.72%207.72%200%20012.' +\n\t\t\t'846%201.81%207.719%207.719%200%20011.894%203.091c-.28.165.277-.057-1.185.283-1.462.34-2.926.673-2.9' +\n\t\t\t'26.673z%22%20fill%3D%22%23ABB1B8%22/%3E%3C/svg%3E'\n\t\t;\n\n\t\treturn {\n\t\t\tid: 'invited-users',\n\t\t\ttitle: Loc.getMessage('SOCNET_ENTITY_SELECTOR_INVITED_USERS_TAB_TITLE'),\n\t\t\tbgColor: {\n\t\t\t\tselected: '#f7a700',\n\t\t\t\tselectedHovered:  '#faac09',\n\t\t\t},\n\t\t\ticon: {\n\t\t\t\t//default: '/bitrix/js/socialnetwork/entity-selector/src/images/invited-users-tab-icon.svg',\n\t\t\t\t//selected: '/bitrix/js/socialnetwork/entity-selector/src/images/invited-users-tab-icon-selected.svg'\n\t\t\t\tdefault: icon,\n\t\t\t\tselected: icon.replace(/ABB1B8/g, 'fff'),\n\t\t\t}\n\t\t};\n\t}\n}","import {DefaultFooter} from \"ui.entity-selector\";\nimport {Tag} from \"main.core\";\n\nexport default class TextFooter extends DefaultFooter\n{\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-selector-footer-default ui-selector-footer-long-text\">\n\t\t\t\t${this.getContent() ? this.getContent() : '' }\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["Footer","dialog","options","handleDialogDestroy","bind","handleSliderMessage","bindEvents","cache","remember","getOption","createTagCreationLabel","inviteEmployeeLink","inviteGuestLink","inviteEmployeeScope","createProjectLink","complexPhrases","complexCode","Number","Boolean","toString","complexPhrase","phrase","Tag","render","Loc","getMessage","employee","querySelector","guest","project","spans","Array","from","querySelectorAll","firstTag","children","find","element","includes","hideIcon","showIcon","replaceChild","createInviteEmployeeLink","innerHTML","guestLink","createInviteGuestLink","createHint","forEach","span","fragment","document","createDocumentFragment","childNodes","appendChild","text","icon","className","handleInviteEmployeeClick","handleInviteGuestClick","handleCreateProjectClick","link","Runtime","loadExtension","then","hint","BX","UI","Hint","createInstance","node","createNode","Dom","insertAfter","Type","isStringFilled","entity","getDialog","getEntity","userOptions","getOptions","SidePanel","Instance","open","allowChangeHistory","cacheable","requestMethod","requestParams","componentParams","JSON","stringify","data","entitySelectorId","getId","rows","searchQuery","getTagSelectorQuery","Validation","isEmail","push","width","projectOptions","PROJECT_OPTIONS","refresh","subscribe","EventEmitter","unsubscribe","unbindEvents","event","getData","messageEvent","slider","getSender","get","getEventId","users","addUsers","projects","addProjects","isArrayFilled","tab","getRecentTab","getTab","addTab","createInvitedUsersTab","user","isPlainObject","item","addItem","Object","assign","tabs","sort","select","selectTab","tabId","id","title","bgColor","selected","selectedHovered","replace","DefaultFooter","TextFooter","getContent"],"mappings":"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"}