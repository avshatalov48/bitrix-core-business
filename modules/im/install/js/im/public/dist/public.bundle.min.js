this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,n){"use strict";const t={};t.openMessenger=function(...e){console.warn("Developer: method BXIM.openMessenger is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");return d.openChat(...e)};t.openMessengerSlider=function(e){console.warn("Developer: method BXIM.openMessengerSlider is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");return d.openChat(e)};t.openHistory=function(...e){console.warn("Developer: method BXIM.openHistory is deprecated. Use method 'Messenger.openChat' from 'im.public' or 'im.public.iframe' extension.");const t=n.Reflection.getClass("BX.Messenger.v2.Lib.Opener");return t==null?void 0:t.openHistory(...e)};t.openNotify=function(...e){console.warn("Developer: method BXIM.openNotify is deprecated. Use method 'Messenger.openNotifications' from 'im.public' or 'im.public.iframe' extension.");return d.openNotifications(...e)};t.openSettings=function(...e){console.warn("Developer: method BXIM.openSettings is deprecated. Use method 'Messenger.openSettings' from 'im.public' or 'im.public.iframe' extension.");return d.openSettings(...e)};t.openVideoconf=function(e){console.warn("Developer: method BXIM.openVideoconf is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.");return d.openConference({code:e})};t.openVideoconfByUrl=function(e){console.warn("Developer: method BXIM.openVideoconfByUrl is deprecated. Use method 'Messenger.openConference' from 'im.public' or 'im.public.iframe' extension.");const t=n.Reflection.getClass("BX.Messenger.v2.Lib.Utils");if(t&&n.Type.isStringFilled(url)&&!t.conference.isCurrentPortal(url)){return false}d.openConference({link:e});return true};t.callTo=function(...e){console.warn("Developer: method BXIM.callTo is deprecated. Use method 'Messenger.startVideoCall' from 'im.public' or 'im.public.iframe' extension.");return d.startVideoCall(...e)};t.phoneTo=function(...e){console.warn("Developer: method BXIM.phoneTo is deprecated. Use method 'Messenger.startPhoneCall' from 'im.public' or 'im.public.iframe' extension.");return d.startPhoneCall(...e)};t.startCallList=function(...e){console.warn("Developer: method BXIM.startCallList is deprecated. Use method 'Messenger.startCallList' from 'im.public' or 'im.public.iframe' extension.");return d.startCallList(...e)};t.disk={saveToDiskAction(...e){console.warn("Developer: method BXIM.disk.saveToDiskAction is deprecated. Use method 'Messenger.saveFileToDisk' from 'im.public' or 'im.public.iframe' extension.");const[,n]=e;if(!n||!n.fileId){return Promise.reject()}return d.saveFileToDisk(n.fileId)}};t.messenger={};t.messenger.popupPopupMenu=false;t.settings={};const o={init:()=>{},enableInVersion:()=>false,getApiVersion:()=>0,addCustomEvent:()=>{},onCustomEvent:()=>{},ready:()=>true,log:()=>{}};class s{constructor(){const e=n.Extension.getSettings("im.public");this.v2enabled=e.get("v2enabled",false)}async openPage(e,t={}){if(!this.v2enabled){return Promise.resolve(false)}const o=n.Dom.create({tag:"a",attrs:{href:e}});if(o.host!==location.host){return Promise.resolve(false)}const s=Boolean(t.skipNativeBrowser);const i=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const r=await(i==null?void 0:i.getInstance().checkForOpenBrowserPage());if(r){return i==null?void 0:i.getInstance().openPage(o.href,{skipNativeBrowser:s})}if(s===true){return Promise.resolve(false)}window.open(o.href,"_blank");return Promise.resolve(true)}}const i=new s;const r={notify:"notification"};const l=e=>{var n;return(n=r[e])!=null?n:""};class a{constructor(){this.v2enabled=false;const e=n.Extension.getSettings("im.public");this.v2enabled=e.get("v2enabled",false);this.desktop=i}async openChat(e="",t=0){var o;if(!this.v2enabled){window.BXIM.openMessenger(e);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkForRedirect());if(i){return s==null?void 0:s.getInstance().redirectToChat(e,t)}return(o=c())==null?void 0:o.openChat(e,t)}async forwardEntityToChat(e,t){var o;const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkForRedirect());return(o=c())==null?void 0:o.forwardEntityToChat(e,t)}async openLines(e=""){var t;if(!this.v2enabled){const n=e===""?0:e;window.BXIM.openMessenger(n,"im-ol");return Promise.resolve()}const o=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const s=await(o==null?void 0:o.getInstance().checkForRedirect());if(s){return o==null?void 0:o.getInstance().redirectToLines(e)}return(t=c())==null?void 0:t.openLines(e)}async openCopilot(e="",t=0){var o;if(!this.v2enabled){window.BXIM.openMessenger(e);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkForRedirect());if(i){return s==null?void 0:s.getInstance().redirectToCopilot(e)}return(o=c())==null?void 0:o.openCopilot(e,t)}async openCollab(e=""){var t;const o=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const s=await(o==null?void 0:o.getInstance().checkForRedirect());if(s){return o==null?void 0:o.getInstance().redirectToCollab(e)}return(t=c())==null?void 0:t.openCollab(e)}async openLinesHistory(e=""){var n;if(!this.v2enabled){window.BXIM.openHistory(e);return Promise.resolve()}return(n=c())==null?void 0:n.openHistory(e)}async openNotifications(){var e;if(!this.v2enabled){window.BXIM.openNotify();return Promise.resolve()}const t=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const o=await(t==null?void 0:t.getInstance().checkForRedirect());if(o){return t==null?void 0:t.getInstance().redirectToNotifications()}return(e=c())==null?void 0:e.openNotifications()}async openRecentSearch(){var e;if(!this.v2enabled){window.BXIM.openMessenger();return Promise.resolve()}const t=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const o=await(t==null?void 0:t.getInstance().checkForRedirect());if(o){return t==null?void 0:t.getInstance().redirectToRecentSearch()}return(e=c())==null?void 0:e.openRecentSearch()}async openSettings(e={}){var t,o;if(!this.v2enabled){const t={};if(n.Type.isPlainObject(e)){if(n.Type.isStringFilled(e.selected)){t.active=e.selected}if(n.Type.isStringFilled(e.section)){t.onlyPanel=e.section}}window.BXIM.openSettings(t);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkForRedirect());if(i){var r;return s==null?void 0:s.getInstance().redirectToSettings((r=e.onlyPanel)!=null?r:"")}const a=l((t=e.onlyPanel)!=null?t:"");return(o=c())==null?void 0:o.openSettings(a)}async openConference(e={}){var t;if(!this.v2enabled){if(n.Type.isPlainObject(e)){if(n.Type.isStringFilled(e.code)){window.BXIM.openVideoconf(e.code)}if(n.Type.isStringFilled(e.link)){window.BXIM.openVideoconfByUrl(e.link)}}return Promise.resolve()}const o=n.Reflection.getClass("BX.Messenger.v2.Lib.Utils");if(n.Type.isStringFilled(e.url)&&!o.conference.isCurrentPortal(e.url)){o.browser.openLink(e.url);return Promise.resolve()}const s=o.conference.getCodeByOptions(e);const i=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");if(i!=null&&i.isDesktop()){return i==null?void 0:i.getInstance().openConference(s)}const r=await(i==null?void 0:i.getInstance().checkForRedirect());if(r){return i==null?void 0:i.getInstance().redirectToConference(s)}return(t=c())==null?void 0:t.openConference(s)}async openChatCreation(e){var t;const o=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const s=await(o==null?void 0:o.getInstance().checkForRedirect());if(s){return o==null?void 0:o.getInstance().redirectToChatCreation(e)}return(t=c())==null?void 0:t.openChatCreation(e)}async startVideoCall(e="",t=true){var o;if(!this.v2enabled){window.BXIM.callTo(e,t);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkForRedirect());if(i){return s==null?void 0:s.getInstance().redirectToVideoCall(e,t)}return(o=c())==null?void 0:o.startVideoCall(e,t)}async startPhoneCall(e,t){var o;if(!this.v2enabled){window.BXIM.phoneTo(e,t);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkStatusInDifferentContext());if(i){return s==null?void 0:s.getInstance().redirectToPhoneCall(e,t)}return(o=c())==null?void 0:o.startPhoneCall(e,t)}async startCallList(e,t){var o;if(!this.v2enabled){window.BXIM.startCallList(e,t);return Promise.resolve()}const s=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");const i=await(s==null?void 0:s.getInstance().checkStatusInDifferentContext());if(i){return s==null?void 0:s.getInstance().redirectToCallList(e,t)}return(o=c())==null?void 0:o.startCallList(e,t)}enableDesktopRedirect(){const e=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");e==null?void 0:e.getInstance().enableRedirect()}disableDesktopRedirect(){const e=n.Reflection.getClass("BX.Messenger.v2.Lib.DesktopManager");e==null?void 0:e.getInstance().disableRedirect()}setWebRTCDebug(e=false){if(!this.v2enabled){return}const t=n.Reflection.getClass("BX.Messenger.v2.Lib.PhoneManager");t==null?void 0:t.getInstance().toggleDebugFlag(e);const o=n.Reflection.getClass("BX.Messenger.v2.Lib.CallManager");o==null?void 0:o.getInstance().toggleDebugFlag(e)}async saveFileToDisk(e){const{DiskService:t}=n.Reflection.getClass("BX.Messenger.v2.Service");if(!t){return}await(new t).save([e]).catch((e=>{console.error("Messenger.saveFileToDisk error:",e)}));BX.UI.Notification.Center.notify({content:n.Loc.getMessage("IM_SERVICE_FILE_SAVED_ON_DISK_SUCCESS_MSGVER_1")})}}const c=()=>n.Reflection.getClass("BX.Messenger.v2.Lib.Opener");const d=new a;const u=n.Reflection.getClass("BX.Messenger");if(u){u.Public=d}if(d.v2enabled&&n.Type.isUndefined(window.BXIM)&&window.parent===window){window.BXIM=t}if(d.v2enabled&&n.Type.isUndefined(window.BX.desktop)&&n.Type.isObject(window.BXDesktopSystem)&&window.parent===window){window.BX.desktop=o}e.Messenger=d})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX);
//# sourceMappingURL=public.bundle.map.js