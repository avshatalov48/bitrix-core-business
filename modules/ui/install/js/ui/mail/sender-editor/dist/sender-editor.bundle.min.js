this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,t,s,i,a,n,r,l){"use strict";let o=e=>e,d,c,u,v,h,p,b,m,L,I;const S=BX.SidePanel;const f=/\S+@\S+\.\S+/;const P="mail-mailbox-config-delete";const g="sender";var _=babelHelpers.classPrivateFieldLooseKey("setFieldData");var E=babelHelpers.classPrivateFieldLooseKey("showDisconnectDialog");var F=babelHelpers.classPrivateFieldLooseKey("save");var y=babelHelpers.classPrivateFieldLooseKey("disconnect");var T=babelHelpers.classPrivateFieldLooseKey("saveSender");var D=babelHelpers.classPrivateFieldLooseKey("createContentContainer");var M=babelHelpers.classPrivateFieldLooseKey("createAlertNode");var A=babelHelpers.classPrivateFieldLooseKey("createSenderSection");var B=babelHelpers.classPrivateFieldLooseKey("createSmtpServerSection");var w=babelHelpers.classPrivateFieldLooseKey("createSmtpEmailRow");var C=babelHelpers.classPrivateFieldLooseKey("createSmtpServerRow");var N=babelHelpers.classPrivateFieldLooseKey("createSmtpPortAndSafeConnectionRow");var H=babelHelpers.classPrivateFieldLooseKey("createSmtpPasswordRow");var x=babelHelpers.classPrivateFieldLooseKey("createLimitSection");var R=babelHelpers.classPrivateFieldLooseKey("showAlertNode");var O=babelHelpers.classPrivateFieldLooseKey("hideAlertNode");var U=babelHelpers.classPrivateFieldLooseKey("prepareNecessaryFields");var j=babelHelpers.classPrivateFieldLooseKey("hasInvalidFields");var k=babelHelpers.classPrivateFieldLooseKey("clearInvalidFields");var K=babelHelpers.classPrivateFieldLooseKey("isInvalidField");var $=babelHelpers.classPrivateFieldLooseKey("getErrorMessage");var X=babelHelpers.classPrivateFieldLooseKey("setUserName");class G{constructor(e){var s;Object.defineProperty(this,X,{value:he});Object.defineProperty(this,$,{value:ve});Object.defineProperty(this,K,{value:ue});Object.defineProperty(this,k,{value:ce});Object.defineProperty(this,j,{value:de});Object.defineProperty(this,U,{value:oe});Object.defineProperty(this,O,{value:le});Object.defineProperty(this,R,{value:re});Object.defineProperty(this,x,{value:ne});Object.defineProperty(this,H,{value:ae});Object.defineProperty(this,N,{value:ie});Object.defineProperty(this,C,{value:se});Object.defineProperty(this,w,{value:te});Object.defineProperty(this,B,{value:ee});Object.defineProperty(this,A,{value:Q});Object.defineProperty(this,M,{value:J});Object.defineProperty(this,D,{value:z});Object.defineProperty(this,T,{value:Z});Object.defineProperty(this,y,{value:W});Object.defineProperty(this,F,{value:Y});Object.defineProperty(this,E,{value:V});Object.defineProperty(this,_,{value:q});if(e){var i,a;if(e.senderId&&t.Type.isInteger(e.senderId)&&e.senderId>0){this.title=t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_EDIT_TITLE");this.senderId=e.senderId}else{this.title=t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_ADD_TITLE")}this.setSender=(i=e.setSenderCallback)!=null?i:null;this.addSender=(a=e.addSenderCallback)!=null?a:null}this.onCloseAction=(s=e.onClose)!=null?s:null;babelHelpers.classPrivateFieldLooseBase(this,D)[D]();babelHelpers.classPrivateFieldLooseBase(this,U)[U]()}static openSlider(e){const s=new G(e);S.Instance.open("smtpSender",{width:760,cacheable:false,contentCallback:()=>s.getContentCallback(),events:{onLoad:()=>{t.ready((()=>{new l.LayoutForm({container:s.limitSection})}))}}})}getContentCallback(){return s.Layout.createContent({extensions:["ui.mail.sender-editor"],title:this.title,design:{section:false,margin:false},content:()=>{if(this.senderId>0){return this.loadSender(this.senderId)}return t.ajax.runAction("main.api.mail.sender.getDefaultSenderName").then((e=>{babelHelpers.classPrivateFieldLooseBase(this,X)[X](e.data);return this.getContentContainer()})).catch((()=>this.getContentContainer()))},buttons:({cancelButton:e,Button:s})=>{const i=[];const a=new n.SaveButton({onclick:()=>{babelHelpers.classPrivateFieldLooseBase(this,F)[F](a)}});i.push(a);if(this.senderId>0){this.disconnectButton=new s({text:t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_DISCONNECT_BUTTON"),color:BX.UI.Button.Color.DANGER,onclick:()=>{babelHelpers.classPrivateFieldLooseBase(this,E)[E]()}});i.push(this.disconnectButton)}i.push(e);return i}})}loadSender(e){return t.ajax.runAction("main.api.mail.sender.getSenderData",{data:{senderId:e}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,_)[_](e.data);return this.getContentContainer()})).catch((()=>this.getContentContainer()))}getContentContainer(){return this.contentContainer}}function q(e){this.nameField.value=e.name;this.accessField.checked=e.isPublic;this.emailField.value=e.email;this.serverField.value=e.server;this.portField.value=e.port;if(e.protocol==="smtps"){this.sslField.checked=true}if(t.Type.isNumber(e.limit)&&e.limit>0){this.senderLimitCheckbox.checked=true;this.senderLimitField.value=e.limit}}function V(){top.BX.UI.Dialogs.MessageBox.show({message:t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_DISCONNECT_MESSAGE"),modal:true,buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,onOk:e=>{babelHelpers.classPrivateFieldLooseBase(this,y)[y]();e.close()},onCancel:e=>{e.close()}})}function Y(e){babelHelpers.classPrivateFieldLooseBase(this,k)[k]();if(babelHelpers.classPrivateFieldLooseBase(this,j)[j]()){return}babelHelpers.classPrivateFieldLooseBase(this,O)[O]();e.setClocking();babelHelpers.classPrivateFieldLooseBase(this,T)[T]().then((e=>{const t=e.data;if(this.setSender){this.setSender(t.senderId,t.name,this.email)}if(this.addSender){const e=[];e.name=t.name;e.email=this.email;this.addSender(e)}BX.SidePanel.Instance.getTopSlider().close();if(!this.senderId&&!this.addSender){rt.openSlider({senderId:t.senderId,email:this.email,setSenderCallback:this.setSender,onClose:this.onCloseAction})}})).catch((t=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R](t.errors[0].message);e.setClocking(false)}))}function W(){t.Dom.addClass(this.disconnectButton,"ui-btn-wait");t.ajax.runAction("main.api.mail.sender.deleteSender",{data:{senderId:this.senderId}}).then((()=>{t.Dom.removeClass(this.disconnectButton,"ui-btn-wait");S.Instance.getTopSlider().close();top.BX.SidePanel.Instance.postMessage(window,P,{id:this.senderId,type:g})})).catch((()=>{t.Dom.removeClass(this.disconnectButton,"ui-btn-wait")}))}function Z(){var e;this.email=this.emailField.value;const s={id:(e=this.senderId)!=null?e:null,name:this.nameField.value,email:this.email,smtp:{},public:this.accessField.checked?"Y":"N"};s.smtp={server:this.serverField.value,port:this.portField.value,ssl:this.sslField.checked?this.sslField.value:"",login:this.emailField.value,password:this.passwordField.value,limit:this.senderLimitCheckbox.checked?this.senderLimitField.value:null};return t.ajax.runAction("main.api.mail.sender.submitSender",{data:{data:s}}).then((e=>e))}function z(){babelHelpers.classPrivateFieldLooseBase(this,M)[M]();babelHelpers.classPrivateFieldLooseBase(this,A)[A]();babelHelpers.classPrivateFieldLooseBase(this,B)[B]();babelHelpers.classPrivateFieldLooseBase(this,x)[x]();this.contentContainer=t.Tag.render(d||(d=o`
			<div class="ui-form">
				${0}
				${0}
				${0}
				${0}
			</div>
		`),this.alertNode,this.senderSection,this.smtpServerSection,this.limitSection)}function J(){this.alertNode=t.Tag.render(c||(c=o`
			<div class="ui-alert ui-alert-danger ui-alert-icon-warning" style="display: none">
				<span class="ui-alert-message"></span>
			</div>
		`))}function Q(){var e;const{root:s,nameField:i,accessField:a}=t.Tag.render(u||(u=o`
			<div class="ui-slider-section">
				<div class="ui-slider-content-box">
					<div class="ui-slider-heading-4">${0}</div>
					<div class="ui-form-row">
						<div class="ui-ctl-top smtp-sender-name">
							<div class="ui-form-label">${0}</div>
							<span data-hint="${0}"></span>
						</div>
						<div class="ui-form-row-inline ui-ctl-w100">
							<div class="ui-form-row">
								<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">
									<input type="text" data-name="name" value="" class="ui-ctl-element" ref="nameField">
								</div>
							</div>
							<div class="ui-form-row">
								<label class="ui-ctl ui-ctl-checkbox">
									<input type="checkbox" class="ui-ctl-element" data-name="access" ref="accessField">
									<div class="ui-ctl-label-text">${0}</div>
									<span data-hint="${0}"></span>
								</label>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_MAIN_SECTION_TITLE"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_NAME"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_NAME_HINT"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_AVAILABLE_TOGGLE"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_AVAILABLE_TOGGLE_HINT"));this.senderSection=s;this.nameField=i;this.accessField=a;this.hintInstence=(e=top.BX.UI.Hint)==null?void 0:e.createInstance();this.hintInstence.init(this.senderSection)}function ee(){babelHelpers.classPrivateFieldLooseBase(this,w)[w]();babelHelpers.classPrivateFieldLooseBase(this,C)[C]();babelHelpers.classPrivateFieldLooseBase(this,N)[N]();babelHelpers.classPrivateFieldLooseBase(this,H)[H]();this.smtpServerSection=t.Tag.render(v||(v=o`
			<div class="ui-slider-section">
				<div class="ui-slider-content-box">
					<div class="ui-slider-heading-4">${0}</div>
					${0}
					${0}
					${0}
					${0}
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SMTP_SECTION_TITLE"),this.smtpServerRow,this.smtpPortAndSafeConnectionRow,this.smtpEmailRow,this.smtpPasswordRow)}function te(){const{root:e,emailField:s}=t.Tag.render(h||(h=o`
			<div class="ui-form-row">
				<div class="ui-ctl-top">
					<div class="ui-form-label">${0}</div>
				</div>
				<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">
					<input type="email" name="email" class="ui-ctl-element" data-name="email" placeholder="info@example.com" ref="emailField">
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_EMAIL"));this.smtpEmailRow=e;this.emailField=s}function se(){const{root:e,serverField:s}=t.Tag.render(p||(p=o`
			<div class="ui-form-row">
				<div class="ui-ctl-top">
					<div class="ui-form-label">${0}</div>
				</div>
				<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">
					<input type="text" name="server" class="ui-ctl-element" data-name="server" placeholder="smtp.example.com" ref="serverField">
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SERVER"));this.smtpServerRow=e;this.serverField=s}function ie(){const{root:e,portField:s,sslField:i}=t.Tag.render(b||(b=o`
			<div class="ui-form-row">
				<div class="ui-ctl-top">
					<div class="ui-form-label">${0}</div>
				</div>
				<div class="ui-form-row-inline" style="margin-bottom: 0">
					<div class="ui-form-row">
						<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">
						<input type="text" 
							class="ui-ctl-element" 
							data-name="port" 
							placeholder="555"
							ref="portField"
						>
						</div>
					</div>
					<div class="ui-form-row">
						<label class="ui-ctl ui-ctl-checkbox">
							<input type="checkbox" class="ui-ctl-element" value="Y" data-name="ssl" ref="sslField">
							<div class="ui-ctl-label-text">${0}</div>
						</label>
					</div>
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_PORT"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SSL"));this.smtpPortAndSafeConnectionRow=e;this.portField=s;this.sslField=i}function ae(){const{root:e,passwordField:s}=t.Tag.render(m||(m=o`
			<div class="ui-form-row">
				<div class="ui-ctl-top">
					<div class="ui-form-label">${0}</div>
				</div>
				<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">
					<input type="password" class="ui-ctl-element" data-name="password" ref="passwordField">
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_PASSWORD"));this.smtpPasswordRow=e;this.passwordField=s}function ne(){const{root:e,senderLimitCheckbox:s,senderLimitField:i}=t.Tag.render(L||(L=o`
			<div class="ui-slider-section">
				<div class="ui-slider-content-box">
					<div class="ui-slider-heading-4">${0}</div>
					<div class="ui-form-row">
						<div class="ui-form-label" data-form-row-hidden="">
							<label class="ui-ctl ui-ctl-checkbox smtp-editor-limit-checkbox">
								<input type="checkbox" class="ui-ctl-element" data-name="hasLimit" ref="senderLimitCheckbox">
								<div class="ui-ctl-label-text">${0}</div>
							</label>
						</div>
						<div class="ui-form-row-hidden">
							<div class="ui-form-row">
								<div class="ui-ctl-top">
									<div class="ui-form-label">${0}</div>
								</div>
								<div class="ui-ctl ui-ctl-textbox ui-ctl-w25">
									<input type="number" class="ui-ctl-element" data-name="limit" value="250" min="0" ref="senderLimitField">
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_LIMIT_SECTION_TITLE"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_LIMIT_SETTINGS"),t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_SENDER_LIMIT_TITLE"));this.limitSection=e;this.senderLimitCheckbox=s;this.senderLimitField=i}function re(e=null){if(e){const t=this.alertNode.querySelector("span");t.textContent=e}t.Dom.style(this.alertNode,"display","block")}function le(){t.Dom.style(this.alertNode,"display","none")}function oe(){this.requiredFields=[{row:this.smtpEmailRow,input:this.emailField,type:"email"},{row:this.smtpServerRow,input:this.serverField,type:"server"},{row:this.smtpPortAndSafeConnectionRow,input:this.portField,type:"port"}];if(!this.senderId){this.requiredFields.push({row:this.smtpPasswordRow,input:this.passwordField,type:"pass"})}}function de(){let e=0;this.requiredFields.forEach((s=>{if(!babelHelpers.classPrivateFieldLooseBase(this,K)[K](s.type,s.input.value)){return}e++;t.Dom.addClass(s.row,"ui-ctl-warning");const i=babelHelpers.classPrivateFieldLooseBase(this,$)[$](s.type,s.input.value);const a=t.Tag.render(I||(I=o`
				<div class="ui-mail-field-error-message ui-ctl-bottom">${0}</div>
			`),i);t.Dom.append(a,s.row);if(this.topEmptyNode){return}this.topEmptyNode=s.row;this.topEmptyNode.scrollIntoView()}));return e>0}function ce(){var e;if(!this.requiredFields){return}this.requiredFields.forEach((e=>{t.Dom.removeClass(e.row,"ui-ctl-warning");const s=e.row.querySelector(".ui-mail-field-error-message");if(t.Type.isDomNode(s)){t.Dom.remove(s)}}));this.topEmptyNode=null;(e=this.invalidFieldNode)==null?void 0:e.remove()}function ue(e,t){if(t.length===0){return true}if(e==="port"&&(!Number.isInteger(Number(t))||t<0||t>65535)){return true}return e==="email"&&!f.test(t)}function ve(e,s){switch(e){case"email":if(t.Type.isString(s)&&s.length>0){return t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_INVALID_EMAIL")}return t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_EMPTY_EMAIL");case"server":return t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_EMPTY_SERVER");case"port":return t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_INVALID_PORT");default:return t.Loc.getMessage("UI_MAIL_SMTP_SLIDER_EMPTY_PASSWORD")}}function he(e){this.nameField.value=e}let pe=e=>e,be,me,Le,Ie,Se,fe,Pe,ge,_e,Ee,Fe,ye,Te,De,Me,Ae,Be,we,Ce;const Ne="mailbox";const He="sender";const xe="mailboxSender";const Re="alias";const Oe="mail-mailbox-config-success";const Ue="mail-mailbox-config-delete";const je="mailAliasSlider";var ke=babelHelpers.classPrivateFieldLooseKey("createContentContainer");var Ke=babelHelpers.classPrivateFieldLooseKey("createAddSenderContainer");var $e=babelHelpers.classPrivateFieldLooseKey("addAliasPromise");var Xe=babelHelpers.classPrivateFieldLooseKey("createToolbarButtons");var Ge=babelHelpers.classPrivateFieldLooseKey("renderSenderItem");var qe=babelHelpers.classPrivateFieldLooseKey("renderSenderNameContainer");var Ve=babelHelpers.classPrivateFieldLooseKey("renderSenderEditNode");var Ye=babelHelpers.classPrivateFieldLooseKey("renderSenderExtraInfoContainer");var We=babelHelpers.classPrivateFieldLooseKey("getExtraInfoText");var Ze=babelHelpers.classPrivateFieldLooseKey("renderSenderEditContainer");var ze=babelHelpers.classPrivateFieldLooseKey("renderUserInfoNode");var Je=babelHelpers.classPrivateFieldLooseKey("renderDeleteButton");var Qe=babelHelpers.classPrivateFieldLooseKey("renderSettingsButton");var et=babelHelpers.classPrivateFieldLooseKey("renderSubmitButton");var tt=babelHelpers.classPrivateFieldLooseKey("renderCancelButton");var st=babelHelpers.classPrivateFieldLooseKey("addSenders");var it=babelHelpers.classPrivateFieldLooseKey("openSmtpSettings");var at=babelHelpers.classPrivateFieldLooseKey("openMailboxSettings");var nt=babelHelpers.classPrivateFieldLooseKey("hasNameInvalidCharacters");class rt{constructor(e){Object.defineProperty(this,nt,{value:Ft});Object.defineProperty(this,at,{value:Et});Object.defineProperty(this,it,{value:_t});Object.defineProperty(this,st,{value:gt});Object.defineProperty(this,tt,{value:Pt});Object.defineProperty(this,et,{value:ft});Object.defineProperty(this,Qe,{value:St});Object.defineProperty(this,Je,{value:It});Object.defineProperty(this,ze,{value:Lt});Object.defineProperty(this,Ze,{value:mt});Object.defineProperty(this,We,{value:bt});Object.defineProperty(this,Ye,{value:pt});Object.defineProperty(this,Ve,{value:ht});Object.defineProperty(this,qe,{value:vt});Object.defineProperty(this,Ge,{value:ut});Object.defineProperty(this,Xe,{value:ct});Object.defineProperty(this,$e,{value:dt});Object.defineProperty(this,Ke,{value:ot});Object.defineProperty(this,ke,{value:lt});this.wasSenderUpdated=false;this.senderId=Number(e.senderId);this.email=e.email;this.setSender=e.setSenderCallback;this.updateSenderList=e.updateSenderList;babelHelpers.classPrivateFieldLooseBase(this,ke)[ke]();babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe]()}static openSlider(e){const t=new rt(e);const i=function(e){const[s]=e.getData();if(!s){return}const i=s.getEventId();const a=s.getData();const n=Number(s.data.id);const r=BX.SidePanel.Instance.getSlider(je);if(i===Oe){t.wasSenderUpdated=true;t.updateMainSenderName(n);if(r){r.close()}return}if(i===Ue){t.wasSenderUpdated=true;if(t.id===Number(n)){t.setSender()}if(r){r.close()}if(a&&a.type!==He){BX.SidePanel.Instance.postMessage(window,s.getEventId(),s.getData)}}};BX.SidePanel.Instance.open(je,{width:680,cacheable:false,contentCallback:()=>s.Layout.createContent({extensions:["ui.mail.sender-editor"],title:e.email,design:{section:false,margin:false},content(){return t.loadSliderContent()},toolbar(){return t.getToolbarButtons()},buttons:()=>{}}),events:{onClose:()=>{top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onMessage",i);if(t.updateSenderList&&t.wasSenderUpdated){t.updateSenderList()}}}});top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onMessage",i)}getContentContainer(){return this.contentContainer}getToolbarButtons(){const e=[];if(this.settingsButton){e.push(this.settingsButton)}return e}loadSliderContent(){return BX.ajax.runAction("main.api.mail.sender.getSenderTransitionalData",{data:{senderId:this.senderId}}).then((e=>{const t=e.data;const s=t.senders;this.id=Number(t.id);this.email=t.email;babelHelpers.classPrivateFieldLooseBase(this,st)[st](s);const i=t.type||null;switch(i){case Ne:this.settingsButton.bindEvent("click",(()=>{babelHelpers.classPrivateFieldLooseBase(this,at)[at](t.href)}));break;case He:this.settingsButton.bindEvent("click",(()=>{babelHelpers.classPrivateFieldLooseBase(this,it)[it](t.id)}));break;default:this.settingsButton.setDisabled();break}return this.getContentContainer()})).catch((()=>{this.settingsButton.setDisabled();return this.getContentContainer()}))}updateMainSenderName(e){return BX.ajax.runAction("main.api.mail.sender.getSenderByMailboxId",{data:{mailboxId:e}}).then((e=>{var t;const s=(t=e.data)==null?void 0:t.name;if(!s||!this.mainSenderNameNode){return}this.mainSenderNameNode.innerText=s})).catch((()=>{}))}}function lt(){this.senderList=t.Tag.render(be||(be=pe`
			<div class="mail-sender-list"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke]();this.contentContainer=t.Tag.render(me||(me=pe`
			<div class="ui-form">
				<div class="ui-slider-section">
					<div class="ui-slider-content-box" style="margin-bottom: 0">
						<div class="ui-slider-heading-4 sender-list-header">${0}</div>
						${0}
						${0}
					</div>
				</div>
			</div>
		`),t.Text.encode(t.Loc.getMessage("UI_MAIL_ALIAS_SLIDER_EMAIL_TITLE")),this.senderList,this.addSenderContainer)}function ot(){this.senderInput=t.Tag.render(Le||(Le=pe`
			<input type="text" class="ui-ctl-element" data-name="aliasName" placeholder="${0}">
		`),t.Text.encode(t.Loc.getMessage("UI_MAIL_ALIAS_SLIDER_ADD_INPUT_PLACEHOLDER")));this.senderInputContainer=t.Tag.render(Ie||(Ie=pe`
			<div class="add-sender-input-container" hidden>
				<div class="ui-ctl ui-ctl-textbox ui-ctl-default-light ui-ctl-sm ui-ctl-w100">
					${0}
				</div>
			</div>
		`),this.senderInput);t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,et)[et]((()=>babelHelpers.classPrivateFieldLooseBase(this,$e)[$e]()),this.senderInput),this.senderInputContainer);t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,tt)[tt]((()=>{t.Dom.hide(this.senderInputContainer);t.Dom.show(this.senderAddButton);this.senderInput.value=null})),this.senderInputContainer);this.senderAddButton=t.Tag.render(Se||(Se=pe`
			<div class="add-sender-button">${0}</div>
		`),t.Text.encode(t.Loc.getMessage("UI_MAIL_ALIAS_SLIDER_ADD_BUTTON")));t.Event.bind(this.senderAddButton,"click",(()=>{t.Dom.hide(this.senderAddButton);t.Dom.show(this.senderInputContainer);this.senderInput.focus()}));this.addSenderContainer=t.Tag.render(fe||(fe=pe`
			<div class="add-sender-container">
				${0}
				${0}
			</div>
		`),this.senderInputContainer,this.senderAddButton)}function dt(){return new Promise((e=>{const s=()=>{t.Dom.hide(this.senderInputContainer);t.Dom.show(this.senderAddButton);this.senderInput.value=null;e()};if(this.senderInput.value.trim().length===0){s();return}if(babelHelpers.classPrivateFieldLooseBase(this,nt)[nt](this.senderInput.value.trim())){e();return}const i=this.senderInput.value;t.ajax.runAction("main.api.mail.sender.addAlias",{data:{name:i,email:this.email}}).then((e=>{const a=e.data;const n=a.senderId;if(this.setSender&&a.senderId){this.setSender(a.senderId,i,this.email)}this.wasSenderUpdated=true;this.senderId=n;const r=babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge]({id:n,name:i,isOwner:true,type:Re,canEdit:true});t.Dom.append(r,this.senderList);s()})).catch((()=>{s()}))}))}function ct(){this.settingsButton=new n.Button({text:t.Loc.getMessage("UI_MAIL_ALIAS_SLIDER_MAIL_SETTINGS_BUTTON"),icon:n.Button.Icon.SETTING,color:n.Button.Color.LIGHT_BORDER})}function ut(e){const s=t.Tag.render(Pe||(Pe=pe`<div class="sender-list-item"></div>`));const{root:i,textNode:a}=babelHelpers.classPrivateFieldLooseBase(this,qe)[qe](e.name);let n=null;if(e.canEdit){const{nameEditContainer:s,editInput:r}=babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](e,a);t.Dom.append(s,i);n=()=>{r.value=i.innerText;t.Dom.hide(a);t.Dom.show(s);r.focus()};t.Event.bind(a,"click",n)}t.Dom.append(i,s);t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](e),s);t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze](e,s,n),s);if(e.type===He&&this.id===Number(e.id)||e.type===xe&&this.id===Number(e.mailboxId)){this.mainSenderNameNode=i.querySelector(".sender-item-name-text-container")}return s}function vt(e){const{root:s,textNode:i}=t.Tag.render(ge||(ge=pe`
			<div class="sender-item-name-container">
				<div class="sender-item-name-text-container" ref="textNode">
					${0}
				</div>
			</div>
		`),t.Text.encode(e));return{root:s,textNode:i}}function ht(e,s){const i=s;const{root:a,editInput:n}=t.Tag.render(_e||(_e=pe`
			<div class="edit-sender-container-content" ref="editContent">
				<div class="ui-ctl ui-ctl-textbox ui-ctl-default-light ui-ctl-sm ui-ctl-w100">
					<input type="text" class="ui-ctl-element" ref="editInput" placeholder="${0}">
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_ALIAS_SLIDER_ADD_INPUT_PLACEHOLDER"));const r=a;const l=()=>new Promise((a=>{const l=()=>{n.value=s.innerText;t.Dom.hide(r);t.Dom.show(i);a()};if(n.value.length===0||n.value===s.innerText){l();return}if(babelHelpers.classPrivateFieldLooseBase(this,nt)[nt](n.value)){a();return}const o=n.value;t.ajax.runAction("main.api.mail.sender.updateSenderName",{data:{senderId:e.id,name:o}}).then((()=>{i.innerText=o;if(this.setSender){this.setSender(e.id,o,this.email)}this.wasSenderUpdated=true;l()})).catch((()=>{l()}))}));t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,et)[et](l,n),a);const o=()=>{t.Dom.hide(r);t.Dom.show(i);n.value=null};t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,tt)[tt](o),a);t.Dom.hide(a);return{nameEditContainer:r,editInput:n}}function pt(e){return t.Tag.render(Ee||(Ee=pe`
			<div class="sender-item-type-container">${0}</div>
		`),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,We)[We](e)))}function bt(e){if(e.type===He&&this.id===Number(e.id)||e.type===xe&&this.id===Number(e.mailboxId)){return t.Loc.getMessage("UI_MAIL_ALIAS_EDITOR_CURRENT_SENDER_NAME")}if([He,xe].includes(e.type)&&e.isOwner){return t.Loc.getMessage("UI_MAIL_ALIAS_EDITOR_ANOTHER_SENDER_NAME")}if(e.type===Re&&e.isOwner){return t.Loc.getMessage("UI_MAIL_ALIAS_EDITOR_ADDITIONAL_SENDER_NAME")}return""}function mt(e,s,i){const a=t.Tag.render(Fe||(Fe=pe`
			<div class="sender-item-edit-container"></div>
		`));if(!e.isOwner){t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](e.userUrl,e.avatar),a);return a}const n=t.Tag.render(ye||(ye=pe`
			<div class="sender-item-btn ui-btn ui-btn-xs ui-icon-set --pencil-50"></div>
		`));t.Dom.append(n,a);if(i){t.Event.bind(n,"click",i)}if(e.type===Re){t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Je)[Je](e.id,s),a);return a}t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe](e.type,e.id,e.editHref),a);return a}function Lt(e,s){const{root:i,userAvatarContainer:a}=t.Tag.render(Te||(Te=pe`
			<div class="sender-item-owner-info">
				${0}
				<a href="${0}" class="ui-icon ui-icon-common-user sender-item-owner-avatar" ref="userAvatarContainer"></a> 
			</div>
		`),t.Loc.getMessage("UI_MAIL_ALIAS_EDITOR_ANOTHER_USER_SENDER_NAME"),t.Text.encode(e));let n="";if(s){n=t.Tag.render(De||(De=pe`<i style="background-image: url('${0}')"></i>`),t.Text.encode(s))}else{n=t.Tag.render(Me||(Me=pe`<div class="sender-item-owner-avatar-icon ui-icon-set --person"></div>`))}t.Dom.append(n,a);return i}function It(e,s){const i=t.Tag.render(Ae||(Ae=pe`
			<div class="sender-item-btn ui-btn ui-btn-xs ui-icon-set --trash-bin" style="margin: 0"></div>
		`));t.Event.bind(i,"click",(()=>{t.Dom.removeClass(i,["ui-icon-set","--trash-bin"]);t.Dom.addClass(i,["ui-btn-light","ui ui-btn-wait"]);t.ajax.runAction("main.api.mail.sender.deleteSender",{data:{senderId:e}}).then((()=>{s.remove();this.wasSenderUpdated=true;if(Number(e)===this.senderId){this.setSender()}})).catch((()=>{t.Dom.removeClass(i,"ui-btn-wait")}))}));return i}function St(e,s,i){const a=t.Tag.render(Be||(Be=pe`
			<div class="sender-item-btn ui-btn ui-btn-xs ui-icon-set --settings-1" style="margin: 0"></div>
		`));if(e===xe){t.Event.bind(a,"click",(()=>{babelHelpers.classPrivateFieldLooseBase(this,at)[at](i)}));return a}t.Event.bind(a,"click",(()=>{babelHelpers.classPrivateFieldLooseBase(this,it)[it](s)}));return a}function ft(e,s){const i=t.Tag.render(we||(we=pe`
			<div class="ui-btn ui-btn-xs ui-btn-primary ui-btn-icon-done" style="margin: 0"></div>
		`));t.Event.bind(i,"click",(()=>{t.Dom.addClass(i,"ui ui-btn-wait");e().then((()=>{t.Dom.removeClass(i,"ui-btn-wait")})).catch((()=>{}))}));t.Event.bind(s,"keypress",(e=>{if(e.key==="Enter"){i.click()}}));return i}function Pt(e){const s=t.Tag.render(Ce||(Ce=pe`
			<div class="sender-item-btn ui-btn ui-btn-xs ui-icon-set --cross-45" style="margin: 0"></div>
		`));t.Event.bind(s,"click",e);return s}function gt(e){if(!e){return}e.sort(((e,t)=>e.id-t.id));e.forEach((e=>{const s=babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge](e);t.Dom.append(s,this.senderList)}))}function _t(e){G.openSlider({senderId:Number(e),setSenderCallback:(e,t,s)=>{if(this.mainSenderNameNode){this.mainSenderNameNode.innerText=t}this.setSender(e,t,s);this.wasSenderUpdated=true}})}function Et(e){BX.SidePanel.Instance.open(e)}function Ft(e){const s=/[^\p{L}\p{N}\p{Zs}\-.'(),]+/gu;if(s.test(e)){top.BX.UI.Notification.Center.notify({content:t.Text.encode(t.Loc.getMessage("UI_MAIL_ALIAS_EDITOR_INVALID_SYMBOLS_NOTIFICATION"))});return true}return false}e.AliasEditor=rt;e.SmtpEditor=G})(this.BX.UI.Mail=this.BX.UI.Mail||{},BX,BX.UI.SidePanel,BX,BX.UI,BX.UI,BX,BX.UI);
//# sourceMappingURL=sender-editor.bundle.map.js