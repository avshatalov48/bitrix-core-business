{"version":3,"file":"registry.bundle.js","sources":["../src/utils/format.js","../src/application/nested-modules/settings/format/format-functions.js","../src/application/nested-modules/settings/format/field-config.js","../src/utils/validate.js","../src/application/nested-modules/settings/settings.js","../src/application/nested-modules/tariff-restrictions/format/field-config.js","../src/application/nested-modules/tariff-restrictions/tariff-restrictions.js","../src/application/application.js","../src/messages/format/format-functions.js","../src/messages/format/field-config.js","../src/messages/nested-modules/pin.js","../src/messages/nested-modules/reactions.js","../src/messages/nested-modules/comments/format/field-config.js","../src/messages/nested-modules/comments/comments.js","../src/messages/messages.js","../src/chats/format/format-functions.js","../src/chats/format/field-config.js","../src/chats/chats.js","../src/users/nested-modules/bots.js","../src/users/format/format-functions.js","../src/users/format/field-config.js","../src/users/users.js","../src/files/files.js","../src/recent/format/format-functions.js","../src/recent/format/field-config.js","../src/recent/nested-modules/calls.js","../src/recent/recent.js","../src/notifications/notifications.js","../src/sidebar/nested-modules/links/format/field-config.js","../src/sidebar/nested-modules/links/links.js","../src/sidebar/nested-modules/favorites/format/field-config.js","../src/sidebar/nested-modules/favorites/favorites.js","../src/sidebar/nested-modules/members.js","../src/sidebar/nested-modules/message-search/message-search.js","../src/sidebar/nested-modules/tasks/format/field-config.js","../src/sidebar/nested-modules/tasks/tasks.js","../src/sidebar/nested-modules/meeting/format/field-config.js","../src/sidebar/nested-modules/meeting/meeting.js","../src/sidebar/nested-modules/files/format/field-config.js","../src/sidebar/nested-modules/files/files.js","../src/sidebar/nested-modules/multidialog/format/field-config.js","../src/sidebar/nested-modules/multidialog/multidialog.js","../src/sidebar/sidebar.js","../src/market/market.js","../src/counters/counters.js","../src/copilot/format/field-config.js","../src/copilot/nested-modules/chats/field-config.js","../src/copilot/nested-modules/chats/chats.js","../src/copilot/nested-modules/messages/field-config.js","../src/copilot/nested-modules/messages/messages.js","../src/copilot/nested-modules/roles/field-config.js","../src/copilot/nested-modules/roles/roles.js","../src/copilot/copilot.js"],"sourcesContent":["import { Type, Text } from 'main.core';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport const isNumberOrString = (target: JsonValue): boolean => {\n\treturn Type.isNumber(target) || Type.isString(target);\n};\n\nexport const convertToString = (target: JsonValue): string => {\n\treturn target.toString();\n};\n\nexport const convertToNumber = (target: string | number): number => {\n\treturn Number.parseInt(target, 10);\n};\n\nexport const convertToDate = (target: string) => {\n\treturn Utils.date.cast(target, false);\n};\n\nconst SNAKE_CASE_REGEXP = /(_[\\da-z])/gi;\nexport const convertObjectKeysToCamelCase = (targetObject: JsonObject): JsonObject => {\n\tconst resultObject = {};\n\tObject.entries(targetObject).forEach(([key, value]) => {\n\t\tconst newKey = prepareKey(key);\n\t\tif (Type.isPlainObject(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertObjectKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertArrayItemsKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\t\tresultObject[newKey] = value;\n\t});\n\n\treturn resultObject;\n};\n\nconst prepareKey = (rawKey: string): string => {\n\tlet key = rawKey;\n\tif (key.search(SNAKE_CASE_REGEXP) !== -1)\n\t{\n\t\tkey = key.toLowerCase();\n\t}\n\n\treturn Text.toCamelCase(key);\n};\n\nconst convertArrayItemsKeysToCamelCase = (targetArray: JsonValue[]): JsonValue[] => {\n\treturn targetArray.map((arrayItem) => {\n\t\tif (!Type.isPlainObject(arrayItem))\n\t\t{\n\t\t\treturn arrayItem;\n\t\t}\n\n\t\treturn convertObjectKeysToCamelCase(arrayItem);\n\t});\n};\n","import { NotificationSettingsBlock } from 'im.v2.const';\nimport type { RawNotificationSettingsBlock, NotificationSettingsItem } from 'im.v2.const';\n\ntype PreparedNotificationSettings = {\n\t[block: string]: NotificationSettingsBlock,\n};\n\nconst SortWeight = {\n\tim: 10,\n};\n\nexport const prepareNotificationSettings = (target: RawNotificationSettingsBlock[]): PreparedNotificationSettings => {\n\tconst result = {};\n\n\tconst sortedTarget = sortNotificationSettingsBlock(target);\n\tsortedTarget.forEach((block: RawNotificationSettingsBlock) => {\n\t\tconst preparedItems = {};\n\t\tblock.notices.forEach((item: NotificationSettingsItem) => {\n\t\t\tpreparedItems[item.id] = item;\n\t\t});\n\t\tresult[block.id] = {\n\t\t\tid: block.id,\n\t\t\tlabel: block.label,\n\t\t\titems: preparedItems,\n\t\t};\n\t});\n\n\treturn result;\n};\n\nconst sortNotificationSettingsBlock = (target: RawNotificationSettingsBlock[]): RawNotificationSettingsBlock[] => {\n\treturn [...target].sort((a, b) => {\n\t\tconst weightA = SortWeight[a.id] ?? 0;\n\t\tconst weightB = SortWeight[b.id] ?? 0;\n\n\t\treturn weightB - weightA;\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Settings } from 'im.v2.const';\n\nimport { convertToNumber, isNumberOrString } from '../../../../utils/format';\nimport { prepareNotificationSettings } from './format-functions';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const settingsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: Settings.notification.enableSound,\n\t\ttargetFieldName: Settings.notification.enableSound,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableAutoRead,\n\t\ttargetFieldName: Settings.notification.enableAutoRead,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.mode,\n\t\ttargetFieldName: Settings.notification.mode,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableWeb,\n\t\ttargetFieldName: Settings.notification.enableWeb,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableMail,\n\t\ttargetFieldName: Settings.notification.enableMail,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enablePush,\n\t\ttargetFieldName: Settings.notification.enablePush,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'notifications',\n\t\ttargetFieldName: 'notifications',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareNotificationSettings,\n\t},\n\t{\n\t\tfieldName: Settings.message.bigSmiles,\n\t\ttargetFieldName: Settings.message.bigSmiles,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.background,\n\t\ttargetFieldName: Settings.appearance.background,\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.alignment,\n\t\ttargetFieldName: Settings.appearance.alignment,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showBirthday,\n\t\ttargetFieldName: Settings.recent.showBirthday,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showInvited,\n\t\ttargetFieldName: Settings.recent.showInvited,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showLastMessage,\n\t\ttargetFieldName: Settings.recent.showLastMessage,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target) => {\n\t\t\treturn target === '1';\n\t\t},\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.desktop.enableRedirect,\n\t\ttargetFieldName: Settings.desktop.enableRedirect,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.user.status,\n\t\ttargetFieldName: Settings.user.status,\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport { convertObjectKeysToCamelCase } from './format';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport type FieldsConfig = FieldsConfigItem[];\ntype FieldsConfigItem = {\n\tfieldName: string | Array<string>,\n\ttargetFieldName: string,\n\tcheckFunction?: CheckFunction | Array<CheckFunction>, // OR logic\n\tformatFunction?: FormatFunction,\n};\ntype CheckFunction = (target: JsonValue) => boolean;\ntype FormatFunction = (target: JsonValue, currentResult: JsonObject, rawFields: JsonObject) => JsonValue;\n\nexport const formatFieldsWithConfig = (fields: JsonObject, config: FieldsConfig): JsonObject => {\n\tconst resultObject = {};\n\tconst rawFields = convertObjectKeysToCamelCase(fields);\n\n\tconfig.forEach((fieldConfig: FieldsConfigItem) => {\n\t\tconst { fieldName, targetFieldName, checkFunction, formatFunction } = fieldConfig;\n\n\t\t// check if field exists\n\t\tconst foundFieldName = getValidFieldName(rawFields, fieldName);\n\t\tif (!foundFieldName)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// validate value\n\t\tif (!isFieldValueValid(rawFields[foundFieldName], checkFunction))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// format value\n\t\tresultObject[targetFieldName] = formatFieldValue({\n\t\t\tfieldValue: rawFields[foundFieldName],\n\t\t\tformatFunction,\n\t\t\tcurrentResult: resultObject,\n\t\t\trawFields: fields,\n\t\t});\n\t});\n\n\treturn resultObject;\n};\n\nconst getValidFieldName = (fields: JsonObject, fieldName: string | string[]): string | null => {\n\tlet fieldNameList = fieldName;\n\tif (Type.isStringFilled(fieldNameList))\n\t{\n\t\tfieldNameList = [fieldNameList];\n\t}\n\n\tfor (const singleField of fieldNameList)\n\t{\n\t\tif (!Type.isUndefined(fields[singleField]))\n\t\t{\n\t\t\treturn singleField;\n\t\t}\n\t}\n\n\treturn null;\n};\n\nconst isFieldValueValid = (field: JsonValue, checkFunction: CheckFunction | Array<CheckFunction>): boolean => {\n\tlet checkFunctionList = checkFunction;\n\tif (Type.isUndefined(checkFunctionList))\n\t{\n\t\treturn true;\n\t}\n\n\tif (Type.isFunction(checkFunctionList))\n\t{\n\t\tcheckFunctionList = [checkFunctionList];\n\t}\n\n\treturn checkFunctionList.some((singleFunction) => singleFunction(field));\n};\n\ntype FormatFieldValueParams = {\n\tfieldValue: JsonValue,\n\tformatFunction: FormatFunction,\n\tcurrentResult: JsonObject,\n\trawFields: JsonObject\n};\nconst formatFieldValue = (params: FormatFieldValueParams) => {\n\tconst { fieldValue, formatFunction, currentResult, rawFields } = params;\n\tif (Type.isUndefined(formatFunction))\n\t{\n\t\treturn fieldValue;\n\t}\n\n\treturn formatFunction(fieldValue, currentResult, rawFields);\n};\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { Settings, DialogAlignment, NotificationSettingsMode, NotificationSettingsType, NotificationSettingsBlock } from 'im.v2.const';\nimport { settingsFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\n\ntype SettingsState = {\n\t[settingName: string]: any,\n\tnotifications: {\n\t\t[moduleId: string]: NotificationSettingsBlock\n\t}\n};\ntype NotificationOptionPayload = {\n\tmoduleId: string,\n\toptionName: string,\n\ttype: $Values<typeof NotificationSettingsType>,\n\tvalue: boolean\n};\n\n/* eslint-disable no-param-reassign */\nexport class SettingsModel extends BuilderModel\n{\n\tgetState(): SettingsState\n\t{\n\t\treturn {\n\t\t\t[Settings.appearance.background]: 1,\n\t\t\t[Settings.appearance.alignment]: DialogAlignment.left,\n\n\t\t\t[Settings.notification.enableSound]: true,\n\t\t\t[Settings.notification.enableAutoRead]: true,\n\t\t\t[Settings.notification.mode]: NotificationSettingsMode.simple,\n\t\t\t[Settings.notification.enableWeb]: true,\n\t\t\t[Settings.notification.enableMail]: true,\n\t\t\t[Settings.notification.enablePush]: true,\n\t\t\tnotifications: {},\n\n\t\t\t[Settings.message.bigSmiles]: true,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\n\t\t\t[Settings.desktop.enableRedirect]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/get */\n\t\t\tget: (state: SettingsState) => (key: string): any => {\n\t\t\t\treturn state[key];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/set */\n\t\t\tset: (store, payload: {[settingName: string]: any}) => {\n\t\t\t\tstore.commit('set', this.formatFields(payload));\n\t\t\t},\n\t\t\t/** @function application/settings/setNotificationOption */\n\t\t\tsetNotificationOption: (store, payload: NotificationOptionPayload) => {\n\t\t\t\tstore.commit('setNotificationOption', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetNotificationOption: (state: SettingsState, payload: NotificationOptionPayload) => {\n\t\t\t\tconst { moduleId, optionName, type, value } = payload;\n\t\t\t\tconst moduleOptions = state.notifications[moduleId];\n\t\t\t\tif (!moduleOptions?.items?.[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmoduleOptions.items[optionName][type] = value;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, settingsFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const tariffRestrictionsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'fullChatHistory',\n\t\ttargetFieldName: 'fullChatHistory',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n];\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { tariffRestrictionsFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\n\nexport type TariffRestrictions = {\n\tfullChatHistory: {\n\t\tisAvailable: boolean,\n\t\tlimitDays: number | null,\n\t}\n};\n\n/* eslint-disable no-param-reassign */\nexport class TariffRestrictionsModel extends BuilderModel\n{\n\tgetState(): TariffRestrictions\n\t{\n\t\treturn {\n\t\t\tfullChatHistory: {\n\t\t\t\tisAvailable: true,\n\t\t\t\tlimitDays: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/tariffRestrictions/get */\n\t\t\tget: (state: TariffRestrictions): TariffRestrictions => {\n\t\t\t\treturn state;\n\t\t\t},\n\t\t\t/** @function application/tariffRestrictions/isHistoryAvailable */\n\t\t\tisHistoryAvailable: (state: TariffRestrictions): boolean => {\n\t\t\t\treturn state.fullChatHistory?.isAvailable ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/tariffRestrictions/set */\n\t\t\tset: (store, payload: JsonObject) => {\n\t\t\t\tstore.commit('set', this.formatFields(payload));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: TariffRestrictions, payload: JsonObject) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, tariffRestrictionsFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Layout, EventType } from 'im.v2.const';\n\nimport { SettingsModel } from './nested-modules/settings/settings';\nimport { TariffRestrictionsModel } from './nested-modules/tariff-restrictions/tariff-restrictions';\n\nimport type { ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\n\ntype ApplicationState = {\n\tlayout: {\n\t\tname: string,\n\t\tentityId: string,\n\t\tcontextId: number,\n\t},\n};\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tsettings: SettingsModel,\n\t\t\ttariffRestrictions: TariffRestrictionsModel,\n\t\t};\n\t}\n\n\tgetState(): ApplicationState\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat.name,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/getLayout */\n\t\t\tgetLayout: (state) => {\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\t/** @function application/isChatOpen */\n\t\t\tisChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tconst allowedLayouts = [Layout.chat.name, Layout.copilot.name, Layout.channel.name];\n\t\t\t\tif (!allowedLayouts.includes(state.layout.name))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tisLinesChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (state.layout.name !== Layout.openlines.name)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\t/** @function application/areNotificationsOpen */\n\t\t\tareNotificationsOpen: (state) => {\n\t\t\t\treturn state.layout.name === Layout.notification.name;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/setLayout */\n\t\t\tsetLayout: (store, payload: {name: string, entityId?: string, contextId?: number}) => {\n\t\t\t\tconst { name, entityId = '', contextId = 0 } = payload;\n\t\t\t\tif (!Type.isStringFilled(name))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = { ...store.state.layout };\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(name),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(name, entityId),\n\t\t\t\t\tcontextId,\n\t\t\t\t};\n\t\t\t\tif (previousLayout.name === newLayout.name && previousLayout.entityId === newLayout.entityId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateLayout', {\n\t\t\t\t\tlayout: newLayout,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tupdateLayout: (state, payload) => {\n\t\t\t\tstate.layout = { ...state.layout, ...payload.layout };\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidateLayout(name: string): string\n\t{\n\t\tif (!Layout[name])\n\t\t{\n\t\t\treturn Layout.chat.name;\n\t\t}\n\n\t\treturn name;\n\t}\n\n\tvalidateLayoutEntityId(name: string, entityId: string): string\n\t{\n\t\tif (!Layout[name])\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}\n","import { Type, type JsonObject } from 'main.core';\nimport { MessageComponent, type KeyboardButtonConfig } from 'im.v2.const';\n\nimport { convertToNumber } from '../../utils/format';\n\nexport const prepareComponentId = (componentId: string) => {\n\tconst supportedComponents = Object.values(MessageComponent);\n\tif (!supportedComponents.includes(componentId))\n\t{\n\t\treturn MessageComponent.unsupported;\n\t}\n\n\treturn componentId;\n};\n\nexport const prepareAuthorId = (target: number | string, currentResult: JsonObject, rawFields: JsonObject): number => {\n\tif (Type.isString(rawFields.system) && rawFields.system === 'Y')\n\t{\n\t\treturn 0;\n\t}\n\n\tif (Type.isBoolean(rawFields.isSystem) && rawFields.isSystem === true)\n\t{\n\t\treturn 0;\n\t}\n\n\treturn convertToNumber(target);\n};\n\nexport const prepareKeyboard = (rawKeyboardButtons: KeyboardButtonConfig[]): KeyboardButtonConfig[] => {\n\treturn rawKeyboardButtons.map((rawButton) => {\n\t\treturn {\n\t\t\t...rawButton,\n\t\t\tblock: rawButton.block === 'Y',\n\t\t\tdisabled: rawButton.disabled === 'Y',\n\t\t\tvote: rawButton.vote === 'Y',\n\t\t\twait: rawButton.wait === 'Y',\n\t\t};\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\nimport { prepareComponentId, prepareAuthorId, prepareKeyboard } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const messageFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: ['id', 'temporaryId'],\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: [Type.isNumber, Utils.text.isTempMessage],\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'date',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: [Type.isString, Type.isDate],\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'text',\n\t\ttargetFieldName: 'text',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['senderId', 'authorId'],\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareAuthorId,\n\t},\n\t{\n\t\tfieldName: 'sending',\n\t\ttargetFieldName: 'sending',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'unread',\n\t\ttargetFieldName: 'unread',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewed',\n\t\ttargetFieldName: 'viewed',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewedByOthers',\n\t\ttargetFieldName: 'viewedByOthers',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'error',\n\t\ttargetFieldName: 'error',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'componentId',\n\t\ttargetFieldName: 'componentId',\n\t\tcheckFunction: (target): boolean => {\n\t\t\treturn Type.isString(target) && target !== '';\n\t\t},\n\t\tformatFunction: prepareComponentId,\n\t},\n\t{\n\t\tfieldName: 'componentParams',\n\t\ttargetFieldName: 'componentParams',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: ['files', 'fileId'],\n\t\ttargetFieldName: 'files',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'attach',\n\t\ttargetFieldName: 'attach',\n\t\tcheckFunction: [Type.isArray, Type.isBoolean, Type.isString],\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareKeyboard,\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: (target): boolean => target === 'N',\n\t\tformatFunction: (): [] => [],\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'replyId',\n\t\ttargetFieldName: 'replyId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'forward',\n\t\ttargetFieldName: 'forward',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n];\n","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId]].map(pinnedMessageId => {\n\t\t\t\t\treturn Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\n\nimport type {Store, GetterTree, ActionTree, MutationTree} from 'ui.vue3.vuex';\nimport type {ImModelReactions} from 'im.v2.model';\n\nexport const Reaction = Object.freeze({\n\tlike: 'like',\n\tkiss: 'kiss',\n\tlaugh: 'laugh',\n\twonder: 'wonder',\n\tcry: 'cry',\n\tangry: 'angry',\n\tfacepalm: 'facepalm',\n});\n\ntype ReactionType = $Values<typeof Reaction>;\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: {[reactionType: string]: number},\n\treactionUsers: {[reactionType: string]: number[]},\n\townReactions: ReactionType[]\n};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set()\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions =>\n\t\t\t{\n\t\t\t\treturn state.collection[messageId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\tset: (store: Store, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\tstore.state.collection[payload.messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstore: Store,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tif (!store.state.collection[payload.messageId] || !Reaction[payload.reaction])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tconst newItem = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers\n\t\t\t\t\t};\n\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst newOwnReaction = !!item.ownReactions;\n\t\t\t\t\tif (newOwnReaction)\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = item.ownReactions;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnewItem.ownReactions = currentItem ? currentItem.ownReactions : new Set();\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = newItem;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t\t\t\treactions.ownReactions.add(reaction);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\t\t\t\tconst currentCounter = reactions.reactionCounters[reaction];\n\t\t\t\tif (currentCounter + 1 <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tif (!reactions.reactionUsers[reaction])\n\t\t\t\t\t{\n\t\t\t\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\treactions.reactionUsers[reaction].add(userId);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction]++;\n\t\t\t},\n\t\t\tremoveReaction: (\n\t\t\t\tstate: ReactionsState,\n\t\t\t\tpayload: {messageId: number, userId: number, reaction: ReactionType}\n\t\t\t) =>\n\t\t\t{\n\t\t\t\tconst {messageId, userId, reaction} = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach(reaction => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList)\n\t{\n\t\treturn payload.map(item => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\tconst reactionCounters = {};\n\t\t\tObject.entries(item.reactionCounters).forEach(([reaction, counter]) => {\n\t\t\t\treactionCounters[reaction] = counter;\n\t\t\t});\n\n\t\t\tconst result = {\n\t\t\t\tmessageId: item.messageId,\n\t\t\t\treactionCounters: reactionCounters,\n\t\t\t\treactionUsers: reactionUsers\n\t\t\t};\n\n\t\t\tif (item.ownReactions?.length > 0)\n\t\t\t{\n\t\t\t\tresult.ownReactions = new Set(item.ownReactions);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n}","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const commentFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'lastUserIds',\n\t\ttargetFieldName: 'lastUserIds',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'messageCount',\n\t\ttargetFieldName: 'messageCount',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'isUserSubscribed',\n\t\ttargetFieldName: 'isUserSubscribed',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { commentFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\nimport type { ImModelCommentInfo, ImModelMessage } from 'im.v2.model';\nimport type { RawCommentInfo } from 'im.v2.provider.service';\n\nconst LAST_USERS_TO_SHOW = 3;\n\ntype CommentsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelCommentInfo\n\t},\n\tlayout: {\n\t\topened: boolean,\n\t\tchannelDialogId: string,\n\t\tpostId: number,\n\t}\n};\n\nexport class CommentsModel extends BuilderModel\n{\n\tgetState(): CommentsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tlayout: {\n\t\t\t\topened: false,\n\t\t\t\tchannelDialogId: '',\n\t\t\t\tpostId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelCommentInfo\n\t{\n\t\treturn {\n\t\t\tchatId: 0,\n\t\t\tlastUserIds: [],\n\t\t\tmessageCount: 0,\n\t\t\tmessageId: 0,\n\t\t\tisUserSubscribed: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/comments/getByMessageId */\n\t\t\tgetByMessageId: (state: CommentsState) => (messageId: number): ?ImModelCommentInfo => {\n\t\t\t\treturn state.collection[messageId] ?? this.getElementState();\n\t\t\t},\n\t\t\t/** @function messages/comments/getMessageIdByChatId */\n\t\t\tgetMessageIdByChatId: (state: CommentsState) => (chatId: number): ?number => {\n\t\t\t\tconst collection = Object.values(state.collection);\n\t\t\t\tconst foundItem = collection.find((item) => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\n\t\t\t\treturn foundItem?.messageId;\n\t\t\t},\n\t\t\t/** @function messages/comments/isUserSubscribed */\n\t\t\tisUserSubscribed: (state: CommentsState) => (messageId: number): boolean => {\n\t\t\t\tconst element = state.collection[messageId];\n\t\t\t\tif (!element && this.#isMessageAuthor(messageId))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn element?.isUserSubscribed ?? false;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpened */\n\t\t\tareOpened: (state: CommentsState): boolean => {\n\t\t\t\treturn state.layout.opened;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpenedForChannel */\n\t\t\tareOpenedForChannel: (state: CommentsState) => (channelDialogId: string): boolean => {\n\t\t\t\treturn state.layout.channelDialogId === channelDialogId;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpenedForChannelPost */\n\t\t\tareOpenedForChannelPost: (state: CommentsState) => (postId: number): boolean => {\n\t\t\t\treturn state.layout.postId === postId;\n\t\t\t},\n\t\t\t/** @function messages/comments/getOpenedChannelId */\n\t\t\tgetOpenedChannelId: (state: CommentsState): string => {\n\t\t\t\treturn state.layout.channelDialogId ?? '';\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/comments/set */\n\t\t\tset: (store, rawPayload: RawCommentInfo[] | RawCommentInfo) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map((item: RawCommentInfo) => {\n\t\t\t\t\tconst currentItem: ImModelCommentInfo = store.state.collection[item.messageId];\n\t\t\t\t\tif (currentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn { ...currentItem, ...this.#formatFields(item) };\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\tisUserSubscribed: this.#isMessageAuthor(item.messageId),\n\t\t\t\t\t\t...this.#formatFields(item),\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/setLastUser */\n\t\t\tsetLastUser: (store, payload: { messageId: number, newUserId: number }) => {\n\t\t\t\tconst { messageId, newUserId } = payload;\n\t\t\t\tconst currentItem = store.state.collection[messageId];\n\t\t\t\tif (!currentItem || newUserId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastUser', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/subscribe */\n\t\t\tsubscribe: (store, messageId: number) => {\n\t\t\t\tCore.getStore().dispatch('messages/comments/set', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tisUserSubscribed: true,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/comments/unsubscribe */\n\t\t\tunsubscribe: (store, messageId: number) => {\n\t\t\t\tCore.getStore().dispatch('messages/comments/set', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tisUserSubscribed: false,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/comments/setOpened */\n\t\t\tsetOpened: (store, payload: { channelDialogId: string }) => {\n\t\t\t\tstore.commit('setOpened', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/setClosed */\n\t\t\tsetClosed: (store) => {\n\t\t\t\tstore.commit('setClosed');\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: CommentsState, payload: RawCommentInfo[]) => {\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.messageId] = item;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetLastUser: (state: CommentsState, payload: { messageId: number, newUserId: number }) => {\n\t\t\t\tconst { messageId, newUserId } = payload;\n\t\t\t\tconst { lastUserIds: currentUsers } = state.collection[messageId];\n\t\t\t\tif (currentUsers.includes(newUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentUsers.length < LAST_USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tcurrentUsers.unshift(newUserId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcurrentUsers.pop();\n\t\t\t\tcurrentUsers.unshift(newUserId);\n\t\t\t},\n\t\t\tsetOpened: (state: CommentsState, payload: { channelDialogId: string, commentsPostId: number }) => {\n\t\t\t\tconst { channelDialogId, commentsPostId } = payload;\n\n\t\t\t\tstate.layout = {\n\t\t\t\t\topened: true,\n\t\t\t\t\tchannelDialogId,\n\t\t\t\t\tpostId: commentsPostId,\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetClosed: (state: CommentsState) => {\n\t\t\t\tstate.layout = {\n\t\t\t\t\topened: false,\n\t\t\t\t\tchannelDialogId: '',\n\t\t\t\t\tcommentsPostId: 0,\n\t\t\t\t};\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, commentFieldsConfig);\n\t}\n\n\t#isMessageAuthor(messageId: number): boolean\n\t{\n\t\tconst message: ImModelMessage = Core.getStore().getters['messages/getById'](messageId);\n\n\t\treturn message?.authorId === Core.getUserId();\n\t}\n}\n","import type { JsonObject } from 'main.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageComponent, MessageType, UserIdNetworkPrefix } from 'im.v2.const';\nimport { UserManager } from 'im.v2.lib.user';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { convertToNumber } from '../utils/format';\nimport { messageFieldsConfig } from './format/field-config';\nimport { PinModel } from './nested-modules/pin';\nimport { ReactionsModel } from './nested-modules/reactions';\nimport { CommentsModel } from './nested-modules/comments/comments';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\nimport type { AttachConfig } from 'im.v2.const';\nimport type { RawMessage } from '../type/message';\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set<string | number>\n\t}\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel,\n\t\t\tcomments: CommentsModel,\n\t\t};\n\t}\n\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\treplyId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tkeyboard: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tcomponentId: MessageComponent.default,\n\t\t\tcomponentParams: {},\n\t\t\tforward: {\n\t\t\t\tid: '',\n\t\t\t\tuserId: 0,\n\t\t\t},\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/getByChatId */\n\t\t\tgetByChatId: (state: MessagesState) => (chatId: number) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t}).sort(this.#sortCollection);\n\t\t\t},\n\t\t\t/** @function messages/getById */\n\t\t\tgetById: (state: MessagesState) => (id: number | string): ?ImModelMessage => {\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\t/** @function messages/getByIdList */\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] => {\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function messages/hasMessage */\n\t\t\thasMessage: (state: MessagesState) => ({ chatId, messageId }) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/isForward */\n\t\t\tisForward: (state: MessagesState) => (id: number | string) => {\n\t\t\t\tconst message = state.collection[id];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn Type.isStringFilled(message.forward.id);\n\t\t\t},\n\t\t\t/** @function messages/isInChatCollection */\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean => {\n\t\t\t\tconst { messageId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { chatId } = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstId */\n\t\t\tgetFirstId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastId */\n\t\t\tgetLastId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastOwnMessageId */\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstUnread */\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getChatUnreadMessages */\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageFiles */\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] => {\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map((fileId) => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageType */\n\t\t\tgetMessageType: (state: MessagesState) => (messageId: number): ?$Values<typeof MessageType> => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\n\t\t\t\tif (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t},\n\t\t\t/** @function messages/getPreviousMessage */\n\t\t\tgetPreviousMessage: (state: MessagesState) => (payload: {messageId: number, chatId: number}): ?ImModelMessage => {\n\t\t\t\tconst { messageId, chatId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = [...state.chatCollection[chatId]];\n\t\t\t\tconst initialMessageIndex = chatCollection.indexOf(messageId);\n\t\t\t\tconst desiredMessageId = chatCollection[initialMessageIndex - 1];\n\t\t\t\tif (!desiredMessageId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[desiredMessageId];\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/setChatCollection */\n\t\t\tsetChatCollection: (store, payload: {messages: RawMessage | RawMessage[], clearCollection: boolean}) => {\n\t\t\t\tlet { messages, clearCollection } = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', { messages });\n\t\t\t\tstore.commit('setChatCollection', { messages });\n\t\t\t},\n\t\t\t/** @function messages/store */\n\t\t\tstore: (store, payload: RawMessage | RawMessage[]) => {\n\t\t\t\tlet preparedMessages = payload;\n\t\t\t\tif (Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpreparedMessages = [payload];\n\t\t\t\t}\n\n\t\t\t\tpreparedMessages = preparedMessages.map((message: RawMessage) => {\n\t\t\t\t\tconst currentMessage: ImModelMessage = store.state.collection[message.id];\n\t\t\t\t\tif (currentMessage)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn { ...currentMessage, ...this.#formatFields(message) };\n\t\t\t\t\t}\n\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\n\t\t\t\tif (preparedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: preparedMessages,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/add */\n\t\t\tadd: (store, payload: RawMessage) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.#formatFields(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\t/** @function messages/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.#formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: { ...currentMessage, ...this.#formatFields(fields) },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/readMessages */\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number => {\n\t\t\t\tconst { chatId, messageIds } = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView,\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\t/** @function messages/setViewedByOthers */\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function messages/clearChatCollection */\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) => {\n\t\t\t\tconst { chatId } = payload;\n\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t},\n\t\t\t/** @function messages/deleteAttach */\n\t\t\tdeleteAttach: (store, payload: {messageId: number, attachId: string }) => {\n\t\t\t\tconst { messageId, attachId } = payload;\n\t\t\t\tconst message: ImModelMessage = store.state.collection[messageId];\n\t\t\t\tif (!message || !Type.isArray(message.attach))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst attach = message.attach.filter((attachItem: AttachConfig) => {\n\t\t\t\t\treturn attachId !== attachItem.id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tfields: { ...message, ...this.#formatFields({ attach }) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = { ...state.collection[id] };\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = { ...currentMessage, ...fields, sending: false };\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tstate.collection[id] = { ...state.collection[id], ...fields };\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tconst { chatId } = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId]?.delete(id);\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) => {\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) => {\n\t\t\t\tconst { messageIdsToRead, messageIdsToView } = payload;\n\t\t\t\tmessageIdsToRead.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(rawFields: JsonObject): JsonObject\n\t{\n\t\tconst messageParams = Type.isPlainObject(rawFields.params) ? rawFields.params : {};\n\t\tconst fields = { ...rawFields, ...messageParams };\n\n\t\tconst formattedFields: ImModelMessage = formatFieldsWithConfig(fields, messageFieldsConfig);\n\t\tif (this.#needToSwapAuthorId(formattedFields, messageParams))\n\t\t{\n\t\t\tformattedFields.authorId = this.#prepareSwapAuthorId(formattedFields, messageParams);\n\t\t}\n\n\t\treturn formattedFields;\n\t}\n\n\t#needToSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): boolean\n\t{\n\t\tconst { NAME: name, USER_ID: userId } = messageParams;\n\n\t\treturn Boolean(name && userId && formattedFields.authorId);\n\t}\n\n\t#prepareSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): string\n\t{\n\t\tconst { NAME: authorName, USER_ID: userId, AVATAR: avatar } = messageParams;\n\t\tconst originalAuthorId = formattedFields.authorId;\n\t\tconst fakeAuthorId = convertToNumber(userId);\n\t\tconst userManager = new UserManager();\n\t\tconst networkId = `${UserIdNetworkPrefix}-${originalAuthorId}-${fakeAuthorId}`;\n\t\tvoid userManager.setUsersToModel({\n\t\t\tnetworkId,\n\t\t\tname: authorName,\n\t\t\tavatar: avatar ?? '',\n\t\t});\n\n\t\treturn networkId;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach((messageId) => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n\n\t#sortCollection(a: ImModelMessage, b: ImModelMessage): number\n\t{\n\t\tif (Utils.text.isUuidV4(a.id) && !Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (!Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn a.date.getTime() - b.date.getTime();\n\t\t}\n\n\t\treturn a.id - b.id;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Text, Type, type JsonObject } from 'main.core';\n\nexport const prepareManagerList = (managerList: number[] | string[]): number[] => {\n\tconst result = [];\n\n\tmanagerList.forEach((rawUserId) => {\n\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\tif (userId > 0)\n\t\t{\n\t\t\tresult.push(userId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const prepareChatName = (chatName: string | number): string => {\n\treturn Text.decode(chatName.toString());\n};\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareWritingList = (writingList: Object[]): Array<{userId: number, userName: string}> => {\n\tconst result = [];\n\n\twritingList.forEach((element) => {\n\t\tconst item = {};\n\n\t\tif (!element.userId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.userId = Number.parseInt(element.userId, 10);\n\t\titem.userName = Text.decode(element.userName);\n\n\t\tresult.push(item);\n\t});\n\n\treturn result;\n};\n\nexport const prepareMuteList = (muteList: Object[] | Object): Object[] => {\n\tconst result = [];\n\n\tif (Type.isArray(muteList))\n\t{\n\t\tmuteList.forEach((rawUserId) => {\n\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\telse if (Type.isPlainObject(muteList))\n\t{\n\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\tif (!value)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn result;\n};\n\ntype LastMessageViews = { countOfViewers: number, firstViewers: Object[], messageId: number };\nexport const prepareLastMessageViews = (rawLastMessageViews: JsonObject): LastMessageViews => {\n\tconst {\n\t\tcountOfViewers,\n\t\tfirstViewers: rawFirstViewers,\n\t\tmessageId,\n\t} = rawLastMessageViews;\n\n\tlet firstViewer = null;\n\tfor (const rawFirstViewer of rawFirstViewers)\n\t{\n\t\tif (rawFirstViewer.userId === Core.getUserId())\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tfirstViewer = {\n\t\t\tuserId: rawFirstViewer.userId,\n\t\t\tuserName: rawFirstViewer.userName,\n\t\t\tdate: Utils.date.cast(rawFirstViewer.date),\n\t\t};\n\t\tbreak;\n\t}\n\n\tif (countOfViewers > 0 && !firstViewer)\n\t{\n\t\tthrow new Error('Chats model: no first viewer for message');\n\t}\n\n\treturn {\n\t\tcountOfViewers,\n\t\tfirstViewer,\n\t\tmessageId,\n\t};\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport { Type } from 'main.core';\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\nimport { formatFieldsWithConfig, type FieldsConfig } from 'im.v2.model';\nimport {\n\tprepareAvatar,\n\tprepareChatName,\n\tprepareLastMessageViews,\n\tprepareWritingList,\n\tprepareManagerList,\n\tprepareMuteList,\n} from './format-functions';\n\nexport const chatFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['id', 'chatId'],\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'quoteId',\n\t\ttargetFieldName: 'quoteId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'counter',\n\t\ttargetFieldName: 'counter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'userCounter',\n\t\ttargetFieldName: 'userCounter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastId',\n\t\ttargetFieldName: 'lastReadId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'markedId',\n\t\ttargetFieldName: 'markedId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageId',\n\t\ttargetFieldName: 'lastMessageId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageViews',\n\t\ttargetFieldName: 'lastMessageViews',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: prepareLastMessageViews,\n\t},\n\t{\n\t\tfieldName: 'hasPrevPage',\n\t\ttargetFieldName: 'hasPrevPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'hasNextPage',\n\t\ttargetFieldName: 'hasNextPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'savedPositionMessageId',\n\t\ttargetFieldName: 'savedPositionMessageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: ['title', 'name'],\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareChatName,\n\t},\n\t{\n\t\tfieldName: ['owner', 'ownerId'],\n\t\ttargetFieldName: 'ownerId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'extranet',\n\t\ttargetFieldName: 'extranet',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'entityLink',\n\t\ttargetFieldName: 'entityLink',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, chatEntityFieldsConfig);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'dateCreate',\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'public',\n\t\ttargetFieldName: 'public',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'writingList',\n\t\ttargetFieldName: 'writingList',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareWritingList,\n\t},\n\t{\n\t\tfieldName: 'managerList',\n\t\ttargetFieldName: 'managerList',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareManagerList,\n\t},\n\t{\n\t\tfieldName: 'muteList',\n\t\ttargetFieldName: 'muteList',\n\t\tcheckFunction: [Type.isArray, Type.isPlainObject],\n\t\tformatFunction: prepareMuteList,\n\t},\n\t{\n\t\tfieldName: 'inited',\n\t\ttargetFieldName: 'inited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'loading',\n\t\ttargetFieldName: 'loading',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'description',\n\t\ttargetFieldName: 'description',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'diskFolderId',\n\t\ttargetFieldName: 'diskFolderId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'role',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target: string) => target.toLowerCase(),\n\t},\n\t{\n\t\tfieldName: 'permissions',\n\t\ttargetFieldName: 'permissions',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'tariffRestrictions',\n\t\ttargetFieldName: 'tariffRestrictions',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'parentChatId',\n\t\ttargetFieldName: 'parentChatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n];\n\nexport const chatEntityFieldsConfig = [\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'url',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type, type JsonObject } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Color, ChatType, UserRole } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { chatFieldsConfig } from './format/field-config';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype ChatState = {\n\tcollection: {[dialogId: string]: ImModelChat},\n};\n\n/* eslint-disable no-param-reassign */\nexport class ChatsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'chats';\n\t}\n\n\tgetState(): ChatState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelChat\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: ChatType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0,\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\tquoteId: 0,\n\t\t\townerId: 0,\n\t\t\tentityLink: {},\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: '',\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t\trole: UserRole.guest,\n\t\t\tpermissions: {\n\t\t\t\tmanageUi: UserRole.none,\n\t\t\t\tmanageSettings: UserRole.none,\n\t\t\t\tmanageUsersAdd: UserRole.none,\n\t\t\t\tmanageUsersDelete: UserRole.none,\n\t\t\t\tmanageMessages: UserRole.none,\n\t\t\t},\n\t\t\ttariffRestrictions: {\n\t\t\t\tisHistoryLimitExceeded: false,\n\t\t\t},\n\t\t\tparentChatId: 0,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/get */\n\t\t\tget: (state: ChatState) => (dialogId: string, getBlank: boolean = false) => {\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function chats/getByChatId */\n\t\t\tgetByChatId: (state: ChatState) => (chatId: number | string, getBlank: boolean = false) => {\n\t\t\t\tconst preparedChatId = Number.parseInt(chatId, 10);\n\n\t\t\t\tconst chat = Object.values(state.collection).find((item) => {\n\t\t\t\t\treturn item.chatId === preparedChatId;\n\t\t\t\t});\n\n\t\t\t\tif (!chat && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\treturn chat;\n\t\t\t},\n\t\t\t/** @function chats/getQuoteId */\n\t\t\tgetQuoteId: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\t/** @function chats/isUser */\n\t\t\tisUser: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === ChatType.user;\n\t\t\t},\n\t\t\t/** @function chats/getLastReadId */\n\t\t\tgetLastReadId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId } = state.collection[dialogId];\n\t\t\t\tconst lastReadIdMessage = Core.getStore().getters['messages/getById'](lastReadId);\n\t\t\t\tif (!lastReadIdMessage)\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn lastReadId;\n\t\t\t},\n\t\t\t/** @function chats/getInitialMessageId */\n\t\t\tgetInitialMessageId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, markedId } = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t\t/** @function chats/isSupport */\n\t\t\tisSupport: (state: ChatState) => (dialogId: string): boolean => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === ChatType.support24Question;\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/set */\n\t\t\tset: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/add */\n\t\t\tadd: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/update */\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields(payload.fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/delete */\n\t\t\tdelete: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { dialogId: payload.dialogId });\n\t\t\t},\n\t\t\t/** @function chats/clearCounters */\n\t\t\tclearCounters: (store) => {\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\t\t\t/** @function chats/mute */\n\t\t\tmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/unmute */\n\t\t\tunmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter((item) => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/setLastMessageViews */\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) => {\n\t\t\t\tconst { dialogId, fields: { userId, userName, date, messageId } } = payload;\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/clearLastMessageViews */\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { lastMessageViews: defaultLastMessageViews } = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/incrementLastMessageViews */\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: { ...existingItem.lastMessageViews, countOfViewers: newCounter },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = { ...state.collection[payload.dialogId], ...payload.fields };\n\t\t\t},\n\t\t\tdelete: (state: ChatState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tclearCounters: (state: ChatState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, chatFieldsConfig);\n\t}\n}\n","import { BotCode, BotType, RawBotType } from 'im.v2.const';\nimport { BuilderModel, type GetterTree, type ActionTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { convertObjectKeysToCamelCase } from '../../utils/format';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelBot } from 'im.v2.model';\n\ntype BotsState = {\n\tcollection: {[dialogId: string]: ImModelBot},\n};\n\ntype BotPayload = {\n\tuserId: string | number,\n\tbotData: ImModelBot,\n};\n\nexport class BotsModel extends BuilderModel\n{\n\tgetState(): BotsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelBot\n\t{\n\t\treturn {\n\t\t\tcode: '',\n\t\t\ttype: BotType.bot,\n\t\t\tappId: '',\n\t\t\tisHidden: false,\n\t\t\tisSupportOpenline: false,\n\t\t\tisHuman: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/getByUserId */\n\t\t\tgetByUserId: (state: BotsState) => (userId: string | number): ?ImModelBot => {\n\t\t\t\treturn state.collection[userId];\n\t\t\t},\n\t\t\t/** @function users/bots/isNetwork */\n\t\t\tisNetwork: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.network;\n\t\t\t},\n\t\t\t/** @function users/bots/isSupport */\n\t\t\tisSupport: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.support24;\n\t\t\t},\n\t\t\t/** @function users/bots/getCopilotUserId */\n\t\t\tgetCopilotUserId: (state: BotsState): ?number => {\n\t\t\t\tfor (const [userId, bot] of Object.entries(state.collection))\n\t\t\t\t{\n\t\t\t\t\tif (bot.code === BotCode.copilot)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn Number.parseInt(userId, 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function users/bots/isCopilot */\n\t\t\tisCopilot: (state: BotsState, getters) => (userId: number | string): boolean => {\n\t\t\t\tconst copilotUserId = getters.getCopilotUserId;\n\n\t\t\t\treturn copilotUserId === Number.parseInt(userId, 10);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/set */\n\t\t\tset: (store, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\tif (!botData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tuserId,\n\t\t\t\t\tbotData: { ...this.getElementState(), ...this.formatFields(botData) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: BotsState, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[userId] = botData;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): ImModelBot\n\t{\n\t\tconst result: ImModelBot = convertObjectKeysToCamelCase(fields);\n\t\tif (result.type === RawBotType.human)\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t\tresult.isHuman = true;\n\t\t}\n\n\t\tconst TYPES_MAPPED_TO_DEFAULT_BOT = [RawBotType.openline, RawBotType.supervisor];\n\t\tif (TYPES_MAPPED_TO_DEFAULT_BOT.includes(result.type))\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Type } from 'main.core';\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareDepartments = (departments: Array<number | string>): number[] => {\n\tconst result = [];\n\tdepartments.forEach((rawDepartmentId) => {\n\t\tconst departmentId = Number.parseInt(rawDepartmentId, 10);\n\t\tif (departmentId > 0)\n\t\t{\n\t\t\tresult.push(departmentId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const preparePhones = (phones): Object => {\n\tconst result = {};\n\n\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t{\n\t\tresult.workPhone = phones.workPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t{\n\t\tresult.personalMobile = phones.personalMobile.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t{\n\t\tresult.personalPhone = phones.personalPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t{\n\t\tresult.innerPhone = phones.innerPhone.toString();\n\t}\n\n\treturn result;\n};\n","import { Type, Text } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport {\n\tconvertToNumber,\n\tconvertToDate,\n\tisNumberOrString,\n} from '../../utils/format';\nimport { prepareAvatar, prepareDepartments, preparePhones } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const userFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'networkId',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Utils.user.isNetworkUserId,\n\t},\n\t{\n\t\tfieldName: 'firstName',\n\t\ttargetFieldName: 'firstName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'lastName',\n\t\ttargetFieldName: 'lastName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'workPosition',\n\t\ttargetFieldName: 'workPosition',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'gender',\n\t\ttargetFieldName: 'gender',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'birthday',\n\t\ttargetFieldName: 'birthday',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'isBirthday',\n\t\ttargetFieldName: 'isBirthday',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isAdmin',\n\t\ttargetFieldName: 'isAdmin',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'extranet',\n\t\ttargetFieldName: 'extranet',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'network',\n\t\ttargetFieldName: 'network',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'bot',\n\t\ttargetFieldName: 'bot',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'connector',\n\t\ttargetFieldName: 'connector',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'externalAuthId',\n\t\ttargetFieldName: 'externalAuthId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'idle',\n\t\ttargetFieldName: 'idle',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'lastActivityDate',\n\t\ttargetFieldName: 'lastActivityDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'mobileLastDate',\n\t\ttargetFieldName: 'mobileLastDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'absent',\n\t\ttargetFieldName: 'absent',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'isAbsent',\n\t\ttargetFieldName: 'isAbsent',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'departments',\n\t\ttargetFieldName: 'departments',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareDepartments,\n\t},\n\t{\n\t\tfieldName: 'phones',\n\t\ttargetFieldName: 'phones',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: preparePhones,\n\t},\n];\n","import { Type, Loc, type JsonObject } from 'main.core';\nimport { BuilderModel, type ActionTree, type GetterTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { UserStatusManager } from 'im.v2.lib.user-status';\nimport { Color } from 'im.v2.const';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { BotsModel } from './nested-modules/bots';\nimport { userFieldsConfig } from './format/field-config';\n\nimport type { User as ImModelUser } from '../type/user';\n\ntype UsersState = {\n\tcollection: {[userId: string]: ImModelUser},\n\tabsentList: string[],\n};\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tbots: BotsModel,\n\t\t};\n\t}\n\n\tgetState(): UsersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tabsentList: [],\n\t\t\tabsentCheckInterval: null,\n\t\t};\n\t}\n\n\tgetElementState(params = {}): ImModelUser\n\t{\n\t\tconst { id = 0 } = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\tisAdmin: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/get */\n\t\t\tget: (state) => (userId, getTemporary = false) => {\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({ id: userId });\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\t/** @function users/getBlank */\n\t\t\tgetBlank: () => (params) => {\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\t/** @function users/getList */\n\t\t\tgetList: (state) => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({ id }));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function users/hasBirthday */\n\t\t\thasBirthday: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\t/** @function users/hasVacation */\n\t\t\thasVacation: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\t/** @function users/getLastOnline */\n\t\t\tgetLastOnline: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\t/** @function users/getPosition */\n\t\t\tgetPosition: (state) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\t\t\tconst user: ImModelUser = state.collection[userId];\n\t\t\t\tconst isSupportBot = Core.getStore().getters['users/bots/isSupport'](userId);\n\n\t\t\t\tif (userId <= 0 || !user || isSupportBot)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\tif (user.bot === true)\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_CHAT_BOT');\n\t\t\t\t}\n\n\t\t\t\treturn Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/set */\n\t\t\tset: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/add */\n\t\t\tadd: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/update */\n\t\t\tupdate: (store, rawPayload) => {\n\t\t\t\tconst payload = rawPayload;\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst fields = { ...payload.fields, id: payload.id };\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\t/** @function users/setStatus */\n\t\t\tsetStatus: (store, payload: {status: string}) => {\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.formatFields(payload),\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\n\t\t\t\tUserStatusManager.getInstance().onUserUpdate(payload.fields);\n\t\t\t},\n\t\t\tupdate: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = { ...state.collection[payload.id], ...payload.fields };\n\n\t\t\t\tUserStatusManager.getInstance().onUserUpdate(payload.fields);\n\t\t\t},\n\t\t\tdelete: (state, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\tconst preparedFields: ImModelUser = formatFieldsWithConfig(fields, userFieldsConfig);\n\t\tconst isBot = preparedFields.bot === true;\n\t\tif (isBot)\n\t\t{\n\t\t\tCore.getStore().dispatch('users/bots/set', {\n\t\t\t\tuserId: preparedFields.id,\n\t\t\t\tbotData: fields.botData || fields.bot_data,\n\t\t\t});\n\t\t}\n\n\t\treturn preparedFields;\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (state.absentCheckInterval)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000 * 60 * 60 * 24;\n\t\tstate.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tstate.absentList.forEach((userId) => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {FileStatus} from 'im.v2.const';\nimport {Utils} from 'im.v2.lib.utils';\n\nimport type {ImModelFile} from 'im.v2.model';\nimport {Logger} from 'im.v2.lib.logger';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t}\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\t/** @function files/get */\n\t\t\tget: (state: FilesState) => (fileId: number, getTemporary = false): ?ImModelFile =>\n\t\t\t{\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[fileId];\n\t\t\t},\n\t\t\t/** @function files/isInCollection */\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean =>\n\t\t\t{\n\t\t\t\tconst {fileId} = payload;\n\n\t\t\t\treturn !!state.collection[fileId];\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\t/** @function files/add */\n\t\t\tadd: (store, payload: Object) =>\n\t\t\t{\n\t\t\t\tconst preparedFile = {...this.getElementState(), ...this.validate(payload)};\n\n\t\t\t\tstore.commit('add', {files: [preparedFile]});\n\t\t\t},\n\t\t\t/** @function files/set */\n\t\t\tset: (store, payload: Object[]) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\treturn {...this.getElementState(), ...this.validate(file)};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', {files: payload});\n\t\t\t},\n\t\t\t/** @function files/update */\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: id,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t/** @function files/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.validate(fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function files/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tconst {id} = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) =>\n\t\t\t{\n\t\t\t\tpayload.files.forEach(file => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) =>\n\t\t\t{\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) =>\n\t\t\t{\n\t\t\t\tconst {id, fields} = payload;\n\t\t\t\tconst currentFile = {...state.collection[id]};\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = {...currentFile, ...fields};\n\t\t\t},\n\t\t\tdelete: (state: FilesState, payload: {id: number | string}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Files model: delete mutation', payload);\n\t\t\t\tconst {id} = payload;\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidate(file: Object): ImModelFile\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(file.id) || Type.isStringFilled(file.id))\n\t\t{\n\t\t\tresult.id = file.id;\n\t\t}\n\n\t\tif (Type.isNumber(file.chatId) || Type.isString(file.chatId))\n\t\t{\n\t\t\tresult.chatId = Number.parseInt(file.chatId, 10);\n\t\t}\n\n\t\tif (!Type.isUndefined(file.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(file.date);\n\t\t}\n\n\t\tif (Type.isString(file.type))\n\t\t{\n\t\t\tresult.type = file.type;\n\t\t}\n\n\t\tif (Type.isString(file.extension))\n\t\t{\n\t\t\tresult.extension = file.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = Utils.file.getIconTypeByExtension(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.name) || Type.isNumber(file.name))\n\t\t{\n\t\t\tresult.name = file.name.toString();\n\t\t}\n\n\t\tif (Type.isNumber(file.size) || Type.isString(file.size))\n\t\t{\n\t\t\tresult.size = Number.parseInt(file.size, 10);\n\t\t}\n\n\t\tif (Type.isBoolean(file.image))\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (Type.isPlainObject(file.image))\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (Type.isString(file.image.width) || Type.isNumber(file.image.width))\n\t\t\t{\n\t\t\t\tresult.image.width = Number.parseInt(file.image.width, 10);\n\t\t\t}\n\t\t\tif (Type.isString(file.image.height) || Type.isNumber(file.image.height))\n\t\t\t{\n\t\t\t\tresult.image.height = Number.parseInt(file.image.height, 10);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.status) && !Type.isUndefined(FileStatus[file.status]))\n\t\t{\n\t\t\tresult.status = file.status;\n\t\t}\n\n\t\tif (Type.isNumber(file.progress) || Type.isString(file.progress))\n\t\t{\n\t\t\tresult.progress = Number.parseInt(file.progress, 10);\n\t\t}\n\n\t\tif (Type.isNumber(file.authorId) || Type.isString(file.authorId))\n\t\t{\n\t\t\tresult.authorId = Number.parseInt(file.authorId, 10);\n\t\t}\n\n\t\tif (Type.isString(file.authorName) || Type.isNumber(file.authorName))\n\t\t{\n\t\t\tresult.authorName = file.authorName.toString();\n\t\t}\n\n\t\tif (Type.isString(file.urlPreview))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlPreview\n\t\t\t\t|| file.urlPreview.startsWith('http')\n\t\t\t\t|| file.urlPreview.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t\t|| file.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = file.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = Core.getHost() + file.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlDownload))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlDownload\n\t\t\t\t|| file.urlDownload.startsWith('http')\n\t\t\t\t|| file.urlDownload.startsWith('bx')\n\t\t\t\t|| file.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = file.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = Core.getHost() + file.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(file.urlShow))\n\t\t{\n\t\t\tif (\n\t\t\t\t!file.urlShow\n\t\t\t\t|| file.urlShow.startsWith('http')\n\t\t\t\t|| file.urlShow.startsWith('bx')\n\t\t\t\t|| file.urlShow.startsWith('file')\n\t\t\t\t|| file.urlShow.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = file.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = Core.getHost() + file.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isPlainObject(file.viewerAttrs))\n\t\t{\n\t\t\tresult.viewerAttrs = this.validateViewerAttributes(file.viewerAttrs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateViewerAttributes(viewerAttrs)\n\t{\n\t\tconst result = {\n\t\t\tviewer: true,\n\t\t};\n\n\t\tif (Type.isString(viewerAttrs.actions))\n\t\t{\n\t\t\tresult.actions = viewerAttrs.actions;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.objectId))\n\t\t{\n\t\t\tresult.objectId = viewerAttrs.objectId;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.src))\n\t\t{\n\t\t\tresult.src = viewerAttrs.src;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.title))\n\t\t{\n\t\t\tresult.title = viewerAttrs.title;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerGroupBy))\n\t\t{\n\t\t\tresult.viewerGroupBy = viewerAttrs.viewerGroupBy;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerType))\n\t\t{\n\t\t\tresult.viewerType = viewerAttrs.viewerType;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerTypeClass))\n\t\t{\n\t\t\tresult.viewerTypeClass = viewerAttrs.viewerTypeClass;\n\t\t}\n\n\t\tif (Type.isBoolean(viewerAttrs.viewerSeparateItem))\n\t\t{\n\t\t\tresult.viewerSeparateItem = viewerAttrs.viewerSeparateItem;\n\t\t}\n\n\t\tif (Type.isString(viewerAttrs.viewerExtension))\n\t\t{\n\t\t\tresult.viewerExtension = viewerAttrs.viewerExtension;\n\t\t}\n\n\t\tif (Type.isNumber(viewerAttrs.imChatId))\n\t\t{\n\t\t\tresult.imChatId = viewerAttrs.imChatId;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { Type } from 'main.core';\n\ntype Draft = {\n\ttext: string,\n};\n\ntype PreparedDraft = {\n\ttext: string,\n\tdate: Date | null,\n};\n\ntype Invitation = Boolean | {\n\toriginatorId: number,\n\tcanResend: boolean,\n};\n\ntype PreparedInvitation = {\n\tisActive: boolean,\n\toriginator: number,\n\tcanResend: boolean,\n};\n\nexport const prepareDraft = (draft: Draft): PreparedDraft => {\n\tif (!draft.text || draft.text === '')\n\t{\n\t\treturn {\n\t\t\ttext: '',\n\t\t\tdate: null,\n\t\t};\n\t}\n\n\treturn {\n\t\ttext: draft.text,\n\t\tdate: new Date(),\n\t};\n};\n\nexport const prepareInvitation = (invited: Invitation): PreparedInvitation => {\n\tif (Type.isPlainObject(invited))\n\t{\n\t\treturn {\n\t\t\tisActive: true,\n\t\t\toriginator: invited.originatorId,\n\t\t\tcanResend: invited.canResend,\n\t\t};\n\t}\n\n\treturn {\n\t\tisActive: false,\n\t\toriginator: 0,\n\t\tcanResend: false,\n\t};\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport { Type } from 'main.core';\n\nimport { convertToString, isNumberOrString } from '../../utils/format';\nimport { prepareDraft, prepareInvitation } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const recentFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: ['id', 'dialogId'],\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: isNumberOrString,\n\t},\n\t{\n\t\tfieldName: 'draft',\n\t\ttargetFieldName: 'draft',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: prepareDraft,\n\t},\n\t{\n\t\tfieldName: 'invited',\n\t\ttargetFieldName: 'invitation',\n\t\tcheckFunction: [Type.isPlainObject, Type.isBoolean],\n\t\tformatFunction: prepareInvitation,\n\t},\n\t{\n\t\tfieldName: 'unread',\n\t\ttargetFieldName: 'unread',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'pinned',\n\t\ttargetFieldName: 'pinned',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'liked',\n\t\ttargetFieldName: 'liked',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: ['defaultUserRecord', 'isFakeElement'],\n\t\ttargetFieldName: 'isFakeElement',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isBirthdayPlaceholder',\n\t\ttargetFieldName: 'isBirthdayPlaceholder',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: ['dateLastActivity', 'lastActivityDate'],\n\t\ttargetFieldName: 'lastActivityDate',\n\t\tcheckFunction: [Type.isString, Type.isDate],\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { RecentCallStatus } from 'im.v2.const';\n\nimport type { ImModelCallItem } from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] => {\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t},\n\n\t\t\tgetCallByDialog: (state: CallsState) => (dialogId): ?ImModelCallItem => {\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\n\t\t\thasActiveCall: (state: CallsState) => (dialogId): boolean => {\n\t\t\t\tif (Type.isUndefined(dialogId))\n\t\t\t\t{\n\t\t\t\t\tconst activeCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\t\treturn item.state === RecentCallStatus.joined;\n\t\t\t\t\t});\n\n\t\t\t\t\treturn Boolean(activeCall);\n\t\t\t\t}\n\n\t\t\t\tconst existingCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === dialogId;\n\t\t\t\t});\n\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingCall.state === RecentCallStatus.joined;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.id === payload.call.id;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Type, type JsonObject } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, FakeDraftMessagePrefix, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { recentFieldsConfig } from './format/field-config';\nimport { CallsModel } from './nested-modules/calls';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelMessage, ImModelChat } from 'im.v2.model';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tcopilotCollection: Set<string>,\n\tchannelCollection: Set<string>,\n};\n\ntype SetDraftPayload = {\n\tid: string | number,\n\ttext: string,\n\tcollectionName: string,\n\taddMethodName: string\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tcalls: CallsModel,\n\t\t};\n\t}\n\n\tgetState(): RecentState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tcopilotCollection: new Set(),\n\t\t\tchannelCollection: new Set(),\n\t\t};\n\t}\n\n\tgetElementState(): ImModelRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessageId: 0,\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null,\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t},\n\t\t\tisFakeElement: false,\n\t\t\tisBirthdayPlaceholder: false,\n\t\t\tlastActivityDate: null,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/getRecentCollection */\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.recentCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getUnreadCollection */\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.unreadCollection].map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getCopilotCollection */\n\t\t\tgetCopilotCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.copilotCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getChannelCollection */\n\t\t\tgetChannelCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.channelCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getSortedCollection */\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\tconst recentCollectionAsArray = [...state.recentCollection].map((dialogId) => {\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t});\n\n\t\t\t\tconst filteredCollection = recentCollectionAsArray.filter((item) => {\n\t\t\t\t\treturn !item.isBirthdayPlaceholder && !item.isFakeElement && item.messageId;\n\t\t\t\t});\n\n\t\t\t\treturn [...filteredCollection].sort((a, b) => {\n\t\t\t\t\tconst messageA: ImModelMessage = this.#getMessage(a.messageId);\n\t\t\t\t\tconst messageB: ImModelMessage = this.#getMessage(b.messageId);\n\n\t\t\t\t\treturn messageB.date - messageA.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/get */\n\t\t\tget: (state: RecentState) => (dialogId: string): ImModelRecentItem | null => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function recent/getMessage */\n\t\t\tgetMessage: (state: RecentState) => (dialogId: string): ImModelMessage | null => {\n\t\t\t\tconst element = state.collection[dialogId];\n\t\t\t\tif (!element)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn this.#getMessage(element.messageId);\n\t\t\t},\n\t\t\t/** @function recent/needsBirthdayPlaceholder */\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\t\t\t\tconst hasTodayMessage = this.#hasTodayMessage(currentItem.messageId);\n\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/needsVacationPlaceholder */\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasTodayMessage = this.#hasTodayMessage(currentItem.messageId);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/getSortDate */\n\t\t\tgetSortDate: (state: RecentState) => (dialogId): Date | null => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst message: ImModelMessage = this.#getMessage(currentItem.messageId);\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\tconst lastActivity = currentItem.lastActivityDate;\n\t\t\t\tconst needToUseActivityDate = Type.isDate(lastActivity) && lastActivity > message.date;\n\t\t\t\tif (ChannelManager.isChannel(currentItem.dialogId) && needToUseActivityDate)\n\t\t\t\t{\n\t\t\t\t\treturn lastActivity;\n\t\t\t\t}\n\n\t\t\t\treturn message.date;\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/setRecent */\n\t\t\tsetRecent: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await Core.getStore().dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedRecentCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setUnread */\n\t\t\tsetUnread: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/setCopilot */\n\t\t\tsetCopilot: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setCopilotCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedCopilotCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setChannel */\n\t\t\tsetChannel: async (store, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setChannelCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/clearChannelCollection */\n\t\t\tclearChannelCollection: (store) => {\n\t\t\t\tstore.commit('clearChannelCollection');\n\t\t\t},\n\t\t\t/** @function recent/store */\n\t\t\tstore: (store, payload: Array | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.#formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst preparedElement = { ...element };\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({ dialogId: existingItem.dialogId, fields: preparedElement });\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({ ...this.getElementState(), ...preparedElement });\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map((item) => item.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/update */\n\t\t\tupdate: (store, payload: { id: string | number, fields: Object }) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.#formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/unread */\n\t\t\tunread: (store, payload: { id: string | number, action: boolean }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { unread: payload.action },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/pin */\n\t\t\tpin: (store, payload: { id: string | number, action: boolean }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { pinned: payload.action },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/like */\n\t\t\tlike: (store, payload: { id: string | number, messageId: number, liked: boolean }) => {\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.messageId === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { liked: payload.liked === true },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setRecentDraft */\n\t\t\tsetRecentDraft: (store, payload: { id: string | number, text: string }) => {\n\t\t\t\tCore.getStore().dispatch('recent/setDraft', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\ttext: payload.text,\n\t\t\t\t\tcollectionName: 'recentCollection',\n\t\t\t\t\taddMethodName: 'setRecentCollection',\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setCopilotDraft */\n\t\t\tsetCopilotDraft: (store, payload: { id: string | number, text: string }) => {\n\t\t\t\tCore.getStore().dispatch('recent/setDraft', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\ttext: payload.text,\n\t\t\t\t\tcollectionName: 'copilotCollection',\n\t\t\t\t\taddMethodName: 'setCopilotCollection',\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setDraft */\n\t\t\tsetDraft: (store, payload: SetDraftPayload) => {\n\t\t\t\tconst isRemovingDraft = !Type.isStringFilled(payload.text);\n\t\t\t\tif (isRemovingDraft && this.#shouldDeleteItemWithDraft(payload))\n\t\t\t\t{\n\t\t\t\t\tvoid Core.getStore().dispatch('recent/delete', { id: payload.id });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem && !isRemovingDraft)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', { ...this.getElementState(), ...this.#prepareFakeItemWithDraft(payload) });\n\t\t\t\t\texistingItem = store.state.collection[payload.id];\n\t\t\t\t}\n\n\t\t\t\tconst existingCollectionItem = store.state[payload.collectionName].has(payload.id);\n\t\t\t\tif (!existingCollectionItem)\n\t\t\t\t{\n\t\t\t\t\tif (isRemovingDraft)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstore.commit(payload.addMethodName, [payload.id.toString()]);\n\t\t\t\t}\n\n\t\t\t\tconst fields = this.#formatFields({ draft: { text: payload.text.toString() } });\n\t\t\t\tif (fields.draft.text === existingItem.draft.text)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/delete */\n\t\t\tdelete: (store, payload: { id: string | number }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteFromRecentCollection', existingItem.dialogId);\n\t\t\t\tstore.commit('deleteFromCopilotCollection', existingItem.dialogId);\n\t\t\t\tstore.commit('deleteFromChannelCollection', existingItem.dialogId);\n\t\t\t\tconst canDelete = this.#canDelete(existingItem.dialogId);\n\n\t\t\t\tif (!canDelete)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/clearUnread */\n\t\t\tclearUnread: (store) => {\n\t\t\t\tstore.commit('clearUnread');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromRecentCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCopilotCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.copilotCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromCopilotCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.copilotCollection.delete(payload);\n\t\t\t},\n\t\t\tdeleteFromChannelCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.channelCollection.delete(payload);\n\t\t\t},\n\t\t\tsetChannelCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.channelCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tclearChannelCollection: (state: RecentState) => {\n\t\t\t\tstate.channelCollection = new Set();\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({ dialogId, fields }) => {\n\t\t\t\t\t// if we already got chat - we should not update it with fake user chat\n\t\t\t\t\t// (unless it's an accepted invitation or fake user with real message)\n\t\t\t\t\tconst elementIsInRecent = state.recentCollection.has(dialogId);\n\t\t\t\t\tconst isFakeElement = fields.isFakeElement && Utils.text.isTempMessage(fields.messageId);\n\t\t\t\t\tif (elementIsInRecent && isFakeElement && !fields.invitation)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tstate.collection[dialogId] = { ...currentElement, ...fields };\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\n\t\t\tclearUnread: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(rawFields: JsonObject): Partial<ImModelRecentItem>\n\t{\n\t\tconst options = Type.isPlainObject(rawFields.options) ? rawFields.options : {};\n\t\tconst fields = { ...rawFields, ...options };\n\n\t\treturn formatFieldsWithConfig(fields, recentFieldsConfig);\n\t}\n\n\t#updateUnloadedRecentCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedChatCounters');\n\t}\n\n\t#updateUnloadedCopilotCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedCopilotCounters');\n\t}\n\n\t#updateUnloadedCounters(payload: Array | Object, updateMethod: string)\n\t{\n\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t{\n\t\t\tpayload = [payload];\n\t\t}\n\t\tconst zeroedCountersForNewItems = {};\n\t\tpayload.forEach((item) => {\n\t\t\tzeroedCountersForNewItems[item.chat_id] = 0;\n\t\t});\n\t\tvoid Core.getStore().dispatch(updateMethod, zeroedCountersForNewItems);\n\t}\n\n\t#getMessage(messageId: number | string): ImModelMessage\n\t{\n\t\treturn Core.getStore().getters['messages/getById'](messageId);\n\t}\n\n\t#getDialog(dialogId: string): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/get'](dialogId);\n\t}\n\n\t#hasTodayMessage(messageId: number | string): boolean\n\t{\n\t\tconst message: ImModelMessage = this.#getMessage(messageId);\n\t\tconst hasMessage = Utils.text.isUuidV4(message.id) || message.id > 0;\n\n\t\treturn hasMessage && Utils.date.isToday(message.date);\n\t}\n\n\t#canDelete(dialogId: string): boolean\n\t{\n\t\tconst NOT_DELETABLE_TYPES = [ChatType.openChannel];\n\t\tconst { type } = this.#getDialog(dialogId);\n\n\t\treturn !NOT_DELETABLE_TYPES.includes(type);\n\t}\n\n\t#prepareFakeItemWithDraft(payload: SetDraftPayload): Partial<ImModelRecentItem>\n\t{\n\t\tconst messageId = this.#createFakeMessageForDraft(payload.id);\n\n\t\treturn this.#formatFields({\n\t\t\tdialogId: payload.id.toString(),\n\t\t\tdraft: {\n\t\t\t\ttext: payload.text.toString(),\n\t\t\t},\n\t\t\tmessageId,\n\t\t});\n\t}\n\n\t#createFakeMessageForDraft(dialogId: string): string\n\t{\n\t\tconst messageId = `${FakeDraftMessagePrefix}-${dialogId}`;\n\t\tvoid Core.getStore().dispatch('messages/store', { id: messageId, date: new Date() });\n\n\t\treturn messageId;\n\t}\n\n\t#shouldDeleteItemWithDraft(payload: SetDraftPayload): boolean\n\t{\n\t\tconst existingItem = Core.getStore().state.recent.collection[payload.id];\n\n\t\treturn existingItem\n\t\t\t&& !Type.isStringFilled(payload.text)\n\t\t\t&& existingItem.messageId.toString().startsWith(FakeDraftMessagePrefix)\n\t\t;\n\t}\n}\n","import {BuilderModel} from 'ui.vue3.vuex';\nimport {Type, Text} from 'main.core';\n\nimport {Core} from 'im.v2.application.core';\nimport {Utils} from 'im.v2.lib.utils';\nimport {NotificationTypesCodes} from 'im.v2.const';\n\nimport { convertObjectKeysToCamelCase } from '../utils/format';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t\titemsToAdd.forEach(() => {\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t\tstore.commit('setCounter', 0);\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tdeleteFromSearch: (store, payload) => {\n\t\t\t\tconst existingItem = store.state.searchCollection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id: existingItem.id });\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t\tstate.searchCollection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) => {\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read,\n\t\t\t\t});\n\t\t\t\tstate.searchCollection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read,\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = convertObjectKeysToCamelCase(fields.params);\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarLinksFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn target.source ?? '';\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'richData',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target.richData, richDataFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const richDataFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'description',\n\t\ttargetFieldName: 'description',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'link',\n\t\ttargetFieldName: 'link',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'previewUrl',\n\t\ttargetFieldName: 'previewUrl',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { sidebarLinksFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarLinkItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype LinksState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n\tcounters: {[chatId: number]: number},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarLinkItem>,\n}\n\ntype LinksPayload = {\n\tchatId?: number,\n\tlinks?: Object[],\n\thasNextPage?: boolean,\n\tisHistoryLimitExceeded: boolean,\n}\n\n/* eslint-disable no-param-reassign */\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\tcounters: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/links/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getCounter */\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t},\n\t\t\t/** @function sidebar/links/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/links/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSearchResultCollectionSize */\n\t\t\tgetSearchResultCollectionSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/links/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/links/setCounter */\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\t/** @function sidebar/links/set */\n\t\t\tset: (store, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, links, hasNextPage, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tlinks.forEach((link) => {\n\t\t\t\t\tconst preparedLink = { ...this.getElementState(), ...this.formatFields(link) };\n\t\t\t\t\tstore.commit('add', { chatId, link: preparedLink });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/links/setSearch */\n\t\t\tsetSearch: (store, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, links, hasNextPage, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tlinks.forEach((link) => {\n\t\t\t\t\tconst preparedLink = { ...this.getElementState(), ...this.formatFields(link) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, link: preparedLink });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/links/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/links/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].items.has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst { chatId, counter } = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst { chatId, link } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(link.id, link);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst { chatId, link } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(link.id, link);\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarLinksFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarFavoritesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import type { JsonObject } from 'main.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarFavoritesFieldsConfig } from './format/field-config';\n\nimport type { ImModelSidebarFavoriteItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype FavoritesState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n\tcounters: {[chatId: number]: number},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarFavoriteItem>,\n\tlastId: number\n}\n\ntype FavoritesPayload = {\n\tchatId?: number,\n\tfavorites?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/favorites/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getCounter */\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/isFavoriteMessage */\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId].items);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find((element) => element.messageId === messageId);\n\n\t\t\t\treturn Boolean(targetMessage);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/favorites/setCounter */\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst { chatId, favorites, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\n\t\t\t\tfavorites.forEach((favorite) => {\n\t\t\t\t\tconst preparedFavoriteMessage = { ...this.getElementState(), ...this.formatFields(favorite) };\n\t\t\t\t\tstore.commit('add', { chatId, favorite: preparedFavoriteMessage });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].items.has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/deleteByMessageId */\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst { chatId, messageId } = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId].items;\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id: targetLinkId });\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/setSearch */\n\t\t\tsetSearch: (store, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, favorites, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\n\t\t\t\tfavorites.forEach((favorite) => {\n\t\t\t\t\tconst preparedFavoriteMessage = { ...this.getElementState(), ...this.formatFields(favorite) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, favorite: preparedFavoriteMessage });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst { chatId, counter } = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst { chatId, favorite } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(favorite.id, favorite);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst { chatId, favorite } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(favorite.id, favorite);\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarFavoritesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: { [chatId: number]: ChatState }\n};\n\ntype ChatState = {\n\tusers: Set<number>,\n\tinited: boolean,\n\thasNextPage: boolean,\n\tlastId: number\n};\n\n/* eslint-disable no-param-reassign */\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\tusers: new Set(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t\tinited: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/members/get */\n\t\t\tget: (state) => (chatId: number): number[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].users];\n\t\t\t},\n\t\t\t/** @function sidebar/members/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].users.size;\n\t\t\t},\n\t\t\t/** @function sidebar/members/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/members/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/members/getInited */\n\t\t\tgetInited: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].inited;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/members/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, users, hasNextPage, lastId } = payload;\n\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', { chatId, inited: true });\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', { chatId, users });\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/members/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, userId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { userId, chatId });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) => {\n\t\t\t\tconst { chatId, users } = payload;\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tusers.forEach((id: number) => {\n\t\t\t\t\tstate.collection[chatId].users.add(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tsetInited: (state, payload) => {\n\t\t\t\tconst { chatId, inited } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].inited = inited;\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst { chatId, userId } = payload;\n\t\t\t\tstate.collection[chatId].users.delete(userId);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MessageSearchState = {\n\thistoryLimitExceededCollection: {[chatId: number]: boolean},\n};\n\n/* eslint-disable no-param-reassign */\nexport class MessageSearchModel extends BuilderModel\n{\n\tgetState(): MessageSearchState\n\t{\n\t\treturn {\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/messageSearch/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/messageSearch/setHistoryLimitExceeded */\n\t\t\tsetHistoryLimitExceeded: (store, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarTaskFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'task',\n\t\ttargetFieldName: 'task',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, taskFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const taskFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'creatorId',\n\t\ttargetFieldName: 'creatorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'responsibleId',\n\t\ttargetFieldName: 'responsibleId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'statusTitle',\n\t\ttargetFieldName: 'statusTitle',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'deadline',\n\t\ttargetFieldName: 'deadline',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'state',\n\t\ttargetFieldName: 'state',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'source',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { sidebarTaskFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarTaskItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype TasksState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarTaskItem>,\n\tlastId: number\n}\n\ntype TasksPayload = {\n\tchatId?: number,\n\ttasks?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/tasks/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/tasks/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, tasks, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach((task) => {\n\t\t\t\t\tconst preparedTask = { ...this.getElementState(), ...this.formatFields(task) };\n\t\t\t\t\tstore.commit('add', { chatId, task: preparedTask });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/setSearch */\n\t\t\tsetSearch: (store, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, tasks, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach((task) => {\n\t\t\t\t\tconst preparedTask = { ...this.getElementState(), ...this.formatFields(task) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, task: preparedTask });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id, chatId });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst { chatId, task } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(task.id, task);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst { chatId, task } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst { id, chatId } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarTaskFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarMeetingFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'calendar',\n\t\ttargetFieldName: 'meeting',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, meetingFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const meetingFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'dateFrom',\n\t\ttargetFieldName: 'dateFrom',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'dateTo',\n\t\ttargetFieldName: 'dateTo',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'source',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarMeetingFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarMeetingItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MeetingsState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarMeetingItem>,\n\tlastId: number\n}\n\ntype MeetingsPayload = {\n\tchatId?: number,\n\tmeetings?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/meetings/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/meetings/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, meetings, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach((meeting) => {\n\t\t\t\t\tconst preparedMeeting = { ...this.getElementState(), ...this.formatFields(meeting) };\n\t\t\t\t\tstore.commit('add', { chatId, meeting: preparedMeeting });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/setSearch */\n\t\t\tsetSearch: (store, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, meetings, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach((meeting) => {\n\t\t\t\t\tconst preparedMeeting = { ...this.getElementState(), ...this.formatFields(meeting) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, meeting: preparedMeeting });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id, chatId });\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst { chatId, meeting } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(meeting.id, meeting);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst { chatId, meeting } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst { id, chatId } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarMeetingFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarFilesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: ['dateCreate', 'date'],\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: ['fileId', 'id'],\n\t\ttargetFieldName: 'fileId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { SidebarFileTypes } from 'im.v2.const';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarFilesFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarFileItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[string]: ChatState\n\t\t}\n\t},\n};\n\ntype ChatState = {\n\titems: Map<number, ImModelSidebarFileItem>,\n\thasNextPage: boolean,\n\tlastId: number,\n};\n\ntype FilesPayload = {\n\tchatId?: number,\n\tfiles?: Object[],\n\tsubType?: string,\n\thasNextPage?: boolean,\n}\n\n/* eslint-disable no-param-reassign */\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/files/get */\n\t\t\tget: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][subType].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number, subType: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId][subType].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLatest */\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet documents = [];\n\t\t\t\tlet other = [];\n\t\t\t\tlet briefs = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileTypes.media].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileTypes.audio].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.document])\n\t\t\t\t{\n\t\t\t\t\tdocuments = [...state.collection[chatId][SidebarFileTypes.document].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.brief])\n\t\t\t\t{\n\t\t\t\t\tbriefs = [...state.collection[chatId][SidebarFileTypes.brief].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.other])\n\t\t\t\t{\n\t\t\t\t\tother = [...state.collection[chatId][SidebarFileTypes.other].items.values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, documents, briefs, other]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLatestUnsorted */\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileTypes.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileTypes.fileUnsorted].items.values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSize */\n\t\t\tgetSize: (state) => (chatId: number, subType: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/files/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number, subType: string): boolean => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/files/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number, subType: string): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId][subType].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number, subType: string): boolean => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][subType].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number, subType: string): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId][subType].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/files/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/files/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, files, subType } = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach((file) => {\n\t\t\t\t\tconst preparedFile = { ...this.getElementState(), ...this.formatFields(file) };\n\t\t\t\t\tstore.commit('add', { chatId, subType, file: preparedFile });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/files/setSearch */\n\t\t\tsetSearch: (store, payload: FilesPayload) => {\n\t\t\t\tconst { chatId, files, subType } = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach((file) => {\n\t\t\t\t\tconst preparedFile = { ...this.getElementState(), ...this.formatFields(file) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, subType, file: preparedFile });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/files/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHasNextPage */\n\t\t\tsetHasNextPage: (store, payload) => {\n\t\t\t\tconst { chatId, subType, hasNextPage } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPage', { chatId, subType, hasNextPage });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHasNextPageSearch */\n\t\t\tsetHasNextPageSearch: (store, payload: FilesPayload) => {\n\t\t\t\tconst { chatId, subType, hasNextPage } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, subType, hasNextPage });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setLastId */\n\t\t\tsetLastId: (store, payload) => {\n\t\t\t\tconst { chatId, subType, lastId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastId', { chatId, subType, lastId });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setLastIdSearch */\n\t\t\tsetLastIdSearch: (store, payload) => {\n\t\t\t\tconst { chatId, subType, lastId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastIdSearch', { chatId, subType, lastId });\n\t\t\t},\n\t\t\t/** @function sidebar/files/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHistoryLimitExceeded */\n\t\t\tsetHistoryLimitExceeded: (store, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst { chatId, file, subType } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][subType].items.set(file.id, file);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, subType: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst { chatId, file, subType } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tif (!state.collectionSearch[chatId][subType])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\t\t\t\tstate.collectionSearch[chatId][subType].items.set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tObject.values(SidebarFileTypes).forEach((subType) => {\n\t\t\t\t\tif (state.collection[chatId][subType] && state.collection[chatId][subType].items.has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][subType].items.delete(id);\n\t\t\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collectionSearch[chatId][subType].items.delete(id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, subType, hasNextPage } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId][subType]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId][subType].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload) => {\n\t\t\t\tconst { chatId, subType, hasNextPage } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId][subType]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId][subType].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, subType, lastId } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId][subType]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId][subType].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload) => {\n\t\t\t\tconst { chatId, subType, lastId } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId][subType]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][subType] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId][subType].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarFilesFieldsConfig);\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarMultidialogFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: Type.String,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'openSessionsLimit',\n\t\ttargetFieldName: 'openSessionsLimit',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'dateMessage',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { MultidialogStatus } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarMultidialogFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelSidebarMultidialogItem } from '../../../registry';\n\ntype MultidialogModelState = {\n\tisInited: boolean,\n\tisInitedDetail: boolean,\n\tchatsCount: number,\n\tunreadChats: Set<number>,\n\topenSessionsLimit: number,\n\tmultidialogs: Record<string, ImModelSidebarMultidialogItem>\n}\ntype StatusType = $Values<typeof MultidialogStatus>\n\n/* eslint-disable no-param-reassign */\nexport class MultidialogModel extends BuilderModel\n{\n\tgetState(): MultidialogModelState\n\t{\n\t\treturn {\n\t\t\tisInited: false,\n\t\t\tisInitedDetail: false,\n\t\t\tchatsCount: 0,\n\t\t\tunreadChats: new Set(),\n\t\t\topenSessionsLimit: 0,\n\t\t\tmultidialogs: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMultidialogItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '',\n\t\t\tchatId: 0,\n\t\t\tstatus: '',\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/isInited */\n\t\t\tisInited: ({ isInited }): boolean => {\n\t\t\t\treturn isInited;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/isInitedDetail */\n\t\t\tisInitedDetail: ({ isInitedDetail }): boolean => {\n\t\t\t\treturn isInitedDetail;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getOpenSessionsLimit */\n\t\t\tgetOpenSessionsLimit: ({ openSessionsLimit }): number => {\n\t\t\t\treturn openSessionsLimit;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getChatsCount */\n\t\t\tgetChatsCount: ({ chatsCount }): number => {\n\t\t\t\treturn chatsCount;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: ({ unreadChats }): number => {\n\t\t\t\tlet count = 0;\n\t\t\t\tunreadChats.forEach((chatId: number) => {\n\t\t\t\t\tcount += Core.getStore().getters['counters/getChatCounterByChatId'](chatId);\n\t\t\t\t});\n\n\t\t\t\treturn count;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/get */\n\t\t\tget: ({ multidialogs }) => (chatId): ImModelSidebarMultidialogItem => {\n\t\t\t\treturn multidialogs[chatId];\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/isSupport */\n\t\t\tisSupport: () => (dialogId): boolean => {\n\t\t\t\tconst isSupportBot = Core.getStore().getters['users/bots/isSupport'](dialogId);\n\t\t\t\tconst isSupportChat = Core.getStore().getters['chats/isSupport'](dialogId);\n\n\t\t\t\treturn isSupportChat || isSupportBot;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/hasNextPage */\n\t\t\thasNextPage: ({ chatsCount, multidialogs }): boolean => {\n\t\t\t\treturn chatsCount > Object.keys(multidialogs).length;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getNumberMultidialogs */\n\t\t\tgetNumberMultidialogs: ({ multidialogs }): number => {\n\t\t\t\treturn Object.keys(multidialogs).length;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getMultidialogsByStatus */\n\t\t\tgetMultidialogsByStatus: ({ multidialogs }) => (status: StatusType[]): ImModelSidebarMultidialogItem[] => {\n\t\t\t\treturn Object.values(multidialogs)\n\t\t\t\t\t.filter((multidialog: ImModelSidebarMultidialogItem) => status.includes(multidialog.status));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/setInited */\n\t\t\tsetInited: (store, isInited: boolean) => {\n\t\t\t\tstore.commit('setInited', isInited);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setInitedDetail */\n\t\t\tsetInitedDetail: (store, isInitedDetail: boolean) => {\n\t\t\t\tstore.commit('setInitedDetail', isInitedDetail);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/addMultidialogs */\n\t\t\taddMultidialogs: (store, multidialogs: ImModelSidebarMultidialogItem[]) => {\n\t\t\t\tif (!Type.isArray(multidialogs))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmultidialogs.forEach((multidialog) => {\n\t\t\t\t\tconst preparedTicket = { ...this.getElementState(), ...this.formatFields(multidialog) };\n\t\t\t\t\tstore.commit('addMultidialog', preparedTicket);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setOpenSessionsLimit */\n\t\t\tsetOpenSessionsLimit: (store, openSessionsLimit: number) => {\n\t\t\t\tif (Type.isNumber(openSessionsLimit))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setOpenSessionsLimit', openSessionsLimit);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setChatsCount */\n\t\t\tsetChatsCount: (store, chatsCount: number) => {\n\t\t\t\tif (Type.isNumber(chatsCount))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setChatsCount', chatsCount);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setUnreadChats */\n\t\t\tsetUnreadChats: (store, unreadChats: number[]) => {\n\t\t\t\tif (Type.isArray(unreadChats))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setUnreadChats', unreadChats);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { unreadChats, multidialogs, chatsCount, openSessionsLimit } = payload;\n\n\t\t\t\tstore.dispatch('setUnreadChats', unreadChats);\n\t\t\t\tstore.dispatch('setChatsCount', chatsCount);\n\t\t\t\tstore.dispatch('setOpenSessionsLimit', openSessionsLimit);\n\t\t\t\tstore.dispatch('addMultidialogs', multidialogs);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/deleteUnreadChats */\n\t\t\tdeleteUnreadChats: (store, chatId: number) => {\n\t\t\t\tstore.commit('deleteUnreadChats', chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/setInited */\n\t\t\tsetInited: (state, isInited) => {\n\t\t\t\tstate.isInited = isInited;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setInitedDetail */\n\t\t\tsetInitedDetail: (state, isInitedDetail) => {\n\t\t\t\tstate.isInitedDetail = isInitedDetail;\n\t\t\t},\n\t\t\taddMultidialog: (state, multidialog: ImModelSidebarMultidialogItem) => {\n\t\t\t\tstate.multidialogs[multidialog.chatId] = multidialog;\n\t\t\t},\n\t\t\tsetChatsCount: (state, chatsCount) => {\n\t\t\t\tstate.chatsCount = chatsCount;\n\t\t\t},\n\t\t\tsetOpenSessionsLimit: (state, openSessionsLimit) => {\n\t\t\t\tstate.openSessionsLimit = openSessionsLimit;\n\t\t\t},\n\t\t\tsetUnreadChats: (state, unreadChats) => {\n\t\t\t\tunreadChats.forEach((chatId) => {\n\t\t\t\t\tstate.unreadChats.add(chatId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteUnreadChats: ({ unreadChats }, chatId) => {\n\t\t\t\tunreadChats.delete(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarMultidialogFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { LinksModel } from './nested-modules/links/links';\nimport { FavoritesModel } from './nested-modules/favorites/favorites';\nimport { MembersModel } from './nested-modules/members';\nimport { MessageSearchModel } from './nested-modules/message-search/message-search';\nimport { TasksModel } from './nested-modules/tasks/tasks';\nimport { MeetingsModel } from './nested-modules/meeting/meeting';\nimport { FilesModel } from './nested-modules/files/files';\nimport { MultidialogModel } from './nested-modules/multidialog/multidialog';\n\nimport type { GetterTree, ActionTree, MutationTree, NestedModuleTree } from 'ui.vue3.vuex';\n\ntype SidebarState = {\n\tinitedList: Set<number>,\n\tisFilesMigrated: boolean,\n\tisLinksMigrated: boolean,\n};\n\n/* eslint-disable no-param-reassign */\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): NestedModuleTree\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t\tmultidialog: MultidialogModel,\n\t\t\tmessageSearch: MessageSearchModel,\n\t\t};\n\t}\n\n\tgetState(): SidebarState\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/isInited */\n\t\t\tisInited: (state: SidebarState) => (chatId: number): boolean => {\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t\t/** @function sidebar/hasHistoryLimit */\n\t\t\thasHistoryLimit: () => (chatId: number): boolean => {\n\t\t\t\tconst limitsByPanel = [\n\t\t\t\t\t'sidebar/links/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/files/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/favorites/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/meetings/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/tasks/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/messageSearch/isHistoryLimitExceeded',\n\t\t\t\t].map((getterName) => Core.getStore().getters[getterName](chatId));\n\n\t\t\t\treturn limitsByPanel.some((hasLimit) => hasLimit);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/setInited */\n\t\t\tsetInited: (store, chatId: number) => {\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\t/** @function sidebar/setFilesMigrated */\n\t\t\tsetFilesMigrated: (store, value: boolean) => {\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\t/** @function sidebar/setLinksMigrated */\n\t\t\tsetLinksMigrated: (store, value: boolean) => {\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetInited: (state: SidebarState, chatId: number) => {\n\t\t\t\tstate.initedList.add(chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state: SidebarState, payload: boolean) => {\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state: SidebarState, payload: boolean) => {\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from '../type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype CountersState = {\n\tunloadedChatCounters: {[chatId: string]: number},\n\tunloadedLinesCounters: {[chatId: string]: number},\n\tunloadedCopilotCounters: {[chatId: string]: number},\n\tcommentCounters: CommentsCounters,\n};\n\ntype CommentsCounters = {\n\t[channelChatId: string]: {\n\t\t[commentChatId: string]: number,\n\t},\n}\n\ntype CommentsCounterPayload = {\n\tchannelId: number,\n\tcommentChatId: number\n};\n\nexport class CountersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'counters';\n\t}\n\n\tgetState(): CountersState\n\t{\n\t\treturn {\n\t\t\tunloadedChatCounters: {},\n\t\t\tunloadedLinesCounters: {},\n\t\t\tunloadedCopilotCounters: {},\n\t\t\tcommentCounters: {},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/getUnloadedChatCounters */\n\t\t\tgetUnloadedChatCounters: (state: CountersState): number => {\n\t\t\t\treturn state.unloadedChatCounters;\n\t\t\t},\n\t\t\t/** @function counters/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: (state: CountersState): number => {\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getRecentCollection'];\n\t\t\t\trecentCollection.forEach((recentItem: ImModelRecentItem) => {\n\t\t\t\t\tconst recentItemCounter = this.#getRecentItemCounter(recentItem);\n\t\t\t\t\tloadedChatsCounter += recentItemCounter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\tconst channelCommentsCounter = Core.getStore().getters['counters/getTotalCommentsCounter'];\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter + channelCommentsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalCopilotCounter */\n\t\t\tgetTotalCopilotCounter: (state: CountersState): number => {\n\t\t\t\tlet loadedChatsCounter = 0;\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getCopilotCollection'];\n\t\t\t\trecentCollection.forEach((recentItem: ImModelRecentItem) => {\n\t\t\t\t\tconst chat = this.#getChat(recentItem.dialogId);\n\t\t\t\t\tif (this.#isChatMuted(chat))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tloadedChatsCounter += chat.counter;\n\t\t\t\t});\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedCopilotCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalLinesCounter */\n\t\t\tgetTotalLinesCounter: (state: CountersState): number => {\n\t\t\t\tlet unloadedLinesCounter = 0;\n\t\t\t\tObject.values(state.unloadedLinesCounters).forEach((counter) => {\n\t\t\t\t\tunloadedLinesCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn unloadedLinesCounter;\n\t\t\t},\n\t\t\t/** @function counters/getSpecificLinesCounter */\n\t\t\tgetSpecificLinesCounter: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tif (!state.unloadedLinesCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.unloadedLinesCounters[chatId];\n\t\t\t},\n\t\t\t/** @function counters/getTotalCommentsCounter */\n\t\t\tgetTotalCommentsCounter: (state: CountersState): number => {\n\t\t\t\tlet totalCounter = 0;\n\t\t\t\tObject.entries(state.commentCounters).forEach(([channelChatId, channelCounters]) => {\n\t\t\t\t\tconst channel = this.#getChatByChatId(channelChatId);\n\t\t\t\t\tif (this.#isChatMuted(channel))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tObject.values(channelCounters).forEach((commentCounter) => {\n\t\t\t\t\t\ttotalCounter += commentCounter;\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn totalCounter;\n\t\t\t},\n\t\t\t/** @function counters/getChannelComments */\n\t\t\tgetChannelComments: (state: CountersState) => (chatId: number): number[] => {\n\t\t\t\tif (!state.commentCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.commentCounters[chatId];\n\t\t\t},\n\t\t\t/** @function counters/getChannelCommentsCounter */\n\t\t\tgetChannelCommentsCounter: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tif (!state.commentCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tlet result = 0;\n\t\t\t\tObject.values(state.commentCounters[chatId]).forEach((counter) => {\n\t\t\t\t\tresult += counter;\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function counters/getChatCounterByChatId */\n\t\t\tgetChatCounterByChatId: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tconst recentCollection: ImModelRecentItem[] = Core.getStore().getters['recent/getRecentCollection'];\n\t\t\t\tconst recentItem = recentCollection.find((element) => {\n\t\t\t\t\tconst chat: ImModelChat = this.store.getters['chats/get'](element.dialogId, true);\n\n\t\t\t\t\treturn chat.chatId === chatId;\n\t\t\t\t});\n\n\t\t\t\tif (!recentItem)\n\t\t\t\t{\n\t\t\t\t\treturn state.unloadedChatCounters[chatId] ?? 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#getRecentItemCounter(recentItem);\n\t\t\t},\n\t\t\t/** @function counters/getSpecificCommentsCounter */\n\t\t\tgetSpecificCommentsCounter: (state: CountersState) => (payload: CommentsCounterPayload): number => {\n\t\t\t\tconst { channelId, commentChatId } = payload;\n\t\t\t\tif (!state.commentCounters[channelId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.commentCounters[channelId][commentChatId] ?? 0;\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/setUnloadedChatCounters */\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedLinesCounters */\n\t\t\tsetUnloadedLinesCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedLinesCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedCopilotCounters */\n\t\t\tsetUnloadedCopilotCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedCopilotCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setCommentCounters */\n\t\t\tsetCommentCounters: (store, payload: CommentsCounters) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCommentCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/readAllChannelComments */\n\t\t\treadAllChannelComments: (store, channelChatId: number) => {\n\t\t\t\tif (!Type.isNumber(channelChatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('readAllChannelComments', channelChatId);\n\t\t\t},\n\t\t\t/** @function counters/delete */\n\t\t\tdelete: (store, payload: {channelChatId: number, commentChatId: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetUnloadedChatCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedLinesCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedLinesCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedLinesCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedCopilotCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedCopilotCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedCopilotCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCommentCounters: (state: CountersState, payload: CommentsCounters) => {\n\t\t\t\tObject.entries(payload).forEach(([channelChatId, countersMap]) => {\n\t\t\t\t\tif (!state.commentCounters[channelChatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.commentCounters[channelChatId] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tconst channelMap = state.commentCounters[channelChatId];\n\t\t\t\t\tObject.entries(countersMap).forEach(([commentChatId, counter]) => {\n\t\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdelete channelMap[commentChatId];\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tchannelMap[commentChatId] = counter;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAllChannelComments: (state: CountersState, channelChatId: number) => {\n\t\t\t\tdelete state.commentCounters[channelChatId];\n\t\t\t},\n\t\t\tdelete: (state: CountersState, payload: {channelChatId: number, commentChatId: number}) => {\n\t\t\t\tconst { channelChatId, commentChatId } = payload;\n\t\t\t\tif (!state.commentCounters[channelChatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdelete state.commentCounters[channelChatId][commentChatId];\n\t\t\t},\n\t\t};\n\t}\n\n\t#getChat(dialogId): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/get'](dialogId, true);\n\t}\n\n\t#getChatByChatId(chatId): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/getByChatId'](chatId, true);\n\t}\n\n\t#isChatMuted(chat: ImModelChat): boolean\n\t{\n\t\treturn chat.muteList.includes(Core.getUserId());\n\t}\n\n\t#getRecentItemCounter(recentItem: ImModelRecentItem): number\n\t{\n\t\tconst chat = this.#getChat(recentItem.dialogId);\n\t\tif (this.#isChatMuted(chat))\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\tconst isMarked = recentItem.unread;\n\t\tif (chat.counter === 0 && isMarked)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\treturn chat.counter;\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { formatFieldsWithConfig, type FieldsConfig } from '../../utils/validate';\n\nexport const copilotFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'recommendedRoles',\n\t\ttargetFieldName: 'recommendedRoles',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'roles',\n\t\ttargetFieldName: 'roles',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn Object.values(target).map((role) => {\n\t\t\t\treturn formatFieldsWithConfig(role, rolesFieldsConfig);\n\t\t\t});\n\t\t},\n\t},\n];\n\n\n\n\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const chatFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'role',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { chatFieldsConfig } from './field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { CopilotRole } from '../../../type/copilot';\n\ntype ChatsState = {\n\tcollection: {[dialogId: string]: CopilotChat},\n}\n\ntype CopilotChat = {\n\tdialogId: string,\n\trole: string,\n}\n\n/* eslint-disable no-param-reassign */\nexport class ChatsModel extends BuilderModel\n{\n\tgetState(): ChatsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): CopilotChat\n\t{\n\t\treturn {\n\t\t\tdialogId: '',\n\t\t\trole: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/chats/getRole */\n\t\t\tgetRole: (state) => (dialogId: number): ?CopilotRole => {\n\t\t\t\tconst chat = state.collection[dialogId];\n\t\t\t\tif (!chat)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](chat.role);\n\t\t\t},\n\t\t\t/** @function copilot/chats/getRoleAvatar */\n\t\t\tgetRoleAvatar: (state, getters) => (dialogId: number): string => {\n\t\t\t\tconst role = getters.getRole(dialogId);\n\t\t\t\tif (!role)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getAvatar'](role.code);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/chats/add */\n\t\t\tadd: (store, payload) => {\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatsToAdd = Type.isArrayFilled(payload) ? payload : [payload];\n\n\t\t\t\tchatsToAdd.forEach((chat) => {\n\t\t\t\t\tconst preparedChat = { ...this.getElementState(), ...this.formatFields(chat) };\n\t\t\t\t\tstore.commit('add', preparedChat);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\tconst { dialogId } = payload;\n\t\t\t\tstate.collection[dialogId] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, chatFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const messagesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'roleCode',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Core } from 'im.v2.application.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { messagesFieldsConfig } from './field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { CopilotPrompt, CopilotRole, CopilotRoleCode } from '../../../type/copilot';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MessagesState = {\n\tcollection: { [key: number]: CopilotRoleCode }\n}\n\ntype CopilotMessage = {\n\trole: string\n}\n\n/* eslint-disable no-param-reassign */\nexport class MessagesModel extends BuilderModel\n{\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): CopilotMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\troleCode: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/messages/getRole */\n\t\t\tgetRole: (state) => (messageId: number): ?CopilotRole => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn Core.getStore().getters['copilot/roles/getDefault'];\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](message.roleCode);\n\t\t\t},\n\t\t\t/** @function copilot/messages/getPrompts */\n\t\t\tgetPrompts: (state) => (messageId: number): CopilotPrompt[] => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getPrompts'](message.roleCode);\n\t\t\t},\n\t\t\tgetAvatar: (state, getters) => (messageId: number): string => {\n\t\t\t\tconst role = getters.getRole(messageId);\n\t\t\t\tif (!role)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getAvatar'](role.code);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/messages/add */\n\t\t\tadd: (store, payload) => {\n\t\t\t\tif (!Type.isArrayFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpayload.forEach((message) => {\n\t\t\t\t\tconst preparedMessage = {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t...this.formatFields(message),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', preparedMessage);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\tstate.collection[payload.id] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, messagesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const rolesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, avatarFieldsConfig);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: ['desc', 'description'],\n\t\ttargetFieldName: 'desc',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'default',\n\t\ttargetFieldName: 'default',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'prompts',\n\t\ttargetFieldName: 'prompts',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: (target) => {\n\t\t\treturn target.map((prompt) => {\n\t\t\t\treturn formatFieldsWithConfig(prompt, promptsFieldsConfig);\n\t\t\t});\n\t\t},\n\t},\n];\n\nconst promptsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'promptType',\n\t\ttargetFieldName: 'promptType',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'text',\n\t\ttargetFieldName: 'text',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n\nconst avatarFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'small',\n\t\ttargetFieldName: 'small',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'medium',\n\t\ttargetFieldName: 'medium',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'large',\n\t\ttargetFieldName: 'large',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { rolesFieldsConfig } from './field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { CopilotPrompt, CopilotRole, CopilotRoleCode, AvatarSize } from '../../../type/copilot';\n\ntype RolesState = {\n\troles: {[CopilotRoleCode]: CopilotRole}\n}\nexport const AvatarSizes: {[AvatarSize]: string} = Object.freeze({\n\tS: 'small',\n\tM: 'medium',\n\tL: 'large',\n});\n\n/* eslint-disable no-param-reassign */\nexport class RolesModel extends BuilderModel\n{\n\tgetState(): RolesState\n\t{\n\t\treturn {\n\t\t\troles: {},\n\t\t};\n\t}\n\n\tgetElementState(): CopilotRole\n\t{\n\t\treturn {\n\t\t\tcode: '',\n\t\t\tname: '',\n\t\t\tdesc: '',\n\t\t\tdefault: false,\n\t\t\tavatar: {\n\t\t\t\tsmall: '',\n\t\t\t\tmedium: '',\n\t\t\t\tlarge: '',\n\t\t\t},\n\t\t\tprompts: [],\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/roles/get */\n\t\t\tget: (state) => (): CopilotRole[] => {\n\t\t\t\treturn Object.values(state.roles);\n\t\t\t},\n\t\t\t/** @function copilot/roles/getByCode */\n\t\t\tgetByCode: (state, getters) => (code: string): CopilotRole[] => {\n\t\t\t\treturn state.roles[code] ?? getters.getDefault;\n\t\t\t},\n\t\t\t/** @function copilot/roles/getPrompts */\n\t\t\tgetPrompts: (state, getters) => (roleCode: string): CopilotPrompt[] => {\n\t\t\t\tif (!state.roles[roleCode])\n\t\t\t\t{\n\t\t\t\t\treturn getters.getDefault?.prompts ?? [];\n\t\t\t\t}\n\n\t\t\t\treturn state.roles[roleCode].prompts;\n\t\t\t},\n\t\t\t/** @function copilot/roles/getDefault */\n\t\t\tgetDefault: (state): CopilotRole => {\n\t\t\t\treturn Object.values(state.roles).find((role: CopilotRole) => role.default);\n\t\t\t},\n\t\t\t/** @function copilot/roles/getAvatar */\n\t\t\tgetAvatar: (state, getters) => (roleCode: string, size: AvatarSize = 'M'): string => {\n\t\t\t\tif (!state.roles[roleCode])\n\t\t\t\t{\n\t\t\t\t\treturn getters.getDefault?.prompts ?? [];\n\t\t\t\t}\n\n\t\t\t\treturn state.roles[roleCode].avatar[AvatarSizes[size]];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/roles/add */\n\t\t\tadd: (store, payload) => {\n\t\t\t\tconst roles = Object.values(payload);\n\t\t\t\tif (!Type.isArrayFilled(roles))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\troles.forEach((role) => {\n\t\t\t\t\tconst preparedRole = { ...this.getElementState(), ...this.formatFields(role) };\n\t\t\t\t\tstore.commit('add', preparedRole);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\tstate.roles[payload.code] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, rolesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { copilotFieldsConfig } from './format/field-config';\nimport { ChatsModel } from './nested-modules/chats/chats';\nimport { MessagesModel } from './nested-modules/messages/messages';\nimport { RolesModel } from './nested-modules/roles/roles';\n\nimport type { JsonObject } from 'main.core';\nimport type { CopilotRole } from '../type/copilot';\nimport type { GetterTree, ActionTree, MutationTree, NestedModuleTree } from 'ui.vue3.vuex';\n\ntype CopilotModelState = {\n\trecommendedRoles: string[],\n\taiProvider: string,\n};\n\nconst RECOMMENDED_ROLES_LIMIT = 4;\n\n/* eslint-disable no-param-reassign */\nexport class CopilotModel extends BuilderModel\n{\n\tgetNestedModules(): NestedModuleTree\n\t{\n\t\treturn {\n\t\t\troles: RolesModel,\n\t\t\tmessages: MessagesModel,\n\t\t\tchats: ChatsModel,\n\t\t};\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn 'copilot';\n\t}\n\n\tgetState(): CopilotModelState\n\t{\n\t\treturn {\n\t\t\trecommendedRoles: [],\n\t\t\taiProvider: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/getProvider */\n\t\t\tgetProvider: (state): string => {\n\t\t\t\treturn state.aiProvider;\n\t\t\t},\n\t\t\t/** @function copilot/getRecommendedRoles */\n\t\t\tgetRecommendedRoles: (state) => (): CopilotRole[] => {\n\t\t\t\tconst roles = state.recommendedRoles.map((roleCode) => {\n\t\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](roleCode);\n\t\t\t\t});\n\n\t\t\t\treturn roles.slice(0, RECOMMENDED_ROLES_LIMIT);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/setRecommendedRoles */\n\t\t\tsetRecommendedRoles: (store, payload) => {\n\t\t\t\tif (!Type.isArrayFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setRecommendedRoles', payload);\n\t\t\t},\n\t\t\t/** @function copilot/setProvider */\n\t\t\tsetProvider: (store, payload) => {\n\t\t\t\tif (!Type.isStringFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setProvider', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecommendedRoles: (state, payload) => {\n\t\t\t\tstate.recommendedRoles = payload;\n\t\t\t},\n\t\t\tsetProvider: (state, payload) => {\n\t\t\t\tstate.aiProvider = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, copilotFieldsConfig);\n\t}\n}\n"],"names":["isNumberOrString","target","Type","isNumber","isString","convertToString","toString","convertToNumber","Number","parseInt","convertToDate","Utils","date","cast","SNAKE_CASE_REGEXP","convertObjectKeysToCamelCase","targetObject","resultObject","Object","entries","forEach","key","value","newKey","prepareKey","isPlainObject","isArray","convertArrayItemsKeysToCamelCase","rawKey","search","toLowerCase","Text","toCamelCase","targetArray","map","arrayItem","SortWeight","im","prepareNotificationSettings","result","sortedTarget","sortNotificationSettingsBlock","block","preparedItems","notices","item","id","label","items","sort","a","b","weightA","weightB","settingsFieldsConfig","fieldName","Settings","notification","enableSound","targetFieldName","checkFunction","isBoolean","enableAutoRead","mode","enableWeb","enableMail","enablePush","formatFunction","message","bigSmiles","appearance","background","alignment","recent","showBirthday","showInvited","showLastMessage","hotkey","sendByEnter","desktop","enableRedirect","user","status","formatFieldsWithConfig","fields","config","rawFields","fieldConfig","foundFieldName","getValidFieldName","isFieldValueValid","formatFieldValue","fieldValue","currentResult","fieldNameList","isStringFilled","singleField","isUndefined","field","checkFunctionList","isFunction","some","singleFunction","params","SettingsModel","BuilderModel","getState","DialogAlignment","left","NotificationSettingsMode","simple","notifications","getGetters","get","state","getActions","set","store","payload","commit","formatFields","setNotificationOption","getMutations","moduleId","optionName","type","moduleOptions","tariffRestrictionsFieldsConfig","TariffRestrictionsModel","fullChatHistory","isAvailable","limitDays","isHistoryAvailable","ApplicationModel","getName","getNestedModules","settings","tariffRestrictions","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","allowedLayouts","copilot","channel","includes","isLinesChatOpen","openlines","areNotificationsOpen","setLayout","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","updateLayout","prepareComponentId","componentId","supportedComponents","values","MessageComponent","unsupported","prepareAuthorId","system","isSystem","prepareKeyboard","rawKeyboardButtons","rawButton","disabled","vote","wait","messageFieldsConfig","text","isTempMessage","isDate","PinModel","collection","getPinned","chatId","pinnedMessageId","Core","getStore","getters","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","Reaction","freeze","like","kiss","laugh","wonder","cry","angry","facepalm","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","reaction","removeReaction","newItem","currentItem","newOwnReaction","userId","reactions","getUserId","removeAllCurrentUserReactions","currentCounter","users","counter","commentFieldsConfig","LAST_USERS_TO_SHOW","CommentsModel","opened","channelDialogId","postId","lastUserIds","messageCount","isUserSubscribed","getMessageIdByChatId","foundItem","find","element","areOpened","areOpenedForChannel","areOpenedForChannelPost","getOpenedChannelId","rawPayload","Array","setLastUser","newUserId","subscribe","dispatch","unsubscribe","setOpened","setClosed","currentUsers","unshift","pop","commentsPostId","authorId","MessagesModel","pin","comments","chatCollection","replyId","Date","files","attach","keyboard","unread","viewed","viewedByOthers","sending","error","default","componentParams","forward","isEdited","isDeleted","getByChatId","getById","getByIdList","idList","push","hasMessage","isForward","isInChatCollection","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","filter","getMessageFiles","fileId","getMessageType","currentUserId","MessageType","self","opponent","getPreviousMessage","initialMessageIndex","indexOf","desiredMessageId","setChatCollection","clearCollection","preparedMessages","currentMessage","updateWithId","update","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","clearChatCollection","deleteAttach","attachId","attachItem","isOwnMessage","messageParams","formattedFields","NAME","USER_ID","Boolean","authorName","AVATAR","avatar","originalAuthorId","fakeAuthorId","userManager","UserManager","networkId","UserIdNetworkPrefix","setUsersToModel","firstId","lastId","lastOwnMessageId","z","resultId","isUuidV4","getTime","prepareManagerList","managerList","rawUserId","prepareChatName","chatName","decode","prepareAvatar","endsWith","startsWith","getHost","encodeURI","prepareWritingList","writingList","userName","prepareMuteList","muteList","prepareLastMessageViews","rawLastMessageViews","countOfViewers","firstViewers","rawFirstViewers","firstViewer","rawFirstViewer","Error","chatFieldsConfig","chatEntityFieldsConfig","ChatsModel","ChatType","description","color","Color","base","extranet","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","savedPositionMessageId","quoteId","ownerId","entityLink","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","role","UserRole","guest","permissions","manageUi","none","manageSettings","manageUsersAdd","manageUsersDelete","manageMessages","isHistoryLimitExceeded","parentChatId","getBlank","preparedChatId","getQuoteId","isUser","getLastReadId","lastReadIdMessage","getInitialMessageId","Math","min","isSupport","support24Question","existingItem","clearCounters","mute","actionName","unmute","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","keys","BotsModel","BotType","bot","appId","isHidden","isSupportOpenline","isHuman","getByUserId","isNetwork","network","support24","getCopilotUserId","BotCode","isCopilot","copilotUserId","botData","RawBotType","human","TYPES_MAPPED_TO_DEFAULT_BOT","openline","supervisor","prepareDepartments","departments","rawDepartmentId","departmentId","preparePhones","phones","workPhone","personalMobile","personalPhone","innerPhone","userFieldsConfig","isNetworkUserId","UsersModel","bots","absentList","absentCheckInterval","firstName","lastName","workPosition","gender","isAdmin","connector","externalAuthId","idle","lastActivityDate","mobileLastDate","birthday","isBirthday","absent","isAbsent","getTemporary","getList","userList","hasBirthday","hasVacation","getLastOnline","getLastDateText","getPosition","isSupportBot","Loc","getMessage","existingUser","setStatus","UserStatusManager","getInstance","onUserUpdate","preparedFields","isBot","bot_data","addToAbsentList","startAbsentCheckInterval","TIME_TO_NEXT_DAY","setTimeout","setInterval","currentTime","now","absentEnd","getTimeToNextMidnight","FilesModel","extension","icon","size","image","FileStatus","done","progress","urlPreview","urlShow","urlDownload","viewerAttrs","isInCollection","preparedFile","validate","file","currentFile","getIconTypeByExtension","width","height","validateViewerAttributes","viewer","actions","objectId","src","title","viewerGroupBy","viewerType","viewerTypeClass","viewerSeparateItem","viewerExtension","imChatId","prepareDraft","draft","prepareInvitation","invited","isActive","originator","originatorId","canResend","recentFieldsConfig","CallsModel","call","RecentCallStatus","waiting","getCallByDialog","hasActiveCall","activeCall","joined","existingCall","addActiveCall","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentModel","calls","recentCollection","unreadCollection","copilotCollection","channelCollection","pinned","liked","invitation","isFakeElement","isBirthdayPlaceholder","getRecentCollection","dialog","getUnreadCollection","getCopilotCollection","getChannelCollection","getSortedCollection","recentCollectionAsArray","filteredCollection","messageA","messageB","needsBirthdayPlaceholder","hasTodayMessage","needsVacationPlaceholder","getSortDate","getStartOfTheDay","lastActivity","needToUseActivityDate","ChannelManager","isChannel","setRecent","itemIds","setUnread","setCopilot","setChannel","clearChannelCollection","itemsToUpdate","itemsToAdd","preparedElement","action","isLastMessage","isExactMessageLiked","setRecentDraft","collectionName","addMethodName","setCopilotDraft","setDraft","isRemovingDraft","existingCollectionItem","canDelete","clearUnread","setRecentCollection","deleteFromRecentCollection","setUnreadCollection","setCopilotCollection","deleteFromCopilotCollection","deleteFromChannelCollection","setChannelCollection","elementIsInRecent","currentElement","options","updateMethod","zeroedCountersForNewItems","chat_id","isToday","NOT_DELETABLE_TYPES","openChannel","FakeDraftMessagePrefix","NotificationsModel","Map","searchCollection","unreadCounter","replaces","notifyButtons","sectionCode","NotificationTypesCodes","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getCounter","initialSet","total_unread_count","isArrayFilled","setSearchResult","skipValidation","readAll","deleteFromSearch","clearSearchResult","setCounter","addSearchResult","updateSearchResult","decreaseCounter","increaseCounter","clear","author_id","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","sidebarLinksFieldsConfig","source","richData","richDataFieldsConfig","LinksModel","collectionSearch","counters","historyLimitExceededCollection","previewUrl","getChatState","getSize","hasNextPageSearch","getSearchResultCollectionSize","links","preparedLink","setSearch","clearSearch","setHasNextPage","hasCollection","setHasNextPageSearch","setHistoryLimitExceeded","addSearch","hasCollectionSearch","sidebarFavoritesFieldsConfig","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","getSearchResultCollectionLastId","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","setLastId","setLastIdSearch","MembersModel","getInited","setInited","MessageSearchModel","sidebarTaskFieldsConfig","taskFieldsConfig","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","tasks","preparedTask","sidebarMeetingFieldsConfig","meetingFieldsConfig","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","sidebarFilesFieldsConfig","subType","getLatest","rootState","rootGetters","media","audio","documents","other","briefs","SidebarFileTypes","document","brief","sortedFlatCollection","flat","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","sidebarMultidialogFieldsConfig","String","MultidialogModel","isInited","isInitedDetail","chatsCount","unreadChats","openSessionsLimit","multidialogs","getOpenSessionsLimit","getChatsCount","getTotalChatCounter","count","isSupportChat","getNumberMultidialogs","getMultidialogsByStatus","multidialog","setInitedDetail","addMultidialogs","preparedTicket","setOpenSessionsLimit","setChatsCount","setUnreadChats","deleteUnreadChats","addMultidialog","SidebarModel","members","messageSearch","initedList","isFilesMigrated","isLinksMigrated","hasHistoryLimit","limitsByPanel","getterName","hasLimit","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","context","iconName","placement","order","loadConfiguration","ID","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","setPlacementCollection","setCollection","app","configuration","CountersModel","unloadedChatCounters","unloadedLinesCounters","unloadedCopilotCounters","commentCounters","getUnloadedChatCounters","loadedChatsCounter","recentItem","recentItemCounter","unloadedChatsCounter","channelCommentsCounter","getTotalCopilotCounter","getTotalLinesCounter","unloadedLinesCounter","getSpecificLinesCounter","getTotalCommentsCounter","totalCounter","channelChatId","channelCounters","commentCounter","getChannelComments","getChannelCommentsCounter","getChatCounterByChatId","getSpecificCommentsCounter","channelId","commentChatId","setUnloadedChatCounters","setUnloadedLinesCounters","setUnloadedCopilotCounters","setCommentCounters","readAllChannelComments","countersMap","channelMap","isMarked","copilotFieldsConfig","rolesFieldsConfig","getRole","getRoleAvatar","chatsToAdd","preparedChat","messagesFieldsConfig","roleCode","getPrompts","getAvatar","preparedMessage","avatarFieldsConfig","prompt","promptsFieldsConfig","AvatarSizes","S","M","L","RolesModel","roles","desc","small","medium","large","prompts","getByCode","getDefault","preparedRole","RECOMMENDED_ROLES_LIMIT","CopilotModel","chats","recommendedRoles","aiProvider","getProvider","getRecommendedRoles","setRecommendedRoles","setProvider"],"mappings":"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"}