{"version":3,"file":"sliderloader.bundle.js","sources":["../src/sliderloader.js"],"sourcesContent":["\"use strict\";\nimport { Loc, Runtime, Type, Uri } from \"main.core\";\n\nexport class SliderLoader\n{\n\tconstructor(entryId, options = {})\n\t{\n\t\tthis.extensionName = (\n\t\t\t(\n\t\t\t\tType.isString(entryId)\n\t\t\t\t&& (\n\t\t\t\t\tentryId === 'NEW'\n\t\t\t\t\t|| entryId.substring(0, 4) === 'EDIT'\n\t\t\t\t)\n\t\t\t)\n\t\t\t|| !parseInt(entryId)\n\t\t)\n\t\t\t? 'EventEditForm'\n\t\t\t: 'EventViewForm';\n\n\t\tthis.sliderId = options.sliderId || \"calendar:slider-\" + Math.random();\n\n\t\tentryId = (Type.isString(entryId) && entryId.substring(0, 4) === 'EDIT')\n\t\t\t? parseInt(entryId.substring(4))\n\t\t\t: parseInt(entryId);\n\n\t\tthis.extensionParams = {\n\t\t\tentryId: entryId,\n\t\t\tentry: options.entry || null,\n\t\t\ttype: options.type || null,\n\t\t\townerId: parseInt(options.ownerId) || null,\n\t\t\tuserId: parseInt(options.userId) || null,\n\t\t};\n\n\t\tif (Type.isArray(options.participantsEntityList))\n\t\t{\n\t\t\tthis.extensionParams.participantsEntityList = options.participantsEntityList;\n\t\t}\n\n\t\tif (Type.isArray(options.participantsSelectorEntityList))\n\t\t{\n\t\t\tthis.extensionParams.participantsSelectorEntityList = options.participantsSelectorEntityList;\n\t\t}\n\n\t\tif (options.formDataValue)\n\t\t{\n\t\t\tthis.extensionParams.formDataValue = options.formDataValue;\n\t\t}\n\n\t\tif (options.calendarContext)\n\t\t{\n\t\t\tthis.extensionParams.calendarContext = options.calendarContext;\n\t\t}\n\n\t\tif (options.isLocationCalendar)\n\t\t{\n\t\t\tthis.extensionParams.isLocationCalendar = options.isLocationCalendar;\n\t\t}\n\n\t\tif (options.roomsManager)\n\t\t{\n\t\t\tthis.extensionParams.roomsManager = options.roomsManager;\n\t\t}\n\n\t\tif (options.locationAccess)\n\t\t{\n\t\t\tthis.extensionParams.locationAccess = options.locationAccess;\n\t\t}\n\n\t\tif (options.locationCapacity)\n\t\t{\n\t\t\tthis.extensionParams.locationCapacity = options.locationCapacity;\n\t\t}\n\n\t\tif (Type.isDate(options.entryDateFrom))\n\t\t{\n\t\t\tthis.extensionParams.entryDateFrom = options.entryDateFrom;\n\t\t}\n\n\t\tif (options.timezoneOffset)\n\t\t{\n\t\t\tthis.extensionParams.timezoneOffset = options.timezoneOffset;\n\t\t}\n\n\t\tif (Type.isString(options.entryName))\n\t\t{\n\t\t\tthis.extensionParams.entryName = options.entryName;\n\t\t}\n\n\t\tif (Type.isString(options.entryDescription))\n\t\t{\n\t\t\tthis.extensionParams.entryDescription = options.entryDescription;\n\t\t}\n\n\t\tif (Type.isString(options.link))\n\t\t{\n\t\t\tconst uri = new Uri(options.link);\n\t\t\tconst isSharing = uri.getQueryParam('IS_SHARING');\n\t\t\tthis.isSharing = isSharing === '1';\n\t\t}\n\n\t\tif (Type.isBoolean(options.isSharing) && options.isSharing === true)\n\t\t{\n\t\t\tthis.isSharing = true;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.jumpToControl))\n\t\t{\n\t\t\tthis.extensionParams.jumpToControl = options.jumpToControl;\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tif (this.isSharing)\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\t\tcontentCallback: this.loadDeletedViewForm.bind(this),\n\t\t\t\twidth: 600,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\t\tcontentCallback: this.loadExtension.bind(this),\n\t\t\t\tlabel: {\n\t\t\t\t\ttext: Loc.getMessage('CALENDAR_EVENT'),\n\t\t\t\t\tbgColor: \"#55D0E0\"\n\t\t\t\t},\n\t\t\t\ttype: 'calendar:slider'\n\t\t\t});\n\t\t}\n\t}\n\n\tloadExtension(slider): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst extensionName = 'calendar.' + this.extensionName.toLowerCase();\n\t\t\tRuntime.loadExtension(extensionName).then((exports) => {\n\t\t\t\tif (exports && exports[this.extensionName])\n\t\t\t\t{\n\t\t\t\t\tconst calendarForm = new exports[this.extensionName](this.extensionParams);\n\t\t\t\t\tif (typeof calendarForm.initInSlider)\n\t\t\t\t\t{\n\t\t\t\t\t\tcalendarForm.initInSlider(slider, resolve);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error(`Extension \"calendar.${extensionName}\" not found`);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tasync loadDeletedViewForm(slider): Promise\n\t{\n\t\tconst { DeletedViewForm } = await Runtime.loadExtension('calendar.sharing.deletedviewform');\n\n\t\treturn new Promise((resolve) => {\n\t\t\tnew DeletedViewForm(this.extensionParams.entryId).initInSlider(slider, resolve);\n\t\t});\n\t}\n}"],"names":["SliderLoader","constructor","entryId","options","extensionName","Type","isString","substring","parseInt","sliderId","Math","random","extensionParams","entry","type","ownerId","userId","isArray","participantsEntityList","participantsSelectorEntityList","formDataValue","calendarContext","isLocationCalendar","roomsManager","locationAccess","locationCapacity","isDate","entryDateFrom","timezoneOffset","entryName","entryDescription","link","uri","Uri","isSharing","getQueryParam","isBoolean","isStringFilled","jumpToControl","show","BX","SidePanel","Instance","open","contentCallback","loadDeletedViewForm","bind","width","loadExtension","label","text","Loc","getMessage","bgColor","slider","Promise","resolve","toLowerCase","Runtime","then","exports","calendarForm","initInSlider","console","error","DeletedViewForm"],"mappings":"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"}