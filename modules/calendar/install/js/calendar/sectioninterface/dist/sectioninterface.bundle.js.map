{"version":3,"file":"sectioninterface.bundle.js","sources":["../src/editform.js","../src/trackingusersform.js","../src/trackinggroupsform.js","../src/trackingcollabform.js","../src/trackingtypesform.js","../src/sectioninterface.js"],"sourcesContent":["import { Runtime, Dom, Event, Loc, Text, Type, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog as EntitySelectorDialog} from 'ui.entity-selector';\n\n\nexport class EditForm extends EventEmitter\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface.EditForm');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.sectionAccessTasks = options.sectionAccessTasks;\n\t\tthis.sectionManager = options.sectionManager;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.section = params.section;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tthis.allowChangeName = params.allowChangeName !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = '';\n\t\t\tthis.DOM.accessWrap.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = 'none';\n\t\t\tthis.DOM.accessWrap.style.display = 'none';\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.section)\n\t\t{\n\t\t\tif (params.section.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.section.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.section.access || params.section.data.ACCESS || {});\n\n\t\t\tif (params.section.name)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.value = params.section.name;\n\t\t\t}\n\t\t}\n\n\t\tif (this.allowChangeName)\n\t\t{\n\t\t\tBX.focus(this.DOM.sectionTitleInput);\n\t\t\tif (this.DOM.sectionTitleInput.value !== '')\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.select();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.sectionTitleInput, '--disabled');\n\t\t\tthis.DOM.sectionTitleInput.disabled = true;\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-form-content'}}));\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(\n\t\t\t\tDom.create(\n\t\t\t\t\t'DIV',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content-block'}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.sectionTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-field-container calendar-field-container-string'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-field-block'}}))\n\t\t\t.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {type: 'text', placeholder: Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')},\n\t\t\t\tprops: {className: 'calendar-field calendar-field-string'}\n\t\t\t}));\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-new-calendar-options-container'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-btn-container'}}));\n\n\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\tevents: {click: this.save.bind(this)}\n\t\t});\n\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: {click: this.checkClose.bind(this)}\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckClose()\n\t{\n\t\tthis.close();\n\t}\n\n\tsave()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.sectionManager.saveSection(\n\t\t\tthis.DOM.sectionTitleInput.value,\n\t\t\tthis.color,\n\t\t\tthis.access,\n\t\t\t{section: this.section}\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitSectionColorSelector()\n\t{\n\t\tthis.DOM.colorContWrap = this.DOM.optionsWrap.appendChild(Dom.create('DIV', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_COLOR')\n\t\t}));\n\t\tthis.colorIcon = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-selected' }\n\t\t}));\n\t\tthis.colorChangeLink = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-change' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_CHANGE')\n\t\t}));\n\n\t\tEvent.bind(this.colorIcon, 'click', this.showSimplePicker.bind(this));\n\t\tEvent.bind(this.colorChangeLink, 'click', this.showSimplePicker.bind(this));\n\t}\n\n\tshowSimplePicker(value)\n\t{\n\t\tconst colors = Runtime.clone(Util.getDefaultColorList(), true);\n\t\tconst innerCont = Dom.create(\n\t\t\t'DIV',\n\t\t\t{\n\t\t\t\tprops: {className: 'calendar-simple-color-wrap calendar-field-container-colorpicker-square'}\n\t\t\t}\n\t\t);\n\t\tconst colorWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\t\tevents: {click: BX.delegate(this.simplePickerClick, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLinkWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link-wrap'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLink = moreLinkWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'SPAN',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link'},\n\t\t\t\t\thtml: Loc.getMessage('EC_COLOR'),\n\t\t\t\t\tevents: {click: BX.delegate(this.showFullPicker, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.simplePickerColorWrap = colorWrap;\n\t\tthis.colors = [];\n\n\t\tif (!colors.includes(this.color))\n\t\t{\n\t\t\tcolors.push(this.color);\n\t\t}\n\n\t\tfor (let i = 0; i < colors.length; i++)\n\t\t{\n\t\t\tthis.colors.push({\n\t\t\t\tcolor: colors[i],\n\t\t\t\tnode: colorWrap.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-field-colorpicker-color-item'},\n\t\t\t\t\tstyle: {backgroundColor: colors[i]},\n\t\t\t\t\tattrs: {'data-bx-calendar-color': colors[i]},\n\t\t\t\t\thtml: '<span class=\"calendar-field-colorpicker-color\"></span>'\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\n\t\tthis.lastActiveNode = this.colors[BX.util.array_search(this.color, colors) || 0].node;\n\t\tDom.addClass(this.lastActiveNode, 'active');\n\n\t\tthis.simpleColorPopup = BX.PopupWindowManager.create(\n\t\t\t\"simple-color-popup-\" + Util.getRandomInt(),\n\t\t\tthis.colorIcon,\n\t\t\t{\n\t\t\t\t//zIndex: this.zIndex,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 9,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: innerCont,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.simpleColorPopup.setAngle({offset: 10});\n\t\tthis.simpleColorPopup.show(true);\n\t}\n\n\tsimplePickerClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tconst value = target.getAttribute('data-bx-calendar-color');\n\t\t\tif(value !== null)\n\t\t\t{\n\t\t\t\tif (this.lastActiveNode)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.lastActiveNode, 'active');\n\t\t\t\t}\n\n\t\t\t\tDom.addClass(target, 'active');\n\t\t\t\tthis.lastActiveNode = target;\n\t\t\t\tthis.setColor(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFullPicker()\n\t{\n\t\tif (this.simpleColorPopup)\n\t\t{\n\t\t\tthis.simpleColorPopup.close();\n\t\t}\n\n\t\tif (!this.fullColorPicker || this.fullColorPicker.getPopupWindow()?.isDestroyed())\n\t\t{\n\t\t\tthis.fullColorPicker = new BX.ColorPicker({\n\t\t\t\tbindElement: this.DOM.colorContWrap,\n\t\t\t\tonColorSelected: BX.delegate(function(color){\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t}, this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose:BX.delegate(function(){\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.fullColorPicker.open();\n\t}\n\n\tsetColor(value)\n\t{\n\t\tthis.colorIcon.style.backgroundColor = value;\n\t\tthis.color = value;\n\t}\n\n\tsetAccess(value)\n\t{\n\t\tlet rowsCount = 0;\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\trowsCount++;\n\t\t\t}\n\t\t}\n\t\tthis.accessRowsCount = rowsCount;\n\t\tthis.access = value;\n\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\tthis.insertAccessRow(Util.getAccessName(code), code, value[code]);\n\t\t\t}\n\t\t}\n\t\tthis.checkAccessTableHeight();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tif (this.sectionManager && this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\tthis.initDialogGroup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initDialogStandard();\n\t\t}\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tinitAccessSelectorPopup()\n\t{\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\n\t\t\t\t\t\t\t\t\t\t\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildAccessController()\n\t{\n\t\tthis.DOM.accessLink = this.DOM.optionsWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-new-calendar-option-more\">${Loc.getMessage('EC_SEC_SLIDER_ACCESS')}</div>`,\n\t\t);\n\n\t\tthis.DOM.accessWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\"></table>\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,\n\t\t);\n\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.sectionAccessTasks;\n\n\t\tEvent.bind(this.DOM.accessLink, 'click', () => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\tthis.checkAccessTableHeight();\n\t\t});\n\t}\n\n\tinitDialogStandard()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tconst entities = [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department',\n\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tif (Util.isProjectFeatureEnabled())\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'project',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities,\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\tinitDialogGroup()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'groupAccess',\n\t\t\t\t\t\ttitle: this.sectionManager.ownerName,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'A',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_ADMIN'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'E',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MODERATORS'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'K',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MEMBERS'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tlet title;\n\t\t\t\tif (entity.entityId === 'group')\n\t\t\t\t{\n\t\t\t\t\ttitle = this.sectionManager.ownerName + ': ' + entity.title.text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = entity.title.text;\n\t\t\t\t}\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\t// todo: refactor it\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor(let taskId in this.sectionAccessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.sectionAccessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.sectionAccessTasks[taskId].name === 'calendar_view'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst\n\t\t\t\trowNode = Dom.adjust(this.DOM.accessTable.insertRow(-1), {props : {className: 'calendar-section-slider-access-table-row'}}),\n\t\t\t\ttitleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\thtml: '<span class=\"calendar-section-slider-access-title\">' + Text.encode(title) + ':</span>'}),\n\t\t\t\tvalueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-selector': code}\n\t\t\t\t}),\n\t\t\t\tselectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-container'}\n\t\t\t\t})),\n\t\t\t\tvalueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-value'}\n\t\t\t\t})),\n\t\t\t\tremoveIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-remove'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-remove': code}\n\t\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode: rowNode,\n\t\t\t\ttitleNode: titleNode,\n\t\t\t\tvalueNode: valueNode,\n\t\t\t\tremoveIcon: removeIcon\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = parseInt(this.DOM.accessTable.offsetHeight) + 100 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor(let taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function (value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(taskId)\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t'section-access-popup' + Util.randomInt(),\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Runtime, Dom, Event, Loc, Type, Tag, Text } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingUsersForm\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.interfaceType = 'users';\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.trackingUsers = options.trackingUsers || [];\n\t\tthis.trackingUserIdList = this.trackingUsers.map((item) => parseInt(item.ID, 10));\n\t\tthis.trackingIdList = [];\n\n\t\tthis.CHECKED_CLASS = 'calendar-list-slider-item-checkbox-checked';\n\t\tthis.selectorId = `add-tracking${Util.getRandomInt()}`;\n\t\tthis.closeCallback = options.closeCallback;\n\n\t\tthis.superposedSections = Type.isArray(options.superposedSections) ? options.superposedSections : [];\n\t\tthis.selected = {};\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tthis.selected[section.id] = true;\n\t\t});\n\n\t\tthis.isCreated = false;\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t\tthis.checkInnerWrapHeight();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.updateSectionList();\n\n\t\tthis.firstTrackingUserIdList = Runtime.clone(this.trackingUserIdList);\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose(): void\n\t{\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.isOpenedState = false;\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\t\tthis.DOM.outerWrap.style.cssText = '';\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened(): boolean\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate(): void\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } }),\n\t\t);\n\n\t\tthis.userTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 320,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingUsers.map(\n\t\t\t\t\t(item) => ['user', parseInt(item.ID, 10)],\n\t\t\t\t),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tthis.userTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tcreateButtons(): void\n\t{\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-btn-container\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\t\tonclick=\"${this.save.bind(this)}\"\n\t\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_SAVE')}</button>\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"ui-btn ui-btn-link\"\n\t\t\t\t\t\tonclick=\"${this.close.bind(this)}\"\n\t\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_CANCEL')}</button>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t}\n\n\thandleUserSelectorChanges(): void\n\t{\n\t\tconst selectedItems = this.userTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingUserIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\tthis.trackingUserIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tsave(): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\tgroupIdList: this.trackingIdList,\n\t\t\t\tcollabIdList: this.trackingIdList,\n\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t\ttype: this.interfaceType,\n\t\t\t},\n\t\t}).then(\n\t\t\t() => {\n\t\t\t\tlocation.reload();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\n\t\tthis.close();\n\t}\n\n\tprepareTrackingSections()\n\t{\n\t\tlet sections = this.getSelectedSections();\n\n\t\tfor (const id in this.sectionIndex)\n\t\t{\n\t\t\tif (this.sectionIndex.hasOwnProperty(id) && this.sectionIndex[id].checkbox)\n\t\t\t{\n\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t{\n\t\t\t\t\tif (!sections.includes(parseInt(id, 10)))\n\t\t\t\t\t{\n\t\t\t\t\t\tsections.push(parseInt(id, 10));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (sections.includes(parseInt(id, 10)))\n\t\t\t\t{\n\t\t\t\t\tsections = sections.filter(\n\t\t\t\t\t\t(section) => parseInt(section, 10) !== parseInt(id, 10),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sections;\n\t}\n\n\tgetSelectedSections()\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'users'\n\t\t\t\t&& section.type === 'user'\n\t\t\t\t&& this.trackingUserIdList\n\t\t\t\t&& !this.trackingUserIdList.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\tupdateSectionList(delayExecution)\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tif (delayExecution !== false)\n\t\t{\n\t\t\tthis.updateSectionTimeout = setTimeout(() => {\n\t\t\t\tthis.updateSectionList(false);\n\t\t\t}, 300);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\ttype: 'users',\n\t\t\t},\n\t\t}).then(\n\t\t\t// Success\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t// Users calendars\n\t\t\t\tresponse.data.users.forEach((user) => {\n\t\t\t\t\tconst sections = response.data.sections.filter((section) => {\n\t\t\t\t\t\treturn parseInt(section.OWNER_ID, 10) === parseInt(user.ID, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t${Text.encode(user.FORMATTED_NAME)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\n\t\t\t\t\tif (sections.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\tsectionList: sections,\n\t\t\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\t}\n\n\tcreateSectionBlock(params = {})\n\t{\n\t\tlet result = false;\n\t\tif (\n\t\t\tType.isArray(params.sectionList)\n\t\t\t&& params.sectionList.length\n\t\t\t&& Type.isElementNode(params.wrap))\n\t\t{\n\t\t\tlet listWrap;\n\t\t\tparams.wrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${listWrap = Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tEvent.bind(listWrap, 'click', this.sectionClick.bind(this));\n\n\t\t\tparams.sectionList.forEach((section) => {\n\t\t\t\tconst id = section.ID.toString();\n\t\t\t\tlet checkbox;\n\n\t\t\t\tconst li = listWrap.appendChild(Tag.render`\n\t\t\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${id}\">\n\t\t\t\t\t\t${checkbox = Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-list-slider-item-checkbox\" style=\"background: ${section.COLOR}\"></div>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t<div class=\"calendar-list-slider-item-name\">${Text.encode(section.NAME)}</div>\n\t\t\t\t\t</li>\n\t\t\t\t`);\n\n\t\t\t\tthis.sectionIndex[id] = {\n\t\t\t\t\titem: li,\n\t\t\t\t\tcheckbox,\n\t\t\t\t};\n\n\t\t\t\tif (\n\t\t\t\t\tthis.selected[id]\n\t\t\t\t\t|| !Type.isArray(this.firstTrackingUserIdList)\n\t\t\t\t\t|| !this.firstTrackingUserIdList.includes(parseInt(section.OWNER_ID, 10))\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(checkbox, this.CHECKED_CLASS);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsectionClick(e): void\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (!Type.isElementNode(target))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = target.getAttribute('data-bx-calendar-section');\n\t\tif (id === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.sectionIndex[id]?.checkbox)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t{\n\t\t\tDom.removeClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t}\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif (e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if (e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckInnerWrapHeight()\n\t{\n\t\tif (this.checkHeightTimeout)\n\t\t{\n\t\t\tclearTimeout(this.checkHeightTimeout);\n\t\t\tthis.checkHeightTimeout = null;\n\t\t}\n\n\t\tthis.checkHeightTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.outerWrap, 'show'))\n\t\t\t{\n\t\t\t\tif (this.DOM.outerWrap.offsetHeight - this.DOM.innerWrap.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tconst fullHeight = parseInt(this.DOM.innerWrap.offsetHeight, 10) + 200;\n\t\t\t\t\tthis.DOM.outerWrap.style.maxHeight = `${fullHeight}px`;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n}\n","import { Dom, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\nimport { TrackingUsersForm } from './trackingusersform';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingGroupsForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.interfaceType = 'groups';\n\t\tthis.trackingIdList = options.trackingGroups || [];\n\t\tthis.collabs = options.collabs || [];\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } }),\n\t\t);\n\n\t\tthis.groupTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 320,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingIdList.map((id) => ['project', id]),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: this.getSelectorEntities(),\n\t\t\t},\n\t\t});\n\n\t\tthis.groupTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\thandleGroupSelectorChanges()\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityType === 'project')\n\t\t\t{\n\t\t\t\tthis.trackingIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tgroupIdList: this.trackingIdList,\n\t\t\t\ttype: this.interfaceType,\n\t\t\t},\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t// Groups calendars\n\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t});\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'groups'\n\t\t\t\t&& section.type === 'group'\n\t\t\t\t&& !this.trackingIdList?.includes(section.ownerId)\n\t\t\t\t&& !this.collabs?.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\tgetSelectorEntities(): Array\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'project',\n\t\t\t\toptions: {\n\t\t\t\t\tlockProjectLink: !Util.isProjectFeatureEnabled(),\n\t\t\t\t\tlockProjectLinkFeatureId: 'socialnetwork_projects_groups',\n\t\t\t\t\t'!type': ['collab'],\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n}\n","import { TrackingGroupsForm } from './trackinggroupsform';\n\nexport class TrackingCollabsForm extends TrackingGroupsForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.interfaceType = 'collabs';\n\t\tthis.trackingIdList = options.trackingCollabs || [];\n\t\tthis.groups = options.groups || [];\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section): void => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'collabs'\n\t\t\t\t&& section.type === 'group'\n\t\t\t\t&& !this.trackingIdList?.includes(section.ownerId)\n\t\t\t\t&& !this.groups?.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsections.push(parseInt(section.id, 10));\n\t\t});\n\n\t\treturn sections;\n\t}\n\n\thandleGroupSelectorChanges(): void\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingIdList = [];\n\t\tselectedItems.forEach((item): void => {\n\t\t\tif (item.entityType !== 'collab')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.trackingIdList.push(item.id);\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tgetSelectorEntities(): Array\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'project',\n\t\t\t\toptions: {\n\t\t\t\t\ttype: ['collab'],\n\t\t\t\t\tcreateProjectLink: false,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n}\n","import { Dom, Loc, Tag, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TrackingUsersForm } from './trackingusersform';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class TrackingTypesForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.trackingGroups = options.trackingGroups || [];\n\t\tthis.interfaceType = 'company';\n\t\tthis.selectGroups = true;\n\t\tthis.selectUsers = false;\n\t\tthis.addLinkMessage = Loc.getMessage('EC_SEC_SLIDER_SELECT_GROUPS');\n\t}\n\n\tshow()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tthis.updateSectionList();\n\t\tthis.isOpenedState = true;\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`,\n\t\t);\n\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), { style: { height: '140px' } }),\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tclearTimeout(this.updateSectionTimeout);\n\t\t\tthis.updateSectionTimeout = null;\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\tdata: {\n\t\t\t\ttype: 'company',\n\t\t\t},\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\tthis.sectionIndex = {};\n\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\tif (\n\t\t\t\t\tType.isArray(response.data.sections)\n\t\t\t\t\t&& response.data.sections.length)\n\t\t\t\t{\n\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\twrap: this.sectionsWrap,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tUtil.displayError(response.errors);\n\t\t\t},\n\t\t);\n\n\t\tthis.checkInnerWrapHeight();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t},\n\t\t}).then(\n\t\t\t() => location.reload(),\n\t\t\t(response) => Util.displayError(response.errors),\n\t\t);\n\n\t\tthis.close();\n\t}\n\n\tgetSelectedSections(): Array<number>\n\t{\n\t\tconst sections = [];\n\t\tthis.superposedSections.forEach((section) => sections.push(parseInt(section.id, 10)));\n\n\t\treturn sections;\n\t}\n}\n","import { Util } from 'calendar.util';\nimport { IcalSyncPopup } from 'calendar.sync.interface';\nimport { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuItem, MenuManager } from 'main.popup';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { EditForm } from './editform';\nimport { TrackingUsersForm } from './trackingusersform';\nimport { TrackingGroupsForm } from './trackinggroupsform';\nimport { TrackingCollabsForm } from './trackingcollabform';\nimport { TrackingTypesForm } from './trackingtypesform';\nimport { SectionManager } from 'calendar.sectionmanager';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\n/* eslint-disable @bitrix24/bitrix24-rules/no-native-dom-methods */\nexport class SectionInterface extends EventEmitter\n{\n\tname = 'sectioninterface';\n\tuid = null;\n\tDOM = {};\n\tSLIDER_WIDTH = 400;\n\tSLIDER_DURATION = 80;\n\tsliderId = 'calendar:section-slider';\n\tdenyClose = false;\n\tdeletedSectionsIds = [];\n\tisCollabFeatureEnabled = false;\n\n\tconstructor({ calendarContext, readonly, sectionManager, isCollabFeatureEnabled = false })\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface');\n\t\tthis.sectionManager = sectionManager;\n\t\tthis.calendarContext = calendarContext;\n\t\tthis.readonly = readonly;\n\t\tthis.BX = Util.getBX();\n\t\tthis.deleteSectionHandlerBinded = this.deleteSectionHandler.bind(this);\n\t\tthis.refreshSectionListBinded = this.refreshSectionList.bind(this);\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t\tthis.currentUserId = this.calendarContext?.currentUser?.id;\n\t\tthis.isCollabFeatureEnabled = isCollabFeatureEnabled;\n\n\t\tif (this.calendarContext !== null && this.calendarContext.util.config.accessNames)\n\t\t{\n\t\t\tUtil.setAccessNames(this.calendarContext?.util?.config?.accessNames);\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION,\n\t\t\tevents: {\n\t\t\t\tonCloseByEsc: this.escHide.bind(this),\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tthis.addEventEmitterSubscriptions();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t}\n\n\taddEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t}\n\n\tdestroyEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded,\n\t\t);\n\t}\n\n\tescHide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId && this.denyClose)\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.closeForms();\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:delete', this.deleteSectionHandlerBinded);\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:pull-delete', this.deleteSectionHandlerBinded);\n\n\t\t\tBX.removeCustomEvent('SidePanel.Slider:onCloseComplete', BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.localSectionListWrap;\n\n\t\t\tthis.deletedSectionsIds = [];\n\n\t\t\tif (this.sectionActionMenu)\n\t\t\t{\n\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t}\n\n\t\t\tif (this.trackingTypesForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingTypesForm;\n\t\t\t}\n\n\t\t\tif (this.trackingUsersForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingUsersForm;\n\t\t\t}\n\n\t\t\tif (this.trackingGroupsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingGroupsForm;\n\t\t\t}\n\n\t\t\tif (this.trackingCollabsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingCollabsForm;\n\t\t\t}\n\n\t\t\tif (this.addBtnMenu)\n\t\t\t{\n\t\t\t\tthis.addBtnMenu.destroy();\n\t\t\t\tdelete this.addBtnMenu;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\tthis.DOM.outerWrap = Tag.render`\n\t\t\t<div class=\"calendar-list-slider-wrap\"></div>\n\t\t`;\n\t\tthis.DOM.titleWrap = this.DOM.outerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-title-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-title\"> \n\t\t\t\t\t\t${Loc.getMessage('EC_SECTION_BUTTON')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext && !this.readonly)\n\t\t{\n\t\t\tthis.DOM.sectionFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tcalendarContext\n\t\t\t&& !this.readonly\n\t\t\t&& (\n\t\t\t\t!calendarContext.util.isUserCalendar()\n\t\t\t\t|| calendarContext.util.userIsOwner()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t// #1. Controls\n\t\t\tthis.createAddButton();\n\n\t\t\t// #2. Forms\n\t\t\tthis.DOM.trackingGroupsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingCollabsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COLLAB')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingUsersFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t\tthis.DOM.trackingTypesFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t);\n\t\t}\n\n\t\t// #3. List of sections\n\t\tthis.createSectionList();\n\n\t\treturn this.DOM.outerWrap;\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tthis.slider = event.getSlider();\n\t\tthis.sliderId = this.slider.getUrl();\n\t\tthis.DOM.content = this.slider.layout.content;\n\t}\n\n\tcreateSectionList()\n\t{\n\t\tthis.sliderSections = this.sectionManager.getSections().filter((section) => {\n\t\t\treturn !this.deletedSectionsIds.find((id) => id === section.id);\n\t\t});\n\t\tif (Type.isElementNode(this.DOM.sectonListOuterWrap))\n\t\t{\n\t\t\tDom.remove(this.DOM.sectonListOuterWrap);\n\t\t}\n\t\tthis.DOM.sectonListOuterWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\tEvent.bind(this.DOM.sectonListOuterWrap, 'click', this.sectionClickHandler.bind(this));\n\n\t\tthis.createLocalSectionsList();\n\t\tthis.createExternalSectionsList();\n\t}\n\n\tcreateLocalSectionsList()\n\t{\n\t\tthis.DOM.localSectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\tthis.getSectionListWrap(this.getLocalSectionListTitle()),\n\t\t);\n\n\t\tthis.createSectionsBlock({\n\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\tsectionList: this.sliderSections.filter((section) => {\n\t\t\t\treturn (section.externalTypeIsLocal() && section.belongsToView()) || section.isPseudo();\n\t\t\t}),\n\t\t});\n\n\t\tthis.createCompanySectionList();\n\t\tthis.createUsersSectionList();\n\t\tthis.createGroupsSectionList();\n\t\tthis.createCollabSectionList();\n\t}\n\n\tcreateExternalSectionsList()\n\t{\n\t\tconst externalSections = this.sliderSections.filter((section) => {\n\t\t\treturn !section.externalTypeIsLocal() && section.belongsToView();\n\t\t});\n\n\t\tthis.DOM.extSectionListWrap = [];\n\n\t\texternalSections.forEach((section) => {\n\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\n\t\t\tthis.createSectionUnit({\n\t\t\t\tsection,\n\t\t\t\twrap: listWrap,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSectionListWrapForSection(section)\n\t{\n\t\tlet sectionExternalType = section.getExternalType();\n\t\tif (section.isGoogle())\n\t\t{\n\t\t\tsectionExternalType = 'google';\n\t\t}\n\n\t\tif (section.data.IS_EXCHANGE)\n\t\t{\n\t\t\tsectionExternalType = 'exchange';\n\t\t}\n\n\t\tconst sectionExternalConnection = SectionManager.getSectionExternalConnection(section, sectionExternalType);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tsection.data.CAL_DAV_CON = sectionExternalConnection?.addParams?.id || null;\n\t\tconst key = sectionExternalType + (\n\t\t\tsectionExternalConnection\n\t\t\t\t? sectionExternalConnection.getId()\n\t\t\t\t: '-disconnected'\n\t\t);\n\n\t\tif (!Type.isElementNode(this.DOM.extSectionListWrap[key]))\n\t\t{\n\t\t\tconst sectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\t\tthis.getSectionListWrap(this.getExternalConnectionBlockTitle(\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: sectionExternalType,\n\t\t\t\t\t\tconnection: sectionExternalConnection,\n\t\t\t\t\t},\n\t\t\t\t)),\n\t\t\t);\n\n\t\t\tsectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${this.DOM.extSectionListWrap[key] = Tag.render`<ul class=\"calendar-list-slider-container\"/>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tif (\n\t\t\t\t!sectionExternalConnection\n\t\t\t\t&& calendarContext\n\t\t\t\t&& calendarContext.util.userIsOwner()\n\t\t\t\t&& !section.isArchive()\n\t\t\t\t&& (\n\t\t\t\t\t!section.isExchange()\n\t\t\t\t\t||\t(!calendarContext.util.config.bExchange && section.isExchange())\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-widget-content-block')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<div data-bx-calendar-open-sync=\"Y\" class=\"calendar-list-slider-card-widget-bottom-button\">\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-link\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ADJUST_SYNC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`,\n\t\t\t\t\t);\n\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text calendar-list-title-disabled\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_SYNC_DISABLED')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t`,\n\t\t\t\t\t);\n\t\t\t}\n\t\t\telse if (section.isArchive())\n\t\t\t{\n\t\t\t\tconst hintNode = sectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-question calendar-list-slider-archive-hint\"\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE_HELPER')}\">\n\t\t\t\t\t\t\t<i></i>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`);\n\t\t\t\tif (Type.isDomNode(hintNode))\n\t\t\t\t{\n\t\t\t\t\tUtil.initHintNode(hintNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.DOM.extSectionListWrap[key];\n\t}\n\n\tgetExternalConnectionBlockTitle({ type, connection }): string\n\t{\n\t\tlet title = '';\n\t\tconst connectionName = connection\n\t\t\t? connection.getConnectionAccountName() || connection.getConnectionName()\n\t\t\t: null\n\t\t;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'google':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_GOOGLE',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_GOOGLE_DIS');\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'office365':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_OFFICE365',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_OFFICE365_DIS');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'icloud':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_ICLOUD',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ICLOUD_DIS');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'caldav':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\tif (connection.getType() === 'yandex')\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_YANDEX',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_CALDAV',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'exchange':\n\t\t\t\ttitle = Loc.getMessage('EC_CAL_SYNC_EXCHANGE');\n\t\t\t\tbreak;\n\t\t\tcase 'archive':\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT');\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tcreateCompanySectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\treturn section.isCompanyCalendar() && !section.belongsToView();\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: this.sliderSections.filter((section) => {\n\t\t\t\t\treturn section.isCompanyCalendar();\n\t\t\t\t}),\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateUsersSectionList()\n\t{\n\t\tthis.calendarContext.util.getSuperposedTrackedUsers().forEach((user) => {\n\t\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\t\treturn !section.belongsToView()\n\t\t\t\t\t&& section.type === 'user'\n\t\t\t\t\t&& section.data.OWNER_ID === user.ID;\n\t\t\t});\n\n\t\t\tif (sections.length > 0)\n\t\t\t{\n\t\t\t\tconst calendarName = this.currentUserId === parseInt(user.ID, 10)\n\t\t\t\t\t? Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST')\n\t\t\t\t\t: Text.encode(user.FORMATTED_NAME)\n\t\t\t\t;\n\t\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t${calendarName}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\n\t\t\t\tthis.createSectionsBlock({\n\t\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\t\tsectionList: sections,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateGroupsSectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => (\n\t\t\t!section.belongsToView() && section.type === 'group' && !section.isCollab()\n\t\t));\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_GROUP_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: sections,\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateCollabSectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => (\n\t\t\t!section.belongsToView() && section.type === 'group' && section.isCollab()\n\t\t));\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_TITLE_COLLAB_CALENDAR')}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: sections,\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSectionListWrap(title): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-list-slider-card-widget\">\n\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t${Text.encode(title)}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetLocalSectionListTitle(): string\n\t{\n\t\tif (this.sectionManager.calendarType === 'user')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t}\n\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\t\tif (\n\t\t\tthis.sectionManager.calendarType === 'group'\n\t\t\t&& calendarContext?.isCollabCalendar\n\t\t)\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_THIS_COLLAB_CALENDARS_LIST');\n\t\t}\n\n\t\tif (\n\t\t\tthis.sectionManager.calendarType === 'group'\n\t\t\t&& !calendarContext?.isCollabCalendar\n\t\t)\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\n\t\treturn Loc.getMessage('EC_SEC_SLIDER_TYPE_CALENDARS_LIST');\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (\n\t\t\tcalendarContext.util.config.perm?.edit_section\n\t\t\t&& !calendarContext.isCollabUser\n\t\t)\n\t\t{\n\t\t\tconst addButtonOuter = this.DOM.titleWrap.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-split ui-btn-light-border\" style=\"margin-right: 0\"></span>\n\t\t\t`);\n\t\t\tthis.DOM.addButton = addButtonOuter.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-main\">${Loc.getMessage('EC_ADD')}</span>\n\t\t\t`);\n\t\t\tthis.DOM.addButtonMore = addButtonOuter.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-extra\"></span>\n\t\t\t`);\n\n\t\t\tEvent.bind(this.DOM.addButtonMore, 'click', this.showAddButtonPopup.bind(this));\n\t\t\tEvent.bind(this.DOM.addButton, 'click', this.showEditSectionForm.bind(this));\n\t\t}\n\t}\n\n\tshowAddButtonPopup(): void\n\t{\n\t\tif (this.addBtnMenu && this.addBtnMenu.popupWindow && this.addBtnMenu.popupWindow.isShown())\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_TITLE'),\n\t\t\t\tdelimiter: true,\n\t\t\t}),\n\t\t\t{\n\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_MENU'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\tthis.showEditSectionForm();\n\t\t\t\t},\n\t\t\t},\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_EXIST_TITLE'),\n\t\t\t\tdelimiter: true,\n\t\t\t}),\n\t\t\tthis.getAddCompanyMenuItem(),\n\t\t\tthis.getAddUserMenuItem(),\n\t\t\tthis.getAddGroupMenuItem(),\n\t\t];\n\n\t\tif (this.isCollabFeatureEnabled)\n\t\t{\n\t\t\tmenuItems.push(this.getAddCollabMenuItem());\n\t\t}\n\n\t\tthis.addBtnMenu = MenuManager.create(\n\t\t\t`add-btn-${Util.getRandomInt()}`,\n\t\t\tthis.DOM.addButtonMore,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: this.zIndex,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 15,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false,\n\t\t\t},\n\t\t);\n\n\t\tthis.addBtnMenu.show();\n\t}\n\n\tgetAddCompanyMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingTypesForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddUserMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingUsersForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddGroupMenuItem(): Object\n\t{\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext.util.config.projectFeatureEnabled)\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\tthis.showTrackingGroupsForm();\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-item-lock',\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'socialnetwork_projects_groups' }).show();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAddCollabMenuItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COLLAB'),\n\t\t\tonclick: (): void => {\n\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\tthis.showTrackingCollabsForm();\n\t\t\t},\n\t\t};\n\t}\n\n\tcreateSectionsBlock({ sectionList, wrap })\n\t{\n\t\tif (Type.isArray(sectionList))\n\t\t{\n\t\t\tconst listWrap = wrap.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content-block\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`)\n\t\t\t;\n\n\t\t\tsectionList.forEach((section) => {\n\t\t\t\tthis.createSectionUnit({ section, wrap: listWrap });\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateSectionUnit({ section, wrap })\n\t{\n\t\tif (!section.DOM)\n\t\t{\n\t\t\tsection.DOM = {};\n\t\t}\n\t\tconst sectionId = section.id.toString();\n\t\tconst li = wrap.appendChild(Tag.render`\n\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${sectionId}\"></li>\n\t\t`);\n\t\tconst checkbox = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-checkbox ${section.isShown() ? 'calendar-list-slider-item-checkbox-checked' : ''}\" style=\"background-color: ${section.color}\"></div>\n\t\t`);\n\t\tconst title = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-name\" title=\"${Text.encode(section.name)}\">${Text.encode(section.name)}</div>\n\t\t`);\n\n\t\tsection.DOM.item = li;\n\t\tsection.DOM.checkbox = checkbox;\n\t\tsection.DOM.title = title;\n\n\t\tsection.DOM.actionCont = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-actions-container\" data-bx-calendar-section-menu=\"${sectionId}\">\n\t\t\t\t<span class=\"calendar-list-slider-item-context-menu\"></span>\n\t\t\t</div>\n\t\t`);\n\t}\n\n\tsectionClickHandler(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (target && target.getAttribute)\n\t\t{\n\t\t\tif (target.getAttribute('data-bx-calendar-section-menu') !== null)\n\t\t\t{\n\t\t\t\tlet sectionId = target.getAttribute('data-bx-calendar-section-menu');\n\t\t\t\tsectionId = sectionId === 'tasks' ? sectionId : parseInt(sectionId, 10);\n\t\t\t\tthis.showSectionMenu(this.sectionManager.getSection(sectionId), target);\n\t\t\t}\n\t\t\telse if (target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tthis.switchSection(this.sectionManager.getSection(target.getAttribute('data-bx-calendar-section')));\n\t\t\t}\n\t\t\telse if (target.getAttribute('data-bx-calendar-open-sync') !== null)\n\t\t\t{\n\t\t\t\tthis.calendarContext.syncInterface.openSyncPanel();\n\t\t\t}\n\t\t}\n\t}\n\n\tfindCheckBoxNodes(id): Array<HTMLElement>\n\t{\n\t\treturn this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t`.calendar-list-slider-item[data-bx-calendar-section='${id}'] .calendar-list-slider-item-checkbox`,\n\t\t);\n\t}\n\n\tswitchSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\n\t\t// TODO: should use eventEmtter\n\t\tthis.calendarContext.reload();\n\t}\n\n\tswitchOnSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (!section.isShown())\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (!section.isShown())\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\t}\n\n\tswitchOffSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (const checkboxNode of checkboxNodes)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNode, 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t}\n\n\tshowSectionMenu(section, menuItemNode)\n\t{\n\t\tconst menuItems = [];\n\t\tconst itemNode = menuItemNode.closest('[data-bx-calendar-section]');\n\t\tif (Type.isElementNode(itemNode))\n\t\t{\n\t\t\tDom.addClass(itemNode, 'active');\n\t\t}\n\n\t\tif (section.canDo('view_time'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_LEAVE_ONE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showOnlyOneSection(section, this.sectionManager.sections);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (!section.isPseudo() && section.getLink() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_OPEN_LINK'),\n\t\t\t\thref: section.getLink(),\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\t!this.readonly\n\t\t\t&& section.canDo('edit_section')\n\t\t\t&& !section.isPseudo()\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({ section });\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.isSuperposed() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideSuperposedHandler(section);\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.canBeConnectedToOutlook() && section.data.EXTERNAL_TYPE === 'local')\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_CONNECT_TO_OUTLOOK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.connectToOutlook();\n\t\t\t\t\tthis.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\t!section.isPseudo()\n\t\t\t&& section.data.EXPORT\n\t\t\t&& section.data.EXPORT.LINK\n\t\t\t&& section.data.EXTERNAL_TYPE === 'local'\n\t\t\t&& !this.calendarContext?.util?.isExtranetUser()\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXPORT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\n\t\t\t\t\tconst options = {\n\t\t\t\t\t\tsectionLink: section.data.EXPORT.LINK,\n\t\t\t\t\t\tcalendarPath: this.calendarContext.util.config.path,\n\t\t\t\t\t};\n\t\t\t\t\tif (IcalSyncPopup.checkPathes(options))\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.createInstance(options).show();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.showPopupWithPathesError();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tlet provider;\n\t\tlet connection;\n\n\t\tif (section.data.CAL_DAV_CON\n\t\t\t&& section.belongsToView()\n\t\t\t&& this.calendarContext.syncInterface\n\t\t)\n\t\t{\n\t\t\t[provider, connection] = this.calendarContext.syncInterface.getProviderById(section.data.CAL_DAV_CON);\n\t\t}\n\n\t\tif (\n\t\t\tsection.canDo('edit_section')\n\t\t\t&& section.belongsToView()\n\t\t\t&& !section.isPseudo()\n\t\t\t&& (\n\t\t\t\t(!section.isGoogle() && !connection)\n\t\t\t\t|| section.data.EXTERNAL_TYPE === 'local'\n\t\t\t\t|| !connection\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_DELETE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showSectionConfirm('delete', section);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (section.canDo('edit_section') && connection)\n\t\t{\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365() || section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXTERNAL_ADJUST'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tif (provider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprovider.openActiveConnectionSlider(connection);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showSectionConfirm('hideSync', section);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\telse if (section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showSectionConfirm('hideExternal', section);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (section.isPseudo() && section.taskSectionBelongToUser())\n\t\t{\n\t\t\tmenuItems.push(\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tthis.showEditSectionForm({\n\t\t\t\t\t\t\tsection,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_TASK_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tBX.userOptions.save('calendar', 'user_settings', 'showTasks', 'N');\n\n\t\t\t\t\t\tDom.addClass(section.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tDom.clean(section.DOM.item, true);\n\t\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tif (menuItems && menuItems.length > 0)\n\t\t{\n\t\t\tthis.sectionActionMenu = MenuManager.create(\n\t\t\t\t`section-menu-${Util.getRandomInt()}`,\n\t\t\t\tmenuItemNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 9,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tthis.sectionActionMenu.show();\n\t\t\tthis.sectionActionMenu.popupWindow.subscribe('onClose', () => {\n\t\t\t\tif (Type.isElementNode(itemNode))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(itemNode, 'active');\n\t\t\t\t}\n\t\t\t\tthis.allowSliderClose();\n\t\t\t});\n\n\t\t\tthis.denySliderClose();\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tcloseForms()\n\t{\n\t\tif (this.addBtnMenu)\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\t\t}\n\n\t\tif (this.editSectionForm)\n\t\t{\n\t\t\tthis.editSectionForm.close();\n\t\t}\n\n\t\tif (this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm.close();\n\t\t}\n\n\t\tif (this.trackingGroupsForm)\n\t\t{\n\t\t\tthis.trackingGroupsForm.close();\n\t\t}\n\n\t\tif (this.trackingCollabsForm)\n\t\t{\n\t\t\tthis.trackingCollabsForm.close();\n\t\t}\n\n\t\tif (this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm.close();\n\t\t}\n\t}\n\n\tshowEditSectionForm(params = {})\n\t{\n\t\tif (!this.DOM.sectionFormWrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.closeForms();\n\t\tconst formTitleNode = this.DOM.sectionFormWrap.querySelector('.calendar-list-slider-card-widget-title-text');\n\n\t\tthis.editSectionForm = new EditForm({\n\t\t\twrap: this.DOM.sectionFormWrap,\n\t\t\tsectionAccessTasks: this.sectionManager.getSectionAccessTasks(),\n\t\t\tsectionManager: this.sectionManager,\n\t\t\tcloseCallback: () => {\n\t\t\t\tthis.allowSliderClose();\n\t\t\t},\n\t\t});\n\n\t\tlet showAccessControl = true;\n\t\tif (params.section && (!params.section.belongsToView() || params.section.isPseudo()))\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION_PERSONAL');\n\t\t\tshowAccessControl = false;\n\t\t}\n\t\telse if (params.section && params.section.id)\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION');\n\t\t\tshowAccessControl = params.section.hasPermission('access');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\t\t}\n\n\t\tthis.editSectionForm.show({\n\t\t\tshowAccess: showAccessControl,\n\t\t\tallowChangeName: params.section ? !params.section.isPrimaryForConnection() : true,\n\t\t\tsection: params.section || {\n\t\t\t\tcolor: Util.getRandomColor(),\n\t\t\t\taccess: this.sectionManager.getDefaultSectionAccess(),\n\t\t\t},\n\t\t});\n\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingTypesForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm = new TrackingTypesForm({\n\t\t\t\twrap: this.DOM.trackingTypesFormWrap,\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingTypesForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingUsersForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm = new TrackingUsersForm({\n\t\t\t\twrap: this.DOM.trackingUsersFormWrap,\n\t\t\t\ttrackingUsers: this.calendarContext.util.getSuperposedTrackedUsers(),\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingUsersForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingGroupsForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingGroupsForm)\n\t\t{\n\t\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\t\tconst trackingGroups = [];\n\t\t\tconst collabs = [];\n\n\t\t\tsuperposedSections.forEach((section) => {\n\t\t\t\tif (section.getType() !== 'group')\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst ownerId = section.getOwnerId();\n\t\t\t\tif (\n\t\t\t\t\t!section.isCollab()\n\t\t\t\t\t&& !trackingGroups.includes(ownerId)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\ttrackingGroups.push(ownerId);\n\t\t\t\t}\n\t\t\t\telse if (\n\t\t\t\t\tsection.isCollab()\n\t\t\t\t\t&& !collabs.includes(ownerId)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcollabs.push(ownerId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.trackingGroupsForm = new TrackingGroupsForm({\n\t\t\t\twrap: this.DOM.trackingGroupsFormWrap,\n\t\t\t\ttrackingGroups,\n\t\t\t\tcollabs,\n\t\t\t\tsuperposedSections,\n\t\t\t\tcloseCallback: (): void => this.allowSliderClose(),\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingGroupsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingCollabsForm(): void\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingCollabsForm)\n\t\t{\n\t\t\tthis.trackingCollabsForm = this.createTrackingCollabsForm();\n\t\t}\n\n\t\tthis.trackingCollabsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tcreateTrackingCollabsForm(): TrackingCollabsForm\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst trackingCollabs = [];\n\t\tconst groups = [];\n\n\t\tsuperposedSections.forEach((section): void => {\n\t\t\tif (section.getType() !== 'group')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ownerId = section.getOwnerId();\n\t\t\tif (\n\t\t\t\tsection.isCollab()\n\t\t\t\t&& !trackingCollabs.includes(ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\ttrackingCollabs.push(ownerId);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\t!section.isCollab()\n\t\t\t\t&& !groups.includes(ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\tgroups.push(ownerId);\n\t\t\t}\n\t\t});\n\n\t\treturn new TrackingCollabsForm({\n\t\t\twrap: this.DOM.trackingCollabsFormWrap,\n\t\t\ttrackingCollabs,\n\t\t\tgroups,\n\t\t\tsuperposedSections,\n\t\t\tcloseCallback: (): void => this.allowSliderClose(),\n\t\t});\n\t}\n\n\tdeleteSectionHandler(event)\n\t{\n\t\tif (event && event instanceof this.BX.Event.BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst sectionId = parseInt(data.sectionId, 10);\n\n\t\t\tthis.sliderSections.forEach((section, index) => {\n\t\t\t\tif (parseInt(section.id, 10) === sectionId)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionManager.deleteSectionHandler(sectionId);\n\t\t\t\t\tthis.deletedSectionsIds.push(sectionId);\n\t\t\t\t\tconst deleteSectionNodes = this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t\t\t\t`.calendar-list-slider-item[data-bx-calendar-section='${sectionId}']`,\n\t\t\t\t\t);\n\n\t\t\t\t\tdeleteSectionNodes.forEach((node) => {\n\t\t\t\t\t\tDom.addClass(node, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!section.externalTypeIsLocal())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\t\t\t\t\t\tthis.sliderSections = BX.util.deleteFromArray(this.sliderSections, index);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tdeleteSectionNodes.forEach((node) => {\n\t\t\t\t\t\t\t\tDom.remove(node);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (!listWrap.querySelector('li.calendar-list-slider-item'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.remove(listWrap.closest('.calendar-list-slider-card-widget'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.closeForms();\n\t\t}\n\t}\n\n\thideSuperposedHandler(section)\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst sections = [];\n\t\tlet i;\n\n\t\tfor (i = 0; i < superposedSections.length; i++)\n\t\t{\n\t\t\tif (parseInt(section.id, 10) !== parseInt(superposedSections[i].id, 10))\n\t\t\t{\n\t\t\t\tsections.push(parseInt(superposedSections[i].id, 10));\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\tdata: {\n\t\t\t\tsections,\n\t\t\t},\n\t\t}).then(\n\t\t\t() => BX.reload(),\n\t\t\t(response) => Util.displayError(response.errors),\n\t\t);\n\t}\n\n\trefreshSectionList()\n\t{\n\t\tthis.createSectionList();\n\t}\n\n\tshowOnlyOneSection(section, sections)\n\t{\n\t\tfor (const curSection of sections)\n\t\t{\n\t\t\tif (curSection.id === section.id)\n\t\t\t{\n\t\t\t\tthis.switchOnSection(curSection);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.switchOffSection(curSection);\n\t\t\t}\n\t\t}\n\n\t\tthis.calendarContext.reload();\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif (\n\t\t\te.keyCode === Util.getKeyCode('enter')\n\t\t\t&& this.DOM.confirmSectionPopup\n\t\t\t&& this.currentConfirmMode\n\t\t\t&& this.currentSection\n\t\t)\n\t\t{\n\t\t\tswitch (this.currentConfirmMode)\n\t\t\t{\n\t\t\t\tcase 'delete': {\n\t\t\t\t\tthis.removeSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase 'hideSync': {\n\t\t\t\t\tthis.hideSyncSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase 'hideExternal': {\n\t\t\t\t\tthis.hideExternalSection(this.currentSection);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t// no default\n\t\t\t}\n\t\t}\n\t}\n\n\tshowSectionConfirm(mode, section)\n\t{\n\t\tthis.currentSection = section;\n\t\tthis.currentConfirmMode = mode;\n\n\t\tconst confirmCallback = this.getConfirmCallback();\n\t\tconst okCaption = this.getOkCaption();\n\n\t\tthis.DOM.confirmSectionPopup = new MessageBox({\n\t\t\tmessage: this.getSectionConfirmContent(),\n\t\t\tminHeight: 120,\n\t\t\tminWidth: 280,\n\t\t\tmaxWidth: 300,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,\n\t\t\tonOk: confirmCallback,\n\t\t\tonCancel: () => {\n\t\t\t\tthis.DOM.confirmSectionPopup.close();\n\t\t\t},\n\t\t\tokCaption,\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tdelete this.DOM.confirmSectionPopup;\n\t\t\t\t\t\tdelete this.currentSection;\n\t\t\t\t\t\tdelete this.currentConfirmMode;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t},\n\t\t});\n\n\t\tthis.DOM.confirmSectionPopup.show();\n\t}\n\n\tgetConfirmCallback(): Function | null\n\t{\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.removeSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideSync')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.hideSyncSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tthis.hideExternalSection(this.currentSection);\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetOkCaption(): string | null\n\t{\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_DELETE');\n\t\t}\n\n\t\tif (this.currentConfirmMode === 'hideSync' || this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_CAL_SYNC_DISCONNECT');\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSectionConfirmContent(): HTMLElement\n\t{\n\t\tlet phrase = '';\n\n\t\tif (this.currentConfirmMode === 'delete')\n\t\t{\n\t\t\tphrase = Loc.getMessage('EC_SEC_DELETE_CONFIRM');\n\t\t}\n\t\telse if (this.currentConfirmMode === 'hideSync' || this.currentConfirmMode === 'hideExternal')\n\t\t{\n\t\t\tphrase = Loc.getMessage('EC_CAL_GOOGLE_HIDE_CONFIRM');\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-list-slider-messagebox-text\">${phrase}</div>\n\t\t`;\n\t}\n\n\tremoveSection(section)\n\t{\n\t\tsection.remove();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n\n\thideSyncSection(section)\n\t{\n\t\tsection.hideSyncSection();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n\n\thideExternalSection(section)\n\t{\n\t\tsection.hideExternalCalendarSection();\n\t\tthis.DOM.confirmSectionPopup.close();\n\t}\n}\n"],"names":["EditForm","EventEmitter","constructor","options","DOM","isCreated","setEventNamespace","outerWrap","wrap","sectionAccessTasks","sectionManager","closeCallback","BX","Util","getBX","keyHandlerBinded","keyHandler","bind","show","params","section","create","showAccess","allowChangeName","accessLink","style","display","accessWrap","Event","document","Dom","addClass","color","setColor","setAccess","access","data","ACCESS","name","sectionTitleInput","value","focus","select","disabled","isOpenedState","close","unbind","removeClass","Type","isFunction","isOpened","querySelector","clean","appendChild","props","className","formFieldsWrap","attrs","type","placeholder","Loc","getMessage","optionsWrap","initSectionColorSelector","initAccessController","buttonsWrap","saveBtn","UI","Button","text","events","click","save","renderTo","checkClose","e","keyCode","getKeyCode","setWaiting","saveSection","then","colorContWrap","html","colorIcon","colorChangeLink","showSimplePicker","colors","Runtime","clone","getDefaultColorList","innerCont","colorWrap","delegate","simplePickerClick","moreLinkWrap","moreLink","showFullPicker","simplePickerColorWrap","includes","push","i","length","node","backgroundColor","lastActiveNode","util","array_search","simpleColorPopup","PopupWindowManager","getRandomInt","autoHide","closeByEsc","offsetTop","offsetLeft","lightShadow","content","cacheable","setAngle","offset","target","findTargetNode","srcElement","isElementNode","getAttribute","fullColorPicker","getPopupWindow","isDestroyed","ColorPicker","bindElement","onColorSelected","popupOptions","zIndex","onPopupClose","open","rowsCount","code","hasOwnProperty","accessRowsCount","insertAccessRow","getAccessName","checkAccessTableHeight","buildAccessController","calendarType","initDialogGroup","initDialogStandard","initAccessSelectorPopup","accessControls","showAccessSelectorPopup","removeIcon","setValueCallback","accessTasks","valueNode","innerHTML","Text","encode","title","remove","rowNode","Tag","render","accessTable","accessButton","hasClass","entities","id","analyticsSource","selectMode","isProjectFeatureEnabled","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","targetContainer","body","tabs","ownerName","items","ownerId","entityId","entityList","getSelectedItems","hide","isArray","forEach","entity","convertEntityToAccessCode","setAccessName","debounce","destroy","undefined","taskId","adjust","insertRow","titleNode","insertCell","valueCell","selectNode","checkTableTimeout","clearTimeout","setTimeout","offsetHeight","maxHeight","parseInt","accessPopupMenu","popupWindow","isShown","_this","menuItems","onclick","PopupMenu","randomInt","angle","TrackingUsersForm","interfaceType","trackingUsers","trackingUserIdList","map","item","ID","trackingIdList","CHECKED_CLASS","selectorId","superposedSections","selected","checkInnerWrapHeight","updateSectionList","firstTrackingUserIdList","cssText","innerWrap","selectorWrap","userTagSelector","TagSelector","dialogOptions","width","handleUserSelectorChanges","sectionsWrap","createButtons","selectedItems","getDialog","ajax","runAction","userIdList","groupIdList","collabIdList","sections","prepareTrackingSections","location","reload","response","displayError","errors","getSelectedSections","sectionIndex","checkbox","filter","delayExecution","updateSectionLoader","getLoader","height","updateSectionTimeout","users","user","OWNER_ID","FORMATTED_NAME","createSectionBlock","sectionList","result","listWrap","sectionClick","toString","li","COLOR","NAME","checkHeightTimeout","fullHeight","TrackingGroupsForm","trackingGroups","collabs","groupTagSelector","handleGroupSelectorChanges","getSelectorEntities","entityType","lockProjectLink","lockProjectLinkFeatureId","TrackingCollabsForm","trackingCollabs","groups","createProjectLink","TrackingTypesForm","selectGroups","selectUsers","addLinkMessage","SectionInterface","calendarContext","readonly","isCollabFeatureEnabled","uid","SLIDER_WIDTH","SLIDER_DURATION","sliderId","denyClose","deletedSectionsIds","deleteSectionHandlerBinded","deleteSectionHandler","refreshSectionListBinded","refreshSectionList","currentUserId","currentUser","config","accessNames","setAccessNames","SidePanel","Instance","contentCallback","createContent","animationDuration","onCloseByEsc","escHide","onClose","onCloseComplete","onLoad","onLoadSlider","addEventEmitterSubscriptions","subscribe","destroyEventEmitterSubscriptions","unsubscribe","event","getSlider","getUrl","denyAction","closeForms","removeCustomEvent","proxy","localSectionListWrap","sectionActionMenu","trackingTypesForm","trackingUsersForm","trackingGroupsForm","trackingCollabsForm","addBtnMenu","titleWrap","getCalendarContext","sectionFormWrap","isUserCalendar","userIsOwner","createAddButton","trackingGroupsFormWrap","trackingCollabsFormWrap","trackingUsersFormWrap","trackingTypesFormWrap","createSectionList","slider","layout","sliderSections","getSections","find","sectonListOuterWrap","sectionClickHandler","createLocalSectionsList","createExternalSectionsList","getSectionListWrap","getLocalSectionListTitle","createSectionsBlock","externalTypeIsLocal","belongsToView","isPseudo","createCompanySectionList","createUsersSectionList","createGroupsSectionList","createCollabSectionList","externalSections","extSectionListWrap","getSectionListWrapForSection","createSectionUnit","sectionExternalType","getExternalType","isGoogle","IS_EXCHANGE","sectionExternalConnection","SectionManager","getSectionExternalConnection","CAL_DAV_CON","addParams","key","getId","sectionListWrap","getExternalConnectionBlockTitle","connection","isArchive","isExchange","bExchange","hintNode","isDomNode","initHintNode","connectionName","getConnectionAccountName","getConnectionName","getType","isCompanyCalendar","getSuperposedTrackedUsers","calendarName","isCollab","isCollabCalendar","perm","edit_section","isCollabUser","addButtonOuter","addButton","addButtonMore","showAddButtonPopup","showEditSectionForm","MenuItem","delimiter","getAddCompanyMenuItem","getAddUserMenuItem","getAddGroupMenuItem","getAddCollabMenuItem","MenuManager","showTrackingTypesForm","showTrackingUsersForm","projectFeatureEnabled","showTrackingGroupsForm","FeaturePromotersRegistry","getPromoter","featureId","showTrackingCollabsForm","sectionId","actionCont","showSectionMenu","getSection","switchSection","syncInterface","openSyncPanel","findCheckBoxNodes","querySelectorAll","checkboxNodes","checkboxNode","switchOnSection","switchOffSection","menuItemNode","itemNode","closest","canDo","showOnlyOneSection","getLink","href","isSuperposed","hideSuperposedHandler","canBeConnectedToOutlook","EXTERNAL_TYPE","connectToOutlook","EXPORT","LINK","isExtranetUser","sectionLink","calendarPath","path","IcalSyncPopup","checkPathes","createInstance","showPopupWithPathesError","provider","getProviderById","showSectionConfirm","isIcloud","isOffice365","isCalDav","openActiveConnectionSlider","taskSectionBelongToUser","userOptions","allowSliderClose","denySliderClose","editSectionForm","formTitleNode","getSectionAccessTasks","showAccessControl","hasPermission","isPrimaryForConnection","getRandomColor","getDefaultSectionAccess","getSuperposedSectionList","getOwnerId","createTrackingCollabsForm","BaseEvent","getData","index","deleteSectionNodes","deleteFromArray","curSection","confirmSectionPopup","currentConfirmMode","currentSection","removeSection","hideSyncSection","hideExternalSection","mode","confirmCallback","getConfirmCallback","okCaption","getOkCaption","MessageBox","message","getSectionConfirmContent","minHeight","minWidth","maxWidth","buttons","Dialogs","MessageBoxButtons","OK_CANCEL","onOk","onCancel","padding","contentPadding","animation","phrase","hideExternalCalendarSection"],"mappings":"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"}