this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,i,t,a,o,r,l,n,c,b){"use strict";const v="im-chat";const d="im-copilot";const p="im-lines";const f="im-notify";const u="button_";const P={first:"1",second:"2"};var h=babelHelpers.classPrivateFieldLooseKey("instance");var L=babelHelpers.classPrivateFieldLooseKey("store");var B=babelHelpers.classPrivateFieldLooseKey("notificationService");var y=babelHelpers.classPrivateFieldLooseKey("prepareNotificationOptions");var F=babelHelpers.classPrivateFieldLooseKey("subscribeToNotifierEvents");var H=babelHelpers.classPrivateFieldLooseKey("onNotifierClick");var g=babelHelpers.classPrivateFieldLooseKey("onNotifierAction");var M=babelHelpers.classPrivateFieldLooseKey("onNotifierQuickAnswer");var N=babelHelpers.classPrivateFieldLooseKey("onNotifierButtonClick");var O=babelHelpers.classPrivateFieldLooseKey("sendButtonAction");var I=babelHelpers.classPrivateFieldLooseKey("isChatMessage");var C=babelHelpers.classPrivateFieldLooseKey("isCopilotMessage");var X=babelHelpers.classPrivateFieldLooseKey("isLinesMessage");var j=babelHelpers.classPrivateFieldLooseKey("isNotification");var K=babelHelpers.classPrivateFieldLooseKey("isConfirmButtonAction");var T=babelHelpers.classPrivateFieldLooseKey("extractDialogId");var m=babelHelpers.classPrivateFieldLooseKey("extractNotificationId");var w=babelHelpers.classPrivateFieldLooseKey("extractButtonNumber");var _=babelHelpers.classPrivateFieldLooseKey("extractButtonParams");class A{static getInstance(){if(!babelHelpers.classPrivateFieldLooseBase(this,h)[h]){babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new this}return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}static init(){A.getInstance()}constructor(){Object.defineProperty(this,_,{value:J});Object.defineProperty(this,w,{value:G});Object.defineProperty(this,m,{value:z});Object.defineProperty(this,T,{value:q});Object.defineProperty(this,K,{value:U});Object.defineProperty(this,j,{value:Q});Object.defineProperty(this,X,{value:V});Object.defineProperty(this,C,{value:Y});Object.defineProperty(this,I,{value:R});Object.defineProperty(this,O,{value:W});Object.defineProperty(this,N,{value:S});Object.defineProperty(this,M,{value:D});Object.defineProperty(this,g,{value:k});Object.defineProperty(this,H,{value:E});Object.defineProperty(this,F,{value:x});Object.defineProperty(this,y,{value:$});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,B,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=o.Core.getStore();babelHelpers.classPrivateFieldLooseBase(this,B)[B]=new b.NotificationService;babelHelpers.classPrivateFieldLooseBase(this,F)[F]()}showMessage(e){const{message:i,dialog:t,user:a,lines:o}=e;let n="";if(a&&t.type!==c.ChatType.user){n+=`${a.name}: `}n+=r.Parser.purifyMessage(i);let b=`${v}-${t.dialogId}-${i.id}`;if(t.type===c.ChatType.copilot){b=`${d}-${t.dialogId}-${i.id}`}else if(o){b=`${p}-${t.dialogId}-${i.id}`}const f={id:b,title:t.name,icon:t.avatar||(a==null?void 0:a.avatar),text:n};const u=l.DesktopManager.isChatWindow()&&document.hasFocus();if(u){s.Notifier.notifyViaBrowserProvider(f)}else{s.Notifier.notify(f)}}showNotification(e,i){let a=t.Loc.getMessage("IM_LIB_NOTIFIER_NOTIFY_SYSTEM_TITLE");if(e.title){a=e.title}else if(i){a=i.name}const o=babelHelpers.classPrivateFieldLooseBase(this,y)[y](a,e,i);const r=l.DesktopManager.isChatWindow()&&document.hasFocus();if(r){s.Notifier.notifyViaBrowserProvider(o)}else{s.Notifier.notify(o)}}}function $(e,s,i){var a;const o={id:`${f}-${s.id}`,title:e,icon:i?i.avatar:"",text:r.Parser.purifyNotification(s)};if(s.sectionCode===c.NotificationTypesCodes.confirm){const[e,i]=s.notifyButtons;o.button1Text=e.TEXT;o.button2Text=i.TEXT}else if(((a=s.params)==null?void 0:a.canAnswer)==="Y"){o.inputPlaceholderText=t.Loc.getMessage("IM_LIB_NOTIFIER_NOTIFY_REPLY_PLACEHOLDER")}return o}function x(){s.Notifier.subscribe("click",(e=>{babelHelpers.classPrivateFieldLooseBase(this,H)[H](e.getData())}));s.Notifier.subscribe("action",(e=>{babelHelpers.classPrivateFieldLooseBase(this,g)[g](e.getData())}))}function E(e){const{id:s}=e;if(babelHelpers.classPrivateFieldLooseBase(this,I)[I](s)){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T](s);n.Messenger.openChat(e)}else if(babelHelpers.classPrivateFieldLooseBase(this,C)[C](s)){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T](s);n.Messenger.openCopilot(e)}else if(babelHelpers.classPrivateFieldLooseBase(this,X)[X](s)){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T](s);n.Messenger.openLines(e)}else if(babelHelpers.classPrivateFieldLooseBase(this,j)[j](s)){n.Messenger.openNotifications()}}function k(e){const{id:s,action:i,userInput:t}=e;if(!babelHelpers.classPrivateFieldLooseBase(this,j)[j](s)){return}const a=babelHelpers.classPrivateFieldLooseBase(this,m)[m](s);const o=babelHelpers.classPrivateFieldLooseBase(this,L)[L].getters["notifications/getById"](a);if(t){babelHelpers.classPrivateFieldLooseBase(this,M)[M](o,t)}else if(babelHelpers.classPrivateFieldLooseBase(this,K)[K](i,o)){babelHelpers.classPrivateFieldLooseBase(this,N)[N](i,o)}}function D(e,s){babelHelpers.classPrivateFieldLooseBase(this,B)[B].sendQuickAnswer({id:e.id,text:s})}function S(e,s){const[i,t]=s.notifyButtons;const a=babelHelpers.classPrivateFieldLooseBase(this,w)[w](e);if(a===P.first){babelHelpers.classPrivateFieldLooseBase(this,O)[O](s,i)}else if(a===P.second){babelHelpers.classPrivateFieldLooseBase(this,O)[O](s,t)}}function W(e,s){const[i,t]=babelHelpers.classPrivateFieldLooseBase(this,_)[_](s);babelHelpers.classPrivateFieldLooseBase(this,B)[B].sendConfirmAction(i,t)}function R(e){return e.startsWith(v)}function Y(e){return e.startsWith(d)}function V(e){return e.startsWith(p)}function Q(e){return e.startsWith(f)}function U(e,s){const i=s.sectionCode;return e.startsWith(u)&&i===c.NotificationTypesCodes.confirm}function q(e){return e.split("-")[2]}function z(e){return e.split("-")[2]}function G(e){return e.split("_")[1]}function J(e){return e.COMMAND_PARAMS.split("|")}Object.defineProperty(A,h,{writable:true,value:void 0});e.NotifierManager=A})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.UI.NotificationManager,BX.Vue3.Vuex,BX,BX.Event,BX.Messenger.v2.Application,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Const,BX.Messenger.v2.Service);
//# sourceMappingURL=notifier.bundle.map.js