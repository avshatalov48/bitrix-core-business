this.BX=this.BX||{};(function(e,t,r,n,a){"use strict";(function(e){if(!e.BX){e.BX={}}if(!e.BX.Main){e.BX.Main={}}else if(e.BX.Main.Date){return}var t=e.BX;t.Main.Date={AM_PM_MODE:{UPPER:1,LOWER:2,NONE:false},format:function e(t,n,a,i){var s=this;var u=r.isDate(n)?new Date(n.getTime()):r.isNumber(n)?new Date(n*1e3):new Date;var _=r.isDate(a)?new Date(a.getTime()):r.isNumber(a)?new Date(a*1e3):new Date;var o=!!i;if(r.isArray(t))return g(t,u,_,o);else if(!r.isNotEmptyString(t))return"";var f=(t.match(/{{([^{}]*)}}/g)||[]).map(function(e){return(e.match(/[^{}]+/)||[""])[0]});if(f.length>0){f.forEach(function(e,r){t=t.replace("{{"+e+"}}","{{"+r+"}}")})}var D=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|sshort|ishort|Hshort|dshort|mhort|Yshort|yesterday|today|tommorow|tomorrow|[a-z])/gi;var l={d:function e(){return r.strPadLeft(O(u).toString(),2,"0")},D:function e(){return s._getMessage("DOW_"+v(u))},j:function e(){return O(u)},l:function e(){return s._getMessage("DAY_OF_WEEK_"+v(u))},N:function e(){return v(u)||7},S:function e(){if(O(u)%10==1&&O(u)!=11)return"st";else if(O(u)%10==2&&O(u)!=12)return"nd";else if(O(u)%10==3&&O(u)!=13)return"rd";else return"th"},w:function e(){return v(u)},z:function e(){var t=new Date(T(u),0,1);var r=new Date(T(u),F(u),O(u));return Math.ceil((r-t)/(24*3600*1e3))},W:function e(){var t=new Date(u.getTime());var n=(v(u)+6)%7;p(t,O(t)-n+3);var a=t.getTime();h(t,0,1);if(v(t)!=4)h(t,0,1+(4-v(t)+7)%7);var i=1+Math.ceil((a-t)/(7*24*3600*1e3));return r.strPadLeft(i.toString(),2,"0")},F:function e(){return s._getMessage("MONTH_"+(F(u)+1)+"_S")},f:function e(){return s._getMessage("MONTH_"+(F(u)+1))},m:function e(){return r.strPadLeft((F(u)+1).toString(),2,"0")},M:function e(){return s._getMessage("MON_"+(F(u)+1))},n:function e(){return F(u)+1},t:function e(){var t=o?new Date(Date.UTC(T(u),F(u)+1,0)):new Date(T(u),F(u)+1,0);return O(t)},L:function e(){var t=T(u);return t%4==0&&t%100!=0||t%400==0?1:0},o:function e(){var t=new Date(u.getTime());p(t,O(t)-(v(u)+6)%7+3);return T(t)},Y:function e(){return T(u)},y:function e(){return T(u).toString().slice(2)},a:function e(){return E(u)>11?"pm":"am"},A:function e(){return E(u)>11?"PM":"AM"},B:function e(){var t=(u.getUTCHours()+1)%24+u.getUTCMinutes()/60+u.getUTCSeconds()/3600;return r.strPadLeft(Math.floor(t*1e3/24).toString(),3,"0")},g:function e(){return E(u)%12||12},G:function e(){return E(u)},h:function e(){return r.strPadLeft((E(u)%12||12).toString(),2,"0")},H:function e(){return r.strPadLeft(E(u).toString(),2,"0")},i:function e(){return r.strPadLeft(m(u).toString(),2,"0")},s:function e(){return r.strPadLeft(d(u).toString(),2,"0")},u:function e(){return r.strPadLeft((A(u)*1e3).toString(),6,"0")},e:function e(){if(o)return"UTC";return""},I:function e(){if(o)return 0;var t=new Date(T(u),0,1);var r=Date.UTC(T(u),0,1);var n=new Date(T(u),6,0);var a=Date.UTC(T(u),6,0);return 0+(t-r!==n-a)},O:function e(){if(o)return"+0000";var t=u.getTimezoneOffset();var n=Math.abs(t);return(t>0?"-":"+")+r.strPadLeft((Math.floor(n/60)*100+n%60).toString(),4,"0")},P:function e(){if(o)return"+00:00";var t=this.O();return t.substr(0,3)+":"+t.substr(3)},Z:function e(){if(o)return 0;return-u.getTimezoneOffset()*60},c:function e(){return"Y-m-d\\TH:i:sP".replace(D,I)},r:function e(){return"D, d M Y H:i:s O".replace(D,I)},U:function e(){return Math.floor(u.getTime()/1e3)},sago:function e(){return H(S((_-u)/1e3),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function e(){return H(S((_-u)/1e3),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},sshort:function e(){return s._getMessage("FD_SECOND_SHORT").replace(/#VALUE#/g,S((_-u)/1e3))},iago:function e(){return H(S((_-u)/60/1e3),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function e(){return H(S((_-u)/60/1e3),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function e(){var t=S((_-u)/60/1e3);var r=H(t,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});r+=" ";var n=S((_-u)/1e3)-t*60;r+=H(n,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return r},ishort:function e(){return s._getMessage("FD_MINUTE_SHORT").replace(/#VALUE#/g,S((_-u)/60/1e3))},Hago:function e(){return H(S((_-u)/60/60/1e3),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function e(){return H(S((_-u)/60/60/1e3),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},Hshort:function e(){return s._getMessage("FD_HOUR_SHORT").replace(/#VALUE#/g,S((_-u)/60/60/1e3))},yesterday:function e(){return s._getMessage("FD_YESTERDAY")},today:function e(){return s._getMessage("FD_TODAY")},tommorow:function e(){return s._getMessage("FD_TOMORROW")},tomorrow:function e(){return s._getMessage("FD_TOMORROW")},dago:function e(){return H(S((_-u)/60/60/24/1e3),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function e(){return H(S((_-u)/60/60/24/1e3),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},dshort:function e(){return s._getMessage("FD_DAY_SHORT").replace(/#VALUE#/g,S((_-u)/60/60/24/1e3))},mago:function e(){return H(S((_-u)/60/60/24/31/1e3),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function e(){return H(S((_-u)/60/60/24/31/1e3),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},mshort:function e(){return s._getMessage("FD_MONTH_SHORT").replace(/#VALUE#/g,S((_-u)/60/60/24/31/1e3))},Yago:function e(){return H(S((_-u)/60/60/24/365/1e3),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function e(){return H(S((_-u)/60/60/24/365/1e3),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},Yshort:function e(){return H(S((_-u)/60/60/24/365/1e3),{0:"FD_YEARS_SHORT_0",1:"FD_YEARS_SHORT_1","10_20":"FD_YEARS_SHORT_10_20",MOD_1:"FD_YEARS_SHORT_MOD_1",MOD_2_4:"FD_YEARS_SHORT_MOD_2_4",MOD_OTHER:"FD_YEARS_SHORT_MOD_OTHER"})},x:function e(){var t=s.isAmPmMode(true);var r=t===s.AM_PM_MODE.LOWER?"g:i a":t===s.AM_PM_MODE.UPPER?"g:i A":"H:i";return s.format([["tomorrow","tomorrow, "+r],["-",s.convertBitrixFormat(s._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s","sago"],["i","iago"],["today","today, "+r],["yesterday","yesterday, "+r],["",s.convertBitrixFormat(s._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")]],u,_,o)},X:function e(){var t=s.isAmPmMode(true);var r=t===s.AM_PM_MODE.LOWER?"g:i a":t===s.AM_PM_MODE.UPPER?"g:i A":"H:i";var n=s.format([["tomorrow","tomorrow"],["-",s.convertBitrixFormat(s._getMessage("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",s.convertBitrixFormat(s._getMessage("FORMAT_DATE"))]],u,_,o);var a=s.format([["tomorrow",r],["today",r],["yesterday",r],["",""]],u,_,o);if(a.length>0)return s._getMessage("FD_DAY_AT_TIME").replace(/#DAY#/g,n).replace(/#TIME#/g,a);else return n},Q:function e(){var t=S((_-u)/60/60/24/1e3);if(t==0)return s._getMessage("FD_DAY_DIFF_1").replace(/#VALUE#/g,1);else return s.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],u,_)}};var M=false;if(t[0]&&t[0]=="^"){M=true;t=t.substr(1)}var c=t.replace(D,I);if(M){c=c.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}if(f.length>0){f.forEach(function(e,t){c=c.replace("{{"+t+"}}",e)})}return c;function g(e,t,r,n){var a=S((r-t)/1e3);for(var i=0;i<e.length;i++){var u=e[i][0];var _=e[i][1];var o=null;if(u=="s"){if(a<60)return s.format(_,t,r,n)}else if((o=/^s(\d+)\>?(\d+)?/.exec(u))!=null){if(o[1]&&o[2]){if(a<o[1]&&a>o[2]){return s.format(_,t,r,n)}}else if(a<o[1]){return s.format(_,t,r,n)}}else if(u=="i"){if(a<60*60)return s.format(_,t,r,n)}else if((o=/^i(\d+)\>?(\d+)?/.exec(u))!=null){if(o[1]&&o[2]){if(a<o[1]*60&&a>o[2]*60){return s.format(_,t,r,n)}}else if(a<o[1]*60){return s.format(_,t,r,n)}}else if(u=="H"){if(a<24*60*60)return s.format(_,t,r,n)}else if((o=/^H(\d+)\>?(\d+)?/.exec(u))!=null){if(o[1]&&o[2]){if(a<o[1]*60*60&&a>o[2]*60*60){return s.format(_,t,r,n)}}else if(a<o[1]*60*60){return s.format(_,t,r,n)}}else if(u=="d"){if(a<31*24*60*60)return s.format(_,t,r,n)}else if((o=/^d(\d+)\>?(\d+)?/.exec(u))!=null){if(o[1]&&o[2]){if(a<o[1]*24*60*60&&a>o[2]*24*60*60){return s.format(_,t,r,n)}}else if(a<o[1]*24*60*60){return s.format(_,t,r,n)}}else if(u=="m"){if(a<365*24*60*60)return s.format(_,t,r,n)}else if((o=/^m(\d+)\>?(\d+)?/.exec(u))!=null){if(o[1]&&o[2]){if(a<o[1]*31*24*60*60&&a>o[2]*31*24*60*60){return s.format(_,t,r,n)}}else if(a<o[1]*31*24*60*60){return s.format(_,t,r,n)}}else if(u=="now"){if(t.getTime()==r.getTime()){return s.format(_,t,r,n)}}else if(u=="today"){var f=T(r),D=F(r),l=O(r);var M=n?new Date(Date.UTC(f,D,l,0,0,0,0)):new Date(f,D,l,0,0,0,0);var c=n?new Date(Date.UTC(f,D,l+1,0,0,0,0)):new Date(f,D,l+1,0,0,0,0);if(t>=M&&t<c)return s.format(_,t,r,n)}else if(u=="todayFuture"){var f=T(r),D=F(r),l=O(r);var M=r.getTime();var c=n?new Date(Date.UTC(f,D,l+1,0,0,0,0)):new Date(f,D,l+1,0,0,0,0);if(t>=M&&t<c)return s.format(_,t,r,n)}else if(u=="yesterday"){f=T(r);D=F(r);l=O(r);var g=n?new Date(Date.UTC(f,D,l-1,0,0,0,0)):new Date(f,D,l-1,0,0,0,0);var E=n?new Date(Date.UTC(f,D,l,0,0,0,0)):new Date(f,D,l,0,0,0,0);if(t>=g&&t<E)return s.format(_,t,r,n)}else if(u=="tommorow"||u=="tomorrow"){f=T(r);D=F(r);l=O(r);var m=n?new Date(Date.UTC(f,D,l+1,0,0,0,0)):new Date(f,D,l+1,0,0,0,0);var d=n?new Date(Date.UTC(f,D,l+2,0,0,0,0)):new Date(f,D,l+2,0,0,0,0);if(t>=m&&t<d)return s.format(_,t,r,n)}else if(u=="-"){if(a<0)return s.format(_,t,r,n)}}return e.length>0?s.format(e[e.length-1][1],t,r,n):""}function T(e){return o?e.getUTCFullYear():e.getFullYear()}function O(e){return o?e.getUTCDate():e.getDate()}function F(e){return o?e.getUTCMonth():e.getMonth()}function E(e){return o?e.getUTCHours():e.getHours()}function m(e){return o?e.getUTCMinutes():e.getMinutes()}function d(e){return o?e.getUTCSeconds():e.getSeconds()}function A(e){return o?e.getUTCMilliseconds():e.getMilliseconds()}function v(e){return o?e.getUTCDay():e.getDay()}function p(e,t){return o?e.setUTCDate(t):e.setDate(t)}function h(e,t,r){return o?e.setUTCMonth(t,r):e.setMonth(t,r)}function H(e,t){var r=e<100?Math.abs(e):Math.abs(e%100);var n=r%10;var a="";if(r==0)a=s._getMessage(t["0"]);else if(r==1)a=s._getMessage(t["1"]);else if(r>=10&&r<=20)a=s._getMessage(t["10_20"]);else if(n==1)a=s._getMessage(t["MOD_1"]);else if(2<=n&&n<=4)a=s._getMessage(t["MOD_2_4"]);else a=s._getMessage(t["MOD_OTHER"]);return a.replace(/#VALUE#/g,e)}function I(e,t){if(l[e])return l[e]();else return t}function S(e){return e>=0?Math.floor(e):Math.ceil(e)}},convertBitrixFormat:function e(t){if(!r.isNotEmptyString(t))return"";return t.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")},convertToUTC:function e(t){if(!r.isDate(t))return null;return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))},getNewDate:function e(t){return new Date(this.getBrowserTimestamp(t))},getBrowserTimestamp:function e(t){t=parseInt(t,10);var r=new Date(t*1e3).getTimezoneOffset()*60;return(parseInt(t,10)+parseInt(this._getMessage("SERVER_TZ_OFFSET"))+r)*1e3},getServerTimestamp:function e(t){t=parseInt(t,10);var r=new Date(t).getTimezoneOffset()*60;return Math.round(t/1e3-(parseInt(this._getMessage("SERVER_TZ_OFFSET"),10)+parseInt(r,10)))},formatLastActivityDate:function e(t,r,n){var a=this.isAmPmMode(true);var i=a===this.AM_PM_MODE.LOWER?"g:i a":a===this.AM_PM_MODE.UPPER?"g:i A":"H:i";var s=[["tomorrow","#01#"+i],["now","#02#"],["todayFuture","#03#"+i],["yesterday","#04#"+i],["-",this.convertBitrixFormat(this._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s60","sago"],["i60","iago"],["H5","Hago"],["H24","#03#"+i],["d31","dago"],["m12>1","mago"],["m12>0","dago"],["","#05#"]];var u=this.format(s,t,r,n);var _=null;if((_=/^#(\d+)#(.*)/.exec(u))!=null){switch(_[1]){case"01":u=this._getMessage("FD_LAST_SEEN_TOMORROW").replace("#TIME#",_[2]);break;case"02":u=this._getMessage("FD_LAST_SEEN_NOW");break;case"03":u=this._getMessage("FD_LAST_SEEN_TODAY").replace("#TIME#",_[2]);break;case"04":u=this._getMessage("FD_LAST_SEEN_YESTERDAY").replace("#TIME#",_[2]);break;case"05":u=this._getMessage("FD_LAST_SEEN_MORE_YEAR");break;default:u=_[2];break}}return u},isAmPmMode:function e(t){if(t===true){return this._getMessage("AMPM_MODE")}return this._getMessage("AMPM_MODE")!==false},_getMessage:function e(r){return t.message(r)},parse:function e(t,n,a,i){if(r.isNotEmptyString(t)){if(!a)a=this._getMessage("FORMAT_DATE");if(!i)i=this._getMessage("FORMAT_DATETIME");var s="";for(f=1;f<=12;f++){s=s+"|"+this._getMessage("MON_"+f)}var u=new RegExp("([0-9]+|[a-z]+"+s+")","ig"),_=t.match(u),o=a.match(/(DD|MI|MMMM|MM|M|YYYY)/gi),f,D,l=[],M=[],c={};if(!_){return null}if(_.length>o.length){o=i.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(f=0,D=_.length;f<D;f++){if(_[f].trim()!==""){l[l.length]=_[f]}}for(f=0,D=o.length;f<D;f++){if(o[f].trim()!==""){M[M.length]=o[f]}}var g=r.array_search("MMMM",M);if(g>0){l[g]=this.getMonthIndex(l[g]);M[g]="MM"}else{g=r.array_search("M",M);if(g>0){l[g]=this.getMonthIndex(l[g]);M[g]="MM"}}for(f=0,D=M.length;f<D;f++){var T=M[f].toUpperCase();c[T]=T==="T"||T==="TT"?l[f]:parseInt(l[f],10)}if(c["DD"]>0&&c["MM"]>0&&c["YYYY"]>0){var O=new Date;if(n){O.setUTCDate(1);O.setUTCFullYear(c["YYYY"]);O.setUTCMonth(c["MM"]-1);O.setUTCDate(c["DD"]);O.setUTCHours(0,0,0,0)}else{O.setDate(1);O.setFullYear(c["YYYY"]);O.setMonth(c["MM"]-1);O.setDate(c["DD"]);O.setHours(0,0,0,0)}if((!isNaN(c["HH"])||!isNaN(c["GG"])||!isNaN(c["H"])||!isNaN(c["G"]))&&!isNaN(c["MI"])){if(!isNaN(c["H"])||!isNaN(c["G"])){var F=(c["T"]||c["TT"]||"am").toUpperCase()==="PM",E=parseInt(c["H"]||c["G"]||0,10);if(F){c["HH"]=E+(E===12?0:12)}else{c["HH"]=E<12?E:0}}else{c["HH"]=parseInt(c["HH"]||c["GG"]||0,10)}if(isNaN(c["SS"]))c["SS"]=0;if(n){O.setUTCHours(c["HH"],c["MI"],c["SS"])}else{O.setHours(c["HH"],c["MI"],c["SS"])}}return O}}return null},getMonthIndex:function e(t){var r,n=t.toUpperCase(),a=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],i=["january","february","march","april","may","june","july","august","september","october","november","december"];for(r=1;r<=12;r++){if(n===this._getMessage("MON_"+r).toUpperCase()||n===this._getMessage("MONTH_"+r).toUpperCase()||n===a[r-1].toUpperCase()||n===i[r-1].toUpperCase()){return r}}return t}};var r={isDate:function e(t){return t&&Object.prototype.toString.call(t)=="[object Date]"},isNumber:function e(t){return t===0?true:t?typeof t=="number"||t instanceof Number:false},isArray:function e(t){return t&&Object.prototype.toString.call(t)=="[object Array]"},isString:function e(t){return t===""?true:t?typeof t=="string"||t instanceof String:false},isNotEmptyString:function e(t){return this.isString(t)?t.length>0:false},strPadLeft:function e(t,r,n){var a=t.length,i=n.length;if(a>=r)return t;for(;a<r;a+=i){t=n+t}return t},array_search:function e(t,r){for(var n=0;n<r.length;n++){if(r[n]==t)return n}return-1}}})(window);function i(){var e=babelHelpers.taggedTemplateLiteral(['\n\t\t<div class="','">\n\t\t\t<svg class="calendar-loader-circular"\n\t\t\t\tstyle="width:',"px; height:",'px;"\n\t\t\t\tviewBox="25 25 50 50">\n\t\t\t\t\t<circle class="calendar-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t\t\t<circle class="calendar-loader-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n\t\t\t</svg>\n\t\t</div>\n']);i=function t(){return e};return e}var s=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"parseTime",value:function t(r){var n=e.parseDate1(BX.date.format(e.getDateFormat(),new Date)+" "+r,false);return n?{h:n.getHours(),m:n.getMinutes()}:n}},{key:"getTimeRounded",value:function e(t){return Math.round(t.getTime()/6e4)*6e4}},{key:"parseDate",value:function e(t,r,n,a){return BX.parseDate(t,r,n,a)}},{key:"parseDate1",value:function e(r,n,a){var i,s,u,_;if(!n)n=t.Loc.getMessage("FORMAT_DATETIME");r=BX.util.trim(r);if(a!==false)n=n.replace(":SS","");if(BX.type.isNotEmptyString(r)){_="";for(i=1;i<=12;i++){_=_+"|"+t.Loc.getMessage("MON_"+i)}var o=new RegExp("([0-9]+|[a-z]+"+_+")","ig"),f=r.match(o),D=t.Loc.getMessage("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),l=[],M=[],c={};if(!f){return null}if(f.length>D.length){D=n.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(i=0,s=f.length;i<s;i++){if(BX.util.trim(f[i])!==""){l[l.length]=f[i]}}for(i=0,s=D.length;i<s;i++){if(BX.util.trim(D[i])!=""){M[M.length]=D[i]}}var g=BX.util.array_search("MMMM",M);if(g>0){l[g]=BX.getNumMonth(l[g]);M[g]="MM"}else{g=BX.util.array_search("M",M);if(g>0){l[g]=BX.getNumMonth(l[g]);M[g]="MM"}}for(i=0,s=M.length;i<s;i++){u=M[i].toUpperCase();c[u]=u=="T"||u=="TT"?l[i]:parseInt(l[i],10)}if(c["DD"]>0&&c["MM"]>0&&c["YYYY"]>0){var T=new Date;{T.setDate(1);T.setFullYear(c["YYYY"]);T.setMonth(c["MM"]-1);T.setDate(c["DD"]);T.setHours(0,0,0)}if((!isNaN(c["HH"])||!isNaN(c["GG"])||!isNaN(c["H"])||!isNaN(c["G"]))&&!isNaN(c["MI"])){if(!isNaN(c["H"])||!isNaN(c["G"])){var O=(c["T"]||c["TT"]||"am").toUpperCase()=="PM";var F=parseInt(c["H"]||c["G"]||0,10);if(O){c["HH"]=F+(F==12?0:12)}else{c["HH"]=F<12?F:0}}else{c["HH"]=parseInt(c["HH"]||c["GG"]||0,10)}if(isNaN(c["SS"]))c["SS"]=0;{T.setHours(c["HH"],c["MI"],c["SS"])}}return T}}return null}},{key:"formatTime",value:function r(n,a,i){var s=null;if(t.Type.isDate(n)){s=n}else{s=new Date;s.setHours(n,a,0)}return BX.date.format(e.getTimeFormatShort(),s.getTime()/1e3)}},{key:"formatDate",value:function r(n){if(t.Type.isDate(n)){n=n.getTime()}return BX.date.format(e.getDateFormat(),n/1e3)}},{key:"formatDateTime",value:function r(n){if(t.Type.isDate(n)){n=n.getTime()}return BX.date.format(e.getDateTimeFormat(),n/1e3)}},{key:"formatDateUsable",value:function r(n){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var s=t.Loc.getMessage("LANGUAGE_ID"),u=e.getDateFormat();if(s==="ru"||s==="ua"){u=i?"l, j F":"j F";if(n.getFullYear&&n.getFullYear()!==(new Date).getFullYear()&&a!==false){u+=" Y"}}return BX.date.format([["today","today"],["tommorow","tommorow"],["yesterday","yesterday"],["",u]],n)}},{key:"getDayLength",value:function t(){if(!e.DAY_LENGTH){e.DAY_LENGTH=864e5}return e.DAY_LENGTH}},{key:"getDefaultColorList",value:function e(){return["#86b100","#0092cc","#00afc7","#da9100","#00b38c","#de2b24","#bd7ac9","#838fa0","#ab7917","#e97090"]}},{key:"findTargetNode",value:function e(t,r){var n=false;if(t){var a="data-bx-calendar",i;if(t.attributes&&t.attributes.length){for(i=0;i<t.attributes.length;i++){if(t.attributes[i].name&&t.attributes[i].name.substr(0,a.length)===a){n=t;break}}}if(!n){n=BX.findParent(t,function(e){var t;if(e.attributes&&e.attributes.length){for(t=0;t<e.attributes.length;t++){if(e.attributes[t].name&&e.attributes[t].name.substr(0,a.length)===a)return true}}return false},r)}}return n}},{key:"getFollowedUserList",value:function e(t){return[]}},{key:"getWeekDayByInd",value:function e(t){return["SU","MO","TU","WE","TH","FR","SA"][t]}},{key:"getLoader",value:function e(r,n){return t.Tag.render(i(),n||"calendar-loader",parseInt(r),parseInt(r))}},{key:"getDayCode",value:function e(t){return t.getFullYear()+"-"+("0"+~~(t.getMonth()+1)).substr(-2,2)+"-"+("0"+~~t.getDate()).substr(-2,2)}},{key:"getTextColor",value:function e(t){if(!t){return false}if(t.charAt(0)==="#"){t=t.substring(1,7)}var r=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),a=parseInt(t.substring(4,6),16),i=(r*.8+n+a*.2)/510*100;return i<50}},{key:"getKeyCode",value:function e(r){if(!t.Type.isString(r)){return false}var n={backspace:8,enter:13,escape:27,space:32,delete:46,left:37,right:39,up:38,down:40,z:90,y:89,shift:16,ctrl:17,alt:18,cmd:91,cmdRight:93,pageUp:33,pageDown:34,d:68,w:87,m:77,a:65};return n[r.toLowerCase()]}},{key:"getUsableDateTime",value:function e(r,n){if(t.Type.isDate(r))r=r.getTime();var a=(n||10)*60*1e3;r=Math.ceil(r/a)*a;return new Date(r)}},{key:"showNotification",value:function e(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(t.Type.isString(r)&&r!==""){BX.UI.Notification.Center.notify({content:r,actions:n})}}},{key:"showFieldError",value:function e(r,n,a){if(t.Type.isDomNode(n)&&t.Type.isString(r)&&r!==""){t.Dom.remove(n.querySelector(".ui-alert"));var i=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,text:r});var s=i.getContainer();n.appendChild(s)}}},{key:"getDateFormat",value:function r(){if(!e.DATE_FORMAT){e.DATE_FORMAT=BX.Main.Date.convertBitrixFormat(t.Loc.getMessage("FORMAT_DATE"))}return e.DATE_FORMAT}},{key:"getDateTimeFormat",value:function r(){if(!e.DATETIME_FORMAT){e.DATETIME_FORMAT=BX.Main.Date.convertBitrixFormat(t.Loc.getMessage("FORMAT_DATETIME"))}return e.DATETIME_FORMAT}},{key:"getTimeFormat",value:function r(){if(!e.TIME_FORMAT){if(t.Loc.getMessage("FORMAT_DATETIME").substr(0,t.Loc.getMessage("FORMAT_DATE").length)===t.Loc.getMessage("FORMAT_DATE")){e.TIME_FORMAT=BX.util.trim(e.getDateTimeFormat().substr(e.getDateFormat().length));e.TIME_FORMAT_BX=BX.util.trim(t.Loc.getMessage("FORMAT_DATETIME").substr(t.Loc.getMessage("FORMAT_DATE").length))}else{e.TIME_FORMAT_BX=BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS";e.TIME_FORMAT=BX.date.convertBitrixFormat(BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS")}}return e.TIME_FORMAT}},{key:"getTimeFormatShort",value:function t(){if(!e.TIME_FORMAT_SHORT){e.TIME_FORMAT_SHORT=e.getTimeFormat().replace(":s","");e.TIME_FORMAT_SHORT_BX=e.TIME_FORMAT_BX.replace(":SS","")}return e.TIME_FORMAT_SHORT}},{key:"getCurrentUserId",value:function r(){if(!e.currentUserId){e.currentUserId=parseInt(t.Loc.getMessage("USER_ID"))}return e.currentUserId}},{key:"getTimeByInt",value:function e(t){t=parseInt(t);var r=Math.floor(t/60);return{hour:r,min:t-r*60}}},{key:"preventSelection",value:function e(t){t.ondrag=BX.False;t.ondragstart=BX.False;t.onselectstart=BX.False}},{key:"getBX",value:function e(){return window.top.BX||window.BX}},{key:"closeAllPopups",value:function e(){if(n.PopupManager.isAnyPopupShown()){for(var t=0,r=n.PopupManager._popups.length;t<r;t++){if(n.PopupManager._popups[t]&&n.PopupManager._popups[t].isShown()){n.PopupManager._popups[t].close()}}}}},{key:"sendAnalyticLabel",value:function e(t){BX.ajax.runAction("calendar.api.calendarajax.sendAnalyticsLabel",{analyticsLabel:t})}},{key:"setOptions",value:function t(r,n){e.config=r;e.additionalParams=n}},{key:"setUserSettings",value:function t(r){e.userSettings=r}},{key:"getUserSettings",value:function r(){return t.Type.isObjectLike(e.userSettings)?e.userSettings:{}}},{key:"setCalendarContext",value:function t(r){e.calendarContext=r}},{key:"getCalendarContext",value:function t(){return e.calendarContext||null}},{key:"getMeetingStatusList",value:function e(){return["Y","N","Q","H"]}},{key:"checkEmailLimitationPopup",value:function t(){var r=e.getEventWithEmailGuestAmount();var n=e.getEventWithEmailGuestLimit();return n>0&&(r===8||r===4||r>=n)}},{key:"isEventWithEmailGuestAllowed",value:function t(){return e.getEventWithEmailGuestLimit()===-1||e.getEventWithEmailGuestAmount()<e.getEventWithEmailGuestLimit()}},{key:"setEventWithEmailGuestAmount",value:function t(r){e.countEventWithEmailGuestAmount=r}},{key:"setEventWithEmailGuestLimit",value:function t(r){e.eventWithEmailGuestLimit=r}},{key:"getEventWithEmailGuestAmount",value:function t(){return e.countEventWithEmailGuestAmount}},{key:"getEventWithEmailGuestLimit",value:function t(){return e.eventWithEmailGuestLimit}},{key:"setCurrentView",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;e.currentCalendarView=r}},{key:"getCurrentView",value:function t(){return e.currentCalendarView||null}},{key:"adjustDateForTimezoneOffset",value:function e(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!t.Type.isDate(r))throw new Error("Wrong type for date attribute. DateTime object expected.");if(!parseInt(n)||a===true)return r;return new Date(r.getTime()-parseInt(n)*1e3)}},{key:"randomInt",value:function e(t,r){return Math.round(t-.5+Math.random()*(r-t+1))}},{key:"getRandomColor",value:function t(){var r=e.getDefaultColorList();return r[e.randomInt(0,r.length-1)]}},{key:"setAccessNames",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};e.accessNames={};for(var n in r){if(r.hasOwnProperty(n)){e.setAccessName(n,r[n])}}}},{key:"getAccessName",value:function t(r){return e.accessNames[r]||r}},{key:"setAccessName",value:function t(r,n){e.accessNames[r]=n}},{key:"getRandomInt",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:6;return Math.round(Math.random()*Math.pow(10,t))}},{key:"displayError",value:function e(r,n){if(t.Type.isArray(r)){var a="";for(var i=0;i<r.length;i++){a+=r[i].message+"\n"}r=a}setTimeout(function(){alert(r||"[Bitrix Calendar] Request error");if(n){location.reload()}},200)}},{key:"convertEntityToAccessCode",value:function e(r){if(t.Type.isObjectLike(r)){if(r.entityId==="meta-user"&&r.id==="all-users"){return"UA"}else if(r.entityId==="user"){return"U"+r.id}else if(r.entityId==="project"){return"SG"+r.id}else if(r.entityId==="department"){return"DR"+r.id}}}},{key:"extendPlannerWatches",value:function t(r){var n=r.entries,i=r.userId;n.forEach(function(t){if(t.type==="user"&&parseInt(t.id)!==parseInt(i)){var r=e.PLANNER_PULL_TAG.replace("#USER_ID#",t.id);if(!e.PLANNER_WATCH_LIST.includes(r)){a.PULL.extendWatch(r);e.PLANNER_WATCH_LIST.push(r)}}})}},{key:"clearPlannerWatches",value:function t(){e.PLANNER_WATCH_LIST.forEach(function(e){a.PULL.clearWatch(e)});e.PLANNER_WATCH_LIST=[]}},{key:"registerRequestId",value:function t(){var r=BX.Calendar.Util.getRandomInt(8);e.REQUEST_ID_LIST.push(r);return r}},{key:"unregisterRequestId",value:function t(r){e.REQUEST_ID_LIST=e.REQUEST_ID_LIST.filter(function(e){return e!==r})}},{key:"checkRequestId",value:function r(n){n=parseInt(n);return!t.Type.isInteger(n)||!e.REQUEST_ID_LIST.includes(n)}}]);return e}();babelHelpers.defineProperty(s,"PLANNER_PULL_TAG","calendar-planner-#USER_ID#");babelHelpers.defineProperty(s,"PLANNER_WATCH_LIST",[]);babelHelpers.defineProperty(s,"REQUEST_ID_LIST",[]);babelHelpers.defineProperty(s,"accessNames",{});e.Util=s})(this.BX.Calendar=this.BX.Calendar||{},BX,BX,BX.Main,BX);
//# sourceMappingURL=util.bundle.map.js