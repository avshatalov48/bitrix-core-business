{"version":3,"file":"registry.bundle.js","sources":["../src/add-to-chat/add-to-chat-content.js","../src/add-to-chat/add-to-chat.js","../src/forward-popup/forward-content.js","../src/forward-popup/forward-popup.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { ChatService } from 'im.v2.provider.service';\nimport { ChatType, EventType, SearchEntityIdTypes } from 'im.v2.const';\nimport { ChatSearch } from 'im.v2.component.search.chat-search';\nimport { Button as MessengerButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\nimport { ChannelManager } from 'im.v2.lib.channel';\n\nimport './add-to-chat-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelUser } from 'im.v2.model';\n\nconst searchConfig = Object.freeze({\n\tchats: false,\n\tusers: true,\n});\n\nconst SEARCH_ENTITY_ID = 'user';\n\n// @vue/component\nexport const AddToChatContent = {\n\tname: 'AddToChatContent',\n\tcomponents: { ChatSearch, MessengerButton },\n\tprops: {\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tshowHistory: true,\n\t\t\tisLoading: false,\n\t\t\tselectedItems: new Set(),\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tsearchConfig: () => searchConfig,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn this.dialog.type !== ChatType.user;\n\t\t},\n\t\tisChannel(): boolean\n\t\t{\n\t\t\treturn ChannelManager.isChannel(this.dialogId);\n\t\t},\n\t\tshowHistoryOption(): boolean\n\t\t{\n\t\t\treturn this.isChat && !this.isChannel;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.chatService = new ChatService();\n\t\tthis.membersSelector = this.getTagSelector();\n\t},\n\tmounted()\n\t{\n\t\tthis.membersSelector.renderTo(this.$refs['tag-selector']);\n\t\tthis.membersSelector.focusTextBox();\n\t},\n\tmethods:\n\t{\n\t\tgetTagSelector(): TagSelector\n\t\t{\n\t\t\tlet timeoutId = null;\n\n\t\t\treturn new TagSelector({\n\t\t\t\tmaxHeight: 111,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tshowTextBox: true,\n\t\t\t\taddButtonCaption: this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MSGVER_1'),\n\t\t\t\taddButtonCaptionMore: this.loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MORE'),\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonBeforeTagAdd: () => {\n\t\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\t},\n\t\t\t\t\tonAfterTagAdd: (event) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tthis.selectedItems.add(tag.id);\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t\tonKeyUp: (event) => {\n\t\t\t\t\t\tconst { event: keyboardEvent } = event.getData();\n\t\t\t\t\t\tEventEmitter.emit(EventType.search.keyPressed, { keyboardEvent });\n\t\t\t\t\t},\n\t\t\t\t\tonBeforeTagRemove: () => {\n\t\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\t},\n\t\t\t\t\tonAfterTagRemove: (event) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tthis.selectedItems.delete(tag.id);\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t\tonInput: () => {\n\t\t\t\t\t\tthis.searchQuery = this.membersSelector.getTextBoxValue();\n\t\t\t\t\t},\n\t\t\t\t\tonBlur: () => {\n\t\t\t\t\t\tconst inputText = this.membersSelector.getTextBoxValue();\n\t\t\t\t\t\tif (inputText.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimeoutId = setTimeout(() => {\n\t\t\t\t\t\t\tthis.membersSelector.hideTextBox();\n\t\t\t\t\t\t\tthis.membersSelector.showAddButton();\n\t\t\t\t\t\t}, 200);\n\t\t\t\t\t},\n\t\t\t\t\tonContainerClick: () => {\n\t\t\t\t\t\tthis.focusSelector();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tfocusSelector()\n\t\t{\n\t\t\tthis.membersSelector.hideAddButton();\n\t\t\tthis.membersSelector.showTextBox();\n\t\t\tthis.membersSelector.focusTextBox();\n\t\t},\n\t\tprepareMembers(members: Set<string>): string[]\n\t\t{\n\t\t\tconst preparedMembers = [];\n\t\t\t[...members].forEach((item) => {\n\t\t\t\tconst [type, id] = item.split('|');\n\t\t\t\tif (type === SearchEntityIdTypes.user || type === SearchEntityIdTypes.bot)\n\t\t\t\t{\n\t\t\t\t\tpreparedMembers.push(id);\n\t\t\t\t}\n\t\t\t\telse if (type === SearchEntityIdTypes.department)\n\t\t\t\t{\n\t\t\t\t\tpreparedMembers.push(`${type}${id}`);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn preparedMembers;\n\t\t},\n\t\tonSelectItem(event: {dialogId: string, service: Object, selectedStatus: boolean})\n\t\t{\n\t\t\tconst { dialogId, nativeEvent } = event;\n\t\t\tif (this.selectedItems.has(dialogId))\n\t\t\t{\n\t\t\t\tconst tag = {\n\t\t\t\t\tid: dialogId,\n\t\t\t\t\tentityId: SEARCH_ENTITY_ID,\n\t\t\t\t};\n\n\t\t\t\tthis.membersSelector.removeTag(tag);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst tag = this.getTagByDialogId(dialogId);\n\t\t\t\tthis.membersSelector.addTag(tag);\n\t\t\t}\n\n\t\t\tthis.membersSelector.clearTextBox();\n\t\t\tif (!nativeEvent.altKey)\n\t\t\t{\n\t\t\t\tthis.searchQuery = '';\n\t\t\t}\n\t\t},\n\t\tgetTagByDialogId(dialogId: string): Object\n\t\t{\n\t\t\tconst user: ImModelUser = this.$store.getters['users/get'](dialogId, true);\n\t\t\tconst entityType = user.extranet ? 'extranet' : 'employee';\n\n\t\t\treturn {\n\t\t\t\tid: dialogId,\n\t\t\t\tentityId: SEARCH_ENTITY_ID,\n\t\t\t\tentityType,\n\t\t\t\ttitle: user.name,\n\t\t\t\tavatar: user.avatar.length > 0 ? user.avatar : null,\n\t\t\t};\n\t\t},\n\t\tonInviteClick()\n\t\t{\n\t\t\tconst members = [...this.selectedItems];\n\n\t\t\tif (this.isChat)\n\t\t\t{\n\t\t\t\tthis.extendChat(members);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.push(this.dialogId, Core.getUserId());\n\t\t\t\tthis.createChat(members);\n\t\t\t}\n\t\t},\n\t\textendChat(members: Array<string | number>)\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tthis.chatService.addToChat({\n\t\t\t\tchatId: this.chatId,\n\t\t\t\tmembers,\n\t\t\t\tshowHistory: this.showHistory,\n\t\t\t}).then(() => {\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.$emit('close');\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.$emit('close');\n\t\t\t});\n\t\t},\n\t\tasync createChat(members: number[])\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tconst { newDialogId } = await this.chatService.createChat({\n\t\t\t\ttitle: null,\n\t\t\t\tdescription: null,\n\t\t\t\tmembers,\n\t\t\t\townerId: Core.getUserId(),\n\t\t\t\tisPrivate: true,\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\tthis.isLoading = false;\n\t\t\t});\n\t\t\tthis.isLoading = false;\n\t\t\tvoid Messenger.openChat(newDialogId);\n\t\t},\n\t\tloc(key: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(key);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-entity-selector-add-to-chat__container bx-im-entity-selector-add-to-chat__scope\">\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__input\" ref=\"tag-selector\"></div>\n\t\t\t<div v-if=\"showHistoryOption\" class=\"bx-im-entity-selector-add-to-chat__show-history\">\n\t\t\t\t<input type=\"checkbox\" id=\"bx-im-entity-selector-add-to-chat-show-history\" v-model=\"showHistory\">\n\t\t\t\t<label for=\"bx-im-entity-selector-add-to-chat-show-history\">\n\t\t\t\t\t{{ loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_SHOW_HISTORY')}}\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__search-result-container\">\n\t\t\t\t<ChatSearch\n\t\t\t\t\t:searchMode=\"true\"\n\t\t\t\t\t:searchQuery=\"searchQuery\"\n\t\t\t\t\t:selectMode=\"true\"\n\t\t\t\t\t:searchConfig=\"searchConfig\"\n\t\t\t\t\t:selectedItems=\"[...selectedItems]\"\n\t\t\t\t\t:showMyNotes=\"false\"\n\t\t\t\t\t@clickItem=\"onSelectItem\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-add-to-chat__buttons\">\n\t\t\t\t<MessengerButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:isLoading=\"isLoading\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_INVITE_BUTTON')\"\n\t\t\t\t\t:isDisabled=\"selectedItems.size === 0\"\n\t\t\t\t\t@click=\"onInviteClick\"\n\t\t\t\t/>\n\t\t\t\t<MessengerButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:color=\"ButtonColor.LightBorder\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:text=\"loc('IM_ENTITY_SELECTOR_ADD_TO_CHAT_CANCEL_BUTTON')\"\n\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { PopupOptions } from 'main.popup';\n\nimport { MessengerPopup } from 'im.v2.component.elements';\n\nimport { AddToChatContent } from './add-to-chat-content';\n\nconst POPUP_ID = 'im-add-to-chat-popup';\n\n// @vue/component\nexport const AddToChat = {\n\tname: 'AddToChat',\n\tcomponents: { MessengerPopup, AddToChatContent },\n\tprops:\n\t{\n\t\tshowPopup: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tpopupConfig: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitleBar: this.$Bitrix.Loc.getMessage('IM_ENTITY_SELECTOR_ADD_TO_CHAT_ADD_MEMBERS_TITLE'),\n\t\t\t\tcloseIcon: true,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: this.popupConfig.offsetTop,\n\t\t\t\toffsetLeft: this.popupConfig.offsetLeft,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\tclassName: 'bx-im-entity-selector-add-to-chat__scope',\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\tv-slot=\"{enableAutoHide, disableAutoHide}\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t>\n\t\t\t<AddToChatContent :dialogId=\"dialogId\" @close=\"$emit('close')\"/>\n\t\t</MessengerPopup>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { EventType } from 'im.v2.const';\nimport { ChatSearchInput } from 'im.v2.component.search.chat-search-input';\nimport { ChatSearch } from 'im.v2.component.search.chat-search';\n\nimport type { JsonObject } from 'main.core';\n\nimport './forward-content.css';\n\nconst searchConfig = Object.freeze({\n\tchats: true,\n\tusers: true,\n});\n\n// @vue/component\nexport const ForwardContent = {\n\tname: 'ForwardContent',\n\tcomponents: { ChatSearch, ChatSearchInput },\n\tprops:\n\t{\n\t\tmessageId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tisLoading: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tsearchConfig: () => searchConfig,\n\t},\n\tmethods:\n\t{\n\t\tonLoading(value: boolean)\n\t\t{\n\t\t\tthis.isLoading = value;\n\t\t},\n\t\tonUpdateSearch(query: string)\n\t\t{\n\t\t\tthis.searchQuery = query;\n\t\t},\n\t\tasync onSelectItem(event)\n\t\t{\n\t\t\tconst { dialogId } = event;\n\n\t\t\tawait Messenger.openChat(dialogId);\n\t\t\tEventEmitter.emit(EventType.textarea.insertForward, {\n\t\t\t\tmessageId: this.messageId,\n\t\t\t\tdialogId\n\t\t\t});\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-entity-selector-forward__container\">\n\t\t\t<div class=\"bx-im-entity-selector-forward__input\">\n\t\t\t\t<ChatSearchInput \n\t\t\t\t\t:searchMode=\"true\" \n\t\t\t\t\t:isLoading=\"isLoading\" \n\t\t\t\t\t:withIcon=\"false\" \n\t\t\t\t\t:delayForFocusOnStart=\"1\"\n\t\t\t\t\t@updateSearch=\"onUpdateSearch\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-entity-selector-forward__search-result-container\">\n\t\t\t\t<ChatSearch\n\t\t\t\t\t:searchMode=\"true\"\n\t\t\t\t\t:searchQuery=\"searchQuery\"\n\t\t\t\t\t:searchConfig=\"searchConfig\"\n\t\t\t\t\t@clickItem=\"onSelectItem\"\n\t\t\t\t\t@loading=\"onLoading\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { PopupOptions } from 'main.popup';\n\nimport { MessengerPopup } from 'im.v2.component.elements';\n\nimport { ForwardContent } from './forward-content';\n\nconst POPUP_ID = 'im-forward-popup';\n\n// @vue/component\nexport const ForwardPopup = {\n\tname: 'ForwardPopup',\n\tcomponents: { MessengerPopup, ForwardContent },\n\tprops:\n\t{\n\t\tshowPopup: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed:\n\t{\n\t\tPOPUP_ID: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitleBar: this.$Bitrix.Loc.getMessage('IM_ENTITY_SELECTOR_ADD_TO_CHAT_FORWARD_TITLE'),\n\t\t\t\tcloseIcon: true,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tfixed: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: false,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tcontentBackground: '#fff',\n\t\t\t\tclassName: 'bx-im-entity-selector-forward__scope',\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<ForwardContent :messageId=\"messageId\" @close=\"$emit('close')\" />\n\t\t</MessengerPopup>\n\t`,\n};\n"],"names":["searchConfig","Object","freeze","chats","users","SEARCH_ENTITY_ID","AddToChatContent","name","components","ChatSearch","MessengerButton","props","dialogId","type","String","required","data","searchQuery","showHistory","isLoading","selectedItems","Set","computed","ButtonSize","ButtonColor","dialog","$store","getters","chatId","isChat","ChatType","user","isChannel","ChannelManager","showHistoryOption","created","chatService","ChatService","membersSelector","getTagSelector","mounted","renderTo","$refs","focusTextBox","methods","timeoutId","TagSelector","maxHeight","showAddButton","showTextBox","addButtonCaption","loc","addButtonCaptionMore","showCreateButton","events","onBeforeTagAdd","clearTimeout","onAfterTagAdd","event","tag","getData","add","id","focusSelector","onKeyUp","keyboardEvent","EventEmitter","emit","EventType","search","keyPressed","onBeforeTagRemove","onAfterTagRemove","delete","onInput","getTextBoxValue","onBlur","inputText","length","setTimeout","hideTextBox","onContainerClick","hideAddButton","prepareMembers","members","preparedMembers","forEach","item","split","SearchEntityIdTypes","bot","push","department","onSelectItem","nativeEvent","has","entityId","removeTag","getTagByDialogId","addTag","clearTextBox","altKey","entityType","extranet","title","avatar","onInviteClick","extendChat","Core","getUserId","createChat","addToChat","then","$emit","catch","error","console","newDialogId","description","ownerId","isPrivate","Messenger","openChat","key","$Bitrix","Loc","getMessage","template","POPUP_ID","AddToChat","MessengerPopup","showPopup","Boolean","bindElement","popupConfig","emits","config","titleBar","closeIcon","offsetTop","offsetLeft","padding","contentPadding","contentBackground","className","ForwardContent","ChatSearchInput","messageId","Number","onLoading","value","onUpdateSearch","query","textarea","insertForward","ForwardPopup","targetContainer","document","body","fixed","draggable","autoHide"],"mappings":"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"}