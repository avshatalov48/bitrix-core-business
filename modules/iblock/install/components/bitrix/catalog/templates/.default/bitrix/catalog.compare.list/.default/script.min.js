(function(t){if(!!t.JCCatalogCompareList){return}t.JCCatalogCompareList=function(t){this.obCompare=null;this.obAdminPanel=null;this.visual=t.VISUAL;this.visual.LIST=this.visual.ID+"_tbl";this.visual.ROW=this.visual.ID+"_row_";this.visual.COUNT=this.visual.ID+"_count";this.ajax=t.AJAX;this.position=t.POSITION;BX.ready(BX.proxy(this.init,this))};t.JCCatalogCompareList.prototype.init=function(){this.obCompare=BX(this.visual.ID);if(!!this.obCompare){BX.addCustomEvent(t,"OnCompareChange",BX.proxy(this.reload,this));BX.bindDelegate(this.obCompare,"click",{tagName:"a"},BX.proxy(this.deleteCompare,this));if(this.position.fixed&&this.position.align.vertical==="top"){this.obAdminPanel=BX("bx-panel");if(!!this.obAdminPanel){this.setVerticalAlign();BX.addCustomEvent(t,"onTopPanelCollapse",BX.proxy(this.setVerticalAlign,this))}}}};t.JCCatalogCompareList.prototype.reload=function(){BX.showWait(this.obCompare);BX.ajax.post(this.ajax.url,this.ajax.reload,BX.proxy(this.reloadResult,this))};t.JCCatalogCompareList.prototype.reloadResult=function(t){BX.closeWait();this.obCompare.innerHTML=t;BX.style(this.obCompare,"display","block")};t.JCCatalogCompareList.prototype.deleteCompare=function(){var t=BX.proxy_context,i,o;if(!!t&&t.hasAttribute("data-id")){i=parseInt(t.getAttribute("data-id"),10);if(!isNaN(i)){BX.showWait(this.obCompare);o=this.ajax.url+this.ajax.templates.delete+i.toString();BX.ajax.loadJSON(o,this.ajax.params,BX.proxy(this.deleteCompareResult,this))}}};t.JCCatalogCompareList.prototype.deleteCompareResult=function(t){var i,o,a,e,s;BX.closeWait();if(typeof t==="object"){if(!!t.STATUS&&t.STATUS==="OK"&&!!t.ID){BX.onCustomEvent("onCatalogDeleteCompare",[t.ID]);i=BX(this.visual.LIST);if(i){if(i.rows.length>1){a=this.visual.ROW+t.ID;for(o=0;o<i.rows.length;o++){if(i.rows[o].id===a){i.deleteRow(o)}}i=null;if(BX.type.isNotEmptyString(t.COUNT)||BX.type.isNumber(t.COUNT)){s=parseInt(t.COUNT,10);if(!isNaN(s)){e=BX(this.visual.COUNT);if(!!e){e.innerHTML=s.toString();e=null}BX.style(this.obCompare,"display",s>0?"block":"none")}}}else{this.reload()}}}}};t.JCCatalogCompareList.prototype.setVerticalAlign=function(){var t;if(!!this.obCompare&&!!this.obAdminPanel){t=parseInt(this.obAdminPanel.offsetHeight,10);if(isNaN(t)){t=0}t+=5;BX.style(this.obCompare,"top",t.toString()+"px")}}})(window);