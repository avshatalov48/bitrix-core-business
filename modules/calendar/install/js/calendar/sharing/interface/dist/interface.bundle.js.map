{"version":3,"file":"interface.bundle.js","sources":["../src/model/range.js","../src/model/rule.js","../src/model/settings.js","../src/controls/rule/weekday.js","../src/controls/rule/range.js","../src/controls/rule/settings.js","../src/controls/joint/hint-info.js","../src/controls/joint/user-selector.js","../src/controls/link-list/list-item.js","../src/controls/link-list/list.js","../src/controls/layout.js","../src/controls/dialog-new.js","../src/controls/sharingbutton.js","../src/interface.js","../src/controls/dialog-qr.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\nimport { CalendarSettings } from './calendar-settings';\nimport { RuleModel } from './rule';\n\nexport type RangeParams = {\n\tweekdays: number[],\n\tfrom: number,\n\tto: number,\n};\n\ntype Params = {\n\tid: number,\n\trange: RangeParams,\n\tcalendarSettings: CalendarSettings,\n\trule: RuleModel,\n};\n\nexport class RangeModel extends EventEmitter\n{\n\t#calendarSettings: CalendarSettings;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Calendar.Sharing.Range');\n\n\t\tconst { id, range, rule, calendarSettings, isNew } = params;\n\n\t\tthis.id = id;\n\t\tthis.rule = rule;\n\t\tthis.from = range.from;\n\t\tthis.to = range.to;\n\t\tthis.new = isNew;\n\t\tthis.deletable = false;\n\n\t\tthis.#calendarSettings = calendarSettings;\n\n\t\tthis.setWeekDays(range.weekdays);\n\t}\n\n\ttoArray(): RangeParams\n\t{\n\t\treturn {\n\t\t\tfrom: this.getFrom(),\n\t\t\tto: this.to,\n\t\t\tweekdays: this.getWeekDays(),\n\t\t};\n\t}\n\n\tgetRule(): RuleModel\n\t{\n\t\treturn this.rule;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetFromFormatted(): string\n\t{\n\t\treturn this.formatMinutes(this.getFrom());\n\t}\n\n\tgetFrom(): number\n\t{\n\t\treturn this.from;\n\t}\n\n\tsetFrom(value): void\n\t{\n\t\tthis.from = parseInt(value, 10);\n\n\t\tif (this.from + this.#getSlotSize() > this.to)\n\t\t{\n\t\t\tthis.to = this.from + this.#getSlotSize();\n\t\t}\n\n\t\tthis.updated();\n\t}\n\n\tgetToFormatted(): string\n\t{\n\t\treturn this.formatMinutes(this.getTo());\n\t}\n\n\tgetTo(): number\n\t{\n\t\treturn this.to;\n\t}\n\n\tsetTo(value): void\n\t{\n\t\tthis.to = value;\n\t\tthis.updated();\n\t}\n\n\tupdateSlotSize(): void\n\t{\n\t\tconst maxFrom = 24 * 60 - this.#getSlotSize();\n\n\t\tif (this.from > maxFrom)\n\t\t{\n\t\t\tthis.from = maxFrom;\n\t\t\tthis.to = this.from + this.#getSlotSize();\n\t\t}\n\t\telse if (this.from + this.#getSlotSize() > this.to)\n\t\t{\n\t\t\tthis.to = this.from + this.#getSlotSize();\n\t\t}\n\n\t\tthis.updated();\n\t}\n\n\taddWeekday(weekday: number): void\n\t{\n\t\tif (this.weekdays.includes(weekday))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setWeekDays([...this.weekdays, weekday]);\n\t}\n\n\tremoveWeekday(weekday: number): void\n\t{\n\t\tthis.setWeekDays(this.weekdays.filter((w) => w !== weekday));\n\t}\n\n\tgetWeekDays(): number[]\n\t{\n\t\treturn this.weekdays;\n\t}\n\n\tsetWeekDays(weekdays: number[]): void\n\t{\n\t\tthis.weekdays = this.sortWeekdays(weekdays);\n\t\tthis.updated();\n\t}\n\n\tgetWeekdaysTitle(forceLong: boolean = false): string\n\t{\n\t\tif ([...this.weekdays].sort().join(',') === [1, 2, 3, 4, 5].sort().join(','))\n\t\t{\n\t\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_WORKDAYS_MSGVER_1');\n\t\t}\n\n\t\treturn this.formatWeekdays(forceLong);\n\t}\n\n\tformatWeekdays(forceLong: boolean): string\n\t{\n\t\tconst weekdaysLoc = Util.getWeekdaysLoc(forceLong || this.weekdays.length === 1);\n\n\t\tconst weekdays = this.getWeekDays();\n\n\t\tif (weekdays.length === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn weekdays.map((w) => weekdaysLoc[w]).reduce((a, b) => `${a}, ${b}`);\n\t}\n\n\tsortWeekdays(weekdays: number[]): number[]\n\t{\n\t\treturn weekdays\n\t\t\t.map((w) => (w < this.#calendarSettings.weekStart ? w + 10 : w))\n\t\t\t.sort((a, b) => a - b)\n\t\t\t.map((w) => w % 10)\n\t\t;\n\t}\n\n\tgetAvailableTimeFrom(): { value: number, name: string }[]\n\t{\n\t\tconst timeStamps = [];\n\n\t\tconst maxFrom = 24 * 60 - this.#getSlotSize();\n\t\tfor (let hour = 0; hour <= 24; hour++)\n\t\t{\n\t\t\tif (hour * 60 <= maxFrom)\n\t\t\t{\n\t\t\t\ttimeStamps.push({\n\t\t\t\t\tvalue: hour * 60,\n\t\t\t\t\tname: Util.formatTime(hour, 0),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (hour !== 24 && hour * 60 + 30 <= maxFrom)\n\t\t\t{\n\t\t\t\ttimeStamps.push({\n\t\t\t\t\tvalue: hour * 60 + 30,\n\t\t\t\t\tname: Util.formatTime(hour, 30),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn timeStamps;\n\t}\n\n\tgetAvailableTimeTo(): { value: number, name: string }[]\n\t{\n\t\tconst timeStamps = [];\n\n\t\tfor (let hour = 0; hour <= 24; hour++)\n\t\t{\n\t\t\tif (hour * 60 >= this.from + this.#getSlotSize())\n\t\t\t{\n\t\t\t\ttimeStamps.push({\n\t\t\t\t\tvalue: hour * 60,\n\t\t\t\t\tname: Util.formatTime(hour, 0),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (hour !== 24 && hour * 60 + 30 >= this.from + this.#getSlotSize())\n\t\t\t{\n\t\t\t\ttimeStamps.push({\n\t\t\t\t\tvalue: hour * 60 + 30,\n\t\t\t\t\tname: Util.formatTime(hour, 30),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn timeStamps;\n\t}\n\n\tisDeletable(): boolean\n\t{\n\t\treturn this.deletable;\n\t}\n\n\tsetDeletable(deletable: boolean): void\n\t{\n\t\tthis.deletable = deletable;\n\t}\n\n\tisNew(): boolean\n\t{\n\t\treturn this.new;\n\t}\n\n\tsetNew(isNew: boolean): void\n\t{\n\t\tthis.new = isNew;\n\t}\n\n\t#getSlotSize(): number\n\t{\n\t\treturn this.rule.getSlotSize();\n\t}\n\n\tgetWeekStart(): number\n\t{\n\t\treturn this.#calendarSettings.weekStart;\n\t}\n\n\tformatMinutes(minutes: number): string\n\t{\n\t\tconst date = new Date(Util.parseDate('01.01.2000').getTime() + minutes * 60 * 1000);\n\n\t\treturn Util.formatTime(date);\n\t}\n\n\tupdated(): void\n\t{\n\t\tthis.emit('updated');\n\t\tthis.getRule().updated();\n\t}\n}","import { Util } from 'calendar.util';\nimport { EventEmitter } from 'main.core.events';\nimport { CalendarSettings } from './calendar-settings';\nimport { RangeModel, RangeParams } from './range';\n\nexport type RuleParams = {\n\tslotSize: number,\n\tranges: RangeParams[],\n};\n\ntype Params = {\n\trule: RuleParams,\n\tcalendarSettings: CalendarSettings,\n};\n\nexport class RuleModel extends EventEmitter\n{\n\tAVAILABLE_INTERVALS = [30, 45, 60, 90, 120, 180];\n\tMAX_RANGES = 5;\n\tDEFAULT_SLOT_SIZE = 60;\n\n\t#calendarSettings: CalendarSettings;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Calendar.Sharing.Rule');\n\n\t\tconst { rule, calendarSettings } = params;\n\n\t\tthis.#calendarSettings = calendarSettings;\n\n\t\tthis.ranges = [];\n\t\tfor (const range of rule.ranges)\n\t\t{\n\t\t\tthis.addRange(range, false);\n\t\t}\n\n\t\tthis.setSlotSize(rule.slotSize);\n\t\tthis.sortRanges();\n\t}\n\n\ttoArray(): RuleParams\n\t{\n\t\treturn {\n\t\t\tslotSize: this.getSlotSize(),\n\t\t\tranges: this.getSortedRanges().map((range) => range.toArray()),\n\t\t};\n\t}\n\n\tgetDefaultRule(): RuleModel\n\t{\n\t\treturn new RuleModel({\n\t\t\trule: {\n\t\t\t\tslotSize: this.DEFAULT_SLOT_SIZE,\n\t\t\t\tranges: [{\n\t\t\t\t\tfrom: this.#calendarSettings.workTimeStart,\n\t\t\t\t\tto: this.#calendarSettings.workTimeEnd,\n\t\t\t\t\tweekdays: this.#calendarSettings.workDays,\n\t\t\t\t}],\n\t\t\t},\n\t\t\tcalendarSettings: this.#calendarSettings,\n\t\t});\n\t}\n\n\tgetAvailableIntervals(): number[]\n\t{\n\t\treturn this.AVAILABLE_INTERVALS;\n\t}\n\n\tgetFormattedSlotSize(): string\n\t{\n\t\treturn Util.formatDuration(this.getSlotSize());\n\t}\n\n\tgetSlotSize(): number\n\t{\n\t\treturn this.slotSize;\n\t}\n\n\tsetSlotSize(value)\n\t{\n\t\tconst slotSize = parseInt(value, 10);\n\t\tthis.slotSize = this.getAvailableIntervals().includes(slotSize) ? slotSize : this.DEFAULT_SLOT_SIZE;\n\t\tfor (const range of this.getRanges())\n\t\t{\n\t\t\trange.updateSlotSize();\n\t\t}\n\t}\n\n\tgetRanges(): RangeModel[]\n\t{\n\t\treturn this.ranges;\n\t}\n\n\tsortRanges()\n\t{\n\t\tthis.ranges = this.getSortedRanges();\n\t}\n\n\tgetSortedRanges()\n\t{\n\t\treturn [...this.ranges].sort((a, b) => this.compareRanges(a, b));\n\t}\n\n\tcompareRanges(firstRange, secondRange): 1 | 0 | -1\n\t{\n\t\tconst firstWeekdaysWeight = this.getWeekdaysWeight(firstRange.getWeekDays());\n\t\tconst secondWeekdaysWeight = this.getWeekdaysWeight(secondRange.getWeekDays());\n\n\t\tif (firstWeekdaysWeight !== secondWeekdaysWeight)\n\t\t{\n\t\t\treturn firstWeekdaysWeight - secondWeekdaysWeight;\n\t\t}\n\n\t\tif (firstRange.getFrom() !== secondRange.getFrom())\n\t\t{\n\t\t\treturn firstRange.getFrom() - secondRange.getFrom();\n\t\t}\n\n\t\treturn firstRange.getTo() - secondRange.getTo();\n\t}\n\n\tgetWeekdaysWeight(weekdays): number\n\t{\n\t\treturn weekdays.reduce((accumulator, w, index) => {\n\t\t\treturn accumulator + w * 10 ** (10 - index);\n\t\t}, 0);\n\t}\n\n\taddRange(range, isNew = true): void\n\t{\n\t\tif (!this.canAddRange())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.internalRangeId ??= 1;\n\n\t\tthis.ranges.push(\n\t\t\tnew RangeModel({\n\t\t\t\tid: this.internalRangeId++,\n\t\t\t\trange: range ?? this.getDefaultRule().getRanges()[0],\n\t\t\t\tcalendarSettings: this.#calendarSettings,\n\t\t\t\tisNew,\n\t\t\t\trule: this,\n\t\t\t}),\n\t\t);\n\n\t\tthis.#updateRanges();\n\t\tthis.updated();\n\t}\n\n\tremoveRange(rangeToRemove: RangeModel): boolean\n\t{\n\t\tif (!this.canRemoveRange())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.ranges = this.ranges.filter((range) => {\n\t\t\treturn range.getId() !== rangeToRemove.getId();\n\t\t});\n\n\t\tthis.#updateRanges();\n\t\tthis.rangeDeleted();\n\n\t\treturn true;\n\t}\n\n\t#updateRanges()\n\t{\n\t\tfor (const range of this.ranges.slice(0, -1))\n\t\t{\n\t\t\trange.setDeletable(true);\n\t\t}\n\n\t\tthis.ranges.slice(-1)[0].setDeletable(this.ranges.length === 5);\n\t}\n\n\tcanAddRange(): boolean\n\t{\n\t\treturn this.ranges.length < this.MAX_RANGES;\n\t}\n\n\tcanRemoveRange(): boolean\n\t{\n\t\treturn this.ranges.length > 1;\n\t}\n\n\tupdated(): void\n\t{\n\t\tthis.emit('updated');\n\t}\n\n\trangeDeleted(): void\n\t{\n\t\tthis.emit('rangeDeleted');\n\t}\n}","import { Util } from 'calendar.util';\nimport { EventEmitter } from 'main.core.events';\nimport { DateTimeFormat } from 'main.date';\nimport { Analytics } from 'calendar.sharing.analytics';\nimport { Context } from './context';\nimport { RuleModel, RuleParams } from './rule';\nimport { User } from './user';\n\nexport type CalendarSettings = {\n\tweekStart: string,\n\tweekHolidays: string[],\n\tworkTimeStart: string,\n\tworkTimeEnd: string,\n};\n\nexport type SettingsParams = {\n\tcontext: Context,\n\tlinkHash: string,\n\tsharingUrl: string,\n\tuserInfo: User,\n\n\trule: RuleParams,\n\tcalendarSettings: CalendarSettings,\n\tcollapsed: boolean,\n\tsortJointLinksByFrequentUse: boolean,\n};\n\nexport class SettingsModel\n{\n\t#params: SettingsParams;\n\t#rule: RuleModel;\n\t#memberIds: number[];\n\n\tconstructor(params: SettingsParams)\n\t{\n\t\tthis.#params = params;\n\n\t\tconst { rule, calendarSettings } = params;\n\n\t\tthis.#rule = this.#createRuleModel(rule, calendarSettings);\n\t}\n\n\t#createRuleModel(rule: RuleParams, calendarSettings: CalendarSettings)\n\t{\n\t\tconst { weekStart, weekHolidays, workTimeStart, workTimeEnd } = calendarSettings;\n\n\t\treturn new RuleModel({\n\t\t\trule,\n\t\t\tcalendarSettings: {\n\t\t\t\tweekStart: Util.getIndByWeekDay(weekStart),\n\t\t\t\tworkTimeStart: this.getMinutesFromTime(workTimeStart),\n\t\t\t\tworkTimeEnd: this.getMinutesFromTime(workTimeEnd),\n\t\t\t\tworkDays: this.getWorkingDays(weekHolidays),\n\t\t\t},\n\t\t});\n\t}\n\n\tgetMinutesFromTime(time: string): number\n\t{\n\t\tconst dateString = new Date().toDateString();\n\t\tconst date = new Date(`${dateString} ${`${time}`.replace('.', ':')}:00`);\n\n\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\tconst parsedTime = Util.parseTime(DateTimeFormat.format(shortTimeFormat, date / 1000));\n\n\t\treturn parsedTime.h * 60 + parsedTime.m;\n\t}\n\n\tgetWorkingDays(weekHolidays): number[]\n\t{\n\t\tconst weekHolidaysInt = new Set(weekHolidays.map((day) => Util.getIndByWeekDay(day)));\n\n\t\treturn [0, 1, 2, 3, 4, 5, 6].filter((day) => !weekHolidaysInt.has(day));\n\t}\n\n\tisDefaultRule(): boolean\n\t{\n\t\treturn !this.isDifferentFrom(this.getRule().getDefaultRule());\n\t}\n\n\tisDifferentFrom(anotherRule: RuleModel): boolean\n\t{\n\t\treturn this.getChanges(anotherRule, this.getRule()).length > 0;\n\t}\n\n\tgetChanges(rule: RuleModel): string[]\n\t{\n\t\tconst currentRule = this.getRule().toArray();\n\t\tconst anotherRule = (rule ?? this.getRule().getDefaultRule()).toArray();\n\n\t\tconst sizeChanged = currentRule.slotSize !== anotherRule.slotSize;\n\t\tconst daysChanged = JSON.stringify(currentRule.ranges) !== JSON.stringify(anotherRule.ranges);\n\n\t\tconst changes = [];\n\n\t\tif (daysChanged)\n\t\t{\n\t\t\tchanges.push(Analytics.ruleChanges.custom_days);\n\t\t}\n\n\t\tif (sizeChanged)\n\t\t{\n\t\t\tchanges.push(Analytics.ruleChanges.custom_length);\n\t\t}\n\n\t\treturn changes;\n\t}\n\n\tsortRanges(): void\n\t{\n\t\tthis.getRule().sortRanges();\n\t}\n\n\tgetRule(): RuleModel\n\t{\n\t\treturn this.#rule;\n\t}\n\n\tgetUserInfo(): User\n\t{\n\t\treturn this.#params.userInfo;\n\t}\n\n\tgetContext(): Context\n\t{\n\t\treturn this.#params.context;\n\t}\n\n\tgetLinkHash(): string\n\t{\n\t\treturn this.#params.linkHash;\n\t}\n\n\tgetSharingUrl(): string\n\t{\n\t\treturn this.#params.sharingUrl;\n\t}\n\n\tisCollapsed(): boolean\n\t{\n\t\treturn this.#params.collapsed;\n\t}\n\n\tsortJointLinksByFrequentUse(): boolean\n\t{\n\t\treturn this.#params.sortJointLinksByFrequentUse;\n\t}\n\n\tchangeSortJointLinksByFrequentUse()\n\t{\n\t\tthis.#params.sortJointLinksByFrequentUse = !this.#params.sortJointLinksByFrequentUse;\n\t\tthis.#updateSortByFrequentUse();\n\t}\n\n\tsetMemberIds(memberIds: number[]): void\n\t{\n\t\tthis.#memberIds = memberIds;\n\t}\n\n\tgetMemberIds(): number[]\n\t{\n\t\treturn this.#memberIds;\n\t}\n\n\tasync saveJointLink(): Promise\n\t{\n\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.generateUserJointSharingLink', {\n\t\t\tdata: {\n\t\t\t\tmemberIds: this.getMemberIds(),\n\t\t\t},\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tsave(): Promise\n\t{\n\t\tif (!this.isDifferentFrom(this.#createRuleModel(this.#params.rule, this.#params.calendarSettings)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst changes = this.getChanges();\n\t\tAnalytics.sendRuleUpdated(this.getContext(), changes);\n\n\t\tconst newRule = this.getRule().toArray();\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tBX.ajax.runAction('calendar.api.sharingajax.saveLinkRule', {\n\t\t\t\tdata: {\n\t\t\t\t\tlinkHash: this.getLinkHash(),\n\t\t\t\t\truleArray: newRule,\n\t\t\t\t},\n\t\t\t}).then(() => {\n\t\t\t\tEventEmitter.emit('CalendarSharing:RuleUpdated');\n\t\t\t\tthis.#params.rule = newRule;\n\t\t\t\tresolve();\n\t\t\t}, (error) => {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.error(error);\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tincreaseFrequentUse(): void\n\t{\n\t\tvoid BX.ajax.runAction('calendar.api.sharingajax.increaseFrequentUse', {\n\t\t\tdata: {\n\t\t\t\thash: this.getLinkHash(),\n\t\t\t},\n\t\t});\n\t}\n\n\tupdateCollapsed(isCollapsed: boolean): void\n\t{\n\t\tvoid BX.ajax.runAction('calendar.api.sharingajax.updateSharingSettingsCollapsed', {\n\t\t\tdata: {\n\t\t\t\tcollapsed: isCollapsed ? 'Y' : 'N',\n\t\t\t},\n\t\t});\n\t}\n\n\t#updateSortByFrequentUse(): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.setSortJointLinksByFrequentUse', {\n\t\t\tdata: {\n\t\t\t\tsortByFrequentUse: this.#params.sortJointLinksByFrequentUse ? 'Y' : 'N',\n\t\t\t},\n\t\t});\n\t}\n}","import { Dom, Tag, Type } from 'main.core';\n\ntype WeekdayOptions = {\n\tname: string,\n\tindex: number,\n\tactive: boolean,\n\tonSelected: void,\n\tonDiscarded: void,\n\tonMouseDown: void,\n\tcanBeDiscarded: void,\n}\n\nexport default class Weekday\n{\n\tconstructor(options: WeekdayOptions)\n\t{\n\t\tthis.wrap = null;\n\t\tthis.name = options.name;\n\t\tthis.index = options.index;\n\t\tthis.active = options.active;\n\t\tthis.onSelected = Type.isFunction(options.onSelected) ? options.onSelected : () => {};\n\n\t\tthis.onDiscarded = Type.isFunction(options.onDiscarded) ? options.onDiscarded : () => {};\n\n\t\tthis.onMouseDown = Type.isFunction(options.onMouseDown) ? options.onMouseDown : () => {};\n\n\t\tthis.canBeDiscarded = Type.isFunction(options.canBeDiscarded) ? options.canBeDiscarded : () => {};\n\t}\n\n\trender()\n\t{\n\t\tconst className = this.active ? '--selected' : '';\n\n\t\tthis.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-popup-weekday ${className}\" onmousedown=\"${(e) => this.handleMouseDown(e)}\">\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekday-text\">${this.name}</div>\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekday-icon\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.wrap;\n\t}\n\n\thandleMouseDown(event)\n\t{\n\t\tif (this.active)\n\t\t{\n\t\t\tthis.discard();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.select();\n\t\t}\n\t\tthis.onMouseDown(event, this);\n\t}\n\n\tselect()\n\t{\n\t\tthis.active = true;\n\t\tDom.addClass(this.wrap, '--selected');\n\t\tthis.onSelected();\n\t}\n\n\tdiscard()\n\t{\n\t\tif (!this.canBeDiscarded())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.active = false;\n\t\tDom.removeClass(this.wrap, '--selected');\n\t\tthis.onDiscarded();\n\t}\n}\n","import { Dom, Tag, Type, Event } from 'main.core';\nimport Weekday from './weekday';\nimport { MenuManager, Popup, PopupManager } from 'main.popup';\nimport { Util } from 'calendar.util';\nimport { RangeModel } from '../../model/index';\n\ntype Params = {\n\treadOnly: boolean,\n\tmodel: RangeModel,\n\tshowReadOnlyPopup: function,\n};\n\nexport default class Range\n{\n\t#params: Params;\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tweekdaysSelect: HTMLElement,\n\t\tfromTimeSelect: HTMLElement,\n\t\ttoTimeSelect: HTMLElement,\n\t\tbutton: HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tthis.showReadOnlyPopup = Type.isFunction(params.showReadOnlyPopup) ? params.showReadOnlyPopup : () => {};\n\t\tthis.onRangeUpdated = this.#onRangeUpdated.bind(this);\n\n\t\tthis.#bindEvents();\n\t}\n\n\tget #model(): RangeModel\n\t{\n\t\treturn this.#params.model;\n\t}\n\n\thasShownPopups(): boolean\n\t{\n\t\tconst weekdaysPopupShown = this.weekdaysMenu.isShown();\n\t\tconst startPopupShown = Dom.hasClass(this.#layout.fromTimeSelect, '--active');\n\t\tconst endPopupShown = Dom.hasClass(this.#layout.toTimeSelect, '--active');\n\n\t\treturn weekdaysPopupShown || startPopupShown || endPopupShown;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.#model.subscribe('updated', this.onRangeUpdated);\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#layout.wrap.remove();\n\t\tthis.#unbindEvents();\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tthis.#model.unsubscribe('updated', this.onRangeUpdated);\n\t}\n\n\t#onRangeUpdated(): void\n\t{\n\t\tthis.updateWeekdaysTitle();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-range\">\n\t\t\t\t${this.#renderWeekdaysSelect()}\n\t\t\t\t<div class=\"calendar-sharing__settings-time-interval\">\n\t\t\t\t\t${this.#renderTimeFromSelect()}\n\t\t\t\t\t<div class=\"calendar-sharing__settings-dash\"></div>\n\t\t\t\t\t${this.#renderTimeToSelect()}\n\t\t\t\t</div>\n\t\t\t\t${this.renderButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#model.isNew())\n\t\t{\n\t\t\tthis.#animate();\n\t\t}\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#animate(): void\n\t{\n\t\tDom.addClass(this.#layout.wrap, '--animate-show');\n\t\tsetTimeout(() => {\n\t\t\tDom.removeClass(this.#layout.wrap, '--animate-show');\n\t\t\tthis.#model.setNew(false);\n\t\t}, 300);\n\t}\n\n\trenderButton(): HTMLElement\n\t{\n\t\tconst button = this.#getButton();\n\n\t\tthis.#layout.button?.replaceWith(button);\n\t\tthis.#layout.button = button;\n\n\t\treturn this.#layout.button;\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\tif (this.#model.isDeletable())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"calendar-sharing__settings-delete\"\n\t\t\t\t\tonclick=\"${this.#onDeleteButtonClickHandler.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"calendar-sharing__settings-add\"\n\t\t\t\tonclick=\"${this.#onAddButtonClickHandler.bind(this)}\"\n\t\t\t></div>\n\t\t`;\n\t}\n\n\t#onDeleteButtonClickHandler(): void\n\t{\n\t\tif (this.#params.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.#layout.button);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#remove();\n\t\t}\n\t}\n\n\t#onAddButtonClickHandler(): void\n\t{\n\t\tif (this.#params.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.#layout.button);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#add();\n\t\t}\n\t}\n\n\t#add(): void\n\t{\n\t\tthis.#model.getRule().addRange();\n\t}\n\n\t#remove(): void\n\t{\n\t\tif (!this.#model.getRule().removeRange(this.#model))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.wrap, '--animate-remove');\n\t\tsetTimeout(() => this.destroy(), 300);\n\t}\n\n\t#renderWeekdaysSelect(): HTMLElement\n\t{\n\t\tconst weekdaysLoc = Util.getWeekdaysLoc().map((loc, index) => {\n\t\t\treturn {\n\t\t\t\tloc,\n\t\t\t\tindex,\n\t\t\t\tactive: this.#model.getWeekDays().includes(index),\n\t\t\t};\n\t\t});\n\t\tweekdaysLoc.push(...weekdaysLoc.splice(0, this.#model.getWeekStart()));\n\n\t\tthis.#layout.weekdaysSelect = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"calendar-sharing__settings-weekdays calendar-sharing__settings-select calendar-sharing__settings-select-arrow\"\n\t\t\t\ttitle=\"${ this.#model.formatWeekdays()}\"\n\t\t\t>\n\t\t\t\t${this.#model.getWeekdaysTitle()}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst observer = new IntersectionObserver(() => {\n\t\t\tif (this.#layout.weekdaysSelect.offsetWidth > 0)\n\t\t\t{\n\t\t\t\tthis.updateWeekdaysTitle();\n\t\t\t}\n\t\t});\n\t\tobserver.observe(this.#layout.weekdaysSelect);\n\n\t\tEvent.bind(this.#layout.weekdaysSelect, 'click', this.#onWeekdaysSelectClickHandler.bind(this));\n\n\t\tthis.weekdays = weekdaysLoc.map((weekdayLoc) => this.#createWeekday(weekdayLoc));\n\n\t\tconst weekdaysPopupId = `calendar-sharing-settings-weekdays-${this.#params.model.id}`;\n\t\tthis.weekdaysMenu = PopupManager.getPopupById(weekdaysPopupId);\n\t\tif (!this.weekdaysMenu)\n\t\t{\n\t\t\tthis.weekdaysMenu = this.#createWeekdaysPopup(weekdaysPopupId);\n\t\t\tthis.weekdaysMenu.canBeClosed = true;\n\t\t}\n\t\tthis.weekdaysMenu.setBindElement(this.#layout.weekdaysSelect);\n\n\t\treturn this.#layout.weekdaysSelect;\n\t}\n\n\tupdateWeekdaysTitle(): void\n\t{\n\t\tthis.#layout.weekdaysSelect.title = this.#model.formatWeekdays(false);\n\n\t\tthis.#layout.weekdaysSelect.innerText = this.#model.getWeekdaysTitle(true);\n\t\tconst weekdaysSelectWidth = this.#layout.weekdaysSelect.offsetWidth - 32;\n\t\tconst weekdaysTextWidth = this.#getTextNodeWidth(this.#layout.weekdaysSelect.firstChild);\n\t\tconst weekdaysWidthIsOverflowing = weekdaysSelectWidth < weekdaysTextWidth;\n\t\tif (weekdaysWidthIsOverflowing)\n\t\t{\n\t\t\tthis.#layout.weekdaysSelect.innerText = this.#model.getWeekdaysTitle(false);\n\t\t}\n\t}\n\n\t#getTextNodeWidth(textNode): number\n\t{\n\t\tconst spanNode = BX.Tag.render`<span style=\"position: absolute;\">${textNode.cloneNode()}</span>`;\n\t\ttextNode.replaceWith(spanNode);\n\t\tconst textWidth = spanNode.offsetWidth;\n\t\tspanNode.replaceWith(textNode);\n\n\t\treturn textWidth;\n\t}\n\n\t#createWeekdaysPopup(id: string): Popup\n\t{\n\t\treturn new Popup({\n\t\t\tid,\n\t\t\tcontent: Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekdays\">\n\t\t\t\t\t${this.weekdays.map((weekday) => weekday.render())}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 105,\n\t\t\t},\n\t\t\tautoHideHandler: () => this.weekdaysMenu.canBeClosed,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => Dom.addClass(this.#layout.weekdaysSelect, '--active'),\n\t\t\t\tonPopupClose: () => Dom.removeClass(this.#layout.weekdaysSelect, '--active'),\n\t\t\t},\n\t\t});\n\t}\n\n\t#createWeekday(weekdayLoc): Weekday\n\t{\n\t\treturn new Weekday({\n\t\t\tname: weekdayLoc.loc,\n\t\t\tindex: weekdayLoc.index,\n\t\t\tactive: weekdayLoc.active,\n\t\t\tonSelected: () => this.#model.addWeekday(weekdayLoc.index),\n\t\t\tonDiscarded: () => this.#model.removeWeekday(weekdayLoc.index),\n\t\t\tcanBeDiscarded: () => this.#model.getWeekDays().length > 1,\n\t\t\tonMouseDown: this.#onWeekdayMouseDown.bind(this),\n\t\t});\n\t}\n\n\t#onWeekdayMouseDown(event, currentWeekday): void\n\t{\n\t\tthis.weekdaysMenu.canBeClosed = false;\n\t\tconst startX = event.clientX;\n\t\tconst select = currentWeekday.active;\n\t\tthis.controllableWeekdays = [];\n\n\t\tthis.collectIntersectedWeekdays = (e) => {\n\t\t\tfor (const weekday of this.weekdays)\n\t\t\t{\n\t\t\t\tconst right = weekday.wrap.getBoundingClientRect().right;\n\t\t\t\tconst left = weekday.wrap.getBoundingClientRect().left;\n\n\t\t\t\tif (\n\t\t\t\t\t(startX > right && e.clientX < right)\n\t\t\t\t\t|| (startX < left && e.clientX > left)\n\t\t\t\t\t|| (left < startX && startX < right)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (!this.controllableWeekdays.includes(weekday))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controllableWeekdays.push(weekday);\n\t\t\t\t\t}\n\t\t\t\t\tweekday.intersected = true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.onMouseMove = (e) => {\n\t\t\tthis.controllableWeekdays.forEach((controllableWeekday) => {\n\t\t\t\tcontrollableWeekday.intersected = false;\n\t\t\t});\n\n\t\t\tthis.collectIntersectedWeekdays(e);\n\n\t\t\tfor (const weekday of this.controllableWeekdays)\n\t\t\t{\n\t\t\t\tif ((weekday.intersected && select) || (!weekday.intersected && !select))\n\t\t\t\t{\n\t\t\t\t\tweekday.select();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tweekday.discard();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tEvent.bind(document, 'mousemove', this.onMouseMove);\n\t\tEvent.bind(document, 'mouseup', () => {\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.weekdaysMenu.canBeClosed = true;\n\t\t\t}, 0);\n\t\t});\n\t}\n\n\t#renderTimeFromSelect(): HTMLElement\n\t{\n\t\tthis.#layout.fromTimeSelect = this.#renderTimeSelect(this.#model.getFromFormatted(), {\n\t\t\tgetTimeStamps: () => this.#model.getAvailableTimeFrom(),\n\t\t\tisSelected: (minutes) => this.#model.getFrom() === minutes,\n\t\t\tonItemSelected: (minutes) => this.#model.setFrom(minutes),\n\t\t}, 'calendar-sharing-settings-range-from');\n\n\t\treturn this.#layout.fromTimeSelect;\n\t}\n\n\t#renderTimeToSelect(): HTMLElement\n\t{\n\t\tthis.#layout.toTimeSelect = this.#renderTimeSelect(this.#model.getToFormatted(), {\n\t\t\tgetTimeStamps: () => this.#model.getAvailableTimeTo(),\n\t\t\tisSelected: (minutes) => this.#model.getTo() === minutes,\n\t\t\tonItemSelected: (minutes) => this.#model.setTo(minutes),\n\t\t}, 'calendar-sharing-settings-range-to');\n\n\t\treturn this.#layout.toTimeSelect;\n\t}\n\n\t#renderTimeSelect(time, callbacks, dataId): HTMLElement\n\t{\n\t\tconst timeSelect = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"calendar-sharing__settings-select calendar-sharing__settings-time calendar-sharing__settings-select-arrow\"\n\t\t\t\tdata-id=\"${dataId}\"\n\t\t\t>\n\t\t\t\t${this.formatAmPmSpan(time)}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(timeSelect, 'click', () => this.#onTimeSelectClickHandler(timeSelect, callbacks));\n\n\t\treturn timeSelect;\n\t}\n\n\t#onTimeSelectClickHandler(timeSelect, callbacks): void\n\t{\n\t\tif (this.#params.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(timeSelect);\n\t\t}\n\t\telse if (!Dom.hasClass(timeSelect, '--active'))\n\t\t{\n\t\t\tthis.#showTimeMenu(timeSelect, callbacks);\n\t\t}\n\t}\n\n\t#showTimeMenu(timeSelect, callbacks): void\n\t{\n\t\tlet timeMenu;\n\n\t\tconst items = callbacks.getTimeStamps().map((timeStamp) => {\n\t\t\treturn {\n\t\t\t\thtml: Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__am-pm-container\">${timeStamp.name}</div>\n\t\t\t\t`,\n\t\t\t\tclassName: callbacks.isSelected(timeStamp.value) ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\t\tonclick: () => {\n\t\t\t\t\ttimeSelect.innerHTML = timeStamp.name;\n\t\t\t\t\tcallbacks.onItemSelected(timeStamp.value);\n\t\t\t\t\ttimeMenu.close();\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\n\t\ttimeMenu = MenuManager.create({\n\t\t\tid: `calendar-sharing-settings-time-menu${Date.now()}`,\n\t\t\tclassName: 'calendar-sharing-settings-time-menu',\n\t\t\tbindElement: timeSelect,\n\t\t\titems,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tevents: {\n\t\t\t\tonShow: () => Dom.addClass(timeSelect, '--active'),\n\t\t\t\tonClose: () => Dom.removeClass(timeSelect, '--active'),\n\t\t\t},\n\t\t\tmaxHeight: 300,\n\t\t\tminWidth: timeSelect.offsetWidth,\n\t\t});\n\t\ttimeMenu.show();\n\n\t\tconst timezonesPopup = timeMenu.getPopupWindow();\n\t\tconst popupContent = timezonesPopup.getContentContainer();\n\t\tconst selectedTimezoneItem = popupContent.querySelector('.menu-popup-item.--selected');\n\t\tpopupContent.scrollTop = selectedTimezoneItem.offsetTop - selectedTimezoneItem.offsetHeight * 2;\n\t}\n\n\t#onWeekdaysSelectClickHandler(): void\n\t{\n\t\tif (this.#params.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.#layout.weekdaysSelect);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.weekdaysMenu.show();\n\t\t}\n\t}\n\n\tformatAmPmSpan(time): string\n\t{\n\t\treturn time.toLowerCase().replace(/(am|pm)/g, '<span class=\"calendar-sharing__settings-time-am-pm\">$1</span>');\n\t}\n}\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Popup, MenuManager } from 'main.popup';\nimport { Util } from 'calendar.util';\nimport Range from './range';\nimport { SettingsModel, RuleModel } from '../../model/index';\n\nimport '../../css/settings.css';\n\nexport type Params = {\n\treadOnly: boolean,\n\tmodel: SettingsModel,\n};\n\nexport default class Settings\n{\n\t#params: Params;\n\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tsubtitle: HTMLElement,\n\t\texpandRuleArrow: HTMLElement,\n\t\texpandRuleButton: HTMLElement,\n\t\trule: HTMLElement,\n\t\tweekdaysSelect: HTMLElement,\n\t\tslotSizeText: HTMLElement,\n\t\tslotSizeSelect: HTMLElement,\n\t\trangesContainer: HTMLElement,\n\t\tranges: Range[],\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tthis.readOnly = params.readOnly;\n\n\t\tthis.#bindEvents();\n\t}\n\n\tget #model(): SettingsModel\n\t{\n\t\treturn this.#params.model;\n\t}\n\n\tget #rule(): RuleModel\n\t{\n\t\treturn this.#model.getRule();\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.#rule.subscribe('updated', this.#onRuleUpdated.bind(this));\n\t\tthis.#rule.subscribe('rangeDeleted', this.#onRangeDeleted.bind(this));\n\t}\n\n\t#onRuleUpdated(): void\n\t{\n\t\tthis.#updateSubtitle();\n\t\tthis.#removeRuleHeight();\n\t\tthis.#renderRanges();\n\t}\n\n\t#onRangeDeleted()\n\t{\n\t\tthis.#updateSubtitle();\n\t\tthis.#removeRuleHeight();\n\t\tthis.#layout.ranges.forEach((range) => range.renderButton());\n\t}\n\n\thasShownPopups(): boolean\n\t{\n\t\tconst rangesWithPopup = this.#layout.ranges.filter((range) => range.hasShownPopups()) ?? [];\n\t\tconst rangePopupShown = rangesWithPopup.length > 0;\n\t\tconst slotSizePopupShown = Dom.hasClass(this.#layout.slotSizeSelect, '--active');\n\t\tconst readOnlyPopupShown = this.readOnlyPopup?.isShown();\n\n\t\treturn rangePopupShown || slotSizePopupShown || readOnlyPopupShown;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst readOnlyClass = this.readOnly ? '--read-only' : '';\n\t\tconst expandedClass = this.#model.isCollapsed() ? '--hide' : '';\n\t\tconst contextClass = `--${this.#model.getContext()}`\n\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings ${readOnlyClass} ${expandedClass} ${contextClass}\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderRule()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-header-container\">\n\t\t\t\t<div class=\"calendar-sharing__settings-header\">\n\t\t\t\t\t<div class=\"calendar-sharing__settings-title\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_SETTINGS_TITLE_V2')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#renderSubtitle()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-sharing__settings-header-button\">\n\t\t\t\t\t${this.#renderExpandRuleButton()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderSubtitle(): HTMLElement\n\t{\n\t\tthis.#layout.subtitle = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-subtitle\">\n\t\t\t\t${this.#getSubtitleText()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.subtitle;\n\t}\n\n\t#updateSubtitle(): void\n\t{\n\t\tif (!this.#layout.subtitle)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#layout.subtitle.innerText = this.#getSubtitleText();\n\t}\n\n\t#getSubtitleText(): string\n\t{\n\t\tif (this.#model.isDefaultRule())\n\t\t{\n\t\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_SUBTITLE_DEFAULT');\n\t\t}\n\n\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_SUBTITLE_PERSONAL');\n\t}\n\n\t#renderExpandRuleButton(): HTMLElement|string\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.expandRuleArrow = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-select-arrow ${this.#model.isCollapsed() ? '' : '--active'}\"></div>\n\t\t`;\n\n\t\tthis.#layout.expandRuleButton = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-expand\">\n\t\t\t\t${this.#layout.expandRuleArrow}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.expandRuleButton, 'click', this.#toggleExpand.bind(this));\n\n\t\treturn this.#layout.expandRuleButton;\n\t}\n\n\t#renderRule(): HTMLElement\n\t{\n\t\tthis.#layout.rule = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-rule\">\n\t\t\t\t${this.#renderRanges()}\n\t\t\t\t<div class=\"calendar-sharing__settings-slotSize\">\n\t\t\t\t\t<span class=\"calendar-sharing__settings-slotSize-title\">${Loc.getMessage('CALENDAR_SHARING_SETTINGS_SLOT_SIZE_V2')}</span>\n\t\t\t\t\t${this.#renderSettingsSlotSizeSelect()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.rule;\n\t}\n\n\t#toggleExpand(): void\n\t{\n\t\tthis.#updateRuleHeight();\n\t\tsetTimeout(() => {\n\t\t\tDom.toggleClass(this.#layout.wrap, '--hide');\n\t\t\tDom.toggleClass(this.#layout.expandRuleArrow, '--active');\n\n\t\t\tthis.#model.updateCollapsed(Dom.hasClass(this.#layout.wrap, '--hide'));\n\t\t}, 0);\n\t}\n\n\t#updateRuleHeight(): void\n\t{\n\t\tDom.style(this.#layout.rule, 'height', `${this.#calculateRuleHeight()}px`);\n\t}\n\n\t#renderRanges(): HTMLElement\n\t{\n\t\tthis.#layout.ranges?.forEach((range) => range.destroy());\n\t\tthis.#layout.ranges = this.#rule.getRanges().map((range) => this.#createRange(range));\n\n\t\tconst rangesContainer = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-range-list\">\n\t\t\t\t${this.#layout.ranges.map((range) => range.render())}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.rangesContainer?.replaceWith(rangesContainer);\n\t\tthis.#layout.rangesContainer = rangesContainer;\n\n\t\tthis.#layout.ranges.forEach((range) => range.updateWeekdaysTitle());\n\n\t\treturn rangesContainer;\n\t}\n\n\t#createRange(range): Range\n\t{\n\t\treturn new Range({\n\t\t\tmodel: range,\n\t\t\treadOnly: this.readOnly,\n\t\t\tshowReadOnlyPopup: this.#showReadOnlyPopup.bind(this),\n\t\t});\n\t}\n\n\t#renderSettingsSlotSizeSelect(): HTMLElement\n\t{\n\t\tthis.#layout.slotSizeText = Tag.render`\n\t\t\t<span class=\"calendar-sharing__settings-select-link\">\n\t\t\t\t${this.#rule.getFormattedSlotSize()}\n\t\t\t</span>\n\t\t`;\n\n\t\tthis.#layout.slotSizeSelect = Tag.render`\n\t\t\t<span class=\"calendar-sharing__settings-select-arrow --small-arrow\">\n\t\t\t\t${this.#layout.slotSizeText}\n\t\t\t</span>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.slotSizeSelect, 'click', this.#slotSizeSelectClickHandler.bind(this));\n\n\t\tthis.slotSizeMenu = MenuManager.create({\n\t\t\tid: `calendar-sharing-settings-slotSize${Date.now()}`,\n\t\t\tbindElement: this.#layout.slotSizeSelect,\n\t\t\titems: this.#model.getRule().getAvailableIntervals().map((minutes) => {\n\t\t\t\treturn {\n\t\t\t\t\ttext: Util.formatDuration(minutes),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#rule.setSlotSize(minutes);\n\t\t\t\t\t\tthis.#layout.slotSizeText.innerHTML = this.#rule.getFormattedSlotSize();\n\t\t\t\t\t\tthis.slotSizeMenu.close();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}),\n\t\t\tcloseByEsc: true,\n\t\t\tevents: {\n\t\t\t\tonShow: () => Dom.addClass(this.#layout.slotSizeSelect, '--active'),\n\t\t\t\tonClose: () => Dom.removeClass(this.#layout.slotSizeSelect, '--active'),\n\t\t\t},\n\t\t});\n\n\t\treturn this.#layout.slotSizeSelect;\n\t}\n\n\t#calculateRuleHeight(): number\n\t{\n\t\tconst topMarginHeight = 10;\n\t\tconst bottomMarginHeight = 2;\n\t\tconst marginsHeight = topMarginHeight + bottomMarginHeight;\n\t\tconst slotSizeHeight = 15;\n\t\tconst rangeHeight = 45;\n\n\t\treturn rangeHeight * this.#model.getRule().getRanges().length + (marginsHeight + slotSizeHeight);\n\t}\n\n\t#removeRuleHeight(): void\n\t{\n\t\tDom.style(this.#layout.rule, 'height', null);\n\t}\n\n\t#slotSizeSelectClickHandler(): void\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.#showReadOnlyPopup(this.#layout.slotSizeSelect);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.slotSizeMenu.show();\n\t\t}\n\t}\n\n\t#showReadOnlyPopup(pivotNode): void\n\t{\n\t\tthis.#closeReadOnlyPopup();\n\t\tthis.#getReadOnlyPopup(pivotNode).show();\n\t}\n\n\t#getReadOnlyPopup(pivotNode): Popup\n\t{\n\t\tthis.readOnlyPopup = new Popup({\n\t\t\tbindElement: pivotNode,\n\t\t\tclassName: 'calendar-sharing__settings-read-only-hint',\n\t\t\tcontent: Loc.getMessage('CALENDAR_SHARING_SETTINGS_READ_ONLY_HINT'),\n\t\t\tangle: {\n\t\t\t\toffset: 0,\n\t\t\t},\n\t\t\twidth: 300,\n\t\t\toffsetLeft: pivotNode.offsetWidth / 2,\n\t\t\tdarkMode: true,\n\t\t\tautoHide: true,\n\t\t});\n\n\t\tEvent.bind(this.readOnlyPopup.popupContainer, 'click', () => this.#closeReadOnlyPopup());\n\n\t\tclearTimeout(this.closePopupTimeout);\n\t\tthis.closePopupTimeout = setTimeout(() => this.#closeReadOnlyPopup(), 3000);\n\n\t\treturn this.readOnlyPopup;\n\t}\n\n\t#closeReadOnlyPopup(): void\n\t{\n\t\tthis.readOnlyPopup?.destroy();\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport default class HintInfo\n{\n\t#bindElement: HTMLElement;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t};\n\t#popup: Popup;\n\n\tconstructor(props)\n\t{\n\t\tthis.#bindElement = props.bindElement;\n\t\tthis.#layout = {};\n\n\t\tthis.#popup = new Popup({\n\t\t\tbindElement: this.#bindElement,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tangle: {\n\t\t\t\toffset: this.#bindElement.offsetWidth / 2 + 24,\n\t\t\t},\n\t\t\tborderRadius: '24px',\n\t\t\twidth: 425,\n\t\t\tcontent: this.getContent(),\n\t\t\tanimation: 'fading-slide',\n\t\t});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-wrapper\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_HINT_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-desc\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_HINT_DESC')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-icon\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#popup?.show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n}","import { Text, Dom, Loc, Tag, Event } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport HintInfo from './hint-info';\nimport { SettingsModel } from '../../model/index';\nimport 'ui.icon-set.actions';\n\nexport default class UserSelector\n{\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\ttitle: HTMLElement,\n\t\tchevron: HTMLElement,\n\t\tuserSelectorWrapper: HTMLElement,\n\t\tuserSelector: HTMLElement,\n\t\thint: HTMLElement,\n\t};\n\t#userSelectorDialog: Dialog;\n\t#selectedEntityList: any;\n\t#selectedEntityNodeList: any;\n\t#defaultUserEntity: any;\n\t#isOpened: boolean;\n\t#onMembersAdded: function;\n\n\t#model: SettingsModel;\n\n\tconstructor(props = {})\n\t{\n\t\tthis.#layout = {};\n\t\tthis.#userSelectorDialog = null;\n\t\tthis.#selectedEntityList = {};\n\t\tthis.#selectedEntityNodeList = {};\n\t\tthis.#model = props.model;\n\t\tthis.#defaultUserEntity = this.#model.getUserInfo();\n\t\tthis.#isOpened = false;\n\t\tthis.#onMembersAdded = props.onMembersAdded;\n\n\t\tthis.openEntitySelector = this.openEntitySelector.bind(this);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tconst contextClass = `--${this.#model.getContext()}`;\n\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-main ${contextClass}\">\n\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t${this.renderUserSelectorWrapper()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-title\">\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-title-icon\"></div>\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-title-text\">\n\t\t\t\t\t\t${this.#getTitleText()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst infoNotify = this.#layout.title.querySelector('[ data-role=\"calendar-sharing_popup-joint-slots\"]');\n\n\t\t\tif (infoNotify)\n\t\t\t{\n\t\t\t\tlet hintInfo;\n\t\t\t\tlet timer;\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseenter', () => {\n\t\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\t\tif (!hintInfo)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thintInfo = new HintInfo({\n\t\t\t\t\t\t\t\tbindElement: infoNotify,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thintInfo.show();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseleave', () => {\n\t\t\t\t\tclearTimeout(timer);\n\n\t\t\t\t\tif (hintInfo)\n\t\t\t\t\t{\n\t\t\t\t\t\thintInfo.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\t#getTitleText(): string\n\t{\n\t\tswitch (this.#model.getContext())\n\t\t{\n\t\t\tcase 'calendar':\n\t\t\t\treturn Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_TITLE_V2');\n\t\t\tcase 'crm':\n\t\t\t\treturn Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_TITLE_CRM');\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\trenderUserSelectorWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.userSelectorWrapper)\n\t\t{\n\t\t\tthis.#layout.userSelectorWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-wrapper\">\n\t\t\t\t\t${this.renderUserSelector()}\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-add\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --plus-20\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.userSelectorWrapper, 'click', this.openEntitySelector);\n\t\t}\n\n\t\treturn this.#layout.userSelectorWrapper;\n\t}\n\n\trenderUserSelector(): HTMLElement\n\t{\n\t\tif (!this.#layout.userSelector)\n\t\t{\n\t\t\tconst entityNode = this.getDefaultEntityNode();\n\n\t\t\tthis.#layout.userSelector = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-container\" data-id=\"calendar-sharing-members\">\n\t\t\t\t\t${entityNode}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.userSelector;\n\t}\n\n\tgetDefaultEntityNode(): HTMLElement\n\t{\n\t\tconst entityNode = this.renderUserEntity(this.#defaultUserEntity);\n\t\tconst key = this.getEntityKey(this.#defaultUserEntity.id);\n\t\tthis.#selectedEntityList[key] = this.#defaultUserEntity;\n\t\tthis.#selectedEntityNodeList[key] = entityNode;\n\t\tthis.#model.setMemberIds(this.getSelectedUserIdList());\n\n\t\treturn entityNode;\n\t}\n\n\trenderUserEntity(entity): HTMLElement\n\t{\n\t\tif (this.hasAvatar(entity.avatar))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-entity-container\">\n\t\t\t\t\t<img class=\"calendar-sharing__user-selector-entity\" title=\"${Text.encode(entity.name)}\" src=\"${entity.avatar}\" alt=\"\">\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user calendar-sharing__user-selector-entity\" title=\"${Text.encode(entity?.name)}\"><i></i></div>\n\t\t`;\n\t}\n\n\thasAvatar(avatar): boolean\n\t{\n\t\treturn avatar && avatar !== '/bitrix/images/1.gif';\n\t}\n\n\topenEntitySelector(): void\n\t{\n\t\tif (!this.#layout.userSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst preselectedItem = ['user', this.#defaultUserEntity.id];\n\n\t\tif (!this.#userSelectorDialog)\n\t\t{\n\t\t\tthis.#userSelectorDialog = new Dialog({\n\t\t\t\twidth: 340,\n\t\t\t\ttargetNode: this.#layout.userSelector,\n\t\t\t\tcontext: 'CALENDAR_SHARING',\n\t\t\t\tpreselectedItems: [preselectedItem],\n\t\t\t\tenableSearch: true,\n\t\t\t\tzIndex: 4200,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.onUserSelectorSelect(event);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.onUserSelectorDeselect(event);\n\t\t\t\t\t},\n\t\t\t\t\t'onHide': () => {\n\t\t\t\t\t\tif (this.hasChanges())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#onMembersAdded();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfilters: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: 'calendar.jointSharingFilter',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\tthis.#userSelectorDialog.show();\n\t}\n\n\tisUserSelectorDialogOpened(): boolean\n\t{\n\t\tif (this.#userSelectorDialog)\n\t\t{\n\t\t\treturn this.#userSelectorDialog.isOpen();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonUserSelectorSelect(event): void\n\t{\n\t\tconst item = event.data.item;\n\t\tconst entity = {\n\t\t\tid: item.id,\n\t\t\tavatar: item.avatar,\n\t\t\tname: `${item.customData.get('name')} ${item.customData.get('lastName') ?? ''}`.trim(),\n\t\t};\n\t\tconst entityNode = this.renderUserEntity(entity);\n\n\t\tif (this.#layout.userSelector)\n\t\t{\n\t\t\tDom.append(entityNode, this.#layout.userSelector);\n\t\t}\n\n\t\tconst key = this.getEntityKey(entity.id);\n\n\t\tthis.#selectedEntityList[key] = entity;\n\t\tthis.#selectedEntityNodeList[key] = entityNode;\n\t\tthis.#model.setMemberIds(this.getSelectedUserIdList());\n\t}\n\n\tonUserSelectorDeselect(event): void\n\t{\n\t\tconst item = event.data.item;\n\t\tconst key = this.getEntityKey(item.id);\n\n\t\tconst entityNode = this.#selectedEntityNodeList[key];\n\n\t\tif (entityNode)\n\t\t{\n\t\t\tDom.remove(entityNode);\n\t\t\tdelete this.#selectedEntityList[key];\n\t\t\tdelete this.#selectedEntityNodeList[key];\n\t\t}\n\n\t\tthis.#model.setMemberIds(this.getSelectedUserIdList());\n\t}\n\n\tclearSelectedUsers(): void\n\t{\n\t\tif (this.#layout.userSelector)\n\t\t{\n\t\t\tDom.clean(this.#layout.userSelector);\n\t\t\tthis.#selectedEntityList = {};\n\t\t\tthis.#selectedEntityNodeList = {};\n\n\t\t\tconst entityNode = this.getDefaultEntityNode();\n\t\t\tDom.append(entityNode, this.#layout.userSelector);\n\t\t}\n\n\t\tif (this.#userSelectorDialog)\n\t\t{\n\t\t\tthis.#userSelectorDialog.destroy();\n\t\t\tthis.#userSelectorDialog = null;\n\t\t}\n\t}\n\n\thasChanges(): boolean\n\t{\n\t\treturn this.getPeopleCount() > 1;\n\t}\n\n\tgetPeopleCount(): any\n\t{\n\t\treturn Object.keys(this.#selectedEntityList).length;\n\t}\n\n\tgetSelectedUserIdList(): any\n\t{\n\t\tconst result = [];\n\n\t\tObject.values(this.#selectedEntityList).forEach((entity) => {\n\t\t\tresult.push(entity.id);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetEntityKey(id)\n\t{\n\t\treturn `user-${id}`;\n\t}\n}","import { Text, Dom, Tag, Loc, Event } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { Icon, Actions, Main } from 'ui.icon-set.api.core';\nimport { MenuManager, Menu } from 'main.popup';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { Button, ButtonSize, ButtonColor } from 'ui.buttons';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.icon-set.actions';\n\nconst MAX_AVATAR_COUNT = 4;\n\ntype ListItemProps = {\n\tid: number,\n\thash: string,\n\tshortUrl: string,\n\tmembers: any,\n\tfrequentUse: number,\n\tuserId: number,\n\tuserIds: any,\n\tuserInfo: any,\n\ttype: string,\n\tpathToUser: string,\n\tsetListItemPopupState: func,\n\tdateCreate: string,\n};\n\nexport default class ListItem\n{\n\t#props: ListItemProps;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\tavatarContainer: HTMLElement,\n\t\tdate: HTMLElement,\n\t\tcopyButton: HTMLElement,\n\t\tdeleteButton: HTMLElement,\n\t};\n\n\t#avatarPopup: Menu;\n\t#deletePopup: MessageBox;\n\n\tconstructor(props: ListItemProps)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#layout = {};\n\t\tthis.#avatarPopup = null;\n\t\tthis.#deletePopup = null;\n\n\t\tthis.openAvatarList = this.openAvatarList.bind(this);\n\t\tthis.onCopyButtonClick = this.onCopyButtonClick.bind(this);\n\t\tthis.onDeleteButtonClick = this.onDeleteButtonClick.bind(this);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item\">\n\t\t\t\t\t${this.renderAvatarContainer()}\n\t\t\t\t\t${this.renderDate()}\n\t\t\t\t\t${this.renderCopyButton()}\n\t\t\t\t\t${this.renderDeleteButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trenderAvatarContainer(): HTMLElement\n\t{\n\t\tif (!this.#layout.avatarContainer)\n\t\t{\n\t\t\tconst showMoreIcon = this.#props.members.length > MAX_AVATAR_COUNT;\n\t\t\tconst moreCounter = this.#props.members.length - MAX_AVATAR_COUNT;\n\n\t\t\tthis.#layout.avatarContainer = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-avatar-container\">\n\t\t\t\t\t${this.renderAvatar(this.#props.userInfo)}\n\t\t\t\t\t${this.#props.members.slice(0, MAX_AVATAR_COUNT).map((member) => this.renderAvatar(member))}\n\t\t\t\t\t${showMoreIcon ? this.renderMore(moreCounter) : null}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.avatarContainer, 'click', this.openAvatarList);\n\t\t}\n\n\t\treturn this.#layout.avatarContainer;\n\t}\n\n\trenderAvatar(user): HTMLElement\n\t{\n\t\tconst name = `${user.name} ${user.lastName ?? ''}`.trim();\n\n\t\tif (this.hasAvatar(user.avatar))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<img class=\"calendar-sharing__dialog-link-list-item-avatar\" title=\"${Text.encode(name)}\" alt=\"\" src=\"${user.avatar}\">\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user calendar-sharing__dialog-link-list-item-avatar\" title=\"${Text.encode(name)}\"><i></i></div>\n\t\t`;\n\t}\n\n\thasAvatar(avatar): boolean\n\t{\n\t\treturn avatar && avatar !== '/bitrix/images/1.gif';\n\t}\n\n\trenderMore(counter): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-more\">\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-more-text\">${`+${counter}`}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\topenAvatarList(): void\n\t{\n\t\tif (!this.#avatarPopup)\n\t\t{\n\t\t\tconst uid = BX.util.getRandomString(6);\n\n\t\t\tthis.#avatarPopup = MenuManager.create({\n\t\t\t\tid: `calendar-sharing-dialog_${uid}`,\n\t\t\t\tbindElement: this.#layout.avatarContainer,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tclassName: 'calendar-sharing__dialog-link-list-user-popup-container',\n\t\t\t\titems: this.getAvatarPopupItems(),\n\t\t\t\tmaxHeight: 250,\n\t\t\t\tmaxWidth: 300,\n\t\t\t});\n\t\t\tthis.#avatarPopup.getPopupWindow().subscribe('onClose', () => {\n\t\t\t\tthis.setPopupState(false);\n\t\t\t});\n\n\t\t\tconst menuContainer = this.#avatarPopup.getMenuContainer();\n\n\t\t\t// eslint-disable-next-line init-declarations\n\t\t\tlet timeout;\n\n\t\t\tEvent.bind(menuContainer, 'mouseleave', () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(() => {\n\t\t\t\t\tthis.closeAvatarList();\n\t\t\t\t}, 500);\n\t\t\t});\n\t\t\tEvent.bind(menuContainer, 'mouseenter', () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t});\n\t\t}\n\n\t\tthis.#avatarPopup.show();\n\t\tthis.setPopupState(true);\n\t}\n\n\tcloseAvatarList(): void\n\t{\n\t\tif (this.#avatarPopup)\n\t\t{\n\t\t\tthis.#avatarPopup.close();\n\t\t}\n\t}\n\n\tgetAvatarPopupItems(): any\n\t{\n\t\tconst result = [];\n\n\t\tresult.push(this.getAvatarPopupItem(this.#props.userInfo));\n\t\tthis.#props.members.forEach((member) => {\n\t\t\tresult.push(this.getAvatarPopupItem(member));\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetAvatarPopupItem(user): any\n\t{\n\t\tconst avatar = user.avatar;\n\t\tconst name = `${user.name} ${user.lastName ?? ''}`.trim();\n\t\tconst userPath = this.#props.pathToUser.replace('#USER_ID#', user.id);\n\n\t\treturn {\n\t\t\thtml: Tag.render`\n\t\t\t\t<a href=\"${userPath}\" target=\"_blank\" class=\"calendar-sharing__dialog-link-list-user-popup-item\">\n\t\t\t\t\t<span class=\"ui-icon ui-icon-common-user calendar-sharing__dialog-link-list-user-popup-item-avatar\">\n\t\t\t\t\t\t<i style=\"${this.hasAvatar(avatar) ? `background-image: url('${avatar}')` : ''}\"></i>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-user-popup-item-text\">\n\t\t\t\t\t\t${Text.encode(name)}\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`,\n\t\t};\n\t}\n\n\trenderDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.date)\n\t\t{\n\t\t\tconst date = this.#props.dateCreate\n\t\t\t\t? new Date(this.#props.dateCreate)\n\t\t\t\t: new Date()\n\t\t\t;\n\t\t\tconst formattedDate = Util.formatDate(date);\n\n\t\t\tthis.#layout.date = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-date\" title=\"${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DATE_CREATE')}\">${formattedDate}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.date;\n\t}\n\n\trenderCopyButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.copyButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Main.LINK_3,\n\t\t\t\tsize: 14,\n\t\t\t});\n\n\t\t\tthis.#layout.copyButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-copy-container\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-copy-text\">${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_COPY')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.copyButton, 'click', this.onCopyButtonClick);\n\t\t}\n\n\t\treturn this.#layout.copyButton;\n\t}\n\n\tonCopyButtonClick(): void\n\t{\n\t\tEventEmitter.emit('CalendarSharing:onJointLinkCopy', {\n\t\t\tid: this.#props.id,\n\t\t\tshortUrl: this.#props.shortUrl,\n\t\t\thash: this.#props.hash,\n\t\t\tmembers: this.#props.members,\n\t\t});\n\t}\n\n\trenderDeleteButton(): HTMLElement\n\t{\n\t\tif (this.#props.members.length === 0)\n\t\t{\n\t\t\treturn Tag.render`<div class=\"calendar-sharing__dialog-link-list-item-delete\"></div>`;\n\t\t}\n\n\t\tif (!this.#layout.deleteButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.CROSS_30,\n\t\t\t\tsize: 18,\n\t\t\t});\n\n\t\t\tthis.#layout.deleteButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-delete\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.deleteButton, 'click', this.onDeleteButtonClick);\n\t\t}\n\n\t\treturn this.#layout.deleteButton;\n\t}\n\n\tonDeleteButtonClick(): void\n\t{\n\t\tif (!this.#deletePopup)\n\t\t{\n\t\t\tthis.#deletePopup = new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DELETE_MESSAGE_TITLE_MSGVER_1'),\n\t\t\t\tmessage: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DELETE_MESSAGE_DESC_MSGVER_1'),\n\t\t\t\tbuttons: this.getDeletePopupButtons(),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tminWidth: 365,\n\t\t\t\t\tmaxWidth: 385,\n\t\t\t\t\tminHeight: 180,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.#deletePopup.show();\n\t\tthis.setPopupState(true);\n\t}\n\n\tgetDeletePopupButtons(): any\n\t{\n\t\treturn [\n\t\t\tnew Button({\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\tcolor: ButtonColor.DANGER,\n\t\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_SUBMIT_BUTTON_NEW_MSGVER_1'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.deleteLink();\n\t\t\t\t\t\tthis.#deletePopup.close();\n\t\t\t\t\t\tthis.setPopupState(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew Button({\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_CANCEL_BUTTON'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.#deletePopup.close();\n\t\t\t\t\t\tthis.setPopupState(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t];\n\t}\n\n\tdeleteLink(): void\n\t{\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tBX.ajax.runAction('calendar.api.sharingajax.disableUserLink', {\n\t\t\t\tdata: {\n\t\t\t\t\thash: this.#props.hash,\n\t\t\t\t},\n\t\t\t});\n\t\t\tDom.addClass(this.#layout.wrapper, '--animate-delete');\n\t\t\tsetTimeout(() => {\n\t\t\t\tDom.remove(this.#layout.wrapper);\n\t\t\t}, 300);\n\n\t\t\tEventEmitter.emit('CalendarSharing:onJointLinkDelete', {\n\t\t\t\tid: this.#props.id,\n\t\t\t});\n\t\t}\n\t}\n\n\tsetPopupState(state): void\n\t{\n\t\tthis.#props?.setListItemPopupState(state);\n\t}\n}\n","import { Dom, Tag, Loc, Event, Type } from 'main.core';\nimport { Icon, Actions } from 'ui.icon-set.api.core';\nimport { EventEmitter } from 'main.core.events';\nimport { SettingsModel } from '../../model/index';\nimport ListItem from './list-item';\nimport 'ui.icon-set.actions'\n\nconst DEFAULT_LIST_HEIGHT = 300;\nconst LIST_PADDING_SUM = 45;\n\ntype ListProps = {\n\tmodel: SettingsModel,\n\tonLinkListClose: function,\n};\n\nexport default class List\n{\n\t#props: ListProps;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\ttitle: HTMLElement,\n\t\tsortingButton: HTMLElement,\n\t\tsortingButtonText: HTMLElement,\n\t\tbackButton: HTMLElement,\n\t\tlist: HTMLElement,\n\t\temptyState: HTMLElement,\n\t};\n\t#linkList: any;\n\t#popupOpenState = false;\n\t#pathToUser: string;\n\n\tconstructor(props: ListProps)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#layout = {};\n\t\tthis.#linkList = null;\n\t\tthis.#pathToUser = null;\n\t\tthis.getLinkListInfo();\n\n\t\tthis.setListItemPopupState = this.setListItemPopupState.bind(this);\n\n\t\tthis.eventSubscribe();\n\t}\n\n\tget #model(): SettingsModel\n\t{\n\t\treturn this.#props.model;\n\t}\n\n\teventSubscribe()\n\t{\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkCopy', (event) => {\n\t\t\tthis.onJointLinkCopy(event);\n\t\t});\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkDelete', (event) => {\n\t\t\tthis.onJointLinkDelete(event);\n\t\t});\n\t}\n\n\tgetLinkListInfo(): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.getAllUserLink').then((response) => {\n\t\t\tif (response && response.data)\n\t\t\t{\n\t\t\t\tthis.#linkList = response.data.userLinks;\n\t\t\t\tthis.#pathToUser = response.data.pathToUser;\n\n\t\t\t\tthis.updateLinkList();\n\n\t\t\t\tif (this.isListEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSortingButton();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.#linkList)\n\t\t\t\t{\n\t\t\t\t\tthis.showSortingButton();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper =  Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-wrapper\">\n\t\t\t\t\t${this.getTitleNode()}\n\t\t\t\t\t${this.getListNode()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\tgetTitleNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title =  Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title\">\n\t\t\t\t\t\t${this.getChevronBackIcon()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getSortingButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\tgetChevronBackIcon(): HTMLElement\n\t{\n\t\tif (!this.#layout.backButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.CHEVRON_LEFT,\n\t\t\t\tsize: 24,\n\t\t\t});\n\n\t\t\tthis.#layout.backButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-back-button\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.backButton, 'click', this.close.bind(this));\n\t\t}\n\n\t\treturn this.#layout.backButton;\n\t}\n\n\tgetSortingButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.sortingButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.SORT,\n\t\t\t\tsize: 14,\n\t\t\t\tcolor: '#2066b0',\n\t\t\t});\n\n\t\t\tthis.#layout.sortingButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-sorting-button\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t\t${this.getSortingButtonText()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.sortingButton, 'click', this.changeListSort.bind(this));\n\t\t}\n\n\t\treturn this.#layout.sortingButton;\n\t}\n\n\tgetSortingButtonText(): HTMLElement\n\t{\n\t\tif (!this.#layout.sortingButtonText)\n\t\t{\n\t\t\tthis.#layout.sortingButtonText = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-sorting-button-text\">\n\t\t\t\t\t${this.#getSortingName()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.sortingButtonText;\n\t}\n\n\tgetListNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.list)\n\t\t{\n\t\t\tthis.#layout.list = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-container\">\n\t\t\t\t\t${this.getListItemsNode()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.list;\n\t}\n\n\tgetListItemsNode(): HTMLElement\n\t{\n\t\tif (this.isListEmpty())\n\t\t{\n\t\t\treturn this.getEmptyStateNode();\n\t\t}\n\n\t\tconst linkListItems = this.getListItems();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-link-list\">\n\t\t\t\t${linkListItems.map((listItem) => listItem.render())}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyStateNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.emptyState)\n\t\t{\n\t\t\tthis.#layout.emptyState = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-icon\"></div>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-text\">${Loc.getMessage('CALENDAR_SHARING_LIST_EMPTY_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.emptyState;\n\t}\n\n\tgetListItems(): any\n\t{\n\t\tif (this.#model.sortJointLinksByFrequentUse())\n\t\t{\n\t\t\treturn this.getSortedByFrequentUseListItems();\n\t\t}\n\n\t\treturn this.getSortedByDateListItems();\n\t}\n\n\tgetSortedByFrequentUseListItems(): any\n\t{\n\t\treturn Object.values(this.#linkList).sort((a, b) => {\n\t\t\tif (a.frequentUse > b.frequentUse)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.frequentUse < b.frequentUse)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.id > b.id)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.id < b.id)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}).map((item) => new ListItem({\n\t\t\t...item,\n\t\t\tuserInfo: this.#model.getUserInfo(),\n\t\t\tpathToUser: this.#pathToUser,\n\t\t\tsetListItemPopupState: this.setListItemPopupState,\n\t\t}));\n\t}\n\n\tgetSortedByDateListItems(): any\n\t{\n\t\treturn Object.keys(this.#linkList).sort((a, b) => b - a).map((index) => {\n\t\t\treturn new ListItem({\n\t\t\t\t...this.#linkList[index],\n\t\t\t\tuserInfo: this.#model.getUserInfo(),\n\t\t\t\tpathToUser: this.#pathToUser,\n\t\t\t\tsetListItemPopupState: this.setListItemPopupState,\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(maxListHeight): void\n\t{\n\t\tif (this.#layout.list && maxListHeight)\n\t\t{\n\t\t\tDom.style(this.#layout.list, 'max-height', `${maxListHeight - LIST_PADDING_SUM}px`);\n\t\t}\n\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tDom.addClass(this.#layout.wrapper, '--show');\n\t\t}\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.#layout.list)\n\t\t{\n\t\t\tDom.style(this.#layout.list, 'max-height', `${DEFAULT_LIST_HEIGHT}px`);\n\t\t}\n\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.wrapper, '--show');\n\t\t}\n\n\t\tif (this.#props.onLinkListClose)\n\t\t{\n\t\t\tthis.#props.onLinkListClose();\n\t\t}\n\t}\n\n\tupdateLinkList(): void\n\t{\n\t\tif (this.#layout.list)\n\t\t{\n\t\t\tDom.clean(this.getListNode());\n\n\t\t\tconst listItems = this.getListItemsNode();\n\t\t\tDom.append(listItems, this.#layout.list);\n\t\t}\n\t}\n\n\tchangeListSort(): void\n\t{\n\t\tthis.#model.changeSortJointLinksByFrequentUse();\n\n\t\tif (this.#layout.sortingButtonText)\n\t\t{\n\t\t\tDom.adjust(this.#layout.sortingButtonText, {\n\t\t\t\ttext: this.#getSortingName(),\n\t\t\t});\n\t\t}\n\n\t\tthis.updateLinkList();\n\t}\n\n\t#getSortingName(): string\n\t{\n\t\treturn this.#model.sortJointLinksByFrequentUse()\n\t\t\t? Loc.getMessage('CALENDAR_SHARING_LINK_LIST_SORT_RECENT')\n\t\t\t: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_SORT_DATE');\n\t}\n\n\tsetListItemPopupState(state): void\n\t{\n\t\tthis.#popupOpenState = state;\n\t}\n\n\tisOpenListItemPopup(): boolean\n\t{\n\t\treturn this.#popupOpenState;\n\t}\n\n\tonJointLinkCopy(event): void\n\t{\n\t\tconst id = event.data.id;\n\t\tconst hash = event.data.hash;\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.#linkList[id])\n\t\t\t{\n\t\t\t\tthis.#linkList[id].frequentUse = this.#linkList[id].frequentUse + 1;\n\t\t\t\tthis.updateLinkList();\n\t\t\t}\n\t\t}, 1000);\n\n\t\tBX.ajax.runAction('calendar.api.sharingajax.increaseFrequentUse', {\n\t\t\tdata: {\n\t\t\t\thash,\n\t\t\t},\n\t\t});\n\t}\n\n\tonJointLinkDelete(event): void\n\t{\n\t\tconst id = event.data.id;\n\n\t\tif (this.#linkList[id])\n\t\t{\n\t\t\tdelete this.#linkList[id];\n\t\t}\n\n\t\tif (this.isListEmpty())\n\t\t{\n\t\t\tthis.updateLinkList();\n\t\t\tthis.hideSortingButton();\n\t\t}\n\t}\n\n\tisListEmpty()\n\t{\n\t\treturn Type.isNil(this.#linkList)\n\t\t\t|| (Type.isArray(this.#linkList) && !Type.isArrayFilled(this.#linkList))\n\t\t\t|| (Type.isObject(this.#linkList) && !Object.keys(this.#linkList).length)\n\t\t;\n\t}\n\n\thideSortingButton()\n\t{\n\t\tif (this.#layout.sortingButton)\n\t\t{\n\t\t\tDom.addClass(this.#layout.sortingButton, '--hide');\n\t\t}\n\t}\n\n\tshowSortingButton()\n\t{\n\t\tif (this.#layout.sortingButton)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.sortingButton, '--hide');\n\t\t}\n\t}\n}","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Analytics } from 'calendar.sharing.analytics';\nimport { Util } from 'calendar.util';\nimport Settings from './rule/settings';\nimport UserSelector from './joint/user-selector';\nimport List from './link-list/list';\n\nimport { SettingsModel } from '../model/index';\n\nexport type LayoutParams = {\n\treadOnly: boolean,\n\tsettingsModel: SettingsModel,\n\texternalIcon: HTMLElement,\n};\n\nexport class Layout\n{\n\tHELP_DESK_CODE_CALENDAR = 17198666;\n\tHELP_DESK_CODE_CRM = 17502612;\n\n\tCONTEXT = {\n\t\tCRM: 'crm',\n\t\tCALENDAR: 'calendar',\n\t};\n\n\t#params: LayoutParams;\n\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tmain: HTMLElement,\n\t\tmainTop: HTMLElement,\n\t\tmainBottom: HTMLElement,\n\t\tbuttonHistory: HTMLElement,\n\t\tbuttonCopy: HTMLElement,\n\t\tbuttonWhatSeeUsers: HTMLElement,\n\t};\n\n\t#settingsControl: Settings;\n\t#userSelectorControl: UserSelector;\n\t#linkList: List;\n\n\tconstructor(params: LayoutParams)\n\t{\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#bindEvents();\n\t}\n\n\tget #settingsModel(): SettingsModel\n\t{\n\t\treturn this.#params.settingsModel;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEvent.bind(window, 'beforeunload', () => this.#settingsModel.save());\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkCopy', (event) => {\n\t\t\tconst shortUrl = event.data.shortUrl;\n\t\t\tconst linkHash = event.data.hash;\n\n\t\t\tthis.copyLink(shortUrl, linkHash);\n\n\t\t\tAnalytics.sendLinkCopiedList(this.#settingsModel.getContext(), {\n\t\t\t\tpeopleCount: event.data.members.length + 1,\n\t\t\t\truleChanges: this.#settingsModel.getChanges(),\n\t\t\t});\n\t\t});\n\t}\n\n\treset(): void\n\t{\n\t\tvoid this.#settingsModel.save();\n\t\tthis.#userSelectorControl?.clearSelectedUsers();\n\t\tsetTimeout(() => this.#linkList?.close(), 200);\n\t}\n\n\thasShownPopups(): boolean\n\t{\n\t\tconst isSettingsPopupShown = this.#settingsControl.hasShownPopups();\n\t\tconst isUserSelectorDialogOpened = this.#userSelectorControl?.isUserSelectorDialogOpened();\n\t\tconst isListItemPopupOpened = this.#linkList?.isOpenListItemPopup();\n\n\t\treturn isSettingsPopupShown || isUserSelectorDialogOpened || isListItemPopupOpened;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-wrapper\">\n\t\t\t\t${this.#renderMain()}\n\t\t\t\t${this.#renderLinkList()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderMain(): HTMLElement\n\t{\n\t\tthis.#layout.main ??= Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-content-wrapper --show\">\n\t\t\t\t${this.#renderTop()}\n\t\t\t\t<div class=\"calendar-sharing__dialog-body\">\n\t\t\t\t\t${this.#renderDialogMessage()}\n\t\t\t\t\t${this.#renderSettings()}\n\t\t\t\t\t${this.#renderMembers()}\n\t\t\t\t</div>\n\t\t\t\t${this.#renderMainBottom()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.main;\n\t}\n\n\t#renderDialogMessage(): HTMLElement|string\n\t{\n\t\tif (this.#settingsModel.getContext() === this.CONTEXT.CRM)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-message\">\n\t\t\t\t<div class=\"calendar-sharing__dialog-info-icon-container\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-info-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-sharing__dialog-notify\" onclick=\"${this.#onOpenLink.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('SHARING_INFO_POPUP_CONTENT_4_V3', { '#LINK#': this.#settingsModel.getSharingUrl() })}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tasync #onOpenLink(): Promise\n\t{\n\t\tawait this.#settingsModel.save();\n\t\twindow.open(this.#settingsModel.getSharingUrl(), '_blank').focus();\n\t}\n\n\t#renderTop(): HTMLElement\n\t{\n\t\tif (!this.#layout.mainTop)\n\t\t{\n\t\t\tthis.#layout.mainTop = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-top\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-title\">\n\t\t\t\t\t\t<span>${Loc.getMessage('SHARING_BUTTON_TITLE')}</span>\n\t\t\t\t\t\t${this.#renderHowDoesItWorkIcon()}\n\t\t\t\t\t\t${this.#params.externalIcon ?? ''}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-info\">\n\t\t\t\t\t\t${this.#getSharingInfoMessage()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst howDoesItWork = this.#layout.mainTop.querySelector('[data-role=\"calendar-sharing-how-does-it-work\"]');\n\t\t\tEvent.bind(howDoesItWork, 'click', this.#openHelpDesk.bind(this));\n\n\t\t\tconst infoNotify = this.#layout.mainTop.querySelector('[data-role=\"calendar-sharing_popup-open-link\"]');\n\n\t\t\tif (infoNotify)\n\t\t\t{\n\t\t\t\tlet infoNotifyHint;\n\t\t\t\tlet timer;\n\t\t\t\tEvent.bind(infoNotify, 'mouseenter', () => {\n\t\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\t\tif (!infoNotifyHint)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinfoNotifyHint = new Popup({\n\t\t\t\t\t\t\t\tbindElement: infoNotify,\n\t\t\t\t\t\t\t\tangle: {\n\t\t\t\t\t\t\t\t\toffset: infoNotify.offsetWidth / 2 + 16,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\twidth: 410,\n\t\t\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\t\t\tcontent: Loc.getMessage('SHARING_INFO_POPUP_SLOT_DESC'),\n\t\t\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinfoNotifyHint.show();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseleave', () => {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\tif (infoNotifyHint)\n\t\t\t\t\t{\n\t\t\t\t\t\tinfoNotifyHint.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.mainTop;\n\t}\n\n\t#renderHowDoesItWorkIcon(): HTMLElement|string\n\t{\n\t\tif (this.#settingsModel.getContext() === this.CONTEXT.CRM)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst howDoesItWork = Tag.render`\n\t\t\t<span\n\t\t\t\tclass=\"calendar-sharing__dialog-title-help\"\n\t\t\t\ttitle=\"${Loc.getMessage('SHARING_INFO_POPUP_HOW_IT_WORK')}\"\n\t\t\t></span>\n\t\t`;\n\n\t\tEvent.bind(howDoesItWork, 'click', this.#openHelpDesk.bind(this));\n\n\t\treturn howDoesItWork;\n\t}\n\n\t#openHelpDesk(): void\n\t{\n\t\ttop.BX.Helper.show(`redirect=detail&code=${this.#getContextHelpDeskCode()}`);\n\t}\n\n\t#getSharingInfoMessage(): string\n\t{\n\t\tswitch (this.#settingsModel.getContext())\n\t\t{\n\t\t\tcase this.CONTEXT.CALENDAR:\n\t\t\t\treturn Loc.getMessage('SHARING_INFO_POPUP_CONTENT_3_CALENDAR');\n\t\t\tcase this.CONTEXT.CRM:\n\t\t\t\treturn Loc.getMessage('SHARING_INFO_POPUP_CONTENT_3_CRM_MSGVER_2');\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\t#getContextHelpDeskCode(): number\n\t{\n\t\tswitch (this.#settingsModel.getContext())\n\t\t{\n\t\t\tcase this.CONTEXT.CALENDAR:\n\t\t\t\treturn this.HELP_DESK_CODE_CALENDAR;\n\n\t\t\tcase this.CONTEXT.CRM:\n\t\t\t\treturn this.HELP_DESK_CODE_CRM;\n\n\t\t\tdefault:\n\t\t\t\treturn 0;\n\t\t}\n\t}\n\n\t#renderSettings(): HTMLElement\n\t{\n\t\tthis.#settingsControl = new Settings({\n\t\t\treadOnly: this.#params.readOnly,\n\t\t\tmodel: this.#settingsModel,\n\t\t});\n\n\t\treturn this.#settingsControl.render();\n\t}\n\n\t#renderMembers(): HTMLElement\n\t{\n\t\tthis.#userSelectorControl = new UserSelector({\n\t\t\tmodel: this.#settingsModel,\n\t\t\tonMembersAdded: () => Analytics.sendMembersAdded(this.#settingsModel.getContext(), this.#userSelectorControl.getPeopleCount()),\n\t\t});\n\n\t\treturn this.#userSelectorControl.render();\n\t}\n\n\t#renderMainBottom(): HTMLElement\n\t{\n\t\tif (this.#settingsModel.getContext() === this.CONTEXT.CRM)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.mainBottom ??= Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-bottom\">\n\t\t\t\t${this.#renderCopyLinkButton()}\n\t\t\t\t${this.#renderLinkHistoryButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.mainBottom;\n\t}\n\n\t#renderCopyLinkButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonCopy)\n\t\t{\n\t\t\tthis.#layout.buttonCopy = Tag.render`\n\t\t\t\t<span class=\"ui-btn ui-btn-success ui-btn-round ui-btn-no-caps calendar-sharing__dialog-copy\">\n\t\t\t\t\t${Loc.getMessage('SHARING_DIALOG_SHARING_BLOCK_COPY_LINK_BUTTON')}\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonCopy, 'click', this.#onButtonCopyClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.buttonCopy;\n\t}\n\n\t#onButtonCopyClick(): void\n\t{\n\t\tconst params = {\n\t\t\tpeopleCount: this.#userSelectorControl?.getPeopleCount() ?? 1,\n\t\t\truleChanges: this.#settingsModel.getChanges(),\n\t\t};\n\n\t\tif (this.#userSelectorControl && this.#userSelectorControl.hasChanges())\n\t\t{\n\t\t\tAnalytics.sendLinkCopied(this.#settingsModel.getContext(), Analytics.linkTypes.multiple, params);\n\n\t\t\tvoid this.saveJointLink();\n\t\t}\n\t\telse if (this.copyLink(this.#settingsModel.getSharingUrl()))\n\t\t{\n\t\t\tAnalytics.sendLinkCopied(this.#settingsModel.getContext(), Analytics.linkTypes.solo, params);\n\n\t\t\tthis.#settingsModel.increaseFrequentUse();\n\t\t}\n\t}\n\n\tasync saveJointLink(): Promise\n\t{\n\t\tif (this.#layout.buttonCopy && Dom.hasClass(this.#layout.buttonCopy, 'ui-btn-clock'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.buttonCopy, 'ui-btn-clock');\n\n\t\tconst link = await this.#settingsModel.saveJointLink();\n\n\t\tDom.removeClass(this.#layout.buttonCopy, 'ui-btn-clock');\n\n\t\tthis.copyLink(link.url, link.hash);\n\n\t\tthis.#linkList?.getLinkListInfo();\n\t}\n\n\t#renderLinkHistoryButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonHistory)\n\t\t{\n\t\t\tthis.#layout.buttonHistory = Tag.render`\n\t\t\t\t<span\n\t\t\t\t\tclass=\"ui-btn ui-btn-round ui-btn-light ui-btn-no-caps calendar-sharing__dialog-people\"\n\t\t\t\t\tdata-id=\"calendar-sharing-history-btn\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('SHARING_DIALOG_SHARING_BLOCK_JOINT_SLOTS_BUTTON')}\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonHistory, 'click', this.#openLinkList.bind(this));\n\t\t}\n\n\t\treturn this.#layout.buttonHistory;\n\t}\n\n\t#renderLinkList(): HTMLElement\n\t{\n\t\tif (this.#settingsModel.getContext() === this.CONTEXT.CRM)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.#getLinkList().render();\n\t}\n\n\t#getLinkList(): List\n\t{\n\t\tthis.#linkList ??= new List({\n\t\t\tmodel: this.#settingsModel,\n\t\t\tonLinkListClose: this.#closeLinkList.bind(this),\n\t\t});\n\n\t\treturn this.#linkList;\n\t}\n\n\t#openLinkList(): void\n\t{\n\t\tDom.removeClass(this.#layout.main, '--show');\n\t\tthis.#linkList.show(this.#layout.main.offsetHeight);\n\t}\n\n\t#closeLinkList(): void\n\t{\n\t\tDom.addClass(this.#layout.main, '--show');\n\t}\n\n\tcopyLink(url: string, hash: string): boolean\n\t{\n\t\tif (!url)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = BX.clipboard.copy(url);\n\n\t\tif (result)\n\t\t{\n\t\t\tUtil.showNotification(Loc.getMessage('SHARING_COPY_LINK_NOTIFICATION'));\n\t\t\tEventEmitter.emit('CalendarSharing:LinkCopied', { url, hash });\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Analytics } from 'calendar.sharing.analytics';\nimport type { RuleParams } from '../model/rule';\nimport type { Context, User } from '../model/index';\nimport { SettingsModel, CalendarSettings } from '../model/settings';\nimport { Layout } from './layout';\n\nimport 'main.qrcode';\nimport 'ui.design-tokens';\n\ntype DialogOptions = {\n\tbindElement: HTMLElement,\n\tuserInfo: ?User,\n\tsharingUrl: string,\n\tlinkHash: string,\n\tsharingRule: RuleParams,\n\tcalendarSettings: CalendarSettings,\n\tcontext: Context,\n\treadOnly: boolean,\n\tsettingsCollapsed: boolean,\n\tsortJointLinksByFrequentUse: boolean,\n};\n\nexport default class DialogNew\n{\n\t#popup: Popup;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\tbindElement: HTMLElement,\n\t};\n\n\t#dialogLayout: Layout;\n\t#settingsModel: SettingsModel;\n\n\tconstructor(options: DialogOptions)\n\t{\n\t\tthis.#layout = {};\n\n\t\tthis.#layout.bindElement = options.bindElement;\n\n\t\tthis.#settingsModel = new SettingsModel({\n\t\t\tcontext: options.context,\n\t\t\tlinkHash: options.linkHash,\n\t\t\tsharingUrl: options.sharingUrl,\n\t\t\tuserInfo: options.userInfo,\n\t\t\trule: options.sharingRule,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tcollapsed: options.settingsCollapsed,\n\t\t\tsortJointLinksByFrequentUse: options.sortJointLinksByFrequentUse,\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('CalendarSharing:LinkCopied', this.onSuccessfulCopyingLink.bind(this));\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tbindElement: this.#layout.bindElement,\n\t\t\t\tclassName: 'calendar-sharing__dialog',\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tpadding: 0,\n\t\t\t\twidth: 470,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.#layout.bindElement.offsetWidth / 2 + 16,\n\t\t\t\t},\n\t\t\t\tautoHideHandler: (event) => this.canBeClosed(event),\n\t\t\t\tcontent: this.getPopupWrapper(),\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: this.onPopupShow.bind(this),\n\t\t\t\t\tonPopupClose: this.onPopupClose.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\tonPopupShow(): void\n\t{\n\t\tDom.addClass(this.#layout.bindElement, 'ui-btn-hover');\n\n\t\tAnalytics.sendPopupOpened(this.#settingsModel.getContext());\n\t}\n\n\tonPopupClose(): void\n\t{\n\t\tDom.removeClass(this.#layout.bindElement, 'ui-btn-hover');\n\t\tthis.#dialogLayout.reset();\n\t}\n\n\tcanBeClosed(event): boolean\n\t{\n\t\tconst isClickInside = this.#layout.wrapper.contains(event.target);\n\t\tconst layoutHasShownPopups = this.#dialogLayout.hasShownPopups();\n\t\tconst checkTopSlider = (this.#settingsModel.getContext() === 'calendar') ? BX.SidePanel.Instance.getTopSlider() : false;\n\n\t\treturn !isClickInside\n\t\t\t&& !layoutHasShownPopups\n\t\t\t&& !checkTopSlider\n\t\t;\n\t}\n\n\tgetPopupWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#dialogLayout = new Layout({\n\t\t\t\tsettingsModel: this.#settingsModel,\n\t\t\t});\n\t\t\tthis.#layout.wrapper = this.#dialogLayout.render();\n\t\t}\n\n\t\treturn this.#layout.wrapper = this.#dialogLayout.render();\n\t}\n\n\tonSuccessfulCopyingLink(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.getPopup().isShown();\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#settingsModel.sortRanges();\n\n\t\tthis.getPopup().show();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.getPopup().destroy();\n\t}\n\n\tgetSettingsControlRule(): RuleParams\n\t{\n\t\treturn this.#settingsModel?.getRule().toArray();\n\t}\n}\n","import { Dom, Event, Loc, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'ui.buttons';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { Util } from 'calendar.util';\nimport DialogNew from './dialog-new';\nimport 'ui.switcher';\nimport 'spotlight';\nimport { Guide } from 'ui.tour';\nimport { Counter } from 'ui.cnt';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\n\nexport default class SharingButton\n{\n\tPAY_ATTENTION_TO_NEW_FEATURE_DELAY = 1000;\n\n\tPAY_ATTENTION_TO_NEW_FEATURE_FIRST = 'first-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_NEW = 'new-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_REMIND = 'remind-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_JOINT = 'joint-sharing';\n\n\tPAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS = [this.PAY_ATTENTION_TO_NEW_FEATURE_FIRST];\n\tPAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS = [\n\t\tthis.PAY_ATTENTION_TO_NEW_FEATURE_NEW,\n\t\tthis.PAY_ATTENTION_TO_NEW_FEATURE_REMIND,\n\n\t];\n\n\tconstructor(options = {})\n\t{\n\t\tthis.wrap = options.wrap;\n\t\tthis.userInfo = options.userInfo || null;\n\t\tthis.sharingConfig = Util.getSharingConfig();\n\t\tthis.sharingUrl = this.sharingConfig?.url || null;\n\t\tthis.linkHash = this.sharingConfig?.hash || null;\n\t\tthis.sharingRule = this.sharingConfig?.rule || null;\n\t\tthis.payAttentionToNewFeatureMode = options.payAttentionToNewFeature;\n\t\tthis.sharingFeatureLimit = options.sharingFeatureLimit;\n\t\tthis.sharingSettingsCollapsed = options.sharingSettingsCollapsed;\n\t\tthis.sortJointLinksByFrequentUse = options.sortJointLinksByFrequentUse;\n\t}\n\n\tshow()\n\t{\n\t\tDom.addClass(this.wrap, 'calendar-sharing__btn-wrap');\n\t\tthis.button = new Button({\n\t\t\ttext: Loc.getMessage('SHARING_BUTTON_TITLE'),\n\t\t\tround: true,\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\ticon: this.sharingFeatureLimit ? ButtonIcon.LOCK : null,\n\t\t\tclassName: 'ui-btn-themes calendar-sharing__btn',\n\t\t\tonclick: (button, event) => {\n\t\t\t\tif (!this.switcher.getNode().contains(event.target))\n\t\t\t\t{\n\t\t\t\t\tthis.handleSharingButtonClick();\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tthis.button.renderTo(this.wrap);\n\t\tthis.renderSwitcher();\n\n\t\tif (this.payAttentionToNewFeatureMode === this.PAY_ATTENTION_TO_NEW_FEATURE_JOINT)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (BX.SidePanel.Instance.getTopSlider() === null)\n\t\t\t\t{\n\t\t\t\t\tthis.payAttentionToNewFeatureWithText();\n\t\t\t\t\tBX.ajax.runAction('calendar.api.sharingajax.disableOptionPayAttentionToNewSharingFeature');\n\t\t\t\t}\n\t\t\t}, this.PAY_ATTENTION_TO_NEW_FEATURE_DELAY);\n\t\t}\n\t}\n\n\thandleSharingButtonClick()\n\t{\n\t\tif (this.sharingFeatureLimit)\n\t\t{\n\t\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'calendar_sharing' }).show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isSharingEnabled())\n\t\t{\n\t\t\tthis.openDialog();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.switcher.toggle();\n\t\t}\n\t}\n\n\tgetSwitcherContainer()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__switcher\"></div>\n\t\t`;\n\t}\n\n\tgetSwitcherDivider()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__switcher_divider\"></div>\n\t\t`;\n\t}\n\n\trenderSwitcher()\n\t{\n\t\tDom.append(this.getSwitcherDivider(), this.wrap);\n\t\tthis.switcherWrap = Tag.render`<div class=\"calendar-sharing__switcher-wrap\"></div>`;\n\t\tDom.append(this.switcherWrap, this.wrap);\n\t\tEvent.bind(this.switcherWrap, 'click', this.handleSwitcherWrapClick.bind(this), { capture: true });\n\n\t\tthis.switcher = new BX.UI.Switcher({\n\t\t\tnode: this.getSwitcherContainer(),\n\t\t\tchecked: this.isSharingEnabled() && !this.sharingFeatureLimit,\n\t\t\tcolor: 'green',\n\t\t\tsize: 'small',\n\t\t\thandlers: {\n\t\t\t\ttoggled: () => this.handleSwitcherToggled(),\n\t\t\t},\n\t\t});\n\n\t\tthis.switcher.renderTo(this.switcherWrap);\n\t}\n\n\thandleSwitcherWrapClick(event)\n\t{\n\t\tif (this.switcher.isChecked())\n\t\t{\n\t\t\tthis.showWarningPopup();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\thandleSwitcherToggled()\n\t{\n\t\tif (this.sharingFeatureLimit && this.switcher.isChecked())\n\t\t{\n\t\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'calendar_sharing' }).show();\n\t\t\tthis.switcher.toggle();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isToggledAfterErrorOccurred())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.switcher.isChecked())\n\t\t{\n\t\t\tthis.enableSharing();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableSharing();\n\t\t}\n\t}\n\n\tisToggledAfterErrorOccurred()\n\t{\n\t\treturn this.switcher.isChecked() === this.isSharingEnabled();\n\t}\n\n\tisSharingEnabled()\n\t{\n\t\treturn Type.isString(this.sharingUrl);\n\t}\n\n\tenableSharing()\n\t{\n\t\tconst action = 'calendar.api.sharingajax.enableUserSharing';\n\t\tconst event = 'Calendar.Sharing.copyLinkButton:onSharingEnabled';\n\n\t\tBX.ajax.runAction(action)\n\t\t\t.then((response) => {\n\t\t\t\tthis.sharingUrl = response.data.url;\n\t\t\t\tthis.linkHash = response.data.hash;\n\t\t\t\tthis.sharingRule = response.data.rule;\n\t\t\t\tthis.openDialog();\n\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tevent,\n\t\t\t\t\t{\n\t\t\t\t\t\tisChecked: this.switcher.isChecked(),\n\t\t\t\t\t\turl: response.data.url,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.switcher.toggle();\n\t\t\t})\n\t\t;\n\t}\n\n\topenDialog()\n\t{\n\t\tthis.pulsar?.close();\n\t\tDom.remove(this.counterNode);\n\n\t\tif (!this.newDialog)\n\t\t{\n\t\t\tthis.newDialog = new DialogNew({\n\t\t\t\tbindElement: this.button.getContainer(),\n\t\t\t\tsharingUrl: this.sharingUrl,\n\t\t\t\tlinkHash: this.linkHash,\n\t\t\t\tsharingRule: this.sharingRule,\n\t\t\t\tcontext: 'calendar',\n\t\t\t\tcalendarSettings: {\n\t\t\t\t\tweekHolidays: Util.config.week_holidays,\n\t\t\t\t\tweekStart: Util.config.week_start,\n\t\t\t\t\tworkTimeStart: Util.config.work_time_start,\n\t\t\t\t\tworkTimeEnd: Util.config.work_time_end,\n\t\t\t\t},\n\t\t\t\tuserInfo: this.userInfo,\n\t\t\t\tsettingsCollapsed: this.sharingSettingsCollapsed,\n\t\t\t\tsortJointLinksByFrequentUse: this.sortJointLinksByFrequentUse,\n\t\t\t});\n\t\t}\n\n\t\tif (!this.newDialog.isShown())\n\t\t{\n\t\t\tthis.newDialog.show();\n\t\t}\n\t}\n\n\tdisableSharing()\n\t{\n\t\tconst action = 'calendar.api.sharingajax.disableUserSharing';\n\t\tconst event = 'Calendar.Sharing.copyLinkButton:onSharingDisabled';\n\t\tthis.warningPopup.close();\n\n\t\tBX.ajax.runAction(action)\n\t\t\t.then(() => {\n\t\t\t\tthis.sharingUrl = null;\n\t\t\t\tif (this.newDialog)\n\t\t\t\t{\n\t\t\t\t\tthis.newDialog.destroy();\n\t\t\t\t\tthis.newDialog = null;\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(event, { isChecked: this.switcher.isChecked() });\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.switcher.toggle();\n\t\t\t})\n\t\t;\n\t}\n\n\tshowWarningPopup()\n\t{\n\t\tif (!this.warningPopup)\n\t\t{\n\t\t\tthis.warningPopup = new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('SHARING_WARNING_POPUP_TITLE_1'),\n\t\t\t\tmessage: Loc.getMessage('SHARING_WARNING_POPUP_CONTENT_2'),\n\t\t\t\tbuttons: this.getWarningPopupButtons(),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tminWidth: 365,\n\t\t\t\t\tmaxWidth: 385,\n\t\t\t\t\tminHeight: 180,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.warningPopup.show();\n\t}\n\n\tgetWarningPopupButtons()\n\t{\n\t\treturn [this.getSubmitButton(), this.getCancelButton()];\n\t}\n\n\tgetSubmitButton()\n\t{\n\t\treturn new Button({\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tcolor: ButtonColor.DANGER,\n\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_SUBMIT_BUTTON_NEW_MSGVER_1'),\n\t\t\tevents: {\n\t\t\t\tclick: () => this.handleSubmitButtonClick(),\n\t\t\t},\n\t\t});\n\t}\n\n\tgetCancelButton()\n\t{\n\t\treturn new Button({\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_CANCEL_BUTTON'),\n\t\t\tevents: {\n\t\t\t\tclick: () => this.handleCancelButtonClick(),\n\t\t\t},\n\t\t});\n\t}\n\n\thandleSubmitButtonClick()\n\t{\n\t\tthis.switcher.toggle();\n\t\tthis.warningPopup.close();\n\t}\n\n\thandleCancelButtonClick()\n\t{\n\t\tthis.warningPopup.close();\n\t}\n\n\tpayAttentionToNewFeature(mode)\n\t{\n\t\tif (this.PAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS.includes(mode))\n\t\t{\n\t\t\tthis.payAttentionToNewFeatureWithoutText();\n\t\t}\n\n\t\tif (this.PAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS.includes(mode))\n\t\t{\n\t\t\tthis.payAttentionToNewFeatureWithText();\n\t\t}\n\t}\n\n\tpayAttentionToNewFeatureWithoutText()\n\t{\n\t\tthis.pulsar = this.getPulsar(this.wrap, false);\n\t\tthis.pulsar.show();\n\t\tEvent.bind(this.pulsar.container, 'click', () => {\n\t\t\tthis.handleSharingButtonClick();\n\t\t});\n\n\t\tthis.counterNode = (new Counter({\n\t\t\tvalue: 1,\n\t\t\tcolor: Counter.Color.DANGER,\n\t\t\tsize: Counter.Size.MEDIUM,\n\t\t\tanimation: false,\n\t\t})).getContainer();\n\t\tDom.addClass(this.counterNode, 'calendar-sharing__new-feature-counter');\n\t\tDom.append(this.counterNode, this.wrap);\n\t}\n\n\tpayAttentionToNewFeatureWithText()\n\t{\n\t\tconst title = Loc.getMessage('CALENDAR_PAY_ATTENTION_TO_NEW_FEATURE_JOINT_TITLE');\n\t\tconst text = Loc.getMessage('CALENDAR_PAY_ATTENTION_TO_NEW_FEATURE_JOINT_TEXT');\n\n\t\tconst guide = this.getGuide(title, text);\n\t\tconst pulsar = this.getPulsar(this.wrap);\n\n\t\tguide.showNextStep();\n\t\tguide.getPopup().setAngle({ offset: 210 });\n\n\t\tpulsar.show();\n\t}\n\n\tgetGuide(title, text)\n\t{\n\t\tconst guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.wrap,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\tconst guidePopup = guide.getPopup();\n\t\tDom.addClass(guidePopup.popupContainer, 'calendar-popup-ui-tour-animate');\n\t\tguidePopup.setWidth(400);\n\t\tDom.style(guidePopup.getContentContainer(), 'paddingRight', getComputedStyle(guidePopup.closeIcon).width);\n\n\t\treturn guide;\n\t}\n\n\tgetPulsar(target, hideOnHover = true)\n\t{\n\t\tconst pulsar = new BX.SpotLight({\n\t\t\ttargetElement: target,\n\t\t\ttargetVertex: 'middle-center',\n\t\t\tlightMode: true,\n\t\t});\n\t\tif (hideOnHover)\n\t\t{\n\t\t\tpulsar.bindEvents({\n\t\t\t\tonTargetEnter: () => pulsar.close(),\n\t\t\t});\n\t\t}\n\n\t\treturn pulsar;\n\t}\n}\n","import SharingButton from './controls/sharingbutton';\n\nexport default class Interface\n{\n\tconstructor(options)\n\t{\n\t\tthis.buttonWrap = options.buttonWrap;\n\t\tthis.userInfo = options.userInfo || null;\n\t\tthis.payAttentionToNewFeature = options.payAttentionToNewFeature ?? false;\n\t\tthis.sharingFeatureLimit = options.sharingFeatureLimit ?? false;\n\t\tthis.sharingSettingsCollapsed = options.sharingSettingsCollapsed ?? false;\n\t\tthis.sortJointLinksByFrequentUse = options.sortJointLinksByFrequentUse ?? false;\n\t}\n\n\tshowSharingButton()\n\t{\n\t\tthis.sharingButton = new SharingButton({\n\t\t\twrap: this.buttonWrap,\n\t\t\tuserInfo: this.userInfo,\n\t\t\tpayAttentionToNewFeature: this.payAttentionToNewFeature,\n\t\t\tsharingFeatureLimit: this.sharingFeatureLimit,\n\t\t\tsharingSettingsCollapsed: this.sharingSettingsCollapsed,\n\t\t\tsortJointLinksByFrequentUse: this.sortJointLinksByFrequentUse,\n\t\t});\n\t\tthis.sharingButton.show();\n\t}\n}\n","import { Tag, Loc, Runtime } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\n\ntype DialogQrOptions = {\n\tsharingUrl: string,\n\tcontext: 'calendar' | 'crm',\n}\nexport default class DialogQr\n{\n\tQRCODE_SIZE = 114;\n\tQRCODE_COLOR_LIGHT = '#fff';\n\tQRCODE_COLOR_DARK = '#000';\n\t#popup;\n\t#loader;\n\t#layout;\n\t#qrCode;\n\t#context;\n\n\tconstructor(options: DialogQrOptions)\n\t{\n\t\tthis.#popup = null;\n\t\tthis.#loader = null;\n\t\tthis.#layout = {\n\t\t\tqr: null,\n\t\t};\n\t\tthis.#qrCode = null;\n\t\tthis.#context = options.context;\n\n\t\tthis.sharingUrl = options.sharingUrl;\n\t}\n\n\t/**\n\t *\n\t * @returns {Popup}\n\t */\n\tgetPopup()\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tclassName: 'calendar-sharing__qr',\n\t\t\t\twidth: 315,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontent: this.getContent(),\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\toverlay: true,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t});\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\t/**\n\t *\n\t * @returns {Loader}\n\t */\n\tgetLoader()\n\t{\n\t\tif (!this.#loader)\n\t\t{\n\t\t\tthis.#loader = new Loader({ size: 95 });\n\t\t}\n\n\t\treturn this.#loader;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetNodeQr()\n\t{\n\t\tif (!this.#layout.qr)\n\t\t{\n\t\t\tthis.#layout.qr = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__qr-block\"></div>\n\t\t\t`;\n\n\t\t\t// qr emulation\n\t\t\tthis.getLoader().show(this.#layout.qr);\n\n\t\t\tthis.showQr();\n\t\t}\n\n\t\treturn this.#layout.qr;\n\t}\n\n\tasync showQr()\n\t{\n\t\tawait this.initQrCode();\n\t\tthis.QRCode = new QRCode(this.#layout.qr, {\n\t\t\ttext: this.sharingUrl,\n\t\t\twidth: this.QRCODE_SIZE,\n\t\t\theight: this.QRCODE_SIZE,\n\t\t\tcolorDark: this.QRCODE_COLOR_DARK,\n\t\t\tcolorLight: this.QRCODE_COLOR_LIGHT,\n\t\t\tcorrectLevel: QRCode.CorrectLevel.H,\n\t\t});\n\t\tawait this.getLoader().hide();\n\t}\n\n\tasync initQrCode()\n\t{\n\t\tawait Runtime.loadExtension(['main.qrcode']);\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetContent()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__qr-content\">\n\t\t\t\t<div class=\"calendar-sharing__qr-title\">${this.getPhraseDependsOnContext('SHARING_INFO_POPUP_QR_TITLE')}</div>\n\t\t\t\t${this.getNodeQr()}\n\t\t\t\t<div class=\"calendar-sharing__qr-info\">${Loc.getMessage('SHARING_INFO_POPUP_QR_INFO')}</div>\n\t\t\t\t<a class=\"calendar-sharing__dialog-link\" href=\"${this.sharingUrl}\" target=\"_blank\">${Loc.getMessage('SHARING_INFO_POPUP_QR_OPEN_LINK')}</a>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.getPopup().isShown();\n\t}\n\n\tclose()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.getPopup().destroy();\n\t}\n\n\tgetPhraseDependsOnContext(code: string)\n\t{\n\t\treturn Loc.getMessage(`${code}_${this.#context.toUpperCase()}`);\n\t}\n}\n"],"names":["RangeModel","EventEmitter","constructor","params","setEventNamespace","id","range","rule","calendarSettings","isNew","from","to","new","deletable","setWeekDays","weekdays","toArray","getFrom","getWeekDays","getRule","getId","getFromFormatted","formatMinutes","setFrom","value","parseInt","updated","getToFormatted","getTo","setTo","updateSlotSize","maxFrom","addWeekday","weekday","includes","removeWeekday","filter","w","sortWeekdays","getWeekdaysTitle","forceLong","sort","join","Loc","getMessage","formatWeekdays","weekdaysLoc","Util","getWeekdaysLoc","length","map","reduce","a","b","weekStart","getAvailableTimeFrom","timeStamps","hour","push","name","formatTime","getAvailableTimeTo","isDeletable","setDeletable","setNew","getWeekStart","minutes","date","Date","parseDate","getTime","emit","getSlotSize","RuleModel","AVAILABLE_INTERVALS","MAX_RANGES","DEFAULT_SLOT_SIZE","ranges","addRange","setSlotSize","slotSize","sortRanges","getSortedRanges","getDefaultRule","workTimeStart","workTimeEnd","workDays","getAvailableIntervals","getFormattedSlotSize","formatDuration","getRanges","compareRanges","firstRange","secondRange","firstWeekdaysWeight","getWeekdaysWeight","secondWeekdaysWeight","accumulator","index","canAddRange","internalRangeId","removeRange","rangeToRemove","canRemoveRange","rangeDeleted","slice","SettingsModel","getMinutesFromTime","time","dateString","toDateString","replace","shortTimeFormat","DateTimeFormat","getFormat","parsedTime","parseTime","format","h","m","getWorkingDays","weekHolidays","weekHolidaysInt","Set","day","getIndByWeekDay","has","isDefaultRule","isDifferentFrom","anotherRule","getChanges","currentRule","sizeChanged","daysChanged","JSON","stringify","changes","Analytics","ruleChanges","custom_days","custom_length","getUserInfo","userInfo","getContext","context","getLinkHash","linkHash","getSharingUrl","sharingUrl","isCollapsed","collapsed","sortJointLinksByFrequentUse","changeSortJointLinksByFrequentUse","setMemberIds","memberIds","getMemberIds","saveJointLink","response","BX","ajax","runAction","data","save","sendRuleUpdated","newRule","Promise","resolve","reject","ruleArray","then","error","console","increaseFrequentUse","hash","updateCollapsed","sortByFrequentUse","Weekday","options","wrap","active","onSelected","Type","isFunction","onDiscarded","onMouseDown","canBeDiscarded","render","className","Tag","e","handleMouseDown","event","discard","select","Dom","addClass","removeClass","Range","showReadOnlyPopup","onRangeUpdated","bind","hasShownPopups","weekdaysPopupShown","weekdaysMenu","isShown","startPopupShown","hasClass","fromTimeSelect","endPopupShown","toTimeSelect","destroy","remove","renderButton","button","replaceWith","updateWeekdaysTitle","weekdaysSelect","title","innerText","weekdaysSelectWidth","offsetWidth","weekdaysTextWidth","firstChild","weekdaysWidthIsOverflowing","formatAmPmSpan","toLowerCase","model","subscribe","unsubscribe","setTimeout","readOnly","loc","splice","observer","IntersectionObserver","observe","Event","weekdayLoc","weekdaysPopupId","PopupManager","getPopupById","canBeClosed","setBindElement","textNode","spanNode","cloneNode","textWidth","Popup","content","autoHide","closeByEsc","angle","position","offset","autoHideHandler","events","onPopupShow","onPopupClose","currentWeekday","startX","clientX","controllableWeekdays","collectIntersectedWeekdays","right","getBoundingClientRect","left","intersected","onMouseMove","forEach","controllableWeekday","document","unbind","getTimeStamps","isSelected","onItemSelected","callbacks","dataId","timeSelect","timeMenu","items","timeStamp","html","onclick","innerHTML","close","MenuManager","create","now","bindElement","onShow","onClose","maxHeight","minWidth","show","timezonesPopup","getPopupWindow","popupContent","getContentContainer","selectedTimezoneItem","querySelector","scrollTop","offsetTop","offsetHeight","Settings","rangesWithPopup","rangePopupShown","slotSizePopupShown","slotSizeSelect","readOnlyPopupShown","readOnlyPopup","readOnlyClass","expandedClass","contextClass","subtitle","expandRuleArrow","expandRuleButton","toggleClass","style","rangesContainer","slotSizeText","slotSizeMenu","text","topMarginHeight","bottomMarginHeight","marginsHeight","slotSizeHeight","rangeHeight","pivotNode","width","offsetLeft","darkMode","popupContainer","clearTimeout","closePopupTimeout","HintInfo","props","bindOptions","borderRadius","getContent","animation","wrapper","UserSelector","onMembersAdded","openEntitySelector","renderUserSelectorWrapper","userSelectorWrapper","renderUserSelector","userSelector","entityNode","getDefaultEntityNode","renderUserEntity","key","getEntityKey","getSelectedUserIdList","entity","hasAvatar","avatar","Text","encode","preselectedItem","Dialog","targetNode","preselectedItems","enableSearch","zIndex","onUserSelectorSelect","onUserSelectorDeselect","hasChanges","entities","intranetUsersOnly","emailUsers","inviteEmployeeLink","inviteGuestLink","analyticsSource","filters","isUserSelectorDialogOpened","isOpen","item","customData","get","trim","append","clearSelectedUsers","clean","getPeopleCount","Object","keys","result","values","infoNotify","hintInfo","timer","MAX_AVATAR_COUNT","ListItem","openAvatarList","onCopyButtonClick","onDeleteButtonClick","renderAvatarContainer","renderDate","renderCopyButton","renderDeleteButton","avatarContainer","showMoreIcon","members","moreCounter","renderAvatar","member","renderMore","user","lastName","counter","uid","util","getRandomString","getAvatarPopupItems","maxWidth","setPopupState","menuContainer","getMenuContainer","timeout","closeAvatarList","getAvatarPopupItem","userPath","pathToUser","dateCreate","formattedDate","formatDate","copyButton","icon","Icon","Main","LINK_3","size","shortUrl","deleteButton","Actions","CROSS_30","MessageBox","message","buttons","getDeletePopupButtons","popupOptions","draggable","closeIcon","minHeight","Button","ButtonSize","MEDIUM","color","ButtonColor","DANGER","click","deleteLink","LIGHT_BORDER","state","setListItemPopupState","DEFAULT_LIST_HEIGHT","LIST_PADDING_SUM","List","getLinkListInfo","eventSubscribe","onJointLinkCopy","onJointLinkDelete","userLinks","updateLinkList","isListEmpty","hideSortingButton","showSortingButton","getTitleNode","getListNode","getChevronBackIcon","getSortingButton","backButton","CHEVRON_LEFT","sortingButton","SORT","getSortingButtonText","changeListSort","sortingButtonText","list","getListItemsNode","getEmptyStateNode","linkListItems","getListItems","listItem","emptyState","getSortedByFrequentUseListItems","getSortedByDateListItems","frequentUse","maxListHeight","onLinkListClose","listItems","adjust","isOpenListItemPopup","isNil","isArray","isArrayFilled","isObject","Layout","HELP_DESK_CODE_CALENDAR","HELP_DESK_CODE_CRM","CONTEXT","CRM","CALENDAR","reset","isSettingsPopupShown","isListItemPopupOpened","buttonCopy","link","copyLink","url","clipboard","copy","showNotification","settingsModel","window","sendLinkCopiedList","peopleCount","main","open","focus","mainTop","externalIcon","howDoesItWork","infoNotifyHint","top","Helper","sendMembersAdded","mainBottom","sendLinkCopied","linkTypes","multiple","solo","buttonHistory","DialogNew","sharingRule","settingsCollapsed","bindEvents","onSuccessfulCopyingLink","getPopup","padding","getPopupWrapper","sendPopupOpened","isClickInside","contains","target","layoutHasShownPopups","checkTopSlider","SidePanel","Instance","getTopSlider","getSettingsControlRule","SharingButton","PAY_ATTENTION_TO_NEW_FEATURE_DELAY","PAY_ATTENTION_TO_NEW_FEATURE_FIRST","PAY_ATTENTION_TO_NEW_FEATURE_NEW","PAY_ATTENTION_TO_NEW_FEATURE_REMIND","PAY_ATTENTION_TO_NEW_FEATURE_JOINT","PAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS","PAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS","sharingConfig","getSharingConfig","payAttentionToNewFeatureMode","payAttentionToNewFeature","sharingFeatureLimit","sharingSettingsCollapsed","round","EXTRA_SMALL","ButtonIcon","LOCK","switcher","getNode","handleSharingButtonClick","renderTo","renderSwitcher","payAttentionToNewFeatureWithText","FeaturePromotersRegistry","getPromoter","featureId","isSharingEnabled","openDialog","toggle","getSwitcherContainer","getSwitcherDivider","switcherWrap","handleSwitcherWrapClick","capture","UI","Switcher","node","checked","handlers","toggled","handleSwitcherToggled","isChecked","showWarningPopup","stopPropagation","isToggledAfterErrorOccurred","enableSharing","disableSharing","isString","action","catch","pulsar","counterNode","newDialog","getContainer","config","week_holidays","week_start","work_time_start","work_time_end","warningPopup","getWarningPopupButtons","getSubmitButton","getCancelButton","handleSubmitButtonClick","handleCancelButtonClick","mode","payAttentionToNewFeatureWithoutText","getPulsar","container","Counter","Color","Size","guide","getGuide","showNextStep","setAngle","Guide","simpleMode","onEvents","steps","condition","bottom","guidePopup","setWidth","getComputedStyle","hideOnHover","SpotLight","targetElement","targetVertex","lightMode","onTargetEnter","Interface","buttonWrap","showSharingButton","sharingButton","DialogQr","QRCODE_SIZE","QRCODE_COLOR_LIGHT","QRCODE_COLOR_DARK","qr","overlay","getLoader","Loader","getNodeQr","showQr","initQrCode","QRCode","height","colorDark","colorLight","correctLevel","CorrectLevel","H","hide","Runtime","loadExtension","getPhraseDependsOnContext","code","toUpperCase"],"mappings":"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"}