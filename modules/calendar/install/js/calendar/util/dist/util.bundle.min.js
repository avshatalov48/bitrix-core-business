this.BX=this.BX||{};(function(t,e,a,i,r,n){"use strict";let s=t=>t,o,c;class l{static parseTime(t){let e=l.parseDate1(BX.date.format(l.getDateFormat(),new Date)+" "+t,false);return e?{h:e.getHours(),m:e.getMinutes()}:e}static getTimeRounded(t){return Math.round(t.getTime()/6e4)*6e4}static parseDate(t,e,a,i){return BX.parseDate(t,e,a,i)}static parseDate1(t,a,i){let r,n,s,o;if(!a)a=e.Loc.getMessage("FORMAT_DATETIME");t=BX.util.trim(t);if(i!==false)a=a.replace(":SS","");if(BX.type.isNotEmptyString(t)){o="";for(r=1;r<=12;r++){o=o+"|"+e.Loc.getMessage("MON_"+r)}let i=new RegExp("([0-9]+|[a-z]+"+o+")","ig"),c=t.match(i),l=e.Loc.getMessage("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),u=[],m=[],g={};if(!c){return null}if(c.length>l.length){l=a.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(r=0,n=c.length;r<n;r++){if(BX.util.trim(c[r])!==""){u[u.length]=c[r]}}for(r=0,n=l.length;r<n;r++){if(BX.util.trim(l[r])!=""){m[m.length]=l[r]}}let d=BX.util.array_search("MMMM",m);if(d>0){u[d]=BX.getNumMonth(u[d]);m[d]="MM"}else{d=BX.util.array_search("M",m);if(d>0){u[d]=BX.getNumMonth(u[d]);m[d]="MM"}}for(r=0,n=m.length;r<n;r++){s=m[r].toUpperCase();g[s]=s=="T"||s=="TT"?u[r]:parseInt(u[r],10)}if(g["DD"]>0&&g["MM"]>0&&g["YYYY"]>0){let t=new Date;{t.setDate(1);t.setFullYear(g["YYYY"]);t.setMonth(g["MM"]-1);t.setDate(g["DD"]);t.setHours(0,0,0)}if((!isNaN(g["HH"])||!isNaN(g["GG"])||!isNaN(g["H"])||!isNaN(g["G"]))&&!isNaN(g["MI"])){if(!isNaN(g["H"])||!isNaN(g["G"])){let t=(g["T"]||g["TT"]||"am").toUpperCase()=="PM";let e=parseInt(g["H"]||g["G"]||0,10);if(t){g["HH"]=e+(e==12?0:12)}else{g["HH"]=e<12?e:0}}else{g["HH"]=parseInt(g["HH"]||g["GG"]||0,10)}if(isNaN(g["SS"]))g["SS"]=0;{t.setHours(g["HH"],g["MI"],g["SS"])}}return t}}return null}static formatTime(t,a){let i;if(e.Type.isDate(t)){i=t}else{i=new Date;i.setHours(t,a,0)}return BX.date.format(l.getTimeFormatShort(),i.getTime()/1e3)}static formatDate(t){if(e.Type.isDate(t)){t=t.getTime()}return BX.date.format(l.getDateFormat(),t/1e3)}static formatDateTime(t){if(e.Type.isDate(t)){t=t.getTime()}return BX.date.format(l.getDateTimeFormat(),t/1e3)}static formatTimeInterval(t,e){const i=a.DateTimeFormat.format(l.getTimeFormatShort(),t.getTime()/1e3);const r=a.DateTimeFormat.format(l.getTimeFormatShort(),e.getTime()/1e3);return`${i} - ${r}`}static formatDuration(t){const e=Math.floor(t/60);const i=t%60;let r=a.DateTimeFormat.format("idiff",(new Date).getTime()/1e3-i*60);if(e>0){r=a.DateTimeFormat.format("Hdiff",(new Date).getTime()/1e3-e*60*60);if(i>0){r+=" "+a.DateTimeFormat.format("idiff",(new Date).getTime()/1e3-i*60)}}return r}static formatDateUsable(t,a=true,i=false){const r=e.Loc.getMessage("LANGUAGE_ID");let n=l.getDateFormat();if(r==="ru"||r==="ua"){n=i?"l, j F":"j F";if(t.getFullYear&&t.getFullYear()!==(new Date).getFullYear()&&a!==false){n+=" Y"}}return BX.date.format([["today","today"],["tommorow","tommorow"],["yesterday","yesterday"],["",n]],t)}static formatDayMonthShortTime(t){return a.DateTimeFormat.format(a.DateTimeFormat.getFormat("DAY_MONTH_FORMAT"),t)+" "+a.DateTimeFormat.format(a.DateTimeFormat.getFormat("SHORT_TIME_FORMAT"),t)}static getDayLength(){if(!l.DAY_LENGTH){l.DAY_LENGTH=864e5}return l.DAY_LENGTH}static getDefaultColorList(){return["#86b100","#0092cc","#00afc7","#e89b06","#00b38c","#de2b24","#bd7ac9","#838fa0","#c3612c","#e97090"]}static findTargetNode(t,e){let a=false;if(t){let i="data-bx-calendar",r;if(t.attributes&&t.attributes.length){for(r=0;r<t.attributes.length;r++){if(t.attributes[r].name&&t.attributes[r].name.substr(0,i.length)===i){a=t;break}}}if(!a){a=BX.findParent(t,(function(t){let e;if(t.attributes&&t.attributes.length){for(e=0;e<t.attributes.length;e++){if(t.attributes[e].name&&t.attributes[e].name.substr(0,i.length)===i)return true}}return false}),e)}}return a}static getFollowedUserList(t){return[]}static getWeekDayByInd(t){return["SU","MO","TU","WE","TH","FR","SA"][t]}static getIndByWeekDay(t){return new Object({SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6})[t]}static getWeekdaysLoc(t=false){const e=new Date;const i=[];const r=24*60*60*1e3;const n=t?"l":"D";for(let t=0;t<7;t++){i[(e.getDay()+t)%7]=a.DateTimeFormat.format(n,new Date(e.getTime()+r*t))}return i}static getLoader(t,a){return e.Tag.render(o||(o=s`
		<div class="${0}">
			<svg class="calendar-loader-circular"
				style="width:${0}px; height:${0}px;"
				viewBox="25 25 50 50">
					<circle class="calendar-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
					<circle class="calendar-loader-inner-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
			</svg>
		</div>
`),a||"calendar-loader",parseInt(t),parseInt(t))}static getDayCode(t){return t.getFullYear()+"-"+("0"+~~(t.getMonth()+1)).substr(-2,2)+"-"+("0"+~~t.getDate()).substr(-2,2)}static getTextColor(t){if(!t){return false}if(t.charAt(0)==="#"){t=t.substring(1,7)}let e=parseInt(t.substring(0,2),16),a=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),r=(e*.8+a+i*.2)/510*100;return r<50}static getKeyCode(t){if(!e.Type.isString(t)){return false}let a={backspace:8,enter:13,escape:27,space:32,delete:46,left:37,right:39,up:38,down:40,z:90,y:89,shift:16,ctrl:17,alt:18,cmd:91,cmdRight:93,pageUp:33,pageDown:34,d:68,w:87,m:77,a:65};return a[t.toLowerCase()]}static isAnyModifierKeyPressed(t=window.event){if(t){return t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}return null}static getUsableDateTime(t,a){if(e.Type.isDate(t)){t=t.getTime()}let i=(a||10)*60*1e3;t=Math.ceil(t/i)*i;return new Date(t)}static showNotification(t,a=null){if(e.Type.isString(t)&&t!==""){BX.UI.Notification.Center.notify({content:t,actions:a})}}static showFieldError(t,a,i){if(e.Type.isDomNode(a)&&e.Type.isString(t)&&t!==""){e.Dom.remove(a.querySelector(".ui-alert"));let i=new BX.UI.Alert({color:BX.UI.Alert.Color.DANGER,icon:BX.UI.Alert.Icon.DANGER,text:t});let r=i.getContainer();a.appendChild(r);return r}}static getDateFormat(){if(!l.DATE_FORMAT){l.DATE_FORMAT=BX.Main.Date.convertBitrixFormat(e.Loc.getMessage("FORMAT_DATE"))}return l.DATE_FORMAT}static setDayOfWeekMonthFormat(t){l.dayOfWeekMonthFormat=t}static getDayOfWeekMonthFormat(){return l.dayOfWeekMonthFormat||"l, j F"}static setDayMonthFormat(t){l.dayMonthFormat=t}static getDayMonthFormat(){return l.dayMonthFormat||"j F"}static setLongDateFormat(t){l.longDateFormat=t}static getLongDateFormat(){return l.longDateFormat||"j F Y"}static getDateTimeFormat(){if(!l.DATETIME_FORMAT){l.DATETIME_FORMAT=BX.Main.Date.convertBitrixFormat(e.Loc.getMessage("FORMAT_DATETIME"))}return l.DATETIME_FORMAT}static getTimeFormat(){if(!l.TIME_FORMAT){if(e.Loc.getMessage("FORMAT_DATETIME").substr(0,e.Loc.getMessage("FORMAT_DATE").length)===e.Loc.getMessage("FORMAT_DATE")){l.TIME_FORMAT=BX.util.trim(l.getDateTimeFormat().substr(l.getDateFormat().length));l.TIME_FORMAT_BX=BX.util.trim(e.Loc.getMessage("FORMAT_DATETIME").substr(e.Loc.getMessage("FORMAT_DATE").length))}else{l.TIME_FORMAT_BX=BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS";l.TIME_FORMAT=BX.date.convertBitrixFormat(BX.isAmPmMode()?"H:MI:SS T":"HH:MI:SS")}}return l.TIME_FORMAT}static getTimeFormatShort(){if(!l.TIME_FORMAT_SHORT){l.TIME_FORMAT_SHORT=l.getTimeFormat().replace(":s","");l.TIME_FORMAT_SHORT_BX=l.TIME_FORMAT_BX.replace(":SS","")}return l.TIME_FORMAT_SHORT}static getCurrentUserId(){if(!l.currentUserId){l.currentUserId=parseInt(e.Loc.getMessage("USER_ID"))}return l.currentUserId}static getTimeByInt(t){t=parseInt(t);let e=Math.floor(t/60);return{hour:e,min:t-e*60}}static preventSelection(t){t.ondrag=BX.False;t.ondragstart=BX.False;t.onselectstart=BX.False}static getBX(){return window.top.BX||window.BX}static closeAllPopups(){if(i.PopupManager.isAnyPopupShown()){for(let t=0,e=i.PopupManager._popups.length;t<e;t++){if(i.PopupManager._popups[t]&&i.PopupManager._popups[t].isShown()){i.PopupManager._popups[t].close()}}}}static showConfirmPopup(t,a,i={}){this.confirmPopup=new n.MessageBox({message:e.Tag.render(c||(c=s`
				<div class="calendar-list-slider-messagebox-text">
					${0}
				</div>
			`),a),minHeight:120,minWidth:280,maxWidth:300,buttons:BX.UI.Dialogs.MessageBoxButtons.OK_CANCEL,onOk:()=>{var e;t();(e=this.confirmPopup)==null?void 0:e.close()},onCancel:()=>{var t;(t=this.confirmPopup)==null?void 0:t.close()},popupOptions:{events:{onPopupClose:()=>{delete this.confirmPopup}},closeByEsc:false,padding:0,contentPadding:0,animation:"fading-slide"},...i});this.confirmPopup.show()}static sendAnalyticLabel(t){BX.ajax.runAction("calendar.api.calendarajax.sendAnalyticsLabel",{analyticsLabel:t})}static setOptions(t,e){l.config=t;l.additionalParams=e}static setUserSettings(t){l.userSettings=t}static getUserSettings(){return e.Type.isObjectLike(l.userSettings)?l.userSettings:{}}static setCalendarContext(t){l.calendarContext=t}static getCalendarContext(){return l.calendarContext||null}static getMeetingStatusList(){return["Y","N","Q","H"]}static getWorkTimeStart(){let t=this.config.work_time_start.split(".");if(t.length===1){return t[0]+".00"}return this.config.work_time_start}static getWorkTimeEnd(){let t=this.config.work_time_end.split(".");if(t.length===1){return t[0]+".00"}return this.config.work_time_end}static checkEmailLimitationPopup(){const t=l.getEventWithEmailGuestAmount();const e=l.getEventWithEmailGuestLimit();return e>0&&(t===8||t===4||t>=e)}static isEventWithEmailGuestAllowed(){return l.getEventWithEmailGuestLimit()===-1||l.getEventWithEmailGuestAmount()<l.getEventWithEmailGuestLimit()}static setEventWithEmailGuestAmount(t){l.countEventWithEmailGuestAmount=t}static setEventWithEmailGuestLimit(t){l.eventWithEmailGuestLimit=t}static getEventWithEmailGuestAmount(){return l.countEventWithEmailGuestAmount}static getEventWithEmailGuestLimit(){return l.eventWithEmailGuestLimit}static setCurrentView(t=null){l.currentCalendarView=t}static getCurrentView(){return l.currentCalendarView||null}static adjustDateForTimezoneOffset(t,a=0,i=false){if(!e.Type.isDate(t))throw new Error("Wrong type for date attribute. DateTime object expected.");if(!parseInt(a)||i===true)return t;return new Date(t.getTime()-parseInt(a)*1e3)}static getFormattedTimezone(t){const e=this.getTimeZoneOffset(t);if(e===0){return"(UTC) "+t}const a=e>0?"-":"+";const i=("0"+Math.floor(Math.abs(e)/60)).slice(-2);const r=("0"+Math.abs(e)%60).slice(-2);return"(UTC "+a+i+":"+r+") "+t}static getTimezoneDateFromTimestampUTC(t,e){return new Date(t+this.getTimeZoneOffset()*60*1e3-this.getTimeZoneOffset(e)*60*1e3)}static getTimeZoneOffset(t=undefined){const e=new Date((new Date).toLocaleString("en-US",{timeZone:t})).getTime();const a=new Date((new Date).toLocaleString("en-US",{timeZone:"UTC"})).getTime();return parseInt((a-e)/6e4)}static randomInt(t,e){return Math.round(t-.5+Math.random()*(e-t+1))}static getRandomColor(){const t=l.getDefaultColorList();return t[l.randomInt(0,t.length-1)]}static setAccessNames(t={}){l.accessNames={};for(let e in t){if(t.hasOwnProperty(e)){l.setAccessName(e,t[e])}}}static getAccessName(t){return l.accessNames[t]||t}static setAccessName(t,e){l.accessNames[t]=e}static getRandomInt(t=6){return Math.round(Math.random()*Math.pow(10,t))}static displayError(t,a){if(e.Type.isArray(t)){let e="";for(let a=0;a<t.length;a++){e+=t[a].message+"\n"}t=e}setTimeout((()=>{alert(t||"[Bitrix Calendar] Request error");if(a){location.reload()}}),200)}static convertEntityToAccessCode(t){if(e.Type.isObjectLike(t)){if(t.entityId==="meta-user"&&t.id==="all-users"){return"UA"}else if(t.entityId==="user"){return"U"+t.id}else if(t.entityId==="project"){return"SG"+t.id+"_K"}else if(t.entityId==="department"){return"DR"+t.id}else if(t.entityId==="group"){return t.id}}}static extendPlannerWatches({entries:t,userId:e}){t.forEach((t=>{if(t.type==="user"&&parseInt(t.id)!==parseInt(e)){const e=l.PLANNER_PULL_TAG.replace("#USER_ID#",t.id);if(!l.PLANNER_WATCH_LIST.includes(e)){r.PULL.extendWatch(e);l.PLANNER_WATCH_LIST.push(e)}}}))}static clearPlannerWatches(){l.PLANNER_WATCH_LIST.forEach((t=>{r.PULL.clearWatch(t)}));l.PLANNER_WATCH_LIST=[]}static registerRequestId(){const t=BX.Calendar.Util.getRandomInt(8);l.REQUEST_ID_LIST.push(t);return t}static unregisterRequestId(t){l.REQUEST_ID_LIST=l.REQUEST_ID_LIST.filter((e=>e!==t))}static checkRequestId(t){t=parseInt(t);return!e.Type.isInteger(t)||!l.REQUEST_ID_LIST.includes(t)}static initHintNode(t){var a;const i=l.getBX();if(e.Type.isElementNode(t)&&i!=null&&(a=i.UI)!=null&&a.Hint){var r,n;if(i!=null&&(r=i.UI)!=null&&(n=r.Hint)!=null&&n.popup){i.UI.Hint.popup.destroy();i.UI.Hint.popup=null;i.UI.Hint.content=null}i.UI.Hint.initNode(t)}}static documentIsDisplayingNow(){return!document.hidden}static removeHash(){if("pushState"in history){history.pushState("",document.title,window.location.pathname+window.location.search)}else{let t=document.body.scrollTop;let e=document.body.scrollLeft;window.location.hash="";document.body.scrollTop=t;document.body.scrollLeft=e}}static setIphoneConnectionStatus(t){l.iphoneConnectionStatus=t}static isIphoneConnected(){return l.iphoneConnectionStatus}static setMacConnectionStatus(t){l.macConnectionStatus=t}static isMacConnected(){return l.macConnectionStatus}static setIcloudConnectionStatus(t){l.icloudConnectionStatus=t}static isIcloudConnected(){return l.icloudConnectionStatus}static setGoogleConnectionStatus(t){l.googleConnectionStatus=t}static isGoogleConnected(){return l.googleConnectionStatus}static setIsSharingFeatureEnabled(t){l.isSharingFeatureEnabled=t}static checkSharingFeatureEnabled(){return l.isSharingFeatureEnabled}static setSharingConfig(t){l.sharingConfig=t}static getSharingConfig(){return l.sharingConfig}static downloadIcsFile(t,e){const a=document.createElement("a");a.href="data:text/calendar,"+encodeURI(t);a.download=e;a.click()}static isMobileBrowser(){return navigator.userAgent.toLowerCase().includes("iphone")||navigator.userAgent.toLowerCase().includes("ipad")||navigator.userAgent.toLowerCase().includes("android")}}l.PLANNER_PULL_TAG="calendar-planner-#USER_ID#";l.PLANNER_WATCH_LIST=[];l.REQUEST_ID_LIST=[];l.accessNames={};t.Util=l})(this.BX.Calendar=this.BX.Calendar||{},BX,BX.Main,BX.Main,BX,BX.UI.Dialogs);
//# sourceMappingURL=util.bundle.map.js