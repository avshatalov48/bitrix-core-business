{"version":3,"file":"script.js","sources":["src/left-menu-aha-moment.js","src/store/add-form-store.js","src/api/client.js","src/api/load/recent-service.js","src/const/mode.js","src/const/filter-mode.js","src/const/space.js","src/store/helper.js","src/store/main-store.js","src/store/store.js","src/util/link-manager.js","src/const/spaces-list-state.js","src/const/event.js","src/components/popup/base-popup.js","src/components/popup-menu/popup-menu-option.js","src/components/popup-menu/popup-menu-button.js","src/components/popup-menu/popup-menu-content.js","src/components/popup-menu/popup-menu.js","src/components/header/recent-header.js","src/api/load/search-service.js","src/components/header/search-header.js","src/components/context-menu/items/context-item.js","src/components/context-menu/items/copy-link.js","src/components/context-menu/items/logout.js","src/components/context-menu/items/pin.js","src/components/context-menu/items/follow.js","src/components/context-menu/items/open.js","src/components/context-menu/context-menu.js","src/components/context-menu/context-menu-collection.js","src/util/date-formatter.js","src/components/space/avatar.js","src/components/space/space-content.js","src/components/popup-short-space/popup-short-space.js","src/components/space/space.js","src/const/keyboard-codes.js","src/components/space-add-form/space-add-form.js","src/components/space-list/space-list-add-button.js","src/components/loader/loader.js","src/components/space-list/space-list.js","src/api/load/recent-search-service.js","src/components/collapsed-mode-toggle-block/collapsed-mode-toggle-block.js","src/components/base-component.js","src/pull/pull-requests.js","src/list.js"],"sourcesContent":["import { ajax, Dom, Loc, Runtime, Type } from 'main.core';\n\nexport class LeftMenuAhaMoment\n{\n\tshowAhaMoment(): void\n\t{\n\t\tconst menuSwitcherNode = document.querySelector('.menu-items-header .menu-switcher');\n\t\tif (Type.isDomNode(menuSwitcherNode))\n\t\t{\n\t\t\tthis.#showSpotlight(menuSwitcherNode);\n\t\t}\n\t\tthis.#dontShowCollapseMenuAhaMoment();\n\t}\n\n\t#dontShowCollapseMenuAhaMoment(): void\n\t{\n\t\tajax.runAction('socialnetwork.api.ahamoment.dontShowCollapseMenuAhaMoment');\n\t}\n\n\t#showSpotlight(targetElement): void\n\t{\n\t\tRuntime.loadExtension(['spotlight', 'ui.tour']).then(() => {\n\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\ttargetElement,\n\t\t\t\ttargetVertex: 'middle-center',\n\t\t\t});\n\n\t\t\tDom.addClass(targetElement, '--active');\n\t\t\tspotlight.bindEvents({\n\t\t\t\tonTargetEnter: () => {\n\t\t\t\t\tDom.removeClass(targetElement, '--active');\n\t\t\t\t\tspotlight.close();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tspotlight.setColor('#2fc6f6');\n\t\t\tspotlight.show();\n\n\t\t\tthis.#showAhaMoment(targetElement, spotlight);\n\t\t});\n\t}\n\n\tasync #showAhaMoment(node, spotlight): void\n\t{\n\t\tconst { Guide } = await Runtime.loadExtension('ui.tour');\n\n\t\tconst guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: node,\n\t\t\t\t\ttitle: Loc.getMessage('SOCIALNETWORK_SPACES_COLLAPSE_MENU_AHA_MOMENT_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('SOCIALNETWORK_SPACES_COLLAPSE_MENU_AHA_MOMENT_TEXT'),\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tguide.showNextStep();\n\n\t\tconst guidePopup = guide.getPopup();\n\t\tguidePopup.setWidth(380);\n\t\tguidePopup.getContentContainer().style.paddingRight = getComputedStyle(guidePopup.closeIcon)['width'];\n\t\tguidePopup.setAngle({ offset: node.offsetWidth / 2 - 5 });\n\t\tguidePopup.subscribe('onClose', () => spotlight.close());\n\t\tguidePopup.setAutoHide(true);\n\t\tguidePopup.getPopupContainer().style.marginLeft = '5px';\n\t\tguidePopup.angle.element.style.left = '-1px';\n\t}\n}","export const AddFormStore = {\n\tstate(): Object\n\t{\n\t\treturn {\n\t\t\tavatarColors: [],\n\t\t\tavatarColor: '29AD49',\n\t\t};\n\t},\n\tactions:\n\t\t{\n\t\t\tsetAvatarColors: (store, colors) => {\n\t\t\t\tstore.commit('setAvatarColors', colors);\n\t\t\t},\n\t\t\tsetAvatarColor: (store, color) => {\n\t\t\t\tstore.commit('setAvatarColor', color);\n\t\t\t},\n\t\t},\n\tmutations:\n\t\t{\n\t\t\tsetAvatarColors: (state, colors) => {\n\t\t\t\tstate.avatarColors = colors;\n\t\t\t},\n\t\t\tsetAvatarColor: (state, color) => {\n\t\t\t\tstate.avatarColor = color;\n\t\t\t},\n\t\t},\n\tgetters:\n\t\t{\n\t\t\tavatarColors: (state) => {\n\t\t\t\treturn state.avatarColors;\n\t\t\t},\n\t\t\tpreviousAvatarColor: (state) => {\n\t\t\t\treturn state.avatarColor;\n\t\t\t},\n\t\t},\n};\n","import { ajax } from 'main.core';\n\nexport type LoadSpacesFields = {\n\tloadedSpacesCount: number,\n\tmode: string,\n\tsearchString: string,\n};\n\nexport type ReloadSpacesFields = {\n\tmode: string,\n};\n\nexport type SearchSpacesFields = {\n\tloadedSpacesCount: number,\n\tsearchString: string,\n};\n\nexport class Client\n{\n\tstatic async loadSpaces(data: LoadSpacesFields): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'loadSpaces';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata,\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tstatic async reloadSpaces(data: ReloadSpacesFields): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'reloadSpaces';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata,\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tstatic async searchSpaces(data: SearchSpacesFields): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'searchSpaces';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata,\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tstatic async loadRecentSearchSpaces(): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'loadRecentSearchSpaces';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, { mode: 'class' });\n\n\t\treturn response.data;\n\t}\n\n\tstatic async addSpaceToRecentSearch(spaceId: number): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'addSpaceToRecentSearch';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tspaceId,\n\t\t\t},\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tstatic async loadSpaceData(spaceId: number): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'loadSpaceData';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tspaceId,\n\t\t\t},\n\t\t});\n\n\t\treturn response.data;\n\t}\n\n\tstatic async loadSpaceTheme(spaceId: number): Promise\n\t{\n\t\tconst componentName = 'bitrix:socialnetwork.spaces.list';\n\t\tconst actionName = 'loadSpaceTheme';\n\n\t\tconst response = await ajax.runComponentAction(componentName, actionName, {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\tspaceId,\n\t\t\t},\n\t\t});\n\n\t\treturn response.data;\n\t}\n}\n","import { Client } from '../client';\nimport { LoadServiceInterface } from './load-service-interface';\nimport { ReloadServiceInterface } from './reload-service-interface';\nimport type { LoadSpacesFields, ReloadSpacesFields } from '../client';\n\nexport type LoadRecentSpacesRequestFields = {\n\tloadedSpacesCount: number,\n\tfilterMode: string,\n};\n\nexport type ReloadRecentSpacesRequestFields = {\n\tfilterMode: string,\n};\n\nexport class RecentService implements LoadServiceInterface, ReloadServiceInterface\n{\n\tstatic instance = null;\n\t#selectedSpaceId: number;\n\thasMoreSpacesToLoad: boolean = true;\n\n\tstatic getInstance(): RecentService\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tsetSelectedSpaceId(selectedSpaceId: number)\n\t{\n\t\tthis.#selectedSpaceId = selectedSpaceId;\n\t}\n\n\tgetSelectedSpaceId(): number\n\t{\n\t\treturn this.#selectedSpaceId;\n\t}\n\n\tasync loadSpaces(data: LoadRecentSpacesRequestFields): Promise\n\t{\n\t\tconst fields: LoadSpacesFields = {};\n\t\tfields.loadedSpacesCount = data.loadedSpacesCount;\n\t\tfields.mode = data.filterMode;\n\t\tfields.searchString = '';\n\n\t\tconst result = await Client.loadSpaces(fields);\n\n\t\tthis.hasMoreSpacesToLoad = result.hasMoreSpacesToLoad;\n\n\t\treturn result;\n\t}\n\n\tcanLoadSpaces(): boolean\n\t{\n\t\treturn this.hasMoreSpacesToLoad;\n\t}\n\n\tasync reloadSpaces(data: ReloadRecentSpacesRequestFields): Promise\n\t{\n\t\tconst fields: ReloadSpacesFields = {};\n\t\tfields.mode = data.filterMode;\n\n\t\tconst result = await Client.reloadSpaces(fields);\n\t\tthis.hasMoreSpacesToLoad = result.hasMoreSpacesToLoad;\n\n\t\treturn result;\n\t}\n}\n","export const Modes = Object.freeze({\n\trecent: 'recent',\n\trecentSearch: 'recentSearch',\n\tsearch: 'search',\n});\n","export const FilterModeTypes = Object.freeze({\n\tmy: 'my',\n\tother: 'other',\n\tall: 'all',\n});\n\nexport const FilterModes = Object.freeze([\n\t{\n\t\ttype: FilterModeTypes.my,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_MY_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_MY_DESCRIPTION',\n\t},\n\t{\n\t\ttype: FilterModeTypes.other,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_OTHER_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_OTHER_DESCRIPTION',\n\t},\n\t{\n\t\ttype: FilterModeTypes.all,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_ALL_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_FILTER_MODE_ALL_DESCRIPTION',\n\t},\n]);\n","export const SpaceViewModeTypes = Object.freeze({\n\topen: 'open',\n\tclosed: 'closed',\n\tsecret: 'secret',\n});\n\nexport const SpaceViewModes = Object.freeze([\n\t{\n\t\ttype: SpaceViewModeTypes.open,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_OPEN_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_OPEN_DESCRIPTION',\n\t},\n\t{\n\t\ttype: SpaceViewModeTypes.closed,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_CLOSED_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_CLOSED_DESCRIPTION',\n\t},\n\t{\n\t\ttype: SpaceViewModeTypes.secret,\n\t\tnameMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_SECRET_TITLE',\n\t\tdescriptionMessageId: 'SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_SECRET_DESCRIPTION',\n\t},\n]);\n\nexport const SpaceUserRoles = Object.freeze({\n\tnonMember: 'nonMember',\n\tapplicant: 'applicant',\n\tinvited: 'invited',\n\tmember: 'member',\n});\n","import { RecentService } from '../api/load/recent-service';\nimport { Modes } from '../const/mode';\nimport { FilterModeTypes } from '../const/filter-mode';\nimport { SpaceUserRoles } from '../const/space';\n\nimport type { SpaceModel } from '../model/space-model';\nimport type { InvitationModel } from '../model/invitation-model';\nimport type { RecentActivityModel } from '../model/recent-activity-model';\n\nexport class Helper\n{\n\tstatic instance = null;\n\tstatic getInstance(): Helper\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tbuildSpaces(spaces): SpaceModel[]\n\t{\n\t\treturn spaces.map((spaceData) => ({\n\t\t\tid: parseInt(spaceData.id, 10),\n\t\t\tname: spaceData.name,\n\t\t\tisPinned: spaceData.isPinned,\n\t\t\tisSelected: RecentService.getInstance().getSelectedSpaceId() === parseInt(spaceData.id, 10),\n\t\t\trecentActivity: this.buildRecentActivity(spaceData.recentActivityData),\n\t\t\tavatar: spaceData.avatar,\n\t\t\tvisibilityType: spaceData.visibilityType,\n\t\t\tcounter: parseInt(spaceData.counter, 10),\n\t\t\tlastSearchDate: new Date(this.convertTimestampFromPhp(spaceData.lastSearchDateTimestamp)),\n\t\t\tlastSearchDateTimestamp: spaceData.lastSearchDateTimestamp * 1000,\n\t\t\tuserRole: spaceData.userRole,\n\t\t\tfollow: spaceData.follow,\n\t\t\ttheme: [],\n\t\t\tpermissions: spaceData.permissions,\n\t\t}));\n\t}\n\n\tconvertTimestampFromPhp(timestamp: number | string): number\n\t{\n\t\treturn parseInt(timestamp, 10) * 1000;\n\t}\n\n\tbuildInvitations(invitations): InvitationModel[]\n\t{\n\t\treturn invitations.map((invitationData) => ({\n\t\t\tspaceId: parseInt(invitationData.spaceId, 10),\n\t\t\tmessage: invitationData.message,\n\t\t\tinvitationDateTimestamp: this.convertTimestampFromPhp(invitationData.invitationDateTimestamp),\n\t\t\tinvitationDate: new Date(this.convertTimestampFromPhp(invitationData.invitationDateTimestamp)),\n\t\t}));\n\t}\n\n\tbuildRecentActivity(recentActivityData): RecentActivityModel\n\t{\n\t\tconst recentActivity: RecentActivityModel = {};\n\n\t\trecentActivity.description = recentActivityData.description;\n\t\trecentActivity.typeId = recentActivityData.typeId;\n\t\trecentActivity.entityId = parseInt(recentActivityData.entityId, 10);\n\t\trecentActivity.timestamp = this.convertTimestampFromPhp(recentActivityData.timestamp);\n\t\trecentActivity.date = new Date(recentActivity.timestamp);\n\n\t\treturn recentActivity;\n\t}\n\n\tgetStringCapitalized(string: string): string\n\t{\n\t\treturn string[0].toUpperCase() + string.slice(1);\n\t}\n\n\tgetModelNameByListViewMode(mode: string): string\n\t{\n\t\tlet result = `${mode}ListSpaceIds`;\n\t\tif (mode === Modes.search)\n\t\t{\n\t\t\tresult = 'searchResultFromServerSpaceIds';\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdoAddSpaceToRecentList(space: SpaceModel, lastRecentSpace: SpaceModel, filterMode: string): boolean\n\t{\n\t\tconst doDateActivityFits = lastRecentSpace.recentActivity.date < space.recentActivity.date;\n\t\tconst doUserRoleFitsFilterMode = this.doSpaceUserRoleFitsFilterMode(space.userRole, filterMode);\n\n\t\treturn (doDateActivityFits && doUserRoleFitsFilterMode) || space.id === 0;\n\t}\n\n\tdoSpaceUserRoleFitsFilterMode(userRole: string, filterMode: string): boolean\n\t{\n\t\tif ([SpaceUserRoles.nonMember, SpaceUserRoles.applicant].includes(userRole) && filterMode === FilterModeTypes.my)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (userRole === SpaceUserRoles.member && filterMode === FilterModeTypes.other)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn userRole !== SpaceUserRoles.invited;\n\t}\n}\n","import { Helper } from './helper';\nimport { FilterModeTypes } from '../const/filter-mode';\n\nimport { RecentService } from '../api/load/recent-service';\n\nimport type { SpaceModel } from '../model/space-model';\nimport type { InvitationModel } from '../model/invitation-model';\n\nexport const MainStore = {\n\tstate(): Object\n\t{\n\t\treturn {\n\t\t\tspaces: new Map(),\n\t\t\trecentListSpaceIds: new Set(),\n\t\t\tsearchResultFromServerSpaceIds: new Set(),\n\t\t\tsearchResultFromLoadedSpaceIds: new Set(),\n\t\t\tinvitations: new Map(),\n\t\t\tinvitationSpaceIds: new Set(),\n\t\t\trecentSearchListSpaceIds: new Set(),\n\t\t\tselectedFilterModeType: '',\n\t\t\tspacesListState: '',\n\t\t\tcanCreateGroup: false,\n\t\t};\n\t},\n\tactions:\n\t\t{\n\t\t\tsetSpaces: (store, spaces) => {\n\t\t\t\tstore.commit('setSpaces', Helper.getInstance().buildSpaces(spaces));\n\t\t\t},\n\t\t\tsetInvitations: (store, invitations) => {\n\t\t\t\tstore.commit('setInvitations', Helper.getInstance().buildInvitations(invitations));\n\t\t\t},\n\t\t\tsetCanCreateGroup: (store, canCreateGroup) => {\n\t\t\t\tstore.commit('setCanCreateGroup', canCreateGroup);\n\t\t\t},\n\t\t\tsetRecentSpaceIds: (store, spaceIds) => {\n\t\t\t\tstore.commit('setRecentListSpaceIds', spaceIds);\n\t\t\t},\n\t\t\tsetInvitationSpaceIds: (store, spacesIds) => {\n\t\t\t\tstore.commit('setInvitationSpaceIds', spacesIds);\n\t\t\t},\n\t\t\tsetRecentSearchSpaceIds: (store, spaceIds) => {\n\t\t\t\tstore.commit('setRecentSearchListSpaceIds', spaceIds);\n\t\t\t},\n\t\t\taddSpaces: (store, spaces) => {\n\t\t\t\tstore.commit('addSpaces', Helper.getInstance().buildSpaces(spaces));\n\t\t\t},\n\t\t\tsetSelectedFilterModeType: (store, selectedFilterModeType) => {\n\t\t\t\tstore.commit('setSelectedFilterModeType', selectedFilterModeType);\n\t\t\t},\n\t\t\tsetSelectedSpace: (store, selectedSpaceId) => {\n\t\t\t\tconst previousSelectedSpaceId = RecentService.getInstance().getSelectedSpaceId();\n\t\t\t\tRecentService.getInstance().setSelectedSpaceId(selectedSpaceId);\n\n\t\t\t\tstore.commit('setSelectedSpace', {\n\t\t\t\t\tspaceId: previousSelectedSpaceId,\n\t\t\t\t\tselected: false,\n\t\t\t\t});\n\t\t\t\tstore.commit('setSelectedSpace', {\n\t\t\t\t\tspaceId: selectedSpaceId,\n\t\t\t\t\tselected: true,\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetSpacesListState: (store, spacesListState) => {\n\t\t\t\tstore.commit('setSpacesListState', spacesListState);\n\t\t\t},\n\t\t\tsetLocalSearchResult: (store, spaceIds) => {\n\t\t\t\tstore.commit('setSearchResultFromLoadedSpaceIds', spaceIds);\n\t\t\t},\n\t\t\tclearSpacesViewByMode: (store, mode) => {\n\t\t\t\tconst storeHelper = Helper.getInstance();\n\t\t\t\tconst modelName = storeHelper.getModelNameByListViewMode(mode);\n\t\t\t\tconst modelNameCapitalized = storeHelper.getStringCapitalized(modelName);\n\n\t\t\t\tstore.commit(`set${modelNameCapitalized}`, []);\n\t\t\t},\n\t\t\taddSpacesToView: (store, data) => {\n\t\t\t\tconst storeHelper = Helper.getInstance();\n\n\t\t\t\tconst changedModel = storeHelper.getModelNameByListViewMode(data.mode);\n\t\t\t\tconst changedModelCapitalized = storeHelper.getStringCapitalized(changedModel);\n\n\t\t\t\tconst spaces = storeHelper.buildSpaces(data.spaces);\n\t\t\t\tconst addedSpaceIds = spaces.map((space) => space.id);\n\t\t\t\tconst newSpaceIds = [...store.state[changedModel], ...addedSpaceIds];\n\n\t\t\t\tstore.commit(`set${changedModelCapitalized}`, newSpaceIds);\n\t\t\t\tstore.commit('addSpaces', spaces);\n\t\t\t},\n\t\t\tpinSpace: (store, data) => {\n\t\t\t\tstore.commit('pinSpace', data);\n\t\t\t},\n\t\t\tchangeUserRole: (store, data) => {\n\t\t\t\tstore.commit('changeUserRole', data);\n\t\t\t},\n\t\t\tdeleteInvitationFromStore: (store, data) => {\n\t\t\t\tconst spaceId = data.spaceId;\n\t\t\t\tstore.commit('deleteInvitationBySpaceId', spaceId);\n\t\t\t},\n\t\t\tdeleteSpaceFromStore: (store, data) => {\n\t\t\t\tconst spaceId = data.spaceId;\n\t\t\t\tstore.commit('deleteSpaceById', spaceId);\n\t\t\t},\n\t\t\tupdateCounters: (store, data) => {\n\t\t\t\tconst userId = data.userId;\n\t\t\t\tconst total = data.total;\n\n\t\t\t\tBX.ready(() => {\n\t\t\t\t\tif (BX.getClass('BX.Intranet.LeftMenu')) {\n\t\t\t\t\t\tdata.spaces.forEach((space) => {\n\t\t\t\t\t\t\tif (space.id === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst leftMenuCounters = {\n\t\t\t\t\t\t\t\t\tspaces: total,\n\t\t\t\t\t\t\t\t\tsonet_total: space.metrics.countersLiveFeedTotal,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tBX.Intranet.LeftMenu.updateCounters(leftMenuCounters, false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// empty the existing space counters\n\t\t\t\tstore.getters.spaces.forEach((space) => {\n\t\t\t\t\tstore.commit('updateCounter', {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tspaceId: space.id,\n\t\t\t\t\t\tcounter: 0,\n\t\t\t\t\t\ttasksTotal: 0,\n\t\t\t\t\t\tcalendarTotal: 0,\n\t\t\t\t\t\tworkGroupTotal: 0,\n\t\t\t\t\t\tlifeFeedTotal: 0,\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tdata.spaces.forEach((space) => {\n\t\t\t\t\tstore.commit('updateCounter', {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tspaceId: space.id,\n\t\t\t\t\t\tcounter: space.total,\n\t\t\t\t\t\ttasksTotal: space.metrics.countersTasksTotal,\n\t\t\t\t\t\tcalendarTotal: space.metrics.countersCalendarTotal,\n\t\t\t\t\t\tworkGroupTotal: space.metrics.countersWorkGroupRequestTotal,\n\t\t\t\t\t\tlifeFeedTotal: space.metrics.countersLiveFeedTotal,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSpaceData: (store, data) => {\n\t\t\t\tif (data.space && data.isInvitation)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addInvitations', Helper.getInstance().buildInvitations([data.invitation]));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('deleteInvitationBySpaceId', data.spaceId);\n\t\t\t\t}\n\n\t\t\t\tif (data.space)\n\t\t\t\t{\n\t\t\t\t\tconst helper = Helper.getInstance();\n\t\t\t\t\tconst space: SpaceModel = helper.buildSpaces([data.space]).pop();\n\t\t\t\t\tconst lastRecentSpace: SpaceModel = store.getters.recentSpaces[store.getters.recentSpaces.length - 1];\n\t\t\t\t\tstore.commit('addSpaces', [space]);\n\n\t\t\t\t\tif (helper.doAddSpaceToRecentList(space, lastRecentSpace, store.state.selectedFilterModeType))\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('addRecentListSpaceId', space.id);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!helper.doSpaceUserRoleFitsFilterMode(space.userRole, store.state.selectedFilterModeType))\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('removeRecentListSpaceId', space.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('deleteSpaceById', data.spaceId);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateSpaceRecentActivityData: (store, recentActivityData) => {\n\t\t\t\tstore.commit('updateSpaceRecentActivityData', recentActivityData);\n\n\t\t\t\tconst space: SpaceModel = store.state.spaces.get(recentActivityData.spaceId);\n\t\t\t\tif (!space)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst helper = Helper.getInstance();\n\t\t\t\tconst lastRecentSpace: SpaceModel = store.getters.recentSpaces[store.getters.recentSpaces.length - 1];\n\n\t\t\t\tif (helper.doAddSpaceToRecentList(space, lastRecentSpace, store.state.selectedFilterModeType))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addRecentListSpaceId', space.id);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\tmutations:\n\t\t{\n\t\t\tsetSpaces: (state, spaces) => {\n\t\t\t\tstate.spaces.clear();\n\t\t\t\tspaces.forEach((space) => state.spaces.set(space.id, space));\n\t\t\t},\n\t\t\taddSpaces: (state, spaces) => {\n\t\t\t\tspaces.forEach((space) => state.spaces.set(space.id, space));\n\t\t\t},\n\t\t\tsetRecentListSpaceIds: (state, spaceIds) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.recentListSpaceIds = new Set(spaceIds);\n\t\t\t},\n\t\t\taddRecentListSpaceId: (state, spaceId) => {\n\t\t\t\tstate.recentListSpaceIds.add(spaceId);\n\t\t\t},\n\t\t\tremoveRecentListSpaceId: (state, spaceId) => {\n\t\t\t\tstate.recentListSpaceIds.delete(spaceId);\n\t\t\t},\n\t\t\tsetInvitations: (state, invitations) => {\n\t\t\t\tstate.invitations.clear();\n\t\t\t\tinvitations.forEach((invitation) => state.invitations.set(invitation.spaceId, invitation));\n\t\t\t},\n\t\t\tsetInvitationSpaceIds: (state, spaceIds) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.invitationSpaceIds = new Set(spaceIds);\n\t\t\t},\n\t\t\taddInvitations: (state, invitations) => {\n\t\t\t\tinvitations.forEach((invitation) => {\n\t\t\t\t\tstate.invitationSpaceIds.add(invitation.spaceId);\n\t\t\t\t\tstate.invitations.set(invitation.spaceId, invitation);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCanCreateGroup: (state, canCreateGroup) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.canCreateGroup = canCreateGroup;\n\t\t\t},\n\t\t\tsetSearchResultFromServerSpaceIds: (state, spaceIds) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.searchResultFromServerSpaceIds = new Set(spaceIds);\n\t\t\t},\n\t\t\tsetSearchResultFromLoadedSpaceIds: (state, spaceIds) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.searchResultFromLoadedSpaceIds = new Set(spaceIds);\n\t\t\t},\n\t\t\tsetRecentSearchListSpaceIds: (state, spaceIds) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.recentSearchListSpaceIds = new Set(spaceIds);\n\t\t\t},\n\t\t\tsetSelectedFilterModeType: (state, selectedFilterModeType) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.selectedFilterModeType = selectedFilterModeType;\n\t\t\t},\n\t\t\tsetSelectedSpace: (state, selectedState) => {\n\t\t\t\tconst space: SpaceModel | undefined = state.spaces.get(selectedState.spaceId);\n\t\t\t\tif (space)\n\t\t\t\t{\n\t\t\t\t\tspace.isSelected = selectedState.selected;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSpacesListState: (state, spacesListState) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.spacesListState = spacesListState;\n\t\t\t},\n\t\t\tpinSpace: (state, data) => {\n\t\t\t\tconst space: SpaceModel = state.spaces.get(data.spaceId);\n\t\t\t\tspace.isPinned = data.isPinned;\n\t\t\t\tstate.spaces.set(space.id, space);\n\t\t\t},\n\t\t\tchangeUserRole: (state, data) => {\n\t\t\t\tconst space: SpaceModel = state.spaces.get(data.spaceId);\n\t\t\t\tspace.userRole = data.userRole;\n\t\t\t},\n\t\t\tdeleteSpaceById: (state, spaceId: number) => {\n\t\t\t\tstate.spaces.delete(spaceId);\n\t\t\t\tstate.recentListSpaceIds.delete(spaceId);\n\t\t\t\tstate.searchResultFromServerSpaceIds.delete(spaceId);\n\t\t\t\tstate.searchResultFromLoadedSpaceIds.delete(spaceId);\n\t\t\t\tstate.recentSearchListSpaceIds.delete(spaceId);\n\t\t\t},\n\t\t\tdeleteInvitationBySpaceId: (state, spaceId: number) => {\n\t\t\t\tstate.invitations.delete(spaceId);\n\t\t\t\tstate.invitationSpaceIds.delete(spaceId);\n\t\t\t},\n\t\t\tupdateCounter: (state, data) => {\n\t\t\t\tconst spaceId = data.spaceId;\n\t\t\t\tconst counter = data.counter;\n\n\t\t\t\tconst space: SpaceModel = state.spaces.get(spaceId) ?? {};\n\t\t\t\tspace.counter = counter;\n\t\t\t},\n\t\t\tupdateSpaceRecentActivityData: (state, recentActivityData) => {\n\t\t\t\tconst space: SpaceModel = state.spaces.get(recentActivityData.spaceId);\n\t\t\t\tif (!space)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tspace.recentActivity = Helper.getInstance().buildRecentActivity(recentActivityData);\n\t\t\t},\n\t\t},\n\tgetters:\n\t{\n\t\tspaces: (state): Array<SpaceModel> => {\n\t\t\treturn [...state.spaces.values()];\n\t\t},\n\t\tinvitations: (state): Array<InvitationModel> => {\n\t\t\treturn [...state.invitations.values()];\n\t\t},\n\t\tspaceInvitations: (state, getters): Array<SpaceModel> => {\n\t\t\tconst spacesMap = state.spaces;\n\t\t\tconst invitations = getters.invitations;\n\n\t\t\treturn invitations.map((invitation: InvitationModel) => {\n\t\t\t\tconst space: SpaceModel = spacesMap.get(invitation.spaceId);\n\t\t\t\tconst spaceInvitationFields = {\n\t\t\t\t\trecentActivity: {\n\t\t\t\t\t\t...space.recentActivity,\n\t\t\t\t\t\tdescription: invitation.message,\n\t\t\t\t\t\tdate: invitation.invitationDate,\n\t\t\t\t\t\ttimestamp: invitation.invitationDate.getTime(),\n\t\t\t\t\t},\n\t\t\t\t\tcounter: 1,\n\t\t\t\t};\n\n\t\t\t\treturn { ...space, ...spaceInvitationFields };\n\t\t\t}).sort((a: SpaceModel, b: SpaceModel) => {\n\t\t\t\treturn b.recentActivity.date - a.recentActivity.date;\n\t\t\t});\n\t\t},\n\t\tcanCreateGroup: (state) => {\n\t\t\treturn state.canCreateGroup;\n\t\t},\n\t\tspacesListState: (state) => {\n\t\t\treturn state.spacesListState;\n\t\t},\n\t\trecentSpacesUnordered: (state, getters): Array<SpaceModel> => {\n\t\t\tconst spaces = getters.spaces;\n\t\t\tconst unsortedRecentSpaces = spaces.filter((space: SpaceModel) => {\n\t\t\t\treturn state.recentListSpaceIds.has(space.id) && !state.invitationSpaceIds.has(space.id);\n\t\t\t});\n\n\t\t\treturn unsortedRecentSpaces.sort((a: SpaceModel, b: SpaceModel) => {\n\t\t\t\treturn b.recentActivity.date - a.recentActivity.date;\n\t\t\t});\n\t\t},\n\t\trecentSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\tlet result = [];\n\t\t\tswitch (state.selectedFilterModeType)\n\t\t\t{\n\t\t\t\tcase FilterModeTypes.my:\n\t\t\t\t\tresult = getters.myRecentSpaces;\n\t\t\t\t\tbreak;\n\t\t\t\tcase FilterModeTypes.other:\n\t\t\t\t\tresult = getters.otherRecentSpaces;\n\t\t\t\t\tbreak;\n\t\t\t\tcase FilterModeTypes.all:\n\t\t\t\t\tresult = getters.allRecentSpaces;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tmyRecentSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\treturn [\n\t\t\t\t...getters.pinnedSpacesFromRecent,\n\t\t\t\tgetters.commonSpaceFromRecent,\n\t\t\t\t...getters.notPinnedSpacesWithoutCommonFromRecent,\n\t\t\t];\n\t\t},\n\t\totherRecentSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\treturn [...getters.spacesWithoutCommonFromRecent];\n\t\t},\n\t\tallRecentSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\treturn [getters.commonSpaceFromRecent, ...getters.spacesWithoutCommonFromRecent];\n\t\t},\n\t\tcommonSpaceFromRecent: (state, getters): SpaceModel | undefined => {\n\t\t\treturn getters.recentSpacesUnordered.find((space: SpaceModel) => space.id === 0);\n\t\t},\n\t\tspacesWithoutCommonFromRecent: (state, getters): Array<SpaceModel> => {\n\t\t\treturn getters.recentSpacesUnordered.filter((space: SpaceModel) => {\n\t\t\t\treturn space.id !== getters.commonSpaceFromRecent.id;\n\t\t\t});\n\t\t},\n\t\tpinnedSpacesFromRecent: (state, getters): Array<SpaceModel> => {\n\t\t\treturn getters.recentSpacesUnordered.filter((space: SpaceModel) => space.isPinned);\n\t\t},\n\t\tnotPinnedSpacesWithoutCommonFromRecent: (state, getters): Array<SpaceModel> => {\n\t\t\treturn getters.spacesWithoutCommonFromRecent.filter((space: SpaceModel) => !space.isPinned);\n\t\t},\n\t\tsearchSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\tconst spaces = getters.spaces;\n\t\t\tconst searchResultIds = new Set([\n\t\t\t\t...state.searchResultFromLoadedSpaceIds,\n\t\t\t\t...state.searchResultFromServerSpaceIds,\n\t\t\t]);\n\n\t\t\treturn spaces.filter((space: SpaceModel) => searchResultIds.has(space.id));\n\t\t},\n\t\tspacesLoadedByCurrentSearchQueryCount: (state): number => {\n\t\t\treturn state.searchResultFromServerSpaceIds.size;\n\t\t},\n\t\trecentSearchSpaces: (state, getters): Array<SpaceModel> => {\n\t\t\tconst unsortedRecentSearchSpaces = getters.spaces.filter((space: SpaceModel) => {\n\t\t\t\treturn state.recentSearchListSpaceIds.has(space.id);\n\t\t\t});\n\n\t\t\treturn unsortedRecentSearchSpaces.sort((a: SpaceModel, b: SpaceModel) => {\n\t\t\t\treturn b.lastSearchDate - a.lastSearchDate;\n\t\t\t});\n\t\t},\n\t\trecentSpacesCountForLoad: (state, getters): number => {\n\t\t\t// Do this subtraction because of common space.\n\t\t\t// It is selected bypassing the sorting\n\t\t\treturn getters.recentSpaces.length - 1;\n\t\t},\n\t\trecentSearchSpacesCountForLoad: (state, getters): number => {\n\t\t\treturn getters.recentSearchSpaces.length;\n\t\t},\n\t\tsearchSpacesCountForLoad: (state, getters): number => {\n\t\t\treturn getters.spacesLoadedByCurrentSearchQueryCount;\n\t\t},\n\t},\n};\n","import { createStore } from 'ui.vue3.vuex';\nimport { AddFormStore } from './add-form-store';\nimport { MainStore } from './main-store';\n\nexport const Store = createStore({\n\tmodules: {\n\t\taddForm: AddFormStore,\n\t\tmain: MainStore,\n\t},\n});\n","export class LinkManager\n{\n\tstatic groupPath = '';\n\tstatic commonSpacePath = '';\n\n\tstatic getSpaceLink(spaceId: number): string\n\t{\n\t\tlet path = LinkManager.commonSpacePath;\n\t\tif (spaceId > 0)\n\t\t{\n\t\t\tpath = LinkManager.groupPath.replace('#group_id#', spaceId);\n\t\t}\n\n\t\treturn path;\n\t}\n}\n","export const SpacesListStates = Object.freeze({\n\tdefault: 'default',\n\tcollapsed: 'collapsed',\n\texpanded: 'expanded',\n});\n","export const EventTypes = Object.freeze({\n\tshowLoader: 'socialnetwork:spacesList:showLoader',\n\thideLoader: 'socialnetwork:spacesList:hideLoader',\n\ttryToLoadSpacesIfHasNoScrollbar: 'socialnetwork:spacesList:tryToLoadSpacesIfHasNoScrollbar',\n\tspaceListScroll: 'socialnetwork:spacesList:onScroll',\n\tspaceListShown: 'socialnetwork:spacesList:onShown',\n\tshowUpperSpaceAddForm: 'socialnetwork:spacesList:showUpperSpaceAddForm',\n\tshowBtnToggleBlock: 'socialnetwork:spacesList:showBtnToggleBlock',\n\thideSpaceAddForm: 'socialnetwork:spacesList:hideSpaceAddForm',\n\tupdateCounters: 'socialnetwork:spacesList:updateCounters',\n\tchangeSpace: 'socialnetwork:spacesList:changeSpace',\n\tchangeUserRole: 'socialnetwork:spacesList:changeUserRole',\n\tchangeSubscription: 'socialnetwork:spacesList:changeSubscription',\n\tpinChanged: 'socialnetwork:spacesList:pinChanged',\n\tchangeSpaceListState: 'socialnetwork:spacesList:changeSpaceListState',\n\trecentActivityUpdate: 'socialnetwork:spacesList:recentActivityUpdate',\n\trecentActivityDelete: 'socialnetwork:spacesList:recentActivityDelete',\n\topenSpaceFromContextMenu: 'socialnetwork:spacesList:openSpaceFromContextMenu',\n\tchangeMode: 'socialnetwork:spacesList:changeMode',\n});\n","import { Popup, PopupManager } from 'main.popup';\nimport { Type } from 'main.core';\n\nconst POPUP_CONTAINER_PREFIX = '#popup-window-content-';\n// @vue/component\nexport const BasePopup = {\n\tname: 'BasePopup',\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault(): Object {\n\t\t\t\treturn {};\n\t\t\t},\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed: {\n\t\tpopupContainer(): string\n\t\t{\n\t\t\treturn `${POPUP_CONTAINER_PREFIX}${this.id}`;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.instance = this.getPopupInstance();\n\t\tthis.instance.show();\n\t},\n\tmounted()\n\t{\n\t\tthis.instance.adjustPosition({\n\t\t\tforceBindPosition: true,\n\t\t\tposition: this.getPopupConfig().bindOptions.position,\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.closePopup();\n\t},\n\tmethods: {\n\t\tgetPopupInstance(): Popup\n\t\t{\n\t\t\tif (!this.instance)\n\t\t\t{\n\t\t\t\tPopupManager.getPopupById(this.id)?.destroy();\n\t\t\t\tthis.instance = new Popup(this.getPopupConfig());\n\t\t\t}\n\n\t\t\treturn this.instance;\n\t\t},\n\t\tgetDefaultConfig(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tclassName: 'ui-test-popup',\n\t\t\t\tautoHide: true,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.closePopup.bind(this),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetPopupConfig(): Object\n\t\t{\n\t\t\tconst defaultConfig = this.getDefaultConfig();\n\t\t\tconst modifiedOptions = {};\n\n\t\t\tconst defaultClassName = defaultConfig.className;\n\t\t\tif (this.config.className)\n\t\t\t{\n\t\t\t\tmodifiedOptions.className = `${defaultClassName} ${this.config.className}`;\n\t\t\t}\n\n\t\t\tconst offsetTop = this.config.offsetTop ?? defaultConfig.offsetTop;\n\t\t\t// adjust for default popup margin for shadow\n\t\t\tif (this.config.bindOptions?.position === 'top' && Type.isNumber(this.config.offsetTop))\n\t\t\t{\n\t\t\t\tmodifiedOptions.offsetTop = offsetTop - 10;\n\t\t\t}\n\n\t\t\treturn { ...defaultConfig, ...this.config, ...modifiedOptions };\n\t\t},\n\t\tclosePopup()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t\tthis.instance.destroy();\n\t\t\tthis.instance = null;\n\t\t},\n\t\tenableAutoHide()\n\t\t{\n\t\t\tthis.getPopupInstance().setAutoHide(true);\n\t\t},\n\t\tdisableAutoHide()\n\t\t{\n\t\t\tthis.getPopupInstance().setAutoHide(false);\n\t\t},\n\t\tadjustPosition()\n\t\t{\n\t\t\tthis.getPopupInstance().adjustPosition({\n\t\t\t\tforceBindPosition: true,\n\t\t\t\tposition: this.getPopupConfig().bindOptions.position,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Teleport :to=\"popupContainer\">\n\t\t\t<slot\n\t\t\t\t:adjustPosition=\"adjustPosition\"\n\t\t\t\t:enableAutoHide=\"enableAutoHide\"\n\t\t\t\t:disableAutoHide=\"disableAutoHide\"\n\t\t\t></slot>\n\t\t</Teleport>\n\t`,\n};\n","// @vue/component\n\nexport const PopupMenuOption = {\n\tprops: {\n\t\toption: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t\tisSelected: Boolean,\n\t},\n\temits: ['changeSelectedOption'],\n\tcomputed: {\n\t\tactive(): string\n\t\t{\n\t\t\treturn this.isSelected ? '--active' : '';\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn `--${this.option.type}-spaces`;\n\t\t},\n\t\tdataId(): string\n\t\t{\n\t\t\treturn `spaces-list-popup-menu-option-${this.option.type}`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t@click=\"this.$emit('changeSelectedOption', option.type)\"\n\t\t\tclass=\"sn-spaces__popup-menu_item\"\n\t\t\t:class=\"active\"\n\t\t\t:data-id=\"dataId\"\n\t\t>\n\t\t\t<div class=\"sn-spaces__popup-menu_item-icon\" :class=\"iconClass\"/>\n\t\t\t<div class=\"sn-spaces__popup-menu_item-info\">\n\t\t\t\t<div class=\"sn-spaces__popup-menu_item-name\">{{ option.name }}</div>\n\t\t\t\t<div class=\"sn-spaces__popup-menu_item-description\">{{ option.description }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\n// @vue/component\nexport const PopupMenuButton = {\n\tprops: {\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['popupMenuButtonClick'],\n\tcomputed: {\n\t\tdoShowIcon(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.config.class);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"sn-spaces__popup-menu_item sn-spaces__popup-menu_item-btn\"\n\t\t\tdata-id=\"spaces-popup-menu-button\"\n\t\t\t@click=\"this.$emit('popupMenuButtonClick')\"\n\t\t>\n\t\t\t<div v-if=\"doShowIcon\" class=\"ui-icon-set\" :class=\"config.class\"></div>\n\t\t\t{{config.text}}\n\t\t</div>\n\t`,\n};\n","import { PopupMenuOption } from './popup-menu-option';\nimport { PopupMenuButton } from './popup-menu-button';\n// @vue/component\nexport const PopupMenuContent = {\n\tname: 'ModePopupContent',\n\tcomponents: {\n\t\tPopupMenuOption,\n\t\tPopupMenuButton,\n\t},\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedOption: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tbutton: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => {},\n\t\t},\n\t},\n\temits: ['closePopup', 'changeSelectedOption', 'popupMenuButtonClick'],\n\tcomputed: {\n\t\tdoShowHint(): boolean\n\t\t{\n\t\t\treturn this.hint.length > 0;\n\t\t},\n\t\tdoShowButton(): boolean\n\t\t{\n\t\t\treturn this.button?.text?.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tonChangeSelectedOption(newSelectedOption)\n\t\t{\n\t\t\tthis.$emit('closePopup');\n\t\t\tthis.$emit('changeSelectedOption', newSelectedOption);\n\t\t},\n\t\tonPopupMenuButtonClick()\n\t\t{\n\t\t\tthis.$emit('closePopup');\n\t\t\tthis.$emit('popupMenuButtonClick');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__popup-menu\">\n\t\t\t<PopupMenuOption\n\t\t\t\tv-for=\"option in options\"\n\t\t\t\t:option=\"option\"\n\t\t\t\t:key=\"option.type\"\n\t\t\t\t:isSelected=\"option.type === this.selectedOption\"\n\t\t\t\t@changeSelectedOption=\"onChangeSelectedOption\"\n\t\t\t/>\n\t\t\t<div v-if=\"doShowHint\" class=\"sn-spaces__popup-menu_hint\">\n\t\t\t\t{{hint}}\n\t\t\t</div>\n\t\t\t<PopupMenuButton\n\t\t\t\tv-if=\"doShowButton\"\n\t\t\t\t:config=\"button\"\n\t\t\t\t@popupMenuButtonClick=\"onPopupMenuButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nimport { BasePopup } from '../popup/base-popup';\nimport { PopupMenuContent } from './popup-menu-content';\n\nconst POPUP_ID = 'socialnetwork-spaces-list-mode-popup';\n\nexport const PopupMenu = {\n\tcomponents: { BasePopup, PopupMenuContent },\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedOption: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tbutton: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => {},\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tPOPUP_ID(): string {\n\t\t\treturn `${POPUP_ID}-${this.context}`;\n\t\t},\n\t\tconfig(): Object {\n\t\t\treturn {\n\t\t\t\tclassName: 'ui-test-popup',\n\t\t\t\twidth: 343,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toverlay: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t};\n\t\t},\n\t},\n\temits: ['close', 'changeSelectedOption', 'popupMenuButtonClick'],\n\tmethods: {\n\t\tonChangeSelectedOption(newSelectedOption)\n\t\t{\n\t\t\tthis.$emit('changeSelectedOption', newSelectedOption);\n\t\t},\n\t\tonPopupMenuButtonClick()\n\t\t{\n\t\t\tthis.$emit('popupMenuButtonClick');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BasePopup\n\t\t\t:config=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t\tv-slot=\"{enableAutoHide, disableAutoHide}\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t>\n\t\t\t<PopupMenuContent\n\t\t\t\t:options=\"options\"\n\t\t\t\t:selectedOption=\"selectedOption\"\n\t\t\t\t:hint=\"hint\"\n\t\t\t\t@closePopup=\"$emit('close')\"\n\t\t\t\t@enableAutoHide=\"enableAutoHide\"\n\t\t\t\t@disableAutoHide=\"disableAutoHide\"\n\t\t\t\t@changeSelectedOption=\"onChangeSelectedOption\"\n\t\t\t\t@popupMenuButtonClick=\"onPopupMenuButtonClick\"\n\t\t\t\t:button=\"button\"\n\t\t\t/>\n\t\t</BasePopup>\n\t`,\n};\n","import { EventTypes } from '../../const/event';\nimport { FilterModes } from '../../const/filter-mode';\nimport { PopupMenu } from '../popup-menu/popup-menu';\nimport { Modes } from '../../const/mode';\nimport { RecentService } from '../../api/load/recent-service';\n\n// @vue/component\nexport const RecentHeader = {\n\tcomponents: {\n\t\tPopupMenu,\n\t},\n\tprops: {\n\t\tcanCreateGroup: Boolean,\n\t},\n\temits: ['changeMode'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowModePopup: false,\n\t\t\tisSpaceListScrolled: false,\n\t\t\tfilterModes: FilterModes,\n\t\t};\n\t},\n\tcomputed: {\n\t\tscrollClass(): string\n\t\t{\n\t\t\treturn this.isSpaceListScrolled ? '--scroll-content' : '';\n\t\t},\n\t\tselectedFilterModeType(): string\n\t\t{\n\t\t\treturn this.$store.state.main.selectedFilterModeType;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tconst selectedType = this.selectedFilterModeType;\n\t\t\tconst selectedMode = this.filterModes.find((mode) => mode.type === selectedType);\n\n\t\t\treturn selectedMode ? this.loc(selectedMode.nameMessageId) : this.loc('SOCIALNETWORK_SPACES_TITLE');\n\t\t},\n\t\tselectFilterModeButtonIconModifier(): string\n\t\t{\n\t\t\treturn `--${this.selectedFilterModeType}`;\n\t\t},\n\t\tpopupMenuOptions(): Array\n\t\t{\n\t\t\treturn this.filterModes.map((filterMode) => ({\n\t\t\t\ttype: filterMode.type,\n\t\t\t\tname: this.loc(filterMode.nameMessageId),\n\t\t\t\tdescription: this.loc(filterMode.descriptionMessageId),\n\t\t\t}));\n\t\t},\n\t\tpopupMenuButton(): Object\n\t\t{\n\t\t\tif (!this.canCreateGroup)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('SOCIALNETWORK_SPACES_LIST_MODE_POPUP_NEW_SPACE_BUTTON'),\n\t\t\t\tclass: '--plus-30',\n\t\t\t};\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.spaceListScroll, this.handleListChanges);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.spaceListShown, this.handleListChanges);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.spaceListScroll, this.handleListChanges);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.spaceListShown, this.handleListChanges);\n\t},\n\tmethods: {\n\t\tloc(phraseCode): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t\topenPopup()\n\t\t{\n\t\t\tthis.showModePopup = true;\n\t\t},\n\t\thandleListChanges(event)\n\t\t{\n\t\t\tconst isSpaceListScrolled = event.data.isSpaceListScrolled;\n\t\t\tconst mode = event.data.mode;\n\t\t\tif (mode === Modes.recent)\n\t\t\t{\n\t\t\t\tthis.isSpaceListScrolled = isSpaceListScrolled;\n\t\t\t}\n\t\t},\n\t\tenableSearch()\n\t\t{\n\t\t\tthis.$emit('changeMode', Modes.recentSearch);\n\t\t},\n\t\tasync onChangeSelectedFilterMode(filterMode)\n\t\t{\n\t\t\tif (this.selectedFilterModeType !== filterMode)\n\t\t\t{\n\t\t\t\tconst recentService = RecentService.getInstance();\n\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.showLoader, Modes.recent);\n\t\t\t\tconst result = await recentService.reloadSpaces({\n\t\t\t\t\tfilterMode,\n\t\t\t\t});\n\t\t\t\tthis.$store.dispatch('setSelectedFilterModeType', filterMode);\n\t\t\t\tthis.$store.dispatch('clearSpacesViewByMode', Modes.recent);\n\t\t\t\tthis.$store.dispatch('addSpacesToView', { mode: Modes.recent, spaces: result.spaces });\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.hideLoader, Modes.recent);\n\t\t\t}\n\t\t},\n\t\tonCreateSpaceButtonClick()\n\t\t{\n\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.showUpperSpaceAddForm);\n\t\t},\n\t\tshowBtnArrow()\n\t\t{\n\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.showBtnToggleBlock);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"sn-spaces__list-header\" \n\t\t\t:class=\"scrollClass\"\n\t\t\t@mouseenter=\"showBtnArrow\"\n\t\t>\n\t\t\t<div\n\t\t\t\t@click=\"openPopup\"\n\t\t\t\tclass=\"sn-spaces__list-header_name\"\n\t\t\t\tref=\"spaces-list-header-name\"\n\t\t\t\tdata-id=\"spaces-header-title\"\n\t\t\t>\n\t\t\t\t<div class=\"sn-spaces__list-header_name-block\">\n\t\t\t\t\t<div class=\"sn-spaces__list-header_title\">\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-icon-set --chevron-down\" style='--ui-icon-set__icon-size: 15px;'>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__list-header_btn-spaces\" :class=\"selectFilterModeButtonIconModifier\"></div>\n\t\t\t</div>\n\t\t\t<PopupMenu\n\t\t\t\t:options=\"popupMenuOptions\"\n\t\t\t\tcontext=\"space-recent-header\"\n\t\t\t\t:bind-element=\"$refs['spaces-list-header-name'] || {}\"\n\t\t\t\t:selectedOption=\"selectedFilterModeType\"\n\t\t\t\t:hint=\"loc('SOCIALNETWORK_SPACES_LIST_MODE_POPUP_BOTTOM_DESCRIPTION')\"\n\t\t\t\t@changeSelectedOption=\"onChangeSelectedFilterMode\"\n\t\t\t\t@popupMenuButtonClick=\"onCreateSpaceButtonClick\"\n\t\t\t\tv-if=\"showModePopup\"\n\t\t\t\t@close=\"showModePopup = false\"\n\t\t\t\t:button=\"popupMenuButton\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-light ui-btn-round ui-btn-xs sn-spaces__list-header_btn-search\"\n\t\t\t\t@click=\"enableSearch\"\n\t\t\t\tdata-id=\"spaces-search-button\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --search-2\"></div>\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tv-if=\"canCreateGroup\"\n\t\t\t\tclass=\"ui-btn ui-btn-light ui-btn-round ui-btn-xs sn-spaces__list-header_btn-add\"\n\t\t\t\t@click=\"onCreateSpaceButtonClick\"\n\t\t\t\tdata-id=\"spaces-header-add-space-button\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --plus-30\"></div>\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { LoadServiceInterface } from './load-service-interface';\nimport { ReloadServiceInterface } from './reload-service-interface';\nimport { Client } from '../client';\nimport { LoadRecentSpacesRequestFields } from './recent-service';\nimport { FilterModeTypes } from '../../const/filter-mode';\n\nimport type { SearchSpacesFields } from '../client';\n\nconst MINIMUM_QUERY_LENGTH_FOR_LOAD = 3;\n\nexport class SearchService implements LoadServiceInterface, ReloadServiceInterface\n{\n\tstatic instance = null;\n\thasMoreSpacesToLoad: boolean = true;\n\tsearchString: string = '';\n\n\tstatic getInstance(): SearchService\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tasync loadSpaces(data: LoadRecentSpacesRequestFields): Promise\n\t{\n\t\tconst fields: SearchSpacesFields = {};\n\t\tfields.loadedSpacesCount = data.loadedSpacesCount;\n\t\tfields.mode = FilterModeTypes.all;\n\t\tfields.searchString = this.searchString;\n\n\t\tconst result = await Client.searchSpaces(fields);\n\n\t\tthis.hasMoreSpacesToLoad = result.hasMoreSpacesToLoad;\n\n\t\treturn result;\n\t}\n\n\tcanLoadSpaces(): boolean\n\t{\n\t\treturn this.hasMoreSpacesToLoad && this.searchString.length >= MINIMUM_QUERY_LENGTH_FOR_LOAD;\n\t}\n}\n","import { Modes } from '../../const/mode';\nimport { EventTypes } from '../../const/event';\nimport { Runtime } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { SearchService } from '../../api/load/search-service';\n\nimport type { SpaceModel } from '../../model/space-model';\n\nexport const SearchHeader = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tisSpaceListScrolled: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.startSearchDebounced = Runtime.debounce(this.startSearch, 500, this);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.spaceListScroll, this.handleListChanges);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.spaceListShown, this.handleListChanges);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.spaceListScroll, this.handleListChanges);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.spaceListShown, this.handleListChanges);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tspaces: 'spaces',\n\t\t}),\n\t\tscrollClass(): string\n\t\t{\n\t\t\treturn this.isSpaceListScrolled ? '--scroll-content' : '';\n\t\t},\n\t},\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t\tcloseSearch()\n\t\t{\n\t\t\tthis.searchQuery = '';\n\t\t\tthis.$emit('changeMode', Modes.recent);\n\t\t},\n\t\thandleListChanges(event)\n\t\t{\n\t\t\tconst isSpaceListScrolled = event.data.isSpaceListScrolled;\n\t\t\tconst mode = event.data.mode;\n\t\t\tif ([Modes.search, Modes.recentSearch].includes(mode))\n\t\t\t{\n\t\t\t\tthis.isSpaceListScrolled = isSpaceListScrolled;\n\t\t\t}\n\t\t},\n\t\tonInputChange()\n\t\t{\n\t\t\tSearchService.getInstance().searchString = this.searchQuery;\n\t\t\tif (this.searchQuery.length === 0)\n\t\t\t{\n\t\t\t\tthis.$emit('changeMode', Modes.recentSearch);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.startSearchDebounced();\n\t\t\t}\n\t\t},\n\t\tstartSearch()\n\t\t{\n\t\t\tif (this.searchQuery.length > 0)\n\t\t\t{\n\t\t\t\tSearchService.getInstance().hasMoreSpacesToLoad = true;\n\t\t\t\tthis.$store.dispatch('clearSpacesViewByMode', Modes.search);\n\n\t\t\t\tconst searchResult = this.spaces.filter((space: SpaceModel) => {\n\t\t\t\t\treturn space.name.toLowerCase().includes(this.searchQuery.toLowerCase());\n\t\t\t\t});\n\n\t\t\t\tconst spaceIds = searchResult.map((space: SpaceModel) => space.id);\n\t\t\t\tthis.$store.dispatch('setLocalSearchResult', spaceIds);\n\t\t\t\tthis.$emit('changeMode', Modes.search);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.tryToLoadSpacesIfHasNoScrollbar, Modes.search);\n\t\t\t\t}, 80);\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.input.focus();\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__list-header\" :class=\"scrollClass\">\n\t\t\t<div class=\"sn-spaces__search ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100 ui-ctl-sm\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t:placeholder=\"loc('SOCIALNETWORK_SPACES_LIST_SEARCH_INPUT_PLACEHOLDER')\"\n\t\t\t\t\tv-model.trim=\"searchQuery\"\n\t\t\t\t\tref=\"input\"\n\t\t\t\t\t@input=\"onInputChange\"\n\t\t\t\t\tdata-id=\"spaces-search-input\"\n\t\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"sn-spaces__search-clear ui-ctl-after\"\n\t\t\t\t\t@click=\"closeSearch\"\n\t\t\t\t\tdata-id=\"spaces-close-search-button\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --cross-circle-70\"></div>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\n\ntype Options = {\n\tmessage: string,\n\tspaceId: number,\n}\nexport class ContextItem extends EventEmitter\n{\n\tspaceId: number;\n\tmessage: string;\n\temitter: EventEmitter;\n\n\tconstructor(options: Options)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.ContextItem');\n\n\t\tthis.message = options.message;\n\t\tthis.spaceId = options.spaceId;\n\t\tthis.emitter = new EventEmitter();\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MenuItem } from 'main.popup';\nimport { LinkManager } from '../../../util/link-manager';\nimport { ContextItem } from './context-item';\nimport { UI } from 'ui.notification';\n\nexport class CopyLink extends ContextItem\n{\n\tcreate(): Object\n\t{\n\t\treturn {\n\t\t\ttext: this.message,\n\t\t\tonclick: (event, menuItem: MenuItem) => {\n\t\t\t\tBX.clipboard.copy(location.origin + LinkManager.getSpaceLink(this.spaceId));\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('SN_SPACES_LIST_SPACE_COPY_LINK_NOTIFY'),\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MenuItem } from 'main.popup';\nimport { ContextItem } from './context-item';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { Controller } from 'socialnetwork.controller';\n\nexport class Logout extends ContextItem\n{\n\tcreate(): Object\n\t{\n\t\treturn {\n\t\t\ttext: this.message,\n\t\t\tonclick: (event, menuItem: MenuItem) => {\n\t\t\t\tconst messageBox = new MessageBox({\n\t\t\t\t\tmessage: Loc.getMessage('SN_SPACES_LIST_SPACE_COPY_LOGOUT_POPUP_TEXT'),\n\t\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\t\tokCaption: Loc.getMessage('SN_SPACES_LIST_SPACE_COPY_LOGOUT_POPUP_CONFIRM_BTN'),\n\t\t\t\t\tonOk: () => {\n\t\t\t\t\t\tController.leaveGroup(this.spaceId)\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\t\t\tthis.emit('click');\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\tmessageBox.getOkButton().setDisabled(false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tmessageBox.show();\n\t\t\t},\n\t\t};\n\t}\n}\n","import { ajax } from 'main.core';\nimport { MenuItem } from 'main.popup';\nimport { ContextItem } from './context-item';\nimport { EventTypes } from '../../../const/event';\n\nexport class Pin extends ContextItem\n{\n\tstatic ID = 'pinner';\n\n\tcreate(): Object\n\t{\n\t\treturn {\n\t\t\ttext: this.message,\n\t\t\tonclick: (event, menuItem: MenuItem) => {\n\t\t\t\tthis.#switch().then((result) => {\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\tconst resultMessage = result.data.message;\n\t\t\t\t\tconst resultMode = result.data.mode;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tmenuItem.setText(resultMessage);\n\t\t\t\t\t}, 800);\n\t\t\t\t\tthis.#flush(resultMode);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#switch(): Promise\n\t{\n\t\treturn ajax.runAction('socialnetwork.api.livefeed.spaces.switcher.pin', {\n\t\t\tdata: {\n\t\t\t\tswitcher: {\n\t\t\t\t\ttype: Pin.ID,\n\t\t\t\t\tspaceId: this.spaceId,\n\t\t\t\t},\n\t\t\t\tspace: this.spaceId,\n\t\t\t},\n\t\t});\n\t}\n\n\t#flush(resultMode: string): void\n\t{\n\t\tthis.emit(EventTypes.pinChanged, {\n\t\t\tspaceId: this.spaceId,\n\t\t\tisPinned: resultMode === 'Y',\n\t\t});\n\t}\n}\n","import { ajax } from 'main.core';\nimport { MenuItem } from 'main.popup';\nimport { ContextItem } from './context-item';\n\nexport class Follow extends ContextItem\n{\n\tstatic ID = 'follow';\n\tcreate(): Object\n\t{\n\t\treturn {\n\t\t\ttext: this.message,\n\t\t\tonclick: (event, menuItem: MenuItem) => {\n\t\t\t\tthis.#switch().then((result) => {\n\t\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t\t\tconst resultMessage = result.data.message;\n\t\t\t\t\tconst resultMode = result.data.mode;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tmenuItem.setText(resultMessage);\n\t\t\t\t\t}, 800);\n\t\t\t\t\tthis.#flush(resultMode);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#switch(): Promise\n\t{\n\t\treturn ajax.runAction('socialnetwork.api.livefeed.spaces.switcher.follow', {\n\t\t\tdata: {\n\t\t\t\tswitcher: {\n\t\t\t\t\ttype: Follow.ID,\n\t\t\t\t\tspaceId: this.spaceId,\n\t\t\t\t},\n\t\t\t\tspace: this.spaceId,\n\t\t\t},\n\t\t});\n\t}\n\n\t#flush(resultMode: string): void\n\t{\n\t\tthis.emit('followChanged', {\n\t\t\tspaceId: this.spaceId,\n\t\t\tisFollowed: resultMode === 'Y',\n\t\t});\n\t}\n}\n","import { ContextItem } from './context-item';\nimport { EventTypes } from '../../../const/event';\nimport { MenuItem } from 'main.popup';\n\nexport class Open extends ContextItem\n{\n\tpath: string;\n\n\tcreate(): Object\n\t{\n\t\treturn {\n\t\t\ttext: this.message,\n\t\t\tonclick: (event, menuItem: MenuItem) => {\n\t\t\t\tthis.emitter.emit(EventTypes.openSpaceFromContextMenu, {\n\t\t\t\t\tspaceId: this.spaceId,\n\t\t\t\t});\n\t\t\t\tmenuItem.getMenuWindow().close();\n\t\t\t},\n\t\t};\n\t}\n\n\tsetPath(path: string): Open\n\t{\n\t\tthis.path = path;\n\n\t\treturn this;\n\t}\n}\n","import { Cache } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuManager } from 'main.popup';\nimport { RecentService } from '../../api/load/recent-service';\nimport { Permissions } from '../../model/space-model';\nimport { ContextMenuCollection } from './context-menu-collection';\nimport { CopyLink } from './items/copy-link';\nimport { Logout } from './items/logout';\nimport { Pin } from './items/pin';\nimport { Follow } from './items/follow';\nimport { Open } from './items/open';\nimport { FilterModeTypes } from '../../const/filter-mode';\nimport { Modes } from '../../const/mode';\n\ntype Options = {\n\tspaceId: number,\n\tbindElement: HTMLElement,\n\tpath: string,\n\tisSelected: boolean,\n\tpinMessage: string,\n\tfollowMessage: string,\n\topenMessage: string,\n\tlistFilter: string,\n\tlistMode: string,\n\tpermissions: Permissions,\n}\n\nexport class ContextMenu extends EventEmitter\n{\n\tcollection: ContextMenuCollection;\n\tmenu: Menu;\n\n\t#cache = new Cache.MemoryCache();\n\n\tstatic ID = 'space-context-menu-';\n\n\tconstructor(options: Options)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.ContextMenu');\n\n\t\tthis.#setOptions(options);\n\n\t\tthis.#init();\n\t}\n\n\t#setOptions(options: Options)\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\t#getOption(option: string): any\n\t{\n\t\treturn this.#cache.get('options')[option];\n\t}\n\n\tcreateMenu(): void\n\t{\n\t\tconst id = this.getMenuId();\n\t\tthis.menu = MenuManager.create({\n\t\t\tid,\n\t\t\tcloseByEsc: true,\n\t\t\tbindElement: this.#getOption('bindElement'),\n\t\t\titems: this.getItems(),\n\t\t});\n\t}\n\n\tgetMenuId(): string\n\t{\n\t\treturn ContextMenu.ID + this.#getOption('spaceId');\n\t}\n\n\ttoggle(): void\n\t{\n\t\tthis.collection.destroy();\n\t\tthis.collection.add(this);\n\t\tthis.createMenu();\n\t\tthis.menu.toggle();\n\t}\n\n\tgetSpaceId(): number\n\t{\n\t\treturn this.#getOption('spaceId');\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.menu.getPopupWindow()?.isShown();\n\t}\n\n\tgetItems(): Array<Object>\n\t{\n\t\tconst items = [];\n\t\tif (!this.#getOption('isSelected'))\n\t\t{\n\t\t\tconst open = new Open({\n\t\t\t\tspaceId: this.#getOption('spaceId'),\n\t\t\t\tmessage: this.#getOption('openMessage'),\n\t\t\t});\n\t\t\titems.push(open.setPath(this.#getOption('path')).create());\n\t\t}\n\n\t\tif (\n\t\t\tthis.#getOption('listFilter') === FilterModeTypes.my\n\t\t\t&& this.#getOption('listMode') === Modes.recent\n\t\t)\n\t\t{\n\t\t\tconst pin = new Pin({\n\t\t\t\tspaceId: this.#getOption('spaceId'),\n\t\t\t\tmessage: this.#getOption('pinMessage'),\n\t\t\t});\n\t\t\titems.push(pin.create());\n\t\t}\n\n\t\tconst follow = new Follow({\n\t\t\tspaceId: this.#getOption('spaceId'),\n\t\t\tmessage: this.#getOption('followMessage'),\n\t\t});\n\t\titems.push(follow.create());\n\n\t\tconst copyLink = new CopyLink({\n\t\t\tspaceId: this.#getOption('spaceId'),\n\t\t\tmessage: this.#getOption('copyLinkMessage'),\n\t\t});\n\t\titems.push(copyLink.create());\n\n\t\tconst permissions: Permissions = this.#getOption('permissions');\n\n\t\tif (\n\t\t\tthis.#getOption('listFilter') === FilterModeTypes.my\n\t\t\t&& this.#getOption('listMode') === Modes.recent\n\t\t\t&& permissions.canLeave\n\t\t)\n\t\t{\n\t\t\tconst logout = new Logout({\n\t\t\t\tspaceId: this.#getOption('spaceId'),\n\t\t\t\tmessage: this.#getOption('logoutMessage'),\n\t\t\t});\n\t\t\tlogout.subscribe('click', () => {\n\t\t\t\tif (RecentService.getInstance().getSelectedSpaceId() === this.#getOption('spaceId'))\n\t\t\t\t{\n\t\t\t\t\tthis.emit('openCommonSpace');\n\t\t\t\t}\n\t\t\t});\n\t\t\titems.push(logout.create());\n\t\t}\n\n\t\treturn items;\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.collection = ContextMenuCollection.getInstance();\n\t}\n}\n","import { MenuManager } from 'main.popup';\nimport { ContextMenu } from './context-menu';\n\nexport class ContextMenuCollection\n{\n\tstatic items = [];\n\tstatic instance = null;\n\n\tstatic getInstance(): ContextMenuCollection\n\t{\n\t\tif (ContextMenuCollection.instance === null)\n\t\t{\n\t\t\tContextMenuCollection.instance = new this();\n\t\t}\n\n\t\treturn ContextMenuCollection.instance;\n\t}\n\n\tadd(menu: ContextMenu)\n\t{\n\t\tContextMenuCollection.items.push(menu);\n\t}\n\n\tdestroy(): void\n\t{\n\t\tContextMenuCollection.items.forEach((item: ContextMenu) => {\n\t\t\tconst menu = MenuManager.getMenuById(ContextMenu.ID + item.getSpaceId());\n\t\t\tmenu?.destroy();\n\t\t});\n\t\tContextMenuCollection.items = ContextMenuCollection.items.filter((item: ContextMenu) => item.isShown());\n\t}\n}\n","import { DateTimeFormat } from 'main.date';\n\nexport class DateFormatter\n{\n\t#date: Date;\n\t#currentDate: Date;\n\tstatic formatDate(timestamp: number): string\n\t{\n\t\treturn new DateFormatter(new Date(timestamp)).formatDate();\n\t}\n\n\tconstructor(date: Date)\n\t{\n\t\tthis.#date = date;\n\t\tthis.#currentDate = new Date();\n\t}\n\n\tformatDate(): string\n\t{\n\t\tlet format = '';\n\n\t\tif (this.#isToday())\n\t\t{\n\t\t\tformat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t}\n\t\telse if (this.#isCurrentWeek())\n\t\t{\n\t\t\tformat = 'D';\n\t\t}\n\t\telse if (this.#isCurrentYear())\n\t\t{\n\t\t\tformat = DateTimeFormat.getFormat('DAY_SHORT_MONTH_FORMAT');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformat = DateTimeFormat.getFormat('MEDIUM_DATE_FORMAT');\n\t\t}\n\n\t\treturn DateTimeFormat.format(format, this.#date.getTime() / 1000);\n\t}\n\n\t#isToday(): boolean\n\t{\n\t\treturn this.#date.toLocaleDateString() === this.#currentDate.toLocaleDateString();\n\t}\n\n\t#isCurrentWeek(): boolean\n\t{\n\t\tconst currentWeekNumber = parseInt(DateTimeFormat.format('W', this.#currentDate), 10);\n\t\tconst weekNumber = parseInt(DateTimeFormat.format('W', this.#date), 10);\n\n\t\treturn this.#isCurrentYear() && weekNumber === currentWeekNumber;\n\t}\n\n\t#isCurrentYear(): boolean\n\t{\n\t\treturn this.#date.getFullYear() === this.#currentDate.getFullYear();\n\t}\n}\n","// @vue/component\nimport type { AvatarModel } from '../../model/avatar-model';\n\nexport const Avatar = {\n\tprops: {\n\t\tavatar: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t\tisSecret: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tisInvitation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsecretSpaceImage: '/bitrix/components/bitrix/socialnetwork.spaces.list/templates/.default/images/socialnetwork-spaces_icon_close-spase.svg',\n\t\t};\n\t},\n\tcomputed: {\n\t\tavatarModel(): AvatarModel\n\t\t{\n\t\t\treturn this.avatar;\n\t\t},\n\t\tavatarClass(): string\n\t\t{\n\t\t\tlet result = '';\n\t\t\tif (this.avatarModel.type === 'icon')\n\t\t\t{\n\t\t\t\tif (this.avatarModel.id.length > 0)\n\t\t\t\t{\n\t\t\t\t\tresult = `sonet-common-workgroup-avatar --${this.avatarModel.id}`;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult = 'ui-icon-common-user-group ui-icon';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\ticonStyle(): string\n\t\t{\n\t\t\tlet result = '';\n\t\t\tif (this.avatarModel.type === 'image')\n\t\t\t{\n\t\t\t\tresult = `background-image: url(${this.avatarModel.id});`;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn this.avatarModel.type === 'image' ? 'sn-spaces__list-item_img' : '';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__list-item_icon\" :class=\"avatarClass\">\n\t\t\t<i :style=\"iconStyle\" :class=\"iconClass\"/>\n\t\t\t<div v-if=\"isInvitation\" class=\"sn-spaces__list-item_invitation-icon\">\n\t\t\t\t<div class=\"ui-icon-set --mail\" style=\"--ui-icon-set__icon-size: 18px;\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"sn-spaces__list-item_icon-close\" v-if=\"isSecret\"/>\n\t\t</div>\n\t`,\n};\n","import { DateFormatter } from '../../util/date-formatter';\nimport { SpaceViewModeTypes, SpaceViewModes, SpaceUserRoles } from '../../const/space';\nimport { FilterModeTypes } from '../../const/filter-mode';\nimport { Avatar } from './avatar';\nimport { Modes } from '../../const/mode';\nimport { ajax, Type } from 'main.core';\nimport { Helper } from '../../store/helper';\nimport { BaseEvent } from 'main.core.events';\n\nimport type { SpaceModel } from '../../model/space-model';\n\n// @vue/component\nexport const SpaceContent = {\n\tcomponents: {\n\t\tAvatar,\n\t},\n\tprops: {\n\t\tspace: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisInvitation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tshowAvatar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmodes: Modes,\n\t\t\tspaceUserRoles: SpaceUserRoles,\n\t\t\tdoShowSuccessButton: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tspaceModel(): SpaceModel\n\t\t{\n\t\t\treturn this.space;\n\t\t},\n\t\tselectedFilterModeType(): string\n\t\t{\n\t\t\treturn this.$store.state.main.selectedFilterModeType;\n\t\t},\n\t\tdoShowCounter(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.counter\n\t\t\t\t&& this.spaceModel.counter > 0\n\t\t\t\t&& this.mode === this.modes.recent\n\t\t\t\t&& !this.isApplicantButtonsShown\n\t\t\t;\n\t\t},\n\t\tdoShowPin(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.isPinned\n\t\t\t\t&& this.mode === this.modes.recent\n\t\t\t\t&& !this.isApplicantButtonsShown\n\t\t\t\t&& !this.doShowCounter\n\t\t\t\t&& this.selectedFilterModeType === FilterModeTypes.my\n\t\t\t;\n\t\t},\n\t\tisApplicantButtonsShown(): boolean\n\t\t{\n\t\t\treturn this.doShowJoinButton || this.doShowPendingButton || this.doShowSuccessButton;\n\t\t},\n\t\tdoShowJoinButton(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.userRole === this.spaceUserRoles.nonMember && this.mode === this.modes.recent;\n\t\t},\n\t\tdoShowPendingButton(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.userRole === this.spaceUserRoles.applicant && this.mode === this.modes.recent;\n\t\t},\n\t\tisFollowing(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.userRole !== this.spaceUserRoles.member || this.spaceModel.follow;\n\t\t},\n\t\tspaceDescription(): string\n\t\t{\n\t\t\tconst doShowSpaceVisibilityType = this.isApplicantButtonsShown\n\t\t\t\t|| !this.spaceModel.recentActivity.description\n\t\t\t\t|| this.spaceModel.recentActivity.description.length === 0\n\t\t\t;\n\n\t\t\treturn doShowSpaceVisibilityType ? this.getVisibilityTypeName() : this.spaceModel.recentActivity.description;\n\t\t},\n\t\tisCommon(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.id === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(`onSpaceUpdate_${this.spaceModel.id}`, this.onSpaceUpdate.bind(this));\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(`onSpaceUpdate_${this.spaceModel.id}`, this.onSpaceUpdate.bind(this));\n\t},\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t\tgetVisibilityTypeName(): string\n\t\t{\n\t\t\tif (this.isCommon)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst spaceViewModeNameMessageId = SpaceViewModes.find((spaceViewMode) => {\n\t\t\t\treturn spaceViewMode.type === this.spaceModel.visibilityType;\n\t\t\t})?.nameMessageId;\n\n\t\t\treturn Type.isStringFilled(spaceViewModeNameMessageId)\n\t\t\t\t? this.loc(spaceViewModeNameMessageId)\n\t\t\t\t: ''\n\t\t\t;\n\t\t},\n\t\tformatDate(timestamp: number): string\n\t\t{\n\t\t\treturn DateFormatter.formatDate(timestamp);\n\t\t},\n\t\tisSecretSpace(visibilityType: string): boolean\n\t\t{\n\t\t\treturn visibilityType === SpaceViewModeTypes.secret;\n\t\t},\n\t\tformatCounter(counter: number): string\n\t\t{\n\t\t\tif (counter > 99)\n\t\t\t{\n\t\t\t\treturn '99+';\n\t\t\t}\n\n\t\t\tif (counter === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn counter.toString();\n\t\t},\n\t\tcounterClass(follow: boolean): string\n\t\t{\n\t\t\treturn follow ? 'sn-spaces__list-item_counter' : 'sn-spaces__list-item_counter --mute';\n\t\t},\n\t\tshowSuccessButton()\n\t\t{\n\t\t\tthis.doShowSuccessButton = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.doShowSuccessButton = false;\n\t\t\t}, 1000);\n\t\t},\n\t\tonSpaceUpdate(event: BaseEvent)\n\t\t{\n\t\t\tif (this.mode === this.modes.recent)\n\t\t\t{\n\t\t\t\tconst spaceData = event.data;\n\t\t\t\tconst helper = Helper.getInstance();\n\t\t\t\tconst space: SpaceModel = helper.buildSpaces([spaceData]).pop();\n\n\t\t\t\tconst wasUserApplicant = this.spaceModel.userRole === this.spaceUserRoles.applicant;\n\t\t\t\tconst isUserMember = space.userRole === this.spaceUserRoles.member;\n\n\t\t\t\tif (wasUserApplicant && isUserMember)\n\t\t\t\t{\n\t\t\t\t\tthis.showSuccessButton();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync onJoinButtonClick(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tawait ajax.runAction('socialnetwork.api.userToGroup.join', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tgroupId: this.spaceModel.id,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tconst confirmationNeeded = response.data.confirmationNeeded;\n\t\t\t\tlet userRole = this.spaceUserRoles.member;\n\t\t\t\tif (confirmationNeeded)\n\t\t\t\t{\n\t\t\t\t\tuserRole = this.spaceUserRoles.applicant;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showSuccessButton();\n\t\t\t\t}\n\t\t\t\tthis.$store.dispatch('changeUserRole', {\n\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\tuserRole,\n\t\t\t\t});\n\t\t\t}, (error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t\t},\n\t\tonPendingButtonClick(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tonAcceptedButtonClick(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tasync acceptInvitationButtonClickHandler(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tawait ajax.runAction('socialnetwork.api.userToGroup.acceptOutgoingRequest', {\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.spaceModel.id,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tconst isSuccess = response.data;\n\t\t\t\tif (isSuccess)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.dispatch('changeUserRole', {\n\t\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\t\tuserRole: this.spaceUserRoles.member,\n\t\t\t\t\t});\n\t\t\t\t\tthis.$store.dispatch('deleteInvitationFromStore', {\n\t\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, (error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t\t},\n\t\tasync declineInvitationButtonClickHandler(event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tawait ajax.runAction('socialnetwork.api.userToGroup.rejectOutgoingRequest', {\n\t\t\t\tdata: {\n\t\t\t\t\tgroupId: this.spaceModel.id,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tconst isSuccess = response.data;\n\t\t\t\tif (isSuccess)\n\t\t\t\t{\n\t\t\t\t\tthis.$store.dispatch('deleteInvitationFromStore', {\n\t\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\t});\n\t\t\t\t\tif (this.isSecretSpace(this.spaceModel.visibilityType))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$store.dispatch('deleteSpaceFromStore', {\n\t\t\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$store.dispatch('changeUserRole', {\n\t\t\t\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\t\t\t\tuserRole: this.spaceUserRoles.nonMember,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, (error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Avatar\n\t\t\tv-if=\"showAvatar\"\n\t\t\t:avatar=\"spaceModel.avatar\"\n\t\t\t:isSecret=\"isSecretSpace(spaceModel.visibilityType)\"\n\t\t\t:isInvitation=\"isInvitation\"\n\t\t/>\n\t\t<div class=\"sn-spaces__list-item_info\">\n\t\t\t<div class=\"sn-spaces__list-item_title\" :title=\"spaceModel.name\">\n\t\t\t\t<div class=\"sn-spaces__list-item_name\">{{spaceModel.name}}</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!isFollowing\"\n\t\t\t\t\tclass=\"sn-spaces__list-item_mute ui-icon-set --sound-off\"\n\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 18px;\"\n\t\t\t\t\tdata-id=\"spaces-list-element-mute-icon\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<div class=\"sn-spaces__list-item_description\" data-id=\"spaces-list-element-description\">\n\t\t\t\t{{spaceDescription}}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"sn-spaces__list-item_details\">\n\t\t\t<div class=\"sn-spaces__list-item_time\" data-id=\"spaces-list-element-activity-date\">\n\t\t\t\t{{formatDate(spaceModel.recentActivity.date.getTime())}}\n\t\t\t</div>\n\t\t\t<div class=\"sn-spaces__list-item_changes\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"doShowPin\"\n\t\t\t\t\tclass=\"ui-icon-set --pin-1\"\n\t\t\t\t\tstyle='--ui-icon-set__icon-size: 18px;'\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"doShowCounter\"\n\t\t\t\t\t:class=\"counterClass(isFollowing)\"\n\t\t\t\t\tdata-id=\"spaces-list-element-counter\"\n\t\t\t\t>\n\t\t\t\t\t{{formatCounter(spaceModel.counter)}}\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"doShowJoinButton\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-success ui-btn-no-caps ui-btn-round sn-spaces__list-item_btn-event\"\n\t\t\t\t\t@click=\"onJoinButtonClick\"\n\t\t\t\t\tdata-id=\"spaces-list-element-join-button\"\n\t\t\t\t>\n\t\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_JOIN_SPACE_BUTTON')}}\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"doShowPendingButton\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-primary ui-btn-no-caps ui-btn-round sn-spaces__list-item_btn-event\"\n\t\t\t\t\t@click=\"onPendingButtonClick\"\n\t\t\t\t\tdata-id=\"spaces-list-element-pending-button\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --mail-out\" style='--ui-icon-set__icon-color: white;'></div>\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"doShowSuccessButton\"\n\t\t\t\t\tclass=\"ui-btn ui-btn-xs ui-btn-primary ui-btn-no-caps ui-btn-round sn-spaces__list-item_btn-event\"\n\t\t\t\t\t@click=\"onAcceptedButtonClick\"\n\t\t\t\t\tdata-id=\"spaces-list-element-success-button\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --check\" style='--ui-icon-set__icon-color: white;'></div>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"isInvitation\" class=\"sn-spaces__list-item_btns\">\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-success ui-btn-no-caps ui-btn-round\"\n\t\t\t\t@click=\"acceptInvitationButtonClickHandler\"\n\t\t\t\tdata-id=\"spaces-list-element-accept-invitation-button\"\n\t\t\t>\n\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_ACCEPT_INVITATION_BUTTON')}}\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-no-caps ui-btn-round\"\n\t\t\t\t@click=\"declineInvitationButtonClickHandler\"\n\t\t\t\tdata-id=\"spaces-list-element-decline-invitation-button\"\n\t\t\t>\n\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_DECLINE_INVITATION_BUTTON')}}\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nimport { Modes } from '../../const/mode';\nimport type { SpaceModel } from '../../model/space-model';\nimport { BasePopup } from '../popup/base-popup';\nimport { SpaceContent } from '../space/space-content';\n\nconst POPUP_ID = 'sn-spaces__short';\n\nexport const PopupShortSpace = {\n\tcomponents: {\n\t\tBasePopup,\n\t\tSpaceContent,\n\t},\n\temits: ['closeSpacePopup', 'popupSpaceClick'],\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tspace: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tlink: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisInvitation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmodes: Modes,\n\t\t};\n\t},\n\tcomputed: {\n\t\tPOPUP_ID(): string {\n\t\t\treturn `${POPUP_ID}-${this.context}`;\n\t\t},\n\t\tconfig(): Object {\n\t\t\treturn {\n\t\t\t\tclassName: 'sn-spaces__list-popup',\n\t\t\t\twidth: 293,\n\t\t\t\theight: this.heightPopup,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toverlay: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\toffsetLeft: this.options.left,\n\t\t\t\toffsetTop: -70,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t};\n\t\t},\n\t\tclassModifiers(): string\n\t\t{\n\t\t\tconst classModifiers = [];\n\n\t\t\tif (this.isInvitation)\n\t\t\t{\n\t\t\t\tclassModifiers.push('--invitation');\n\t\t\t}\n\n\t\t\treturn classModifiers.join(' ');\n\t\t},\n\t\tspaceModel(): SpaceModel\n\t\t{\n\t\t\treturn this.space;\n\t\t},\n\t\theightPopup(): number\n\t\t{\n\t\t\treturn this.isInvitation ? 115 : 70;\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopupShortSpace()\n\t\t{\n\t\t\tthis.$emit('closeSpacePopup');\n\t\t},\n\t\tonSpaceClick()\n\t\t{\n\t\t\tthis.$emit('popupSpaceClick');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BasePopup\n\t\t\t:config=\"config\"\n\t\t\t:id=\"POPUP_ID\"\n\t\t>\n\t\t\t<div\n\t\t\t\tref=\"popup-content\"\n\t\t\t\tclass=\"sn-spaces__popup-list_collapsed-mode\"\n\t\t\t\t@click=\"onSpaceClick\"\n\t\t\t\t@mouseleave=\"closePopupShortSpace\"\n\t\t\t>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"sn-spaces__popup-list-item\"\n\t\t\t\t\t:class=\"classModifiers\"\n\t\t\t\t>\n\t\t\t\t\t<SpaceContent \n\t\t\t\t\t\t:space=\"space\" \n\t\t\t\t\t\t:mode=\"mode\"\n\t\t\t\t\t\t:is-invitation=\"isInvitation\"\n\t\t\t\t\t\t:showAvatar=\"false\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BasePopup>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { SpacesListStates } from '../../const/spaces-list-state';\nimport { FilterModeTypes } from '../../const/filter-mode';\nimport { LinkManager } from '../../util/link-manager';\nimport { Client } from '../../api/client';\nimport { SpaceUserRoles } from '../../const/space';\nimport { Modes } from '../../const/mode';\nimport { PopupShortSpace } from '../popup-short-space/popup-short-space';\nimport { ContextMenu } from '../context-menu/context-menu';\nimport { SpaceContent } from './space-content';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { EventTypes } from '../../const/event';\nimport { Controller } from 'socialnetwork.controller';\n\nimport type { SpaceModel } from '../../model/space-model';\n\n// @vue/component\nexport const Space = {\n\tcomponents: {\n\t\tPopupShortSpace,\n\t\tSpaceContent,\n\t},\n\tprops: {\n\t\tspace: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisInvitation: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmodes: Modes,\n\t\t\tspaceUserRoles: SpaceUserRoles,\n\t\t\tshowModePopup: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupShortSpaceOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tleft: this.widthItem,\n\t\t\t};\n\t\t},\n\t\tselectedFilterModeType(): string\n\t\t{\n\t\t\treturn this.$store.state.main.selectedFilterModeType;\n\t\t},\n\t\tclassModifiers(): string\n\t\t{\n\t\t\tconst isRecentMode = this.mode === this.modes.recent;\n\t\t\tconst classModifiers = [];\n\n\t\t\tif (this.spaceModel.isPinned && this.selectedFilterModeType === FilterModeTypes.my && isRecentMode)\n\t\t\t{\n\t\t\t\tclassModifiers.push('--pinned');\n\t\t\t}\n\n\t\t\tif (this.spaceModel.isSelected && isRecentMode)\n\t\t\t{\n\t\t\t\tclassModifiers.push('--active');\n\t\t\t}\n\n\t\t\tif (this.isInvitation)\n\t\t\t{\n\t\t\t\tclassModifiers.push('--invitation');\n\t\t\t}\n\n\t\t\treturn classModifiers.join(' ');\n\t\t},\n\t\tlink(): string\n\t\t{\n\t\t\treturn LinkManager.getSpaceLink(this.spaceModel.id);\n\t\t},\n\t\tspaceModel(): SpaceModel\n\t\t{\n\t\t\treturn this.space;\n\t\t},\n\t\twidthItem(): number\n\t\t{\n\t\t\treturn this.$refs.link.getBoundingClientRect().width;\n\t\t},\n\t\tisCommon(): boolean\n\t\t{\n\t\t\treturn this.spaceModel.id === 0;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventTypes.openSpaceFromContextMenu, this.openSpaceFromContextMenu);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventTypes.openSpaceFromContextMenu, this.openSpaceFromContextMenu);\n\t},\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t\tasync openSpaceFromContextMenu(event: BaseEvent)\n\t\t{\n\t\t\tconst spaceId = event.data.spaceId;\n\t\t\tif (this.spaceModel.id === spaceId)\n\t\t\t{\n\t\t\t\tawait this.onSpaceClick();\n\t\t\t}\n\t\t},\n\t\tgetPinMessage(): string\n\t\t{\n\t\t\treturn this.spaceModel.isPinned\n\t\t\t\t? this.loc('SOCIALNETWORK_SPACES_LIST_SPACE_UNPIN')\n\t\t\t\t: this.loc('SOCIALNETWORK_SPACES_LIST_SPACE_PIN')\n\t\t\t;\n\t\t},\n\t\tgetFollowMessage(): string\n\t\t{\n\t\t\treturn this.spaceModel.follow\n\t\t\t\t? this.loc('SOCIALNETWORK_SPACES_LIST_SPACE_UNFOLLOW')\n\t\t\t\t: this.loc('SOCIALNETWORK_SPACES_LIST_SPACE_FOLLOW')\n\t\t\t;\n\t\t},\n\t\tgetOpenMessage(): string\n\t\t{\n\t\t\treturn this.loc('SOCIALNETWORK_SPACES_LIST_SPACE_OPEN');\n\t\t},\n\t\tgetCopyLinkMessage(): string\n\t\t{\n\t\t\treturn this.loc('SN_SPACES_LIST_SPACE_COPY_LINK');\n\t\t},\n\t\tgetLogoutMessage(): string\n\t\t{\n\t\t\treturn this.loc('SN_SPACES_LIST_SPACE_LOGOUT');\n\t\t},\n\t\tasync onSpaceClick()\n\t\t{\n\t\t\tconst modeBeforeClick = this.mode;\n\n\t\t\tif (this.mode !== Modes.recent)\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.changeMode, Modes.recent);\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('setSelectedSpace', this.spaceModel.id);\n\n\t\t\tBX.Socialnetwork.Spaces.space.reloadPageContent(\n\t\t\t\tLinkManager.getSpaceLink(this.spaceModel.id),\n\t\t\t);\n\n\t\t\tif ([Modes.recentSearch, Modes.search].includes(modeBeforeClick))\n\t\t\t{\n\t\t\t\tawait Client.addSpaceToRecentSearch(this.spaceModel.id);\n\t\t\t}\n\t\t},\n\t\tasync onSpaceContextMenuClick(event: PointerEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tif (this.isCommon || this.spaceModel.userRole !== SpaceUserRoles.member)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menu = new ContextMenu({\n\t\t\t\tspaceId: this.spaceModel.id,\n\t\t\t\tbindElement: event.currentTarget,\n\t\t\t\tpath: this.link,\n\t\t\t\tisSelected: this.spaceModel.isSelected,\n\t\t\t\tpermissions: this.spaceModel.permissions,\n\t\t\t\tlistFilter: this.selectedFilterModeType,\n\t\t\t\tlistMode: this.mode,\n\t\t\t\tpinMessage: this.getPinMessage(),\n\t\t\t\tfollowMessage: this.getFollowMessage(),\n\t\t\t\topenMessage: this.getOpenMessage(),\n\t\t\t\tcopyLinkMessage: this.getCopyLinkMessage(),\n\t\t\t\tlogoutMessage: this.getLogoutMessage(),\n\t\t\t});\n\t\t\tmenu.subscribe('openCommonSpace', () => {\n\t\t\t\tController.openCommonSpace();\n\t\t\t});\n\n\t\t\tmenu.toggle();\n\t\t},\n\t\topenPopup()\n\t\t{\n\t\t\tif (this.$store.getters.spacesListState === SpacesListStates.collapsed)\n\t\t\t{\n\t\t\t\tthis.showModePopup = true;\n\t\t\t}\n\t\t},\n\t\tclosePopup()\n\t\t{\n\t\t\tif (this.$store.getters.spacesListState === SpacesListStates.collapsed)\n\t\t\t{\n\t\t\t\tconst bindElement = this.$refs.link;\n\t\t\t\tconst popupContainer = this.$refs['popup-item']?.$refs['popup-content'];\n\t\t\t\tlet hoverElement = null;\n\n\t\t\t\tEvent.bind(document, 'mouseover', (event) => {\n\t\t\t\t\thoverElement = event.target;\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!popupContainer\n\t\t\t\t\t\t|| (\n\t\t\t\t\t\t\t!bindElement.contains(hoverElement)\n\t\t\t\t\t\t\t&& !popupContainer.contains(hoverElement)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showModePopup = false;\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a\n\t\t\tref=\"link\"\n\t\t\tclass=\"sn-spaces__list-item\"\n\t\t\t:class=\"classModifiers\"\n\t\t\tdata-id=\"spaces-list-element\"\n\t\t\t@click=\"onSpaceClick\"\n\t\t\t@contextmenu=\"onSpaceContextMenuClick\"\n\t\t\t@mouseenter=\"openPopup\"\n\t\t\t@mouseleave=\"closePopup\"\n\t\t>\n\t\t\t<PopupShortSpace\n\t\t\t\tref=\"popup-item\"\n\t\t\t\t:options=\"popupShortSpaceOptions\"\n\t\t\t\t:space=\"space\"\n\t\t\t\t:mode=\"mode\"\n\t\t\t\t:link=\"link\"\n\t\t\t\t:is-invitation=\"isInvitation\"\n\t\t\t\tcontext=\"popup-short-space\"\n\t\t\t\t:bind-element=\"$refs['link'] || {}\"\n\t\t\t\tv-if=\"showModePopup\"\n\t\t\t\t@close=\"showModePopup = false\"\n\t\t\t\t@closeSpacePopup=\"closePopup\"\n\t\t\t\t@popupSpaceClick=\"onSpaceClick\"\n\t\t\t/>\n\t\t\t<SpaceContent \n\t\t\t\t:space=\"space\" \n\t\t\t\t:mode=\"mode\"\n\t\t\t\t:is-invitation=\"isInvitation\"\n\t\t\t/>\n\t\t</a>\n\t`,\n};\n","export const KeyboardCodes = Object.freeze({\n\tenter: 13,\n});","import { BaseEvent } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Client } from '../../api/client';\nimport { EventTypes } from '../../const/event';\nimport { KeyboardCodes } from '../../const/keyboard-codes';\nimport { Modes } from '../../const/mode';\nimport { SpaceViewModeTypes, SpaceViewModes } from '../../const/space';\nimport { LinkManager } from '../../util/link-manager';\nimport { PopupMenu } from '../popup-menu/popup-menu';\nimport { Editor as AvatarEditor } from 'ui.avatar-editor';\nimport { Type, Event, ajax, Dom } from 'main.core';\n\n// @vue/component\nexport const SpaceAddForm = {\n\tcomponents: {\n\t\tPopupMenu,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmodes: Modes,\n\t\t\tspaceViewModes: SpaceViewModes,\n\t\t\tspaceViewModeTypes: SpaceViewModeTypes,\n\t\t\tspaceData: {\n\t\t\t\tname: '',\n\t\t\t\tviewMode: SpaceViewModeTypes.open,\n\t\t\t\timage: null,\n\t\t\t},\n\t\t\tisFocusedOnNameInput: false,\n\t\t\tshowViewModePopup: false,\n\t\t\twasCreateGroupRequestSent: false,\n\t\t\tdoShowNameAlreadyExistsError: false,\n\t\t\tavatarColor: '',\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tavatarColors: 'avatarColors',\n\t\t\tpreviousAvatarColor: 'previousAvatarColor',\n\t\t}),\n\t\tisDataValidated(): boolean\n\t\t{\n\t\t\treturn this.spaceData.name.length > 0 && !this.doShowNameAlreadyExistsError;\n\t\t},\n\t\tconfirmButtonClass(): string\n\t\t{\n\t\t\treturn this.isDataValidated && !this.wasCreateGroupRequestSent ? '' : '--disabled';\n\t\t},\n\t\tpopupMenuOptions(): Array\n\t\t{\n\t\t\treturn this.spaceViewModes.map((spaceViewMode) => ({\n\t\t\t\ttype: spaceViewMode.type,\n\t\t\t\tname: this.loc(spaceViewMode.nameMessageId),\n\t\t\t\tdescription: this.loc(spaceViewMode.descriptionMessageId),\n\t\t\t}));\n\t\t},\n\t\tselectedViewModeOptionName(): string\n\t\t{\n\t\t\treturn this.loc(`SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_${this.spaceData.viewMode.toUpperCase()}_TITLE`);\n\t\t},\n\t\tnameInputModifier(): string\n\t\t{\n\t\t\treturn this.doShowNameAlreadyExistsError ? 'sn-spaces__list-add-item_input-error' : '';\n\t\t},\n\t\tisNameInputReadOnly(): boolean\n\t\t{\n\t\t\treturn this.wasCreateGroupRequestSent;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$refs.spaceAddFormNameInput.focus();\n\t\tEvent.bind(document, 'click', this.handleAutoHide, true);\n\t\tEvent.bind(document, 'keydown', this.handleKeyDown);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.showUpperSpaceAddForm, this.chooseRandomAvatarColor);\n\t\tthis.chooseRandomAvatarColor();\n\t},\n\tunmounted()\n\t{\n\t\tEvent.unbind(document, 'click', this.handleAutoHide, true);\n\t\tEvent.unbind(document, 'keydown', this.handleKeyDown);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.showUpperSpaceAddForm, this.chooseRandomAvatarColor);\n\t},\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t\topenViewModePopup()\n\t\t{\n\t\t\tthis.showViewModePopup = true;\n\t\t},\n\t\tonChangeSelectedOption(newOption)\n\t\t{\n\t\t\tthis.spaceData.viewMode = newOption;\n\t\t},\n\t\tchooseSpaceImage()\n\t\t{\n\t\t\tconst avatarEditor = this.getAvatarEditor();\n\t\t\tavatarEditor.show('file');\n\t\t},\n\t\tgetAvatarEditor(): AvatarEditor\n\t\t{\n\t\t\tif (!this.avatarEditor)\n\t\t\t{\n\t\t\t\tthis.avatarEditor = new AvatarEditor({\n\t\t\t\t\tenableCamera: false,\n\t\t\t\t});\n\n\t\t\t\tDom.addClass(this.avatarEditor.popup.getPopupContainer(), 'sn-spaces__avatar-editor');\n\n\t\t\t\tthis.avatarEditor.subscribe('onApply', (event: BaseEvent) => {\n\t\t\t\t\tconst [file] = event.getCompatData();\n\t\t\t\t\tfile.name ??= 'tmp.png';\n\n\t\t\t\t\tthis.spaceData.image = file;\n\t\t\t\t\tthis.$refs.groupImage.src = URL.createObjectURL(file);\n\n\t\t\t\t\tDom.style(this.$refs.groupImageContainer, 'background', 'none');\n\t\t\t\t\tDom.style(this.$refs.groupImage, 'background', 'none');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.avatarEditor;\n\t\t},\n\t\tonAddSpaceClickHandler()\n\t\t{\n\t\t\tthis.addSpace();\n\t\t},\n\t\tchooseRandomAvatarColor(): void\n\t\t{\n\t\t\tif (this.spaceData.image !== null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!Type.isArrayFilled(this.avatarColors))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst colors = this.avatarColors.filter((color) => color !== this.previousAvatarColor);\n\t\t\tthis.avatarColor = colors[Math.floor(Math.random() * colors.length)];\n\t\t\tDom.style(this.$refs.groupImageContainer, 'backgroundColor', `#${this.avatarColor}`);\n\t\t\tthis.$store.dispatch('setAvatarColor', this.avatarColor);\n\t\t},\n\t\taddSpace()\n\t\t{\n\t\t\tthis.spaceData.name = this.spaceData.name.trim();\n\t\t\tif (this.spaceData.name.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append('groupName', this.spaceData.name);\n\t\t\tformData.append('viewMode', this.spaceData.viewMode);\n\t\t\tif (this.spaceData.image !== null)\n\t\t\t{\n\t\t\t\tformData.append('groupImage', this.spaceData.image, this.spaceData.image.name);\n\t\t\t}\n\t\t\tformData.append('avatarColor', this.avatarColor);\n\n\t\t\tthis.wasCreateGroupRequestSent = true;\n\t\t\tajax.runAction('socialnetwork.api.workgroup.createGroup', {\n\t\t\t\tdata: formData,\n\t\t\t}).then((response) => {\n\t\t\t\tBX.Socialnetwork.Spaces.space.reloadPageContent(\n\t\t\t\t\t`${LinkManager.getSpaceLink(response.data.groupId)}?empty-state=enabled`,\n\t\t\t\t);\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.hideSpaceAddForm);\n\n\t\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\t\tClient.loadSpaceData(response.data.groupId)\n\t\t\t\t\t// eslint-disable-next-line promise/no-nesting\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tthis.$store.dispatch('addSpacesToView', { mode: Modes.recentSearch, spaces: [data.space] });\n\t\t\t\t\t\tthis.$store.dispatch('setSelectedSpace', data.space.id);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}, (errorResponse) => {\n\t\t\t\terrorResponse.errors.forEach((error) => {\n\t\t\t\t\tif (error.code === 'ERROR_GROUP_NAME_EXISTS')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.doShowNameAlreadyExistsError = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.wasCreateGroupRequestSent = false;\n\t\t\t\tconsole.log(errorResponse);\n\t\t\t});\n\t\t},\n\t\thandleAutoHide(event)\n\t\t{\n\t\t\tif (this.shouldHideForm(event))\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.hideSpaceAddForm);\n\t\t\t}\n\t\t},\n\t\thandleKeyDown(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.isFocusedOnNameInput\n\t\t\t\t&& event.keyCode === KeyboardCodes.enter\n\t\t\t\t&& this.isDataValidated\n\t\t\t\t&& !this.wasCreateGroupRequestSent\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.addSpace();\n\t\t\t}\n\t\t},\n\t\tshouldHideForm(event): boolean\n\t\t{\n\t\t\tconst notVisible = this.$refs.spaceAddForm.offsetHeight === 0;\n\t\t\tif (notVisible)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst clickOnSpace = event.target.closest('.sn-spaces__list-item') !== null;\n\t\t\tconst clickOnSelf = this.$refs.spaceAddForm.contains(event.target);\n\t\t\tconst avatarPopupShown = this.avatarEditor?.popup?.isShown();\n\t\t\tconst viewModePopupShown = this.showViewModePopup;\n\t\t\tconst anyPopupShown = avatarPopupShown || viewModePopupShown;\n\n\t\t\treturn !clickOnSelf && !clickOnSpace && !anyPopupShown && !this.formDataChanged();\n\t\t},\n\t\tformDataChanged(): boolean\n\t\t{\n\t\t\tconst isNameFilled = this.spaceData.name !== '';\n\t\t\tconst isViewModeChanged = this.spaceData.viewMode !== SpaceViewModeTypes.open;\n\t\t\tconst isImageChosen = this.$refs.groupImage.src !== '';\n\n\t\t\treturn isNameFilled || isViewModeChanged || isImageChosen;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__list-item --add-active --error\" ref=\"spaceAddForm\" data-id=\"spaces-list-add-space-form\">\n\t\t\t<div class=\"sn-spaces__list-item_add\">\n\t\t\t\t<div class=\"sn-spaces__list-item_icon\" ref=\"groupImageContainer\">\n\t\t\t\t\t<img\n\t\t\t\t\t\talt=\"\" class=\"spaces-list-add-space-image\"\n\t\t\t\t\t\t@click=\"chooseSpaceImage()\"\n\t\t\t\t\t\tref=\"groupImage\"\n\t\t\t\t\t\tdata-id=\"spaces-list-add-space-image\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__list-item_info\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-xs ui-ctl-no-padding ui-ctl-no-border\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tv-model=\"spaceData.name\"\n\t\t\t\t\t\t\ttype=\"text\" class=\"ui-ctl-element\"\n\t\t\t\t\t\t\t:placeholder=\"loc('SOCIALNETWORK_SPACES_LIST_ADD_SPACE_FORM_NAME_PLACEHOLDER')\"\n\t\t\t\t\t\t\tref=\"spaceAddFormNameInput\"\n\t\t\t\t\t\t\tdata-id=\"spaces-list-add-space-name-input\"\n\t\t\t\t\t\t\t@focus=\"isFocusedOnNameInput=true\"\n\t\t\t\t\t\t\t@blur=\"isFocusedOnNameInput=false\"\n\t\t\t\t\t\t\t:class=\"nameInputModifier\"\n\t\t\t\t\t\t\t@input=\"doShowNameAlreadyExistsError=false\"\n\t\t\t\t\t\t\t:readonly=\"isNameInputReadOnly\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div @click=\"openViewModePopup\" ref=\"privacySelector\" class=\"sn-spaces__list-item_select-private\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"sn-spaces__list-item_select-private-text\"\n\t\t\t\t\t\t\tdata-id=\"spaces-list-add-space-view-mode\"\n\t\t\t\t\t\t>{{selectedViewModeOptionName}}</div>\n\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-down\" style=\"--ui-icon-set__icon-size: 14px;\"></div>\n\t\t\t\t\t\t<PopupMenu\n\t\t\t\t\t\t\tv-if=\"showViewModePopup\"\n\t\t\t\t\t\t\t:options=\"popupMenuOptions\"\n\t\t\t\t\t\t\tcontext=\"space-add-form\"\n\t\t\t\t\t\t\t:bind-element=\"this.$refs.privacySelector || {}\"\n\t\t\t\t\t\t\t:hint=\"loc('SOCIALNETWORK_SPACES_LIST_SPACE_VIEW_MODE_HINT')\"\n\t\t\t\t\t\t\t:selectedOption=\"this.spaceData.viewMode\"\n\t\t\t\t\t\t\t@close=\"showViewModePopup = false\"\n\t\t\t\t\t\t\t@changeSelectedOption=\"onChangeSelectedOption\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__list-item_details\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --circle-check sn-spaces__list-item_save-btn\" :class=\"confirmButtonClass\"\n\t\t\t\t\t\t@click=\"onAddSpaceClickHandler()\"\n\t\t\t\t\t\tdata-id=\"spaces-list-add-space-create-button\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"doShowNameAlreadyExistsError\" class=\"sn-spaces__list-item_error\">\n\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_NAME_ALREADY_EXISTS_ERROR')}}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nexport const SpaceListAddButton = {\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__list-item --add-btn\">\n\t\t\t<div class=\"sn-spaces__list-item_icon\">\n\t\t\t</div>\n\t\t\t<div class=\"sn-spaces__list-item_info\">\n\t\t\t\t<div class=\"sn-spaces__list-item_title\">\n\t\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_ADD_SPACE_ITEM_TITLE')}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__list-item_description\">\n\t\t\t\t\t{{loc('SOCIALNETWORK_SPACES_LIST_ADD_SPACE_ITEM_DESCRIPTION')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loader as BaseLoader } from 'main.loader';\n\nexport const Loader = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tloader: null,\n\t\t};\n\t},\n\tprops: {\n\t\tconfig: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault(): Object {\n\t\t\t\treturn {};\n\t\t\t},\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.getLoaderInstance().show();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.destroyLoader();\n\t},\n\tmethods: {\n\t\tgetLoaderInstance(): BaseLoader\n\t\t{\n\t\t\tif (!this.instance)\n\t\t\t{\n\t\t\t\tthis.instance = new BaseLoader(this.getLoaderConfig());\n\t\t\t}\n\n\t\t\treturn this.instance;\n\t\t},\n\t\tgetDefaultConfig(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttarget: this.$refs.root,\n\t\t\t\tsize: 110,\n\t\t\t\tcolor: '#2fc6f6',\n\t\t\t\toffset: {\n\t\t\t\t\tleft: '0px',\n\t\t\t\t\ttop: '0px',\n\t\t\t\t},\n\t\t\t\tmode: 'absolute',\n\t\t\t};\n\t\t},\n\t\tgetLoaderConfig(): Object\n\t\t{\n\t\t\tconst defaultConfig = this.getDefaultConfig();\n\n\t\t\treturn { ...defaultConfig, ...this.config };\n\t\t},\n\t\tdestroyLoader()\n\t\t{\n\t\t\tthis.instance.destroy();\n\t\t\tthis.instance = null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"root\" style=\"position: relative\">\n\t\t</div>\n\t`,\n};\n","import { SpacesListStates } from '../../const/spaces-list-state';\nimport { ContextMenuCollection } from '../context-menu/context-menu-collection';\nimport { Space } from '../space/space';\nimport { SpaceAddForm } from '../space-add-form/space-add-form';\nimport { LoadServiceInterface } from '../../api/load/load-service-interface';\nimport { SpaceListAddButton } from './space-list-add-button';\nimport { EventTypes } from '../../const/event';\nimport { Loader } from '../loader/loader';\nimport { Modes } from '../../const/mode';\nimport { BaseEvent } from 'main.core.events';\n\n// @vue/component\n\nconst PAGINATION_OFFSET = 20;\n\nexport const SpaceList = {\n\tcomponents: {\n\t\tSpace,\n\t\tLoader,\n\t\tSpaceListAddButton,\n\t\tSpaceAddForm,\n\t},\n\temits: ['isSpaceAddFormShown'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisScrollLoading: false,\n\t\t\tisLoading: false,\n\t\t\tmodes: Modes,\n\t\t\tdoShowLowerSpaceAddForm: false,\n\t\t\tdoShowUpperSpaceAddForm: false,\n\t\t\tskeletonItemsAmount: 25,\n\t\t};\n\t},\n\tprops: {\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tspaces: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t\tspaceInvitations: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcanCreateGroup: Boolean,\n\t\tspacesCountForLoad: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tserviceInstance: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tsubtitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(\n\t\t\tEventTypes.tryToLoadSpacesIfHasNoScrollbar,\n\t\t\tthis.tryToLoadSpacesIfHasNoScrollbarHandler,\n\t\t);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.showLoader, this.showLoaderHandler);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.hideLoader, this.hideLoaderHandler);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.showUpperSpaceAddForm, this.showUpperSpaceAddFormHandler);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.hideSpaceAddForm, this.hideSpaceAddFormHandler);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(\n\t\t\tEventTypes.tryToLoadSpacesIfHasNoScrollbar,\n\t\t\tthis.tryToLoadSpacesIfHasNoScrollbarHandler,\n\t\t);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.showLoader, this.showLoaderHandler);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.hideLoader, this.hideLoaderHandler);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.showUpperSpaceAddForm, this.showUpperSpaceAddFormHandler);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.hideSpaceAddForm, this.hideSpaceAddFormHandler);\n\t},\n\tcomputed: {\n\t\tservice(): LoadServiceInterface\n\t\t{\n\t\t\treturn this.serviceInstance;\n\t\t},\n\t\thasScrollbar(): boolean\n\t\t{\n\t\t\treturn this.$refs.list.scrollHeight > this.$refs.list.clientHeight;\n\t\t},\n\t\tloadingClass(): string\n\t\t{\n\t\t\treturn this.isLoading ? '--loading' : '';\n\t\t},\n\t\tfilterMode(): string\n\t\t{\n\t\t\treturn this.$store.state.main.selectedFilterModeType;\n\t\t},\n\t\tdoShowSubtitle(): boolean\n\t\t{\n\t\t\treturn this.subtitle.length > 0;\n\t\t},\n\t\tdoShowSpaceListAddButton(): boolean\n\t\t{\n\t\t\treturn this.canCreateGroup\n\t\t\t\t&& this.mode === this.modes.recent\n\t\t\t\t&& this.spaces.length <= 5\n\t\t\t\t&& !this.isSpaceAddFormShown\n\t\t\t;\n\t\t},\n\t\tdoShowInvitations(): boolean\n\t\t{\n\t\t\treturn this.mode === this.modes.recent && this.spaceInvitations.length > 0;\n\t\t},\n\t\tisSpaceAddFormShown(): boolean\n\t\t{\n\t\t\treturn this.doShowLowerSpaceAddForm || this.doShowUpperSpaceAddForm;\n\t\t},\n\t\tlistState(): string\n\t\t{\n\t\t\treturn this.$store.getters.spacesListState;\n\t\t},\n\t},\n\twatch: {\n\t\tfilterMode()\n\t\t{\n\t\t\tthis.scrollToTop();\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tisShown()\n\t\t{\n\t\t\tif (this.isShown === true)\n\t\t\t{\n\t\t\t\tconst isSpaceListScrolled = this.$refs.list.scrollTop > 0;\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.spaceListShown, { isSpaceListScrolled, mode: this.mode });\n\t\t\t}\n\t\t},\n\t\tdoShowUpperSpaceAddForm()\n\t\t{\n\t\t\tif (this.doShowUpperSpaceAddForm === true)\n\t\t\t{\n\t\t\t\tthis.doShowLowerSpaceAddForm = false;\n\t\t\t}\n\t\t},\n\t\tisSpaceAddFormShown()\n\t\t{\n\t\t\tthis.$emit('isSpaceAddFormShown', this.isSpaceAddFormShown);\n\t\t},\n\t},\n\tmethods: {\n\t\ttryToLoadSpacesIfHasNoScrollbarHandler(event: BaseEvent)\n\t\t{\n\t\t\tconst mode = event.data;\n\t\t\tif (this.isProperMode(mode) && !this.hasScrollbar && this.service.canLoadSpaces())\n\t\t\t{\n\t\t\t\tthis.loadSpaces();\n\t\t\t}\n\t\t},\n\t\tshowLoaderHandler(event: BaseEvent)\n\t\t{\n\t\t\tconst mode = event.data;\n\t\t\tif (this.isProperMode(mode))\n\t\t\t{\n\t\t\t\tthis.isLoading = true;\n\t\t\t}\n\t\t},\n\t\thideLoaderHandler(event: BaseEvent)\n\t\t{\n\t\t\tconst mode = event.data;\n\t\t\tif (this.isProperMode(mode))\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t},\n\t\tshowUpperSpaceAddFormHandler()\n\t\t{\n\t\t\tif (this.mode === this.modes.recent)\n\t\t\t{\n\t\t\t\tthis.doShowUpperSpaceAddForm = true;\n\t\t\t}\n\t\t},\n\t\tshowLowerSpaceAddForm()\n\t\t{\n\t\t\tthis.doShowLowerSpaceAddForm = true;\n\t\t},\n\t\thideSpaceAddFormHandler()\n\t\t{\n\t\t\tthis.doShowLowerSpaceAddForm = false;\n\t\t\tthis.doShowUpperSpaceAddForm = false;\n\n\t\t\tif (this.listState === SpacesListStates.expanded)\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.changeSpaceListState, SpacesListStates.collapsed);\n\t\t\t}\n\t\t},\n\t\tisProperMode(mode: string): boolean\n\t\t{\n\t\t\treturn this.mode === mode;\n\t\t},\n\t\tscrollToTop()\n\t\t{\n\t\t\tthis.$refs.list.scrollTop = 0;\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tconst target = event.target;\n\t\t\tconst isSpaceListScrolled = target.scrollTop > 0;\n\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.spaceListScroll, { isSpaceListScrolled, mode: this.mode });\n\n\t\t\tconst listRemainingSpace = target.scrollHeight - target.offsetHeight;\n\t\t\tconst listScroll = target.scrollTop;\n\n\t\t\tconst isScrolledToBottom = listScroll > (listRemainingSpace - PAGINATION_OFFSET);\n\n\t\t\tif (!this.isScrollLoading && this.service.canLoadSpaces() && isScrolledToBottom)\n\t\t\t{\n\t\t\t\tthis.loadSpaces();\n\t\t\t}\n\n\t\t\tContextMenuCollection.getInstance().destroy();\n\t\t},\n\t\tloadSpaces()\n\t\t{\n\t\t\tthis.isScrollLoading = true;\n\t\t\tthis.service.loadSpaces({\n\t\t\t\tloadedSpacesCount: this.spacesCountForLoad,\n\t\t\t\tfilterMode: this.filterMode,\n\t\t\t}).then((result) => {\n\t\t\t\tthis.$store.dispatch('addSpacesToView', { mode: this.mode, spaces: result.spaces });\n\t\t\t\tthis.isScrollLoading = false;\n\t\t\t}).catch(() => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.isScrollLoading = false;\n\t\t\t\t}, 5000);\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span>\n\t\t\t<Loader v-if=\"isLoading\" :config=\"{offset: {left: '0px', top: '40vh'}}\"/>\n\t\t\t<div\n\t\t\t\t@scroll=\"onScroll\"\n\t\t\t\tclass=\"sn-spaces__list-content\"\n\t\t\t\t:class=\"loadingClass\"\n\t\t\t\tref=\"list\"\n\t\t\t\tdata-id=\"spaces-list-content\"\n\t\t\t>\n\t\t\t\t<div v-show=\"doShowSubtitle\" class=\"sn-spaces__list-subtitle\">\n\t\t\t\t\t{{subtitle}}\n\t\t\t\t</div>\n\t\t\t\t<SpaceAddForm v-if=\"doShowUpperSpaceAddForm\"/>\n\t\t\t\t<div class=\"sn-spaces__list-item_invitation\" v-if=\"doShowInvitations\">\n\t\t\t\t\t<Space\n\t\t\t\t\t\tv-for=\"spaceInvitation in spaceInvitations\"\n\t\t\t\t\t\t:key=\"spaceInvitation.id\"\n\t\t\t\t\t\t:space=\"spaceInvitation\"\n\t\t\t\t\t\t:mode=\"mode\"\n\t\t\t\t\t\t:isInvitation=\"true\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<Space \n\t\t\t\t\tv-for=\"space in spaces\"\n\t\t\t\t\t:key=\"space.id\"\n\t\t\t\t\t:space=\"space\"\n\t\t\t\t\t:mode=\"mode\"\n\t\t\t\t/>\n\t\t\t\t<SpaceListAddButton\n\t\t\t\t\tv-if=\"doShowSpaceListAddButton\"\n\t\t\t\t\t@click=\"showLowerSpaceAddForm\"\n\t\t\t\t\tdata-id=\"spaces-list-add-space-button\"\n\t\t\t\t/>\n\t\t\t\t<SpaceAddForm v-if=\"doShowLowerSpaceAddForm\"/>\n\t\t\t\t<span v-show=\"isScrollLoading\">\n\t\t\t\t\t<div v-for=\"index in skeletonItemsAmount\" :key=\"index\" class=\"sn-spaces__list-skeleton-item\"></div>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</span>\n\t`,\n};\n","import { LoadServiceInterface } from './load-service-interface';\nimport { Client } from '../client';\n\nexport class RecentSearchService implements LoadServiceInterface\n{\n\tstatic instance = null;\n\thasMoreSpacesToLoad: boolean = false;\n\n\tstatic getInstance(): RecentSearchService\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tasync loadSpaces(): Promise\n\t{\n\t\treturn Client.loadRecentSearchSpaces();\n\t}\n\n\tcanLoadSpaces(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import { Dom, ajax } from 'main.core';\nimport { EventTypes } from '../../const/event';\nimport { SpacesListStates } from '../../const/spaces-list-state';\n\n// @vue/component\n\nconst MAX_QUANTITY_SHOW_BTN_TOGGLE_BLOCK = 3;\n\nexport const CollapsedModeToggleBlock = {\n\tname: 'ToggleBlock',\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdataSpacesContent: document.getElementById('sn-spaces__content'),\n\t\t\tcounterImpressionsBtnShowToggleBlock: 0,\n\t\t\tshowBtnShowToggleBlock: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.showBtnToggleBlock, this.showBtnToggleBlockHandler);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.showBtnToggleBlock, this.showBtnToggleBlockHandler);\n\t},\n\tcomputed: {\n\t\tisShowHintBtn(): boolean\n\t\t{\n\t\t\treturn !(this.counterImpressionsBtnShowToggleBlock > MAX_QUANTITY_SHOW_BTN_TOGGLE_BLOCK);\n\t\t},\n\t\tbtnClassName(): string\n\t\t{\n\t\t\treturn this.showBtnShowToggleBlock ? '' : '--hide';\n\t\t},\n\t},\n\tmounted() {\n\t\tif (localStorage.counterImpressionsBtnShowToggleBlock)\n\t\t{\n\t\t\tthis.counterImpressionsBtnShowToggleBlock = localStorage.counterImpressionsBtnShowToggleBlock;\n\t\t}\n\t},\n\tmethods: {\n\t\tshowBtnToggleBlockHandler()\n\t\t{\n\t\t\tif (this.isShowHintBtn && !this.showBtnShowToggleBlock)\n\t\t\t{\n\t\t\t\tthis.showBtnShowToggleBlock = true;\n\t\t\t}\n\t\t},\n\t\thideBtnToggleBlockHandler()\n\t\t{\n\t\t\tthis.showBtnShowToggleBlock = false;\n\t\t},\n\t\thideHintBtn()\n\t\t{\n\t\t\tlocalStorage.counterImpressionsBtnShowToggleBlock = ++this.counterImpressionsBtnShowToggleBlock;\n\t\t\tthis.showBtnShowToggleBlock = false;\n\t\t},\n\t\ttoggleList()\n\t\t{\n\t\t\tthis.showBtnShowToggleBlock = false;\n\n\t\t\tif (this.$store.getters.spacesListState === SpacesListStates.collapsed)\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.changeSpaceListState, SpacesListStates.default);\n\t\t\t\tthis.saveState(SpacesListStates.default);\n\t\t\t\tDom.removeClass(this.dataSpacesContent, '--list-collapsed-mode');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.changeSpaceListState, SpacesListStates.collapsed);\n\t\t\t\tthis.saveState(SpacesListStates.collapsed);\n\t\t\t\tDom.addClass(this.dataSpacesContent, '--list-collapsed-mode');\n\t\t\t}\n\t\t},\n\t\tsaveState(state: string)\n\t\t{\n\t\t\tajax.runAction('socialnetwork.api.space.saveListSate', {\n\t\t\t\tdata: { spacesListState: state },\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__toggle-block\">\n\t\t\t<div class=\"sn-spaces__toggle-image\"></div>\n\t\t\t<div \n\t\t\t\tclass=\"sn-spaces__toggle-wrapper\"\n\t\t\t\t@click=\"toggleList\"\n\t\t\t>\n\t\t\t\t<div \n\t\t\t\t\tref=\"toggle-btn\"\n\t\t\t\t\tclass=\"sn-spaces__toggle-btn\" \n\t\t\t\t\tid=\"sn-spaces__toggle-btn\"\n\t\t\t\t\tdata-id=\"sn-spaces__toggle-btn\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --chevron-left\" style=\"--ui-icon-set__icon-size: 15px;\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"sn-spaces__btn-show-toggle-block\"\n\t\t\t\t:class=\"btnClassName\"\n\t\t\t\tdata-id=\"sn-spaces__btn-hint_show-toggle-block\"\n\t\t\t\tv-if=\"isShowHintBtn\"\n\t\t\t\t@click=\"hideHintBtn\"\n\t\t\t\t@mouseleave=\"hideBtnToggleBlockHandler\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --chevron-left\" style=\"--ui-icon-set__icon-size: 15px;\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { SpacesListStates } from '../const/spaces-list-state';\nimport { EventTypes } from '../const/event';\nimport { Modes } from '../const/mode';\nimport { RecentHeader } from './header/recent-header';\nimport { SearchHeader } from './header/search-header';\nimport { SpaceList } from './space-list/space-list';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { RecentService } from '../api/load/recent-service';\nimport { RecentSearchService } from '../api/load/recent-search-service';\nimport { SearchService } from '../api/load/search-service';\nimport { CollapsedModeToggleBlock } from './collapsed-mode-toggle-block/collapsed-mode-toggle-block';\nimport { Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\n// @vue/component\nexport const BaseComponent = {\n\tcomponents: {\n\t\tRecentHeader,\n\t\tSpaceList,\n\t\tSearchHeader,\n\t\tCollapsedModeToggleBlock,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmode: 'recent',\n\t\t\tmodes: Modes,\n\t\t\tlistNode: document.getElementById('sn-spaces-list'),\n\t\t\tisSpaceAddFormShownInRecentList: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\trecentSpaces: 'recentSpaces',\n\t\t\trecentSpacesCountForLoad: 'recentSpacesCountForLoad',\n\t\t\trecentSearchSpaces: 'recentSearchSpaces',\n\t\t\trecentSearchSpacesCountForLoad: 'recentSearchSpacesCountForLoad',\n\t\t\tsearchSpaces: 'searchSpaces',\n\t\t\tsearchSpacesCountForLoad: 'searchSpacesCountForLoad',\n\t\t\tspacesLoadedByCurrentSearchQueryCount: 'spacesLoadedByCurrentSearchQueryCount',\n\t\t\tcanCreateGroup: 'canCreateGroup',\n\t\t\tspaceInvitations: 'spaceInvitations',\n\t\t}),\n\t\tdoExpandCollapsedList(): boolean\n\t\t{\n\t\t\tconst isCollapsedState = this.$store.getters.spacesListState === SpacesListStates.collapsed;\n\t\t\tconst isSearchMode = [this.modes.search, this.modes.recentSearch].includes(this.mode);\n\n\t\t\treturn isCollapsedState && (isSearchMode || this.isSpaceAddFormShownInRecentList);\n\t\t},\n\t\tdoCollapseExpandedList(): boolean\n\t\t{\n\t\t\tconst isExpandedState = this.$store.getters.spacesListState === SpacesListStates.expanded;\n\t\t\tconst isRecentMode = this.modes.recent === this.mode;\n\n\t\t\treturn isExpandedState && isRecentMode && !this.isSpaceAddFormShownInRecentList;\n\t\t},\n\t},\n\twatch: {\n\t\tdoExpandCollapsedList()\n\t\t{\n\t\t\tif (this.doExpandCollapsedList)\n\t\t\t{\n\t\t\t\tthis.changeSpaceListState(SpacesListStates.expanded);\n\t\t\t}\n\t\t},\n\t\tdoCollapseExpandedList()\n\t\t{\n\t\t\tif (this.doCollapseExpandedList)\n\t\t\t{\n\t\t\t\tthis.changeSpaceListState(SpacesListStates.collapsed);\n\t\t\t}\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.changeSpaceListState, this.changeSpaceListStateHandler);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventTypes.changeMode, this.changeModeHandler);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.changeSpaceListState, this.changeSpaceListStateHandler);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventTypes.changeMode, this.changeModeHandler);\n\t},\n\tmethods: {\n\t\tloc(message: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(message);\n\t\t},\n\t\tchangeModeHandler(event: BaseEvent)\n\t\t{\n\t\t\tconst newMode = event.data;\n\t\t\tthis.setMode(newMode);\n\t\t},\n\t\tsetMode(mode)\n\t\t{\n\t\t\tthis.mode = mode;\n\t\t},\n\t\tgetRecentService(): RecentService\n\t\t{\n\t\t\treturn RecentService.getInstance();\n\t\t},\n\t\tgetRecentSearchService(): RecentSearchService\n\t\t{\n\t\t\treturn RecentSearchService.getInstance();\n\t\t},\n\t\tgetSearchService(): SearchService\n\t\t{\n\t\t\treturn SearchService.getInstance();\n\t\t},\n\t\tchangeSpaceListStateHandler(event)\n\t\t{\n\t\t\tconst state = event.data;\n\n\t\t\tthis.changeSpaceListState(state);\n\t\t},\n\t\tchangeSpaceListState(state)\n\t\t{\n\t\t\tif (state === SpacesListStates.expanded && !Dom.hasClass(this.listNode, '--fixed'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.listNode, '--fixed');\n\t\t\t}\n\t\t\telse if (Dom.hasClass(this.listNode, '--fixed'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.listNode, '--fixed');\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('setSpacesListState', state);\n\t\t},\n\t\tisSpaceAddFormShownHandler(isSpaceAddFormShown: boolean)\n\t\t{\n\t\t\tthis.isSpaceAddFormShownInRecentList = isSpaceAddFormShown;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sn-spaces__list-wrapper\">\n\t\t\t<RecentHeader\n\t\t\t\tv-if=\"mode === modes.recent\"\n\t\t\t\t:canCreateGroup=\"canCreateGroup\"\n\t\t\t\t@changeMode=\"setMode\"\n\t\t\t/>\n\t\t\t<SearchHeader\n\t\t\t\tv-if=\"mode === modes.search || mode === modes.recentSearch\"\n\t\t\t\t@changeMode=\"setMode\"\n\t\t\t/>\n\t\t\t<SpaceList\n\t\t\t\tv-show=\"mode === modes.recent\"\n\t\t\t\t@isSpaceAddFormShown=\"isSpaceAddFormShownHandler\"\n\t\t\t\t:isShown=\"mode === modes.recent\"\n\t\t\t\t:mode=\"modes.recent\"\n\t\t\t\t:spaces=\"recentSpaces\"\n\t\t\t\t:spaceInvitations=\"spaceInvitations\"\n\t\t\t\t:canCreateGroup=\"canCreateGroup\"\n\t\t\t\t:spacesCountForLoad=\"recentSpacesCountForLoad\"\n\t\t\t\t:serviceInstance=\"getRecentService()\"\n\t\t\t/>\n\t\t\t<SpaceList\n\t\t\t\tv-show=\"mode === modes.recentSearch\"\n\t\t\t\t:isShown=\"mode === modes.recentSearch\"\n\t\t\t\t:mode=\"modes.recentSearch\"\n\t\t\t\t:spaces=\"recentSearchSpaces\"\n\t\t\t\t:canCreateGroup=\"canCreateGroup\"\n\t\t\t\t:spacesCountForLoad=\"recentSearchSpacesCountForLoad\"\n\t\t\t\t:serviceInstance=\"getRecentSearchService()\"\n\t\t\t\t:subtitle=\"loc('SOCIALNETWORK_SPACES_LIST_RECENT_SEARCH_LIST_TITLE')\"\n\t\t\t/>\n\t\t\t<SpaceList\n\t\t\t\tv-show=\"mode === modes.search\"\n\t\t\t\t:isShown=\"mode === modes.search\"\n\t\t\t\t:mode=\"modes.search\"\n\t\t\t\t:spaces=\"searchSpaces\"\n\t\t\t\t:canCreateGroup=\"canCreateGroup\"\n\t\t\t\t:spacesCountForLoad=\"searchSpacesCountForLoad\"\n\t\t\t\t:serviceInstance=\"getSearchService()\"\n\t\t\t\t:subtitle=\"loc('SOCIALNETWORK_SPACES_LIST_SEARCH_LIST_TITLE')\"\n\t\t\t/>\n\t\t</div>\n\t\t<CollapsedModeToggleBlock />\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { EventTypes } from '../const/event';\n\nexport class PullRequests extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.List.PullRequests');\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'socialnetwork';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\tworkgroup_pin_changed: this.#pinChanged.bind(this),\n\t\t\tuser_spaces_counter: this.#updateCounters.bind(this),\n\t\t\tworkgroup_update: this.#onChangeSpace.bind(this),\n\t\t\tspace_user_role_change: this.#onChangeUserRole.bind(this),\n\t\t\tworkgroup_subscribe_changed: this.#onChangeSubscription.bind(this),\n\t\t\trecent_activity_update: this.#onRecentActivityUpdate.bind(this),\n\t\t\trecent_activity_delete: this.#onRecentActivityDelete.bind(this),\n\t\t};\n\t}\n\n\t#pinChanged(data): void\n\t{\n\t\tthis.emit(EventTypes.pinChanged, {\n\t\t\tspaceId: data.GROUP_ID,\n\t\t\tisPinned: data.ACTION === 'pin',\n\t\t});\n\t}\n\n\t#updateCounters(data): void\n\t{\n\t\tthis.emit(EventTypes.updateCounters, data);\n\t}\n\n\t#onChangeSpace(data): void\n\t{\n\t\tconst params = data.params;\n\t\tthis.emit(EventTypes.changeSpace, {\n\t\t\tspaceId: params.GROUP_ID,\n\t\t});\n\t}\n\n\t#onChangeUserRole(data): void\n\t{\n\t\tthis.emit(EventTypes.changeUserRole, {\n\t\t\tspaceId: data.GROUP_ID,\n\t\t\tuserId: data.USER_ID,\n\t\t});\n\t}\n\n\t#onChangeSubscription(data): void\n\t{\n\t\tthis.emit(EventTypes.changeSubscription, {\n\t\t\tspaceId: data.GROUP_ID,\n\t\t\tuserId: data.USER_ID,\n\t\t});\n\t}\n\n\t#onRecentActivityUpdate(data): void\n\t{\n\t\tthis.emit(EventTypes.recentActivityUpdate, {\n\t\t\trecentActivityData: data.recentActivityData,\n\t\t});\n\t}\n\n\t#onRecentActivityDelete(data): void\n\t{\n\t\tthis.emit(EventTypes.recentActivityDelete, {\n\t\t\ttypeId: data.typeId,\n\t\t\tentityId: data.entityId,\n\t\t});\n\t}\n}\n","import { LeftMenuAhaMoment } from './left-menu-aha-moment';\nimport { Store } from './store/store';\nimport { LinkManager } from './util/link-manager';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { BaseComponent } from './components/base-component';\nimport { RecentService } from './api/load/recent-service';\nimport { PullRequests } from './pull/pull-requests';\nimport { EventTypes } from './const/event';\nimport { Modes } from './const/mode';\nimport { RecentSearchService } from './api/load/recent-search-service';\nimport { BaseEvent } from 'main.core.events';\nimport { PULL as Pull } from 'pull.client';\n\nimport type { SpaceModel } from './model/space-model';\nimport type { InvitationModel } from './model/invitation-model';\nimport { Client } from './api/client';\n\ntype ListOptions = {\n\trecentSpaceIds: number[],\n\tspaces: SpaceModel[],\n\tinvitationSpaceIds: number[],\n\tinvitations: InvitationModel[],\n\tavatarColors: string[],\n\tselectedSpaceId: number,\n\tpathToUserSpace: string,\n\tpathToGroupSpace: string,\n\tfilterMode: string,\n\tspacesListMode: string,\n\tcanCreateGroup: boolean,\n\tcurrentUserId: number,\n\tdoShowCollapseMenuAhaMoment: boolean,\n};\n\nexport class List\n{\n\t#initialOptions:ListOptions;\n\t#target: HTMLElement;\n\t#application: VueCreateAppResult;\n\n\tconstructor(options: ListOptions)\n\t{\n\t\tthis.#initialOptions = options;\n\n\t\tif (options.doShowCollapseMenuAhaMoment)\n\t\t{\n\t\t\tnew LeftMenuAhaMoment().showAhaMoment();\n\t\t}\n\t}\n\n\tcreate(target: HTMLElement)\n\t{\n\t\tthis.#target = target;\n\t\tthis.#initLinkManager();\n\t\tthis.#initServices();\n\t\tthis.#createApplication();\n\t}\n\n\t#initLinkManager()\n\t{\n\t\tLinkManager.groupPath = this.#initialOptions.pathToGroupSpace;\n\t\tLinkManager.commonSpacePath = this.#initialOptions.pathToUserSpace;\n\t}\n\n\t#initServices()\n\t{\n\t\tRecentService.getInstance().setSelectedSpaceId(parseInt(this.#initialOptions.selectedSpaceId, 10));\n\t}\n\n\t#createApplication()\n\t{\n\t\tconst recentSpaceIds = this.#initialOptions.recentSpaceIds;\n\t\tconst invitationSpaceIds = this.#initialOptions.invitationSpaceIds;\n\t\tconst invitations = this.#initialOptions.invitations;\n\t\tconst spaces = this.#initialOptions.spaces;\n\t\tconst avatarColors = this.#initialOptions.avatarColors;\n\t\tconst selectedFilterModeType = this.#initialOptions.filterMode;\n\t\tconst spacesListState = this.#initialOptions.spacesListMode;\n\t\tconst canCreateGroup = this.#initialOptions.canCreateGroup;\n\t\tconst currentUserId = this.#initialOptions.currentUserId;\n\n\t\tthis.#application = BitrixVue.createApp(\n\t\t\t{\n\t\t\t\tname: 'SpacesList',\n\t\t\t\tprops: {\n\t\t\t\t\tinitialSpaces: Array,\n\t\t\t\t\tselectedFilterModeType: String,\n\t\t\t\t\tspacesListState: String,\n\t\t\t\t\tcanCreateGroup: Boolean,\n\t\t\t\t\trecentSpaceIds: Array,\n\t\t\t\t\tinvitations: Array,\n\t\t\t\t\tinvitationSpaceIds: Array,\n\t\t\t\t},\n\t\t\t\tcomponents: {\n\t\t\t\t\tBaseComponent,\n\t\t\t\t},\n\t\t\t\tmethods: {\n\t\t\t\t\tcastArrayValuesToInt(array: Array): Array\n\t\t\t\t\t{\n\t\t\t\t\t\treturn array.map((value) => parseInt(value, 10));\n\t\t\t\t\t},\n\t\t\t\t\tsubscribeToPull(): void\n\t\t\t\t\t{\n\t\t\t\t\t\tconst pullRequests = new PullRequests();\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.pinChanged, this.pinChangedHandler);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.updateCounters, this.updateCountersHandler);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.changeSpace, this.updateSpaceData);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.changeUserRole, this.updateSpaceUserData);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.changeSubscription, this.updateSpaceUserData);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.recentActivityUpdate, this.recentActivityUpdate);\n\t\t\t\t\t\tpullRequests.subscribe(EventTypes.recentActivityDelete, this.recentActivityDelete);\n\t\t\t\t\t\tPull.subscribe(pullRequests);\n\t\t\t\t\t},\n\t\t\t\t\tpinChangedHandler(event): void\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.pinSpace(event.getData().spaceId, event.getData().isPinned);\n\t\t\t\t\t},\n\t\t\t\t\tpinSpace(spaceId, isPinned): void\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$store.dispatch('pinSpace', { spaceId, isPinned });\n\t\t\t\t\t},\n\t\t\t\t\tupdateCountersHandler(event: BaseEvent): void\n\t\t\t\t\t{\n\t\t\t\t\t\tif (event.data.userId && parseInt(event.data.userId, 10) === currentUserId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$store.dispatch('updateCounters', event.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tasync recentActivityUpdate(event: BaseEvent): void\n\t\t\t\t\t{\n\t\t\t\t\t\tconst recentActivityData = event.data.recentActivityData;\n\t\t\t\t\t\tconst space: SpaceModel | undefined = this.$store.state.main.spaces.get(recentActivityData.spaceId);\n\n\t\t\t\t\t\tif (space)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$store.dispatch('updateSpaceRecentActivityData', recentActivityData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tawait this.loadSpace(recentActivityData.spaceId);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tasync recentActivityDelete(event: BaseEvent): void\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deletedActivityTypeId = event.data.typeId;\n\t\t\t\t\t\tconst deletedActivityEntityId = event.data.entityId;\n\n\t\t\t\t\t\tconst spaceModels: Array<SpaceModel> = [...this.$store.getters.recentSpaces.values()];\n\t\t\t\t\t\tspaceModels.forEach((space: SpaceModel) => {\n\t\t\t\t\t\t\tconst wasSpaceRecentActivityDeleted = space.recentActivity.typeId === deletedActivityTypeId\n\t\t\t\t\t\t\t\t&& space.recentActivity.entityId === deletedActivityEntityId\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\tif (wasSpaceRecentActivityDeleted)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.loadSpace(space.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tasync loadSpace(spaceId: number): void\n\t\t\t\t\t{\n\t\t\t\t\t\tconst requestData = await Client.loadSpaceData(spaceId);\n\t\t\t\t\t\tthis.$store.dispatch('updateSpaceData', requestData);\n\t\t\t\t\t},\n\t\t\t\t\tasync updateSpaceData(event: BaseEvent): void\n\t\t\t\t\t{\n\t\t\t\t\t\tif (event.data.spaceId >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tawait this.loadSpace(event.data.spaceId);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tasync updateSpaceUserData(event: BaseEvent): void\n\t\t\t\t\t{\n\t\t\t\t\t\tif (event.data.userId && parseInt(event.data.userId, 10) === currentUserId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst requestData = await Client.loadSpaceData(event.data.spaceId);\n\t\t\t\t\t\t\tif (requestData.space)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.$bitrix.eventEmitter.emit(`onSpaceUpdate_${requestData.space.id}`, requestData.space);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.$store.dispatch('updateSpaceData', requestData);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbeforeCreate(): void\n\t\t\t\t{\n\t\t\t\t\tthis.$bitrix.Application.set(this);\n\t\t\t\t},\n\t\t\t\tcreated()\n\t\t\t\t{\n\t\t\t\t\tthis.$store.dispatch('setSpaces', this.initialSpaces);\n\t\t\t\t\tthis.$store.dispatch('setRecentSpaceIds', this.castArrayValuesToInt(this.recentSpaceIds));\n\t\t\t\t\tthis.$store.dispatch('setInvitationSpaceIds', this.castArrayValuesToInt(this.invitationSpaceIds));\n\t\t\t\t\tthis.$store.dispatch('setInvitations', this.invitations);\n\t\t\t\t\tthis.$store.dispatch('setAvatarColors', avatarColors);\n\n\t\t\t\t\tthis.$store.dispatch('setSelectedFilterModeType', this.selectedFilterModeType);\n\t\t\t\t\tthis.$store.dispatch('setSpacesListState', this.spacesListState);\n\n\t\t\t\t\tthis.$store.dispatch('setCanCreateGroup', this.canCreateGroup);\n\t\t\t\t\tthis.subscribeToPull();\n\t\t\t\t},\n\t\t\t\tmounted()\n\t\t\t\t{\n\t\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.showLoader, Modes.recentSearch);\n\t\t\t\t\tRecentSearchService.getInstance().loadSpaces().then((result) => {\n\t\t\t\t\t\tthis.$store.dispatch('addSpacesToView', { mode: Modes.recentSearch, spaces: result });\n\t\t\t\t\t\tthis.$bitrix.eventEmitter.emit(EventTypes.hideLoader, Modes.recentSearch);\n\t\t\t\t\t}).catch(() => {});\n\t\t\t\t},\n\t\t\t\ttemplate: `\n\t\t\t\t\t<BaseComponent/>\n\t\t\t\t`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tinitialSpaces: spaces,\n\t\t\t\tselectedFilterModeType,\n\t\t\t\tspacesListState,\n\t\t\t\tcanCreateGroup,\n\t\t\t\trecentSpaceIds,\n\t\t\t\tinvitationSpaceIds,\n\t\t\t\tinvitations,\n\t\t\t},\n\t\t);\n\t\tthis.#application.use(Store);\n\t\tthis.#application.mount(this.#target);\n\t}\n}\n"],"names":["LeftMenuAhaMoment","showAhaMoment","menuSwitcherNode","document","querySelector","Type","isDomNode","ajax","runAction","targetElement","Runtime","loadExtension","then","spotlight","BX","SpotLight","targetVertex","Dom","addClass","bindEvents","onTargetEnter","removeClass","close","setColor","show","node","Guide","guide","simpleMode","onEvents","steps","target","title","Loc","getMessage","text","position","condition","top","bottom","color","showNextStep","guidePopup","getPopup","setWidth","getContentContainer","style","paddingRight","getComputedStyle","closeIcon","setAngle","offset","offsetWidth","subscribe","setAutoHide","getPopupContainer","marginLeft","angle","element","left","AddFormStore","state","avatarColors","avatarColor","actions","setAvatarColors","store","colors","commit","setAvatarColor","mutations","getters","previousAvatarColor","Client","loadSpaces","data","componentName","actionName","response","runComponentAction","mode","reloadSpaces","searchSpaces","loadRecentSearchSpaces","addSpaceToRecentSearch","spaceId","loadSpaceData","loadSpaceTheme","RecentService","hasMoreSpacesToLoad","getInstance","instance","setSelectedSpaceId","selectedSpaceId","getSelectedSpaceId","fields","loadedSpacesCount","filterMode","searchString","result","canLoadSpaces","Modes","Object","freeze","recent","recentSearch","search","FilterModeTypes","my","other","all","FilterModes","type","nameMessageId","descriptionMessageId","SpaceViewModeTypes","open","closed","secret","SpaceViewModes","SpaceUserRoles","nonMember","applicant","invited","member","Helper","buildSpaces","spaces","map","spaceData","id","parseInt","name","isPinned","isSelected","recentActivity","buildRecentActivity","recentActivityData","avatar","visibilityType","counter","lastSearchDate","Date","convertTimestampFromPhp","lastSearchDateTimestamp","userRole","follow","theme","permissions","timestamp","buildInvitations","invitations","invitationData","message","invitationDateTimestamp","invitationDate","description","typeId","entityId","date","getStringCapitalized","string","toUpperCase","slice","getModelNameByListViewMode","doAddSpaceToRecentList","space","lastRecentSpace","doDateActivityFits","doUserRoleFitsFilterMode","doSpaceUserRoleFitsFilterMode","includes","MainStore","Map","recentListSpaceIds","Set","searchResultFromServerSpaceIds","searchResultFromLoadedSpaceIds","invitationSpaceIds","recentSearchListSpaceIds","selectedFilterModeType","spacesListState","canCreateGroup","setSpaces","setInvitations","setCanCreateGroup","setRecentSpaceIds","spaceIds","setInvitationSpaceIds","spacesIds","setRecentSearchSpaceIds","addSpaces","setSelectedFilterModeType","setSelectedSpace","previousSelectedSpaceId","selected","setSpacesListState","setLocalSearchResult","clearSpacesViewByMode","storeHelper","modelName","modelNameCapitalized","addSpacesToView","changedModel","changedModelCapitalized","addedSpaceIds","newSpaceIds","pinSpace","changeUserRole","deleteInvitationFromStore","deleteSpaceFromStore","updateCounters","userId","total","ready","getClass","forEach","leftMenuCounters","sonet_total","metrics","countersLiveFeedTotal","Intranet","LeftMenu","tasksTotal","calendarTotal","workGroupTotal","lifeFeedTotal","countersTasksTotal","countersCalendarTotal","countersWorkGroupRequestTotal","updateSpaceData","isInvitation","invitation","helper","pop","recentSpaces","length","updateSpaceRecentActivityData","get","clear","set","setRecentListSpaceIds","addRecentListSpaceId","add","removeRecentListSpaceId","delete","addInvitations","setSearchResultFromServerSpaceIds","setSearchResultFromLoadedSpaceIds","setRecentSearchListSpaceIds","selectedState","deleteSpaceById","deleteInvitationBySpaceId","updateCounter","values","spaceInvitations","spacesMap","spaceInvitationFields","getTime","sort","a","b","recentSpacesUnordered","unsortedRecentSpaces","filter","has","myRecentSpaces","otherRecentSpaces","allRecentSpaces","pinnedSpacesFromRecent","commonSpaceFromRecent","notPinnedSpacesWithoutCommonFromRecent","spacesWithoutCommonFromRecent","find","searchResultIds","spacesLoadedByCurrentSearchQueryCount","size","recentSearchSpaces","unsortedRecentSearchSpaces","recentSpacesCountForLoad","recentSearchSpacesCountForLoad","searchSpacesCountForLoad","Store","createStore","modules","addForm","main","LinkManager","getSpaceLink","path","commonSpacePath","groupPath","replace","SpacesListStates","default","collapsed","expanded","EventTypes","showLoader","hideLoader","tryToLoadSpacesIfHasNoScrollbar","spaceListScroll","spaceListShown","showUpperSpaceAddForm","showBtnToggleBlock","hideSpaceAddForm","changeSpace","changeSubscription","pinChanged","changeSpaceListState","recentActivityUpdate","recentActivityDelete","openSpaceFromContextMenu","changeMode","POPUP_CONTAINER_PREFIX","BasePopup","props","String","required","config","emits","computed","popupContainer","created","getPopupInstance","mounted","adjustPosition","forceBindPosition","getPopupConfig","bindOptions","beforeUnmount","closePopup","methods","PopupManager","getPopupById","destroy","Popup","getDefaultConfig","className","autoHide","animation","cacheable","events","onPopupClose","bind","defaultConfig","modifiedOptions","defaultClassName","offsetTop","isNumber","$emit","enableAutoHide","disableAutoHide","template","PopupMenuOption","option","Boolean","active","iconClass","dataId","PopupMenuButton","doShowIcon","isStringFilled","class","PopupMenuContent","components","options","Array","selectedOption","hint","button","doShowHint","doShowButton","onChangeSelectedOption","newSelectedOption","onPopupMenuButtonClick","POPUP_ID","PopupMenu","bindElement","context","width","closeByEsc","overlay","padding","RecentHeader","showModePopup","isSpaceListScrolled","filterModes","scrollClass","$store","selectedType","selectedMode","loc","selectFilterModeButtonIconModifier","popupMenuOptions","popupMenuButton","$bitrix","eventEmitter","handleListChanges","unsubscribe","phraseCode","$Bitrix","openPopup","event","enableSearch","onChangeSelectedFilterMode","recentService","emit","dispatch","onCreateSpaceButtonClick","showBtnArrow","MINIMUM_QUERY_LENGTH_FOR_LOAD","SearchService","SearchHeader","searchQuery","startSearchDebounced","debounce","startSearch","mapGetters","closeSearch","onInputChange","searchResult","toLowerCase","setTimeout","$refs","input","focus","ContextItem","EventEmitter","constructor","setEventNamespace","emitter","CopyLink","create","onclick","menuItem","clipboard","copy","location","origin","getMenuWindow","UI","Notification","Center","notify","content","Logout","messageBox","MessageBox","buttons","MessageBoxButtons","OK_CANCEL","okCaption","onOk","Controller","leaveGroup","catch","getOkButton","setDisabled","Pin","resultMessage","resultMode","setText","switcher","ID","Follow","isFollowed","Open","setPath","ContextMenu","Cache","MemoryCache","createMenu","getMenuId","menu","MenuManager","items","getItems","toggle","collection","getSpaceId","isShown","getPopupWindow","push","pin","copyLink","canLeave","logout","ContextMenuCollection","item","getMenuById","DateFormatter","formatDate","format","DateTimeFormat","getFormat","toLocaleDateString","currentWeekNumber","weekNumber","getFullYear","Avatar","isSecret","secretSpaceImage","avatarModel","avatarClass","iconStyle","SpaceContent","showAvatar","modes","spaceUserRoles","doShowSuccessButton","spaceModel","doShowCounter","isApplicantButtonsShown","doShowPin","doShowJoinButton","doShowPendingButton","isFollowing","spaceDescription","doShowSpaceVisibilityType","getVisibilityTypeName","isCommon","onSpaceUpdate","spaceViewModeNameMessageId","spaceViewMode","isSecretSpace","formatCounter","toString","counterClass","showSuccessButton","wasUserApplicant","isUserMember","onJoinButtonClick","stopPropagation","params","groupId","confirmationNeeded","error","console","log","onPendingButtonClick","onAcceptedButtonClick","acceptInvitationButtonClickHandler","isSuccess","declineInvitationButtonClickHandler","PopupShortSpace","link","height","heightPopup","offsetLeft","classModifiers","join","closePopupShortSpace","onSpaceClick","Space","popupShortSpaceOptions","widthItem","isRecentMode","getBoundingClientRect","getPinMessage","getFollowMessage","getOpenMessage","getCopyLinkMessage","getLogoutMessage","modeBeforeClick","Socialnetwork","Spaces","reloadPageContent","onSpaceContextMenuClick","preventDefault","currentTarget","listFilter","listMode","pinMessage","followMessage","openMessage","copyLinkMessage","logoutMessage","openCommonSpace","hoverElement","Event","contains","KeyboardCodes","enter","SpaceAddForm","spaceViewModes","spaceViewModeTypes","viewMode","image","isFocusedOnNameInput","showViewModePopup","wasCreateGroupRequestSent","doShowNameAlreadyExistsError","isDataValidated","confirmButtonClass","selectedViewModeOptionName","nameInputModifier","isNameInputReadOnly","spaceAddFormNameInput","handleAutoHide","handleKeyDown","chooseRandomAvatarColor","unmounted","unbind","openViewModePopup","newOption","chooseSpaceImage","avatarEditor","getAvatarEditor","AvatarEditor","enableCamera","popup","file","getCompatData","groupImage","src","URL","createObjectURL","groupImageContainer","onAddSpaceClickHandler","addSpace","isArrayFilled","Math","floor","random","trim","formData","FormData","append","errorResponse","errors","code","shouldHideForm","keyCode","notVisible","spaceAddForm","offsetHeight","clickOnSpace","closest","clickOnSelf","avatarPopupShown","viewModePopupShown","anyPopupShown","formDataChanged","isNameFilled","isViewModeChanged","isImageChosen","SpaceListAddButton","Loader","loader","getLoaderInstance","destroyLoader","BaseLoader","getLoaderConfig","root","PAGINATION_OFFSET","SpaceList","isScrollLoading","isLoading","doShowLowerSpaceAddForm","doShowUpperSpaceAddForm","skeletonItemsAmount","spacesCountForLoad","Number","serviceInstance","subtitle","tryToLoadSpacesIfHasNoScrollbarHandler","showLoaderHandler","hideLoaderHandler","showUpperSpaceAddFormHandler","hideSpaceAddFormHandler","service","hasScrollbar","list","scrollHeight","clientHeight","loadingClass","doShowSubtitle","doShowSpaceListAddButton","isSpaceAddFormShown","doShowInvitations","listState","watch","scrollToTop","scrollTop","isProperMode","showLowerSpaceAddForm","onScroll","listRemainingSpace","listScroll","isScrolledToBottom","RecentSearchService","MAX_QUANTITY_SHOW_BTN_TOGGLE_BLOCK","CollapsedModeToggleBlock","dataSpacesContent","getElementById","counterImpressionsBtnShowToggleBlock","showBtnShowToggleBlock","showBtnToggleBlockHandler","isShowHintBtn","btnClassName","localStorage","hideBtnToggleBlockHandler","hideHintBtn","toggleList","saveState","BaseComponent","listNode","isSpaceAddFormShownInRecentList","doExpandCollapsedList","isCollapsedState","isSearchMode","doCollapseExpandedList","isExpandedState","changeSpaceListStateHandler","changeModeHandler","newMode","setMode","getRecentService","getRecentSearchService","getSearchService","hasClass","isSpaceAddFormShownHandler","PullRequests","getModuleId","getMap","workgroup_pin_changed","user_spaces_counter","workgroup_update","space_user_role_change","workgroup_subscribe_changed","recent_activity_update","recent_activity_delete","GROUP_ID","ACTION","USER_ID","List","doShowCollapseMenuAhaMoment","pathToGroupSpace","pathToUserSpace","recentSpaceIds","spacesListMode","currentUserId","BitrixVue","createApp","initialSpaces","castArrayValuesToInt","array","value","subscribeToPull","pullRequests","pinChangedHandler","updateCountersHandler","updateSpaceUserData","Pull","getData","loadSpace","deletedActivityTypeId","deletedActivityEntityId","spaceModels","wasSpaceRecentActivityDeleted","requestData","beforeCreate","Application","use","mount"],"mappings":"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"}