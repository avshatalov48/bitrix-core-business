{"version":3,"file":"utils.bundle.js","sources":["../src/utils.js"],"sourcesContent":["import {DateFormat} from 'im.v2.const';\nimport {Loc} from 'main.core';\nimport 'main.date';\n\nconst Utils = {\n\tbrowser:\n\t{\n\t\tisSafari()\n\t\t{\n\t\t\tif (this.isChrome())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!navigator.userAgent.toLowerCase().includes('safari'))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn !this.isSafariBased();\n\t\t},\n\t\tisSafariBased()\n\t\t{\n\t\t\tif (!navigator.userAgent.toLowerCase().includes('applewebkit'))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tnavigator.userAgent.toLowerCase().includes('yabrowser')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('yaapp_ios_browser')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('crios')\n\t\t\t);\n\t\t},\n\t\tisChrome()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('chrome');\n\t\t},\n\t\tisFirefox()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('firefox');\n\t\t},\n\t\tisIe()\n\t\t{\n\t\t\treturn navigator.userAgent.match(/(Trident\\/|MSIE\\/)/) !== null;\n\t\t},\n\n\t\tfindParent(item, findTag)\n\t\t{\n\t\t\tconst isHtmlElement = findTag instanceof HTMLElement;\n\n\t\t\tif (\n\t\t\t\t!findTag\n\t\t\t\t|| (typeof findTag !== 'string' && !isHtmlElement)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfor (; item && item !== document; item = item.parentNode)\n\t\t\t{\n\t\t\t\tif (typeof findTag === 'string')\n\t\t\t\t{\n\t\t\t\t\tif (item.classList.contains(findTag))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (isHtmlElement && item === findTag)\n\t\t\t\t{\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\n\tplatform:\n\t{\n\t\tisMac()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('macintosh');\n\t\t},\n\t\tisLinux()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('linux');\n\t\t},\n\t\tisWindows()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('windows') || (!this.isMac() && !this.isLinux());\n\t\t},\n\t\tisBitrixMobile()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('bitrixmobile');\n\t\t},\n\t\tisBitrixDesktop()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('bitrixdesktop');\n\t\t},\n\t\tgetDesktopVersion()\n\t\t{\n\t\t\tif (typeof this.getDesktopVersionStatic !== 'undefined')\n\t\t\t{\n\t\t\t\treturn this.getDesktopVersionStatic;\n\t\t\t}\n\n\t\t\tif (typeof BXDesktopSystem === 'undefined')\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst version = BXDesktopSystem.GetProperty('versionParts');\n\t\t\tthis.getDesktopVersionStatic = version[3];\n\n\t\t\treturn this.getDesktopVersionStatic;\n\t\t},\n\t\tisMobile(): boolean\n\t\t{\n\t\t\treturn this.isAndroid() || this.isIos() || this.isBitrixMobile();\n\t\t},\n\t\tisIos(): boolean\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('iphone') || navigator.userAgent.toLowerCase().includes('ipad');\n\t\t},\n\t\tgetIosVersion()\n\t\t{\n\t\t\tif (!this.isIos())\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tlet matches = navigator.userAgent.toLowerCase().match(/(iphone|ipad)(.+)(OS\\s([0-9]+)([_.]([0-9]+))?)/i);\n\t\t\tif (!matches || !matches[4])\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn parseFloat(matches[4]+'.'+(matches[6]? matches[6]: 0));\n\t\t},\n\t\tisAndroid()\n\t\t{\n\t\t\treturn navigator.userAgent.toLowerCase().includes('android');\n\t\t},\n\t\topenNewPage(url)\n\t\t{\n\t\t\tif (!url)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.isBitrixMobile())\n\t\t\t{\n\t\t\t\tif (typeof BX.MobileTools !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tlet openWidget = BX.MobileTools.resolveOpenFunction(url);\n\t\t\t\t\tif (openWidget)\n\t\t\t\t\t{\n\t\t\t\t\t\topenWidget();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tapp.openNewPage(url);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.open(url, '_blank');\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t},\n\n\tdevice:\n\t{\n\t\tisDesktop()\n\t\t{\n\t\t\treturn !this.isMobile();\n\t\t},\n\n\t\tisMobile()\n\t\t{\n\t\t\tif (typeof this.isMobileStatic !== 'undefined')\n\t\t\t{\n\t\t\t\treturn this.isMobileStatic;\n\t\t\t}\n\n\t\t\tthis.isMobileStatic = (\n\t\t\t\tnavigator.userAgent.toLowerCase().includes('android')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('webos')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('iphone')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('ipad')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('ipod')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('blackberry')\n\t\t\t\t|| navigator.userAgent.toLowerCase().includes('windows phone')\n\t\t\t);\n\n\t\t\treturn this.isMobileStatic;\n\t\t},\n\n\t\torientationHorizontal: 'horizontal',\n\t\torientationPortrait: 'portrait',\n\n\t\tgetOrientation()\n\t\t{\n\t\t\tif (!this.isMobile())\n\t\t\t{\n\t\t\t\treturn this.orientationHorizontal;\n\t\t\t}\n\n\t\t\treturn Math.abs(window.orientation) === 0? this.orientationPortrait: this.orientationHorizontal;\n\t\t},\n\t},\n\n\ttext:\n\t{\n\t\tquote(text, params, files = {}, localize = null)\n\t\t{\n\t\t\tif (typeof text !== 'string')\n\t\t\t{\n\t\t\t\treturn text.toString();\n\t\t\t}\n\n\t\t\tif (!localize)\n\t\t\t{\n\t\t\t\tlocalize = BX.message;\n\t\t\t}\n\n\t\t\ttext = text.replace(/\\[USER=([0-9]{1,})](.*?)\\[\\/USER]/ig, (whole, userId, text) => text);\n\t\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]{1,})](.*?)[\\/CHAT]/ig, (whole, imol, chatId, text) => text);\n\t\t\ttext = text.replace(/\\[CALL(?:=(.+?))?](.+?)?\\[\\/CALL]/ig, (whole, command, text) => text? text: command);\n\t\t\ttext = text.replace(/\\[ATTACH=([0-9]{1,})]/ig, (whole, command, text) => command === 10000? '': '['+localize['IM_UTILS_TEXT_ATTACH']+'] ');\n\t\t\ttext = text.replace(/\\[RATING=([1-5]{1})]/ig, (whole, rating) => '['+localize.IM_F_RATING+'] ');\n\t\t\ttext = text.replace(/&nbsp;/ig, \" \");\n\n\t\t\ttext = text.replace(/------------------------------------------------------(.*?)------------------------------------------------------/gmis, \"[\"+localize[\"IM_UTILS_TEXT_QUOTE\"]+\"]\");\n\t\t\ttext = text.replace(/^(>>(.*)\\n)/gi, \"[\"+localize[\"IM_UTILS_TEXT_QUOTE\"]+\"]\\n\");\n\n\t\t\tif (params && params.FILE_ID && params.FILE_ID.length > 0)\n\t\t\t{\n\t\t\t\tlet filesText = [];\n\t\t\t\tparams.FILE_ID.forEach(fileId =>\n\t\t\t\t{\n\t\t\t\t\tif (files[fileId].type === 'image')\n\t\t\t\t\t{\n\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_IMAGE']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (files[fileId].type === 'audio')\n\t\t\t\t\t{\n\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_AUDIO']);\n\t\t\t\t\t}\n\t\t\t\t\telse if (files[fileId].type === 'video')\n\t\t\t\t\t{\n\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_VIDEO']);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfilesText.push(files[fileId].name);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filesText.length <= 0)\n\t\t\t\t{\n\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_FILE']);\n\t\t\t\t}\n\n\t\t\t\ttext = filesText.join('\\n')+text;\n\t\t\t}\n\t\t\telse if (params && params.ATTACH && params.ATTACH.length > 0)\n\t\t\t{\n\t\t\t\ttext = '['+localize['IM_UTILS_TEXT_ATTACH']+']\\n'+text;\n\t\t\t}\n\t\t\tif (text.length <= 0)\n\t\t\t{\n\t\t\t\ttext = localize['IM_UTILS_TEXT_DELETED'];\n\t\t\t}\n\n\t\t\treturn text.trim();\n\t\t},\n\n\t\tpurify(text, params, files = {}, localize = null)\n\t\t{\n\t\t\tif (typeof text !== 'string')\n\t\t\t{\n\t\t\t\treturn text.toString();\n\t\t\t}\n\n\t\t\tif (!localize)\n\t\t\t{\n\t\t\t\tlocalize = BX.message;\n\t\t\t}\n\n\t\t\ttext = text.trim();\n\n\t\t\tif (text.startsWith('/me'))\n\t\t\t{\n\t\t\t\ttext = text.substr(4);\n\t\t\t}\n\t\t\telse if (text.startsWith('/loud'))\n\t\t\t{\n\t\t\t\ttext = text.substr(6);\n\t\t\t}\n\n\t\t\ttext = text.replace(/<br><br \\/>/ig, '<br />');\n\t\t\ttext = text.replace(/<br \\/><br>/ig, '<br />');\n\n\t\t\tconst codeReplacement = [];\n\t\t\ttext = text.replace(/\\[CODE\\]\\n?([\\0-\\uFFFF]*?)\\[\\/CODE\\]/ig, function(whole,text)\n\t\t\t{\n\t\t\t\tconst id = codeReplacement.length;\n\t\t\t\tcodeReplacement.push(text);\n\t\t\t\treturn '####REPLACEMENT_CODE_'+id+'####';\n\t\t\t});\n\n\t\t\ttext = text.replace(/\\[PUT(?:=(?:.+?))?\\](?:.+?)?\\[\\/PUT]/ig, function(match)\n\t\t\t{\n\t\t\t\treturn match.replace(/\\[PUT(?:=(.+))?\\](.+?)?\\[\\/PUT]/ig, function(whole, command, text) {\n\t\t\t\t\treturn  text? text: command;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\ttext = text.replace(/\\[SEND(?:=(?:.+?))?\\](?:.+?)?\\[\\/SEND]/ig, function(match)\n\t\t\t{\n\t\t\t\treturn match.replace(/\\[SEND(?:=(.+))?\\](.+?)?\\[\\/SEND]/ig, function(whole, command, text) {\n\t\t\t\t\treturn  text? text: command;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\ttext = text.replace(/\\[[buis]](.*?)\\[\\/[buis]]/ig, '$1');\n\t\t\ttext = text.replace(/\\[url](.*?)\\[\\/url]/ig, '$1');\n\t\t\ttext = text.replace(/\\[RATING=([1-5]{1})]/ig, () => '['+localize['IM_UTILS_TEXT_RATING']+'] ');\n\t\t\ttext = text.replace(/\\[ATTACH=([0-9]{1,})]/ig, () => '['+localize['IM_UTILS_TEXT_ATTACH']+'] ');\n\t\t\ttext = text.replace(/\\[USER=([0-9]{1,})](.*?)\\[\\/USER]/ig, '$2');\n\t\t\ttext = text.replace(/\\[CHAT=([0-9]{1,})](.*?)\\[\\/CHAT]/ig, '$2');\n\t\t\ttext = text.replace(/\\[SEND(?:=(?:.+?))?\\](.+?)?\\[\\/SEND]/ig, '$1');\n\t\t\ttext = text.replace(/\\[PUT(?:=(?:.+?))?\\](.+?)?\\[\\/PUT]/ig, '$1');\n\t\t\ttext = text.replace(/\\[CALL=([0-9]{1,})](.*?)\\[\\/CALL]/ig, '$2');\n\t\t\ttext = text.replace(/\\[PCH=([0-9]{1,})](.*?)\\[\\/PCH]/ig, '$2');\n\t\t\ttext = text.replace(/<img.*?data-code=\"([^\"]*)\".*?>/ig, '$1');\n\t\t\ttext = text.replace(/<span.*?title=\"([^\"]*)\".*?>.*?<\\/span>/ig, '($1)');\n\t\t\ttext = text.replace(/<img.*?title=\"([^\"]*)\".*?>/ig, '($1)');\n\t\t\ttext = text.replace(/\\[ATTACH=([0-9]{1,})]/ig, (whole, command, text) => command === 10000? '': '['+localize['IM_UTILS_TEXT_ATTACH']+'] ');\n\t\t\ttext = text.replace(/<s>([^\"]*)<\\/s>/ig, ' ');\n\t\t\ttext = text.replace(/\\[s]([^\"]*)\\[\\/s]/ig, ' ');\n\t\t\ttext = text.replace(/\\[icon=([^\\]]*)]/ig, (whole) =>\n\t\t\t{\n\t\t\t\tlet title = whole.match(/title=(.*[^\\s\\]])/i);\n\t\t\t\tif (title && title[1])\n\t\t\t\t{\n\t\t\t\t\ttitle = title[1];\n\t\t\t\t\tif (title.indexOf('width=') > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = title.substr(0, title.indexOf('width='))\n\t\t\t\t\t}\n\t\t\t\t\tif (title.indexOf('height=') > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = title.substr(0, title.indexOf('height='))\n\t\t\t\t\t}\n\t\t\t\t\tif (title.indexOf('size=') > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = title.substr(0, title.indexOf('size='))\n\t\t\t\t\t}\n\t\t\t\t\tif (title)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = '('+title.trim()+')';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = '('+localize['IM_UTILS_TEXT_ICON']+')';\n\t\t\t\t}\n\t\t\t\treturn title;\n\t\t\t});\n\n\t\t\tcodeReplacement.forEach((element, index) => {\n\t\t\t\ttext = text.replace('####REPLACEMENT_CODE_'+index+'####', element);\n\t\t\t});\n\n\t\t\ttext = text.replace(/------------------------------------------------------(.*?)------------------------------------------------------/gmis, \"[\"+localize[\"IM_UTILS_TEXT_QUOTE\"]+\"] \");\n\t\t\ttext = text.replace(/^(>>(.*)(\\n)?)/gmi, \"[\"+localize[\"IM_UTILS_TEXT_QUOTE\"]+\"] \");\n\n\t\t\ttext = text.replace(/<\\/?[^>]+>/gi, '');\n\n\t\t\tif (params && params.FILE_ID && params.FILE_ID.length > 0)\n\t\t\t{\n\t\t\t\tlet filesText = [];\n\n\t\t\t\tif (typeof files === 'object')\n\t\t\t\t{\n\t\t\t\t\tparams.FILE_ID.forEach(fileId =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif (typeof files[fileId] === 'undefined')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (files[fileId].type === 'image')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_IMAGE']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (files[fileId].type === 'audio')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_AUDIO']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (files[fileId].type === 'video')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_VIDEO']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfilesText.push(files[fileId].name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (filesText.length <= 0)\n\t\t\t\t{\n\t\t\t\t\tfilesText.push(localize['IM_UTILS_TEXT_FILE']);\n\t\t\t\t}\n\n\t\t\t\ttext = filesText.join(' ')+text;\n\t\t\t}\n\t\t\telse if (params && (params.WITH_ATTACH || params.ATTACH && params.ATTACH.length > 0))\n\t\t\t{\n\t\t\t\ttext = '['+localize['IM_UTILS_TEXT_ATTACH']+'] '+text;\n\t\t\t}\n\t\t\telse if (params && params.WITH_FILE)\n\t\t\t{\n\t\t\t\ttext = '['+localize['IM_UTILS_TEXT_FILE']+'] '+text;\n\t\t\t}\n\t\t\tif (text.length <= 0)\n\t\t\t{\n\t\t\t\ttext = localize['IM_UTILS_TEXT_DELETED'];\n\t\t\t}\n\n\t\t\treturn text.replace('\\n', ' ').trim();\n\t\t},\n\n\t\thtmlspecialchars(text)\n\t\t{\n\t\t\tif (typeof text !== 'string')\n\t\t\t{\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\treturn text.replace(/&/g, '&amp;')\n\t\t\t\t.replace(/\"/g, '&quot;')\n\t\t\t\t.replace(/</g, '&lt;')\n\t\t\t\t.replace(/>/g, '&gt;');\n\t\t},\n\n\t\thtmlspecialcharsback(text)\n\t\t{\n\t\t\tif (typeof text !== 'string')\n\t\t\t{\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\treturn text.replace(/\\&quot;/g, '\"')\n\t\t\t\t.replace(/&#039;/g, \"'\")\n\t\t\t\t.replace(/\\&lt;/g, '<')\n\t\t\t\t.replace(/\\&gt;/g, '>')\n\t\t\t\t.replace(/\\&amp;/g, '&')\n\t\t\t\t.replace(/\\&nbsp;/g, ' ');\n\t\t},\n\n\t\tgetLocalizeForNumber(phrase, number, language = 'en', localize = null)\n\t\t{\n\t\t\tif (!localize)\n\t\t\t{\n\t\t\t\tlocalize = BX.message;\n\t\t\t}\n\n\t\t\tlet pluralFormType = 1;\n\n\t\t\tnumber = parseInt(number);\n\n\t\t\tif (number < 0)\n\t\t\t{\n\t\t\t\tnumber = number * -1;\n\t\t\t}\n\n\t\t\tif (language)\n\t\t\t{\n\t\t\t\tswitch (language)\n\t\t\t\t{\n\t\t\t\t\tcase 'de':\n\t\t\t\t\tcase 'en':\n\t\t\t\t\t\tpluralFormType = ((number !== 1) ? 1 : 0);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'ru':\n\t\t\t\t\tcase 'ua':\n\t\t\t\t\t\tpluralFormType = (((number%10 === 1) && (number%100 !== 11)) ? 0 : (((number%10 >= 2) && (number%10 <= 4) && ((number%100 < 10) || (number%100 >= 20))) ? 1 : 2));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn localize[phrase + '_PLURAL_' + pluralFormType];\n\t\t},\n\n\t\tgetFirstLetters(text): string\n\t\t{\n\t\t\tconst validSymbolsPattern = /[\\p{L}\\p{N} ]/u;\n\t\t\tconst words = text.split(/[\\s,]/).filter(word => {\n\t\t\t\tconst firstLetter = word.charAt(0);\n\t\t\t\treturn validSymbolsPattern.test(firstLetter);\n\t\t\t});\n\t\t\tif (words.length === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tif (words.length > 1)\n\t\t\t{\n\t\t\t\treturn words[0].charAt(0) + words[1].charAt(0);\n\t\t\t}\n\n\t\t\treturn words[0].charAt(0);\n\t\t},\n\n\t\tconvertSnakeToCamelCase(text: string): string\n\t\t{\n\t\t\treturn text.replace(/(_[a-z])/gi, ($1) => {\n\t\t\t\treturn $1.toUpperCase().replace('_', '');\n\t\t\t});\n\t\t}\n\t},\n\n\tdate:\n\t{\n\t\tgetFormatType(type = DateFormat.default, localize = null)\n\t\t{\n\t\t\tif (!localize)\n\t\t\t{\n\t\t\t\tlocalize = BX.message;\n\t\t\t}\n\n\t\t\tlet format = [];\n\t\t\tif (type === DateFormat.groupTitle)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_DATE\"]]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (type === DateFormat.message)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_TIME\"]]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (type === DateFormat.recentTitle)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"tommorow\", \"today\"],\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_DATE_RECENT\"]]\n\t\t\t\t]\n\t\t\t}\n\t\t\telse if (type === DateFormat.recentLinesTitle)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_DATE_RECENT\"]]\n\t\t\t\t]\n\t\t\t}\n\t\t\telse if (type === DateFormat.readedTitle)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"tommorow\", \"tommorow, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"today\", \"today, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"yesterday\", \"yesterday, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_READED\"]]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (type === DateFormat.vacationTitle)\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_DATE_SHORT\"]]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tformat = [\n\t\t\t\t\t[\"tommorow\", \"tommorow, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"today\", \"today, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"yesterday\", \"yesterday, \"+localize[\"IM_UTILS_FORMAT_TIME\"]],\n\t\t\t\t\t[\"\", localize[\"IM_UTILS_FORMAT_DATE_TIME\"]]\n\t\t\t\t];\n\t\t\t}\n\n\t\t\treturn format;\n\t\t},\n\n\t\tgetDateFunction(localize = null)\n\t\t{\n\t\t\tif (this.dateFormatFunction)\n\t\t\t{\n\t\t\t\treturn this.dateFormatFunction;\n\t\t\t}\n\n\t\t\tthis.dateFormatFunction = Object.create(BX.Main.Date);\n\t\t\tif (localize)\n\t\t\t{\n\t\t\t\tthis.dateFormatFunction._getMessage = (phrase) => localize[phrase];\n\t\t\t}\n\n\t\t\treturn this.dateFormatFunction;\n\t\t},\n\n\t\tformat(timestamp, format = null, localize = null)\n\t\t{\n\t\t\tif (!format)\n\t\t\t{\n\t\t\t\tformat = this.getFormatType(DateFormat.default, localize);\n\t\t\t}\n\n\t\t\treturn this.getDateFunction(localize).format(format, timestamp);\n\t\t},\n\n\t\tcast(date, def = new Date())\n\t\t{\n\t\t\tlet result = def;\n\n\t\t\tif (date instanceof Date)\n\t\t\t{\n\t\t\t\tresult = date;\n\t\t\t}\n\t\t\telse if (typeof date === 'string')\n\t\t\t{\n\t\t\t\tresult = new Date(date);\n\t\t\t}\n\t\t\telse if (typeof date === 'number')\n\t\t\t{\n\t\t\t\tresult = new Date(date*1000);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tresult instanceof Date\n\t\t\t\t&& Number.isNaN(result.getTime())\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult = def;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\n\t\tgetTimeToNextMidnight(): number\n\t\t{\n\t\t\tconst nextMidnight = new Date(new Date().setHours(24, 0, 0)).getTime();\n\t\t\treturn nextMidnight - Date.now();\n\t\t},\n\n\t\tgetStartOfTheDay(): Date\n\t\t{\n\t\t\treturn new Date((new Date()).setHours(0, 0));\n\t\t},\n\n\t\tisToday(date)\n\t\t{\n\t\t\treturn this.cast(date).toDateString() === (new Date()).toDateString();\n\t\t}\n\t},\n\n\tuser:\n\t{\n\t\tgetLastDateText(params = {}): string\n\t\t{\n\t\t\tif (params.bot || params.network || !params.lastActivityDate)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst isOnline = this.isOnline(params.lastActivityDate);\n\t\t\tconst isMobileOnline = this.isMobileOnline(params.lastActivityDate, params.mobileLastDate);\n\n\t\t\tlet text = '';\n\n\t\t\t// \"away for X minutes\"\n\t\t\tif (isOnline && params.idle && !isMobileOnline)\n\t\t\t{\n\t\t\t\ttext = Loc.getMessage('IM_STATUS_AWAY_TITLE').replace('#TIME#', this.getIdleText(params.idle));\n\t\t\t}\n\n\t\t\tconst lastSeenText = this.getLastSeenText(params.lastActivityDate);\n\t\t\t// truly online, last activity date < 5 minutes ago - show status text\n\t\t\tif (isOnline && !lastSeenText)\n\t\t\t{\n\t\t\t\ttext = this.getStatusText(params.status);\n\t\t\t}\n\n\t\t\t// last activity date > 5 minutes ago - \"Was online X minutes ago\"\n\t\t\tif (lastSeenText)\n\t\t\t{\n\t\t\t\tconst phraseCode = `IM_LAST_SEEN_${params.gender}`;\n\t\t\t\ttext = Loc.getMessage(phraseCode).replace('#POSITION#. ', '').replace('#LAST_SEEN#', lastSeenText);\n\t\t\t}\n\n\t\t\t// if on vacation - add postfix with vacation info\n\t\t\tif (params.absent)\n\t\t\t{\n\t\t\t\tconst dateFunction = Utils.date.getDateFunction();\n\t\t\t\tconst vacationFormat = Utils.date.getFormatType(DateFormat.vacationTitle);\n\t\t\t\tconst vacationText = Loc.getMessage('IM_STATUS_VACATION_TITLE').replace('#DATE#',\n\t\t\t\t\tdateFunction.format(vacationFormat, params.absent.getTime() / 1000)\n\t\t\t\t);\n\n\t\t\t\ttext = text ? `${text}. ${vacationText}`: vacationText;\n\t\t\t}\n\n\t\t\treturn text;\n\t\t},\n\n\t\tgetIdleText(idle = '')\n\t\t{\n\t\t\tif (!idle)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Utils.date.getDateFunction().format([\n\t\t\t\t['s60', 'sdiff'],\n\t\t\t\t['i60', 'idiff'],\n\t\t\t\t['H24', 'Hdiff'],\n\t\t\t\t['', 'ddiff']\n\t\t\t], idle);\n\t\t},\n\n\t\tisOnline(lastActivityDate): boolean\n\t\t{\n\t\t\tif (!lastActivityDate)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Date.now() - lastActivityDate.getTime() <= this.getOnlineLimit() * 1000;\n\t\t},\n\n\t\tisMobileOnline(lastActivityDate, mobileLastDate): boolean\n\t\t{\n\t\t\tif (!lastActivityDate || !mobileLastDate)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst FIVE_MINUTES = 5 * 60 * 1000;\n\t\t\treturn (\n\t\t\t\tDate.now() - mobileLastDate.getTime() < this.getOnlineLimit() * 1000\n\t\t\t\t&& lastActivityDate - mobileLastDate < FIVE_MINUTES\n\t\t\t);\n\t\t},\n\n\t\tgetStatusText(status: string): string\n\t\t{\n\t\t\tconst localize = BX.message || {};\n\t\t\tstatus = status.toUpperCase();\n\t\t\tconst phraseCode = `IM_STATUS_${status}`;\n\n\t\t\treturn localize[phraseCode] ?? status;\n\t\t},\n\n\t\tgetLastSeenText(lastActivityDate): string\n\t\t{\n\t\t\tif (!lastActivityDate)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst FIVE_MINUTES = 5 * 60 * 1000;\n\t\t\tif (Date.now() - lastActivityDate.getTime() > FIVE_MINUTES)\n\t\t\t{\n\t\t\t\treturn Utils.date.getDateFunction().formatLastActivityDate(lastActivityDate);\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\n\t\tisBirthdayToday(birthday): boolean\n\t\t{\n\t\t\treturn birthday === Utils.date.format(new Date(), 'd-m');\n\t\t},\n\n\t\tgetOnlineLimit()\n\t\t{\n\t\t\tconst localize = BX.message || {};\n\n\t\t\tconst FIFTEEN_MINUTES = 15 * 60;\n\t\t\treturn localize.LIMIT_ONLINE? Number.parseInt(localize.LIMIT_ONLINE, 10): FIFTEEN_MINUTES;\n\t\t},\n\t},\n\n\tgetLogTrackingParams(params = {}): string\n\t{\n\t\tlet result = [];\n\n\t\tlet {\n\t\t\tname = 'tracking',\n\t\t\tdata = [],\n\t\t\tdialog = null,\n\t\t\tmessage = null,\n\t\t\tfiles = null,\n\t\t} = params;\n\n\t\tname = encodeURIComponent(name);\n\n\t\tif (\n\t\t\tdata\n\t\t\t&& !(data instanceof Array)\n\t\t\t&& typeof data === 'object'\n\t\t)\n\t\t{\n\t\t\tlet dataArray = [];\n\t\t\tfor (let name in data)\n\t\t\t{\n\t\t\t\tif (data.hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tdataArray.push(encodeURIComponent(name)+\"=\"+encodeURIComponent(data[name]));\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata = dataArray;\n\t\t}\n\t\telse if (!data instanceof Array)\n\t\t{\n\t\t\tdata = [];\n\t\t}\n\n\t\tif (dialog)\n\t\t{\n\t\t\tresult.push('timType='+dialog.type);\n\n\t\t\tif (dialog.type === 'lines')\n\t\t\t{\n\t\t\t\tresult.push('timLinesType='+dialog.entityId.split('|')[0]);\n\t\t\t}\n\t\t}\n\n\t\tif (files)\n\t\t{\n\t\t\tlet type = 'file';\n\t\t\tif (files instanceof Array && files[0])\n\t\t\t{\n\t\t\t\ttype = files[0].type;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttype = files.type;\n\t\t\t}\n\t\t\tresult.push('timMessageType='+type);\n\t\t}\n\t\telse if (message)\n\t\t{\n\t\t\tresult.push('timMessageType=text');\n\t\t}\n\n\t\tif (this.platform.isBitrixMobile())\n\t\t{\n\t\t\tresult.push('timDevice=bitrixMobile');\n\t\t}\n\t\telse if (this.platform.isBitrixDesktop())\n\t\t{\n\t\t\tresult.push('timDevice=bitrixDesktop');\n\t\t}\n\t\telse if (this.platform.isIos() || this.platform.isAndroid())\n\t\t{\n\t\t\tresult.push('timDevice=mobile');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.push('timDevice=web');\n\t\t}\n\n\t\treturn name + (data.length? '&'+data.join('&'): '') + (result.length? '&'+result.join('&'): '');\n\t},\n\ttypes:\n\t{\n\t\tisUuidV4(uuid)\n\t\t{\n\t\t\tif (typeof uuid !== 'string')\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst uuidV4pattern = new RegExp(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i);\n\n\t\t\treturn uuid.search(uuidV4pattern) === 0;\n\t\t},\n\t},\n};\n\nexport {Utils};"],"names":["Utils","browser","isSafari","isChrome","navigator","userAgent","toLowerCase","includes","isSafariBased","isFirefox","isIe","match","findParent","item","findTag","isHtmlElement","HTMLElement","document","parentNode","classList","contains","platform","isMac","isLinux","isWindows","isBitrixMobile","isBitrixDesktop","getDesktopVersion","getDesktopVersionStatic","BXDesktopSystem","version","GetProperty","isMobile","isAndroid","isIos","getIosVersion","matches","parseFloat","openNewPage","url","BX","MobileTools","openWidget","resolveOpenFunction","app","window","open","device","isDesktop","isMobileStatic","orientationHorizontal","orientationPortrait","getOrientation","Math","abs","orientation","text","quote","params","files","localize","toString","message","replace","whole","userId","imol","chatId","command","rating","IM_F_RATING","FILE_ID","length","filesText","forEach","fileId","type","push","name","join","ATTACH","trim","purify","startsWith","substr","codeReplacement","id","title","indexOf","element","index","WITH_ATTACH","WITH_FILE","htmlspecialchars","htmlspecialcharsback","getLocalizeForNumber","phrase","number","language","pluralFormType","parseInt","getFirstLetters","validSymbolsPattern","words","split","filter","word","firstLetter","charAt","test","convertSnakeToCamelCase","$1","toUpperCase","date","getFormatType","DateFormat","default","format","groupTitle","recentTitle","recentLinesTitle","readedTitle","vacationTitle","getDateFunction","dateFormatFunction","Object","create","Main","Date","_getMessage","timestamp","cast","def","result","Number","isNaN","getTime","getTimeToNextMidnight","nextMidnight","setHours","now","getStartOfTheDay","isToday","toDateString","user","getLastDateText","bot","network","lastActivityDate","isOnline","isMobileOnline","mobileLastDate","idle","Loc","getMessage","getIdleText","lastSeenText","getLastSeenText","getStatusText","status","phraseCode","gender","absent","dateFunction","vacationFormat","vacationText","getOnlineLimit","FIVE_MINUTES","formatLastActivityDate","isBirthdayToday","birthday","FIFTEEN_MINUTES","LIMIT_ONLINE","getLogTrackingParams","data","dialog","encodeURIComponent","Array","dataArray","hasOwnProperty","entityId","types","isUuidV4","uuid","uuidV4pattern","RegExp","search"],"mappings":"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"}