{"version":3,"file":"script.js","sources":["src/ajaxprocessor.js","src/form.js","src/tabs.js","src/dateend.js","src/grat.js","src/editor.js","src/autosave.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class AjaxProcessor\n{\n\thtmlWasInserted: boolean = false;\n\tscriptsLoaded:boolean = false;\n\n\tconstructor()\n\t{\n\n\t}\n\n\tprocessCSS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.CSS)\n\t\t\t&& block.CSS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.CSS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t};\n\n\tprocessExternalJS(block, callback: Function): void\n\t{\n\t\tif (\n\t\t\tType.isArray(block.JS)\n\t\t\t&& block.JS.length > 0\n\t\t)\n\t\t{\n\t\t\tBX.load(block.JS, callback);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tprocessAjaxBlockInsertHTML(block, container: HTMLElement, callbackExternal: Function): void\n\t{\n\t\tcontainer.appendChild(BX.create('DIV', {\n\t\t\thtml: block.CONTENT\n\t\t}));\n\n\t\tthis.htmlWasInserted = true;\n\t\tif (this.scriptsLoaded)\n\t\t{\n\t\t\tthis.processInlineJS(block, callbackExternal);\n\t\t}\n\t}\n\n\tprocessInlineJS(block, callbackExternal: Function): void\n\t{\n\t\tthis.scriptsLoaded = true;\n\t\tif (this.htmlWasInserted)\n\t\t{\n\t\t\tBX.ajax.processRequestData(block.CONTENT, {\n\t\t\t\tscriptsRunFirst: false,\n\t\t\t\tdataType: 'HTML'\n\t\t\t});\n\t\t\tcallbackExternal();\n\t\t}\n\t}\n}","import {Type, ajax as Ajax, Loc, Dom, Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport AjaxProcessor from './ajaxprocessor';\n\nexport default class PostForm\n{\n\tstatic instance = null;\n\n\tlazyLoad: boolean = null;\n\tajaxUrl: string = '';\n\tinited: boolean = false;\n\tloaded: boolean = false;\n\tcontainer: HTMLElement = null;\n\tcontainerMicro: HTMLElement = null;\n\tcontainerMicroInner: HTMLElement = null;\n\tclickDisabled: boolean = false;\n\tlastWait: HTMLElement[] = [];\n\tanimationStartHeight: number = 0;\n\tinitedEditorsList: string[] = [];\n\toptions: { [key: string]: any } = {};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostForm.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostForm.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.init(params);\n\t\tPostForm.setInstance(this);\n\t}\n\n\tsetOption(key: string, value: any): void\n\t{\n\t\tif (!Type.isStringFilled(key))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.options[key] = value;\n\t}\n\n\tonShow(): void\n\t{\n\t\tif(\n\t\t\t!Type.isStringFilled(this.options.startVideoRecorder)\n\t\t\t|| this.options.startVideoRecorder !== 'Y'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (!editorForm)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t}));\n\n\t\t\tBX.VideoRecorder.start('blogPostForm', 'post');\n\t\t}, 500);\n\t};\n\n\tonSliderClose(): void\n\t{\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (!sliderInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.postMessageAll(window, 'SidePanel.Wrapper:onClose', {\n\t\t\tsliderData: sliderInstance.getData(),\n\t\t});\n\t};\n\n\tinit(params: { [key: string]: any }): void\n\t{\n\t\tif (this.inited !== true)\n\t\t{\n\t\t\tthis.inited = true;\n\t\t\tthis.lazyLoad = !Type.isUndefined(params.lazyLoad) ? !!params.lazyLoad : false;\n\t\t\tthis.ajaxUrl = Type.isStringFilled(params.ajaxUrl) ? params.ajaxUrl : '';\n\t\t\tthis.container = Type.isDomNode(params.container) ? params.container : null;\n\t\t\tthis.containerMicro = Type.isDomNode(params.containerMicro) ? params.containerMicro : null;\n\t\t\tthis.containerMicroInner = Type.isDomNode(params.containerMicroInner) ? params.containerMicroInner : null;\n\t\t\tthis.successPostId = !Type.isUndefined(params.successPostId) && parseInt(params.successPostId) > 0 ? parseInt(params.successPostId) : 0;\n\n\t\t\t//region dnd\n\t\t\tif (this.containerMicro)\n\t\t\t{\n\t\t\t\tthis.containerMicro.setAttribute('dropzone', 'copy f:*\\/*');\n\n\t\t\t\tlet timerListenEnter = 0;\n\t\t\t\tconst stopListenEnter = (event) => {\n\t\t\t\t\tif (timerListenEnter > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tclearTimeout(timerListenEnter);\n\t\t\t\t\t\ttimerListenEnter = 0;\n\t\t\t\t\t}\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\t\t\t\tconst fireDragEnter = (event) => {\n\t\t\t\t\tstopListenEnter(event);\n\t\t\t\t\tthis.containerMicro.click();\n\t\t\t\t};\n\t\t\t\tconst startListenEnter = (event) => {\n\t\t\t\t\tif (timerListenEnter <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttimerListenEnter = setTimeout(() => { fireDragEnter(event); }, 3000);\n\t\t\t\t\t}\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t};\n\n\t\t\t\tthis.containerMicro.addEventListener('dragover', startListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragenter', startListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragleave', stopListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('dragexit', stopListenEnter);\n\t\t\t\tthis.containerMicro.addEventListener('drop', stopListenEnter);\n\t\t\t}\n\t\t\t//region\n\t\t}\n\n\t\tconst sliderInstance = BX.SidePanel.Instance.getTopSlider();\n\t\tif (sliderInstance)\n\t\t{\n\t\t\tif (this.successPostId > 0)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, 'Socialnetwork.PostForm:onAdd', {\n\t\t\t\t\toriginatorSliderId: sliderInstance.getData().get('sliderId'),\n\t\t\t\t\tsuccessPostId: this.successPostId,\n\t\t\t\t});\n\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t\telse if (!sliderInstance.getData().get('initialized'))\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(sliderInstance, 'BX.Socialnetwork.SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t\tsliderInstance.getData().set('initialized', true);\n\t\t\t}\n\t\t}\n\t};\n\n\tget(params: { [key: string]: any }): void\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.lazyLoad\n\t\t\t&& !this.loaded\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tthis.animationStartHeight = this.containerMicro.offsetHeight;\n\n\t\t\tif (\n\t\t\t\tType.isStringFilled(params.loaderType)\n\t\t\t\t&& params.loaderType === 'tab'\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.showWaitTab();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.containerMicroInner.style.display = 'none';\n\t\t\t\tthis.showWait(this.containerMicro);\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: this.ajaxUrl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'SBPE_get_full_form',\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tthis.loaded = true;\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\n\t\t\t\t\tif(result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.processAjaxBlock(result.PROPS, params.callback);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonfailure: () => {\n\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\tthis.closeWait();\n\t\t\t\t\tthis.containerMicroInner.style.display = 'block';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (Type.isFunction(params.callback))\n\t\t{\n\t\t\tparams.callback();\n\t\t}\n\t};\n\n\tprocessAjaxBlock(block, callbackExternal: Function): void\n\t{\n\t\tif (!block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst processor = new AjaxProcessor();\n\n\t\tprocessor.processCSS(block, () => {\n\t\t\tprocessor.processAjaxBlockInsertHTML(block, this.container, callbackExternal);\n\t\t});\n\t\tprocessor.processExternalJS(block, () => {\n\t\t\tprocessor.processInlineJS(block, callbackExternal);\n\t\t});\n\t};\n\n\tshowWait(node: HTMLElement): HTMLElement\n\t{\n\t\tconst waiterNode = node.bxmsg = document.body.appendChild(Dom.create('DIV', {\n\t\t\tprops: {\n\t\t\t\tid: `wait_${node.id}`,\n\t\t\t\tclassName: 'feed-add-post-loader-cont'\n\t\t\t},\n\t\t\thtml: '<svg class=\"feed-add-post-loader\" viewBox=\"25 25 50 50\"><circle class=\"feed-add-post-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle><circle class=\"feed-add-post-loader-inner-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'\n\t\t}));\n\n\t\tsetTimeout(() => {\n\t\t\tthis.adjustWait(node);\n\t\t}, 10);\n\t\tthis.lastWait.push(waiterNode);\n\n\t\treturn waiterNode;\n\t};\n\n\tshowWaitTab(): void\n\t{\n\t\tif (\n\t\t\t!BX('feed-add-post-more-icon')\n\t\t\t|| !BX('feed-add-post-more-icon-waiter')\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX('feed-add-post-more-icon').style.display = 'none';\n\t\tBX('feed-add-post-more-icon-waiter').style.display = 'block';\n\t};\n\n\tcloseWait(): void\n\t{\n\t\tconst waiterNode = this.containerMicro.bxmsg;\n\n\t\tif (waiterNode && waiterNode.parentNode)\n\t\t{\n\t\t\tfor (let i=0, len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (this.containerMicro)\n\t\t\t{\n\t\t\t\tthis.containerMicro.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\n\t\tif (\n\t\t\tBX('feed-add-post-more-icon')\n\t\t\t&& BX('feed-add-post-more-icon-waiter')\n\t\t\t&& BX('feed-add-post-more-icon').style.display === 'none'\n\t\t)\n\t\t{\n\t\t\tBX('feed-add-post-more-icon').style.display = 'block';\n\t\t\tBX('feed-add-post-more-icon-waiter').style.display = 'none';\n\t\t}\n\t};\n\n\tadjustWait(node: HTMLElement): void\n\t{\n\t\tif (!node.bxmsg)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nodePosition = BX.pos(node);\n\t\tlet topDelta = nodePosition.top + 15;\n\n\t\tif (topDelta < BX.GetDocElement().scrollTop)\n\t\t{\n\t\t\ttopDelta = BX.GetDocElement().scrollTop + 5;\n\t\t}\n\n\t\tnode.bxmsg.style.top = `${(topDelta + 5)}px`;\n\n\t\tif (node === BX.GetDocElement())\n\t\t{\n\t\t\tnode.bxmsg.style.right = '5px';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.bxmsg.style.left = `${(nodePosition.left + parseInt((nodePosition.width - node.bxmsg.offsetWidth) / 2))}px`;\n\t\t}\n\t};\n\n\ttasksTaskEvent(taskId: number): void\n\t{\n\t\tif (!Reflection.getClass('BX.UI.Notification.Center'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskLink = Loc.getMessage('PATH_TO_USER_TASKS_TASK').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId).replace('#action#', 'view');\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('BLOG_POST_EDIT_T_CREATE_TASK_BUTTON_TITLE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}]\n\t\t});\n\t};\n}","import { Type, Loc, Dom, Event, Runtime, ajax as Ajax, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport { MenuManager } from \"main.popup\";\n\nexport default class PostFormTabs extends EventEmitter\n{\n\tstatic instance = null;\n\n\tinited: boolean = false;\n\n\ttabs: { [key: string]: any } = {};\n\tbodies: { [key: string]: any } = {};\n\tactive = null;\n\tanimation = null;\n\tanimationStartHeight:number = 0;\n\tpreviousTab = null;\n\tmenu = null;\n\tlistsMenu = null;\n\tmenuItems = [];\n\tlastWait: HTMLElement[] = [];\n\tclickDisabled: boolean = false;\n\n\ttabContainer: HTMLElement = null;\n\tarrow: HTMLElement = null;\n\n\tconfig = {\n\t\tid: {\n\t\t\tmessage: 'message',\n\t\t\ttask: 'tasks',\n\t\t\tcalendar: 'calendar',\n\t\t\tfile: 'file',\n\t\t\tgratitude: 'grat',\n\t\t\timportant: 'important',\n\t\t\tvote: 'vote',\n\t\t\tmore: 'more',\n\t\t\tlistItem: 'lists',\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormTabs.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\tif (PostFormTabs.instance === null)\n\t\t{\n\t\t\tnew PostFormTabs();\n\t\t}\n\n\t\treturn PostFormTabs.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Socialnetwork.Livefeed.Post.Form.Tabs');\n\t\tthis.init();\n\t\tthis.emit('onInitialized', { tabsInstance: this });\n\n\t\tPostFormTabs.setInstance(this);\n\t\twindow.SBPETabs = this;\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.tabContainer = document.getElementById('feed-add-post-form-tab');\n\t\tthis.arrow = document.getElementById('feed-add-post-form-tab-arrow');\n\t\tthis.tabs = {};\n\t\tthis.bodies = {};\n\n\t\tconst tabsList = this.tabContainer && this.tabContainer.querySelectorAll('span.feed-add-post-form-link');\n\t\tif (tabsList)\n\t\t{\n\t\t\tfor (let i = 0; i < tabsList.length; i++)\n\t\t\t{\n\t\t\t\tconst id = tabsList[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\t\t\t\tconst limited = tabsList[i].getAttribute('limited');\n\n\t\t\t\tthis.tabs[id] = tabsList[i];\n\n\t\t\t\tif (this.tabs[id].style.display === 'none')\n\t\t\t\t{\n\t\t\t\t\tthis.menuItems.push({\n\t\t\t\t\t\ttabId : id,\n\t\t\t\t\t\ttext : tabsList[i].getAttribute('data-name'),\n\t\t\t\t\t\tclassName : `menu-popup-no-icon feed-add-post-form-${id} feed-add-post-form-${id}-more`,\n\t\t\t\t\t\tonclick : this.createOnClick(id, tabsList[i].getAttribute('data-name'), tabsList[i].getAttribute('data-onclick'), (tabsList[i].getAttribute('data-limited') === 'Y'))\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.tabs[id] = this.tabs[id].parentNode;\n\t\t\t\t}\n\n\t\t\t\tthis.bodies[id] = document.getElementById(`feed-add-post-content-${id}`);\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.file])\n\t\t{\n\t\t\tthis.bodies[this.config.id.file] = [ this.bodies[this.config.id.message] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.calendar])\n\t\t{\n\t\t\tthis.bodies[this.config.id.calendar] = [ this.bodies[this.config.id.calendar] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.vote])\n\t\t{\n\t\t\tthis.bodies[this.config.id.vote] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.vote],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.more])\n\t\t{\n\t\t\tthis.bodies[this.config.id.more] = null;\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.important])\n\t\t{\n\t\t\tthis.bodies[this.config.id.important] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.important],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.gratitude])\n\t\t{\n\t\t\tthis.bodies[this.config.id.gratitude] = [\n\t\t\t\tthis.bodies[this.config.id.message],\n\t\t\t\tthis.bodies[this.config.id.gratitude],\n\t\t\t];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.listItem])\n\t\t{\n\t\t\tthis.bodies[this.config.id.listItem] = [ this.bodies[this.config.id.listItem] ];\n\t\t}\n\n\t\tif (!!this.tabs[this.config.id.task])\n\t\t{\n\t\t\tthis.bodies[this.config.id.task] = [ this.bodies[this.config.id.task] ];\n\t\t}\n\n\t\tfor (let ii in this.bodies)\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.bodies.hasOwnProperty(ii)\n\t\t\t\t&& Type.isDomNode(this.bodies[ii])\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.bodies[ii] = [ this.bodies[ii] ];\n\t\t\t}\n\n\t\t}\n\n\t\tthis.inited = true;\n\t\tthis.previousTab = false;\n\n\t\tconst uploadFileNode = document.getElementById('bx-b-uploadfile-blogPostForm');\n\t\tif (uploadFileNode)\n\t\t{\n\t\t\tuploadFileNode.setAttribute('bx-press', 'pressOut');\n\t\t\tEvent.bind(uploadFileNode, 'mousedown', () => {\n\t\t\t\tuploadFileNode.setAttribute(\"bx-press\", (uploadFileNode.getAttribute(\"bx-press\") == \"pressOut\" ? \"pressOn\" : \"pressOut\"));\n\t\t\t});\n\t\t}\n\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tif (!form)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (!form.changePostFormTab)\n\t\t{\n\t\t\tform.appendChild(Dom.create('INPUT', {\n\t\t\t\tprops : {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: 'changePostFormTab',\n\t\t\t\t\tvalue: ''\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tthis.subscribe('changePostFormTab', (event) => {\n\t\t\tconst { type } = event.getData();\n\n\t\t\tif (type === this.config.id.more)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tform.changePostFormTab.value = type;\n\n\t\t\tif (form['UF_BLOG_POST_IMPRTNT'])\n\t\t\t{\n\t\t\t\tform['UF_BLOG_POST_IMPRTNT'].value = (type === this.config.id.important ? '1' : '0');\n\t\t\t}\n\t\t});\n\t};\n\n\tcreateOnClick(id, name:string, onclick: string, limited: boolean)\n\t{\n\t\treturn () => {\n\t\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\t\tif (!limited)\n\t\t\t{\n\t\t\t\tbtnText.innerHTML = name;\n\t\t\t\tif (id !== this.config.id.listItem)\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-link-active feed-add-post-form-${id}-link`;\n\t\t\t\t\tthis.changePostFormTab(id, false);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbtn.className = `feed-add-post-form-link feed-add-post-form-link-more feed-add-post-form-${id}-link`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(onclick))\n\t\t\t{\n\t\t\t\tBX.evalGlobal(onclick);\n\t\t\t}\n\n\t\t\tthis.menu.popupWindow.close();\n\t\t}\n\t};\n\n\tchangePostFormTab(type, iblock)\n\t{\n\t\tif (this.clickDisabled)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.setActive(type, iblock);\n\t};\n\n\tsetActive(type?:string, iblock)\n\t{\n\t\tif (\n\t\t\tType.isNull(type)\n\t\t\t|| (\n\t\t\t\tthis.active === type\n\t\t\t\t&& type !== this.config.id.listItem\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn this.active;\n\t\t}\n\t\telse if (!this.tabs[type])\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst needAnimation = (type !== this.config.id.task || this.isTaskTabLoaded());\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tfor (let ii in this.tabs)\n\t\t{\n\t\t\tif (this.tabs.hasOwnProperty(ii) && ii !== type)\n\t\t\t{\n\t\t\t\tthis.tabs[ii].classList.remove('feed-add-post-form-link-active');\n\t\t\t\tif (\n\t\t\t\t\tthis.bodies[ii] == null\n\t\t\t\t\t|| this.bodies[type] == null\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (let jj = 0; jj < this.bodies[ii].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (this.bodies[type][jj] != this.bodies[ii][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[ii][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!!this.tabs[type])\n\t\t{\n\t\t\tthis.active = type;\n\n\t\t\tconst tabPosTab = BX.pos(this.tabs[type], true);\n\n\t\t\tthis.arrow.style.display = 'block';\n\t\t\tthis.arrow.style.top = `${tabPosTab.bottom}px`;\n\n\t\t\tconst leftStart = parseInt(this.arrow.style.left) || 0;\n\t\t\tconst widthStart = parseInt(this.arrow.style.width) || 0;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration : 200,\n\t\t\t\tstart: { left: leftStart, width:  widthStart },\n\t\t\t\tfinish: { left: tabPosTab.left, width: tabPosTab.width },\n\t\t\t\ttransition: BX.easing.makeEaseInOut(BX.easing.transitions.quart),\n\t\t\t\tstep : (state) => {\n\t\t\t\t\tthis.arrow.style.left = `${state.left}px`;\n\t\t\t\t\tthis.arrow.style.width = `${state.width}px`;\n\t\t\t\t},\n\n\t\t\t\tcomplete : () => {\n\t\t\t\t\tthis.arrow.style.display = 'none';\n\t\t\t\t\tthis.tabs[type].classList.add('feed-add-post-form-link-active');\n\t\t\t\t}\n\t\t\t})).animate();\n\n\t\t\tif (\n\t\t\t\tthis.previousTab === this.config.id.file\n\t\t\t\t|| type === this.config.id.file\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet hasValuesFile = false;\n\t\t\t\tlet hasValuesDocs = false;\n\n\t\t\t\tconst messageBody = document.getElementById('divoPostFormLHE_blogPostForm');\n\n\t\t\t\tif (\n\t\t\t\t\t!!messageBody\n\t\t\t\t\t&& !!messageBody.childNodes\n\t\t\t\t\t&& messageBody.childNodes.length > 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (let ii in messageBody.childNodes)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!messageBody.childNodes.hasOwnProperty(ii))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst node = messageBody.childNodes[ii];\n\t\t\t\t\t\tif (node.className === 'file-selectdialog')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst nodeFile = node;\n\t\t\t\t\t\t\tconst values1 = nodeFile.querySelector('.file-placeholder-tbody');\n\t\t\t\t\t\t\tconst values2 = nodeFile.querySelector('.feed-add-photo-block');\n\t\t\t\t\t\t\tif (values1.rows > 0 || !!values2 && values2.length > 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thasValuesFile = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tType.isStringFilled(node.className)\n\t\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\t\tnode.className.indexOf('wduf-selectdialog') >= 0\n\t\t\t\t\t\t\t\t\t|| node.className.indexOf('diskuf-selectdialog') >= 0\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| (Type.isStringFilled(node.id) && node.id.indexOf('disk-uf-file-container') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst UserFieldControl = BX.Reflection.getClass('BX.Disk.Uploader.UserFieldControl');\n\t\t\t\t\t\t\tif (UserFieldControl === null)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst nodeDocs = node;\n\t\t\t\t\t\t\t\tconst webdavValues = nodeDocs.querySelectorAll('.wd-inline-file');\n\n\t\t\t\t\t\t\t\thasValuesDocs = (!!webdavValues && webdavValues.length > 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst userFieldControl = UserFieldControl.getById('blogPostForm');\n\t\t\t\t\t\t\t\tif (userFieldControl)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst uploader = userFieldControl.getUploader();\n\t\t\t\t\t\t\t\t\thasValuesDocs = uploader.getFiles().length > 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(\n\t\t\t\t\t\t\tType.isDomNode(node)\n\t\t\t\t\t\t\t&& node.classList\n\t\t\t\t\t\t\t&& !node.classList.contains('urlpreview')\n\t\t\t\t\t\t\t&& !node.classList.contains('feed-add-post-strings-blocks')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.adjust(node, {\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: (type === this.config.id.file ? 'none' : '')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (type === this.config.id.file)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!!window['PlEditorblogPostForm']\n\t\t\t\t\t\t\t&& !window['PlEditorblogPostForm'].SBPEBinded\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].SBPEBinded = true;\n\n\t\t\t\t\t\t\tEventEmitter.subscribe(window[\"PlEditorblogPostForm\"].eventNode, 'onUploadsHasBeenChanged', (event: BaseEvent) => {\n\n\t\t\t\t\t\t\t\tconst wdObj = event.getData()[1];\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\twdObj.dialogName === 'AttachFileDialog'\n\t\t\t\t\t\t\t\t\t&& wdObj.urlUpload.indexOf('&dropped=Y') < 0\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\twdObj.urlUpload = wdObj.agent.uploadFileUrl = wdObj.urlUpload.replace('&random_folder=Y', '&dropped=Y');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdocument.getElementById('bx-b-uploadfile-blogPostForm').setAttribute('bx-press', 'pressOn');\n\t\t\t\t\t\t\t\tif (this.active !== this.config.id.file)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.changePostFormTab(this.config.id.message);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('show');\n\t\t\t\t\t\tmessageBody.classList.add('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tmessageBody.classList.remove('feed-add-post-form', 'feed-add-post-edit-form', 'feed-add-post-edit-form-file');\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!hasValuesFile\n\t\t\t\t\t\t\t&& !hasValuesDocs\n\t\t\t\t\t\t\t&& document.getElementById('bx-b-uploadfile-blogPostForm').getAttribute('bx-press') === 'pressOut'\n\t\t\t\t\t\t\t&& !!window['PlEditorblogPostForm']\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow['PlEditorblogPostForm'].controllerInit('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm');\n\t\t\tif (\n\t\t\t\teditorForm\n\t\t\t\t&& editorForm.style.display === 'none'\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\t\tcompatData: [ 'justShow' ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tif (type === this.config.id.listItem)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('onDisplayClaimLiveFeed', new BaseEvent({\n\t\t\t\t\tcompatData: [ iblock ]\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tthis.previousTab = type;\n\n\t\t\tif (!!this.bodies[type])\n\t\t\t{\n\t\t\t\tfor (let jj = 0; jj < this.bodies[type].length; jj++)\n\t\t\t\t{\n\t\t\t\t\tif (!!this.bodies[type][jj])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.adjust(this.bodies[type][jj], {\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (needAnimation)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\n\t\tif(type !== this.config.id.listItem)\n\t\t{\n\t\t\tthis.restoreMoreMenu();\n\t\t}\n\n\t\tthis.emit('changePostFormTab', { type });\n\n\t\treturn this.active;\n\t};\n\n\tisTaskTabLoaded()\n\t{\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\t\treturn (contentContainer && contentContainer.children.length);\n\t};\n\n\tcollapse()\n\t{\n\t\tthis.active = null;\n\t\tlet postEditSlider = false;\n\n\t\tconst currentSlider = (window !== top.window ? BX.SidePanel.Instance.getSliderByWindow(window) : null);\n\n\t\tif (window !== top.window) // slider\n\t\t{\n\t\t\tif (\n\t\t\t\tcurrentSlider\n\t\t\t\t&& currentSlider.url.match(/\\/user\\/(\\d+)\\/blog\\/edit\\//)\n\t\t\t)\n\t\t\t{\n\t\t\t\tpostEditSlider = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.changePostFormTab(\"message\");\n\t\t\tconst formInstance = PostForm.getInstance();\n\t\t\tif (\n\t\t\t\tformInstance\n\t\t\t\t&& Type.isDomNode(formInstance.containerMicroInner)\n\t\t\t)\n\t\t\t{\n\t\t\t\tformInstance.containerMicroInner.style.display = 'block';\n\t\t\t}\n\t\t\tthis.startAnimation();\n\t\t}\n\n\t\tconst editorForm = document.getElementById('divoPostFormLHE_blogPostForm')\n\t\tif (editorForm)\n\t\t{\n\t\t\tEventEmitter.emit(editorForm, 'OnShowLHE', new BaseEvent({\n\t\t\t\tcompatData: [ false ]\n\t\t\t}));\n\t\t}\n\n\t\tEventEmitter.emit('onExtAutoSaveReset_blogPostForm', new BaseEvent({\n\t\t\tcompatData: [ ]\n\t\t}));\n\n\t\tif (!postEditSlider)\n\t\t{\n\t\t\tthis.endAnimation();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (currentSlider)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(window.top, 'SidePanel.Slider:onClose', new BaseEvent({\n\t\t\t\t\tcompatData: [ currentSlider.getEvent('onClose') ]\n\t\t\t\t}));\n\t\t\t}\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}\n\t};\n\n\tstartAnimation():void\n\t{\n\t\tif (this.animation)\n\t\t{\n\t\t\tthis.animation.stop();\n\t\t}\n\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (PostForm.getInstance().animationStartHeight > 0)\n\t\t{\n\t\t\tthis.animationStartHeight = PostForm.getInstance().animationStartHeight;\n\t\t\tPostForm.getInstance().animationStartHeight = 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.animationStartHeight = container.parentNode.offsetHeight;\n\t\t}\n\n\t\tcontainer.parentNode.style.height = `${this.animationStartHeight}px`;\n\t\tcontainer.parentNode.style.overflowY = 'hidden';\n\t\tcontainer.parentNode.style.position = 'relative';\n\t\tcontainer.style.opacity = 0;\n\t};\n\n\tendAnimation():void\n\t{\n\t\tconst container = document.getElementById('microblog-form');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.animation = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {\n\t\t\t\theight: this.animationStartHeight,\n\t\t\t\topacity: 0\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\theight: container.offsetHeight + container.offsetTop,\n\t\t\t\topacity: 100\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tcontainer.parentNode.style.height = `${state.height}px`;\n\t\t\t\tcontainer.style.opacity = state.opacity / 100;\n\t\t\t},\n\n\t\t\tcomplete : () => {\n\t\t\t\tcontainer.style.cssText = '';\n\t\t\t\tcontainer.parentNode.style.cssText = '';\n\t\t\t\tthis.animation = null;\n\t\t\t}\n\t\t});\n\n\t\tthis.animation.animate();\n\t};\n\n\tshowMoreMenu()\n\t{\n\t\tif (!this.menu)\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t'feed-add-post-form-popup',\n\t\t\t\tdocument.getElementById('feed-add-post-form-link-text'),\n\t\t\t\tthis.menuItems,\n\t\t\t\t{\n\t\t\t\t\tclassName: 'feed-add-post-form-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\toffsetTop: 5,\n\t\t\t\t\toffsetLeft: 3,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.menu.popupWindow.show();\n\t};\n\n\trestoreMoreMenu(): void\n\t{\n\t\tconst itemCnt = this.menuItems.length;\n\t\tif (itemCnt < 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < itemCnt; i++)\n\t\t{\n\t\t\tif (this.active === this.menuItems[i]['tabId'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst btn = document.getElementById('feed-add-post-form-link-more');\n\t\tconst btnText = document.getElementById('feed-add-post-form-link-text');\n\n\t\tbtn.className = 'feed-add-post-form-link feed-add-post-form-link-more';\n\t\tbtnText.innerHTML = Loc.getMessage('SBPE_MORE');\n\t};\n\n\tgetTaskForm()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-tasks').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-tasks')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tconst content = document.getElementById('feed-add-post-content-tasks');\n\t\tconst contentContainer = document.getElementById('feed-add-post-content-tasks-container');\n\n\t\tif (\n\t\t\tcontentContainer\n\t\t\t&& contentContainer.innerHTML.length <= 0\n\t\t\t&& !this.clickDisabled\n\t\t)\n\t\t{\n\t\t\tthis.clickDisabled = true;\n\t\t\tPostForm.getInstance().showWait(contentContainer);\n\t\t\tthis.startAnimation();\n\n\t\t\tconst componentParameters = {\n\t\t\t\tGROUP_ID: Loc.getMessage('TASK_SOCNET_GROUP_ID'),\n\t\t\t\tPATH_TO_USER_TASKS: Loc.getMessage('PATH_TO_USER_TASKS'),\n\t\t\t\tPATH_TO_USER_TASKS_TASK: Loc.getMessage('PATH_TO_USER_TASKS_TASK'),\n\t\t\t\tPATH_TO_GROUP_TASKS: Loc.getMessage('PATH_TO_GROUP_TASKS'),\n\t\t\t\tPATH_TO_GROUP_TASKS_TASK: Loc.getMessage('PATH_TO_GROUP_TASKS_TASK'),\n\t\t\t\tPATH_TO_USER_PROFILE: Loc.getMessage('PATH_TO_USER_PROFILE'),\n\t\t\t\tPATH_TO_GROUP: Loc.getMessage('PATH_TO_GROUP'),\n\t\t\t\tPATH_TO_USER_TASKS_PROJECTS_OVERVIEW: Loc.getMessage('PATH_TO_USER_TASKS_PROJECTS_OVERVIEW'),\n\t\t\t\tPATH_TO_USER_TASKS_TEMPLATES: Loc.getMessage('PATH_TO_USER_TASKS_TEMPLATES'),\n\t\t\t\tPATH_TO_USER_TEMPLATES_TEMPLATE: Loc.getMessage('PATH_TO_USER_TEMPLATES_TEMPLATE'),\n\t\t\t\tENABLE_FOOTER: 'N',\n\t\t\t\tTEMPLATE_CONTROLLER_ID: 'livefeed_task_form',\n\t\t\t\tENABLE_FORM: 'N',\n\t\t\t\tBACKURL: Loc.getMessage('TASK_SUBMIT_BACKURL')\n\t\t\t};\n\n\t\t\tAjax.runComponentAction('bitrix:tasks.task', 'uiEdit', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tparameters: {\n\t\t\t\t\t\tCOMPONENT_PARAMETERS: componentParameters,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tanalytics: {\n\t\t\t\t\ttool: 'tasks',\n\t\t\t\t\tcategory: 'task_operations',\n\t\t\t\t\tevent: 'task_create',\n\t\t\t\t\ttype: 'task',\n\t\t\t\t\tc_section: 'feed',\n\t\t\t\t\tc_element: 'create_button',\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\n\t\t\t\tRuntime.html(contentContainer, response.data.html)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tthis.clickDisabled = false;\n\t\t\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\t\t\tthis.endAnimation();\n\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\tdocument.getElementById('divlivefeed_task_form'),\n\t\t\t\t\t\t\t'OnShowLHE',\n\t\t\t\t\t\t\tnew BaseEvent({compatData: ['justShow']})\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tDom.adjust(content, {\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay : 'block',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}, (response) => {\n\n\t\t\t\tthis.clickDisabled = false;\n\t\t\t\tthis.closeWait(contentContainer);\n\t\t\t\tthis.endAnimation();\n\n\t\t\t\tif (response.errors && response.errors.length)\n\t\t\t\t{\n\t\t\t\t\tconst errors = [];\n\n\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\terrors.push(error.message);\n\t\t\t\t\t});\n\t\t\t\t\tthrow new Error(errors.join(' '));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.startAnimation();\n\t\t\tthis.endAnimation();\n\t\t}\n\t};\n\n\tcloseWait(node)\n\t{\n\t\tconst waiterNode = node.bxmsg;\n\n\t\tif (\n\t\t\twaiterNode\n\t\t\t&& waiterNode.parentNode\n\t\t)\n\t\t{\n\t\t\tfor (let i=0,len=this.lastWait.length; i<len; i++)\n\t\t\t{\n\t\t\t\tif (waiterNode === this.lastWait[i])\n\t\t\t\t{\n\t\t\t\t\tthis.lastWait = BX.util.deleteFromArray(this.lastWait, i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twaiterNode.parentNode.removeChild(waiterNode);\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.bxmsg = null;\n\t\t\t}\n\n\t\t\tDom.clean(waiterNode);\n\t\t\tDom.remove(waiterNode);\n\t\t}\n\t};\n\n\tgetLists()\n\t{\n\t\tconst tabContainer = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists')\n\t\t\t&& document.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\t\tlet tabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tlet tabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tlet menuItemsListsDefault = [];\n\t\tlet menuItemsLists = [];\n\t\tlet canOpenInSlider = false;\n\n\t\tif (tabs.length > 0)\n\t\t{\n\t\t\tmenuItemsLists = this.getMenuItems(\n\t\t\t\ttabs,\n\t\t\t\tcanOpenInSlider ? this.#handleCreateListInSlider.bind(this) : this.createOnclickLists,\n\t\t\t);\n\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet siteId = null;\n\n\t\t\tif (document.getElementById('bx-lists-select-site-id'))\n\t\t\t{\n\t\t\t\tsiteId = document.getElementById('bx-lists-select-site-id').value;\n\t\t\t}\n\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\turl: '/bitrix/components/bitrix/socialnetwork.blog.post.edit/post.ajax.php',\n\t\t\t\tdata: {\n\t\t\t\t\tbitrix_processes: 1,\n\t\t\t\t\tsiteId: siteId,\n\t\t\t\t\tsessid: Loc.getMessage('bitrix_sessid')\n\t\t\t\t},\n\t\t\t\tonsuccess: (result) => {\n\t\t\t\t\tif (result.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tcanOpenInSlider = Text.toBoolean(result.canOpenInSlider);\n\n\t\t\t\t\t\tfor(let k in result.lists)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!result.lists.hasOwnProperty(k))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t'data-name': result.lists[k].NAME,\n\t\t\t\t\t\t\t\t\t'data-picture': result.lists[k].PICTURE,\n\t\t\t\t\t\t\t\t\t'data-description': result.lists[k].DESCRIPTION,\n\t\t\t\t\t\t\t\t\t'data-picture-small': result.lists[k].PICTURE_SMALL,\n\t\t\t\t\t\t\t\t\t'data-code': result.lists[k].CODE,\n\t\t\t\t\t\t\t\t\tiblockId: result.lists[k].ID,\n\t\t\t\t\t\t\t\t\tiblockTypeId: result.lists[k].IBLOCK_TYPE_ID,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists',\n\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(\n\t\t\t\t\t\t\ttabs,\n\t\t\t\t\t\t\tcanOpenInSlider ? this.#handleCreateListInSlider.bind(this) : this.createOnclickLists,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif(!tabsDefault.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(let k in result.permissions)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (!result.permissions.hasOwnProperty(k))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet onclick;\n\t\t\t\t\t\t\t\tif(k === 'new')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}0/edit/\"`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'market')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t\t\tresult.admin\n\t\t\t\t\t\t\t\t\t\t&& document.getElementById('bx-lists-lists-page')\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${document.getElementById('bx-lists-lists-page').value}?bp_catalog=y\"`;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tif(document.getElementById('bx-lists-random-string'))\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tonclick = `BX.Lists[\"LiveFeedClass_${BX('bx-lists-random-string').value}\"].errorPopup(\"${Loc.getMessage('LISTS_CATALOG_PROCESSES_ACCESS_DENIED')}\");`;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(k === 'settings')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick = `document.location.href = \"${BX('bx-lists-lists-page').value}\"`;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t'data-name': result.permissions[k],\n\t\t\t\t\t\t\t\t\t\t'data-picture-small': '',\n\t\t\t\t\t\t\t\t\t\t'data-key': k,\n\t\t\t\t\t\t\t\t\t\t'data-onclick': onclick\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ttabsDefault = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmenuItemsListsDefault = this.getMenuItemsDefault(tabsDefault);\n\t\t\t\t\t\tmenuItemsLists = menuItemsLists.concat(menuItemsListsDefault);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttabContainer.appendChild(Dom.create('span', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t'data-name': result.error,\n\t\t\t\t\t\t\t\t'data-picture-small': ''\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists-default',\n\t\t\t\t\t\t\t\tid: 'feed-add-post-form-tab-lists'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\n\t\t\t\t\t\ttabs = tabContainer.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\t\t\t\t\tmenuItemsLists = this.getMenuItems(tabs, false);\n\t\t\t\t\t\tthis.showMoreMenuLists(menuItemsLists);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\tgetMenuItems(tabs, createOnclickLists)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tconst id = tabs[i].getAttribute('id').replace('feed-add-post-form-tab-', '');\n\n\t\t\tif (createOnclickLists)\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute('data-name')),\n\t\t\t\t\tclassName: `feed-add-post-form-${id} feed-add-post-form-${id}-item`,\n\t\t\t\t\tonclick: createOnclickLists(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\ttabs[i].getAttribute('iblockId'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-name'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-description'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-picture'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('data-code'),\n\t\t\t\t\t\t\ttabs[i].getAttribute('iblockTypeId'),\n\t\t\t\t\t\t],\n\t\t\t\t\t),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemsLists.push({\n\t\t\t\t\ttabId: id,\n\t\t\t\t\ttext: tabs[i].getAttribute('data-name'),\n\t\t\t\t\tclassName: `feed-add-post-form-${id}`,\n\t\t\t\t\tonclick: ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tgetMenuItemsDefault(tabs)\n\t{\n\t\tconst menuItemsLists = [];\n\n\t\tfor (let i = 0; i < tabs.length; i++)\n\t\t{\n\t\t\tmenuItemsLists.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(tabs[i].getAttribute('data-name')),\n\t\t\t\tclassName: `feed-add-post-form-lists-default-${tabs[i].getAttribute('data-key')}`,\n\t\t\t\tonclick: tabs[i].getAttribute('data-onclick')\n\t\t\t});\n\t\t}\n\n\t\treturn menuItemsLists;\n\t};\n\n\tshowMoreMenuLists(menuItemsLists)\n\t{\n\t\tconst menuBindElement = (\n\t\t\tdocument.getElementById('feed-add-post-form-tab-lists').style.display !== 'none'\n\t\t\t\t? document.getElementById('feed-add-post-form-tab-lists')\n\t\t\t\t: document.getElementById('feed-add-post-form-link-more')\n\t\t);\n\n\t\tthis.listsMenu = MenuManager.create(\n\t\t\t'lists',\n\t\t\tmenuBindElement,\n\t\t\tmenuItemsLists,\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toffsetLeft: 12,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\n\t\tconst spanIcon = document.getElementById('popup-window-content-menu-popup-lists').querySelectorAll('span.menu-popup-item-icon');\n\t\tlet spanDataPicture = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists');\n\t\tconst spanDataPictureDefault = menuBindElement.querySelectorAll('span.feed-add-post-form-link-lists-default');\n\t\tspanDataPicture = Array.from(spanDataPicture).concat(Array.from(spanDataPictureDefault));\n\n\t\tfor(let i = 0; i < spanIcon.length; i++)\n\t\t{\n\t\t\tif(!spanDataPicture[i].getAttribute('data-picture-small'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspanIcon[i].innerHTML = spanDataPicture[i].getAttribute('data-picture-small');\n\t\t}\n\n\t\tif (!this.listsMenu.popupWindow.isShown())\n\t\t{\n\t\t\tRuntime.loadExtension('ui.analytics')\n\t\t\t\t.then(({ sendData }) => {\n\t\t\t\t\tsendData({\n\t\t\t\t\t\ttool: 'automation',\n\t\t\t\t\t\tcategory: 'bizproc_operations',\n\t\t\t\t\t\tevent: 'drawer_open',\n\t\t\t\t\t\tc_section: 'feed',\n\t\t\t\t\t\tc_element: 'button',\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\n\t\tthis.listsMenu.popupWindow.show();\n\t};\n\n\tcreateOnclickLists(id, iblock)\n\t{\n\t\treturn () => {\n\t\t\tPostFormTabs.getInstance().changePostFormTab(id, iblock);\n\t\t\tPostFormTabs.getInstance().listsMenu.popupWindow.close();\n\t\t\tPostFormTabs.getInstance().menu.popupWindow.close();\n\t\t};\n\t}\n\n\t#handleCreateListInSlider(id, iblock): Function\n\t{\n\t\treturn () => {\n\t\t\tRuntime.loadExtension('lists.element.creation-guide')\n\t\t\t\t.then(({ CreationGuide }) => {\n\t\t\t\t\tif (CreationGuide)\n\t\t\t\t\t{\n\t\t\t\t\t\tPostFormTabs.getInstance().listsMenu.popupWindow.close();\n\t\t\t\t\t\tPostFormTabs.getInstance().menu.popupWindow.close();\n\n\t\t\t\t\t\tCreationGuide.open({\n\t\t\t\t\t\t\tiBlockTypeId: iblock[5],\n\t\t\t\t\t\t\tiBlockId: Text.toInteger(iblock[0]),\n\t\t\t\t\t\t\tanalyticsSection: 'feed',\n\t\t\t\t\t\t\tanalyticsP1: iblock[1],\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tif (BX.Livefeed && BX.Livefeed.PageInstance)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Livefeed.PageInstance.refresh();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.createOnclickLists(id, iblock)();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.createOnclickLists(id, iblock)();\n\t\t\t\t})\n\t\t\t;\n\t\t};\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MenuManager } from 'main.popup';\n\nimport 'main.date';\n\nexport default class PostFormDateEnd\n{\n\tisInitialized: boolean = false;\n\tpopupShowingPeriods = null;\n\tmenuItems = [];\n\tcustomDateStyleModifier: string = 'feed-add-post-expire-date-customize';\n\n\tcustomDatePopupOptionClass: string = 'js-custom-date-end';\n\n\tpostExpireDateBlock: HTMLElement = null;\n\tformUfInputDateCustom: HTMLElement = null;\n\tformDateDuration: HTMLElement = null;\n\tformDateTimeEditing: HTMLElement = null;\n\tpopupTrigger: HTMLElement = null;\n\tcustomDateSelectedTitle: HTMLElement = null;\n\n\tselectors = {\n\t\tpostExpireDateBlock: '.js-post-expire-date-block',\n\t\tpostEndTime: '.js-form-post-end-time',\n\t\tpostEditingEndTime: '.js-form-editing-post-end-time',\n\t\tpostEndPeriod: '.js-form-post-end-period',\n\t\tpopupTrigger: '.js-important-till-popup-trigger',\n\t\tcustomDateFinal: '.js-date-post-showing-custom',\n\t\tdurationOptionsContainer: '.js-post-showing-duration-options-container',\n\t\tdurationOption: '.js-post-showing-duration-option'\n\t};\n\n\tconstructor()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.isInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addEventHandlers();\n\n\t\tif (!this.formDateTimeEditing.value)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.innerText = this.getCurrentDate();\n\t\t}\n\n\t\tthis.isInitialized = true;\n\t};\n\n\taddEventHandlers()\n\t{\n\t\tthis.postExpireDateBlock = document.querySelector(this.selectors.postExpireDateBlock);\n\t\tthis.formUfInputDateCustom = document.querySelector(this.selectors.postEndTime);\n\t\tthis.formDateDuration = document.querySelector(this.selectors.postEndPeriod);\n\t\tthis.formDateTimeEditing = document.querySelector(this.selectors.postEditingEndTime);\n\t\tthis.popupTrigger = document.querySelector(this.selectors.popupTrigger);\n\n\t\tif (this.popupTrigger)\n\t\t{\n\t\t\tthis.popupTrigger.addEventListener('click', () => {\n\t\t\t\tthis.showPostEndPeriodsPopup();\n\t\t\t});\n\t\t}\n\n\t\tthis.customDateSelectedTitle = document.querySelector(this.selectors.customDateFinal);\n\t\tif (this.customDateSelectedTitle)\n\t\t{\n\t\t\tthis.customDateSelectedTitle.addEventListener('click', () => {\n\t\t\t\tlet curDate = new Date();\n\t\t\t\tlet curTimestamp = Math.round(curDate / 1000) - curDate.getTimezoneOffset() * 60;\n\n\t\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t\t{\n\t\t\t\t\tcurDate = BX.parseDate(this.formDateTimeEditing.value);\n\t\t\t\t\tcurTimestamp = BX.date.convertToUTC(curDate);\n\t\t\t\t}\n\n\t\t\t\tBX.calendar({\n\t\t\t\t\tnode: this.customDateSelectedTitle,\n\t\t\t\t\tform: 'blogPostForm',\n\t\t\t\t\tvalue: curTimestamp,\n\t\t\t\t\tbTime: false,\n\t\t\t\t\tcallback: () => {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tcallback_after: this.onEndDateSet.bind(this)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\n\tshowPostEndPeriodsPopup(): void\n\t{\n\t\tif (!this.popupShowingPeriods)\n\t\t{\n\t\t\tthis.createPopupShowingPeriods();\n\t\t}\n\t\tthis.popupShowingPeriods.popupWindow.show();\n\t};\n\n\tcreatePopupShowingPeriods(): void\n\t{\n\t\tif (this.menuItems.length <= 0)\n\t\t{\n\t\t\tthis.menuItems = this.createPopupItems();\n\t\t}\n\n\t\tthis.popupShowingPeriods = MenuManager.create(\n\t\t\t'feed-add-post-form-popup42',\n\t\t\tdocument.getElementById('js-post-expire-date-wrapper'),\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: \"feed-add-post-expire-date-options\",\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true\n\t\t\t}\n\t\t);\n\t};\n\n\tcreatePopupItems()\n\t{\n\t\tconst menuPostDurationItems = [];\n\t\tconst selectOptions = document.querySelector(this.selectors.durationOptionsContainer).querySelectorAll(this.selectors.durationOption);\n\n\t\tif (!selectOptions)\n\t\t{\n\t\t\treturn menuPostDurationItems;\n\t\t}\n\n\t\tselectOptions.forEach((element) => {\n\t\t\tmenuPostDurationItems.push({\n\t\t\t\tonclick: this.onPopupItemClick.bind(this),\n\t\t\t\tdataset: {\n\t\t\t\t\tvalue: element.getAttribute('data-value'),\n\t\t\t\t\tclass: element.getAttribute('data-class')\n\t\t\t\t},\n\t\t\t\ttext: element.getAttribute('data-text'),\n\t\t\t\tclassName: `menu-popup-item menu-popup-no-icon ${element.getAttribute('data-class')}`\n\t\t\t});\n\t\t});\n\n\t\treturn menuPostDurationItems;\n\t};\n\n\tonPopupItemClick(event)\n\t{\n\t\tconst element = event.currentTarget;\n\t\tif (element.getAttribute('data-class') === this.customDatePopupOptionClass)\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.add(this.customDateStyleModifier);\n\t\t\tif (this.formDateTimeEditing.value)\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.formDateTimeEditing.value;\n\t\t\t\tthis.customDateSelectedTitle.innerText = this.formDateTimeEditing.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.formUfInputDateCustom.value = this.getCurrentDate();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.postExpireDateBlock.classList.remove(this.customDateStyleModifier);\n\t\t\tthis.formUfInputDateCustom.value = null;\n\t\t}\n\n\t\tthis.popupTrigger.innerText = element.innerText.toLowerCase();\n\t\tthis.formDateDuration.value = element.getAttribute('data-value').toUpperCase();\n\t\tthis.popupShowingPeriods.popupWindow.close();\n\t};\n\n\tonEndDateSet(value)\n\t{\n\t\tif (!value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formDateTimeEditing.value = this.getFormattedDate(value);\n\t\tthis.formUfInputDateCustom.value = this.getFormattedDate(value);\n\t\tthis.customDateSelectedTitle.innerText = this.getFormattedDate(value);\n\t};\n\n\tgetFormattedDate(value)\n\t{\n\t\treturn BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE')), value);\n\t};\n\n\tgetCurrentDate()\n\t{\n\t\treturn this.getFormattedDate(new Date());\n\t};\n\n}","import { Type, Loc, Dom } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { TagSelector } from 'ui.entity-selector';\nimport { EventEmitter } from \"main.core.events\";\nimport 'main.date';\n\nexport default class PostFormGratSelector extends EventEmitter\n{\n\tstatic instance = null;\n\n\tpopupWindow = null;\n\tsendEvent = true;\n\tgratsContentElement = null;\n\titemSelectedImageItem = {};\n\titemSelectedInput = {};\n\tgratsList = {};\n\n\tselector = null;\n\n\tconfig = {\n\t\tfields: {\n\t\t\temployeesValue: {\n\t\t\t\tname: 'GRAT_DEST_DATA',\n\t\t\t},\n\t\t},\n\t};\n\n\tstatic setInstance(instance)\n\t{\n\t\tPostFormGratSelector.instance = instance;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn PostFormGratSelector.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tsuper();\n\t\tthis.init(params);\n\t\tPostFormGratSelector.setInstance(this);\n\t}\n\n\tinit(params)\n\t{\n\t\tif(!params.name)\n\t\t{\n\t\t\tparams.name = 'lm';\n\t\t}\n\n\t\tthis.itemSelectedImageItem[params.name] = params.itemSelectedImageItem;\n\t\tthis.itemSelectedInput[params.name] = params.itemSelectedInput;\n\t\tthis.gratsList[params.name] = params.gratsList;\n\n\t\tthis.itemSelectedImageItem[params.name].addEventListener('click', (e) => {\n\t\t\tthis.openDialog(params.name);\n\t\t\te.preventDefault();\n\t\t});\n\n\t\tthis.createEntitySelector(params.entitySelectorParams);\n\t};\n\n\topenDialog(name): boolean\n\t{\n\t\tif(!name)\n\t\t{\n\t\t\tname = 'lm';\n\t\t}\n\n\t\tif (this.popupWindow != null)\n\t\t{\n\t\t\tthis.popupWindow.close();\n\t\t\treturn false;\n\t\t}\n\n\t\tconst gratItems = [];\n\t\tfor (let i = 0; i < this.gratsList[name].length; i++)\n\t\t{\n\t\t\tgratItems[gratItems.length] = Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: `feed-add-grat-box ${this.gratsList[name][i].style}`\n\t\t\t\t},\n\t\t\t\tattrs: {\n\t\t\t\t\t'data-title': this.gratsList[name][i].title,\n\t\t\t\t\t'data-code': this.gratsList[name][i].code,\n\t\t\t\t\t'data-style': this.gratsList[name][i].style\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\tconst node = e.currentTarget;\n\t\t\t\t\t\tthis.selectItem(name, node.getAttribute('data-code'), node.getAttribute('data-style'), node.getAttribute('data-title'));\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst gratRows = [];\n\t\tlet rownum = 1;\n\n\t\tfor (let i = 0; i < gratItems.length; i++)\n\t\t{\n\t\t\tif (i >= gratItems.length/2)\n\t\t\t{\n\t\t\t\trownum = 2;\n\t\t\t}\n\n\t\t\tif (Type.isNil(gratRows[rownum]))\n\t\t\t{\n\t\t\t\tgratRows[rownum] = Dom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-row'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tgratRows[rownum].appendChild(gratItems[i]);\n\t\t}\n\n\t\tthis.gratsContentElement = Dom.create('div', {\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list-title'\n\t\t\t\t\t},\n\t\t\t\t\thtml: Loc.getMessage('BLOG_GRAT_POPUP_TITLE')\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'feed-add-grat-list'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: gratRows\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tthis.popupWindow = new Popup('BXSocNetGratSelector', document.getElementById('feed-add-post-grat-type-selected'), {\n\t\t\tautoHide: true,\n\t\t\toffsetLeft: 25,\n\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: {\n\t\t\t\ttop: '5px',\n\t\t\t\tright: '10px'\n\t\t\t},\n\t\t\tevents : {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.popupWindow.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy: () => {\n\t\t\t\t\tthis.popupWindow = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontent: this.gratsContentElement,\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t\toffset: 20\n\t\t\t},\n\t\t\tlightShadow: true\n\t\t});\n\t\tthis.popupWindow.setAngle({});\n\t\tthis.popupWindow.show();\n\n\t\treturn true;\n\t};\n\n\tselectItem(name, code, style, title)\n\t{\n\t\tconst gratSpan = this.itemSelectedImageItem[name].querySelector('span');\n\t\tif (gratSpan)\n\t\t{\n\t\t\tgratSpan.className = `feed-add-grat-box ${style}`;\n\t\t}\n\n\t\tthis.itemSelectedImageItem[name].title = title;\n\t\tthis.itemSelectedInput[name].value = code;\n\t\tthis.popupWindow.close();\n\t};\n\n\tcreateEntitySelector(params)\n\t{\n\t\tthis.selector = new TagSelector({\n\n\t\t\tid: params.id,\n\t\t\tdialogOptions: {\n\t\t\t\tid: params.id,\n\t\t\t\tcontext: 'GRATITUDE',\n\t\t\t\tpreselectedItems: (Type.isArray(params.preselectedItems) ? params.preselectedItems : []),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.recalcValue(event.getTarget().getSelectedItems(), params.inputNodeId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\taddButtonCaption: Loc.getMessage('BLOG_GRATMEDAL_1'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('BLOG_GRATMEDAL_1')\n\t\t});\n\n\t\tthis.selector.renderTo(document.getElementById(params.tagNodeId));\n\t\tthis.selector.subscribe('onContainerClick', () => {\n\t\t\tthis.emit('Selector::onContainerClick');\n\t\t});\n\t};\n\n\trecalcValue(selectedItems, inputNodeId): void\n\t{\n\t\tif (\n\t\t\t!Type.isArray(selectedItems)\n\t\t\t|| !document.getElementById(inputNodeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = [];\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tresult.push([ item.entityId, item.id ]);\n\t\t});\n\n\t\tdocument.getElementById(inputNodeId).value = JSON.stringify(result);\n\t};\n}","import { Dom, Type, Uri, ajax, Event, Browser, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostForm from './form';\nimport PostFormTabs from './tabs';\nimport PostFormGratSelector from './grat';\nimport PostFormAutoSave from './autosave';\nimport { Picker } from 'ai.picker';\nimport { FileEvent, Uploader } from 'ui.uploader.core';\n\nexport default class PostFormEditor extends EventEmitter\n{\n\tstatic instance: { [key: string]: any } = {};\n\n\tdisabled: boolean = false;\n\tformParams: {};\n\tformId: string = '';\n\n\tstatic setInstance(id, instance)\n\t{\n\t\tPostFormEditor.instance[id] = instance;\n\t}\n\n\tstatic getInstance(id)\n\t{\n\t\treturn PostFormEditor.instance[id];\n\t}\n\n\tconstructor(formID, params)\n\t{\n\t\tsuper();\n\t\tthis.init(formID, params);\n\t\tPostFormEditor.setInstance(formID, this);\n\n\t\twindow['setBlogPostFormSubmitted'] = this.setBlogPostFormSubmitted.bind(this);\n\t\twindow['submitBlogPostForm'] = this.submitBlogPostForm.bind(this);\n\t}\n\n\tinit(formID, params)\n\t{\n\t\tthis.disabled = false;\n\t\tthis.formId = formID;\n\n\t\tthis.formParams = {\n\t\t\teditorID: params.editorID,\n\t\t\tshowTitle: !!params.showTitle,\n\t\t\tsubmitted: false,\n\t\t\ttext: params.text,\n\t\t\tautoSave: params.autoSave,\n\t\t\thandler: (LHEPostForm && LHEPostForm.getHandler(params.editorID)),\n\t\t\teditor: (LHEPostForm && LHEPostForm.getEditor(params.editorID)),\n\t\t\trestoreAutosave: !!params.restoreAutosave,\n\t\t\tcreatedFromEmail: !!params.createdFromEmail,\n\t\t};\n\n\t\tconst currentUri = new Uri(location.toString());\n\t\tconst getTextFromHash = currentUri.getQueryParam('getTextFromHash') === 'Y';\n\n\t\tif (!Type.isStringFilled(this.formParams.text) && getTextFromHash)\n\t\t{\n\t\t\tthis.formParams.textFromHash = decodeURIComponent(currentUri.getFragment());\n\t\t\thistory.replaceState(null, null, ' ');\n\t\t}\n\n\t\tEventEmitter.subscribe('onInitialized', (event: BaseEvent) => {\n\t\t\tconst [ obj, form ] = event.getData();\n\t\t\tthis.onHandlerInited(obj, form);\n\t\t});\n\t\tif (this.formParams.handler)\n\t\t{\n\t\t\tthis.onHandlerInited(this.formParams.handler, formID);\n\t\t}\n\n\t\tEventEmitter.subscribe('OnEditorInitedAfter', (event: BaseEvent) => {\n\t\t\tconst [ editor ] = event.getData();\n\t\t\tthis.onEditorInited(editor);\n\t\t});\n\n\t\tif (this.formParams.editor)\n\t\t{\n\t\t\tthis.onEditorInited(this.formParams.editor);\n\t\t}\n\n\t\tEventEmitter.subscribe('onSocNetLogMoveBody', (event: BaseEvent) => {\n\t\t\tconst [ p ] = event.getData();\n\t\t\tif (p === 'sonet_log_microblog_container')\n\t\t\t{\n\t\t\t\tthis.reinit();\n\t\t\t}\n\t\t});\n\n\t\tEvent.ready(() => {\n\t\t\tif (\n\t\t\t\tBrowser.isIE()\n\t\t\t\t&& document.getElementById('POST_TITLE')\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst showTitlePlaceholderBlur = () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!node\n\t\t\t\t\t\t|| node.value === node.getAttribute('placeholder')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = node.getAttribute('placeholder');\n\t\t\t\t\t\tnode.classList.remove('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'blur', showTitlePlaceholderBlur);\n\t\t\t\tshowTitlePlaceholderBlur();\n\n\t\t\t\tdocument.getElementById('POST_TITLE').__onchange = (e) => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif (node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (node.className.indexOf('feed-add-post-inp-active') < 0 )\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.classList.add('feed-add-post-inp-active');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'click', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE'), 'keydown', document.getElementById('POST_TITLE').__onchange);\n\t\t\t\tEvent.bind(document.getElementById('POST_TITLE').form, 'submit', () => {\n\t\t\t\t\tconst node = document.getElementById('POST_TITLE');\n\n\t\t\t\t\tif(node.value === node.getAttribute('placeholder'))\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.value = '';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (params.activeTab !== '')\n\t\t\t{\n\t\t\t\tPostFormTabs.getInstance().changePostFormTab(params.activeTab);\n\t\t\t}\n\n\t\t\tPostFormTabs.getInstance().subscribe('changePostFormTab', this.checkHideAlert.bind(this));\n\t\t\tif (PostFormGratSelector.getInstance())\n\t\t\t{\n\t\t\t\tPostFormGratSelector.getInstance().subscribe('Selector::onContainerClick', this.hideAlert.bind(this));\n\t\t\t}\n\t\t});\n\t}\n\n\tshowPanelTitle(show, saveChanges)\n\t{\n\t\tshow = (\n\t\t\tshow === true\n\t\t\t|| show === false\n\t\t\t\t? show\n\t\t\t\t: (\n\t\t\t\t\tdocument.getElementById('blog-title').style.display\n\t\t\t\t\t&& document.getElementById('blog-title').style.display === 'none'\n\t\t\t\t)\n\t\t);\n\n\t\tsaveChanges = (saveChanges !== false);\n\n\t\tconst showTitleValue = this.formParams.showTitle;\n\t\tconst node = document.getElementById(`lhe_button_title_${this.formId}`);\n\t\tconst nodeBlock = document.getElementById(`feed-add-post-block${this.formId}`);\n\t\tconst stv = (document.getElementById('show_title') || {});\n\n\t\tif(show)\n\t\t{\n\t\t\tBX.show(document.getElementById('blog-title'));\n\t\t\tif (document.getElementById('POST_TITLE'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').focus();\n\t\t\t}\n\n\t\t\tthis.formParams.showTitle = true;\n\t\t\tstv.value = 'Y';\n\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.add('feed-add-post-form-btn-active');\n\t\t\t}\n\n\t\t\tif (nodeBlock)\n\t\t\t{\n\t\t\t\tnodeBlock.classList.add('blog-post-edit-open');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.hide(document.getElementById('blog-title'));\n\t\t\tthis.formParams.showTitle = false;\n\t\t\tstv.value = \"N\";\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tnode.classList.remove('feed-add-post-form-btn-active');\n\t\t\t}\n\t\t}\n\n\t\tif (saveChanges)\n\t\t{\n\t\t\tBX.userOptions.save('socialnetwork', 'postEdit', 'showTitle', (this.formParams.showTitle ? 'Y' : 'N'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.formParams.showTitle = showTitleValue;\n\t\t}\n\t}\n\n\tsetBlogPostFormSubmitted(value)\n\t{\n\t\tif (document.getElementById('blog-submit-button-save'))\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.add('ui-btn-clock');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.getElementById('blog-submit-button-save').classList.remove('ui-btn-clock');\n\t\t\t}\n\t\t}\n\n\t\tthis.formParams.submitted = value;\n\t\tthis.disabled = value;\n\t};\n\n\tsubmitBlogPostForm(editor, value)\n\t{\n\t\tif (this.disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isObject(editor))\n\t\t{\n\t\t\tvalue = editor;\n\t\t\teditor = LHEPostForm.getEditor(this.formParams.editorID);\n\t\t}\n\n\t\tif (\n\t\t\teditor\n\t\t\t&& editor.id === this.formParams.editorID\n\t\t)\n\t\t{\n\t\t\tif(this.formParams.submitted)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\teditor.SaveContent();\n\n\t\t\tif(!value)\n\t\t\t{\n\t\t\t\tvalue = 'save';\n\t\t\t}\n\n\t\t\tif(document.getElementById('blog-title').style.display === 'none')\n\t\t\t{\n\t\t\t\tdocument.getElementById('POST_TITLE').value = '';\n\t\t\t}\n\n\t\t\tconst submitButton = this.getSubmitButton({\n\t\t\t\tbuttonType: value,\n\t\t\t});\n\n\t\t\tif (submitButton)\n\t\t\t{\n\t\t\t\tsubmitButton.classList.add('ui-btn-clock');\n\t\t\t\tthis.disabled = true;\n\n\t\t\t\twindow.addEventListener('beforeunload', (event) => { // is called on every sumbit, with or without dialog\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tBX.removeClass(submitButton, 'ui-btn-clock');\n\t\t\t\t\t\tthis.disabled = false;\n\t\t\t\t\t\tthis.formParams.submitted = false;\n\t\t\t\t\t}, 3000); // timeout needed to process a form on a back-end\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet actionUrl = '';\n\t\t\tconst activeTab = PostFormTabs.getInstance().active;\n\n\t\t\tif (Type.isStringFilled(activeTab))\n\t\t\t{\n\t\t\t\tactionUrl = document.getElementById(this.formId).action;\n\t\t\t\tUri.removeParam(actionUrl, [ 'b24statTab' ]);\n\t\t\t\tUri.addParam(actionUrl, {\n\t\t\t\t\tb24statTab: activeTab\n\t\t\t\t});\n\t\t\t\tdocument.getElementById(this.formId).action = actionUrl;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t[\n\t\t\t\t\tPostFormTabs.getInstance().config.id.message,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.file,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.gratitude,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.important,\n\t\t\t\t\tPostFormTabs.getInstance().config.id.vote,\n\t\t\t\t].includes(activeTab)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.checkDestinationValue({\n\t\t\t\t\tbuttonType: value,\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tactiveTab === PostFormTabs.getInstance().config.id.gratitude\n\t\t\t\t&& PostFormGratSelector.getInstance()\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (!this.checkEmployeesValue({\n\t\t\t\t\tbuttonType: value,\n\t\t\t\t}))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(()=> {\n\t\t\t\tBX.submit(document.getElementById(this.formId), value);\n\t\t\t\tthis.formParams.submitted = true;\n\t\t\t}, 100);\n\n\t\t}\n\t};\n\n\tcheckDestinationValue({ buttonType }): boolean\n\t{\n\t\tif (Type.isUndefined(MPFEntitySelector))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst tagSelector = new MPFEntitySelector({\n\t\t\tid: `oPostFormLHE_${this.formId}`,\n\t\t});\n\t\tif (\n\t\t\t!tagSelector\n\t\t\t|| !Type.isArray(tagSelector.tags)\n\t\t\t|| tagSelector.tags.length > 0\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.enableSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tthis.showBottomAlert({\n\t\t\ttext: Loc.getMessage('BLOG_POST_EDIT_T_GRAT_ERROR_NO_DESTINATION'),\n\t\t});\n\n\t\ttagSelector.subscribeOnce('onContainerClick', this.hideAlert);\n\n\t\treturn false;\n\t}\n\n\tcheckEmployeesValue({ buttonType }): boolean\n\t{\n\t\tconst employeesValueNode = document.getElementById(this.formId).elements[PostFormGratSelector.getInstance().config.fields.employeesValue.name];\n\t\tif (\n\t\t\temployeesValueNode\n\t\t\t&& Type.isStringFilled(employeesValueNode.value)\n\t\t\t&& employeesValueNode.value !== '[]'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.enableSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tthis.showBottomAlert({\n\t\t\ttext: Loc.getMessage('BLOG_POST_EDIT_T_GRAT_ERROR_NO_EMPLOYEES'),\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tcheckHideAlert(event) {\n\t\tconst { type } = event.getData();\n\t\tif (type === PostFormTabs.getInstance().config.id.gratitude)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hideAlert();\n\t}\n\n\thideAlert()\n\t{\n\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\tif (!alertNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(alertNode);\n\t}\n\n\tenableSubmitButton({ buttonType })\n\t{\n\t\tconst submitButton = this.getSubmitButton({\n\t\t\tbuttonType,\n\t\t});\n\n\t\tif (submitButton)\n\t\t{\n\t\t\tsubmitButton.classList.remove('ui-btn-clock');\n\t\t\tthis.disabled = false;\n\t\t}\n\t}\n\n\tgetSubmitButton({ buttonType })\n\t{\n\t\tlet result = null;\n\n\t\tif (\n\t\t\tbuttonType === 'save'\n\t\t\t&& document.getElementById('blog-submit-button-save')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-save');\n\t\t}\n\t\telse if (\n\t\t\tbuttonType === 'draft'\n\t\t\t&& document.getElementById('blog-submit-button-draft')\n\t\t)\n\t\t{\n\t\t\tresult = document.getElementById('blog-submit-button-draft');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tshowBottomAlert(params)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(params)\n\t\t\t|| !Type.isStringFilled(params.text)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst alertNode = document.getElementById('feed-add-post-bottom-alertblogPostForm');\n\t\tif (alertNode)\n\t\t{\n\t\t\tDom.clean(alertNode);\n\t\t\talertNode.appendChild(Dom.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'ui-alert ui-alert-danger',\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: 'ui-alert-message',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: params.text,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\t}\n\n\tonHandlerInited(obj, form)\n\t{\n\t\tif (form !== this.formId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.handler = obj;\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnControlClick', () => {\n\t\t\tPostFormTabs.getInstance().changePostFormTab(PostFormTabs.getInstance().config.id.message);\n\t\t});\n\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterShowLHE', this.OnAfterShowLHE.bind(this));\n\t\tEventEmitter.subscribe(obj.eventNode, 'OnAfterHideLHE', this.OnAfterHideLHE.bind(this));\n\n\t\tif (obj.eventNode.style.display == 'none')\n\t\t{\n\t\t\tthis.OnAfterHideLHE();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.OnAfterShowLHE();\n\t\t}\n\t}\n\n\tOnAfterShowLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tdiv[ii].classList.remove('feed-post-form-block-hidden');\n\t\t}\n\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(true, false);\n\t\t}\n\n\t};\n\n\tOnAfterHideLHE()\n\t{\n\t\tconst div = [\n\t\t\tdocument.getElementById('feed-add-post-form-notice-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-buttons-blockblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-bottom-alertblogPostForm'),\n\t\t\tdocument.getElementById('feed-add-post-content-message-add-ins')\n\t\t];\n\n\t\tfor (let ii = 0; ii < div.length; ii++)\n\t\t{\n\t\t\tif (!div[ii])\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tdiv[ii].classList.add('feed-post-form-block-hidden');\n\t\t}\n\n\t\tif(this.formParams.showTitle)\n\t\t{\n\t\t\tthis.showPanelTitle(false, false);\n\t\t}\n\t};\n\n\tonEditorInited(editor)\n\t{\n\t\tif (PostForm.getInstance().initedEditorsList.includes(editor.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (editor.id !== this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.formParams.editor = editor;\n\t\tif (this.formParams.autoSave !== 'N')\n\t\t{\n\t\t\tnew PostFormAutoSave(this.formParams.autoSave, this.formParams.restoreAutosave);\n\t\t}\n\n\t\tconst f = window[editor.id + 'Files'];\n\t\tconst handler = LHEPostForm.getHandler(editor.id);\n\n\t\tlet node = null;\n\t\tlet controller = null;\n\n\t\tfor (let id in handler.controllers)\n\t\t{\n\t\t\tif (!handler.controllers.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\thandler.controllers[id].parser\n\t\t\t\t&& handler.controllers[id].parser.bxTag === 'postimage'\n\t\t\t)\n\t\t\t{\n\t\t\t\tcontroller = handler.controllers[id];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst closure2 = (a, b, c) => { return () => {\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.deleteFile(b, {});\n\t\t\t\tDom.remove(document.getElementById(`wd-doc'${b}`));\n\t\t\t\tajax({ method: 'GET', url: c});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta.deleteFile(b, c, a, { controlID : 'common' });\n\t\t\t}\n\t\t} };\n\n\t\tfor (let intId in f)\n\t\t{\n\t\t\tif (!f.hasOwnProperty(intId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (controller)\n\t\t\t{\n\t\t\t\tcontroller.addFile(f[intId]);\n\t\t\t}\n\n\t\t\tnode = document.getElementById(`wd-doc${intId}`).querySelector('.feed-add-post-del-but');\n\t\t\tif (node)\n\t\t\t{\n\t\t\t\tEvent.bind(node, 'click', closure2(handler, intId, f[intId].del_url));\n\t\t\t\tnode.style.cursor = \"pointer\";\n\t\t\t}\n\t\t}\n\n\t\tPostForm.getInstance().initedEditorsList.push(editor.id);\n\n\t\tEventEmitter.subscribe(editor, 'OnSetViewAfter', () => {\n\t\t\tif (this.formParams.createdFromEmail)\n\t\t\t{\n\t\t\t\tif (editor.GetContent() === '')\n\t\t\t\t{\n\t\t\t\t\teditor.SetContent(`${Loc.getMessage('CREATED_ON_THE_BASIC_OF_THE_MESSAGE')}`);\n\t\t\t\t}\n\t\t\t\teditor.Focus(true);\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(this.formParams.textFromHash))\n\t\t\t{\n\t\t\t\tthis.formParams.text = this.formParams.textFromHash;\n\t\t\t\teditor.action.Exec('insertHTML', this.formParams.textFromHash);\n\t\t\t}\n\t\t});\n\t}\n\n\treinit()\n\t{\n\t\tif (!this.formParams.editorID)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isFunction(this.formParams.editor))\n\t\t{\n\t\t\tthis.formParams.editor(this.formParams.text);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(this.reinit, 50);\n\t\t}\n\t}\n}\n","import { Event, Type, Dom, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport PostFormEditor from './editor';\n\nexport default class PostFormAutoSave\n{\n\tconstructor(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tthis.init(autoSaveRestoreMethod, initRestore);\n\t}\n\n\tinit(autoSaveRestoreMethod, initRestore)\n\t{\n\t\tconst formId = 'blogPostForm';\n\t\tconst form = document.getElementById(formId);\n\t\tconst titleID = 'POST_TITLE';\n\t\tconst title = document.getElementById(titleID);\n\t\tconst tags = form.TAGS;\n\n\t\tif (!form)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tinitRestore = (!Type.isUndefined(initRestore) ? !!initRestore : true);\n\n\t\tEventEmitter.subscribe(form, 'onAutoSavePrepare', (event: BaseEvent) => {\n\t\t\tconst [ ob, handler ] = event.getData();\n\n\t\t\tob.DISABLE_STANDARD_NOTIFY = true;\n\t\t\tconst _ob = ob;\n\t\t\tsetTimeout(() => { this.bindLHEEvents(_ob) }, 100);\n\t\t});\n\n\t\tEventEmitter.subscribe(form, 'onAutoSave', (event: BaseEvent) => {\n\t\t\tconst [ ob, formData ] = event.getData();\n\n\t\t\tformData.TAGS = tags.value;\n\t\t\tdelete formData.POST_MESSAGE;\n\t\t});\n\n\t\tif (autoSaveRestoreMethod == 'Y')\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tob.Restore();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestoreFound', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\tlet text = data[`text${formId}`];\n\t\t\t\ttext = (Type.isStringFilled(text) ? text.trim() : '');\n\n\t\t\t\tlet title = data[titleID];\n\t\t\t\ttitle = (Type.isStringFilled(title) ? title.trim() : '');\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(text)\n\t\t\t\t\t&& !Type.isStringFilled(title)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst messageBody = document.getElementById('microoPostFormLHE_blogPostForm');\n\t\t\t\tconst textNode = Dom.create('DIV', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'feed-add-successfully'\n\t\t\t\t\t},\n\t\t\t\t\tchildren : [\n\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName : 'feed-add-info-icon'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tDom.create('A', {\n\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\tclassName: 'feed-add-info-text',\n\t\t\t\t\t\t\t\thref : '#'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick : () => {\n\t\t\t\t\t\t\t\t\tob.Restore();\n\t\t\t\t\t\t\t\t\ttextNode.parentNode.removeChild(textNode);\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: Loc.getMessage('BLOG_POST_AUTOSAVE2')\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t});\n\n\t\t\t\tif (messageBody)\n\t\t\t\t{\n\t\t\t\t\tmessageBody.parentNode.insertBefore(textNode, messageBody);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (initRestore)\n\t\t{\n\t\t\tEventEmitter.subscribe(form, 'onAutoSaveRestore', (event: BaseEvent) => {\n\t\t\t\tconst [ ob, data ] = event.getData();\n\n\t\t\t\ttitle.value = data[titleID];\n\t\t\t\tif(\n\t\t\t\t\tType.isStringFilled(data[titleID])\n\t\t\t\t\t&& data[titleID] !== title.getAttribute('placeholder')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif(document.getElementById('divoPostFormLHE_blogPostForm').style.display !== 'none')\n\t\t\t\t\t{\n\t\t\t\t\t\tPostFormEditor.getInstance(formId).showPanelTitle(true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.bShowTitle = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isFunction(title.__onchange))\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle.__onchange();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst formTags = window[`BXPostFormTags_${formId}`];\n\n\t\t\t\tif(\n\t\t\t\t\tdata.TAGS.length > 0\n\t\t\t\t\t&& formTags\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst tags = formTags.addTag(data.TAGS);\n\t\t\t\t\tif (tags.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.show(formTags.tagsArea);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit('onAutoSaveRestoreDestination', new BaseEvent({\n\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\tformId: formId,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}]\n\t\t\t\t}));\n\n\t\t\t\tthis.bindLHEEvents(ob);\n\t\t\t});\n\t\t}\n\t};\n\n\tbindLHEEvents(_ob)\n\t{\n\t\tconst form = document.getElementById('blogPostForm');\n\t\tconst title = document.getElementById('POST_TITLE');\n\t\tconst tags = form.TAGS;\n\n\t\tEvent.bind(title, 'keydown', _ob.Init.bind(_ob));\n\t\tEvent.bind(tags, 'keydown', _ob.Init.bind(_ob));\n\t};\n}"],"names":["AjaxProcessor","block","callback","Type","isArray","CSS","length","BX","load","JS","container","callbackExternal","appendChild","create","html","CONTENT","htmlWasInserted","scriptsLoaded","processInlineJS","ajax","processRequestData","scriptsRunFirst","dataType","PostForm","instance","params","init","setInstance","key","value","isStringFilled","options","startVideoRecorder","setTimeout","editorForm","document","getElementById","EventEmitter","emit","BaseEvent","compatData","VideoRecorder","start","sliderInstance","SidePanel","Instance","getTopSlider","postMessageAll","window","sliderData","getData","inited","lazyLoad","isUndefined","ajaxUrl","isDomNode","containerMicro","containerMicroInner","successPostId","parseInt","setAttribute","timerListenEnter","stopListenEnter","event","clearTimeout","stopPropagation","preventDefault","fireDragEnter","click","startListenEnter","addEventListener","postMessage","originatorSliderId","get","close","subscribe","onSliderClose","set","clickDisabled","loaded","animationStartHeight","offsetHeight","loaderType","showWaitTab","style","display","showWait","Ajax","method","url","data","action","sessid","Loc","getMessage","onsuccess","result","closeWait","success","processAjaxBlock","PROPS","onfailure","isFunction","processor","processCSS","processAjaxBlockInsertHTML","processExternalJS","node","waiterNode","bxmsg","body","Dom","props","id","className","adjustWait","lastWait","push","parentNode","i","len","util","deleteFromArray","removeChild","clean","remove","nodePosition","pos","topDelta","top","GetDocElement","scrollTop","right","left","width","offsetWidth","taskId","Reflection","getClass","taskLink","replace","UI","Notification","Center","notify","content","actions","title","events","balloon","open","PostFormTabs","message","task","calendar","file","gratitude","important","vote","more","listItem","setEventNamespace","tabsInstance","SBPETabs","tabContainer","arrow","tabs","bodies","tabsList","querySelectorAll","getAttribute","limited","menuItems","tabId","text","onclick","createOnClick","config","ii","hasOwnProperty","previousTab","uploadFileNode","Event","bind","form","changePostFormTab","type","name","btn","btnText","innerHTML","evalGlobal","menu","popupWindow","iblock","setActive","isNull","active","needAnimation","isTaskTabLoaded","startAnimation","classList","jj","adjust","tabPosTab","bottom","leftStart","widthStart","easing","duration","finish","transition","makeEaseInOut","transitions","quart","step","state","complete","add","animate","hasValuesFile","hasValuesDocs","messageBody","childNodes","nodeFile","values1","querySelector","values2","rows","indexOf","UserFieldControl","nodeDocs","webdavValues","userFieldControl","getById","uploader","getUploader","getFiles","contains","SBPEBinded","eventNode","wdObj","dialogName","urlUpload","agent","uploadFileUrl","controllerInit","endAnimation","restoreMoreMenu","contentContainer","children","postEditSlider","currentSlider","getSliderByWindow","match","formInstance","getInstance","getEvent","animation","stop","height","overflowY","position","opacity","offsetTop","makeEaseOut","cssText","MenuManager","closeByEsc","offsetLeft","angle","show","itemCnt","componentParameters","GROUP_ID","PATH_TO_USER_TASKS","PATH_TO_USER_TASKS_TASK","PATH_TO_GROUP_TASKS","PATH_TO_GROUP_TASKS_TASK","PATH_TO_USER_PROFILE","PATH_TO_GROUP","PATH_TO_USER_TASKS_PROJECTS_OVERVIEW","PATH_TO_USER_TASKS_TEMPLATES","PATH_TO_USER_TEMPLATES_TEMPLATE","ENABLE_FOOTER","TEMPLATE_CONTROLLER_ID","ENABLE_FORM","BACKURL","runComponentAction","mode","parameters","COMPONENT_PARAMETERS","analytics","tool","category","c_section","c_element","then","response","Runtime","errors","forEach","error","Error","join","tabsDefault","menuItemsListsDefault","menuItemsLists","canOpenInSlider","getMenuItems","createOnclickLists","getMenuItemsDefault","concat","showMoreMenuLists","siteId","bitrix_processes","Text","toBoolean","k","lists","attrs","NAME","PICTURE","DESCRIPTION","PICTURE_SMALL","CODE","iblockId","ID","iblockTypeId","IBLOCK_TYPE_ID","permissions","admin","htmlspecialchars","menuBindElement","listsMenu","spanIcon","spanDataPicture","spanDataPictureDefault","Array","from","isShown","loadExtension","sendData","CreationGuide","iBlockTypeId","iBlockId","toInteger","analyticsSection","analyticsP1","onClose","Livefeed","PageInstance","refresh","location","reload","PostFormDateEnd","postExpireDateBlock","postEndTime","postEditingEndTime","postEndPeriod","popupTrigger","customDateFinal","durationOptionsContainer","durationOption","isInitialized","addEventHandlers","formDateTimeEditing","customDateSelectedTitle","innerText","getCurrentDate","selectors","formUfInputDateCustom","formDateDuration","showPostEndPeriodsPopup","curDate","Date","curTimestamp","Math","round","getTimezoneOffset","parseDate","date","convertToUTC","bTime","callback_after","onEndDateSet","popupShowingPeriods","createPopupShowingPeriods","createPopupItems","menuPostDurationItems","selectOptions","element","onPopupItemClick","dataset","currentTarget","customDatePopupOptionClass","customDateStyleModifier","toLowerCase","toUpperCase","getFormattedDate","format","convertBitrixFormat","PostFormGratSelector","fields","employeesValue","itemSelectedImageItem","itemSelectedInput","gratsList","e","openDialog","createEntitySelector","entitySelectorParams","gratItems","code","selectItem","gratRows","rownum","isNil","gratsContentElement","Popup","autoHide","bindOptions","forceBindPosition","closeIcon","onPopupClose","destroy","onPopupDestroy","offset","lightShadow","setAngle","gratSpan","selector","TagSelector","dialogOptions","context","preselectedItems","recalcValue","getTarget","getSelectedItems","inputNodeId","entities","emailUsers","inviteEmployeeLink","intranetUsersOnly","selectMode","addButtonCaption","addButtonCaptionMore","renderTo","tagNodeId","selectedItems","item","entityId","JSON","stringify","PostFormEditor","formID","setBlogPostFormSubmitted","submitBlogPostForm","disabled","formId","formParams","editorID","showTitle","submitted","autoSave","handler","LHEPostForm","getHandler","editor","getEditor","restoreAutosave","createdFromEmail","currentUri","Uri","toString","getTextFromHash","getQueryParam","textFromHash","decodeURIComponent","getFragment","history","replaceState","obj","onHandlerInited","onEditorInited","p","reinit","ready","Browser","isIE","showTitlePlaceholderBlur","__onchange","activeTab","checkHideAlert","hideAlert","saveChanges","showTitleValue","nodeBlock","stv","focus","hide","userOptions","save","isObject","SaveContent","submitButton","getSubmitButton","buttonType","removeClass","actionUrl","removeParam","addParam","b24statTab","includes","checkDestinationValue","checkEmployeesValue","submit","MPFEntitySelector","tagSelector","tags","enableSubmitButton","showBottomAlert","subscribeOnce","employeesValueNode","elements","alertNode","isPlainObject","OnAfterShowLHE","OnAfterHideLHE","div","showPanelTitle","initedEditorsList","PostFormAutoSave","f","controller","controllers","parser","bxTag","closure2","a","b","c","deleteFile","controlID","intId","addFile","del_url","cursor","GetContent","SetContent","Focus","Exec","autoSaveRestoreMethod","initRestore","titleID","TAGS","ob","DISABLE_STANDARD_NOTIFY","_ob","bindLHEEvents","formData","POST_MESSAGE","trim","Restore","textNode","href","insertBefore","bShowTitle","formTags","addTag","tagsArea","Init"],"mappings":"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"}