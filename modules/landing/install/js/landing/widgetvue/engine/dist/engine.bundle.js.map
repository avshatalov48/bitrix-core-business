{"version":3,"file":"engine.bundle.js","sources":["../src/components/content.js","../src/components/message.js","../src/components/error.js","../src/engine.js"],"sourcesContent":["import { ref } from 'ui.vue3';\nimport { Type, Loc } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nconst fetchAlarmTime = 5000;\n\nexport const Content = {\n\tprops: {\n\t\tdefaultData: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t\tclickable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisFetching: false,\n\t\t\ttimeout: null,\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe('landing:widgetvue:engine:onSetData', this.onSetData);\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('landing:widgetvue:engine:onSetData', this.onSetData);\n\t},\n\n\tmethods: {\n\t\tonSetData(event: BaseEvent)\n\t\t{\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:engine:endContentLoad');\n\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:engine:onHideMessage');\n\t\t\tthis.isFetching = false;\n\n\t\t\tif (Type.isObject(event.getData().data))\n\t\t\t{\n\t\t\t\tconst data = event.getData().data;\n\t\t\t\tObject.keys(data).forEach(code => {\n\t\t\t\t\tif (this[code] !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis[code] = data[code];\n\t\t\t\t\t}\n\t\t\t\t\t// todo: and crete refs if not exists?\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tfetch(params: {} = {})\n\t\t{\n\t\t\tif (!this.clickable || this.isFetching)\n\t\t\t{\n\t\t\t\tconsole.info('Events is disabled now');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFetching = true;\n\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:engine:startContentLoad');\n\n\t\t\tthis.timeout = setTimeout(() => {\n\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:engine:onMessage', {\n\t\t\t\t\tmessage: Loc.getMessage('LANDING_WIDGETVUE_LOADER_TOO_LONG'),\n\t\t\t\t});\n\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:engine:endContentLoad');\n\t\t\t}, fetchAlarmTime);\n\n\t\t\tthis.$bitrix.Application.get().fetch(params);\n\t\t},\n\n\t\topenApplication(params: {} = {})\n\t\t{\n\t\t\tif (!this.clickable)\n\t\t\t{\n\t\t\t\tconsole.info('Events is disabled now');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$bitrix.Application.get().openApplication(params);\n\t\t},\n\n\t\topenPath(path: string)\n\t\t{\n\t\t\tif (!this.clickable)\n\t\t\t{\n\t\t\t\tconsole.info('Events is disabled now');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$bitrix.Application.get().openPath(path);\n\t\t},\n\t},\n\n\tsetup(props)\n\t{\n\t\t// todo: to docs. All refs must be implicated in default? or we can create, but v-for can be broken\n\n\t\t// todo: or create refs via data? or pass when create\n\t\tconst dataRefs = {};\n\t\tif (Type.isObject(props.defaultData))\n\t\t{\n\t\t\tObject.keys(props.defaultData).forEach(code => {\n\t\t\t\tdataRefs[code] = ref(props.defaultData[code]);\n\t\t\t});\n\t\t}\n\n\t\treturn dataRefs;\n\t},\n};\n","import { Loc } from 'main.core';\nimport LoaderImage from '../images/emptystate.svg';\n\nexport const Message = {\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_LOADER_DEFAULT_MESSAGE'),\n\t\t},\n\t\tlink: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tlinkText: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT'),\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"w-loader\">\n\t\t\t<div class=\"w-loader-icon\"></div>\n\t\t\t<div class=\"w-loader-text\">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const Error = {\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_MESSAGE'),\n\t\t},\n\t\tlink: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tlinkText: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT'),\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"w-error\">\n\t\t\t<div class=\"w-loader-icon --error\"></div>\n\t\t\t<div class=\"w-error-text\">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t\t<a\n\t\t\t\t\tv-show=\"link !== null\"\n\t\t\t\t\tclass=\"w-loader-link\" :href=\"link\"\n\t\t\t\t>\n\t\t\t        {{linkText}}\n\t\t\t\t</a>\t\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { Type, Runtime, Event as CoreEvent, Dom } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Loader } from 'main.loader';\n\nimport { Content } from './components/content';\nimport { Message } from './components/message';\nimport { Error } from './components/error';\nimport { EngineOptions } from './internal/types';\n\nimport './css/style.css';\n\nexport class Engine\n{\n\t#parentOrigin: ?string = '';\n\t#id: string = '';\n\n\t#rootNode: ?HTMLElement;\n\t#data: ?{};\n\t#error: ?string;\n\n\t#clickable: boolean = false;\n\n\t#application: VueCreateAppResult;\n\t#contentComponent: Object;\n\n\tconstructor(options: EngineOptions): void\n\t{\n\t\tthis.#id = Type.isString(options.id) ? options.id : '';\n\t\tthis.#rootNode = document.querySelector(`#${this.#id}`);\n\t\tthis.#parentOrigin = Type.isString(options.origin) ? options.origin : null;\n\n\t\tthis.#data = Type.isObject(options.data) ? options.data : null;\n\t\tthis.#error = Type.isString(options.error) ? options.error : null;\n\n\t\tthis.#clickable = Type.isBoolean(options.clickable) ? options.clickable : false;\n\n\t\tthis.#contentComponent = Runtime.clone(Content);\n\t}\n\n\trender()\n\t{\n\t\tif (this.#rootNode)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.#rootNode,\n\t\t\t});\n\n\t\t\tthis.#contentComponent.template = this.#rootNode.innerHTML || '';\n\t\t\tthis.#contentComponent.template = `<div>${this.#contentComponent.template}</div>`;\n\t\t\tthis.#bindEvents();\n\t\t\tthis.#createApp();\n\t\t}\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.loader.show();\n\t}\n\n\thideLoader()\n\t{\n\t\tthis.loader.hide();\n\t}\n\n\tfetch(params: {} = {})\n\t{\n\t\tif (params instanceof Event)\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tthis.#message(\n\t\t\t'fetchData',\n\t\t\tparams,\n\t\t);\n\t}\n\n\topenApplication(params: {} = {})\n\t{\n\t\tthis.#message(\n\t\t\t'openApplication',\n\t\t\tparams,\n\t\t);\n\t}\n\n\topenPath(path: string)\n\t{\n\t\tthis.#message(\n\t\t\t'openPath',\n\t\t\t{ path },\n\t\t);\n\t}\n\n\t#message(name: string, params: {} = {})\n\t{\n\t\twindow.parent.postMessage(\n\t\t\t{\n\t\t\t\tname,\n\t\t\t\tparams,\n\t\t\t\torigin: this.#id,\n\t\t\t},\n\t\t\tthis.#parentOrigin,\n\t\t);\n\t}\n\n\t#bindEvents() {\n\t\tCoreEvent.bind(window, 'message', this.#onMessage.bind(this));\n\t}\n\n\t#onMessage(event)\n\t{\n\t\tif (\n\t\t\tevent.data\n\t\t\t&& event.data.origin\n\t\t\t&& event.data.name\n\t\t\t&& event.data.params\n\t\t\t&& Type.isObject(event.data.params)\n\t\t)\n\t\t{\n\t\t\tif (event.data.origin !== this.#id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.data.name === 'setData'\n\t\t\t\t&& Type.isObject(event.data.params.data)\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('landing:widgetvue:engine:onSetData', {\n\t\t\t\t\tdata: event.data.params.data,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.data.name === 'setError'\n\t\t\t\t&& Type.isObject(event.data.params.error)\n\t\t\t\t&& Type.isString(event.data.params.error.message)\n\t\t\t)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('landing:widgetvue:engine:onError', {\n\t\t\t\t\tmessage: event.data.params.error.message,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (event.data.name === 'getSize')\n\t\t\t{\n\t\t\t\t// do nothing, just for refreshFrameSize\n\t\t\t}\n\n\t\t\tthis.#refreshFrameSize();\n\t\t}\n\t}\n\n\t#refreshFrameSize()\n\t{\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.#message(\n\t\t\t\t'setSize',\n\t\t\t\t{\n\t\t\t\t\tsize: this.#rootNode.offsetHeight,\n\t\t\t\t},\n\t\t\t);\n\t\t});\n\t}\n\n\t#createApp(): void\n\t{\n\t\tconst context = this;\n\t\tconst defaultError = this.#error ? { message: this.#error } : null;\n\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tname: this.#id,\n\n\t\t\tcomponents: {\n\t\t\t\tMessage, Error, Content: this.#contentComponent,\n\t\t\t},\n\n\t\t\tprops: {\n\t\t\t\tdefaultData: {\n\t\t\t\t\ttype: Object, default: null,\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tdata()\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tmessage: null,\n\t\t\t\t\terror: defaultError,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tcreated()\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:engine:startContentLoad', this.onShowLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:engine:endContentLoad', this.onHideLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:engine:onMessage', this.onShowMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:engine:onHideMessage', this.onHideMessage);\n\t\t\t\tEventEmitter.subscribe('landing:widgetvue:engine:onError', this.onShowError);\n\t\t\t},\n\n\t\t\tmounted()\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.get().#refreshFrameSize();\n\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tconst links = this.$el.getElementsByTagName('a');\n\t\t\t\t\tif (links.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t[].slice.call(links).map(link => {\n\t\t\t\t\t\t\tCoreEvent.bind(link, 'click', event => {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tbeforeUnmount()\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:engine:startContentLoad', this.onShowLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:engine:endContentLoad', this.onHideLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:engine:onMessage', this.onShowMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:engine:onHideMessage', this.onHideMessage);\n\t\t\t\tEventEmitter.unsubscribe('landing:widgetvue:engine:onError', this.onShowError);\n\t\t\t},\n\n\t\t\tmethods: {\n\t\t\t\tonShowLoader()\n\t\t\t\t{\n\t\t\t\t\t// todo: move loader to comp\n\t\t\t\t\tthis.$bitrix.Application.get().showLoader();\n\t\t\t\t},\n\n\t\t\t\tonHideLoader()\n\t\t\t\t{\n\t\t\t\t\t// todo: move loader to comp\n\t\t\t\t\tthis.$bitrix.Application.get().hideLoader();\n\t\t\t\t},\n\n\t\t\t\tonShowMessage(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\tconst message = event.getData()?.message || null;\n\t\t\t\t\tthis.message = message ? { message } : null;\n\t\t\t\t},\n\n\t\t\t\tonHideMessage()\n\t\t\t\t{\n\t\t\t\t\tthis.message = null;\n\t\t\t\t},\n\n\t\t\t\tonShowError(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\t// todo: set error link?\n\t\t\t\t\tconst message = event.getData()?.message || null;\n\t\t\t\t\tthis.error = message ? { message } : null;\n\n\t\t\t\t\tthis.onHideLoader();\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tbeforeCreate(): void\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.set(context);\n\t\t\t},\n\n\t\t\ttemplate: `\n\t\t\t\t<div class=\"widget\">\n\t\t\t\t\t<Error\n\t\t\t\t\t\tv-show=\"error !== null\"\n\t\t\t\t\t\tv-bind=\"error && error.message !== null ? error : {}\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Message\n\t\t\t\t\t\tv-show=\"message !== null\"\n\t\t\t\t\t\tv-bind=\"message && message.message !== null ? message : {}\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Content\n\t\t\t\t\t\tv-show=\"message === null && error === null\"\n\t\t\t\t\t\t\n\t\t\t\t\t\t:defaultData=\"defaultData\"\n\t\t\t\t\t\t:clickable=${this.#clickable}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t}, {\n\t\t\tdefaultData: this.#data,\n\t\t});\n\n\t\tthis.#application.mount(this.#rootNode);\n\t}\n}\n"],"names":["fetchAlarmTime","Content","props","defaultData","type","Object","default","clickable","Boolean","data","isFetching","timeout","created","EventEmitter","subscribe","onSetData","beforeUnmount","unsubscribe","methods","event","clearTimeout","$bitrix","eventEmitter","emit","Type","isObject","getData","keys","forEach","code","undefined","fetch","params","console","info","setTimeout","message","Loc","getMessage","Application","get","openApplication","openPath","path","setup","dataRefs","ref","Message","String","link","linkText","template","Error","Engine","constructor","options","isString","id","document","querySelector","origin","error","isBoolean","Runtime","clone","render","loader","Loader","target","innerHTML","showLoader","show","hideLoader","hide","Event","name","window","parent","postMessage","CoreEvent","bind","requestAnimationFrame","size","offsetHeight","context","defaultError","BitrixVue","createApp","components","onShowLoader","onHideLoader","onShowMessage","onHideMessage","onShowError","mounted","$nextTick","links","$el","getElementsByTagName","length","slice","call","map","preventDefault","stopPropagation","beforeCreate","set","mount"],"mappings":";;;;;;CAIA,MAAMA,cAAc,GAAG,IAAI;AAE3B,CAAO,MAAMC,OAAO,GAAG;GACtBC,KAAK,EAAE;KACNC,WAAW,EAAE;OACZC,IAAI,EAAEC,MAAM;OACZC,OAAO,EAAE;MACT;KACDC,SAAS,EAAE;OACVH,IAAI,EAAEI,OAAO;OACbF,OAAO,EAAE;;IAEV;GAEDG,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE,KAAK;OACjBC,OAAO,EAAE;MACT;IACD;GAEDC,OAAO,GACP;KACCC,6BAAY,CAACC,SAAS,CAAC,oCAAoC,EAAE,IAAI,CAACC,SAAS,CAAC;IAC5E;GAEDC,aAAa,GACb;KACCH,6BAAY,CAACI,WAAW,CAAC,oCAAoC,EAAE,IAAI,CAACF,SAAS,CAAC;IAC9E;GAEDG,OAAO,EAAE;KACRH,SAAS,CAACI,KAAgB,EAC1B;OACCC,YAAY,CAAC,IAAI,CAACT,OAAO,CAAC;OAC1B,IAAI,CAACU,OAAO,CAACC,YAAY,CAACC,IAAI,CAAC,yCAAyC,CAAC;OACzE,IAAI,CAACF,OAAO,CAACC,YAAY,CAACC,IAAI,CAAC,wCAAwC,CAAC;OACxE,IAAI,CAACb,UAAU,GAAG,KAAK;OAEvB,IAAIc,cAAI,CAACC,QAAQ,CAACN,KAAK,CAACO,OAAO,EAAE,CAACjB,IAAI,CAAC,EACvC;SACC,MAAMA,IAAI,GAAGU,KAAK,CAACO,OAAO,EAAE,CAACjB,IAAI;SACjCJ,MAAM,CAACsB,IAAI,CAAClB,IAAI,CAAC,CAACmB,OAAO,CAACC,IAAI,IAAI;WACjC,IAAI,IAAI,CAACA,IAAI,CAAC,KAAKC,SAAS,EAC5B;aACC,IAAI,CAACD,IAAI,CAAC,GAAGpB,IAAI,CAACoB,IAAI,CAAC;;;UAGxB,CAAC;;MAEH;;KAEDE,KAAK,CAACC,MAAU,GAAG,EAAE,EACrB;OACC,IAAI,CAAC,IAAI,CAACzB,SAAS,IAAI,IAAI,CAACG,UAAU,EACtC;SACCuB,OAAO,CAACC,IAAI,CAAC,wBAAwB,CAAC;SAEtC;;OAGD,IAAI,CAACxB,UAAU,GAAG,IAAI;OACtB,IAAI,CAACW,OAAO,CAACC,YAAY,CAACC,IAAI,CAAC,2CAA2C,CAAC;OAE3E,IAAI,CAACZ,OAAO,GAAGwB,UAAU,CAAC,MAAM;SAC/B,IAAI,CAACd,OAAO,CAACC,YAAY,CAACC,IAAI,CAAC,oCAAoC,EAAE;WACpEa,OAAO,EAAEC,aAAG,CAACC,UAAU,CAAC,mCAAmC;UAC3D,CAAC;SACF,IAAI,CAACjB,OAAO,CAACC,YAAY,CAACC,IAAI,CAAC,yCAAyC,CAAC;QACzE,EAAEvB,cAAc,CAAC;OAElB,IAAI,CAACqB,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE,CAACT,KAAK,CAACC,MAAM,CAAC;MAC5C;KAEDS,eAAe,CAACT,MAAU,GAAG,EAAE,EAC/B;OACC,IAAI,CAAC,IAAI,CAACzB,SAAS,EACnB;SACC0B,OAAO,CAACC,IAAI,CAAC,wBAAwB,CAAC;SAEtC;;OAGD,IAAI,CAACb,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE,CAACC,eAAe,CAACT,MAAM,CAAC;MACtD;KAEDU,QAAQ,CAACC,IAAY,EACrB;OACC,IAAI,CAAC,IAAI,CAACpC,SAAS,EACnB;SACC0B,OAAO,CAACC,IAAI,CAAC,wBAAwB,CAAC;SAEtC;;OAGD,IAAI,CAACb,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE,CAACE,QAAQ,CAACC,IAAI,CAAC;;IAE9C;GAEDC,KAAK,CAAC1C,KAAK,EACX;;;;KAIC,MAAM2C,QAAQ,GAAG,EAAE;KACnB,IAAIrB,cAAI,CAACC,QAAQ,CAACvB,KAAK,CAACC,WAAW,CAAC,EACpC;OACCE,MAAM,CAACsB,IAAI,CAACzB,KAAK,CAACC,WAAW,CAAC,CAACyB,OAAO,CAACC,IAAI,IAAI;SAC9CgB,QAAQ,CAAChB,IAAI,CAAC,GAAGiB,WAAG,CAAC5C,KAAK,CAACC,WAAW,CAAC0B,IAAI,CAAC,CAAC;QAC7C,CAAC;;KAGH,OAAOgB,QAAQ;;CAEjB,CAAC;;CCpHM,MAAME,OAAO,GAAG;GACtB7C,KAAK,EAAE;KACNkC,OAAO,EAAE;OACRhC,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE+B,aAAG,CAACC,UAAU,CAAC,0CAA0C;MAClE;KACDW,IAAI,EAAE;OACL7C,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE;MACT;KACD4C,QAAQ,EAAE;OACT9C,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE+B,aAAG,CAACC,UAAU,CAAC,2CAA2C;;IAEpE;GAEDa,QAAQ,EAAG;;;;;;;;CAQZ,CAAC;;CCzBM,MAAMC,KAAK,GAAG;GACpBlD,KAAK,EAAE;KACNkC,OAAO,EAAE;OACRhC,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE+B,aAAG,CAACC,UAAU,CAAC,yCAAyC;MACjE;KACDW,IAAI,EAAE;OACL7C,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE;MACT;KACD4C,QAAQ,EAAE;OACT9C,IAAI,EAAE4C,MAAM;OACZ1C,OAAO,EAAE+B,aAAG,CAACC,UAAU,CAAC,2CAA2C;;IAEpE;GAEDa,QAAQ,EAAG;;;;;;;;;;;;;;CAcZ,CAAC;;CCtBwB;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAEzB,CAAO,MAAME,MAAM,CACnB;GAaCC,WAAW,CAACC,OAAsB,EAClC;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OAbyB;;KAAE;OAAA;OAAA,OACb;;KAAE;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAMM;;KAAK;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAO1B,4CAAI,cAAO/B,cAAI,CAACgC,QAAQ,CAACD,OAAO,CAACE,EAAE,CAAC,GAAGF,OAAO,CAACE,EAAE,GAAG,EAAE;KACtD,4CAAI,0BAAaC,QAAQ,CAACC,aAAa,CAAE,IAAC,wCAAE,IAAI,WAAK,EAAC,CAAC;KACvD,4CAAI,kCAAiBnC,cAAI,CAACgC,QAAQ,CAACD,OAAO,CAACK,MAAM,CAAC,GAAGL,OAAO,CAACK,MAAM,GAAG,IAAI;KAE1E,4CAAI,kBAASpC,cAAI,CAACC,QAAQ,CAAC8B,OAAO,CAAC9C,IAAI,CAAC,GAAG8C,OAAO,CAAC9C,IAAI,GAAG,IAAI;KAC9D,4CAAI,oBAAUe,cAAI,CAACgC,QAAQ,CAACD,OAAO,CAACM,KAAK,CAAC,GAAGN,OAAO,CAACM,KAAK,GAAG,IAAI;KAEjE,4CAAI,4BAAcrC,cAAI,CAACsC,SAAS,CAACP,OAAO,CAAChD,SAAS,CAAC,GAAGgD,OAAO,CAAChD,SAAS,GAAG,KAAK;KAE/E,4CAAI,0CAAqBwD,iBAAO,CAACC,KAAK,CAAC/D,OAAO,CAAC;;GAGhDgE,MAAM,GACN;KACC,4CAAI,IAAI,yBACR;OACC,IAAI,CAACC,MAAM,GAAG,IAAIC,kBAAM,CAAC;SACxBC,MAAM,0CAAE,IAAI;QACZ,CAAC;OAEF,4CAAI,wCAAmBjB,QAAQ,GAAG,4CAAI,wBAAWkB,SAAS,IAAI,EAAE;OAChE,4CAAI,wCAAmBlB,QAAQ,GAAI,QAAO,4CAAI,wCAAmBA,QAAS,QAAO;OACjF,4CAAI;OACJ,4CAAI;;;GAINmB,UAAU,GACV;KACC,IAAI,CAACJ,MAAM,CAACK,IAAI,EAAE;;GAGnBC,UAAU,GACV;KACC,IAAI,CAACN,MAAM,CAACO,IAAI,EAAE;;GAGnB1C,KAAK,CAACC,MAAU,GAAG,EAAE,EACrB;KACC,IAAIA,MAAM,YAAY0C,KAAK,EAC3B;OACC1C,MAAM,GAAG,EAAE;;KAGZ,4CAAI,sBACH,WAAW,EACXA,MAAM;;GAIRS,eAAe,CAACT,MAAU,GAAG,EAAE,EAC/B;KACC,4CAAI,sBACH,iBAAiB,EACjBA,MAAM;;GAIRU,QAAQ,CAACC,IAAY,EACrB;KACC,4CAAI,sBACH,UAAU,EACV;OAAEA;MAAM;;CA0MX;CAAC,mBAtMSgC,IAAY,EAAE3C,MAAU,GAAG,EAAE,EACtC;GACC4C,MAAM,CAACC,MAAM,CAACC,WAAW,CACxB;KACCH,IAAI;KACJ3C,MAAM;KACN4B,MAAM,0CAAE,IAAI;IACZ,0CACD,IAAI,gCACJ;CACF;CAAC,wBAEa;GACbmB,eAAS,CAACC,IAAI,CAACJ,MAAM,EAAE,SAAS,EAAE,4CAAI,0BAAYI,IAAI,CAAC,IAAI,CAAC,CAAC;CAC9D;CAAC,qBAEU7D,KAAK,EAChB;GACC,IACCA,KAAK,CAACV,IAAI,IACPU,KAAK,CAACV,IAAI,CAACmD,MAAM,IACjBzC,KAAK,CAACV,IAAI,CAACkE,IAAI,IACfxD,KAAK,CAACV,IAAI,CAACuB,MAAM,IACjBR,cAAI,CAACC,QAAQ,CAACN,KAAK,CAACV,IAAI,CAACuB,MAAM,CAAC,EAEpC;KACC,IAAIb,KAAK,CAACV,IAAI,CAACmD,MAAM,6CAAK,IAAI,WAAI,EAClC;OACC;;KAGD,IACCzC,KAAK,CAACV,IAAI,CAACkE,IAAI,KAAK,SAAS,IAC1BnD,cAAI,CAACC,QAAQ,CAACN,KAAK,CAACV,IAAI,CAACuB,MAAM,CAACvB,IAAI,CAAC,EAEzC;OACCI,6BAAY,CAACU,IAAI,CAAC,oCAAoC,EAAE;SACvDd,IAAI,EAAEU,KAAK,CAACV,IAAI,CAACuB,MAAM,CAACvB;QACxB,CAAC;;KAGH,IACCU,KAAK,CAACV,IAAI,CAACkE,IAAI,KAAK,UAAU,IAC3BnD,cAAI,CAACC,QAAQ,CAACN,KAAK,CAACV,IAAI,CAACuB,MAAM,CAAC6B,KAAK,CAAC,IACtCrC,cAAI,CAACgC,QAAQ,CAACrC,KAAK,CAACV,IAAI,CAACuB,MAAM,CAAC6B,KAAK,CAACzB,OAAO,CAAC,EAElD;OACCvB,6BAAY,CAACU,IAAI,CAAC,kCAAkC,EAAE;SACrDa,OAAO,EAAEjB,KAAK,CAACV,IAAI,CAACuB,MAAM,CAAC6B,KAAK,CAACzB;QACjC,CAAC;;KAGH,IAAIjB,KAAK,CAACV,IAAI,CAACkE,IAAI,KAAK,SAAS,EACjC;KAIA,4CAAI;;CAEN;CAAC,8BAGD;GACCM,qBAAqB,CAAC,MAAM;KAC3B,4CAAI,sBACH,SAAS,EACT;OACCC,IAAI,EAAE,4CAAI,wBAAWC;MACrB;IAEF,CAAC;CACH;CAAC,uBAGD;GACC,MAAMC,OAAO,GAAG,IAAI;GACpB,MAAMC,YAAY,GAAG,4CAAI,oBAAU;KAAEjD,OAAO,0CAAE,IAAI;IAAS,GAAG,IAAI;GAElE,4CAAI,gCAAgBkD,iBAAS,CAACC,SAAS,CAAC;KACvCZ,IAAI,0CAAE,IAAI,WAAI;KAEda,UAAU,EAAE;OACXzC,OAAO;OAAEK,KAAK;OAAEnD,OAAO,0CAAE,IAAI;MAC7B;KAEDC,KAAK,EAAE;OACNC,WAAW,EAAE;SACZC,IAAI,EAAEC,MAAM;SAAEC,OAAO,EAAE;;MAExB;KAEDG,IAAI,GACJ;OACC,OAAO;SACN2B,OAAO,EAAE,IAAI;SACbyB,KAAK,EAAEwB;QACP;MACD;KAEDzE,OAAO,GACP;OACC,IAAI,CAACS,OAAO,CAACC,YAAY,CAACR,SAAS,CAAC,2CAA2C,EAAE,IAAI,CAAC2E,YAAY,CAAC;OACnG,IAAI,CAACpE,OAAO,CAACC,YAAY,CAACR,SAAS,CAAC,yCAAyC,EAAE,IAAI,CAAC4E,YAAY,CAAC;OACjG,IAAI,CAACrE,OAAO,CAACC,YAAY,CAACR,SAAS,CAAC,oCAAoC,EAAE,IAAI,CAAC6E,aAAa,CAAC;OAC7F,IAAI,CAACtE,OAAO,CAACC,YAAY,CAACR,SAAS,CAAC,wCAAwC,EAAE,IAAI,CAAC8E,aAAa,CAAC;OACjG/E,6BAAY,CAACC,SAAS,CAAC,kCAAkC,EAAE,IAAI,CAAC+E,WAAW,CAAC;MAC5E;KAEDC,OAAO,GACP;OACC,4CAAI,CAACzE,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE;OAE9B,IAAI,CAACuD,SAAS,CAAC,MAAM;SACpB,MAAMC,KAAK,GAAG,IAAI,CAACC,GAAG,CAACC,oBAAoB,CAAC,GAAG,CAAC;SAChD,IAAIF,KAAK,CAACG,MAAM,GAAG,CAAC,EACpB;WACC,EAAE,CAACC,KAAK,CAACC,IAAI,CAACL,KAAK,CAAC,CAACM,GAAG,CAACrD,IAAI,IAAI;aAChC8B,eAAS,CAACC,IAAI,CAAC/B,IAAI,EAAE,OAAO,EAAE9B,KAAK,IAAI;eACtCA,KAAK,CAACoF,cAAc,EAAE;eACtBpF,KAAK,CAACqF,eAAe,EAAE;cACvB,CAAC;YACF,CAAC;;QAEH,CAAC;MACF;KAEDxF,aAAa,GACb;OACC,IAAI,CAACK,OAAO,CAACC,YAAY,CAACL,WAAW,CAAC,2CAA2C,EAAE,IAAI,CAACwE,YAAY,CAAC;OACrG,IAAI,CAACpE,OAAO,CAACC,YAAY,CAACL,WAAW,CAAC,yCAAyC,EAAE,IAAI,CAACyE,YAAY,CAAC;OACnG,IAAI,CAACrE,OAAO,CAACC,YAAY,CAACL,WAAW,CAAC,oCAAoC,EAAE,IAAI,CAAC0E,aAAa,CAAC;OAC/F,IAAI,CAACtE,OAAO,CAACC,YAAY,CAACL,WAAW,CAAC,wCAAwC,EAAE,IAAI,CAAC2E,aAAa,CAAC;OACnG/E,6BAAY,CAACI,WAAW,CAAC,kCAAkC,EAAE,IAAI,CAAC4E,WAAW,CAAC;MAC9E;KAED3E,OAAO,EAAE;OACRuE,YAAY,GACZ;;SAEC,IAAI,CAACpE,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE,CAAC8B,UAAU,EAAE;QAC3C;OAEDoB,YAAY,GACZ;;SAEC,IAAI,CAACrE,OAAO,CAACkB,WAAW,CAACC,GAAG,EAAE,CAACgC,UAAU,EAAE;QAC3C;OAEDmB,aAAa,CAACxE,KAAgB,EAC9B;SAAA;SACC,MAAMiB,OAAO,GAAG,mBAAAjB,KAAK,CAACO,OAAO,EAAE,qBAAf,eAAiBU,OAAO,KAAI,IAAI;SAChD,IAAI,CAACA,OAAO,GAAGA,OAAO,GAAG;WAAEA;UAAS,GAAG,IAAI;QAC3C;OAEDwD,aAAa,GACb;SACC,IAAI,CAACxD,OAAO,GAAG,IAAI;QACnB;OAEDyD,WAAW,CAAC1E,KAAgB,EAC5B;SAAA;;SAEC,MAAMiB,OAAO,GAAG,oBAAAjB,KAAK,CAACO,OAAO,EAAE,qBAAf,gBAAiBU,OAAO,KAAI,IAAI;SAChD,IAAI,CAACyB,KAAK,GAAGzB,OAAO,GAAG;WAAEA;UAAS,GAAG,IAAI;SAEzC,IAAI,CAACsD,YAAY,EAAE;;MAEpB;KAEDe,YAAY,GACZ;OACC,IAAI,CAACpF,OAAO,CAACkB,WAAW,CAACmE,GAAG,CAACtB,OAAO,CAAC;MACrC;KAEDjC,QAAQ,EAAG;;;;;;;;;;;;;;mBAcG,wCAAE,IAAI,yBAAY;;;;IAIhC,EAAE;KACFhD,WAAW,0CAAE,IAAI;IACjB,CAAC;GAEF,4CAAI,8BAAcwG,KAAK,yCAAC,IAAI,wBAAW;CACxC;;;;;;;;"}