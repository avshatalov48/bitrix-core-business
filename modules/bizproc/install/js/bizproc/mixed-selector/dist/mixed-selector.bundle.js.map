{"version":3,"file":"mixed-selector.bundle.js","sources":["../src/bp-mixed-selector/bp-mixed-selector.js","../src/index.js"],"sourcesContent":["import { Type, Tag, Loc, Dom, Event, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuManager } from 'main.popup';\nimport type { BpMixedSelectorOptions } from 'bizproc.mixed-selector';\n\nexport class BpMixedSelector extends EventEmitter\n{\n\ttargetNode: HTMLElement = null;\n\ttargetTitle: string;\n\ttabs: Object<string, Object> = null;\n\ttemplate: Array = [];\n\tactivityName: string = '';\n\tmaxWidth: number = 300;\n\tmaxHeight: number = 500;\n\tminWidth: number = 100;\n\tminHeight: number = 60;\n\tobjectName: string = 'mixed_selector[object]';\n\tfieldName: string = 'mixed_selector[field]';\n\tcheckActivityChildren: boolean = true;\n\tactivityFilter: Array = [];\n\texceptErrorMessages: boolean = false;\n\n\tmap: Object<string, Object> = null;\n\tmenuItems: Array = null;\n\tmenuTargetNode: HTMLElement = null;\n\tmenuId: string = null;\n\n\tobjectInputNode: HTMLInputElement = null;\n\tfieldInputNode: HTMLInputElement = null;\n\n\tconstructor(selectorOptions: BpMixedSelectorOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.MixedSelector.BpMixedSelector');\n\n\t\tconst options: BpMixedSelectorOptions = Type.isPlainObject(selectorOptions) ? selectorOptions : {};\n\n\t\tthis.setTargetNode(options.targetNode);\n\t\tthis.setObjectTabs(options.objectTabs);\n\t\tthis.setTemplate(options.template);\n\t\tthis.setActivityName(options.activityName);\n\t\tthis.setSize(options.size);\n\t\tthis.setInputNames(options.inputNames);\n\t\tthis.setTargetTitle(options.targetTitle);\n\t\tthis.setCheckActivityChildren(options.checkActivityChildren);\n\t\tthis.setActivityFilter(options.activityFilter);\n\t\tthis.setExceptErrorMessages(options.exceptErrorMessages);\n\t}\n\n\tstatic getAvailableTabsName(): Array\n\t{\n\t\treturn ['Parameter', 'Variable', 'Constant', 'GlobalConst', 'GlobalVar', 'Document', 'Activity'];\n\t}\n\n\tstatic getAvailableTabsLocMessages(): Object\n\t{\n\t\treturn {\n\t\t\tParameter: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_PARAMETER'),\n\t\t\tVariable: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_VARIABLE'),\n\t\t\tConstant: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_CONSTANT'),\n\t\t\tGlobalConst: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_CONSTANT'),\n\t\t\tGlobalVar: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_VARIABLE'),\n\t\t\tDocument: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_DOCUMENT_FIELDS'),\n\t\t\tActivity: Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_ADDITIONAL_RESULT'),\n\t\t};\n\t}\n\n\t/* region basic SET/GET */\n\n\tsetTargetNode(node: HTMLElement)\n\t{\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tthis.targetNode = node;\n\t\t}\n\t}\n\n\tgetTargetNode(): HTMLElement | null\n\t{\n\t\treturn this.targetNode;\n\t}\n\n\tsetObjectTabs(tabs)\n\t{\n\t\tif (Type.isPlainObject(tabs))\n\t\t{\n\t\t\tthis.tabs = tabs;\n\t\t}\n\t}\n\n\tgetObjectTabs(): Object | null\n\t{\n\t\treturn this.tabs;\n\t}\n\n\tsetTemplate(template)\n\t{\n\t\tif (Type.isArrayFilled(template))\n\t\t{\n\t\t\tthis.template = template;\n\t\t}\n\t}\n\n\tgetTemplate(): Array\n\t{\n\t\treturn this.template;\n\t}\n\n\tsetActivityName(name)\n\t{\n\t\tif (Type.isStringFilled(name))\n\t\t{\n\t\t\tthis.activityName = name;\n\t\t}\n\t}\n\n\tgetActivityName(): string\n\t{\n\t\treturn this.activityName;\n\t}\n\n\tsetSize(size)\n\t{\n\t\tif (!Type.isPlainObject(size))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(size.maxWidth))\n\t\t{\n\t\t\tthis.maxWidth = size.maxWidth;\n\t\t}\n\n\t\tif (Type.isNumber(size.minWidth))\n\t\t{\n\t\t\tthis.minWidth = size.minWidth;\n\t\t}\n\n\t\tif (Type.isNumber(size.maxHeight))\n\t\t{\n\t\t\tthis.maxHeight = size.maxHeight;\n\t\t}\n\n\t\tif (Type.isNumber(size.minHeight))\n\t\t{\n\t\t\tthis.minHeight = size.minHeight;\n\t\t}\n\t}\n\n\tgetSize(): Object\n\t{\n\t\treturn {\n\t\t\tmaxWidth: this.maxWidth,\n\t\t\tminWidth: this.minWidth,\n\t\t\tmaxHeight: this.maxHeight,\n\t\t\tminHeight: this.minHeight,\n\t\t};\n\t}\n\n\tsetInputNames(names)\n\t{\n\t\tif (!Type.isPlainObject(names))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isStringFilled(names.object))\n\t\t{\n\t\t\tthis.objectName = names.object;\n\t\t}\n\n\t\tif (Type.isStringFilled(names.field))\n\t\t{\n\t\t\tthis.fieldName = names.field;\n\t\t}\n\t}\n\n\tgetInputNames(): Object\n\t{\n\t\treturn {\n\t\t\tobject: this.objectName,\n\t\t\tfield: this.fieldName,\n\t\t};\n\t}\n\n\tsetTargetTitle(title)\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.targetTitle = title;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetTitle = Loc.getMessage('BIZPROC_MIXED_SELECTOR_EXT_CHOOSE_TARGET');\n\t}\n\n\tgetTargetTitle(): string\n\t{\n\t\treturn this.targetTitle;\n\t}\n\n\tsetCheckActivityChildren(check)\n\t{\n\t\tif (Type.isBoolean(check))\n\t\t{\n\t\t\tthis.checkActivityChildren = check;\n\t\t}\n\t}\n\n\tgetCheckActivityChildren(): boolean\n\t{\n\t\treturn this.checkActivityChildren;\n\t}\n\n\tsetActivityFilter(filter)\n\t{\n\t\tif (Type.isArray(filter))\n\t\t{\n\t\t\tthis.activityFilter = filter;\n\t\t}\n\t}\n\n\tgetActivityFilter(): Array\n\t{\n\t\treturn this.activityFilter;\n\t}\n\n\tsetExceptErrorMessages(except)\n\t{\n\t\tif (Type.isBoolean(except))\n\t\t{\n\t\t\tthis.exceptErrorMessages = except;\n\t\t}\n\t}\n\n\tgetExceptErrorMessages(): boolean\n\t{\n\t\treturn this.exceptErrorMessages;\n\t}\n\n\t/* endregion */\n\n\tgetMenu(): Menu | null\n\t{\n\t\tconst me = this;\n\t\tif (this.menuId)\n\t\t{\n\t\t\t// todo: modify popup position.\n\t\t\treturn MenuManager.getMenuById(this.menuId);\n\t\t}\n\t\tthis.menuId = BX.util.getRandomString();\n\n\t\tconst size = this.getSize();\n\n\t\treturn MenuManager.create(\n\t\t\tme.menuId,\n\t\t\tme.getMenuTargetNode(),\n\t\t\tme.getMenuItems(),\n\t\t\t{\n\t\t\t\tzIndex: 200,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (Dom.getPosition(me.getMenuTargetNode()).width / 2),\n\t\t\t\tangle: { position: 'top', offset: 0 },\n\t\t\t\tmaxWidth: size.maxWidth,\n\t\t\t\tmaxHeight: size.maxHeight,\n\t\t\t\tminWidth: size.minWidth,\n\t\t\t\tminHeight: size.minHeight,\n\t\t\t},\n\t\t);\n\t}\n\n\tgetMenuTargetNode(): HTMLElement | null\n\t{\n\t\treturn this.menuTargetNode;\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\tif (this.menuItems)\n\t\t{\n\t\t\treturn this.menuItems;\n\t\t}\n\t\tthis.menuItems = [];\n\n\t\tthis.#fillMenuItems();\n\n\t\treturn this.menuItems;\n\t}\n\n\tgetMenuItemsByTabName(tabName: string): Array\n\t{\n\t\tconst tabsItems = this.getMenuItems();\n\n\t\tfor (const i in tabsItems)\n\t\t{\n\t\t\tif (tabsItems[i].tabName === tabName)\n\t\t\t{\n\t\t\t\treturn tabsItems[i].items;\n\t\t\t}\n\t\t}\n\n\t\treturn [];\n\t}\n\n\t#fillMenuItems()\n\t{\n\t\tconst me = this;\n\t\tconst map = this.#getTabsMap();\n\t\tconst locMapNames = BpMixedSelector.getAvailableTabsLocMessages();\n\t\tconst mapKeys = BX.util.object_keys(map);\n\t\tfor (const i in mapKeys)\n\t\t{\n\t\t\tif (mapKeys[i] === 'Activity')\n\t\t\t{\n\t\t\t\tconst activitiesItems = this.#getTemplateActivitiesItems(this.template, map[mapKeys[i]]);\n\t\t\t\tconst groupByItemActivitiesItems = [];\n\t\t\t\tactivitiesItems.forEach((activityItem) => {\n\t\t\t\t\tif (!Type.isArrayFilled(activityItem))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst items = [];\n\t\t\t\t\tactivityItem.forEach((item) => {\n\t\t\t\t\t\tif (!Type.isStringFilled(item.description))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t(item.field !== 'ErrorMessage')\n\t\t\t\t\t\t\t\t|| (this.getExceptErrorMessages() === false))\n\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\t(this.getActivityFilter().length === 0)\n\t\t\t\t\t\t\t\t|| this.getActivityFilter().includes(item.activity)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\ttext: Text.encode(`${item.text} (${item.description})`),\n\t\t\t\t\t\t\t\tobject: item.object,\n\t\t\t\t\t\t\t\tfield: item.field,\n\t\t\t\t\t\t\t\tproperty: item,\n\t\t\t\t\t\t\t\tonclick: me.#onChooseFieldClick.bind(me),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (Type.isArrayFilled(items))\n\t\t\t\t\t{\n\t\t\t\t\t\tgroupByItemActivitiesItems.push({\n\t\t\t\t\t\t\ttext: activityItem[0].description,\n\t\t\t\t\t\t\tobject: activityItem[0].object,\n\t\t\t\t\t\t\titems,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (Type.isArrayFilled(groupByItemActivitiesItems))\n\t\t\t\t{\n\t\t\t\t\tthis.menuItems.push({\n\t\t\t\t\t\ttext: locMapNames[mapKeys[i]],\n\t\t\t\t\t\titems: groupByItemActivitiesItems,\n\t\t\t\t\t\ttabName: 'Activity',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.menuItems.push({\n\t\t\t\t\ttext: locMapNames[mapKeys[i]],\n\t\t\t\t\titems: this.#extractMenuItem(map[mapKeys[i]], mapKeys[i]),\n\t\t\t\t\ttabName: mapKeys[i],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#getTabsMap(): Object\n\t{\n\t\tif (this.map)\n\t\t{\n\t\t\treturn this.map;\n\t\t}\n\t\tthis.map = {};\n\n\t\tconst availableTabs = BpMixedSelector.getAvailableTabsName();\n\n\t\tconst keys = Object.keys(this.tabs);\n\t\tfor (const i in keys)\n\t\t{\n\t\t\tif (availableTabs.includes(keys[i]) && Object.keys(this.tabs[keys[i]]).length > 0)\n\t\t\t{\n\t\t\t\tthis.map[keys[i]] = this.tabs[keys[i]];\n\t\t\t}\n\t\t}\n\n\t\tif (this.template.length < 0 && this.map.Activity)\n\t\t{\n\t\t\tdelete this.map.Activity;\n\t\t}\n\n\t\treturn this.map;\n\t}\n\n\t#extractMenuItem(items, object): Array\n\t{\n\t\tconst result = [];\n\t\tconst itemsKeys = Object.keys(items);\n\t\tfor (const i in itemsKeys)\n\t\t{\n\t\t\tresult.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(items[itemsKeys[i]].Name),\n\t\t\t\tobject,\n\t\t\t\tfield: itemsKeys[i],\n\t\t\t\tproperty: items[itemsKeys[i]],\n\t\t\t\tonclick: this.#onChooseFieldClick.bind(this),\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getTemplateActivitiesItems(template, activities): Array\n\t{\n\t\tlet result = [];\n\n\t\tfor (let i = 0, s = template.length; i < s; ++i)\n\t\t{\n\t\t\tif (template[i].Name === this.activityName && !this.checkActivityChildren)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst activityType = template[i].Type.toLowerCase();\n\t\t\tconst activityData = activities[activityType] ?? {};\n\n\t\t\tconst returnActivityData = activityData.RETURN;\n\t\t\tconst additionalResult = activityData.ADDITIONAL_RESULT;\n\n\t\t\tif (returnActivityData)\n\t\t\t{\n\t\t\t\tconst keys = Object.keys(returnActivityData);\n\t\t\t\tconst activityResult = [];\n\n\t\t\t\tfor (const j in keys)\n\t\t\t\t{\n\t\t\t\t\tactivityResult.push({\n\t\t\t\t\t\ttext: returnActivityData[keys[j]].NAME,\n\t\t\t\t\t\tdescription: template[i].Properties.Title || activityData.NAME,\n\t\t\t\t\t\tactivity: activityType,\n\t\t\t\t\t\tvalue: `{=${template[i].Name}:${keys[j]}}`,\n\t\t\t\t\t\tobject: template[i].Name,\n\t\t\t\t\t\tfield: keys[j],\n\t\t\t\t\t\tproperty: {\n\t\t\t\t\t\t\tName: returnActivityData[keys[j]].NAME,\n\t\t\t\t\t\t\tType: returnActivityData[keys[j]].TYPE,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (activityResult.length > 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(activityResult);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (Type.isArray(additionalResult))\n\t\t\t{\n\t\t\t\tconst properties = template[i].Properties;\n\t\t\t\tadditionalResult.forEach((addProp) => {\n\t\t\t\t\tif (properties[addProp])\n\t\t\t\t\t{\n\t\t\t\t\t\tconst keys = Object.keys(properties[addProp]);\n\t\t\t\t\t\tconst activityResult = [];\n\n\t\t\t\t\t\tfor (const j in keys)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst field = properties[addProp][keys[j]];\n\t\t\t\t\t\t\tactivityResult.push({\n\t\t\t\t\t\t\t\ttext: field.Name,\n\t\t\t\t\t\t\t\tdescription: properties.Title || activityData.NAME,\n\t\t\t\t\t\t\t\tvalue: `{=${template[i].Name}:${keys[j]}}`,\n\t\t\t\t\t\t\t\tobject: template[i].Name,\n\t\t\t\t\t\t\t\tfield: keys[j],\n\t\t\t\t\t\t\t\tproperty: field,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (activityResult.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.push(activityResult);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (template[i].Children && template[i].Children.length > 0)\n\t\t\t{\n\t\t\t\tconst subResult = this.#getTemplateActivitiesItems(template[i].Children, activities);\n\t\t\t\tresult = result.concat(subResult);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#onChooseFieldClick(event, item)\n\t{\n\t\tconst menu = this.getMenu();\n\t\tmenu.close();\n\n\t\t// todo: item.text htmlspecialchars applied twice\n\t\tthis.setSelectedObjectAndField(item.object, item.field, item.text);\n\t\tEventEmitter.emit(this, 'onSelect', { item });\n\t}\n\n\trenderMixedSelector()\n\t{\n\t\tconst link = Tag.render`<a href=\"#\">${BX.util.htmlspecialchars(this.getTargetTitle())}</a>`;\n\t\tthis.menuTargetNode = link;\n\t\tEvent.bind(link, 'click', this.#onChooseTargetClick.bind(this));\n\n\t\tconst objectInput = Tag.render`\n\t\t\t<input \n\t\t\t\ttype=\"hidden\" \n\t\t\t\tname=\"${this.objectName}\" \n\t\t\t\tdata-role=\"mixed-selector-object\"\n\t\t\t\tvalue=\"\"\n\t\t\t>\n\t\t`;\n\t\tthis.objectInputNode = objectInput;\n\n\t\tconst fieldInput = Tag.render`\n\t\t\t<input \n\t\t\t\ttype=\"hidden\" \n\t\t\t\tname=\"${this.fieldName}\" \n\t\t\t\tdata-role=\"mixed-selector-field\"\n\t\t\t\tvalue=\"\"\n\t\t\t>\n\t\t`;\n\t\tthis.fieldInputNode = fieldInput;\n\n\t\tDom.append(link, this.targetNode);\n\t\tDom.append(objectInput, this.targetNode);\n\t\tDom.append(fieldInput, this.targetNode);\n\t}\n\n\t#onChooseTargetClick(event)\n\t{\n\t\tconst menu = this.getMenu();\n\t\tmenu.show();\n\n\t\tevent.preventDefault();\n\t}\n\n\tgetSelectedObjectValue(): string | null\n\t{\n\t\tif (this.objectInputNode)\n\t\t{\n\t\t\treturn this.objectInputNode.value;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetSelectedFieldValue(): string | null\n\t{\n\t\tif (this.fieldInputNode)\n\t\t{\n\t\t\treturn this.fieldInputNode.value;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetSelectedObjectAndField(object: string, field: string, fieldTitle: string)\n\t{\n\t\tconst target = this.getMenuTargetNode();\n\t\tconst tabsLocMessage = BpMixedSelector.getAvailableTabsLocMessages();\n\n\t\tif (BpMixedSelector.getAvailableTabsName().includes(object))\n\t\t{\n\t\t\ttarget.innerText = `${tabsLocMessage[object]}: ${fieldTitle}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttarget.innerText = `${tabsLocMessage.Activity}: ${fieldTitle}`;\n\t\t}\n\n\t\tif (Type.isStringFilled(object) && Type.isStringFilled(field))\n\t\t{\n\t\t\tthis.objectInputNode.value = object;\n\t\t\tthis.fieldInputNode.value = field;\n\t\t}\n\t}\n}\n","import { BpMixedSelector } from \"./bp-mixed-selector/bp-mixed-selector\";\n\nimport type { BpMixedSelectorOptions } from './bp-mixed-selector/bp-mixed-selector-options';\n\nconst MixedSelector = {\n\tBpMixedSelector\n};\n\nexport {\n\tMixedSelector,\n\tBpMixedSelector\n}\n\nexport type {\n\tBpMixedSelectorOptions,\n}\n\n"],"names":["BpMixedSelector","selectorOptions","setEventNamespace","options","Type","isPlainObject","setTargetNode","targetNode","setObjectTabs","objectTabs","setTemplate","template","setActivityName","activityName","setSize","size","setInputNames","inputNames","setTargetTitle","targetTitle","setCheckActivityChildren","checkActivityChildren","setActivityFilter","activityFilter","setExceptErrorMessages","exceptErrorMessages","node","isDomNode","tabs","isArrayFilled","name","isStringFilled","isNumber","maxWidth","minWidth","maxHeight","minHeight","names","object","objectName","field","fieldName","title","Loc","getMessage","check","isBoolean","filter","isArray","except","me","menuId","MenuManager","getMenuById","BX","util","getRandomString","getSize","create","getMenuTargetNode","getMenuItems","zIndex","autoHide","offsetLeft","Dom","getPosition","width","angle","position","offset","menuTargetNode","menuItems","tabName","tabsItems","i","items","link","Tag","render","htmlspecialchars","getTargetTitle","Event","bind","objectInput","objectInputNode","fieldInput","fieldInputNode","append","value","fieldTitle","target","tabsLocMessage","getAvailableTabsLocMessages","getAvailableTabsName","includes","innerText","Activity","Parameter","Variable","Constant","GlobalConst","GlobalVar","Document","EventEmitter","map","locMapNames","mapKeys","object_keys","activitiesItems","groupByItemActivitiesItems","forEach","activityItem","item","description","getExceptErrorMessages","getActivityFilter","length","activity","push","text","Text","encode","property","onclick","availableTabs","keys","Object","result","itemsKeys","Name","activities","activityType","toLowerCase","activityData","returnActivityData","RETURN","additionalResult","ADDITIONAL_RESULT","activityResult","j","NAME","Properties","Title","TYPE","properties","addProp","Children","subResult","concat","s","event","menu","getMenu","close","setSelectedObjectAndField","emit","show","preventDefault","MixedSelector"],"mappings":";;;;;;;;;AAAA,CAE+C;CAAA;CAAA;CAAA;CAAA;CAAA;AAG/C,KAAaA,eAAe;GAAA;GAyB3B,yBAAYC,eAAuC,EACnD;KAAA;KAAA;KACC;KAAQ;KAAA;KAAA;KAAA;KAAA;KAAA;KAAA,qFAzBiB,IAAI;KAAA,+EAEC,IAAI;KAAA,mFACjB,EAAE;KAAA,uFACG,EAAE;KAAA,mFACN,GAAG;KAAA,oFACF,GAAG;KAAA,mFACJ,GAAG;KAAA,oFACF,EAAE;KAAA,qFACD,wBAAwB;KAAA,oFACzB,uBAAuB;KAAA,gGACV,IAAI;KAAA,yFACb,EAAE;KAAA,8FACK,KAAK;KAAA,8EAEN,IAAI;KAAA,oFACf,IAAI;KAAA,yFACO,IAAI;KAAA,iFACjB,IAAI;KAAA,0FAEe,IAAI;KAAA,yFACL,IAAI;KAKtC,MAAKC,iBAAiB,CAAC,0CAA0C,CAAC;KAElE,IAAMC,OAA+B,GAAGC,cAAI,CAACC,aAAa,CAACJ,eAAe,CAAC,GAAGA,eAAe,GAAG,EAAE;KAElG,MAAKK,aAAa,CAACH,OAAO,CAACI,UAAU,CAAC;KACtC,MAAKC,aAAa,CAACL,OAAO,CAACM,UAAU,CAAC;KACtC,MAAKC,WAAW,CAACP,OAAO,CAACQ,QAAQ,CAAC;KAClC,MAAKC,eAAe,CAACT,OAAO,CAACU,YAAY,CAAC;KAC1C,MAAKC,OAAO,CAACX,OAAO,CAACY,IAAI,CAAC;KAC1B,MAAKC,aAAa,CAACb,OAAO,CAACc,UAAU,CAAC;KACtC,MAAKC,cAAc,CAACf,OAAO,CAACgB,WAAW,CAAC;KACxC,MAAKC,wBAAwB,CAACjB,OAAO,CAACkB,qBAAqB,CAAC;KAC5D,MAAKC,iBAAiB,CAACnB,OAAO,CAACoB,cAAc,CAAC;KAC9C,MAAKC,sBAAsB,CAACrB,OAAO,CAACsB,mBAAmB,CAAC;KAAC;;GACzD;KAAA;6DAsBaC,IAAiB,EAC/B;OACC,IAAItB,cAAI,CAACuB,SAAS,CAACD,IAAI,CAAC,EACxB;SACC,IAAI,CAACnB,UAAU,GAAGmB,IAAI;;;;KAEvB;KAAA,gCAGD;OACC,OAAO,IAAI,CAACnB,UAAU;;;KACtB;KAAA,8BAEaqB,IAAI,EAClB;OACC,IAAIxB,cAAI,CAACC,aAAa,CAACuB,IAAI,CAAC,EAC5B;SACC,IAAI,CAACA,IAAI,GAAGA,IAAI;;;;KAEjB;KAAA,gCAGD;OACC,OAAO,IAAI,CAACA,IAAI;;;KAChB;KAAA,4BAEWjB,QAAQ,EACpB;OACC,IAAIP,cAAI,CAACyB,aAAa,CAAClB,QAAQ,CAAC,EAChC;SACC,IAAI,CAACA,QAAQ,GAAGA,QAAQ;;;;KAEzB;KAAA,8BAGD;OACC,OAAO,IAAI,CAACA,QAAQ;;;KACpB;KAAA,gCAEemB,IAAI,EACpB;OACC,IAAI1B,cAAI,CAAC2B,cAAc,CAACD,IAAI,CAAC,EAC7B;SACC,IAAI,CAACjB,YAAY,GAAGiB,IAAI;;;;KAEzB;KAAA,kCAGD;OACC,OAAO,IAAI,CAACjB,YAAY;;;KACxB;KAAA,wBAEOE,IAAI,EACZ;OACC,IAAI,CAACX,cAAI,CAACC,aAAa,CAACU,IAAI,CAAC,EAC7B;SACC;;OAGD,IAAIX,cAAI,CAAC4B,QAAQ,CAACjB,IAAI,CAACkB,QAAQ,CAAC,EAChC;SACC,IAAI,CAACA,QAAQ,GAAGlB,IAAI,CAACkB,QAAQ;;OAG9B,IAAI7B,cAAI,CAAC4B,QAAQ,CAACjB,IAAI,CAACmB,QAAQ,CAAC,EAChC;SACC,IAAI,CAACA,QAAQ,GAAGnB,IAAI,CAACmB,QAAQ;;OAG9B,IAAI9B,cAAI,CAAC4B,QAAQ,CAACjB,IAAI,CAACoB,SAAS,CAAC,EACjC;SACC,IAAI,CAACA,SAAS,GAAGpB,IAAI,CAACoB,SAAS;;OAGhC,IAAI/B,cAAI,CAAC4B,QAAQ,CAACjB,IAAI,CAACqB,SAAS,CAAC,EACjC;SACC,IAAI,CAACA,SAAS,GAAGrB,IAAI,CAACqB,SAAS;;;;KAEhC;KAAA,0BAGD;OACC,OAAO;SACNH,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBC,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBC,SAAS,EAAE,IAAI,CAACA,SAAS;SACzBC,SAAS,EAAE,IAAI,CAACA;QAChB;;;KACD;KAAA,8BAEaC,KAAK,EACnB;OACC,IAAI,CAACjC,cAAI,CAACC,aAAa,CAACgC,KAAK,CAAC,EAC9B;SACC;;OAGD,IAAIjC,cAAI,CAAC2B,cAAc,CAACM,KAAK,CAACC,MAAM,CAAC,EACrC;SACC,IAAI,CAACC,UAAU,GAAGF,KAAK,CAACC,MAAM;;OAG/B,IAAIlC,cAAI,CAAC2B,cAAc,CAACM,KAAK,CAACG,KAAK,CAAC,EACpC;SACC,IAAI,CAACC,SAAS,GAAGJ,KAAK,CAACG,KAAK;;;;KAE7B;KAAA,gCAGD;OACC,OAAO;SACNF,MAAM,EAAE,IAAI,CAACC,UAAU;SACvBC,KAAK,EAAE,IAAI,CAACC;QACZ;;;KACD;KAAA,+BAEcC,KAAK,EACpB;OACC,IAAItC,cAAI,CAAC2B,cAAc,CAACW,KAAK,CAAC,EAC9B;SACC,IAAI,CAACvB,WAAW,GAAGuB,KAAK;SAExB;;OAGD,IAAI,CAACvB,WAAW,GAAGwB,aAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC;;;KAC7E;KAAA,iCAGD;OACC,OAAO,IAAI,CAACzB,WAAW;;;KACvB;KAAA,yCAEwB0B,KAAK,EAC9B;OACC,IAAIzC,cAAI,CAAC0C,SAAS,CAACD,KAAK,CAAC,EACzB;SACC,IAAI,CAACxB,qBAAqB,GAAGwB,KAAK;;;;KAEnC;KAAA,2CAGD;OACC,OAAO,IAAI,CAACxB,qBAAqB;;;KACjC;KAAA,kCAEiB0B,MAAM,EACxB;OACC,IAAI3C,cAAI,CAAC4C,OAAO,CAACD,MAAM,CAAC,EACxB;SACC,IAAI,CAACxB,cAAc,GAAGwB,MAAM;;;;KAE7B;KAAA,oCAGD;OACC,OAAO,IAAI,CAACxB,cAAc;;;KAC1B;KAAA,uCAEsB0B,MAAM,EAC7B;OACC,IAAI7C,cAAI,CAAC0C,SAAS,CAACG,MAAM,CAAC,EAC1B;SACC,IAAI,CAACxB,mBAAmB,GAAGwB,MAAM;;;;KAElC;KAAA,yCAGD;OACC,OAAO,IAAI,CAACxB,mBAAmB;MAC/B;;KAED;KAAA,0BAGA;OACC,IAAMyB,EAAE,GAAG,IAAI;OACf,IAAI,IAAI,CAACC,MAAM,EACf;;SAEC,OAAOC,sBAAW,CAACC,WAAW,CAAC,IAAI,CAACF,MAAM,CAAC;;OAE5C,IAAI,CAACA,MAAM,GAAGG,EAAE,CAACC,IAAI,CAACC,eAAe,EAAE;OAEvC,IAAMzC,IAAI,GAAG,IAAI,CAAC0C,OAAO,EAAE;OAE3B,OAAOL,sBAAW,CAACM,MAAM,CACxBR,EAAE,CAACC,MAAM,EACTD,EAAE,CAACS,iBAAiB,EAAE,EACtBT,EAAE,CAACU,YAAY,EAAE,EACjB;SACCC,MAAM,EAAE,GAAG;SACXC,QAAQ,EAAE,IAAI;SACdC,UAAU,EAAGC,aAAG,CAACC,WAAW,CAACf,EAAE,CAACS,iBAAiB,EAAE,CAAC,CAACO,KAAK,GAAG,CAAE;SAC/DC,KAAK,EAAE;WAAEC,QAAQ,EAAE,KAAK;WAAEC,MAAM,EAAE;UAAG;SACrCpC,QAAQ,EAAElB,IAAI,CAACkB,QAAQ;SACvBE,SAAS,EAAEpB,IAAI,CAACoB,SAAS;SACzBD,QAAQ,EAAEnB,IAAI,CAACmB,QAAQ;SACvBE,SAAS,EAAErB,IAAI,CAACqB;QAChB,CACD;;;KACD;KAAA,oCAGD;OACC,OAAO,IAAI,CAACkC,cAAc;;;KAC1B;KAAA,+BAGD;OACC,IAAI,IAAI,CAACC,SAAS,EAClB;SACC,OAAO,IAAI,CAACA,SAAS;;OAEtB,IAAI,CAACA,SAAS,GAAG,EAAE;OAEnB,2BAAI,wCAAJ,IAAI;OAEJ,OAAO,IAAI,CAACA,SAAS;;;KACrB;KAAA,sCAEqBC,OAAe,EACrC;OACC,IAAMC,SAAS,GAAG,IAAI,CAACb,YAAY,EAAE;OAErC,KAAK,IAAMc,CAAC,IAAID,SAAS,EACzB;SACC,IAAIA,SAAS,CAACC,CAAC,CAAC,CAACF,OAAO,KAAKA,OAAO,EACpC;WACC,OAAOC,SAAS,CAACC,CAAC,CAAC,CAACC,KAAK;;;OAI3B,OAAO,EAAE;;;KACT;KAAA,sCAwND;OACC,IAAMC,IAAI,GAAGC,aAAG,CAACC,MAAM,wGAAexB,EAAE,CAACC,IAAI,CAACwB,gBAAgB,CAAC,IAAI,CAACC,cAAc,EAAE,CAAC,CAAM;OAC3F,IAAI,CAACV,cAAc,GAAGM,IAAI;OAC1BK,eAAK,CAACC,IAAI,CAACN,IAAI,EAAE,OAAO,EAAE,2BAAI,+CAAsBM,IAAI,CAAC,IAAI,CAAC,CAAC;OAE/D,IAAMC,WAAW,GAAGN,aAAG,CAACC,MAAM,qOAGpB,IAAI,CAACvC,UAAU,CAIxB;OACD,IAAI,CAAC6C,eAAe,GAAGD,WAAW;OAElC,IAAME,UAAU,GAAGR,aAAG,CAACC,MAAM,oOAGnB,IAAI,CAACrC,SAAS,CAIvB;OACD,IAAI,CAAC6C,cAAc,GAAGD,UAAU;OAEhCrB,aAAG,CAACuB,MAAM,CAACX,IAAI,EAAE,IAAI,CAACrE,UAAU,CAAC;OACjCyD,aAAG,CAACuB,MAAM,CAACJ,WAAW,EAAE,IAAI,CAAC5E,UAAU,CAAC;OACxCyD,aAAG,CAACuB,MAAM,CAACF,UAAU,EAAE,IAAI,CAAC9E,UAAU,CAAC;;;KACvC;KAAA,yCAWD;OACC,IAAI,IAAI,CAAC6E,eAAe,EACxB;SACC,OAAO,IAAI,CAACA,eAAe,CAACI,KAAK;;OAGlC,OAAO,IAAI;;;KACX;KAAA,wCAGD;OACC,IAAI,IAAI,CAACF,cAAc,EACvB;SACC,OAAO,IAAI,CAACA,cAAc,CAACE,KAAK;;OAGjC,OAAO,IAAI;;;KACX;KAAA,0CAEyBlD,MAAc,EAAEE,KAAa,EAAEiD,UAAkB,EAC3E;OACC,IAAMC,MAAM,GAAG,IAAI,CAAC/B,iBAAiB,EAAE;OACvC,IAAMgC,cAAc,GAAG3F,eAAe,CAAC4F,2BAA2B,EAAE;OAEpE,IAAI5F,eAAe,CAAC6F,oBAAoB,EAAE,CAACC,QAAQ,CAACxD,MAAM,CAAC,EAC3D;SACCoD,MAAM,CAACK,SAAS,aAAMJ,cAAc,CAACrD,MAAM,CAAC,eAAKmD,UAAU,CAAE;QAC7D,MAED;SACCC,MAAM,CAACK,SAAS,aAAMJ,cAAc,CAACK,QAAQ,eAAKP,UAAU,CAAE;;OAG/D,IAAIrF,cAAI,CAAC2B,cAAc,CAACO,MAAM,CAAC,IAAIlC,cAAI,CAAC2B,cAAc,CAACS,KAAK,CAAC,EAC7D;SACC,IAAI,CAAC4C,eAAe,CAACI,KAAK,GAAGlD,MAAM;SACnC,IAAI,CAACgD,cAAc,CAACE,KAAK,GAAGhD,KAAK;;;;KAElC;KAAA,uCAliBD;OACC,OAAO,CAAC,WAAW,EAAE,UAAU,EAAE,UAAU,EAAE,aAAa,EAAE,WAAW,EAAE,UAAU,EAAE,UAAU,CAAC;;;KAChG;KAAA,8CAGD;OACC,OAAO;SACNyD,SAAS,EAAEtD,aAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC;SACjEsD,QAAQ,EAAEvD,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;SAC/DuD,QAAQ,EAAExD,aAAG,CAACC,UAAU,CAAC,qCAAqC,CAAC;SAC/DwD,WAAW,EAAEzD,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;SACzEyD,SAAS,EAAE1D,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;SACvE0D,QAAQ,EAAE3D,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;SACtEoD,QAAQ,EAAErD,aAAG,CAACC,UAAU,CAAC,8CAA8C;QACvE;;;GACD;CAAA,EA5DmC2D,6BAAY;CAglBhD,2BAnSA;GAAA;GACC,IAAMrD,EAAE,GAAG,IAAI;GACf,IAAMsD,GAAG,0BAAG,IAAI,kCAAJ,IAAI,CAAc;GAC9B,IAAMC,WAAW,GAAGzG,eAAe,CAAC4F,2BAA2B,EAAE;GACjE,IAAMc,OAAO,GAAGpD,EAAE,CAACC,IAAI,CAACoD,WAAW,CAACH,GAAG,CAAC;GAAC,6BAEzC;KACC,IAAIE,OAAO,CAAChC,CAAC,CAAC,KAAK,UAAU,EAC7B;OACC,IAAMkC,eAAe,0BAAG,MAAI,kEAAJ,MAAI,EAA6B,MAAI,CAACjG,QAAQ,EAAE6F,GAAG,CAACE,OAAO,CAAChC,CAAC,CAAC,CAAC,CAAC;OACxF,IAAMmC,0BAA0B,GAAG,EAAE;OACrCD,eAAe,CAACE,OAAO,CAAC,UAACC,YAAY,EAAK;SACzC,IAAI,CAAC3G,cAAI,CAACyB,aAAa,CAACkF,YAAY,CAAC,EACrC;WACC;;SAGD,IAAMpC,KAAK,GAAG,EAAE;SAChBoC,YAAY,CAACD,OAAO,CAAC,UAACE,IAAI,EAAK;WAC9B,IAAI,CAAC5G,cAAI,CAAC2B,cAAc,CAACiF,IAAI,CAACC,WAAW,CAAC,EAC1C;aACC;;WAGD,IACC,CACED,IAAI,CAACxE,KAAK,KAAK,cAAc,IAC1B,MAAI,CAAC0E,sBAAsB,EAAE,KAAK,KAAM,MAE3C,MAAI,CAACC,iBAAiB,EAAE,CAACC,MAAM,KAAK,CAAC,IACnC,MAAI,CAACD,iBAAiB,EAAE,CAACrB,QAAQ,CAACkB,IAAI,CAACK,QAAQ,CAAC,CACnD,EAEF;aACC1C,KAAK,CAAC2C,IAAI,CAAC;eACVC,IAAI,EAAEC,cAAI,CAACC,MAAM,WAAIT,IAAI,CAACO,IAAI,eAAKP,IAAI,CAACC,WAAW,OAAI;eACvD3E,MAAM,EAAE0E,IAAI,CAAC1E,MAAM;eACnBE,KAAK,EAAEwE,IAAI,CAACxE,KAAK;eACjBkF,QAAQ,EAAEV,IAAI;eACdW,OAAO,EAAE,uBAAAzE,EAAE,6CAAqBgC,IAAI,CAAChC,EAAE;cACvC,CAAC;;UAEH,CAAC;SAEF,IAAI9C,cAAI,CAACyB,aAAa,CAAC8C,KAAK,CAAC,EAC7B;WACCkC,0BAA0B,CAACS,IAAI,CAAC;aAC/BC,IAAI,EAAER,YAAY,CAAC,CAAC,CAAC,CAACE,WAAW;aACjC3E,MAAM,EAAEyE,YAAY,CAAC,CAAC,CAAC,CAACzE,MAAM;aAC9BqC,KAAK,EAALA;YACA,CAAC;;QAEH,CAAC;OAEF,IAAIvE,cAAI,CAACyB,aAAa,CAACgF,0BAA0B,CAAC,EAClD;SACC,MAAI,CAACtC,SAAS,CAAC+C,IAAI,CAAC;WACnBC,IAAI,EAAEd,WAAW,CAACC,OAAO,CAAChC,CAAC,CAAC,CAAC;WAC7BC,KAAK,EAAEkC,0BAA0B;WACjCrC,OAAO,EAAE;UACT,CAAC;;MAEH,MAED;OACC,MAAI,CAACD,SAAS,CAAC+C,IAAI,CAAC;SACnBC,IAAI,EAAEd,WAAW,CAACC,OAAO,CAAChC,CAAC,CAAC,CAAC;SAC7BC,KAAK,yBAAE,MAAI,4CAAJ,MAAI,EAAkB6B,GAAG,CAACE,OAAO,CAAChC,CAAC,CAAC,CAAC,EAAEgC,OAAO,CAAChC,CAAC,CAAC,CAAC;SACzDF,OAAO,EAAEkC,OAAO,CAAChC,CAAC;QAClB,CAAC;;IAEH;GAlED,KAAK,IAAMA,CAAC,IAAIgC,OAAO;KAAA;;CAmExB;CAAC,wBAGD;GACC,IAAI,IAAI,CAACF,GAAG,EACZ;KACC,OAAO,IAAI,CAACA,GAAG;;GAEhB,IAAI,CAACA,GAAG,GAAG,EAAE;GAEb,IAAMoB,aAAa,GAAG5H,eAAe,CAAC6F,oBAAoB,EAAE;GAE5D,IAAMgC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAAC,IAAI,CAACjG,IAAI,CAAC;GACnC,KAAK,IAAM8C,CAAC,IAAImD,IAAI,EACpB;KACC,IAAID,aAAa,CAAC9B,QAAQ,CAAC+B,IAAI,CAACnD,CAAC,CAAC,CAAC,IAAIoD,MAAM,CAACD,IAAI,CAAC,IAAI,CAACjG,IAAI,CAACiG,IAAI,CAACnD,CAAC,CAAC,CAAC,CAAC,CAAC0C,MAAM,GAAG,CAAC,EACjF;OACC,IAAI,CAACZ,GAAG,CAACqB,IAAI,CAACnD,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC9C,IAAI,CAACiG,IAAI,CAACnD,CAAC,CAAC,CAAC;;;GAIxC,IAAI,IAAI,CAAC/D,QAAQ,CAACyG,MAAM,GAAG,CAAC,IAAI,IAAI,CAACZ,GAAG,CAACR,QAAQ,EACjD;KACC,OAAO,IAAI,CAACQ,GAAG,CAACR,QAAQ;;GAGzB,OAAO,IAAI,CAACQ,GAAG;CAChB;CAAC,2BAEgB7B,KAAK,EAAErC,MAAM,EAC9B;GACC,IAAMyF,MAAM,GAAG,EAAE;GACjB,IAAMC,SAAS,GAAGF,MAAM,CAACD,IAAI,CAAClD,KAAK,CAAC;GACpC,KAAK,IAAMD,CAAC,IAAIsD,SAAS,EACzB;KACCD,MAAM,CAACT,IAAI,CAAC;OACXC,IAAI,EAAEjE,EAAE,CAACC,IAAI,CAACwB,gBAAgB,CAACJ,KAAK,CAACqD,SAAS,CAACtD,CAAC,CAAC,CAAC,CAACuD,IAAI,CAAC;OACxD3F,MAAM,EAANA,MAAM;OACNE,KAAK,EAAEwF,SAAS,CAACtD,CAAC,CAAC;OACnBgD,QAAQ,EAAE/C,KAAK,CAACqD,SAAS,CAACtD,CAAC,CAAC,CAAC;OAC7BiD,OAAO,EAAE,2BAAI,6CAAqBzC,IAAI,CAAC,IAAI;MAC3C,CAAC;;GAGH,OAAO6C,MAAM;CACd;CAAC,sCAE2BpH,QAAQ,EAAEuH,UAAU,EAChD;GAAA;GACC,IAAIH,MAAM,GAAG,EAAE;GAAC,gCAGhB;KAAA;KACC,IAAIpH,QAAQ,CAAC+D,CAAC,CAAC,CAACuD,IAAI,KAAK,MAAI,CAACpH,YAAY,IAAI,CAAC,MAAI,CAACQ,qBAAqB,EACzE;OAAA;;KAIA,IAAM8G,YAAY,GAAGxH,QAAQ,CAAC+D,CAAC,CAAC,CAACtE,IAAI,CAACgI,WAAW,EAAE;KACnD,IAAMC,YAAY,4BAAGH,UAAU,CAACC,YAAY,CAAC,yEAAI,EAAE;KAEnD,IAAMG,kBAAkB,GAAGD,YAAY,CAACE,MAAM;KAC9C,IAAMC,gBAAgB,GAAGH,YAAY,CAACI,iBAAiB;KAEvD,IAAIH,kBAAkB,EACtB;OACC,IAAMT,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACS,kBAAkB,CAAC;OAC5C,IAAMI,cAAc,GAAG,EAAE;OAEzB,KAAK,IAAMC,CAAC,IAAId,IAAI,EACpB;SACCa,cAAc,CAACpB,IAAI,CAAC;WACnBC,IAAI,EAAEe,kBAAkB,CAACT,IAAI,CAACc,CAAC,CAAC,CAAC,CAACC,IAAI;WACtC3B,WAAW,EAAEtG,QAAQ,CAAC+D,CAAC,CAAC,CAACmE,UAAU,CAACC,KAAK,IAAIT,YAAY,CAACO,IAAI;WAC9DvB,QAAQ,EAAEc,YAAY;WACtB3C,KAAK,cAAO7E,QAAQ,CAAC+D,CAAC,CAAC,CAACuD,IAAI,cAAIJ,IAAI,CAACc,CAAC,CAAC,MAAG;WAC1CrG,MAAM,EAAE3B,QAAQ,CAAC+D,CAAC,CAAC,CAACuD,IAAI;WACxBzF,KAAK,EAAEqF,IAAI,CAACc,CAAC,CAAC;WACdjB,QAAQ,EAAE;aACTO,IAAI,EAAEK,kBAAkB,CAACT,IAAI,CAACc,CAAC,CAAC,CAAC,CAACC,IAAI;aACtCxI,IAAI,EAAEkI,kBAAkB,CAACT,IAAI,CAACc,CAAC,CAAC,CAAC,CAACI;;UAEnC,CAAC;;OAGH,IAAIL,cAAc,CAACtB,MAAM,GAAG,CAAC,EAC7B;SACCW,MAAM,CAACT,IAAI,CAACoB,cAAc,CAAC;;MAE5B,MACI,IAAItI,cAAI,CAAC4C,OAAO,CAACwF,gBAAgB,CAAC,EACvC;OACC,IAAMQ,UAAU,GAAGrI,QAAQ,CAAC+D,CAAC,CAAC,CAACmE,UAAU;OACzCL,gBAAgB,CAAC1B,OAAO,CAAC,UAACmC,OAAO,EAAK;SACrC,IAAID,UAAU,CAACC,OAAO,CAAC,EACvB;WACC,IAAMpB,KAAI,GAAGC,MAAM,CAACD,IAAI,CAACmB,UAAU,CAACC,OAAO,CAAC,CAAC;WAC7C,IAAMP,eAAc,GAAG,EAAE;WAEzB,KAAK,IAAMC,EAAC,IAAId,KAAI,EACpB;aACC,IAAMrF,KAAK,GAAGwG,UAAU,CAACC,OAAO,CAAC,CAACpB,KAAI,CAACc,EAAC,CAAC,CAAC;aAC1CD,eAAc,CAACpB,IAAI,CAAC;eACnBC,IAAI,EAAE/E,KAAK,CAACyF,IAAI;eAChBhB,WAAW,EAAE+B,UAAU,CAACF,KAAK,IAAIT,YAAY,CAACO,IAAI;eAClDpD,KAAK,cAAO7E,QAAQ,CAAC+D,CAAC,CAAC,CAACuD,IAAI,cAAIJ,KAAI,CAACc,EAAC,CAAC,MAAG;eAC1CrG,MAAM,EAAE3B,QAAQ,CAAC+D,CAAC,CAAC,CAACuD,IAAI;eACxBzF,KAAK,EAAEqF,KAAI,CAACc,EAAC,CAAC;eACdjB,QAAQ,EAAElF;cACV,CAAC;;WAGH,IAAIkG,eAAc,CAACtB,MAAM,GAAG,CAAC,EAC7B;aACCW,MAAM,CAACT,IAAI,CAACoB,eAAc,CAAC;;;QAG7B,CAAC;;KAGH,IAAI/H,QAAQ,CAAC+D,CAAC,CAAC,CAACwE,QAAQ,IAAIvI,QAAQ,CAAC+D,CAAC,CAAC,CAACwE,QAAQ,CAAC9B,MAAM,GAAG,CAAC,EAC3D;OACC,IAAM+B,SAAS,0BAAG,MAAI,kEAAJ,MAAI,EAA6BxI,QAAQ,CAAC+D,CAAC,CAAC,CAACwE,QAAQ,EAAEhB,UAAU,CAAC;OACpFH,MAAM,GAAGA,MAAM,CAACqB,MAAM,CAACD,SAAS,CAAC;;IAElC;GA1ED,KAAK,IAAIzE,CAAC,GAAG,CAAC,EAAE2E,CAAC,GAAG1I,QAAQ,CAACyG,MAAM,EAAE1C,CAAC,GAAG2E,CAAC,EAAE,EAAE3E,CAAC;KAAA;KAAA,yBAI7C;;GAwEF,OAAOqD,MAAM;CACd;CAAC,8BAEmBuB,KAAK,EAAEtC,IAAI,EAC/B;GACC,IAAMuC,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;GAC3BD,IAAI,CAACE,KAAK,EAAE;;;GAGZ,IAAI,CAACC,yBAAyB,CAAC1C,IAAI,CAAC1E,MAAM,EAAE0E,IAAI,CAACxE,KAAK,EAAEwE,IAAI,CAACO,IAAI,CAAC;GAClEhB,6BAAY,CAACoD,IAAI,CAAC,IAAI,EAAE,UAAU,EAAE;KAAE3C,IAAI,EAAJA;IAAM,CAAC;CAC9C;CAAC,+BAiCoBsC,KAAK,EAC1B;GACC,IAAMC,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;GAC3BD,IAAI,CAACK,IAAI,EAAE;GAEXN,KAAK,CAACO,cAAc,EAAE;CACvB;;KCviBKC,aAAa,GAAG;GACrB9J,eAAe,EAAfA;CACD,CAAC;;;;;;;;;"}