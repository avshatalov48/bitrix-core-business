this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(D,u,e,F,t,s){"use strict";const i=navigator.userAgent.toLowerCase();const r={isChrome(){return s.Browser.isChrome()},isFirefox(){return s.Browser.isFirefox()},isIe(){return s.Browser.isIE()},isSafari(){if(this.isChrome()){return false}if(!i.includes("safari")){return false}return!this.isSafariBased()},isSafariBased(){if(!i.includes("applewebkit")){return false}return i.includes("yabrowser")||i.includes("yaapp_ios_browser")||i.includes("crios")},findParent(D,u){const e=u instanceof HTMLElement;if(!u||!s.Type.isString(u)&&!e){return null}for(;D&&D!==document;D=D.parentNode){if(s.Type.isString(u)){if(s.Dom.hasClass(u)){return D}}else if(e&&D===u){return D}}return null},openLink(D,u="_blank"){window.open(D,u,"",true)},waitForSelectionToUpdate(){return new Promise((D=>{setTimeout((()=>{D()}),0)}))}};const n={cast(D,u=new Date){let e=u;if(D instanceof Date){e=D}else if(s.Type.isString(D)){e=new Date(D)}else if(s.Type.isNumber(D)){e=new Date(D*1e3)}if(e instanceof Date&&Number.isNaN(e.getTime())){e=u}return e},getTimeToNextMidnight(){const D=new Date((new Date).setHours(24,0,0)).getTime();return D-Date.now()},getStartOfTheDay(){return new Date((new Date).setHours(0,0))},isToday(D){return this.cast(D).toDateString()===(new Date).toDateString()},isSameDay(D,u){return D.getFullYear()===u.getFullYear()&&D.getMonth()===u.getMonth()&&D.getDate()===u.getDate()}};const a=navigator.userAgent.toLowerCase();const C={isDesktop(){return!this.isMobile()},isMobile(){if(!s.Type.isUndefined(this.isMobileStatic)){return this.isMobileStatic}this.isMobileStatic=a.includes("android")||a.includes("webos")||a.includes("iphone")||a.includes("ipad")||a.includes("ipod")||a.includes("blackberry")||a.includes("windows phone");return this.isMobileStatic},orientationHorizontal:"horizontal",orientationPortrait:"portrait",getOrientation(){if(!this.isMobile()){return this.orientationHorizontal}return Math.abs(window.orientation)===0?this.orientationPortrait:this.orientationHorizontal}};const E=navigator.userAgent.toLowerCase();const o={isMac(){return s.Browser.isMac()},isLinux(){return s.Browser.isLinux()},isWindows(){return s.Browser.isWin()||!this.isMac()&&!this.isLinux()},isBitrixMobile(){return E.includes("bitrixmobile")},isBitrixDesktop(){return u.DesktopApi.isDesktop()},getDesktopVersion(){return u.DesktopApi.getApiVersion()},isDesktopFeatureEnabled(D){return u.DesktopApi.isFeatureEnabled(D)},isMobile(){return this.isAndroid()||this.isIos()||this.isBitrixMobile()},isIos(){return s.Browser.isIOS()},getIosVersion(){if(!this.isIos()){return null}const D=E.match(/(iphone|ipad)(.+)(OS\s([0-9]+)([_.]([0-9]+))?)/i);if(!D||!D[4]){return null}return parseFloat(D[4]+"."+(D[6]?D[6]:0))},isAndroid(){return s.Browser.isAndroid()},openNewPage(D){if(!D){return false}if(this.isBitrixMobile()){const u=window.BX.MobileTools;if(s.Type.isUndefined()){const e=u.resolveOpenFunction(D);if(e){e();return true}}window.app.openNewPage(D);return true}window.open(D,"_blank");return true}};const l={getLogTrackingParams(D={}){const u=[];let{name:e="tracking",data:F=[]}=D;const{dialog:t=null,message:i=null,files:r=null}=D;e=encodeURIComponent(e);if(s.Type.isPlainObject(F)){const D=[];for(const u in F){if(F.hasOwnProperty(u)){D.push(encodeURIComponent(u)+"="+encodeURIComponent(F[u]))}}F=D}else if(!s.Type.isArray(F)){F=[]}if(s.Type.isObjectLike(t)){u.push("timType="+t.type);if(t.type==="lines"){u.push("timLinesType="+t.entityId.split("|")[0])}}if(!s.Type.isNull(r)){let D="file";if(s.Type.isArray(r)&&r[0]){D=r[0].type}else if(s.Type.isObjectLike(r)){D=r.type}u.push("timMessageType="+D)}else if(!s.Type.isNull(i)){u.push("timMessageType=text")}if(o.isBitrixMobile()){u.push("timDevice=bitrixMobile")}else if(o.isBitrixDesktop()){u.push("timDevice=bitrixDesktop")}else if(o.isIos()||o.isAndroid()){u.push("timDevice=mobile")}else{u.push("timDevice=web")}return e+(F.length?"&"+F.join("&"):"")+(u.length?"&"+u.join("&"):"")}};
/**
	 * emoji-test-regex-pattern v15.1
	 * (c) Copyright Mathias Bynens <https://mathiasbynens.be/>
	 * @license MIT
	 *
	 * @source: https://github.com/mathiasbynens/emoji-test-regex-pattern/blob/main/dist/emoji-15.1/javascript.txt
	 */const c=/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g;const B={convertHtmlEntities(D){return s.Dom.create({tag:"span",html:D}).innerText},convertSnakeToCamelCase(D){return D.replace(/(_[a-z])/gi,(D=>D.toUpperCase().replace("_","")))},escapeRegex(D){return D.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},getLocalizeForNumber(D,u,e="en"){let F=1;u=parseInt(u);if(u<0){u=u*-1}if(e){switch(e){case"de":case"en":F=u!==1?1:0;break;case"ru":case"ua":F=u%10===1&&u%100!==11?0:u%10>=2&&u%10<=4&&(u%100<10||u%100>=20)?1:2;break}}return s.Loc.getMessage(D+"_PLURAL_"+F)},getFirstLetters(D){const u=/[\p{L}\p{N} ]/u;const e=D.split(/[\s,]/).filter((D=>{const e=D.charAt(0);return u.test(e)}));if(e.length===0){return""}if(e.length>1){return e[0].charAt(0)+e[1].charAt(0)}return e[0].charAt(0)},insertUnseenWhitespace(D,u){if(D.length<=u){return D}const e="\u200b";let F=D.slice(0,u+1);const t=D.slice(u+1);const s=/\s/.test(F);const i=/\[user=(\d+)(\s)?(replace)?](.*?)\[\/user]/gi.test(D);if(F.length===u+1&&!s&&!i){F+=e}return F+t},getUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(D=>{var u=Math.random()*16|0,e=D=="x"?u:u&3|8;return e.toString(16)}))},isUuidV4(D){if(!s.Type.isString(D)){return false}const u=new RegExp(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i);return D.search(u)===0},isTempMessage(D){return this.isUuidV4(D)||D.toString().startsWith("temp")},checkUrl(D){const u=["http:","https:","ftp:","file:","tel:","callto:","mailto:","skype:","viber:"];const e=["/",...u].find((u=>D.startsWith(u)));if(!e){return false}const F=s.Dom.create({tag:"a",attrs:{href:D}});return u.indexOf(F.protocol)>-1},isEmojiOnly(D){const u=D.replaceAll(c,"");return u.replaceAll(/\s/g,"").length===0},htmlspecialchars(D){return s.Text.encode(D)},htmlspecialcharsback(D){return s.Text.decode(D)},getWordsFromString(D){const u=D.replaceAll("("," ").replaceAll(")"," ").replaceAll("["," ").replaceAll("]"," ").replaceAll("{"," ").replaceAll("}"," ").replaceAll("<"," ").replaceAll(">"," ").replaceAll("-"," ").replaceAll("#"," ").replaceAll('"'," ").replaceAll("'"," ").replaceAll(/\s\s+/g," ");return u.split(" ").filter((D=>D!==""))},getMentionBbCode(D,u){if(s.Type.isString(D)&&D.startsWith("chat")){return`[CHAT=${D.slice(4)}]${u}[/CHAT]`}return`[USER=${D}]${u}[/USER]`}};const p=s.Extension.getSettings("im.v2.lib.utils");const A={getLastDateText(D={}){if(D.bot||D.network||!D.lastActivityDate){return""}const u=this.isOnline(D.lastActivityDate);const e=this.isMobileOnline(D.lastActivityDate,D.mobileLastDate);let t="";const i=this.getLastSeenText(D.lastActivityDate);if(u&&D.idle&&!e){t=s.Loc.getMessage("IM_STATUS_AWAY_TITLE").replace("#TIME#",this.getIdleText(D.idle))}else if(u&&!i){t=this.getStatusTextForLastDate(D.status)}else if(i){const u=`IM_LAST_SEEN_${D.gender}`;t=s.Loc.getMessage(u).replace("#POSITION#. ","").replace("#LAST_SEEN#",i)}if(D.absent){const u=s.Loc.getMessage("IM_STATUS_VACATION_TITLE").replace("#DATE#",F.DateFormatter.formatByCode(D.absent.getTime()/1e3,F.DateCode.shortDateFormat));t=t?`${t}. ${u}`:u}return t},getIdleText(D=""){if(!D){return""}return e.DateTimeFormat.format([["s60","sdiff"],["i60","idiff"],["H24","Hdiff"],["","ddiff"]],D)},isOnline(D){if(!D){return false}return Date.now()-D.getTime()<=this.getOnlineLimit()*1e3},isMobileOnline(D,u){if(!D||!u){return false}const e=5*60*1e3;return Date.now()-u.getTime()<this.getOnlineLimit()*1e3&&D-u<e},getStatusTextForLastDate(D){var u;D=D.toUpperCase();return(u=s.Loc.getMessage(`IM_STATUS_${D}`))!=null?u:D},getStatusText(D){var u;D=D.toUpperCase();return(u=s.Loc.getMessage(`IM_STATUS_TEXT_${D}`))!=null?u:D},getLastSeenText(D){if(!D){return""}const u=5*60*1e3;if(Date.now()-D.getTime()>u){return e.DateTimeFormat.formatLastActivityDate(D)}return""},isBirthdayToday(D){return D===e.DateTimeFormat.format("d-m",new Date)},getOnlineLimit(){const D=p.get("limitOnline",false);const u=15*60;return D?Number.parseInt(D,10):u},getProfileLink(D){if(s.Type.isString(D)){D=Number.parseInt(D,10)}return`/company/personal/user/${D}/`},getCalendarLink(D){if(s.Type.isString(D)){D=Number.parseInt(D,10)}const u=s.Extension.getSettings("im.v2.lib.utils").get("pathToUserCalendar");return u.replace("#user_id#",D)}};const d={getFileExtension(D){return D.split(".").splice(-1)[0]},getIconTypeByFilename(D){const u=this.getFileExtension(D);return this.getIconTypeByExtension(u)},getIconTypeByExtension(D){let u="empty";switch(D.toString()){case"png":case"jpe":case"jpg":case"jpeg":case"gif":case"heic":case"bmp":case"webp":u="img";break;case"mp4":case"mkv":case"webm":case"mpeg":case"hevc":case"avi":case"3gp":case"flv":case"m4v":case"ogg":case"wmv":case"mov":u="mov";break;case"txt":u="txt";break;case"doc":case"docx":u="doc";break;case"xls":case"xlsx":u="xls";break;case"php":u="php";break;case"pdf":u="pdf";break;case"ppt":case"pptx":u="ppt";break;case"rar":u="rar";break;case"zip":case"7z":case"tar":case"gz":case"gzip":u="zip";break;case"set":u="set";break;case"conf":case"ini":case"plist":u="set";break;default:u="empty"}return u},getFileTypeByExtension(D){let u=t.FileType.file;const e=D.toLowerCase();switch(e){case"png":case"jpe":case"jpg":case"jpeg":case"gif":case"heic":case"bmp":case"webp":u=t.FileType.image;break;case"mp4":case"mkv":case"webm":case"mpeg":case"hevc":case"avi":case"3gp":case"flv":case"m4v":case"ogg":case"wmv":case"mov":u=t.FileType.video;break;case"mp3":u=t.FileType.audio;break;default:u=t.FileType.file}return u},formatFileSize(D){let u=D;if(!u||u<=0){u=0}const e=["BYTE","KB","MB","GB","TB"];const F=1024;let t=0;while(u>=F&&t<e.length-1){u/=F;t++}const i=s.Loc.getMessage(`IM_UTILS_FILE_SIZE_${e[t]}`);const r=Math.round(u);return`${r} ${i}`},getShortFileName(D,u){if(!D||D.length<u){return D}const e="...";const F=1;const t=2;const s=this.getFileExtension(D);const i=s.length+F;const r=D.slice(0,-i);if(r.length<=u){return D}const n=u-t-e.length;if(n<=0){return D}const a=r.slice(0,n).trim();const C=r.slice(-t).trim();return`${a}${e}${C}.${s}`},getViewerDataAttributes(D){if(!D){return{}}const u={"data-viewer":true};Object.entries(D).forEach((([D,e])=>{u[`data-${s.Text.toKebabCase(D)}`]=e}));return u},createDownloadLink(D,u,e){const F=s.Dom.create("a",{text:D});s.Dom.style(F,"display","block");s.Dom.style(F,"color","inherit");s.Dom.style(F,"text-decoration","inherit");F.setAttribute("href",u);F.setAttribute("download",e);return F},isImage(D){const u=d.getFileExtension(D);const e=d.getFileTypeByExtension(u);return e===t.FileType.image},getBase64(D){const u=new FileReader;return new Promise((e=>{s.Event.bind(u,"load",(()=>{const D=u.result;const F=D.indexOf(",");const t=D.slice(F+1);e(t)}));u.readAsDataURL(D)}))}};const f="Key";const h="Digit";const g="Ctrl";const b="Alt";const m="Shift";const y=new Set([g,b,m]);var x=babelHelpers.classPrivateFieldLooseKey("event");var T=babelHelpers.classPrivateFieldLooseKey("prepareCombination");var v=babelHelpers.classPrivateFieldLooseKey("checkCombination");var L=babelHelpers.classPrivateFieldLooseKey("checkModifiers");var w=babelHelpers.classPrivateFieldLooseKey("checkShift");var S=babelHelpers.classPrivateFieldLooseKey("checkAlt");var k=babelHelpers.classPrivateFieldLooseKey("checkCtrl");var M=babelHelpers.classPrivateFieldLooseKey("splitCombinationIntoKeyCodes");class P{constructor(D){Object.defineProperty(this,M,{value:N});Object.defineProperty(this,k,{value:_});Object.defineProperty(this,S,{value:U});Object.defineProperty(this,w,{value:$});Object.defineProperty(this,L,{value:H});Object.defineProperty(this,v,{value:O});Object.defineProperty(this,T,{value:I});Object.defineProperty(this,x,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,x)[x]=D}isCmdOrCtrl(){if(o.isMac()){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].metaKey}if(o.isLinux()||o.isWindows()){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].ctrlKey}return false}isShift(){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].shiftKey}isAltOrOption(){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].altKey}isCombination(D){const u=babelHelpers.classPrivateFieldLooseBase(this,T)[T](D);return u.some((D=>babelHelpers.classPrivateFieldLooseBase(this,v)[v](D)))}isExactCombination(D){const u=babelHelpers.classPrivateFieldLooseBase(this,T)[T](D);return u.some((D=>babelHelpers.classPrivateFieldLooseBase(this,v)[v](D,true)))}}function I(D){if(Array.isArray(D)){return D}if(s.Type.isStringFilled(D)){return[D]}return[]}function O(D,u=false){if(!babelHelpers.classPrivateFieldLooseBase(this,L)[L](D,u)){return false}const e=babelHelpers.classPrivateFieldLooseBase(this,M)[M](D);let F=true;e.forEach((D=>{if(D!==babelHelpers.classPrivateFieldLooseBase(this,x)[x].code){F=false}}));return F}function H(D,u=false){let e=true;if(!babelHelpers.classPrivateFieldLooseBase(this,w)[w](D,u)||!babelHelpers.classPrivateFieldLooseBase(this,S)[S](D,u)||!babelHelpers.classPrivateFieldLooseBase(this,k)[k](D,u)){e=false}return e}function $(D,u=false){let e=true;const F=D.includes(m)&&!babelHelpers.classPrivateFieldLooseBase(this,x)[x].shiftKey;const t=u&&!D.includes(m)&&babelHelpers.classPrivateFieldLooseBase(this,x)[x].shiftKey;if(F||t){e=false}return e}function U(D,u=false){let e=true;const F=D.includes(b)&&!babelHelpers.classPrivateFieldLooseBase(this,x)[x].altKey;const t=u&&!D.includes(b)&&babelHelpers.classPrivateFieldLooseBase(this,x)[x].altKey;if(F||t){e=false}return e}function _(D,u=false){let e=true;const F=D.includes(g)&&!this.isCmdOrCtrl();const t=u&&!D.includes(g)&&this.isCmdOrCtrl();if(F||t){e=false}return e}function N(D){const u=D.split("+");const e=u.filter((D=>!y.has(D)));return e.map((D=>{const u=/^[A-Za-z]$/;const e=/^\d$/;if(u.test(D)){return`${f}${D.toUpperCase()}`}if(e.test(D)){return`${h}${D}`}return D}))}const j={isCmdOrCtrl(D){return new P(D).isCmdOrCtrl()},isShift(D){return new P(D).isShift()},isAltOrOption(D){return new P(D).isAltOrOption()},isCombination(D,u){return new P(D).isCombination(u)},isExactCombination(D,u){return new P(D).isExactCombination(u)}};const K={recursiveBackwardNodeSearch(D,u,e=10){while(e>0){if(s.Dom.hasClass(D,u)){return D}if(!D||!D.parentNode){return null}D=D.parentNode;e--}return null}};const z={isDialogId(D){return/^(chat\d+)$|^\d+$/i.test(D)},isExternalId(D){return this.isGroupExternalId(D)||this.isCrmExternalId(D)},isGroupExternalId(D){const u="sg";return D.startsWith(u)},isCrmExternalId(D){const u="crm|";return D.startsWith(u)},isLinesExternalId(D){const u="imol|";return D.toString().startsWith(u)&&!this.isLinesHistoryId(D)},isLinesHistoryId(D){return/^imol\|\d+$/.test(D)}};const V={isValidUrl(D){return/^(https|http):\/\/(.*)\/video\/([\d.a-z-]+)/i.test(D)},isValidCode(D){return/^([\d.a-z-]+)$/i.test(D)},isCurrentPortal(D){if(!s.Type.isStringFilled(D)){return false}const u=D.match(/^(https|http):\/\/(.*)\/video\/([\d.a-z-]+)/i);if(!u){return false}const e=u[2];return e.includes(location.host)},getCodeFromUrl(D){if(!s.Type.isStringFilled(D)){return null}const u=D.match(/^(https|http):\/\/(.*)\/video\/([\d.a-z-]+)/i);if(!u){return null}const e=u[3];if(!s.Type.isStringFilled(e)){return null}return e},getUrlByCode(D){if(!this.isValidCode(D)){return null}const u=location.origin.replace("http://","https://");return`${u}/video/${D}`},getCodeByOptions(D={}){if(s.Type.isStringFilled(D.link)&&this.isValidUrl(D.link)){return this.getCodeFromUrl(D.link)}if(s.Type.isStringFilled(D.code)&&this.isValidCode(D.code)){return D.code}return null},getWindowNameByCode(D){if(!this.isValidCode(D)){return null}return`im-conference-${D}`}};const X={isNumber(D){return/^([\d #()+./-]+)$/.test(D)}};const W={browser:r,date:n,device:C,platform:o,rest:l,text:B,user:A,file:d,dom:K,key:j,dialog:z,conference:V,call:X};D.Utils=W})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.Messenger.v2.Lib,BX.Main,BX.Im.V2.Lib,BX.Messenger.v2.Const,BX);
//# sourceMappingURL=utils.bundle.map.js