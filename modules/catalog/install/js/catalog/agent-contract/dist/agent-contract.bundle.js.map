{"version":3,"file":"agent-contract.bundle.js","sources":["../src/controller/controller.js","../src/controller/controller-factory.js","../src/model/model.js","../src/model/model-factory.js","../src/gridactions.js"],"sourcesContent":["export class AgentContractController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\twindow.top.BX.onCustomEvent('AgentContract:onDocumentSave');\n\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\tsliders.forEach((slider) => {\n\t\t\tslider.getWindow().BX.onCustomEvent('AgentContract:onDocumentSave');\n\t\t});\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {AgentContractController} from \"./controller\";\n\nexport class ControllersFactory\n{\n\tconstructor(eventName)\n\t{\n\t\tEventEmitter.subscribe(eventName + ':onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['agent_contract'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'agent_contract')\n\t\t{\n\t\t\treturn new AgentContractController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","export class AgentContractModel extends BX.UI.EntityModel\n{\n\tconstructor(id, settings) {\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tisCaptionEditable()\n\t{\n\t\treturn true;\n\t}\n\n\tgetCaption()\n\t{\n\t\tvar title = this.getField(\"TITLE\");\n\t\treturn BX.type.isString(title) ? title : \"\";\n\t}\n\n\tsetCaption(caption)\n\t{\n\t\tthis.setField(\"TITLE\", caption);\n\t}\n\n\tprepareCaptionData(data)\n\t{\n\t\tdata[\"TITLE\"] = this.getField(\"TITLE\", \"\");\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport {AgentContractModel} from \"./model\";\n\nexport class ModelFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorModelFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['agent_contract'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'agent_contract')\n\t\t{\n\t\t\treturn new AgentContractModel(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {ajax, Loc} from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nexport class GridActions\n{\n\tgrid;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.grid = options.grid || null;\n\n\t\tBX.addCustomEvent('AgentContract:onDocumentSave', () => {\n\t\t\tthis.grid?.reload();\n\t\t});\n\n\t\tBX.SidePanel.Instance.bindAnchors({\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\tcondition: [\n\t\t\t\t\t\tnew RegExp(\"/agent_contract/details/[0-9]+/\"),\n\t\t\t\t\t\tnew RegExp(\"/bitrix/admin/cat_agent_contract.php\\\\?ID=([0-9]+)\"),\n\t\t\t\t\t],\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\twidth: 650,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\t}\n\n\tdelete(id)\n\t{\n\t\tMessageBox.confirm(\n\t\t\tLoc.getMessage('CATALOG_AGENT_CONTRACT_TITLE_DELETE_CONTENT'),\n\t\t\t(messageBox, button) => {\n\t\t\t\tbutton.setWaiting();\n\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.agentcontract.entity.delete',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t).then(() => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tthis.grid?.reload();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tif (response.errors)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: BX.util.htmlspecialchars(response.errors[0].message),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t});\n\t\t\t},\n\t\t\tLoc.getMessage('CATALOG_AGENT_CONTRACT_BUTTON_CONFIRM'),\n\t\t\t(messageBox) => messageBox.close(),\n\t\t\tLoc.getMessage('CATALOG_AGENT_CONTRACT_BUTTON_BACK'),\n\t\t);\n\t}\n\n\tdeleteList()\n\t{\n\t\tlet ids = this.grid.getRows().getSelectedIds();\n\t\tajax.runAction(\n\t\t\t'catalog.agentcontract.entity.deleteList',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tids: ids,\n\t\t\t\t}\n\t\t\t}\n\t\t).then((response) => {\n\t\t\tthis.grid?.reload();\n\t\t}).catch((response) => {\n\t\t\tif (response.errors)\n\t\t\t{\n\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\tif (error.message)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: BX.util.htmlspecialchars(error.message),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.grid?.reload();\n\t\t});\n\t}\n}\n"],"names":["AgentContractController","BX","UI","EntityEditorController","constructor","id","settings","initialize","onAfterSave","window","top","onCustomEvent","sliders","SidePanel","Instance","getOpenSliders","forEach","slider","getWindow","ControllersFactory","eventName","EventEmitter","subscribe","event","eventArgs","getCompatData","methods","factory","bind","type","controlId","AgentContractModel","EntityModel","isCaptionEditable","getCaption","title","getField","isString","setCaption","caption","setField","prepareCaptionData","data","ModelFactory","GridActions","options","grid","addCustomEvent","reload","bindAnchors","rules","condition","RegExp","allowChangeHistory","cacheable","width","delete","MessageBox","confirm","Loc","getMessage","messageBox","button","setWaiting","ajax","runAction","then","close","catch","response","errors","Notification","Center","notify","content","util","htmlspecialchars","message","deleteList","ids","getRows","getSelectedIds","error"],"mappings":"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"}