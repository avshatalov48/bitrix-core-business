{"version":3,"file":"role.bundle.js","sources":["../src/role-manager.js"],"sourcesContent":["import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { UserRole } from 'im.v2.const';\n\ntype RoleItem = $Keys<typeof UserRole>;\n\ntype RawChatConfig = {\n\townerId?: number,\n\towner?: number,\n\tmanagers?: number[],\n\tmanager_list?: number[],\n}\n\ntype ChatConfig = {\n\townerId: number,\n\tmanagers: number[],\n}\n\nexport function getChatRoleForUser(rawChatConfig: RawChatConfig): RoleItem\n{\n\tconst chatConfig = prepareChatConfig(rawChatConfig);\n\tconst userId = Core.getUserId();\n\tif (chatConfig.ownerId === userId)\n\t{\n\t\treturn UserRole.owner;\n\t}\n\n\tif (chatConfig.managers.includes(userId))\n\t{\n\t\treturn UserRole.manager;\n\t}\n\n\treturn UserRole.member;\n}\n\nfunction prepareChatConfig(rawChatConfig: RawChatConfig): ChatConfig\n{\n\tconst result = {\n\t\townerId: 0,\n\t\tmanagers: [],\n\t};\n\n\tif (Type.isNumber(rawChatConfig.ownerId))\n\t{\n\t\tresult.ownerId = rawChatConfig.ownerId;\n\t}\n\n\tif (Type.isNumber(rawChatConfig.owner))\n\t{\n\t\tresult.ownerId = rawChatConfig.owner;\n\t}\n\n\tif (Type.isArray(rawChatConfig.managers))\n\t{\n\t\tresult.managers = rawChatConfig.managers;\n\t}\n\n\tif (Type.isArray(rawChatConfig.manager_list))\n\t{\n\t\tresult.managers = rawChatConfig.manager_list;\n\t}\n\n\treturn result;\n}\n"],"names":["getChatRoleForUser","rawChatConfig","chatConfig","prepareChatConfig","userId","Core","getUserId","ownerId","UserRole","owner","managers","includes","manager","member","result","Type","isNumber","isArray","manager_list"],"mappings":";;;;;;;CAmBO,SAASA,kBAAkB,CAACC,aAA4B,EAC/D;GACC,MAAMC,UAAU,GAAGC,iBAAiB,CAACF,aAAa,CAAC;GACnD,MAAMG,MAAM,GAAGC,2BAAI,CAACC,SAAS,EAAE;GAC/B,IAAIJ,UAAU,CAACK,OAAO,KAAKH,MAAM,EACjC;KACC,OAAOI,oBAAQ,CAACC,KAAK;;GAGtB,IAAIP,UAAU,CAACQ,QAAQ,CAACC,QAAQ,CAACP,MAAM,CAAC,EACxC;KACC,OAAOI,oBAAQ,CAACI,OAAO;;GAGxB,OAAOJ,oBAAQ,CAACK,MAAM;CACvB;CAEA,SAASV,iBAAiB,CAACF,aAA4B,EACvD;GACC,MAAMa,MAAM,GAAG;KACdP,OAAO,EAAE,CAAC;KACVG,QAAQ,EAAE;IACV;GAED,IAAIK,cAAI,CAACC,QAAQ,CAACf,aAAa,CAACM,OAAO,CAAC,EACxC;KACCO,MAAM,CAACP,OAAO,GAAGN,aAAa,CAACM,OAAO;;GAGvC,IAAIQ,cAAI,CAACC,QAAQ,CAACf,aAAa,CAACQ,KAAK,CAAC,EACtC;KACCK,MAAM,CAACP,OAAO,GAAGN,aAAa,CAACQ,KAAK;;GAGrC,IAAIM,cAAI,CAACE,OAAO,CAAChB,aAAa,CAACS,QAAQ,CAAC,EACxC;KACCI,MAAM,CAACJ,QAAQ,GAAGT,aAAa,CAACS,QAAQ;;GAGzC,IAAIK,cAAI,CAACE,OAAO,CAAChB,aAAa,CAACiB,YAAY,CAAC,EAC5C;KACCJ,MAAM,CAACJ,QAAQ,GAAGT,aAAa,CAACiB,YAAY;;GAG7C,OAAOJ,MAAM;CACd;;;;;;;;"}