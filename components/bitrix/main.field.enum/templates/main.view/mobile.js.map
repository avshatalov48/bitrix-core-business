{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nconst nodeEnum = (function ()\n{\n\tconst nodeEnum = function (select, container, isInlineEdit)\n\t{\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tthis.multiple = false;\n\t\tthis.select = null;\n\t\tthis.container = null;\n\t\tthis.isInlineEdit = null;\n\t\tthis.titles = [];\n\t\tthis.values = [];\n\t\tthis.defaultTitles = [];\n\t\tthis.init(select, container, isInlineEdit);\n\t};\n\tnodeEnum.prototype = {\n\t\tinit: function (select, container, isInlineEdit = true)\n\t\t{\n\t\t\tif (BX(select) && BX(container))\n\t\t\t{\n\t\t\t\tthis.select = select;\n\t\t\t\tthis.container = container;\n\t\t\t\tthis.isInlineEdit = isInlineEdit;\n\t\t\t\tif (!this.select.hasAttribute('bx-bound'))\n\t\t\t\t{\n\t\t\t\t\tthis.select.setAttribute('bx-bound', 'Y');\n\t\t\t\t\tBX.addCustomEvent(select, 'onChange', BX.delegate(function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.multiple = this.select.hasAttribute('multiple');\n\t\t\t\t\t\tthis.initValues();\n\t\t\t\t\t}, this));\n\t\t\t\t\tBX.bind(this.container, 'click', this.click);\n\t\t\t\t}\n\t\t\t\tthis.multiple = select.hasAttribute('multiple');\n\t\t\t\tthis.initValues();\n\t\t\t}\n\t\t},\n\t\tinitValues: function ()\n\t\t{\n\t\t\tthis.titles = [];\n\t\t\tthis.values = [];\n\t\t\tthis.defaultTitles = [];\n\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t{\n\t\t\t\tthis.titles.push(this.select.options[ii].textContent.trim());\n\t\t\t\tthis.values.push(this.select.options[ii].value);\n\t\t\t\tif (this.select.options[ii].hasAttribute('selected'))\n\t\t\t\t{\n\t\t\t\t\tthis.defaultTitles.push(this.select.options[ii].innerHTML);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tclick: function (e)\n\t\t{\n\t\t\tthis.show();\n\t\t\treturn BX.PreventDefault(e);\n\t\t},\n\t\tshow: function ()\n\t\t{\n\t\t\tif (this.titles.length > 0)\n\t\t\t{\n\t\t\t\tBXMobileApp.UI.SelectPicker.show({\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tvalues: this.titles,\n\t\t\t\t\tmultiselect: this.multiple,\n\t\t\t\t\tdefault_value: this.defaultTitles\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcallback: function (data)\n\t\t{\n\t\t\tthis.defaultTitles = [];\n\t\t\tif (data && data.values && data.values.length > 0)\n\t\t\t{\n\t\t\t\tlet keys = [];\n\t\t\t\tfor (let ii = 0; ii < this.titles.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tfor (let jj = 0; jj < data.values.length; jj++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.titles[ii] === data.values[jj])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkeys.push(this.values[ii]);\n\t\t\t\t\t\t\tthis.defaultTitles.push(this.titles[ii]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet html = '';\n\t\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tthis.select.options[ii].removeAttribute('selected');\n\t\t\t\t\tif (BX.util.in_array(this.select.options[ii].value, keys))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.select.options[ii].setAttribute('selected', 'selected');\n\t\t\t\t\t\tif (this.multiple)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml += this.select.options[ii].innerHTML + '<br>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = this.select.options[ii].innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (html === '' && !this.multiple)\n\t\t\t\t{\n\t\t\t\t\thtml = `<span style=\"color:grey\">${Loc.getMessage('interface_form_select')}</span>`;\n\t\t\t\t}\n\t\t\t\tthis.container.innerHTML = html;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tthis.select.options[ii].removeAttribute('selected');\n\t\t\t\t}\n\n\t\t\t\tthis.container.innerHTML = Loc.getMessage('USER_TYPE_ENUM_NO_VALUE');\n\t\t\t}\n\n\t\t\tif (this.isInlineEdit)\n\t\t\t{\n\t\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.select]);\n\t\t\t}\n\t\t}\n\t};\n\treturn nodeEnum;\n})();\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.Enum = function (params)\n{\n\tthis.init(params);\n};\nBX.Mobile.Field.Enum.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\tresult = new nodeEnum(\n\t\t\t\tnode,\n\t\t\t\tBX(`${node.id}_select`),\n\t\t\t\t(node.dataset.isInlineEdit !== 'false')\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t},\n};\n"],"names":["nodeEnum","select","container","isInlineEdit","click","BX","delegate","callback","multiple","titles","values","defaultTitles","init","prototype","hasAttribute","setAttribute","addCustomEvent","initValues","bind","ii","options","length","push","textContent","trim","value","innerHTML","e","show","PreventDefault","BXMobileApp","UI","SelectPicker","multiselect","default_value","data","keys","jj","html","removeAttribute","util","in_array","Loc","getMessage","onCustomEvent","window","app","exec","Mobile","Field","Enum","params","__proto__","bindElement","node","result","id","dataset"],"mappings":"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"}