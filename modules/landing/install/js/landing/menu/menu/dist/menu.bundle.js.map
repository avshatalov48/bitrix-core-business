{"version":3,"file":"menu.bundle.js","sources":["../src/build-tree.js","../src/make-flat-tree.js","../src/get-node-class.js","../src/menu.js"],"sourcesContent":["export default function buildTree(root: HTMLElement, selector, parent = null, depth = 0)\n{\n\treturn [...root.querySelectorAll(selector)]\n\t\t.filter((element) => {\n\t\t\treturn element.parentElement.closest(selector) === parent;\n\t\t})\n\t\t.map((element) => {\n\t\t\tconst newDepth = depth + 1;\n\t\t\treturn {\n\t\t\t\tlayout: element,\n\t\t\t\tchildren: buildTree(element, selector, element, newDepth),\n\t\t\t\tdepth,\n\t\t\t};\n\t\t});\n}","import {MenuItem} from 'landing.menu.menuitem';\n\nexport default function makeFlatTree(tree: Array<MenuItem>, acc = []): Array<MenuItem>\n{\n\ttree.forEach((item) => {\n\t\tacc.push(item);\n\t\tmakeFlatTree(item.children, acc);\n\t});\n\n\treturn acc;\n}","export default function getNodeClass(type)\n{\n\tif (type === 'link')\n\t{\n\t\treturn BX.Landing.Node.Link;\n\t}\n\n\tif (type === 'img')\n\t{\n\t\treturn BX.Landing.Node.Img;\n\t}\n\n\tif (type === 'icon')\n\t{\n\t\treturn BX.Landing.Node.Icon;\n\t}\n\n\tif (type === 'embed')\n\t{\n\t\treturn BX.Landing.Node.Embed;\n\t}\n\n\tif (type === 'map')\n\t{\n\t\treturn BX.Landing.Node.Map;\n\t}\n\n\tif (type === 'component')\n\t{\n\t\treturn BX.Landing.Node.Component;\n\t}\n\n\treturn BX.Landing.Node.Text;\n}","import {Event, Cache, Tag, Dom, Type, Text} from 'main.core';\nimport {Loc} from 'landing.loc';\nimport {Env} from 'landing.env';\nimport {Main} from 'landing.main';\nimport {Backend} from 'landing.backend';\nimport {MenuItem} from 'landing.menu.menuitem';\nimport {MenuForm} from 'landing.ui.form.menuform';\nimport {StylePanel} from 'landing.ui.panel.stylepanel';\nimport buildTree from './build-tree';\nimport makeFlatTree from './make-flat-tree';\nimport getNodeClass from './get-node-class';\n\nimport './css/style.css';\n\n/**\n * @memberOf BX.Landing.Menu\n */\nexport class Menu extends Event.EventEmitter\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.Menu.Menu');\n\n\t\tthis.code = options.code;\n\t\tthis.root = options.root;\n\t\tthis.block = options.block;\n\t\tthis.manifest = Object.freeze({...options.manifest});\n\t\tthis.cache = new Cache.MemoryCache();\n\n\t\tif (\n\t\t\tEnv.getInstance().getType() === 'KNOWLEDGE'\n\t\t\t|| Env.getInstance().getType() === 'GROUP'\n\t\t)\n\t\t{\n\t\t\tif (Dom.hasClass(this.root.nextElementSibling, 'landing-menu-add'))\n\t\t\t{\n\t\t\t\tDom.remove(this.root.nextElementSibling);\n\t\t\t}\n\n\t\t\tDom.addClass(this.root, 'landing-menu-root-list');\n\t\t\tDom.insertAfter(this.getAddPageLayout(), this.root);\n\t\t}\n\n\t\tEvent.bind(this.root, 'click', (event: MouseEvent) => {\n\t\t\tif (\n\t\t\t\t!StylePanel.getInstance().isShown()\n\t\t\t\t&& event.target.nodeName === 'A'\n\t\t\t)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlet href = Dom.attr(event.target, 'href');\n\t\t\t\tconst hrefPagePrefix = 'page:';\n\t\t\t\tif (href.startsWith(hrefPagePrefix))\n\t\t\t\t{\n\t\t\t\t\thref = href.replace(hrefPagePrefix, '');\n\t\t\t\t}\n\t\t\t\tif (href.startsWith('#landing'))\n\t\t\t\t{\n\t\t\t\t\tconst pageId = Text.toNumber(href.replace('#landing', ''));\n\t\t\t\t\tthis.reloadPage(pageId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateMenuItem(options): MenuItem\n\t{\n\t\tconst nodes = new BX.Landing.Collection.NodeCollection();\n\n\t\tObject.entries(this.manifest.nodes).forEach(([code, nodeManifest]) => {\n\t\t\tconst nodeElements = [\n\t\t\t\t...options.layout.querySelectorAll(code),\n\t\t\t].filter((nodeElement) => {\n\t\t\t\tconst elementParent = nodeElement.closest(this.manifest.item);\n\t\t\t\treturn elementParent === options.layout;\n\t\t\t});\n\n\t\t\tif (nodeElements.length > 0)\n\t\t\t{\n\t\t\t\tconst NodeClass = getNodeClass(nodeManifest.type);\n\n\t\t\t\tnodeElements.forEach((nodeElement) => {\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew NodeClass({\n\t\t\t\t\t\t\tnode: nodeElement,\n\t\t\t\t\t\t\tmanifest: {...nodeManifest, allowInlineEdit: false, menuMode: true},\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn new MenuItem({\n\t\t\tlayout: options.layout,\n\t\t\tchildren: options.children.map((itemOptions, index) => {\n\t\t\t\treturn this.createMenuItem({...itemOptions, index});\n\t\t\t}),\n\t\t\tselector: `${this.manifest.item}@${options.index}`,\n\t\t\tdepth: options.depth,\n\t\t\tnodes,\n\t\t});\n\t}\n\n\tgetTree()\n\t{\n\t\tconst {item} = this.manifest;\n\t\treturn buildTree(this.root, item)\n\t\t\t.map((options, index) => this.createMenuItem({...options, index}));\n\t}\n\n\tgetFlatTree()\n\t{\n\t\treturn makeFlatTree(this.getTree());\n\t}\n\n\tgetForm(): MenuForm\n\t{\n\t\treturn new MenuForm({\n\t\t\ttitle: Loc.getMessage('LANDING_MENU_TITLE'),\n\t\t\ttype: 'menu',\n\t\t\tcode: this.code,\n\t\t\tforms: this.getFlatTree().map((item) => {\n\t\t\t\treturn item.getForm();\n\t\t\t}),\n\t\t});\n\t}\n\n\tgetAddPageButton(): HTMLButtonElement\n\t{\n\t\treturn this.cache.remember('addPageButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-icon-add ui-btn-round landing-ui-menu-add-button\"\n\t\t\t\t\tonclick=\"${this.onAddPageButtonClick.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageTextInputKeydown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 13)\n\t\t{\n\t\t\tthis.addPage();\n\t\t}\n\t}\n\n\taddPage()\n\t{\n\t\tconst input = this.getAddPageInput();\n\t\tconst {value} = input;\n\n\t\tinput.value = '';\n\t\tinput.focus();\n\n\t\tif (Type.isStringFilled(value))\n\t\t{\n\t\t\tconst code = BX.translit(\n\t\t\t\tvalue,\n\t\t\t\t{\n\t\t\t\t\tchange_case: 'L',\n\t\t\t\t\treplace_space: '-',\n\t\t\t\t\treplace_other: '',\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tconst backend = Backend.getInstance();\n\n\t\t\tbackend\n\t\t\t\t.createPage({\n\t\t\t\t\ttitle: value,\n\t\t\t\t\tmenuCode: this.code,\n\t\t\t\t\tblockId: this.block,\n\t\t\t\t\tcode,\n\t\t\t\t})\n\t\t\t\t.then((id) => {\n\t\t\t\t\tconst li = this.createLi({\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t\thref: `#landing${id}`,\n\t\t\t\t\t\ttarget: '_self',\n\t\t\t\t\t\tchildren: [],\n\t\t\t\t\t});\n\n\t\t\t\t\tDom.append(li, this.root);\n\t\t\t\t\tDom.remove(this.getAddPageField());\n\t\t\t\t\tDom.removeClass(this.root, 'landing-menu-root-list-with-field');\n\t\t\t\t\tDom.removeClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\n\t\t\t\t\tthis.reloadPage(id);\n\t\t\t\t});\n\t\t}\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\treloadPage(id: number)\n\t{\n\t\tconst main = Main.getInstance();\n\t\tconst url = Env.getInstance().getLandingEditorUrl({\n\t\t\tlanding: id,\n\t\t});\n\n\t\tvoid main.reloadSlider(url);\n\t}\n\n\tgetAddPageInput(): TextField\n\t{\n\t\treturn this.cache.remember('addPageTextInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"landing-menu-add-field-input\"\n\t\t\t\t\tplaceholder=\"${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\"\n\t\t\t\t\tonkeydown=\"${this.onAddPageTextInputKeydown.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageInputCloseButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst input = this.getAddPageInput();\n\n\t\tinput.value = '';\n\t\tDom.removeClass(this.root, 'landing-menu-root-list-with-field');\n\t\tDom.removeClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\t\tDom.remove(this.getAddPageField());\n\t\tDom.append(this.getAddPageButton(), this.getAddPageLayout());\n\t}\n\n\tgetAddPageInputCloseButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInputCloseButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"landing-menu-add-field-close\"\n\t\t\t\t\tonclick=\"${this.onAddPageInputCloseButtonClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('LANDING_MENU_CLOSE_BUTTON_LABEL')}\"\n\t\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageInputApplyButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInputApplyButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"landing-menu-add-field-apply\"\n\t\t\t\t\tonclick=\"${this.onAddPageInputApplyButtonClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('LANDING_MENU_APPLY_BUTTON_LABEL')}\"\n\t\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageInputApplyButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.addPage();\n\t}\n\n\tgetAddPageField(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add-field\">\n\t\t\t\t\t${this.getAddPageInput()}\n\t\t\t\t\t${this.getAddPageInputApplyButton()}\n\t\t\t\t\t${this.getAddPageInputCloseButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add\">\n\t\t\t\t\t${this.getAddPageButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tDom.addClass(this.root, 'landing-menu-root-list-with-field');\n\t\tDom.addClass(this.getAddPageLayout(), 'landing-menu-add-with-background');\n\t\tDom.prepend(this.getAddPageField(), this.getAddPageLayout());\n\t\tDom.remove(this.getAddPageButton());\n\t\tthis.getAddPageInput().focus();\n\t}\n\n\tcreateList(items, type = 'root')\n\t{\n\t\tconst {ulClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<ul class=\"${ulClassName}\">${items.map((item) => this.createLi(item, type))}</ul>\n\t\t`;\n\t}\n\n\tcreateA(item, type = 'root')\n\t{\n\t\tconst {aClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<a class=\"${aClassName}\" href=\"${item.href}\" target=\"${item.target}\">${Text.encode(item.text)}</a>\n\t\t`;\n\t}\n\n\tcreateLi(item, type = 'root')\n\t{\n\t\tconst {liClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<li class=\"${liClassName}\">\n\t\t\t\t${this.createA(item, type)}\n\t\t\t\t${item.children ? this.createList(item.children, 'children') : undefined}\n\t\t\t</li>\n\t\t`;\n\t}\n\n\trebuild(items)\n\t{\n\t\tconst newList = this.createList(items);\n\n\t\tDom.replace(this.root, newList);\n\t\tthis.root = newList;\n\t}\n}"],"names":["buildTree","root","selector","parent","depth","querySelectorAll","filter","element","parentElement","closest","map","newDepth","layout","children","makeFlatTree","tree","acc","forEach","item","push","getNodeClass","type","BX","Landing","Node","Link","Img","Icon","Embed","Map","Component","Text","Menu","options","setEventNamespace","code","block","manifest","Object","freeze","cache","Cache","MemoryCache","Env","getInstance","getType","Dom","hasClass","nextElementSibling","remove","addClass","insertAfter","getAddPageLayout","Event","bind","event","StylePanel","isShown","target","nodeName","preventDefault","href","attr","hrefPagePrefix","startsWith","replace","pageId","toNumber","reloadPage","nodes","Collection","NodeCollection","entries","nodeManifest","nodeElements","nodeElement","elementParent","length","NodeClass","node","allowInlineEdit","menuMode","MenuItem","itemOptions","index","createMenuItem","getTree","MenuForm","title","Loc","getMessage","forms","getFlatTree","getForm","remember","Tag","render","onAddPageButtonClick","keyCode","addPage","input","getAddPageInput","value","focus","Type","isStringFilled","translit","change_case","replace_space","replace_other","backend","Backend","createPage","menuCode","blockId","then","id","li","createLi","text","append","getAddPageField","removeClass","main","Main","url","getLandingEditorUrl","landing","reloadSlider","onAddPageTextInputKeydown","getAddPageButton","onAddPageInputCloseButtonClick","onAddPageInputApplyButtonClick","getAddPageInputApplyButton","getAddPageInputCloseButton","prepend","items","ulClassName","aClassName","encode","liClassName","createA","createList","undefined","newList","EventEmitter"],"mappings":"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"}