{"version":3,"file":"sidebar.bundle.js","sources":["../src/component/bx-messenger-sidebar.js","../src/sidebar.js"],"sourcesContent":["/**\n * Bitrix im\n * Sidebar vue component\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nBitrixVue.component('bx-im-component-sidebar',\n\t{\n\t\tdata: function()\n\t\t{\n\t\t\treturn {\n\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\n\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\t...Vuex.mapState({\n\t\t\t\t\trecent: state => state.recent.collection.general,\n\t\t\t\t\tpinned: state => state.recent.collection.pinned\n\t\t\t\t}),\n\n\t\t\t\trecentData()\n\t\t\t\t{\n\t\t\t\t\treturn [...this.recent, ...this.pinned];\n\t\t\t\t}\n\t\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tgetController()\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Data.get('controller');\n\t\t\t\t},\n\n\t\t\t\tgetStore()\n\t\t\t\t{\n\t\t\t\t\treturn this.getController().store;\n\t\t\t\t},\n\n\t\t\t\tonScroll(event)\n\t\t\t\t{\n\t\t\t\t\tif (this.oneScreenRemaining(event))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getController().recent.loadMore();\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonClick(event)\n\t\t\t\t{\n\t\t\t\t\tthis.getController().recent.openOldDialog(event);\n\t\t\t\t},\n\n\t\t\t\tonRightClick(event)\n\t\t\t\t{\n\t\t\t\t\tthis.getController().recent.openOldContextMenu(event);\n\t\t\t\t},\n\n\t\t\t\toneScreenRemaining(event)\n\t\t\t\t{\n\t\t\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t\t\t}\n\t\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"sidebar-wrap\">\n\t\t\t\t<bx-im-view-list-sidebar\n\t\t\t\t\t:recentData=\"recentData\"\n\t\t\t\t\t@scroll=\"onScroll\"\n\t\t\t\t\t@click=\"onClick\"\n\t\t\t\t\t@rightClick=\"onRightClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t`\n\t});","/**\n * Bitrix Im\n * Core application\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\nimport {Core} from \"im.application.core\";\nimport {VueVendorV2} from \"ui.vue\";\n\n// vue components\nimport './component/bx-messenger-sidebar';\nimport './sidebar.css';\nimport \"im.view.list.recent\";\nimport \"im.view.list.sidebar\";\n\nexport class SidebarApplication\n{\n\t/* region 01. Initialize */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.templateTemp = null;\n\t\tthis.rootNodeTemp = this.params.nodeTemp || document.createElement('div');\n\n\t\tthis.eventBus = new VueVendorV2;\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initParams())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t})\n\t\t});\n\t}\n\n\tinitParams()\n\t{\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComponent()\n\t{\n\t\treturn this.controller.createVue(this, {\n\t\t\tel: this.rootNode,\n\t\t\ttemplate: `<bx-im-component-sidebar/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t})\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromise.resolve(this);\n\n\t\treturn this.requestData();\n\t}\n\n\trequestData()\n\t{\n\t\tthis.controller.recent.drawPlaceholders();\n\t\tthis.controller.recent.getRecentData();\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\t/* endregion 01. Initialize */\n\n\t/* region 02. Event Bus */\n\temit(eventName, params = {})\n\t{\n\t\tthis.eventBus.$emit(eventName, params);\n\n\t\treturn true;\n\t}\n\n\tlisten(eventName, callback)\n\t{\n\t\tif (typeof callback !== 'function')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.eventBus.$on(eventName, callback);\n\n\t\treturn true;\n\t}\n\t/* endregion 02. Event Bus */\n}"],"names":["BitrixVue","component","data","created","computed","Vuex","mapState","recent","state","collection","general","pinned","recentData","methods","getController","$Bitrix","Data","get","getStore","store","onScroll","event","oneScreenRemaining","loadMore","onClick","openOldDialog","onRightClick","openOldContextMenu","target","scrollTop","clientHeight","scrollHeight","template","SidebarApplication","params","inited","initPromise","BX","Promise","rootNode","node","document","createElement","templateTemp","rootNodeTemp","nodeTemp","eventBus","VueVendorV2","initCore","then","initParams","initComponent","initComplete","resolve","reject","Core","ready","controller","createVue","el","vue","requestData","drawPlaceholders","getRecentData","promise","eventName","$emit","callback","$on"],"mappings":";;;;;;;AAAA;CAYA;CACA;CACA;AACAA,iBAAS,CAACC,SAAS,CAAC,yBAAyB,EAC5C;GACCC,IAAI,EAAE,gBACN;KACC,OAAO,EAEN;IACD;GACDC,OAAO,qBACP,EAEC;GACDC,QAAQ,kCAEHC,gBAAI,CAACC,QAAQ,CAAC;KAChBC,MAAM,EAAE,gBAAAC,KAAK;OAAA,OAAIA,KAAK,CAACD,MAAM,CAACE,UAAU,CAACC,OAAO;;KAChDC,MAAM,EAAE,gBAAAH,KAAK;OAAA,OAAIA,KAAK,CAACD,MAAM,CAACE,UAAU,CAACE,MAAM;;IAC/C,CAAC;KAEFC,UAAU,wBACV;OACC,gDAAW,IAAI,CAACL,MAAM,kCAAK,IAAI,CAACI,MAAM;;KAEvC;GACFE,OAAO,EACN;KACCC,aAAa,2BACb;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,IAAI,CAACC,GAAG,CAAC,YAAY,CAAC;MAC1C;KAEDC,QAAQ,sBACR;OACC,OAAO,IAAI,CAACJ,aAAa,EAAE,CAACK,KAAK;MACjC;KAEDC,QAAQ,oBAACC,KAAK,EACd;OACC,IAAI,IAAI,CAACC,kBAAkB,CAACD,KAAK,CAAC,EAClC;SACC,IAAI,CAACP,aAAa,EAAE,CAACP,MAAM,CAACgB,QAAQ,EAAE;;MAEvC;KAEDC,OAAO,mBAACH,KAAK,EACb;OACC,IAAI,CAACP,aAAa,EAAE,CAACP,MAAM,CAACkB,aAAa,CAACJ,KAAK,CAAC;MAChD;KAEDK,YAAY,wBAACL,KAAK,EAClB;OACC,IAAI,CAACP,aAAa,EAAE,CAACP,MAAM,CAACoB,kBAAkB,CAACN,KAAK,CAAC;MACrD;KAEDC,kBAAkB,8BAACD,KAAK,EACxB;OACC,OAAOA,KAAK,CAACO,MAAM,CAACC,SAAS,GAAGR,KAAK,CAACO,MAAM,CAACE,YAAY,IAAIT,KAAK,CAACO,MAAM,CAACG,YAAY,GAAGV,KAAK,CAACO,MAAM,CAACE,YAAY;;IAEnH;GACFE,QAAQ;CAUT,CAAC,CAAC;;CCpFH;CACA;CACA;CACA;CACA;CACA;CACA;CACA;AACA,KASaC,kBAAkB;;;GAI9B,8BACA;KAAA;KAAA,IADYC,MAAM,uEAAG,EAAE;KAAA;KAEtB,IAAI,CAACC,MAAM,GAAG,KAAK;KACnB,IAAI,CAACC,WAAW,GAAG,IAAIC,EAAE,CAACC,OAAO;KAEjC,IAAI,CAACJ,MAAM,GAAGA,MAAM;KAEpB,IAAI,CAACF,QAAQ,GAAG,IAAI;KACpB,IAAI,CAACO,QAAQ,GAAG,IAAI,CAACL,MAAM,CAACM,IAAI,IAAIC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;KAEjE,IAAI,CAACC,YAAY,GAAG,IAAI;KACxB,IAAI,CAACC,YAAY,GAAG,IAAI,CAACV,MAAM,CAACW,QAAQ,IAAIJ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;KAEzE,IAAI,CAACI,QAAQ,GAAG,IAAIC,kBAAW;KAE/B,IAAI,CAACC,QAAQ,EAAE,CACbC,IAAI,CAAC;OAAA,OAAM,KAAI,CAACC,UAAU,EAAE;OAAC,CAC7BD,IAAI,CAAC;OAAA,OAAM,KAAI,CAACE,aAAa,EAAE;OAAC,CAChCF,IAAI,CAAC;OAAA,OAAM,KAAI,CAACG,YAAY,EAAE;OAAC;;GAEjC;KAAA;KAAA,2BAGD;OAAA;OACC,OAAO,IAAId,OAAO,CAAC,UAACe,OAAO,EAAEC,MAAM,EAAK;SACvCC,wBAAI,CAACC,KAAK,EAAE,CAACP,IAAI,CAAC,UAAAQ,UAAU,EAAI;WAC/B,MAAI,CAACA,UAAU,GAAGA,UAAU;WAC5BJ,OAAO,EAAE;UACT,CAAC;QACF,CAAC;;;KACF;KAAA,6BAGD;OACC,OAAO,IAAIf,OAAO,CAAC,UAACe,OAAO,EAAEC,MAAM;SAAA,OAAKD,OAAO,EAAE;SAAC;;;KAClD;KAAA,gCAGD;OAAA;OACC,OAAO,IAAI,CAACI,UAAU,CAACC,SAAS,CAAC,IAAI,EAAE;SACtCC,EAAE,EAAE,IAAI,CAACpB,QAAQ;SACjBP,QAAQ;QACR,CAAC,CACDiB,IAAI,CAAC,UAAAW,GAAG,EAAI;SACZ,MAAI,CAAC5B,QAAQ,GAAG4B,GAAG;SACnB,OAAO,IAAItB,OAAO,CAAC,UAACe,OAAO,EAAEC,MAAM;WAAA,OAAKD,OAAO,EAAE;WAAC;QAClD,CAAC;;;KACF;KAAA,+BAGD;OACC,IAAI,CAAClB,MAAM,GAAG,IAAI;OAClB,IAAI,CAACC,WAAW,CAACiB,OAAO,CAAC,IAAI,CAAC;OAE9B,OAAO,IAAI,CAACQ,WAAW,EAAE;;;KACzB;KAAA,8BAGD;OACC,IAAI,CAACJ,UAAU,CAAClD,MAAM,CAACuD,gBAAgB,EAAE;OACzC,IAAI,CAACL,UAAU,CAAClD,MAAM,CAACwD,aAAa,EAAE;OAEtC,OAAO,IAAIzB,OAAO,CAAC,UAACe,OAAO,EAAEC,MAAM;SAAA,OAAKD,OAAO,EAAE;SAAC;;;KAClD;KAAA,wBAGD;OACC,IAAI,IAAI,CAAClB,MAAM,EACf;SACC,IAAI6B,OAAO,GAAG,IAAI3B,EAAE,CAACC,OAAO;SAC5B0B,OAAO,CAACX,OAAO,CAAC,IAAI,CAAC;SAErB,OAAOW,OAAO;;OAGf,OAAO,IAAI,CAAC5B,WAAW;;;;;KAKxB;KAAA,qBACK6B,SAAS,EACd;OAAA,IADgB/B,MAAM,uEAAG,EAAE;OAE1B,IAAI,CAACY,QAAQ,CAACoB,KAAK,CAACD,SAAS,EAAE/B,MAAM,CAAC;OAEtC,OAAO,IAAI;;;KACX;KAAA,uBAEM+B,SAAS,EAAEE,QAAQ,EAC1B;OACC,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAClC;SACC,OAAO,KAAK;;OAGb,IAAI,CAACrB,QAAQ,CAACsB,GAAG,CAACH,SAAS,EAAEE,QAAQ,CAAC;OAEtC,OAAO,IAAI;MACX;;GACD;CAAA;;;;;;;;"}