this.BX=this.BX||{};this.BX.UI=this.BX.UI||{};(function(e,t,i,s){"use strict";let a=e=>e,r,o,l,n,d,c,p;const v=BX.SidePanel;const m="mailProviderShowcase";const h="mail-mailbox-config-success";const u="other";const b="mailbox";var I=babelHelpers.classPrivateFieldLooseKey("wasSenderUpdated");var g=babelHelpers.classPrivateFieldLooseKey("createSmtpItemNode");var S=babelHelpers.classPrivateFieldLooseKey("createShowcase");var L=babelHelpers.classPrivateFieldLooseKey("createProvidersList");var E=babelHelpers.classPrivateFieldLooseKey("createPromotionShowcase");var P=babelHelpers.classPrivateFieldLooseKey("getProviderKey");var _=babelHelpers.classPrivateFieldLooseKey("getProviderName");var M=babelHelpers.classPrivateFieldLooseKey("getProviderImgSrcClass");class f{constructor(e=null){var i,s,o,l;Object.defineProperty(this,M,{value:w});Object.defineProperty(this,_,{value:N});Object.defineProperty(this,P,{value:B});Object.defineProperty(this,E,{value:O});Object.defineProperty(this,L,{value:R});Object.defineProperty(this,S,{value:C});Object.defineProperty(this,g,{value:A});Object.defineProperty(this,I,{writable:true,value:false});this.isSender=(i=e.isSender)!=null?i:false;this.setSenderCallback=(s=e.setSenderCallback)!=null?s:null;this.addSenderCallback=(o=e.addSenderCallback)!=null?o:null;this.updateSenderList=(l=e.updateSenderList)!=null?l:null;this.container=t.Tag.render(r||(r=a`
			<div class="showcase-container"></div>
		`))}static openSlider(e){const a=new f(e);const r=function(e){const[i]=e.getData();if(!i){return}const r=v.Instance.getSlider(m);if(!r||i.getEventId()!==h){return}const o=i.data.id;if(!o){return}babelHelpers.classPrivateFieldLooseBase(a,I)[I]=true;r.close();top.BX.SidePanel.Instance.postMessage(window,i.getEventId(),i.data);t.ajax.runAction("main.api.mail.sender.getSenderByMailboxId",{data:{mailboxId:o,getSenderWithoutSmtp:!a.options.isCloud}}).then((e=>{const t=e.data;if(!t){return}a.setSender(t.id,t.name,t.email);if(a.addSenderCallback||t.type===b){return}s.AliasEditor.openSlider({senderId:t.id,email:t.email,setSenderCallback:a.setSenderCallback,updateSenderList:()=>{void a.updateSenderList()}})})).catch((()=>{}))};v.Instance.open(m,{width:790,cacheable:false,contentCallback:()=>i.Layout.createContent({extensions:["ui.mail.provider-showcase"],title:t.Loc.getMessage("UI_MAIL_PROVIDER_SHOWCASE_TITLE"),design:{section:false},content(){return a.load()},buttons:()=>{}}),events:{onClose:()=>{top.BX.Event.EventEmitter.unsubscribe("SidePanel.Slider:onMessage",r);if(a.updateSenderList&&babelHelpers.classPrivateFieldLooseBase(a,I)[I]){a.updateSenderList()}}}});top.BX.Event.EventEmitter.subscribe("SidePanel.Slider:onMessage",r)}static renderTo(e,i){const s=new f(i);return new Promise(((i,a)=>{s.load().then((s=>{t.Dom.append(s,e);i(s)})).catch((()=>{a()}))}))}load(){return t.ajax.runAction("main.api.mail.mailproviders.getShowcaseParams",{data:{isSender:this.isSender?1:0}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S](e.data);return this.container})).catch((()=>{}))}setSender(e,t,i){const s=t;const a=i;if(this.setSenderCallback){this.setSenderCallback(e,s,a)}if(!this.addSenderCallback){return}const r=[];r.name=s;r.email=a;this.addSenderCallback(r)}}function A(){this.smtpNode=t.Tag.render(o||(o=a`
			<div class="mail-provider-item mail-provider-item-available">
				<div class="mail-provider-img-container">
					<div class="mail-provider-img-smtp"></div>
				</div>
				<div class="mail-provider-item-title-container">
					<span class="mail-provider-item-title">${0}</span>
				</div>
			</div>
		`),t.Loc.getMessage("UI_MAIL_PROVIDER_SMTP_TITLE"));t.Event.bind(this.smtpNode,"click",(()=>{const e=BX.SidePanel.Instance.getTopSlider();if(e){s.SmtpEditor.openSlider({setSenderCallback:(t,i,s)=>{if(this.setSenderCallback&&t&&i&&s){this.setSenderCallback(t,i,s)}this.updateSenderList();e.close()},addSenderCallback:this.addSenderCallback})}}));if(this.options.isMailToolAvailable&&this.options.canConnectNewMailbox){return}t.Dom.addClass(this.smtpNode,"available-mail-provider-item");t.Dom.attr(this.smtpNode,"data-tag",t.Loc.getMessage("UI_MAIL_PROVIDER_AVAILABLE_TAG"))}function C(e){this.options=e.options;this.providers=e.providers;this.showcaseNode=t.Tag.render(l||(l=a`
			<div class="mail-provider-list"></div>
		`));t.Dom.append(this.showcaseNode,this.container);babelHelpers.classPrivateFieldLooseBase(this,L)[L]();if(!this.isSender||!this.options.isSmtpAvailable){return}babelHelpers.classPrivateFieldLooseBase(this,g)[g]();const i=this.showcaseNode.firstChild;if(!i||this.options.canConnectNewMailbox&&this.options.isMailToolAvailable){t.Dom.append(this.smtpNode,this.showcaseNode)}else{t.Dom.insertBefore(this.smtpNode,i)}if(this.options.isModuleMailInstalled){return}babelHelpers.classPrivateFieldLooseBase(this,E)[E]()}function R(){if(!this.providers){return}this.providers.forEach((e=>{var i;const s=babelHelpers.classPrivateFieldLooseBase(this,P)[P](e.name);const r=e.name;const{root:o,title:l}=t.Tag.render(n||(n=a`
				<a class="mail-provider-item mail-provider-item-available">
					<div class="mail-provider-img-container">
						<div class="mail-provider-img ${0}"></div>
					</div>
					<div class="mail-provider-item-title-container" ref="title">
						<span class="mail-provider-item-title">${0}</span>
					</div>
				</a>
			`),babelHelpers.classPrivateFieldLooseBase(this,M)[M](s),t.Text.encode((i=babelHelpers.classPrivateFieldLooseBase(this,_)[_](s))!=null?i:r[0].toUpperCase()+r.slice(1)));if(e.name===u){const e=t.Tag.render(d||(d=a`
					<span class="mail-provider-item-subtitle">${0}</span>
				`),t.Loc.getMessage("UI_MAIL_PROVIDER_IMAP_SUBTITLE"));t.Dom.append(e,l)}if(!this.options.isMailToolAvailable){t.Event.bind(o,"click",(()=>{BX.UI.InfoHelper.show(this.options.toolLimitSliderCode)}))}else if(this.options.canConnectNewMailbox){t.Event.bind(o,"click",(()=>{v.Instance.open(e.href,{width:760})}))}else{t.Event.bind(o,"click",(()=>{if(this.activeFeaturePromoter){this.activeFeaturePromoter.close();this.activeFeaturePromoter=null}const e=BX.Intranet?BX.UI.FeaturePromotersRegistry:top.BX.UI.FeaturePromotersRegistry;this.activeFeaturePromoter=e.getPromoter({code:this.options.mailboxLimitSliderCode,bindElement:l});this.activeFeaturePromoter.show()}))}t.Dom.append(o,this.showcaseNode);if(!this.isSender||!this.options.isMailToolAvailable||!this.options.canConnectNewMailbox){return}t.Dom.insertBefore(o,this.smtpNode)}))}function O(){if(!this.options.promotionProviders){return}const e=t.Loc.getMessage("UI_MAIL_PROMOTION_TEXT",{"[strong]":"<strong>","[/strong]":"</strong>"});const{root:i,providerList:s}=t.Tag.render(c||(c=a`
			<div class="promotion-showcase">
				<div class="ui-alert ui-alert-icon-info ui-alert-primary">
					<span class="ui-alert-message">${0}</span>
				</div>
				<div class="mail-provider-list" ref="providerList" style="margin-top: 10px"></div>
			</div>
		`),e);this.promotionShowcaseNode=i;this.options.promotionProviders.forEach((e=>{var i;const r=t.Text.encode(e);const o=t.Tag.render(p||(p=a`
				<a class="mail-provider-item mail-provider-item-unavailable">
					<div class="mail-provider-img-container">
						<div class="mail-provider-img ${0}"></div>
					</div>
					<div class="mail-provider-item-title-container">
						<span class="mail-provider-item-title">${0}</span>
					</div>
				</a>
			`),babelHelpers.classPrivateFieldLooseBase(this,M)[M](r),t.Text.encode((i=babelHelpers.classPrivateFieldLooseBase(this,_)[_](r))!=null?i:r[0].toUpperCase()+r.slice(1)));t.Dom.append(o,s)}));t.Dom.append(this.promotionShowcaseNode,this.container)}function B(e){switch(e){case"aol":return"aol";case"gmail":return"gmail";case"yahoo":return"yahoo";case"mail.ru":case"mailru":return"mailru";case"icloud":return"icloud";case"outlook.com":case"outlook":return"outlook";case"office365":return"office365";case"exchangeOnline":case"exchange":return"exchange";case"yandex":return"yandex";case"ukr.net":return"ukrnet";case"other":case"imap":return"other";default:return""}}function N(e){switch(e){case"aol":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_AOL");case"gmail":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_GMAIL");case"yahoo":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_YAHOO");case"mailru":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_MAILRU");case"icloud":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_ICLOUD");case"outlook":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_OUTLOOK");case"office365":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_OFFICE365");case"exchange":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_EXCHANGE");case"yandex":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_YANDEX");case"other":return t.Loc.getMessage("UI_MAIL_PROVIDER_SERVICE_NAME_IMAP");default:return null}}function w(e){return`mail-provider-${e}-img`}e.ProviderShowcase=f})(this.BX.UI.Mail=this.BX.UI.Mail||{},BX,BX.UI.SidePanel,BX.UI.Mail);
//# sourceMappingURL=provider-showcase.bundle.map.js