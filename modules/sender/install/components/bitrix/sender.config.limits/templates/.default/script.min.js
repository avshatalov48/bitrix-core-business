(function(){BX.namespace("BX.Sender.Config");if(BX.Sender.Config.Limits){return}var t=BX.Sender.Helper;function e(t){this.init(t)}e.prototype.init=function(e){this.name=e.name;this.context=e.context;this.manager=e.manager;this.editNode=t.getNode("percentage-edit",this.context);this.inputNode=t.getNode("percentage-input",this.context);this.textNode=t.getNode("percentage-text",this.context);this.viewNode=t.getNode("percentage-view",this.context);this.limitNode=t.getNode("percentage-limit",this.context);this.availableNode=t.getNode("percentage-available",this.context);if(this.inputNode){this.input=this.inputNode.querySelector("input");this.current=parseInt(this.input.value);BX.bind(this.editNode,"click",this.onEdit.bind(this));BX.bind(this.input,"blur",this.onSave.bind(this))}};e.prototype.setValue=function(e){this.current=parseInt(e.percentage);this.input.value=this.current;this.textNode.textContent=this.current;this.viewNode.style.left=this.current+"%";t.animate.numbers(this.limitNode,e.limit);t.animate.numbers(this.availableNode,e.available)};e.prototype.onEdit=function(){BX.addClass(this.viewNode,"sender-config-limits-progress-active");var t=this;setTimeout(function(){BX.focus(t.input)},50)};e.prototype.onSave=function(){BX.removeClass(this.viewNode,"sender-config-limits-progress-active");var t=parseInt(this.input.value);if(this.current===t){return}var e=this;this.manager.ajaxAction.request({action:"setLimitPercentage",onsuccess:function(t){e.setValue(t)},data:{percentage:t}})};function i(t){}i.prototype.init=function(e){this.mess=e.mess||{};this.actionUri=e.actionUri||"";this.context=BX(e.containerId);t.getNodes("percentage-context",this.context).forEach(this.initPercentage,this);this.ajaxAction=new BX.AjaxAction(this.actionUri)};i.prototype.initPercentage=function(t){if(!t){return}var i=t.getAttribute("data-name");if(!i){return}new e({name:i,context:t,manager:this})};i.prototype.showMailPopup=function(){BX.Sender.B24License.showDefaultPopup()};i.prototype.showMailRatingPopup=function(t){this.popup=BX.PopupWindowManager.create("sender-config-limit-mail-rating",null,{titleBar:this.mess.mailDailyLimitTitle,width:600,height:225,autoHide:true,lightShadow:true,closeByEsc:true,closeIcon:true,overlay:true,buttons:[new BX.PopupWindowButton({text:this.mess.close,className:"popup-window-button-accept",events:{click:function(){this.popupWindow.close()}}})]});this.popup.setContent(this.mess.mailDailyLimit);this.popup.show()};BX.Sender.Config.Limits=new i})(window);