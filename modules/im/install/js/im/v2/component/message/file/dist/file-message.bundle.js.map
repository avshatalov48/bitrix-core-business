{"version":3,"file":"file-message.bundle.js","sources":["../src/helpers/get-gallery-elements-config.js","../src/helpers/get-gallery-grid-rows-config.js","../src/components/items/progress-bar.js","../src/components/items/gallery-item.js","../src/components/items/video.js","../src/components/media-content.js","../src/components/media-message.js","../src/classes/base-file-context-menu.js","../src/components/items/base-file.js","../src/components/base-file-message.js","../src/components/items/audio.js","../src/components/audio-message.js","../src/components/file-collection-message.js","../src/file-message.js"],"sourcesContent":["import type { JsonObject } from 'main.core';\n\nexport function getGalleryElementsConfig(filesCount: number, index: number): JsonObject\n{\n\tconst spanValues = {\n\t\t10: ['1-4', '1-1', '1-2', '1-1', '1-1', '1-2', '1-1', '1-1', '1-2', '1-1'],\n\t\t9: ['1-4', '1-1', '1-2', '1-1', '1-2', '1-2', '1-1', '1-2', '1-1'],\n\t\t8: ['1-4', '1-2', '1-2', '1-1', '1-2', '1-1', '1-2', '1-2'],\n\t\t7: ['1-4', '1-2', '1-2', '1-2', '1-2', '1-2', '1-2'],\n\t\t6: ['1-4', '1-2', '1-2', '1-1', '1-2', '1-1'],\n\t\t5: ['1-4', '1-2', '1-2', '1-2', '1-2'],\n\t\t4: ['2-4', '1-1', '1-2', '1-1'],\n\t\t3: ['2-4', '1-2', '1-2'],\n\t\t2: ['2-2', '2-2'],\n\t};\n\n\tconst spanValue = spanValues[filesCount] && spanValues[filesCount][index];\n\tif (!spanValue)\n\t{\n\t\treturn {\n\t\t\t'grid-row-end': 'span 1',\n\t\t\t'grid-column-end': 'span 1',\n\t\t};\n\t}\n\n\tconst [rowSpan, colSpan] = spanValue.split('-');\n\n\treturn {\n\t\t'grid-row-end': `span ${rowSpan}`,\n\t\t'grid-column-end': `span ${colSpan}`,\n\t};\n}\n","export function getGalleryGridRowsConfig(filesCount: number): { gridTemplateRows: string }\n{\n\tlet rowsTemplate = '140px 80px';\n\tif (filesCount >= 7)\n\t{\n\t\trowsTemplate = '140px 80px 80px 58px';\n\t}\n\telse if (filesCount >= 3)\n\t{\n\t\trowsTemplate = '140px 80px 80px';\n\t}\n\n\treturn { gridTemplateRows: rowsTemplate };\n}\n","import { EventEmitter } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\nimport { ProgressBarManager } from 'im.v2.lib.progressbar';\n\nimport '../../css/items/progress-bar.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const ProgressBar = {\n\tname: 'ProgressBar',\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\twithLabels: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\t'file.status': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t\t'file.progress': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.initProgressBar();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.removeProgressBar();\n\t},\n\tmethods:\n\t{\n\t\tinitProgressBar()\n\t\t{\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet blurElement;\n\t\t\tif (this.file.progress < 0 || (!this.isImage && !this.isVideo))\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tconst customConfig = { blurElement, hasTitle: false };\n\t\t\tif (!this.withLabels)\n\t\t\t{\n\t\t\t\tcustomConfig.labels = {};\n\t\t\t}\n\n\t\t\tthis.progressBarManager = new ProgressBarManager({\n\t\t\t\tcontainer: this.$refs['progress-bar'],\n\t\t\t\tuploadState: this.file,\n\t\t\t\tcustomConfig,\n\t\t\t});\n\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.cancel, () => {\n\t\t\t\tEventEmitter.emit(EventType.uploader.cancel, {\n\t\t\t\t\ttempFileId: this.file.id,\n\t\t\t\t\ttempMessageId: this.messageId,\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.destroy, () => {\n\t\t\t\tif (this.progressBar)\n\t\t\t\t{\n\t\t\t\t\tthis.progressBar = null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.progressBarManager.start();\n\t\t},\n\t\tremoveProgressBar()\n\t\t{\n\t\t\tif (!this.getProgressBarManager())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getProgressBarManager().destroy();\n\t\t},\n\t\tgetProgressBarManager(): ProgressBarManager\n\t\t{\n\t\t\treturn this.progressBarManager;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-progress-bar__container\" ref=\"progress-bar\"></div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\n\nimport { FileType } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ImModelMessage } from 'im.v2.model';\n\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/gallery-item.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\nconst MAX_WIDTH = 488;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\n\n// @vue/component\nexport const GalleryItem = {\n\tname: 'GalleryItem',\n\tdirectives: { lazyload },\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisGallery: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessageItem(): ImModelMessage\n\t\t{\n\t\t\treturn this.message;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.id, true);\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tif (this.isGallery)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\timageTitle(): string\n\t\t{\n\t\t\tconst size = Utils.file.formatFileSize(this.file.size);\n\n\t\t\treturn this.loc(\n\t\t\t\t'IM_ELEMENTS_MEDIA_IMAGE_TITLE',\n\t\t\t\t{\n\t\t\t\t\t'#NAME#': this.file.name,\n\t\t\t\t\t'#SIZE#': size,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.messageItem.forward.id);\n\t\t},\n\t\tisVideo(): boolean\n\t\t{\n\t\t\treturn this.file.type === FileType.video;\n\t\t},\n\t\tpreviewSourceLink(): string\n\t\t{\n\t\t\t// for a video, we use \"urlPreview\", because there is an image preview.\n\t\t\t// for an image, we use \"urlShow\", because for large gif files in \"urlPreview\" we have\n\t\t\t// a static image (w/o animation) .\n\t\t\treturn this.isVideo ? this.file.urlPreview : this.file.urlShow;\n\t\t},\n\t\tallowLazyLoad(): boolean\n\t\t{\n\t\t\treturn !this.previewSourceLink.startsWith('blob:');\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\tclass=\"bx-im-gallery-item__container\" \n\t\t\t:class=\"{'--with-forward': isForward}\"\n\t\t\t@click=\"download\"\n\t\t\t:style=\"imageSize\"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-if=\"allowLazyLoad\"\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src=\"previewSourceLink\"\n\t\t\t\t:title=\"imageTitle\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-gallery-item__source\"\n\t\t\t/>\n\t\t\t<img\n\t\t\t\tv-else\n\t\t\t\t:src=\"previewSourceLink\"\n\t\t\t\t:title=\"imageTitle\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-gallery-item__source\"\n\t\t\t/>\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageItem.id\" :withLabels=\"!isGallery\" />\n\t\t\t<div v-if=\"isVideo\" class=\"bx-im-gallery-item__play-icon-container\">\n\t\t\t\t<div class=\"bx-im-gallery-item__play-icon\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { VideoPlayer } from\t'im.v2.component.elements';\n\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/video.css';\n\nimport type { ImModelFile, ImModelMessage } from 'im.v2.model';\n\nconst VIDEO_SIZE_TO_AUTOPLAY = 5_000_000;\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\nconst DEFAULT_WIDTH = 320;\nconst DEFAULT_HEIGHT = 180;\n\n// @vue/component\nexport const VideoItem = {\n\tname: 'VideoItem',\n\tcomponents: { VideoPlayer, ProgressBar },\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessageItem(): ImModelMessage\n\t\t{\n\t\t\treturn this.message;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.id, true);\n\t\t},\n\t\tautoplay(): boolean\n\t\t{\n\t\t\treturn this.file.size < VIDEO_SIZE_TO_AUTOPLAY;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (!newHeight || !newWidth)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: `${DEFAULT_WIDTH}px`,\n\t\t\t\t\theight: `${DEFAULT_HEIGHT}px`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.messageItem.forward.id);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-video-item__container bx-im-video-item__scope\"\n\t\t\t:class=\"{'--with-forward': isForward}\"\n\t\t\t@click=\"download\"\n\t\t>\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageItem.id\" />\n\t\t\t<VideoPlayer\n\t\t\t\t:fileId=\"file.id\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:previewImageUrl=\"file.urlPreview\"\n\t\t\t\t:elementStyle=\"imageSize\"\n\t\t\t\t:withAutoplay=\"autoplay\"\n\t\t\t\t:withPlayerControls=\"isLoaded\"\n\t\t\t\t:viewerAttributes=\"viewerAttributes\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { MessageStatus } from 'im.v2.component.message.elements';\nimport { FileType } from 'im.v2.const';\n\nimport { getGalleryElementsConfig } from '../helpers/get-gallery-elements-config';\nimport { getGalleryGridRowsConfig } from '../helpers/get-gallery-grid-rows-config';\nimport { GalleryItem } from './items/gallery-item';\nimport { VideoItem } from './items/video';\n\nimport '../css/items/media-content.css';\n\nimport type { ImModelMessage } from 'im.v2.model';\n\nconst FILES_LIMIT = 10;\n\n// @vue/component\nexport const MediaContent = {\n\tname: 'MediaContent',\n\tcomponents: { GalleryItem, VideoItem, MessageStatus },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfileIds(): number[]\n\t\t{\n\t\t\treturn this.message.files.slice(0, FILES_LIMIT);\n\t\t},\n\t\tfirstFileId(): number\n\t\t{\n\t\t\treturn this.message.files[0];\n\t\t},\n\t\tisGallery(): boolean\n\t\t{\n\t\t\treturn this.message.files.length > 1;\n\t\t},\n\t\tgalleryRowConfig(): { gridTemplateRows: string }\n\t\t{\n\t\t\treturn getGalleryGridRowsConfig(this.fileIds.length);\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\tonlyMedia(): boolean\n\t\t{\n\t\t\treturn !this.hasText && !this.hasAttach;\n\t\t},\n\t\tisSingleVideo(): boolean\n\t\t{\n\t\t\tif (this.isGallery)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.$store.getters['files/get'](this.firstFileId, true).type === FileType.video;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetGalleryElementStyles(index: number): { gridRowEnd: string, gridColumnEnd: string }\n\t\t{\n\t\t\treturn getGalleryElementsConfig(this.fileIds.length, index);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-message-media-content__container\">\n\t\t\t<div v-if=\"isGallery\" class=\"bx-im-message-media-content__gallery\" :style=\"galleryRowConfig\">\n\t\t\t\t<GalleryItem\n\t\t\t\t\tv-for=\"(fileId, index) in fileIds\"\n\t\t\t\t\t:key=\"fileId\"\n\t\t\t\t\t:id=\"fileId\"\n\t\t\t\t\t:isGallery=\"true\"\n\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t:style=\"getGalleryElementStyles(index)\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"isSingleVideo\" class=\"bx-im-message-media-content__single-video\">\n\t\t\t\t<VideoItem\n\t\t\t\t\t:id=\"firstFileId\"\n\t\t\t\t\t:message=\"message\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-else class=\"bx-im-message-media-content__single-image\">\n\t\t\t\t<GalleryItem\n\t\t\t\t\t:id=\"firstFileId\"\n\t\t\t\t\t:message=\"message\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-if=\"onlyMedia\" class=\"bx-im-message-media-content__status-container\">\n\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"true\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport {\n\tMessageStatus,\n\tReactionList,\n\tDefaultMessageContent,\n\tMessageHeader,\n\tMessageFooter,\n} from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { ChatType } from 'im.v2.const';\n\nimport { MediaContent } from './media-content';\n\nimport '../css/media-message.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelMessage, ImModelChat } from 'im.v2.model';\n\nconst MAX_GALLERY_WIDTH = 305;\nconst MAX_SINGLE_MEDIA_WIDTH = 488;\n\n// @vue/component\nexport const MediaMessage = {\n\tname: 'MediaMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t\tMediaContent,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfileIds(): number[]\n\t\t{\n\t\t\treturn this.message.files;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId);\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\thasReply(): boolean\n\t\t{\n\t\t\treturn this.message.replyId !== 0;\n\t\t},\n\t\tshowContextMenu(): boolean\n\t\t{\n\t\t\treturn this.onlyImage;\n\t\t},\n\t\tshowBottomContainer(): boolean\n\t\t{\n\t\t\treturn this.hasText || this.hasAttach || this.hasReply;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.message.forward.id);\n\t\t},\n\t\tneedBackground(): boolean\n\t\t{\n\t\t\treturn this.showBottomContainer || this.isChannelPost || this.isForward;\n\t\t},\n\t\tisChannelPost(): boolean\n\t\t{\n\t\t\treturn [ChatType.channel, ChatType.openChannel].includes(this.dialog.type);\n\t\t},\n\t\timageContainerStyles(): JsonObject\n\t\t{\n\t\t\tlet maxWidth = MAX_SINGLE_MEDIA_WIDTH;\n\t\t\tif (this.fileIds.length > 1)\n\t\t\t{\n\t\t\t\tmaxWidth = MAX_GALLERY_WIDTH;\n\t\t\t}\n\n\t\t\treturn { 'max-width': `${maxWidth}px` };\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\" :withBackground=\"needBackground\">\n\t\t\t<div class=\"bx-im-message-image__container\" :style=\"imageContainerStyles\">\n\t\t\t\t<MessageHeader :withTitle=\"false\" :item=\"item\" class=\"bx-im-message-image__header\" />\n\t\t\t\t<MediaContent :item=\"message\" />\n\t\t\t\t<div v-if=\"showBottomContainer\" class=\"bx-im-message-image__bottom-container\">\n\t\t\t\t\t<DefaultMessageContent\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:withText=\"hasText\"\n\t\t\t\t\t\t:withAttach=\"hasAttach\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<template #after-message>\n\t\t\t\t<div v-if=\"!showBottomContainer\" class=\"bx-im-message-image__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" :contextDialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</BaseMessage>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { DiskService } from 'im.v2.provider.service';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PopupType } from 'im.v2.const';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelFile, ImModelMessage } from 'im.v2.model';\n\nexport class BaseFileContextMenu extends BaseMenu\n{\n\tcontext: ImModelMessage & {dialogId: string, fileId: number};\n\n\tid: String = PopupType.messageBaseFileMenu;\n\tdiskService: DiskService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-file-context-menu';\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn [\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDisk(),\n\t\t];\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: Utils.file.createDownloadLink(\n\t\t\t\tLoc.getMessage('IM_MESSAGE_FILE_MENU_DOWNLOAD_FILE'),\n\t\t\t\tfile.urlDownload,\n\t\t\t\tfile.name,\n\t\t\t),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetSaveToDisk(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK'),\n\t\t\tonclick: function() {\n\t\t\t\tvoid this.diskService.save(file.id).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_SUCCESS'),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getMessageFile(): ?ImModelFile\n\t{\n\t\tif (!this.context.fileId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.store.getters['files/get'](this.context.fileId);\n\t}\n}\n","import 'ui.icons.disk';\n\nimport { FileType } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { ProgressBar } from './progress-bar';\nimport { BaseFileContextMenu } from '../../classes/base-file-context-menu';\n\nimport '../../css/items/base-file.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileItem = {\n\tname: 'BaseFileItem',\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\tid: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.$store.getters['files/get'](this.id, true);\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 20;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst iconType = Utils.file.getIconTypeByFilename(this.file.name);\n\n\t\t\treturn `ui-icon-file-${iconType}`;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\timageStyles(): {backgroundImage: string}\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url(${this.file.urlPreview})`,\n\t\t\t};\n\t\t},\n\t\tisImage(): boolean\n\t\t{\n\t\t\treturn this.file.type === FileType.image;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\topenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tthis.$emit('openContextMenu', {\n\t\t\t\tevent,\n\t\t\t\tfileId: this.id,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-base-file-item__container\">\n\t\t\t<div class=\"bx-im-base-file-item__icon-container\" ref=\"loader-icon\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" :withLabels=\"false\" />\n\t\t\t\t<div v-if=\"isImage\" :style=\"imageStyles\" class=\"bx-im-base-file-item__image\"></div>\n\t\t\t\t<div v-else :class=\"iconClass\" class=\"bx-im-base-file-item__type-icon ui-icon\"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-base-file-item__content\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<span :title=\"file.name\" class=\"bx-im-base-file-item__title\">\n\t\t\t\t\t{{ fileShortName }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"bx-im-base-file-item__size\">{{ fileSize }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-base-file-item__download-icon\"\n\t\t\t\t:class=\"{'--not-active': !isLoaded}\"\n\t\t\t\t@click=\"openContextMenu\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/base-file-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileMessage = {\n\tname: 'BaseFileMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu({ event, fileId }: { event: PointerEvent, fileId: number })\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, fileId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-base-file__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-base-file__author-title\" />\n\t\t\t\t<BaseFileItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:id=\"messageFile.id\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t/>\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { AudioPlayer } from 'im.v2.component.elements';\n\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/audio.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioItem = {\n\tname: 'AudioItem',\n\tcomponents: { AudioPlayer, ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-media-audio__container\">\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" />\n\t\t\t<AudioPlayer\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:messageId=\"messageId\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:file=\"file\"\n\t\t\t\t:timelineType=\"Math.floor(Math.random() * 5)\"\n\t\t\t\t:authorId=\"file.authorId\"\n\t\t\t\t:withContextMenu=\"false\"\n\t\t\t\t:withAvatar=\"false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType, MessageType } from 'im.v2.const';\n\nimport { AudioItem } from './items/audio';\n\nimport '../css/audio-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioMessage = {\n\tname: 'AudioMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t\tDefaultMessageContent,\n\t\tAudioItem,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t\tmessageType(): $Values<typeof MessageType>\n\t\t{\n\t\t\treturn this.$store.getters['messages/getMessageType'](this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-audio__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-audio__header\"/>\n\t\t\t\t<AudioItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t:messageType=\"messageType\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-audio__default-message-container\">\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/file-collection-message.css';\n\nimport type { ImModelMessage } from 'im.v2.model';\n\nconst FILES_LIMIT = 10;\n\n// @vue/component\nexport const FileCollectionMessage = {\n\tname: 'FileCollectionMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageId(): string | number\n\t\t{\n\t\t\treturn this.message.id;\n\t\t},\n\t\tfileIds(): number[]\n\t\t{\n\t\t\treturn this.message.files.slice(0, FILES_LIMIT);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu({ event, fileId }: { event: PointerEvent, fileId: number })\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, fileId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-file-collection__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-file-collection__author-title\" />\n\t\t\t\t<div class=\"bx-im-message-file-collection__items\">\n\t\t\t\t\t<BaseFileItem\n\t\t\t\t\t\tv-for=\"fileId in fileIds\"\n\t\t\t\t\t\t:key=\"fileId\"\n\t\t\t\t\t\t:id=\"fileId\"\n\t\t\t\t\t\t:messageId=\"messageId\"\n\t\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<DefaultMessageContent \n\t\t\t\t\t:item=\"item\" \n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\tclass=\"bx-im-message-file-collection__default-content\" \n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t</BaseMessage>\n\t`,\n};\n","import { FileType } from 'im.v2.const';\nimport { UnsupportedMessage } from 'im.v2.component.message.unsupported';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { MediaMessage } from './components/media-message';\nimport { BaseFileMessage } from './components/base-file-message';\nimport { AudioMessage } from './components/audio-message';\nimport { FileCollectionMessage } from './components/file-collection-message';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\nconst FileMessageType = Object.freeze({\n\tmedia: 'MediaMessage',\n\taudio: 'AudioMessage',\n\tbase: 'BaseFileMessage',\n\tcollection: 'FileCollectionMessage',\n});\n\n// @vue/component\nexport const FileMessage = {\n\tname: 'FileMessage',\n\tcomponents: {\n\t\tBaseFileMessage,\n\t\tMediaMessage,\n\t\tAudioMessage,\n\t\tUnsupportedMessage,\n\t\tFileCollectionMessage,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFiles(): ImModelFile[]\n\t\t{\n\t\t\tconst files = [];\n\n\t\t\tif (this.message.files.length === 0)\n\t\t\t{\n\t\t\t\treturn files;\n\t\t\t}\n\n\t\t\tthis.message.files.forEach((fileId: number) => {\n\t\t\t\tconst file: ImModelFile = this.$store.getters['files/get'](fileId, true);\n\t\t\t\tfiles.push(file);\n\t\t\t});\n\n\t\t\treturn files;\n\t\t},\n\t\tisGallery(): boolean\n\t\t{\n\t\t\treturn this.messageFiles.every((file) => [FileType.image, FileType.video].includes(file.type));\n\t\t},\n\t\tcomponentName(): string\n\t\t{\n\t\t\tif (this.messageFiles.length > 1)\n\t\t\t{\n\t\t\t\treturn this.isGallery ? FileMessageType.media : FileMessageType.collection;\n\t\t\t}\n\n\t\t\tconst file = this.messageFiles[0];\n\t\t\tconst hasPreview = Boolean(file.image);\n\n\t\t\tif (file.type === FileType.image && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.media;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.audio)\n\t\t\t{\n\t\t\t\treturn FileMessageType.audio;\n\t\t\t}\n\n\t\t\t// file.type value is empty for mkv files\n\t\t\tconst isVideo = file.type === FileType.video || Utils.file.getFileExtension(file.name) === 'mkv';\n\t\t\tif (isVideo && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.media;\n\t\t\t}\n\n\t\t\treturn FileMessageType.base;\n\t\t},\n\t\tisRealMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['messages/isRealMessage'](this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component \n\t\t\t:is=\"componentName\" \n\t\t\t:item=\"message\" \n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:withTitle=\"withTitle\" \n\t\t\t:menuIsActiveForId=\"menuIsActiveForId\"\n\t\t\t:withRetryButton=\"false\"\n\t\t\t:withContextMenu=\"isRealMessage\"\n\t\t/>\n\t`,\n};\n"],"names":["getGalleryElementsConfig","filesCount","index","spanValues","spanValue","rowSpan","colSpan","split","getGalleryGridRowsConfig","rowsTemplate","gridTemplateRows","ProgressBar","name","props","item","type","Object","required","messageId","String","Number","withLabels","Boolean","default","computed","file","watch","getProgressBarManager","update","mounted","initProgressBar","beforeUnmount","removeProgressBar","methods","progress","blurElement","isImage","isVideo","customConfig","hasTitle","labels","progressBarManager","ProgressBarManager","container","$refs","uploadState","subscribe","event","cancel","EventEmitter","emit","EventType","uploader","tempFileId","id","tempMessageId","destroy","progressBar","start","template","MAX_WIDTH","MAX_HEIGHT","MIN_WIDTH","MIN_HEIGHT","GalleryItem","directives","lazyload","components","message","isGallery","messageItem","$store","getters","imageSize","newWidth","image","width","newHeight","height","aspectRatio","Math","round","sizes","max","viewerAttributes","Utils","getViewerDataAttributes","viewerAttrs","canBeOpenedWithViewer","BX","UI","Viewer","imageTitle","size","formatFileSize","loc","isLoaded","isForward","Type","isStringFilled","forward","FileType","video","previewSourceLink","urlPreview","urlShow","allowLazyLoad","startsWith","download","url","urlDownload","window","open","phraseCode","replacements","$Bitrix","Loc","getMessage","VIDEO_SIZE_TO_AUTOPLAY","DEFAULT_WIDTH","DEFAULT_HEIGHT","VideoItem","VideoPlayer","autoplay","FILES_LIMIT","MediaContent","MessageStatus","fileIds","files","slice","firstFileId","length","galleryRowConfig","hasText","text","hasAttach","attach","onlyMedia","isSingleVideo","getGalleryElementStyles","MAX_GALLERY_WIDTH","MAX_SINGLE_MEDIA_WIDTH","MediaMessage","ReactionList","BaseMessage","DefaultMessageContent","MessageHeader","MessageFooter","dialogId","withTitle","menuIsActiveForId","dialog","hasReply","replyId","showContextMenu","onlyImage","showBottomContainer","needBackground","isChannelPost","ChatType","channel","openChannel","includes","imageContainerStyles","maxWidth","BaseFileContextMenu","BaseMenu","constructor","PopupType","messageBaseFileMenu","diskService","DiskService","getMenuItems","getDownloadFileItem","getSaveToDisk","html","createDownloadLink","onclick","menuInstance","close","bind","save","then","Notification","Center","notify","content","context","fileId","store","BaseFileItem","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","iconClass","iconType","getIconTypeByFilename","imageStyles","backgroundImage","created","contextMenu","openContextMenu","$emit","BaseFileMessage","messageFile","onOpenContextMenu","openMenu","target","AudioItem","AudioPlayer","messageType","AudioMessage","canSetReactions","isNumber","FileCollectionMessage","FileMessageType","freeze","media","audio","base","collection","FileMessage","UnsupportedMessage","messageFiles","forEach","push","every","componentName","hasPreview","getFileExtension","isRealMessage"],"mappings":"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"}