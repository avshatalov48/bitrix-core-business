{"version":3,"file":"interface.bundle.js","sources":["../src/controls/dialog-qr.js","../src/controls/rule/weekday.js","../src/controls/rule/range.js","../src/controls/rule/settings.js","../src/controls/joint/hint-info.js","../src/controls/joint/user-selector.js","../src/controls/link-list/list-item.js","../src/controls/link-list/list.js","../src/controls/dialog-new.js","../src/controls/sharingbutton.js","../src/interface.js"],"sourcesContent":["import { Tag, Loc, Runtime } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Loader } from 'main.loader';\n\ntype DialogQrOptions = {\n\tsharingUrl: string,\n\tcontext: 'calendar' | 'crm',\n}\nexport default class DialogQr\n{\n\tQRCODE_SIZE = 114;\n\tQRCODE_COLOR_LIGHT = '#fff';\n\tQRCODE_COLOR_DARK = '#000';\n\t#popup;\n\t#loader;\n\t#layout;\n\t#qrCode;\n\t#context;\n\n\tconstructor(options: DialogQrOptions)\n\t{\n\t\tthis.#popup = null;\n\t\tthis.#loader = null;\n\t\tthis.#layout = {\n\t\t\tqr: null,\n\t\t};\n\t\tthis.#qrCode = null;\n\t\tthis.#context = options.context;\n\n\t\tthis.sharingUrl = options.sharingUrl;\n\t}\n\n\t/**\n\t *\n\t * @returns {Popup}\n\t */\n\tgetPopup()\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tclassName: 'calendar-sharing__qr',\n\t\t\t\twidth: 315,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontent: this.getContent(),\n\t\t\t\tcloseIcon: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\toverlay: true,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t});\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\t/**\n\t *\n\t * @returns {Loader}\n\t */\n\tgetLoader()\n\t{\n\t\tif (!this.#loader)\n\t\t{\n\t\t\tthis.#loader = new Loader({ size: 95 });\n\t\t}\n\n\t\treturn this.#loader;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetNodeQr()\n\t{\n\t\tif (!this.#layout.qr)\n\t\t{\n\t\t\tthis.#layout.qr = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__qr-block\"></div>\n\t\t\t`;\n\n\t\t\t// qr emulation\n\t\t\tthis.getLoader().show(this.#layout.qr);\n\n\t\t\tthis.showQr();\n\t\t}\n\n\t\treturn this.#layout.qr;\n\t}\n\n\tasync showQr()\n\t{\n\t\tawait this.initQrCode();\n\t\tthis.QRCode = new QRCode(this.#layout.qr, {\n\t\t\ttext: this.sharingUrl,\n\t\t\twidth: this.QRCODE_SIZE,\n\t\t\theight: this.QRCODE_SIZE,\n\t\t\tcolorDark: this.QRCODE_COLOR_DARK,\n\t\t\tcolorLight: this.QRCODE_COLOR_LIGHT,\n\t\t\tcorrectLevel: QRCode.CorrectLevel.H,\n\t\t});\n\t\tawait this.getLoader().hide();\n\t}\n\n\tasync initQrCode()\n\t{\n\t\tawait Runtime.loadExtension(['main.qrcode']);\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetContent()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__qr-content\">\n\t\t\t\t<div class=\"calendar-sharing__qr-title\">${this.getPhraseDependsOnContext('SHARING_INFO_POPUP_QR_TITLE')}</div>\n\t\t\t\t${this.getNodeQr()}\n\t\t\t\t<div class=\"calendar-sharing__qr-info\">${Loc.getMessage('SHARING_INFO_POPUP_QR_INFO')}</div>\n\t\t\t\t<a class=\"calendar-sharing__dialog-link\" href=\"${this.sharingUrl}\" target=\"_blank\">${Loc.getMessage('SHARING_INFO_POPUP_QR_OPEN_LINK')}</a>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.getPopup().isShown();\n\t}\n\n\tclose()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.getPopup().destroy();\n\t}\n\n\tgetPhraseDependsOnContext(code: string)\n\t{\n\t\treturn Loc.getMessage(`${code}_${this.#context.toUpperCase()}`);\n\t}\n}\n","import { Dom, Tag, Type } from 'main.core';\n\ntype WeekdayOptions = {\n\tname: string,\n\tindex: number,\n\tactive: boolean,\n\tonSelected: void,\n\tonDiscarded: void,\n\tonMouseDown: void,\n\tcanBeDiscarded: void,\n}\n\nexport default class Weekday\n{\n\tconstructor(options: WeekdayOptions)\n\t{\n\t\tthis.wrap = null;\n\t\tthis.name = options.name;\n\t\tthis.index = options.index;\n\t\tthis.active = options.active;\n\t\tthis.onSelected = Type.isFunction(options.onSelected) ? options.onSelected : () => {};\n\n\t\tthis.onDiscarded = Type.isFunction(options.onDiscarded) ? options.onDiscarded : () => {};\n\n\t\tthis.onMouseDown = Type.isFunction(options.onMouseDown) ? options.onMouseDown : () => {};\n\n\t\tthis.canBeDiscarded = Type.isFunction(options.canBeDiscarded) ? options.canBeDiscarded : () => {};\n\t}\n\n\trender()\n\t{\n\t\tconst className = this.active ? '--selected' : '';\n\n\t\tthis.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-popup-weekday ${className}\" onmousedown=\"${(e) => this.handleMouseDown(e)}\">\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekday-text\">${this.name}</div>\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekday-icon\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.wrap;\n\t}\n\n\thandleMouseDown(event)\n\t{\n\t\tif (this.active)\n\t\t{\n\t\t\tthis.discard();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.select();\n\t\t}\n\t\tthis.onMouseDown(event, this);\n\t}\n\n\tselect()\n\t{\n\t\tthis.active = true;\n\t\tDom.addClass(this.wrap, '--selected');\n\t\tthis.onSelected();\n\t}\n\n\tdiscard()\n\t{\n\t\tif (!this.canBeDiscarded())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.active = false;\n\t\tDom.removeClass(this.wrap, '--selected');\n\t\tthis.onDiscarded();\n\t}\n}\n","import { Dom, Loc, Tag, Type, Event } from 'main.core';\nimport Weekday from './weekday';\nimport { MenuManager, Popup } from 'main.popup';\nimport { Util } from 'calendar.util';\n\ntype RangeOptions = {\n\treadOnly: boolean,\n\tgetSlotSize: void,\n\tfrom: number,\n\tto: number,\n\tweekdays: Array<number>,\n\tworkDays: Array<number>,\n\tweekStart: number,\n\truleUpdated: void,\n\taddRange: void,\n\tremoveRange: void,\n\tshowReadOnlyPopup: void,\n\tshow: boolean,\n\tdeletable: boolean,\n}\n\nexport default class Range\n{\n\tconstructor(options: RangeOptions)\n\t{\n\t\tthis.layout = {\n\t\t\twrap: null,\n\t\t\tweekdaysSelect: null,\n\t\t\tstartSelect: null,\n\t\t\tendSelect: null,\n\t\t};\n\n\t\tthis.readOnly = options.readOnly;\n\t\tthis.weekStart = options.weekStart;\n\t\tthis.workDays = options.workDays;\n\n\t\tthis.getSlotSize = options.getSlotSize;\n\t\tthis.rule = {\n\t\t\tfrom: options.from,\n\t\t\tto: options.to,\n\t\t\tweekdays: this.getSortedWeekdays(options.weekdays),\n\t\t};\n\n\t\tthis.ruleUpdated = Type.isFunction(options.ruleUpdated) ? options.ruleUpdated : () => {};\n\n\t\tthis.addRange = Type.isFunction(options.addRange) ? options.addRange : () => {};\n\n\t\tthis.removeRange = Type.isFunction(options.removeRange) ? options.removeRange : () => {};\n\n\t\tthis.showReadOnlyPopup = Type.isFunction(options.showReadOnlyPopup) ? options.showReadOnlyPopup : () => {};\n\n\t\tthis.show = options.show;\n\t\tthis.deletable = false;\n\t}\n\n\tgetRule(): any\n\t{\n\t\treturn this.rule;\n\t}\n\n\tsettingPopupShown(): boolean\n\t{\n\t\tconst weekdaysPopupShown = Dom.hasClass(this.layout.weekdaysSelect, '--active');\n\t\tconst startPopupShown = Dom.hasClass(this.layout.fromTimeSelect, '--active');\n\t\tconst endPopupShown = Dom.hasClass(this.layout.toTimeSelect, '--active');\n\n\t\treturn weekdaysPopupShown || startPopupShown || endPopupShown;\n\t}\n\n\tgetWrap(): HTMLElement\n\t{\n\t\treturn this.layout.wrap;\n\t}\n\n\tdisableAnimation()\n\t{\n\t\tthis.show = false;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.layout.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-range\">\n\t\t\t\t${this.renderWeekdaysSelect()}\n\t\t\t\t<div class=\"calendar-sharing__settings-time-interval\">\n\t\t\t\t\t${this.renderTimeFromSelect()}\n\t\t\t\t\t<div class=\"calendar-sharing__settings-dash\"></div>\n\t\t\t\t\t${this.renderTimeToSelect()}\n\t\t\t\t</div>\n\t\t\t\t${this.renderButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.show)\n\t\t{\n\t\t\tDom.addClass(this.layout.wrap, '--animate-show');\n\t\t\tsetTimeout(() => Dom.removeClass(this.layout.wrap, '--animate-show'), 300);\n\t\t}\n\n\t\treturn this.layout.wrap;\n\t}\n\n\trenderButton(): HTMLElement\n\t{\n\t\tthis.layout.button = this.getButton();\n\n\t\treturn this.layout.button;\n\t}\n\n\tupdate()\n\t{\n\t\tconst maxFrom = 24 * 60 - this.getSlotSize();\n\t\tif (this.rule.from > maxFrom)\n\t\t{\n\t\t\tthis.rule.from = maxFrom;\n\t\t\tif (this.layout.fromTimeSelect)\n\t\t\t{\n\t\t\t\tthis.layout.fromTimeSelect.innerHTML = this.formatAmPmSpan(this.formatMinutes(this.rule.from));\n\t\t\t}\n\n\t\t\tthis.rule.to = 24 * 60;\n\t\t\tif (this.layout.toTimeSelect)\n\t\t\t{\n\t\t\t\tthis.layout.toTimeSelect.innerHTML = this.formatAmPmSpan(this.formatMinutes(this.rule.to));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.updateTo();\n\t\t}\n\t}\n\n\tupdateTo()\n\t{\n\t\tconst minToMinutes = this.rule.from + this.getSlotSize();\n\t\tif (minToMinutes > this.rule.to)\n\t\t{\n\t\t\tthis.rule.to = minToMinutes;\n\t\t\tif (this.layout.toTimeSelect)\n\t\t\t{\n\t\t\t\tthis.layout.toTimeSelect.innerHTML = this.formatAmPmSpan(this.formatMinutes(this.rule.to));\n\t\t\t}\n\t\t}\n\t}\n\n\tsetDeletable(isDeletable)\n\t{\n\t\tthis.deletable = isDeletable;\n\n\t\tconst button = this.layout.button;\n\t\tthis.layout.button = this.getButton();\n\t\tbutton?.replaceWith(this.layout.button);\n\t}\n\n\tgetButton(): HTMLElement\n\t{\n\t\tlet button;\n\n\t\tif (this.deletable)\n\t\t{\n\t\t\tbutton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__settings-delete\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(button, 'click', this.onDeleteButtonClickHandler.bind(this));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tbutton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__settings-add\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(button, 'click', this.onAddButtonClickHandler.bind(this));\n\t\t}\n\n\t\treturn button;\n\t}\n\n\tonDeleteButtonClickHandler()\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.layout.button);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.remove();\n\t\t}\n\t}\n\n\tonAddButtonClickHandler()\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.layout.button);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRange(this);\n\t\t}\n\t}\n\n\thideButton()\n\t{\n\t\tDom.addClass(this.layout.button, '--hidden');\n\t}\n\n\tshowButton()\n\t{\n\t\tDom.removeClass(this.layout.button, '--hidden');\n\t}\n\n\tremove()\n\t{\n\t\tif (!this.removeRange(this))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.layout.wrap, '--animate-remove');\n\t\tsetTimeout(() => this.layout.wrap.remove(), 300);\n\t}\n\n\trenderWeekdaysSelect(): HTMLElement\n\t{\n\t\tconst weekdaysLoc = Util.getWeekdaysLoc().map((loc, index) => {\n\t\t\treturn {\n\t\t\t\tloc,\n\t\t\t\tindex,\n\t\t\t\tactive: this.rule.weekdays.includes(index),\n\t\t\t};\n\t\t});\n\t\tweekdaysLoc.push(...weekdaysLoc.splice(0, this.weekStart));\n\n\t\tthis.layout.weekdaysSelect = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"calendar-sharing__settings-weekdays calendar-sharing__settings-select calendar-sharing__settings-select-arrow\"\n\t\t\t\ttitle=\"${this.formatWeekdays(false)}\"\n\t\t\t>\n\t\t\t\t${this.getWeekdaysTitle()}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.layout.weekdaysSelect, 'click', this.onWeekdaysSelectClickHandler.bind(this));\n\n\t\tthis.weekdays = weekdaysLoc.map((weekdayLoc) => this.createWeekday(weekdayLoc));\n\n\t\tthis.weekdaysMenu = new Popup({\n\t\t\tid: `calendar-sharing-settings-weekdays${Date.now()}`,\n\t\t\tbindElement: this.layout.weekdaysSelect,\n\t\t\tcontent: Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__settings-popup-weekdays\">\n\t\t\t\t\t${this.weekdays.map((weekday) => weekday.render())}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 105,\n\t\t\t},\n\t\t\tautoHideHandler: () => this.weekdaysMenu.canBeClosed,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => Dom.addClass(this.layout.weekdaysSelect, '--active'),\n\t\t\t\tonPopupClose: () => Dom.removeClass(this.layout.weekdaysSelect, '--active'),\n\t\t\t},\n\t\t});\n\t\tthis.weekdaysMenu.canBeClosed = true;\n\n\t\treturn this.layout.weekdaysSelect;\n\t}\n\n\tcreateWeekday(weekdayLoc): Weekday\n\t{\n\t\treturn new Weekday({\n\t\t\tname: weekdayLoc.loc,\n\t\t\tindex: weekdayLoc.index,\n\t\t\tactive: weekdayLoc.active,\n\t\t\tonSelected: () => {\n\t\t\t\tif (this.rule.weekdays.includes(weekdayLoc.index))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rule.weekdays.push(weekdayLoc.index);\n\t\t\t\tthis.rule.weekdays = this.getSortedWeekdays(this.rule.weekdays);\n\t\t\t\tthis.layout.weekdaysSelect.title = this.formatWeekdays();\n\t\t\t\tthis.layout.weekdaysSelect.innerText = this.getWeekdaysTitle();\n\n\t\t\t\tthis.ruleUpdated();\n\t\t\t},\n\t\t\tonDiscarded: () => {\n\t\t\t\tconst index = this.rule.weekdays.indexOf(weekdayLoc.index);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.rule.weekdays.splice(index, 1);\n\t\t\t\tthis.layout.weekdaysSelect.title = this.formatWeekdays();\n\t\t\t\tthis.layout.weekdaysSelect.innerText = this.getWeekdaysTitle();\n\n\t\t\t\tthis.ruleUpdated();\n\t\t\t},\n\t\t\tcanBeDiscarded: () => this.rule.weekdays.length > 1,\n\t\t\tonMouseDown: this.onWeekdayMouseDown.bind(this),\n\t\t});\n\t}\n\n\tonWeekdayMouseDown(event, currentWeekday)\n\t{\n\t\tthis.weekdaysMenu.canBeClosed = false;\n\t\tconst startX = event.clientX;\n\t\tconst select = currentWeekday.active;\n\t\tthis.controllableWeekdays = [];\n\n\t\tthis.collectIntersectedWeekdays = (e) => {\n\t\t\tfor (const weekday of this.weekdays)\n\t\t\t{\n\t\t\t\tconst right = weekday.wrap.getBoundingClientRect().right;\n\t\t\t\tconst left = weekday.wrap.getBoundingClientRect().left;\n\n\t\t\t\tif (\n\t\t\t\t\t(startX > right && e.clientX < right)\n\t\t\t\t\t|| (startX < left && e.clientX > left)\n\t\t\t\t\t|| (left < startX && startX < right)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tif (!this.controllableWeekdays.includes(weekday))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.controllableWeekdays.push(weekday);\n\t\t\t\t\t}\n\t\t\t\t\tweekday.intersected = true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.onMouseMove = (e) => {\n\t\t\tthis.controllableWeekdays.forEach((controllableWeekday) => {\n\t\t\t\tcontrollableWeekday.intersected = false;\n\t\t\t});\n\n\t\t\tthis.collectIntersectedWeekdays(e);\n\n\t\t\tfor (const weekday of this.controllableWeekdays)\n\t\t\t{\n\t\t\t\tif ((weekday.intersected && select) || (!weekday.intersected && !select))\n\t\t\t\t{\n\t\t\t\t\tweekday.select();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tweekday.discard();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tEvent.bind(document, 'mousemove', this.onMouseMove);\n\t\tEvent.bind(document, 'mouseup', () => {\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.weekdaysMenu.canBeClosed = true;\n\t\t\t}, 0);\n\t\t});\n\t}\n\n\trenderTimeFromSelect(): HTMLElement\n\t{\n\t\tconst fromFormatted = this.formatMinutes(this.rule.from);\n\t\tthis.layout.fromTimeSelect = this.renderTimeSelect(fromFormatted, {\n\t\t\tisSelected: (minutes) => this.rule.from === minutes,\n\t\t\tonItemSelected: (minutes) => {\n\t\t\t\tthis.rule.from = minutes;\n\t\t\t\tthis.updateTo();\n\t\t\t},\n\t\t\tgetMaxMinutes: () => 24 * 60 - this.getSlotSize(),\n\t\t}, 'calendar-sharing-settings-range-from');\n\n\t\treturn this.layout.fromTimeSelect;\n\t}\n\n\trenderTimeToSelect(): HTMLElement\n\t{\n\t\tconst toFormatted = this.formatMinutes(this.rule.to);\n\t\tthis.layout.toTimeSelect = this.renderTimeSelect(toFormatted, {\n\t\t\tisSelected: (minutes) => this.rule.to === minutes,\n\t\t\tonItemSelected: (minutes) => {\n\t\t\t\tthis.rule.to = minutes;\n\t\t\t},\n\t\t\tgetMinMinutes: () => this.rule.from + this.getSlotSize(),\n\t\t}, 'calendar-sharing-settings-range-to');\n\n\t\treturn this.layout.toTimeSelect;\n\t}\n\n\trenderTimeSelect(time, callbacks, dataId): HTMLElement\n\t{\n\t\tconst timeSelect = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"calendar-sharing__settings-select calendar-sharing__settings-time calendar-sharing__settings-select-arrow\"\n\t\t\t\tdata-id=\"${dataId}\"\n\t\t\t>\n\t\t\t\t${this.formatAmPmSpan(time)}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(timeSelect, 'click', () => this.onTimeSelectClickHandler(timeSelect, callbacks));\n\n\t\treturn timeSelect;\n\t}\n\n\tshowTimeMenu(timeSelect, callbacks)\n\t{\n\t\tconst timeStamps = [];\n\t\tfor (let hour = 0; hour <= 24; hour++)\n\t\t{\n\t\t\tif (\n\t\t\t\t(!Type.isFunction(callbacks.getMinMinutes) || hour * 60 >= callbacks.getMinMinutes())\n\t\t\t\t&& (!Type.isFunction(callbacks.getMaxMinutes) || hour * 60 <= callbacks.getMaxMinutes())\n\t\t\t)\n\t\t\t{\n\t\t\t\ttimeStamps.push({ minutes: hour * 60, label: this.formatAmPmSpan(Util.formatTime(hour, 0)) });\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\thour !== 24\n\t\t\t\t&& (!Type.isFunction(callbacks.getMinMinutes) || hour * 60 + 30 >= callbacks.getMinMinutes())\n\t\t\t\t&& (!Type.isFunction(callbacks.getMaxMinutes) || hour * 60 + 30 <= callbacks.getMaxMinutes())\n\t\t\t)\n\t\t\t{\n\t\t\t\ttimeStamps.push({ minutes: hour * 60 + 30, label: this.formatAmPmSpan(Util.formatTime(hour, 30)) });\n\t\t\t}\n\t\t}\n\n\t\tlet timeMenu;\n\t\tconst items = timeStamps.map((timeStamp) => {\n\t\t\treturn {\n\t\t\t\thtml: Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__am-pm-container\">${timeStamp.label}</div>\n\t\t\t\t`,\n\t\t\t\tclassName: callbacks.isSelected(timeStamp.minutes) ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\t\tonclick: () => {\n\t\t\t\t\ttimeSelect.innerHTML = timeStamp.label;\n\t\t\t\t\tcallbacks.onItemSelected(timeStamp.minutes);\n\t\t\t\t\tthis.ruleUpdated();\n\t\t\t\t\ttimeMenu.close();\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\n\t\ttimeMenu = MenuManager.create({\n\t\t\tid: `calendar-sharing-settings-time-menu${Date.now()}`,\n\t\t\tclassName: 'calendar-sharing-settings-time-menu',\n\t\t\tbindElement: timeSelect,\n\t\t\titems,\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\tevents: {\n\t\t\t\tonShow: () => Dom.addClass(timeSelect, '--active'),\n\t\t\t\tonClose: () => Dom.removeClass(timeSelect, '--active'),\n\t\t\t},\n\t\t\tmaxHeight: 300,\n\t\t\tminWidth: timeSelect.offsetWidth,\n\t\t});\n\t\ttimeMenu.show();\n\n\t\tconst timezonesPopup = timeMenu.getPopupWindow();\n\t\tconst popupContent = timezonesPopup.getContentContainer();\n\t\tconst selectedTimezoneItem = popupContent.querySelector('.menu-popup-item.--selected');\n\t\tpopupContent.scrollTop = selectedTimezoneItem.offsetTop - selectedTimezoneItem.offsetHeight * 2;\n\t}\n\n\tonWeekdaysSelectClickHandler()\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.layout.weekdaysSelect);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.weekdaysMenu.show();\n\t\t}\n\t}\n\n\tonTimeSelectClickHandler(timeSelect, callbacks)\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(timeSelect);\n\t\t}\n\t\telse\n\t\tif (!Dom.hasClass(timeSelect, '--active'))\n\t\t{\n\t\t\tthis.showTimeMenu(timeSelect, callbacks);\n\t\t}\n\t}\n\n\tformatAmPmSpan(time): string\n\t{\n\t\treturn time.toLowerCase().replace(/(am|pm)/g, '<span class=\"calendar-sharing__settings-time-am-pm\">$1</span>');\n\t}\n\n\tformatMinutes(minutes): string\n\t{\n\t\tconst date = new Date(Util.parseDate('01.01.2000').getTime() + minutes * 60 * 1000);\n\n\t\treturn Util.formatTime(date);\n\t}\n\n\tgetWeekdaysTitle(): string\n\t{\n\t\tif ([...this.rule.weekdays].sort().toString() === this.workDays.sort().toString())\n\t\t{\n\t\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_WORKDAYS_MSGVER_1');\n\t\t}\n\n\t\treturn this.formatWeekdays();\n\t}\n\n\tformatWeekdays(singleDay = true): string\n\t{\n\t\tif (singleDay && this.rule.weekdays.length === 1)\n\t\t{\n\t\t\treturn Util.getWeekdaysLoc(true)[this.rule.weekdays[0]];\n\t\t}\n\n\t\tconst weekdaysLoc = Util.getWeekdaysLoc();\n\n\t\treturn this.rule.weekdays.map((w) => weekdaysLoc[w]).reduce((a, b) => `${a}, ${b}`, '');\n\t}\n\n\tgetSortedWeekdays(weekdays): []\n\t{\n\t\treturn weekdays\n\t\t\t.map((w) => (w < this.weekStart ? w + 10 : w))\n\t\t\t.sort((a, b) => a - b)\n\t\t\t.map((w) => w % 10);\n\t}\n}\n","import { DateTimeFormat } from 'main.date';\nimport { Dom, Event, Loc, Tag, Type } from 'main.core';\nimport { Popup, MenuManager } from 'main.popup';\nimport '../../css/settings.css';\nimport Range from './range';\nimport { Util } from 'calendar.util';\nimport { Analytics } from 'calendar.sharing.analytics';\n\ntype SettingsOptions = {\n\treadOnly: boolean,\n\trule: {\n\t\tslotSize: number,\n\t\tranges: Array<any>,\n\t},\n\tweekStart: number,\n\tworkDays: Array<number>,\n\tworkTimeStart: string,\n\tworkTimeEnd: string,\n\tcollapsed: boolean,\n}\n\nexport default class Settings\n{\n\tAVAILABLE_INTERVALS = [30, 45, 60, 90, 120, 180];\n\tMAX_RANGES = 5;\n\n\tlayout: {\n\t\twrap: HTMLElement,\n\t\tsubtitle: HTMLElement,\n\t\texpandRuleArrow: HTMLElement,\n\t\texpandRuleButton: HTMLElement,\n\t\trule: HTMLElement,\n\t\tweekdaysSelect: HTMLElement,\n\t\tslotSizeSelect: HTMLElement,\n\t\trangesContainer: HTMLElement,\n\t};\n\n\tconstructor(options: SettingsOptions)\n\t{\n\t\tthis.layout = {};\n\n\t\tthis.readOnly = options.readOnly;\n\n\t\tthis.collapsed = !options.readOnly && options.collapsed;\n\t\tif (!Type.isBoolean(options.collapsed))\n\t\t{\n\t\t\tthis.notExpandable = true;\n\t\t}\n\n\t\tthis.workTimeStart = options.workTimeStart;\n\t\tthis.workTimeEnd = options.workTimeEnd;\n\t\tthis.workDays = options.workDays;\n\t\tthis.weekStart = options.weekStart;\n\t\tthis.rule = {\n\t\t\tslotSize: options.rule.slotSize,\n\t\t};\n\n\t\tthis.ranges = [];\n\t\tfor (const rangeOptions of options.rule.ranges)\n\t\t{\n\t\t\tthis.ranges.push(this.getRange({\n\t\t\t\t...rangeOptions,\n\t\t\t\tshow: false,\n\t\t\t}));\n\t\t}\n\n\t\tif (!Type.isArrayFilled(this.ranges))\n\t\t{\n\t\t\tthis.ranges = [this.getRange()];\n\t\t}\n\n\t\tthis.sortRanges();\n\n\t\tthis.updateRanges();\n\t}\n\n\tgetRule(): any\n\t{\n\t\tconst ranges = this.ranges.map((range) => range.getRule());\n\t\tranges.sort((a, b) => this.compareRanges(a, b));\n\n\t\treturn JSON.parse(JSON.stringify({\n\t\t\tranges,\n\t\t\t...this.rule,\n\t\t}));\n\t}\n\n\tsortRanges()\n\t{\n\t\tthis.ranges.sort((a, b) => this.compareRanges(a.getRule(), b.getRule()));\n\t}\n\n\tcompareRanges(range1, range2): number\n\t{\n\t\tconst weekdaysWeight1 = this.getWeekdaysWeight(range1.weekdays);\n\t\tconst weekdaysWeight2 = this.getWeekdaysWeight(range2.weekdays);\n\n\t\tif (weekdaysWeight1 !== weekdaysWeight2)\n\t\t{\n\t\t\treturn weekdaysWeight1 - weekdaysWeight2;\n\t\t}\n\n\t\tif (range1.from !== range2.from)\n\t\t{\n\t\t\treturn range1.from - range2.from;\n\t\t}\n\n\t\treturn range1.to - range2.to;\n\t}\n\n\tgetWeekdaysWeight(weekdays): number\n\t{\n\t\treturn weekdays\n\t\t\t.map((w) => (w < this.weekStart ? w + 10 : w))\n\t\t\t.sort((a, b) => a - b)\n\t\t\t.reduce((accumulator, w, index) => {\n\t\t\t\treturn accumulator + w * 10 ** (10 - index);\n\t\t\t}, 0);\n\t}\n\n\tsettingPopupShown(): boolean\n\t{\n\t\tconst rangesWithPopup = this.ranges.filter((range) => range.settingPopupShown()) ?? [];\n\t\tconst rangePopupShown = rangesWithPopup.length > 0;\n\t\tconst slotSizePopupShown = Dom.hasClass(this.layout.slotSizeSelect, '--active');\n\t\tconst readOnlyPopupShown = this.readOnlyPopup?.isShown();\n\n\t\treturn rangePopupShown || slotSizePopupShown || readOnlyPopupShown;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst readOnlyClass = this.readOnly ? '--read-only' : '';\n\t\tconst expandedClass = this.collapsed ? '--hide' : '';\n\n\t\tthis.layout.wrap = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings ${readOnlyClass} ${expandedClass}\">\n\t\t\t\t${this.renderHeader()}\n\t\t\t\t${this.renderRule()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.layout.wrap;\n\t}\n\n\trenderHeader(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-header-container\">\n\t\t\t\t<div class=\"calendar-sharing__settings-header\">\n\t\t\t\t\t<div class=\"calendar-sharing__settings-title\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_SETTINGS_TITLE_V2')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderSubtitle()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-sharing__settings-header-button\">\n\t\t\t\t\t${this.renderExpandRuleButton()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderSubtitle(): HTMLElement\n\t{\n\t\tthis.layout.subtitle = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-subtitle\">\n\t\t\t\t${this.getSubtitleText()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.layout.subtitle;\n\t}\n\n\tupdateSubtitle(): void\n\t{\n\t\tif (!this.layout.subtitle)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.layout.subtitle.innerText = this.getSubtitleText();\n\t}\n\n\tgetSubtitleText(): string\n\t{\n\t\tif (this.isDefaultRule())\n\t\t{\n\t\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_SUBTITLE_DEFAULT');\n\t\t}\n\n\t\treturn Loc.getMessage('CALENDAR_SHARING_SETTINGS_SUBTITLE_PERSONAL');\n\t}\n\n\trenderExpandRuleButton(): HTMLElement|string\n\t{\n\t\tif (this.readOnly || this.notExpandable)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.layout.expandRuleArrow = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-select-arrow ${this.collapsed ? '' : '--active'}\"></div>\n\t\t`;\n\n\t\tthis.layout.expandRuleButton = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-expand\">\n\t\t\t\t${this.layout.expandRuleArrow}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.layout.expandRuleButton, 'click', this.toggle.bind(this));\n\n\t\treturn this.layout.expandRuleButton;\n\t}\n\n\trenderRule(): HTMLElement\n\t{\n\t\tthis.layout.rule = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-rule\">\n\t\t\t\t${this.renderRanges()}\n\t\t\t\t<div class=\"calendar-sharing__settings-slotSize\">\n\t\t\t\t\t<span class=\"calendar-sharing__settings-slotSize-title\">${Loc.getMessage('CALENDAR_SHARING_SETTINGS_SLOT_SIZE_V2')}</span>\n\t\t\t\t\t${this.getSettingsSlotSizeSelect()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.layout.rule;\n\t}\n\n\ttoggle(): void\n\t{\n\t\tthis.updateRuleHeight();\n\t\tsetTimeout(() => {\n\t\t\tDom.toggleClass(this.layout.wrap, '--hide');\n\t\t\tDom.toggleClass(this.layout.expandRuleArrow, '--active');\n\n\t\t\tthis.updateSharingSettingsCollapsedAction(Dom.hasClass(this.layout.wrap, '--hide'));\n\t\t}, 0);\n\t}\n\n\tupdateSharingSettingsCollapsedAction(isCollapsed: boolean): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.updateSharingSettingsCollapsed', {\n\t\t\tdata: {\n\t\t\t\tcollapsed: isCollapsed ? 'Y' : 'N',\n\t\t\t},\n\t\t});\n\t}\n\n\trenderRanges(): HTMLElement\n\t{\n\t\tthis.ranges.forEach((range) => range.disableAnimation());\n\n\t\tconst rangesContainer = Tag.render`\n\t\t\t<div class=\"calendar-sharing__settings-range-list\">\n\t\t\t\t${this.ranges.map((range) => range.render())}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.ranges.length === this.MAX_RANGES)\n\t\t{\n\t\t\tthis.ranges[0].hideButton();\n\t\t}\n\n\t\tif (Type.isDomNode(this.layout.rangesContainer))\n\t\t{\n\t\t\tthis.layout.rangesContainer.replaceWith(rangesContainer);\n\t\t}\n\n\t\tthis.layout.rangesContainer = rangesContainer;\n\n\t\treturn rangesContainer;\n\t}\n\n\tgetRange(rangeOptions): Range\n\t{\n\t\tconst date = new Date().toDateString();\n\t\tconst from = new Date(`${date} ${`${this.workTimeStart}`.replace('.', ':')}:00`);\n\t\tconst to = new Date(`${date} ${`${this.workTimeEnd}`.replace('.', ':')}:00`);\n\n\t\tconst isNotFirst = this.ranges?.length >= 1;\n\n\t\treturn new Range({\n\t\t\tgetSlotSize: () => this.rule.slotSize,\n\t\t\tfrom: this.getMinutesFromDate(from),\n\t\t\tto: this.getMinutesFromDate(to),\n\t\t\tweekdays: this.workDays,\n\t\t\tweekStart: this.weekStart,\n\t\t\tworkDays: this.workDays,\n\t\t\taddRange: (range) => this.addRange(range),\n\t\t\tremoveRange: (range) => this.removeRange(range),\n\t\t\tshowReadOnlyPopup: (node) => this.showReadOnlyPopup(node),\n\t\t\truleUpdated: () => this.ruleUpdated(),\n\t\t\tshow: isNotFirst,\n\t\t\treadOnly: this.readOnly,\n\t\t\t...rangeOptions,\n\t\t});\n\t}\n\n\taddRange(afterRange)\n\t{\n\t\tif (this.ranges.length >= this.MAX_RANGES)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newRange = this.getRange();\n\t\tthis.ranges.push(newRange);\n\n\t\tafterRange.getWrap().after(newRange.render());\n\n\t\tthis.updateRanges();\n\t}\n\n\tremoveRange(deletedRange): boolean\n\t{\n\t\tif (this.ranges.length <= 1)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.ranges = this.ranges.filter((range) => range !== deletedRange);\n\n\t\tthis.updateRanges();\n\n\t\treturn true;\n\t}\n\n\tgetSettingsSlotSizeSelect(): HTMLElement\n\t{\n\t\tthis.layout.slotSizeText = Tag.render`\n\t\t\t<span class=\"calendar-sharing__settings-select-link\">\n\t\t\t\t${Util.formatDuration(this.rule.slotSize)}\n\t\t\t</span>\n\t\t`;\n\n\t\tthis.layout.slotSizeSelect = Tag.render`\n\t\t\t<span class=\"calendar-sharing__settings-select-arrow --small-arrow\">\n\t\t\t\t${this.layout.slotSizeText}\n\t\t\t</span>\n\t\t`;\n\n\t\tEvent.bind(this.layout.slotSizeSelect, 'click', this.slotSizeSelectClickHandler.bind(this));\n\n\t\tconst items = this.AVAILABLE_INTERVALS.map((minutes) => {\n\t\t\treturn {\n\t\t\t\ttext: Util.formatDuration(minutes),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.rule.slotSize = minutes;\n\t\t\t\t\tthis.layout.slotSizeText.innerHTML = Util.formatDuration(this.rule.slotSize);\n\t\t\t\t\tthis.slotSizeMenu.close();\n\t\t\t\t\tthis.updateRanges();\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\n\t\tthis.slotSizeMenu = MenuManager.create({\n\t\t\tid: `calendar-sharing-settings-slotSize${Date.now()}`,\n\t\t\tbindElement: this.layout.slotSizeSelect,\n\t\t\titems,\n\t\t\tcloseByEsc: true,\n\t\t\tevents: {\n\t\t\t\tonShow: () => Dom.addClass(this.layout.slotSizeSelect, '--active'),\n\t\t\t\tonClose: () => Dom.removeClass(this.layout.slotSizeSelect, '--active'),\n\t\t\t},\n\t\t});\n\n\t\treturn this.layout.slotSizeSelect;\n\t}\n\n\tupdateRanges()\n\t{\n\t\tfor (const range of this.ranges.slice(0, -1))\n\t\t{\n\t\t\trange.setDeletable(true);\n\t\t\trange.update();\n\t\t}\n\n\t\tconst lastRange = this.ranges.slice(-1)[0];\n\t\tlastRange.setDeletable(this.ranges.length === 5);\n\t\tlastRange.update();\n\n\t\tthis.ruleUpdated();\n\t}\n\n\truleUpdated()\n\t{\n\t\tthis.updateSubtitle();\n\t\tthis.removeRuleHeight();\n\t}\n\n\tupdateRuleHeight()\n\t{\n\t\tDom.style(this.layout.rule, 'height', `${this.calculateRuleHeight()}px`);\n\t}\n\n\tcalculateRuleHeight()\n\t{\n\t\tconst topMarginHeight = 10;\n\t\tconst bottomMarginHeight = 2;\n\t\tconst marginsHeight = topMarginHeight + bottomMarginHeight;\n\t\tconst slotSizeHeight = 15;\n\t\tconst rangeHeight = 45;\n\n\t\treturn rangeHeight * this.ranges.length + (marginsHeight + slotSizeHeight);\n\t}\n\n\tremoveRuleHeight()\n\t{\n\t\tDom.style(this.layout.rule, 'height', null);\n\t}\n\n\tslotSizeSelectClickHandler()\n\t{\n\t\tif (this.readOnly)\n\t\t{\n\t\t\tthis.showReadOnlyPopup(this.layout.slotSizeSelect);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.slotSizeMenu.show();\n\t\t}\n\t}\n\n\tshowReadOnlyPopup(pivotNode)\n\t{\n\t\tthis.closeReadOnlyPopup();\n\t\tthis.getReadOnlyPopup(pivotNode).show();\n\t}\n\n\tgetReadOnlyPopup(pivotNode): Popup\n\t{\n\t\tthis.readOnlyPopup = new Popup({\n\t\t\tbindElement: pivotNode,\n\t\t\tclassName: 'calendar-sharing__settings-read-only-hint',\n\t\t\tcontent: Loc.getMessage('CALENDAR_SHARING_SETTINGS_READ_ONLY_HINT'),\n\t\t\tangle: {\n\t\t\t\toffset: 0,\n\t\t\t},\n\t\t\twidth: 300,\n\t\t\toffsetLeft: pivotNode.offsetWidth / 2,\n\t\t\tdarkMode: true,\n\t\t\tautoHide: true,\n\t\t});\n\n\t\tEvent.bind(this.readOnlyPopup.popupContainer, 'click', () => this.closeReadOnlyPopup());\n\n\t\tclearTimeout(this.closePopupTimeout);\n\t\tthis.closePopupTimeout = setTimeout(() => this.closeReadOnlyPopup(), 3000);\n\n\t\treturn this.readOnlyPopup;\n\t}\n\n\tcloseReadOnlyPopup()\n\t{\n\t\tthis.readOnlyPopup?.destroy();\n\t}\n\n\tgetMinutesFromDate(date): number\n\t{\n\t\tconst parsedTime = Util.parseTime(DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_TIME_FORMAT'), date / 1000));\n\n\t\treturn parsedTime.h * 60 + parsedTime.m;\n\t}\n\n\tisDefaultRule(): boolean\n\t{\n\t\treturn !this.isDifferentFrom(this.getDefaultRule());\n\t}\n\n\tisDifferentFrom(anotherRule): boolean\n\t{\n\t\treturn !this.objectsEqual(anotherRule, this.getRule());\n\t}\n\n\tgetChanges(): string[]\n\t{\n\t\tconst defaultRule = this.getDefaultRule();\n\t\tconst rule = this.getRule();\n\n\t\tconst sizeChanged = rule.slotSize !== defaultRule.slotSize;\n\t\tconst daysChanged = JSON.stringify(rule.ranges) !== JSON.stringify(defaultRule.ranges);\n\n\t\tconst changes = [];\n\n\t\tif (daysChanged)\n\t\t{\n\t\t\tchanges.push(Analytics.ruleChanges.custom_days);\n\t\t}\n\n\t\tif (sizeChanged)\n\t\t{\n\t\t\tchanges.push(Analytics.ruleChanges.custom_length);\n\t\t}\n\n\t\treturn changes;\n\t}\n\n\tgetDefaultRule()\n\t{\n\t\treturn {\n\t\t\tslotSize: 60,\n\t\t\tranges: [this.getRange().getRule()],\n\t\t};\n\t}\n\n\tobjectsEqual(obj1, obj2): boolean\n\t{\n\t\treturn JSON.stringify(this.sortKeys(obj1)) === JSON.stringify(this.sortKeys(obj2));\n\t}\n\n\tsortKeys(object): any\n\t{\n\t\treturn Object.keys(object).sort().reduce(\n\t\t\t(obj, key) => {\n\t\t\t\tobj[key] = object[key];\n\n\t\t\t\treturn obj;\n\t\t\t},\n\t\t\t{},\n\t\t);\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport default class HintInfo\n{\n\t#bindElement: HTMLElement;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t};\n\t#popup: Popup;\n\n\tconstructor(props)\n\t{\n\t\tthis.#bindElement = props.bindElement;\n\t\tthis.#layout = {};\n\n\t\tthis.#popup = new Popup({\n\t\t\tbindElement: this.#bindElement,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tangle: {\n\t\t\t\toffset: this.#bindElement.offsetWidth / 2 + 24,\n\t\t\t},\n\t\t\tborderRadius: '24px',\n\t\t\twidth: 425,\n\t\t\tcontent: this.getContent(),\n\t\t\tanimation: 'fading-slide',\n\t\t});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-wrapper\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_HINT_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-text-desc\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_HINT_DESC')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-hint-icon\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#popup?.show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n}","import { Text, Dom, Loc, Tag, Event } from 'main.core';\nimport { Dialog } from 'ui.entity-selector';\nimport HintInfo from './hint-info';\n\nexport default class UserSelector\n{\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\ttitle: HTMLElement,\n\t\tchevron: HTMLElement,\n\t\tuserSelectorWrapper: HTMLElement,\n\t\tuserSelector: HTMLElement,\n\t\thint: HTMLElement,\n\t};\n\t#userSelectorDialog: Dialog;\n\t#selectedEntityList: any;\n\t#selectedEntityNodeList: any;\n\t#defaultUserEntity: any;\n\t#isOpened: boolean;\n\t#onMembersAdded: function;\n\n\tconstructor(props = {})\n\t{\n\t\tthis.#layout = {};\n\t\tthis.#userSelectorDialog = null;\n\t\tthis.#selectedEntityList = {};\n\t\tthis.#selectedEntityNodeList = {};\n\t\tthis.#defaultUserEntity = props.userInfo || {};\n\t\tthis.#isOpened = false;\n\t\tthis.#onMembersAdded = props.onMembersAdded;\n\n\t\tthis.openEntitySelector = this.openEntitySelector.bind(this);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-main\">\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-title\">\n\t\t\t\t\t\t${this.renderTitle()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderUserSelectorWrapper()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trenderTitle(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-title-text\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_USER_SELECTOR_TITLE_V2')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst infoNotify = this.#layout.title.querySelector('[ data-role=\"calendar-sharing_popup-joint-slots\"]');\n\n\t\t\tif (infoNotify)\n\t\t\t{\n\t\t\t\tlet hintInfo;\n\t\t\t\tlet timer;\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseenter', () => {\n\t\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\t\tif (!hintInfo)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thintInfo = new HintInfo({\n\t\t\t\t\t\t\t\tbindElement: infoNotify,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thintInfo.show();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseleave', () => {\n\t\t\t\t\tclearTimeout(timer);\n\n\t\t\t\t\tif (hintInfo)\n\t\t\t\t\t{\n\t\t\t\t\t\thintInfo.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\trenderUserSelectorWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.userSelectorWrapper)\n\t\t{\n\t\t\tthis.#layout.userSelectorWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-wrapper\">\n\t\t\t\t\t${this.renderUserSelector()}\n\t\t\t\t\t<div class=\"calendar-sharing__user-selector-add\">\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.userSelectorWrapper, 'click', this.openEntitySelector);\n\t\t}\n\n\t\treturn this.#layout.userSelectorWrapper;\n\t}\n\n\trenderUserSelector(): HTMLElement\n\t{\n\t\tif (!this.#layout.userSelector)\n\t\t{\n\t\t\tconst entityNode = this.getDefaultEntityNode();\n\n\t\t\tthis.#layout.userSelector = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-container\" data-id=\"calendar-sharing-members\">\n\t\t\t\t\t${entityNode}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.userSelector;\n\t}\n\n\tgetDefaultEntityNode(): HTMLElement\n\t{\n\t\tconst entityNode = this.renderUserEntity(this.#defaultUserEntity);\n\t\tconst key = this.getEntityKey(this.#defaultUserEntity.id);\n\t\tthis.#selectedEntityList[key] = this.#defaultUserEntity;\n\t\tthis.#selectedEntityNodeList[key] = entityNode;\n\n\t\treturn entityNode;\n\t}\n\n\trenderUserEntity(entity): HTMLElement\n\t{\n\t\tif (this.hasAvatar(entity.avatar))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__user-selector-entity-container\">\n\t\t\t\t\t<img class=\"calendar-sharing__user-selector-entity\" title=\"${Text.encode(entity.name)}\" src=\"${entity.avatar}\" alt=\"\">\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user calendar-sharing__user-selector-entity\" title=\"${Text.encode(entity?.name)}\"><i></i></div>\n\t\t`;\n\t}\n\n\thasAvatar(avatar): boolean\n\t{\n\t\treturn avatar && avatar !== '/bitrix/images/1.gif';\n\t}\n\n\topenEntitySelector(): void\n\t{\n\t\tif (!this.#layout.userSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst preselectedItem = ['user', this.#defaultUserEntity.id];\n\n\t\tif (!this.#userSelectorDialog)\n\t\t{\n\t\t\tthis.#userSelectorDialog = new Dialog({\n\t\t\t\twidth: 340,\n\t\t\t\ttargetNode: this.#layout.userSelector,\n\t\t\t\tcontext: 'CALENDAR_SHARING',\n\t\t\t\tpreselectedItems: [preselectedItem],\n\t\t\t\tenableSearch: true,\n\t\t\t\tzIndex: 4200,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.onUserSelectorSelect(event);\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.onUserSelectorDeselect(event);\n\t\t\t\t\t},\n\t\t\t\t\t'onHide': () => {\n\t\t\t\t\t\tif (this.hasChanges())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#onMembersAdded();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfilters: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: 'calendar.jointSharingFilter',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\tthis.#userSelectorDialog.show();\n\t}\n\n\tisUserSelectorDialogOpened(): boolean\n\t{\n\t\tif (this.#userSelectorDialog)\n\t\t{\n\t\t\treturn this.#userSelectorDialog.isOpen();\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonUserSelectorSelect(event): void\n\t{\n\t\tconst item = event.data.item;\n\t\tconst entity = {\n\t\t\tid: item.id,\n\t\t\tavatar: item.avatar,\n\t\t\tname: `${item.customData.get('name')} ${item.customData.get('lastName') ?? ''}`.trim(),\n\t\t};\n\t\tconst entityNode = this.renderUserEntity(entity);\n\n\t\tif (this.#layout.userSelector)\n\t\t{\n\t\t\tDom.append(entityNode, this.#layout.userSelector);\n\t\t}\n\n\t\tconst key = this.getEntityKey(entity.id);\n\n\t\tthis.#selectedEntityList[key] = entity;\n\t\tthis.#selectedEntityNodeList[key] = entityNode;\n\n\t}\n\n\tonUserSelectorDeselect(event): void\n\t{\n\t\tconst item = event.data.item;\n\t\tconst key = this.getEntityKey(item.id);\n\n\t\tconst entityNode = this.#selectedEntityNodeList[key];\n\n\t\tif (entityNode)\n\t\t{\n\t\t\tDom.remove(entityNode);\n\t\t\tdelete this.#selectedEntityList[key];\n\t\t\tdelete this.#selectedEntityNodeList[key];\n\t\t}\n\t}\n\n\tclearSelectedUsers(): void\n\t{\n\t\tif (this.#layout.userSelector)\n\t\t{\n\t\t\tDom.clean(this.#layout.userSelector);\n\t\t\tthis.#selectedEntityList = {};\n\t\t\tthis.#selectedEntityNodeList = {};\n\n\t\t\tconst entityNode = this.getDefaultEntityNode();\n\t\t\tDom.append(entityNode, this.#layout.userSelector);\n\t\t}\n\n\t\tif (this.#userSelectorDialog)\n\t\t{\n\t\t\tthis.#userSelectorDialog.destroy();\n\t\t\tthis.#userSelectorDialog = null;\n\t\t}\n\t}\n\n\thasChanges(): boolean\n\t{\n\t\treturn this.getPeopleCount() > 1;\n\t}\n\n\tgetPeopleCount(): any\n\t{\n\t\treturn Object.keys(this.#selectedEntityList).length;\n\t}\n\n\tgetSelectedUserIdList(): any\n\t{\n\t\tconst result = [];\n\n\t\tObject.values(this.#selectedEntityList).forEach((entity) => {\n\t\t\tresult.push(entity.id);\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetEntityKey(id)\n\t{\n\t\treturn `user-${id}`;\n\t}\n}","import { Text, Dom, Tag, Loc, Event } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { Icon, Actions, Main } from 'ui.icon-set.api.core';\nimport { MenuManager, Menu } from 'main.popup';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { Button, ButtonSize, ButtonColor } from 'ui.buttons';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.icon-set.actions'\n\n\nconst MAX_AVATAR_COUNT = 4;\n\ntype ListItemProps = {\n\tid: number,\n\thash: string,\n\tshortUrl: string,\n\tmembers: any,\n\tfrequentUse: number,\n\tuserId: number,\n\tuserIds: any,\n\tuserInfo: any,\n\ttype: string,\n\tpathToUser: string,\n\tsetListItemPopupState: func,\n\tdateCreate: string,\n};\n\nexport default class ListItem\n{\n\t#props: ListItemProps;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\tavatarContainer: HTMLElement,\n\t\tdate: HTMLElement,\n\t\tcopyButton: HTMLElement,\n\t\tdeleteButton: HTMLElement,\n\t};\n\t#avatarPopup: Menu;\n\t#deletePopup: MessageBox;\n\n\tconstructor(props: ListItemProps)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#layout = {};\n\t\tthis.#avatarPopup = null;\n\t\tthis.#deletePopup = null;\n\n\t\tthis.openAvatarList = this.openAvatarList.bind(this);\n\t\tthis.onCopyButtonClick = this.onCopyButtonClick.bind(this);\n\t\tthis.onDeleteButtonClick = this.onDeleteButtonClick.bind(this);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item\">\n\t\t\t\t\t${this.renderAvatarContainer()}\n\t\t\t\t\t${this.renderDate()}\n\t\t\t\t\t${this.renderCopyButton()}\n\t\t\t\t\t${this.renderDeleteButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trenderAvatarContainer(): HTMLElement\n\t{\n\t\tif (!this.#layout.avatarContainer)\n\t\t{\n\t\t\tconst showMoreIcon = this.#props.members.length > MAX_AVATAR_COUNT;\n\t\t\tconst moreCounter = this.#props.members.length - MAX_AVATAR_COUNT;\n\n\t\t\tthis.#layout.avatarContainer = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-avatar-container\">\n\t\t\t\t\t${this.renderAvatar(this.#props.userInfo)}\n\t\t\t\t\t${this.#props.members.slice(0, MAX_AVATAR_COUNT).map((member) => this.renderAvatar(member))}\n\t\t\t\t\t${showMoreIcon ? this.renderMore(moreCounter) : null}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.avatarContainer, 'click', this.openAvatarList);\n\t\t}\n\n\t\treturn this.#layout.avatarContainer;\n\t}\n\n\trenderAvatar(user): HTMLElement\n\t{\n\t\tconst name = `${user.name} ${user.lastName ?? ''}`.trim();\n\n\t\tif (this.hasAvatar(user.avatar))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<img class=\"calendar-sharing__dialog-link-list-item-avatar\" title=\"${Text.encode(name)}\" alt=\"\" src=\"${user.avatar}\">\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-icon ui-icon-common-user calendar-sharing__dialog-link-list-item-avatar\" title=\"${Text.encode(name)}\"><i></i></div>\n\t\t`;\n\t}\n\n\thasAvatar(avatar): boolean\n\t{\n\t\treturn avatar && avatar !== '/bitrix/images/1.gif';\n\t}\n\n\trenderMore(counter): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-more\">\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-more-text\">${'+' + counter}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\topenAvatarList(): void\n\t{\n\t\tif (!this.#avatarPopup)\n\t\t{\n\t\t\tconst uid = BX.util.getRandomString(6);\n\n\t\t\tthis.#avatarPopup = MenuManager.create({\n\t\t\t\tid: 'calendar-sharing-dialog_' + uid,\n\t\t\t\tbindElement: this.#layout.avatarContainer,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tclassName: 'calendar-sharing__dialog-link-list-user-popup-container',\n\t\t\t\titems: this.getAvatarPopupItems(),\n\t\t\t\tmaxHeight: 250,\n\t\t\t\tmaxWidth: 300,\n\t\t\t});\n\t\t\tthis.#avatarPopup.getPopupWindow().subscribe('onClose', () => {\n\t\t\t\tthis.setPopupState(false);\n\t\t\t});\n\n\t\t\tconst menuContainer = this.#avatarPopup.getMenuContainer();\n\n\t\t\tlet timeout;\n\n\t\t\tEvent.bind(menuContainer, 'mouseleave', () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(() => {\n\t\t\t\t\tthis.closeAvatarList();\n\t\t\t\t}, 500);\n\t\t\t});\n\t\t\tEvent.bind(menuContainer, 'mouseenter', () => {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t});\n\t\t}\n\n\t\tthis.#avatarPopup.show();\n\t\tthis.setPopupState(true);\n\t}\n\n\tcloseAvatarList(): void\n\t{\n\t\tif (this.#avatarPopup)\n\t\t{\n\t\t\tthis.#avatarPopup.close();\n\t\t}\n\t}\n\n\tgetAvatarPopupItems(): any\n\t{\n\t\tconst result = [];\n\n\t\tresult.push(this.getAvatarPopupItem(this.#props.userInfo));\n\t\tthis.#props.members.forEach((member) => {\n\t\t\tresult.push(this.getAvatarPopupItem(member));\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tgetAvatarPopupItem(user): any\n\t{\n\t\tconst avatar = user.avatar;\n\t\tconst name = `${user.name} ${user.lastName ?? ''}`.trim();\n\t\tconst userPath = this.#props.pathToUser.replace('#USER_ID#', user.id);\n\n\t\treturn {\n\t\t\thtml: Tag.render`\n\t\t\t\t<a href=\"${userPath}\" target=\"_blank\" class=\"calendar-sharing__dialog-link-list-user-popup-item\">\n\t\t\t\t\t<span class=\"ui-icon ui-icon-common-user calendar-sharing__dialog-link-list-user-popup-item-avatar\">\n\t\t\t\t\t\t<i style=\"${this.hasAvatar(avatar) ? `background-image: url('${avatar}')` : ''}\"></i>\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-user-popup-item-text\">\n\t\t\t\t\t\t${Text.encode(name)}\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`,\n\t\t};\n\t}\n\n\trenderDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.date)\n\t\t{\n\t\t\tconst date = this.#props.dateCreate\n\t\t\t\t? new Date(this.#props.dateCreate)\n\t\t\t\t: new Date()\n\t\t\t;\n\t\t\tconst formattedDate = Util.formatDate(date);\n\n\t\t\tthis.#layout.date = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-date\" title=\"${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DATE_CREATE')}\">${formattedDate}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.date;\n\t}\n\n\trenderCopyButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.copyButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Main.LINK_3,\n\t\t\t\tsize: 14,\n\t\t\t});\n\n\t\t\tthis.#layout.copyButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-copy-container\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-copy-text\">${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_COPY')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.copyButton, 'click', this.onCopyButtonClick);\n\t\t}\n\n\t\treturn this.#layout.copyButton;\n\t}\n\n\tonCopyButtonClick(): void\n\t{\n\t\tEventEmitter.emit('CalendarSharing:onJointLinkCopy', {\n\t\t\tid: this.#props.id,\n\t\t\tshortUrl: this.#props.shortUrl,\n\t\t\thash: this.#props.hash,\n\t\t\tmembers: this.#props.members,\n\t\t});\n\t}\n\n\trenderDeleteButton(): HTMLElement\n\t{\n\t\tif (!this.#props.members.length)\n\t\t{\n\t\t\treturn Tag.render`<div class=\"calendar-sharing__dialog-link-list-item-delete\"></div>`;\n\t\t}\n\n\t\tif (!this.#layout.deleteButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.CROSS_30,\n\t\t\t\tsize: 18,\n\t\t\t});\n\n\t\t\tthis.#layout.deleteButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-item-delete\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.deleteButton, 'click', this.onDeleteButtonClick);\n\t\t}\n\n\t\treturn this.#layout.deleteButton;\n\t}\n\n\tonDeleteButtonClick(): void\n\t{\n\t\tif (!this.#deletePopup)\n\t\t{\n\t\t\tthis.#deletePopup = new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DELETE_MESSAGE_TITLE_MSGVER_1'),\n\t\t\t\tmessage: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_DELETE_MESSAGE_DESC_MSGVER_1'),\n\t\t\t\tbuttons: this.getDeletePopupButtons(),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tminWidth: 365,\n\t\t\t\t\tmaxWidth: 385,\n\t\t\t\t\tminHeight: 180,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.#deletePopup.show();\n\t\tthis.setPopupState(true);\n\t}\n\n\tgetDeletePopupButtons(): any\n\t{\n\t\treturn [\n\t\t\tnew Button({\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\tcolor: ButtonColor.DANGER,\n\t\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_DELETE'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.deleteLink();\n\t\t\t\t\t\tthis.#deletePopup.close();\n\t\t\t\t\t\tthis.setPopupState(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew Button({\n\t\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_CANCEL_BUTTON'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.#deletePopup.close();\n\t\t\t\t\t\tthis.setPopupState(false);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t];\n\t}\n\n\tdeleteLink(): void\n\t{\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tBX.ajax.runAction('calendar.api.sharingajax.disableUserLink', {\n\t\t\t\tdata: {\n\t\t\t\t\thash: this.#props.hash,\n\t\t\t\t},\n\t\t\t});\n\t\t\tDom.addClass(this.#layout.wrapper, '--animate-delete');\n\t\t\tsetTimeout(() => {\n\t\t\t\tDom.remove(this.#layout.wrapper);\n\t\t\t}, 300);\n\n\t\t\tEventEmitter.emit('CalendarSharing:onJointLinkDelete', {\n\t\t\t\tid: this.#props.id,\n\t\t\t});\n\t\t}\n\t}\n\n\tsetPopupState(state): void\n\t{\n\t\tthis.#props?.setListItemPopupState(state);\n\t}\n}","import { Dom, Tag, Loc, Event, Type } from 'main.core';\nimport { Icon, Actions } from 'ui.icon-set.api.core';\nimport { EventEmitter } from 'main.core.events';\nimport ListItem from './list-item';\nimport 'ui.icon-set.actions'\n\nconst DEFAULT_LIST_HEIGHT = 300;\nconst LIST_PADDING_SUM = 45;\n\ntype ListProps = {\n\tuserInfo: any,\n\tonLinkListClose: func,\n\tsortJointLinksByFrequentUse: boolean,\n};\n\nexport default class List\n{\n\t#props: ListProps;\n\t#layout: {\n\t\twrapper: HTMLElement,\n\t\ttitle: HTMLElement,\n\t\tsortingButton: HTMLElement,\n\t\tsortingButtonText: HTMLElement,\n\t\tbackButton: HTMLElement,\n\t\tlist: HTMLElement,\n\t\temptyState: HTMLElement,\n\t};\n\t#linkList: any;\n\t#popupOpenState = false;\n\t#sortByFrequentUse: boolean;\n\t#pathToUser: string;\n\n\tconstructor(props: ListProps)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#layout = {};\n\t\tthis.#linkList = null;\n\t\tthis.#pathToUser = null;\n\t\tthis.#sortByFrequentUse = props.sortJointLinksByFrequentUse;\n\t\tthis.getLinkListInfo();\n\n\t\tthis.setListItemPopupState = this.setListItemPopupState.bind(this);\n\n\t\tthis.eventSubscribe();\n\t}\n\n\teventSubscribe()\n\t{\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkCopy', (event) => {\n\t\t\tthis.onJointLinkCopy(event);\n\t\t});\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkDelete', (event) => {\n\t\t\tthis.onJointLinkDelete(event);\n\t\t});\n\t}\n\n\tgetLinkListInfo(): void\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.getAllUserLink').then((response) => {\n\t\t\tif (response && response.data)\n\t\t\t{\n\t\t\t\tthis.#linkList = response.data.userLinks;\n\t\t\t\tthis.#pathToUser = response.data.pathToUser;\n\n\t\t\t\tthis.updateLinkList();\n\n\t\t\t\tif (this.isListEmpty())\n\t\t\t\t{\n\t\t\t\t\tthis.hideSortingButton();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.#linkList)\n\t\t\t\t{\n\t\t\t\t\tthis.showSortingButton();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper =  Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-wrapper\">\n\t\t\t\t\t${this.getTitleNode()}\n\t\t\t\t\t${this.getListNode()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\tgetTitleNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title =  Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title\">\n\t\t\t\t\t\t${this.getChevronBackIcon()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-title-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_LINK_LIST_TITLE')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getSortingButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\tgetChevronBackIcon(): HTMLElement\n\t{\n\t\tif (!this.#layout.backButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.CHEVRON_LEFT,\n\t\t\t\tsize: 24,\n\t\t\t});\n\n\t\t\tthis.#layout.backButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-back-button\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.backButton, 'click', this.close.bind(this));\n\t\t}\n\n\t\treturn this.#layout.backButton;\n\t}\n\n\tgetSortingButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.sortingButton)\n\t\t{\n\t\t\tconst icon = new Icon({\n\t\t\t\ticon: Actions.SORT,\n\t\t\t\tsize: 14,\n\t\t\t\tcolor: '#2066b0',\n\t\t\t});\n\n\t\t\tthis.#layout.sortingButton = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-sorting-button\">\n\t\t\t\t\t${icon.render()}\n\t\t\t\t\t${this.getSortingButtonText()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.sortingButton, 'click', this.changeListSort.bind(this));\n\t\t}\n\n\t\treturn this.#layout.sortingButton;\n\t}\n\n\tgetSortingButtonText(): HTMLElement\n\t{\n\t\tif (!this.#layout.sortingButtonText)\n\t\t{\n\t\t\tthis.#layout.sortingButtonText = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-sorting-button-text\">\n\t\t\t\t\t${this.#getSortingName()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.sortingButtonText;\n\t}\n\n\tgetListNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.list)\n\t\t{\n\t\t\tthis.#layout.list = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-container\">\n\t\t\t\t\t${this.getListItemsNode()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.list;\n\t}\n\n\tgetListItemsNode(): HTMLElement\n\t{\n\t\tif (this.isListEmpty())\n\t\t{\n\t\t\treturn this.getEmptyStateNode();\n\t\t}\n\n\t\tconst linkListItems = this.getListItems();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__dialog-link-list\">\n\t\t\t\t${linkListItems.map((listItem) => listItem.render())}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetEmptyStateNode(): HTMLElement\n\t{\n\t\tif (!this.#layout.emptyState)\n\t\t{\n\t\t\tthis.#layout.emptyState = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-wrapper\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-icon\"></div>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-link-list-empty-state-text\">${Loc.getMessage('CALENDAR_SHARING_LIST_EMPTY_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.emptyState;\n\t}\n\n\tgetListItems(): any\n\t{\n\t\tif (this.#sortByFrequentUse)\n\t\t{\n\t\t\treturn this.getSortedByFrequentUseListItems();\n\t\t}\n\n\t\treturn this.getSortedByDateListItems();\n\t}\n\n\tgetSortedByFrequentUseListItems(): any\n\t{\n\t\treturn Object.values(this.#linkList).sort((a, b) => {\n\t\t\tif (a.frequentUse > b.frequentUse)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.frequentUse < b.frequentUse)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (a.id > b.id)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (a.id < b.id)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}).map((item) => new ListItem({\n\t\t\t...item,\n\t\t\tuserInfo: this.#props.userInfo,\n\t\t\tpathToUser: this.#pathToUser,\n\t\t\tsetListItemPopupState: this.setListItemPopupState,\n\t\t}));\n\t}\n\n\tgetSortedByDateListItems(): any\n\t{\n\t\treturn Object.keys(this.#linkList).sort((a, b) => b - a).map((index) => {\n\t\t\treturn new ListItem({\n\t\t\t\t...this.#linkList[index],\n\t\t\t\tuserInfo: this.#props.userInfo,\n\t\t\t\tpathToUser: this.#pathToUser,\n\t\t\t\tsetListItemPopupState: this.setListItemPopupState,\n\t\t\t});\n\t\t});\n\t}\n\n\tshow(maxListHeight): void\n\t{\n\t\tif (this.#layout.list && maxListHeight)\n\t\t{\n\t\t\tDom.style(this.#layout.list, 'max-height', `${maxListHeight - LIST_PADDING_SUM}px`);\n\t\t}\n\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tDom.addClass(this.#layout.wrapper, '--show');\n\t\t}\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.#layout.list)\n\t\t{\n\t\t\tDom.style(this.#layout.list, 'max-height', `${DEFAULT_LIST_HEIGHT}px`);\n\t\t}\n\n\t\tif (this.#layout.wrapper)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.wrapper, '--show');\n\t\t}\n\n\t\tif (this.#props.onLinkListClose)\n\t\t{\n\t\t\tthis.#props.onLinkListClose();\n\t\t}\n\t}\n\n\tupdateLinkList(): void\n\t{\n\t\tif (this.#layout.list)\n\t\t{\n\t\t\tDom.clean(this.getListNode());\n\n\t\t\tconst listItems = this.getListItemsNode();\n\t\t\tDom.append(listItems, this.#layout.list);\n\t\t}\n\t}\n\n\tchangeListSort(): void\n\t{\n\t\tthis.#sortByFrequentUse = !this.#sortByFrequentUse;\n\t\tBX.ajax.runAction('calendar.api.sharingajax.setSortJointLinksByFrequentUse', {\n\t\t\tdata: {\n\t\t\t\tsortByFrequentUse: this.#sortByFrequentUse ? 'Y' : 'N',\n\t\t\t},\n\t\t});\n\n\t\tconst sortName = this.#getSortingName();\n\n\t\tif (this.#layout.sortingButtonText)\n\t\t{\n\t\t\tDom.adjust(this.#layout.sortingButtonText, {\n\t\t\t\ttext: sortName,\n\t\t\t});\n\t\t}\n\n\t\tthis.updateLinkList();\n\t}\n\n\t#getSortingName(): string\n\t{\n\t\treturn this.#sortByFrequentUse\n\t\t\t? Loc.getMessage('CALENDAR_SHARING_LINK_LIST_SORT_RECENT')\n\t\t\t: Loc.getMessage('CALENDAR_SHARING_LINK_LIST_SORT_DATE');\n\t}\n\n\tsetListItemPopupState(state): void\n\t{\n\t\tthis.#popupOpenState = state;\n\t}\n\n\tisOpenListItemPopup(): boolean\n\t{\n\t\treturn this.#popupOpenState;\n\t}\n\n\tonJointLinkCopy(event): void\n\t{\n\t\tconst id = event.data.id;\n\t\tconst hash = event.data.hash;\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.#linkList[id])\n\t\t\t{\n\t\t\t\tthis.#linkList[id].frequentUse = this.#linkList[id].frequentUse + 1;\n\t\t\t\tthis.updateLinkList();\n\t\t\t}\n\t\t}, 1000);\n\n\t\tBX.ajax.runAction('calendar.api.sharingajax.increaseFrequentUse', {\n\t\t\tdata: {\n\t\t\t\thash,\n\t\t\t},\n\t\t});\n\t}\n\n\tonJointLinkDelete(event): void\n\t{\n\t\tconst id = event.data.id;\n\n\t\tif (this.#linkList[id])\n\t\t{\n\t\t\tdelete this.#linkList[id];\n\t\t}\n\n\t\tif (this.isListEmpty())\n\t\t{\n\t\t\tthis.updateLinkList();\n\t\t\tthis.hideSortingButton();\n\t\t}\n\t}\n\n\tisListEmpty()\n\t{\n\t\treturn Type.isNil(this.#linkList)\n\t\t\t|| (Type.isArray(this.#linkList) && !Type.isArrayFilled(this.#linkList))\n\t\t\t|| (Type.isObject(this.#linkList) && !Object.keys(this.#linkList).length)\n\t\t;\n\t}\n\n\thideSortingButton()\n\t{\n\t\tif (this.#layout.sortingButton)\n\t\t{\n\t\t\tDom.addClass(this.#layout.sortingButton, '--hide');\n\t\t}\n\t}\n\n\tshowSortingButton()\n\t{\n\t\tif (this.#layout.sortingButton)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.sortingButton, '--hide');\n\t\t}\n\t}\n}","import { Dom, Tag, Loc, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Analytics } from 'calendar.sharing.analytics';\nimport DialogQr from './dialog-qr';\n\nimport 'main.qrcode';\nimport 'ui.design-tokens';\nimport { Util } from 'calendar.util';\nimport Settings from './rule/settings';\nimport UserSelector from \"./joint/user-selector\";\nimport List from './link-list/list';\n\ntype DialogOptions = {\n\tbindElement: HTMLElement,\n\tdialogQr: DialogQr,\n\tuserInfo: { name: string, avatar: ?string, id: number } | null,\n\tsharingUrl: string,\n\tlinkHash: string,\n\tsharingRule: any,\n\tcalendarSettings: any,\n\tcontext: 'calendar' | 'crm',\n\treadOnly: boolean,\n\tsettingsCollapsed: boolean,\n\tsortJointLinksByFrequentUse: boolean,\n}\n\nexport default class DialogNew\n{\n\t// eslint-disable-next-line unicorn/numeric-separators-style\n\tHELP_DESK_CODE_CALENDAR = 17198666;\n\t// eslint-disable-next-line unicorn/numeric-separators-style\n\tHELP_DESK_CODE_CRM = 17502612;\n\t#options: DialogOptions;\n\t#popup;\n\t#layout;\n\t#dialogQr;\n\t#context;\n\t#settings;\n\t#calendarContext = 'calendar';\n\t#crmContext = 'crm';\n\t#settingsControl;\n\t#userSelectorControl;\n\t#linkList;\n\n\tconstructor(options: DialogOptions)\n\t{\n\t\tthis.#options = options;\n\t\tthis.#popup = null;\n\t\tthis.#dialogQr = null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tcontentWrapper: null,\n\t\t\tcontentTop: null,\n\t\t\tcontentBody: null,\n\t\t\tcontentBottom: null,\n\t\t\tlistWrapper: null,\n\t\t\tbuttonCopy: null,\n\t\t\tbuttonHistory: null,\n\t\t\tbuttonWhatSeeUsers: null,\n\t\t};\n\t\tthis.#context = options.context;\n\n\t\tthis.#settingsControl = null;\n\t\tthis.#userSelectorControl = null;\n\t\tthis.#linkList = null;\n\n\t\tconst weekHolidays = new Set(options.calendarSettings.weekHolidays.map((day) => Util.getIndByWeekDay(day)));\n\n\t\tthis.#settings = {\n\t\t\treadOnly: options.readOnly ?? false,\n\t\t\trule: {\n\t\t\t\tslotSize: options.sharingRule.slotSize ?? 60,\n\t\t\t\tranges: options.sharingRule.ranges ?? [],\n\t\t\t},\n\t\t\tweekStart: Util.getIndByWeekDay(options.calendarSettings.weekStart),\n\t\t\tworkDays: [0, 1, 2, 3, 4, 5, 6].filter((day) => !weekHolidays.has(day)),\n\t\t\tworkTimeStart: options.calendarSettings.workTimeStart,\n\t\t\tworkTimeEnd: options.calendarSettings.workTimeEnd,\n\t\t\tcollapsed: options.settingsCollapsed,\n\t\t};\n\n\t\tthis.bindElement = options.bindElement || null;\n\t\tthis.sharingUrl = options.sharingUrl || null;\n\t\tthis.linkHash = options.linkHash;\n\t\tthis.userInfo = options.userInfo || null;\n\n\t\tthis.onPopupClose = this.onPopupClose.bind(this);\n\t\tthis.onCopyButtonClick = this.onCopyButtonClick.bind(this);\n\n\t\tEventEmitter.subscribe('CalendarSharing:onJointLinkCopy', (event) => {\n\t\t\tconst shortUrl = event.data.shortUrl;\n\n\t\t\tif (this.copyLink(shortUrl))\n\t\t\t{\n\t\t\t\tthis.onSuccessfulCopyingLink();\n\t\t\t}\n\n\t\t\tAnalytics.sendLinkCopiedList(this.#context, {\n\t\t\t\tpeopleCount: event.data.members.length + 1,\n\t\t\t\truleChanges: this.#settingsControl.getChanges(),\n\t\t\t});\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tEvent.bind(window, 'beforeunload', this.saveSharingRule.bind(this));\n\t}\n\n\t/**\n\t *\n\t * @returns {Popup}\n\t */\n\tgetPopup(): Popup\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = new Popup({\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tclassName: 'calendar-sharing__dialog',\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tpadding: 0,\n\t\t\t\twidth: 470,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.bindElement.offsetWidth / 2 + 16,\n\t\t\t\t},\n\t\t\t\tautoHideHandler: (event) => this.canBeClosed(event),\n\t\t\t\tcontent: this.getPopupWrapper(),\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: this.onPopupShow.bind(this),\n\t\t\t\t\tonPopupClose: this.onPopupClose.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn this.#popup;\n\t}\n\n\tonPopupShow()\n\t{\n\t\tDom.addClass(this.bindElement, 'ui-btn-hover');\n\n\t\tAnalytics.sendPopupOpened(this.#context);\n\t}\n\n\tonPopupClose()\n\t{\n\t\tDom.removeClass(this.bindElement, 'ui-btn-hover');\n\t\tthis.saveSharingRule();\n\t\tthis.clearSelectedUsers();\n\t\tthis.closeLinkList();\n\t}\n\n\tcanBeClosed(event): boolean\n\t{\n\t\tconst isClickInside = this.#layout.wrapper.contains(event.target);\n\t\tconst isQrDialogShown = this.#dialogQr?.isShown();\n\t\tconst isSettingsPopupShown = this.#settingsControl.settingPopupShown();\n\t\tconst isUserSelectorDialogOpened = this.#userSelectorControl?.isUserSelectorDialogOpened();\n\t\tconst isListItemPopupOpened = this.#linkList?.isOpenListItemPopup();\n\t\tconst checkTopSlider = (this.#context === this.#calendarContext)\n\t\t\t? Util.getBX().SidePanel.Instance.getTopSlider()\n\t\t\t: false\n\t\t;\n\n\t\treturn !isClickInside\n\t\t\t&& !isQrDialogShown\n\t\t\t&& !isSettingsPopupShown\n\t\t\t&& !isUserSelectorDialogOpened\n\t\t\t&& !isListItemPopupOpened\n\t\t\t&& !checkTopSlider\n\t\t;\n\t}\n\n\t/**\n\t *\n\t * @returns {DialogQr}\n\t */\n\tgetDialogQr(): DialogQr\n\t{\n\t\tif (!this.#dialogQr)\n\t\t{\n\t\t\tthis.#dialogQr = new DialogQr({\n\t\t\t\tsharingUrl: this.sharingUrl,\n\t\t\t\tcontext: this.#context,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#dialogQr;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetPopupWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-wrapper\">\n\t\t\t\t\t${this.getPopupContentMain()}\n\t\t\t\t\t${this.getPopupContentList()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\tgetPopupContentMain()\n\t{\n\t\tif (!this.#layout.contentWrapper)\n\t\t{\n\t\t\tthis.#layout.contentWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-content-wrapper --show\">\n\t\t\t\t\t${this.getPopupContentTop()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-body\">\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-message\">\n\t\t\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-info-icon-container\">\n\t\t\t\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-info-icon\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"calendar-sharing__dialog-notify\" onclick=\"${this.onOpenLink.bind(this)}\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('SHARING_INFO_POPUP_CONTENT_4_V3', { '#LINK#': this.sharingUrl })}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getSettingsNode()}\n\t\t\t\t\t\t\t${this.getUserSelectorNode()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t${this.getPopupContentBottom()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.contentWrapper;\n\t}\n\n\tgetPopupContentList()\n\t{\n\t\tif (this.#context === this.#crmContext)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#linkList)\n\t\t{\n\t\t\tthis.#linkList = new List({\n\t\t\t\tuserInfo: this.userInfo,\n\t\t\t\tonLinkListClose: this.onLinkListClose.bind(this),\n\t\t\t\tsortJointLinksByFrequentUse: this.#options.sortJointLinksByFrequentUse,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#linkList.render();\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetPopupCopyLinkButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonCopy)\n\t\t{\n\t\t\tthis.#layout.buttonCopy = Tag.render`\n\t\t\t\t<span class=\"ui-btn ui-btn-success ui-btn-round ui-btn-no-caps calendar-sharing__dialog-copy\">\n\t\t\t\t\t${Loc.getMessage('SHARING_DIALOG_SHARING_BLOCK_COPY_LINK_BUTTON')}\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonCopy, 'click', this.onCopyButtonClick);\n\t\t}\n\n\t\treturn this.#layout.buttonCopy;\n\t}\n\n\tgetPopupLinkHistoryButton(): HTMLElement\n\t{\n\t\tif (this.#context === this.#crmContext)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#layout.buttonHistory)\n\t\t{\n\t\t\tthis.#layout.buttonHistory = Tag.render`\n\t\t\t\t<span\n\t\t\t\t\tclass=\"ui-btn ui-btn-round ui-btn-light ui-btn-no-caps calendar-sharing__dialog-people\"\n\t\t\t\t\tdata-id=\"calendar-sharing-history-btn\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('SHARING_DIALOG_SHARING_BLOCK_JOINT_SLOTS_BUTTON')}\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonHistory, 'click', this.openLinkList.bind(this));\n\t\t}\n\n\t\treturn this.#layout.buttonHistory;\n\t}\n\n\tgetPopupWhatSeeUsersButton()\n\t{\n\t\tif (this.#context === this.#calendarContext)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#layout.buttonWhatSeeUsers)\n\t\t{\n\t\t\tconst adjustClick = () => {\n\t\t\t\tthis.saveSharingRule();\n\t\t\t\tthis.getDialogQr().show();\n\t\t\t};\n\n\t\t\tthis.#layout.buttonWhatSeeUsers = Tag.render`\n\t\t\t\t<span onclick=\"${adjustClick}\" class=\"calendar-sharing__dialog-link\">\n\t\t\t\t\t${Loc.getMessage('SHARING_INFO_POPUP_WHAT_SEE_USERS')}\n\t\t\t\t</span>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonWhatSeeUsers, 'click', adjustClick);\n\t\t}\n\n\t\treturn this.#layout.buttonWhatSeeUsers;\n\t}\n\n\tonCopyButtonClick()\n\t{\n\t\tconst params = {\n\t\t\tpeopleCount: this.#userSelectorControl?.getPeopleCount() ?? 1,\n\t\t\truleChanges: this.#settingsControl.getChanges(),\n\t\t};\n\n\t\tif (this.#userSelectorControl && this.#userSelectorControl.hasChanges())\n\t\t{\n\t\t\tAnalytics.sendLinkCopied(this.#context, Analytics.linkTypes.multiple, params);\n\n\t\t\tthis.saveJointLink();\n\t\t}\n\t\telse if (this.copyLink(this.sharingUrl))\n\t\t{\n\t\t\tAnalytics.sendLinkCopied(this.#context, Analytics.linkTypes.solo, params);\n\n\t\t\tif (this.#context === this.#calendarContext)\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.sharingajax.increaseFrequentUse', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\thash: this.linkHash,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.onSuccessfulCopyingLink();\n\t\t}\n\t}\n\n\tasync saveJointLink()\n\t{\n\t\tif (this.#layout.buttonCopy && Dom.hasClass(this.#layout.buttonCopy, 'ui-btn-clock'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.buttonCopy, 'ui-btn-clock');\n\n\t\tconst memberIds = this.#userSelectorControl.getSelectedUserIdList();\n\n\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.generateUserJointSharingLink', {\n\t\t\tdata: {\n\t\t\t\tmemberIds,\n\t\t\t},\n\t\t});\n\n\t\tif (response && response.data)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.buttonCopy, 'ui-btn-clock');\n\n\t\t\tconst { url } = response.data;\n\n\t\t\tif (this.copyLink(url))\n\t\t\t{\n\t\t\t\tthis.onSuccessfulCopyingLink();\n\t\t\t}\n\n\t\t\tthis.#linkList?.getLinkListInfo();\n\t\t}\n\t}\n\n\tclearSelectedUsers()\n\t{\n\t\tif (this.#userSelectorControl)\n\t\t{\n\t\t\tthis.#userSelectorControl.clearSelectedUsers();\n\t\t}\n\t}\n\n\topenLinkList()\n\t{\n\t\tif (this.#layout.contentWrapper && this.#linkList)\n\t\t{\n\t\t\tDom.removeClass(this.#layout.contentWrapper, '--show');\n\t\t\tthis.#linkList.show(this.#layout.contentWrapper.offsetHeight);\n\t\t}\n\t}\n\n\tcloseLinkList()\n\t{\n\t\tif (this.#linkList)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#linkList.close();\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\tonLinkListClose()\n\t{\n\t\tif (this.#layout.contentWrapper)\n\t\t{\n\t\t\tDom.addClass(this.#layout.contentWrapper, '--show');\n\t\t}\n\t}\n\n\tcopyLink(linkUrl): boolean\n\t{\n\t\tif (!linkUrl)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = BX.clipboard.copy(linkUrl);\n\n\t\tif (result)\n\t\t{\n\t\t\tUtil.showNotification(Loc.getMessage('SHARING_COPY_LINK_NOTIFICATION'));\n\t\t\tEventEmitter.emit('CalendarSharing:LinkCopied');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync onOpenLink()\n\t{\n\t\tawait this.saveSharingRule();\n\t\twindow.open(this.sharingUrl, '_blank').focus();\n\t}\n\n\tonSuccessfulCopyingLink()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tgetSettingsNode(): HTMLElement\n\t{\n\t\tthis.#settingsControl = new Settings(this.#settings);\n\t\tthis.#settings.rule = this.#settingsControl.getRule();\n\n\t\treturn this.#settingsControl.render();\n\t}\n\n\tgetUserSelectorNode(): HTMLElement\n\t{\n\t\tif (this.#context === this.#crmContext)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#userSelectorControl = new UserSelector({\n\t\t\tuserInfo: this.userInfo,\n\t\t\tonMembersAdded: () => Analytics.sendMembersAdded(this.#context, this.#userSelectorControl.getPeopleCount()),\n\t\t});\n\n\t\treturn this.#userSelectorControl.render();\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetPopupContentBottom(): HTMLElement\n\t{\n\t\tif (!this.#layout.contentBottom)\n\t\t{\n\t\t\tthis.#layout.contentBottom = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-bottom\">\n\t\t\t\t\t${this.getPopupCopyLinkButton()}\n\t\t\t\t\t${this.getPopupLinkHistoryButton()}\n\t\t\t\t\t${this.getPopupWhatSeeUsersButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.contentBottom;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLElement}\n\t */\n\tgetPopupContentTop(): HTMLElement\n\t{\n\t\tif (!this.#layout.contentTop)\n\t\t{\n\t\t\tconst openHelpDesk = () => {\n\t\t\t\ttop.BX.Helper.show(`redirect=detail&code=${this.getHelpDeskCodeDependsOnContext()}`);\n\t\t\t};\n\n\t\t\tthis.#layout.contentTop = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__dialog-top\">\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-title\">\n\t\t\t\t\t\t<span>${Loc.getMessage('SHARING_BUTTON_TITLE')}</span>\n\t\t\t\t\t\t<span onclick=\"${openHelpDesk}\" class=\"calendar-sharing__dialog-title-help\" title=\"${Loc.getMessage('SHARING_INFO_POPUP_HOW_IT_WORK')}\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__dialog-info\">${`${this.getPhraseDependsOnContext('SHARING_INFO_POPUP_CONTENT_3')} `}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tconst infoNotify = this.#layout.contentTop.querySelector('[ data-role=\"calendar-sharing_popup-open-link\"]');\n\n\t\t\tif (infoNotify)\n\t\t\t{\n\t\t\t\tlet infoNotifyHint;\n\t\t\t\tlet timer;\n\t\t\t\tEvent.bind(infoNotify, 'mouseenter', () => {\n\t\t\t\t\ttimer = setTimeout(() => {\n\t\t\t\t\t\tif (!infoNotifyHint)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinfoNotifyHint = new Popup({\n\t\t\t\t\t\t\t\tbindElement: infoNotify,\n\t\t\t\t\t\t\t\tangle: {\n\t\t\t\t\t\t\t\t\toffset: infoNotify.offsetWidth / 2 + 16,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\twidth: 410,\n\t\t\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\t\t\tcontent: Loc.getMessage('SHARING_INFO_POPUP_SLOT_DESC'),\n\t\t\t\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinfoNotifyHint.show();\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tEvent.bind(infoNotify, 'mouseleave', () => {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\tif (infoNotifyHint)\n\t\t\t\t\t{\n\t\t\t\t\t\tinfoNotifyHint.close();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.contentTop;\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn this.getPopup().isShown();\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.bindElement)\n\t\t{\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn('BX.Calendar.Sharing: \"bindElement\" is not defined');\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#settingsControl?.sortRanges();\n\t\tthis.#settingsControl?.updateRanges();\n\t\tthis.#settingsControl?.renderRanges();\n\n\t\tthis.getPopup().show();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.getPopup().destroy();\n\t\tthis.getDialogQr().destroy();\n\t}\n\n\tgetPhraseDependsOnContext(code: string): string\n\t{\n\t\treturn Loc.getMessage(`${code}_${this.#context.toUpperCase()}`);\n\t}\n\n\tgetHelpDeskCodeDependsOnContext(): number\n\t{\n\t\tlet code;\n\t\tswitch (this.#context)\n\t\t{\n\t\t\tcase this.#calendarContext:\n\t\t\t{\n\t\t\t\tcode = this.HELP_DESK_CODE_CALENDAR;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase this.#crmContext:\n\t\t\t{\n\t\t\t\tcode = this.HELP_DESK_CODE_CRM;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\tcode = 0;\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tsaveSharingRule()\n\t{\n\t\tif (!this.#settingsControl.isDifferentFrom(this.#settings.rule))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst changes = this.#settingsControl.getChanges();\n\t\tAnalytics.sendRuleUpdated(this.#context, changes);\n\n\t\tconst newRule = this.#settingsControl.getRule();\n\t\tBX.ajax.runAction('calendar.api.sharingajax.saveLinkRule', {\n\t\t\tdata: {\n\t\t\t\tlinkHash: this.linkHash,\n\t\t\t\truleArray: newRule,\n\t\t\t},\n\t\t}).then(() => {\n\t\t\tthis.#settings.rule = newRule;\n\t\t\tEventEmitter.emit('CalendarSharing:RuleUpdated');\n\t\t}, (error) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\tgetSettingsControlRule(): any\n\t{\n\t\treturn this.#settingsControl?.getRule();\n\t}\n}\n","import { Dom, Event, Loc, Tag, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'ui.buttons';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { Util } from 'calendar.util';\nimport DialogNew from './dialog-new';\nimport 'ui.switcher';\nimport 'spotlight';\nimport { Guide } from 'ui.tour';\nimport { Counter } from 'ui.cnt';\n\nexport default class SharingButton\n{\n\tPAY_ATTENTION_TO_NEW_FEATURE_DELAY = 1000;\n\n\tPAY_ATTENTION_TO_NEW_FEATURE_FIRST = 'first-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_NEW = 'new-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_REMIND = 'remind-feature';\n\tPAY_ATTENTION_TO_NEW_FEATURE_JOINT = 'joint-sharing'\n\n\tPAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS = [this.PAY_ATTENTION_TO_NEW_FEATURE_FIRST];\n\tPAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS = [\n\t\tthis.PAY_ATTENTION_TO_NEW_FEATURE_NEW,\n\t\tthis.PAY_ATTENTION_TO_NEW_FEATURE_REMIND,\n\n\t];\n\n\tAVAILABLE_PAY_ATTENTION_TO_NEW_FEATURE_MODS = [\n\t\t...this.PAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS,\n\t\t...this.PAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS,\n\t];\n\n\tconstructor(options = {})\n\t{\n\t\tthis.wrap = options.wrap;\n\t\tthis.userInfo = options.userInfo || null;\n\t\tthis.sharingConfig = Util.getSharingConfig();\n\t\tthis.sharingUrl = this.sharingConfig?.url || null;\n\t\tthis.linkHash = this.sharingConfig?.hash || null;\n\t\tthis.sharingRule = this.sharingConfig?.rule || null;\n\t\tthis.payAttentionToNewFeatureMode = options.payAttentionToNewFeature;\n\t\tthis.sharingFeatureLimit = options.sharingFeatureLimit;\n\t\tthis.sharingSettingsCollapsed = options.sharingSettingsCollapsed;\n\t\tthis.sortJointLinksByFrequentUse = options.sortJointLinksByFrequentUse;\n\t}\n\n\tshow()\n\t{\n\t\tDom.addClass(this.wrap, 'calendar-sharing__btn-wrap');\n\t\tthis.button = new Button({\n\t\t\ttext: Loc.getMessage('SHARING_BUTTON_TITLE'),\n\t\t\tround: true,\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\ticon: this.sharingFeatureLimit ? ButtonIcon.LOCK : null,\n\t\t\tclassName: 'ui-btn-themes calendar-sharing__btn',\n\t\t\tonclick: (button, event) => {\n\t\t\t\tif (!this.switcher.getNode().contains(event.target))\n\t\t\t\t{\n\t\t\t\t\tthis.handleSharingButtonClick();\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tthis.button.renderTo(this.wrap);\n\t\tthis.renderSwitcher();\n\n\t\tif (this.payAttentionToNewFeatureMode === this.PAY_ATTENTION_TO_NEW_FEATURE_JOINT)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (BX.SidePanel.Instance.getTopSlider() === null)\n\t\t\t\t{\n\t\t\t\t\tthis.payAttentionToNewFeatureWithText();\n\t\t\t\t\tBX.ajax.runAction('calendar.api.sharingajax.disableOptionPayAttentionToNewSharingFeature');\n\t\t\t\t}\n\t\t\t}, this.PAY_ATTENTION_TO_NEW_FEATURE_DELAY);\n\t\t}\n\t}\n\n\thandleSharingButtonClick()\n\t{\n\t\tif (this.sharingFeatureLimit)\n\t\t{\n\t\t\ttop.BX.UI.InfoHelper.show('limit_office_calendar_free_slots');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isSharingEnabled())\n\t\t{\n\t\t\tthis.openDialog();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.switcher.toggle();\n\t\t}\n\t}\n\n\tgetSwitcherContainer()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__switcher\"></div>\n\t\t`;\n\t}\n\n\tgetSwitcherDivider()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__switcher_divider\"></div>\n\t\t`;\n\t}\n\n\trenderSwitcher()\n\t{\n\t\tDom.append(this.getSwitcherDivider(), this.wrap);\n\t\tthis.switcherWrap = Tag.render`<div class=\"calendar-sharing__switcher-wrap\"></div>`;\n\t\tDom.append(this.switcherWrap, this.wrap);\n\t\tEvent.bind(this.switcherWrap, 'click', this.handleSwitcherWrapClick.bind(this), { capture: true });\n\n\t\tthis.switcher = new BX.UI.Switcher({\n\t\t\tnode: this.getSwitcherContainer(),\n\t\t\tchecked: this.isSharingEnabled() && !this.sharingFeatureLimit,\n\t\t\tcolor: 'green',\n\t\t\tsize: 'small',\n\t\t\thandlers: {\n\t\t\t\ttoggled: () => this.handleSwitcherToggled(),\n\t\t\t},\n\t\t});\n\n\t\tthis.switcher.renderTo(this.switcherWrap);\n\t}\n\n\thandleSwitcherWrapClick(event)\n\t{\n\t\tif (this.switcher.isChecked())\n\t\t{\n\t\t\tthis.showWarningPopup();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\thandleSwitcherToggled()\n\t{\n\t\tif (this.sharingFeatureLimit && this.switcher.isChecked())\n\t\t{\n\t\t\ttop.BX.UI.InfoHelper.show('limit_office_calendar_free_slots');\n\t\t\tthis.switcher.toggle();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isToggledAfterErrorOccurred())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.switcher.isChecked())\n\t\t{\n\t\t\tthis.enableSharing();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableSharing();\n\t\t}\n\t}\n\n\tisToggledAfterErrorOccurred()\n\t{\n\t\treturn this.switcher.isChecked() === this.isSharingEnabled();\n\t}\n\n\tisSharingEnabled()\n\t{\n\t\treturn Type.isString(this.sharingUrl);\n\t}\n\n\tenableSharing()\n\t{\n\t\tconst action = 'calendar.api.sharingajax.enableUserSharing';\n\t\tconst event = 'Calendar.Sharing.copyLinkButton:onSharingEnabled';\n\n\t\tBX.ajax.runAction(action)\n\t\t\t.then((response) => {\n\t\t\t\tthis.sharingUrl = response.data.url;\n\t\t\t\tthis.linkHash = response.data.hash;\n\t\t\t\tthis.sharingRule = response.data.rule;\n\t\t\t\tthis.openDialog();\n\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tevent,\n\t\t\t\t\t{\n\t\t\t\t\t\tisChecked: this.switcher.isChecked(),\n\t\t\t\t\t\turl: response.data.url,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.switcher.toggle();\n\t\t\t})\n\t\t;\n\t}\n\n\topenDialog()\n\t{\n\t\tthis.pulsar?.close();\n\t\tDom.remove(this.counterNode);\n\n\t\tif (!this.newDialog)\n\t\t{\n\t\t\tthis.newDialog = new DialogNew({\n\t\t\t\tbindElement: this.button.getContainer(),\n\t\t\t\tsharingUrl: this.sharingUrl,\n\t\t\t\tlinkHash: this.linkHash,\n\t\t\t\tsharingRule: this.sharingRule,\n\t\t\t\tcontext: 'calendar',\n\t\t\t\tcalendarSettings: {\n\t\t\t\t\tweekHolidays: Util.config.week_holidays,\n\t\t\t\t\tweekStart: Util.config.week_start,\n\t\t\t\t\tworkTimeStart: Util.config.work_time_start,\n\t\t\t\t\tworkTimeEnd: Util.config.work_time_end,\n\t\t\t\t},\n\t\t\t\tuserInfo: this.userInfo,\n\t\t\t\tsettingsCollapsed: this.sharingSettingsCollapsed,\n\t\t\t\tsortJointLinksByFrequentUse: this.sortJointLinksByFrequentUse,\n\t\t\t});\n\t\t}\n\n\t\tif (!this.newDialog.isShown())\n\t\t{\n\t\t\tthis.newDialog.show();\n\t\t}\n\t}\n\n\tdisableSharing()\n\t{\n\t\tconst action = 'calendar.api.sharingajax.disableUserSharing';\n\t\tconst event = 'Calendar.Sharing.copyLinkButton:onSharingDisabled';\n\t\tthis.warningPopup.close();\n\n\t\tBX.ajax.runAction(action)\n\t\t\t.then(() => {\n\t\t\t\tthis.sharingUrl = null;\n\t\t\t\tif (this.newDialog)\n\t\t\t\t{\n\t\t\t\t\tthis.newDialog.destroy();\n\t\t\t\t\tthis.newDialog = null;\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(event, { isChecked: this.switcher.isChecked() });\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.switcher.toggle();\n\t\t\t})\n\t\t;\n\t}\n\n\tshowWarningPopup()\n\t{\n\t\tif (!this.warningPopup)\n\t\t{\n\t\t\tthis.warningPopup = new MessageBox({\n\t\t\t\ttitle: Loc.getMessage('SHARING_WARNING_POPUP_TITLE_1'),\n\t\t\t\tmessage: Loc.getMessage('SHARING_WARNING_POPUP_CONTENT_2'),\n\t\t\t\tbuttons: this.getWarningPopupButtons(),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tdraggable: false,\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\tminWidth: 365,\n\t\t\t\t\tmaxWidth: 385,\n\t\t\t\t\tminHeight: 180,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tthis.warningPopup.show();\n\t}\n\n\tgetWarningPopupButtons()\n\t{\n\t\treturn [this.getSubmitButton(), this.getCancelButton()];\n\t}\n\n\tgetSubmitButton()\n\t{\n\t\treturn new Button({\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tcolor: ButtonColor.DANGER,\n\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_SUBMIT_BUTTON_NEW_MSGVER_1'),\n\t\t\tevents: {\n\t\t\t\tclick: () => this.handleSubmitButtonClick(),\n\t\t\t},\n\t\t});\n\t}\n\n\tgetCancelButton()\n\t{\n\t\treturn new Button({\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\ttext: Loc.getMessage('SHARING_WARNING_POPUP_CANCEL_BUTTON'),\n\t\t\tevents: {\n\t\t\t\tclick: () => this.handleCancelButtonClick(),\n\t\t\t},\n\t\t});\n\t}\n\n\thandleSubmitButtonClick()\n\t{\n\t\tthis.switcher.toggle();\n\t\tthis.warningPopup.close();\n\t}\n\n\thandleCancelButtonClick()\n\t{\n\t\tthis.warningPopup.close();\n\t}\n\n\tpayAttentionToNewFeature(mode)\n\t{\n\t\tif (this.PAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS.includes(mode))\n\t\t{\n\t\t\tthis.payAttentionToNewFeatureWithoutText();\n\t\t}\n\n\t\tif (this.PAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS.includes(mode))\n\t\t{\n\t\t\tthis.payAttentionToNewFeatureWithText();\n\t\t}\n\t}\n\n\tpayAttentionToNewFeatureWithoutText()\n\t{\n\t\tthis.pulsar = this.getPulsar(this.wrap, false);\n\t\tthis.pulsar.show();\n\t\tEvent.bind(this.pulsar.container, 'click', () => {\n\t\t\tthis.handleSharingButtonClick();\n\t\t});\n\n\t\tthis.counterNode = (new Counter({\n\t\t\tvalue: 1,\n\t\t\tcolor: Counter.Color.DANGER,\n\t\t\tsize: Counter.Size.MEDIUM,\n\t\t\tanimation: false,\n\t\t})).getContainer();\n\t\tDom.addClass(this.counterNode, 'calendar-sharing__new-feature-counter');\n\t\tDom.append(this.counterNode, this.wrap);\n\t}\n\n\tpayAttentionToNewFeatureWithText()\n\t{\n\t\tconst title = Loc.getMessage('CALENDAR_PAY_ATTENTION_TO_NEW_FEATURE_JOINT_TITLE');\n\t\tconst text = Loc.getMessage('CALENDAR_PAY_ATTENTION_TO_NEW_FEATURE_JOINT_TEXT');\n\n\t\tconst guide = this.getGuide(title, text);\n\t\tconst pulsar = this.getPulsar(this.wrap);\n\n\t\tguide.showNextStep();\n\t\tguide.getPopup().setAngle({ offset: 210 });\n\n\t\tpulsar.show();\n\t}\n\n\tgetGuide(title, text)\n\t{\n\t\tconst guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.wrap,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttext,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\tconst guidePopup = guide.getPopup();\n\t\tDom.addClass(guidePopup.popupContainer, 'calendar-popup-ui-tour-animate');\n\t\tguidePopup.setWidth(400);\n\t\tDom.style(guidePopup.getContentContainer(), 'paddingRight', getComputedStyle(guidePopup.closeIcon).width);\n\n\t\treturn guide;\n\t}\n\n\tgetPulsar(target, hideOnHover = true)\n\t{\n\t\tconst pulsar = new BX.SpotLight({\n\t\t\ttargetElement: target,\n\t\t\ttargetVertex: 'middle-center',\n\t\t\tlightMode: true,\n\t\t});\n\t\tif (hideOnHover)\n\t\t{\n\t\t\tpulsar.bindEvents({\n\t\t\t\tonTargetEnter: () => pulsar.close(),\n\t\t\t});\n\t\t}\n\n\t\treturn pulsar;\n\t}\n}\n","import SharingButton from './controls/sharingbutton';\n\nexport default class Interface\n{\n\tconstructor(options)\n\t{\n\t\tthis.buttonWrap = options.buttonWrap;\n\t\tthis.userInfo = options.userInfo || null;\n\t\tthis.payAttentionToNewFeature = options.payAttentionToNewFeature ?? false;\n\t\tthis.sharingFeatureLimit = options.sharingFeatureLimit ?? false;\n\t\tthis.sharingSettingsCollapsed = options.sharingSettingsCollapsed ?? false;\n\t\tthis.sortJointLinksByFrequentUse = options.sortJointLinksByFrequentUse ?? false;\n\t}\n\n\tshowSharingButton()\n\t{\n\t\tthis.sharingButton = new SharingButton({\n\t\t\twrap: this.buttonWrap,\n\t\t\tuserInfo: this.userInfo,\n\t\t\tpayAttentionToNewFeature: this.payAttentionToNewFeature,\n\t\t\tsharingFeatureLimit: this.sharingFeatureLimit,\n\t\t\tsharingSettingsCollapsed: this.sharingSettingsCollapsed,\n\t\t\tsortJointLinksByFrequentUse: this.sortJointLinksByFrequentUse,\n\t\t});\n\t\tthis.sharingButton.show();\n\t}\n}\n"],"names":["DialogQr","constructor","options","QRCODE_SIZE","QRCODE_COLOR_LIGHT","QRCODE_COLOR_DARK","qr","context","sharingUrl","getPopup","Popup","className","width","padding","content","getContent","closeIcon","closeByEsc","autoHide","overlay","animation","getLoader","Loader","size","getNodeQr","Tag","render","show","showQr","initQrCode","QRCode","text","height","colorDark","colorLight","correctLevel","CorrectLevel","H","hide","Runtime","loadExtension","getPhraseDependsOnContext","Loc","getMessage","isShown","close","destroy","code","toUpperCase","Weekday","wrap","name","index","active","onSelected","Type","isFunction","onDiscarded","onMouseDown","canBeDiscarded","e","handleMouseDown","event","discard","select","Dom","addClass","removeClass","Range","layout","weekdaysSelect","startSelect","endSelect","readOnly","weekStart","workDays","getSlotSize","rule","from","to","weekdays","getSortedWeekdays","ruleUpdated","addRange","removeRange","showReadOnlyPopup","deletable","getRule","settingPopupShown","weekdaysPopupShown","hasClass","startPopupShown","fromTimeSelect","endPopupShown","toTimeSelect","getWrap","disableAnimation","renderWeekdaysSelect","renderTimeFromSelect","renderTimeToSelect","renderButton","setTimeout","button","getButton","update","maxFrom","innerHTML","formatAmPmSpan","formatMinutes","updateTo","minToMinutes","setDeletable","isDeletable","replaceWith","Event","bind","onDeleteButtonClickHandler","onAddButtonClickHandler","remove","hideButton","showButton","weekdaysLoc","Util","getWeekdaysLoc","map","loc","includes","push","splice","formatWeekdays","getWeekdaysTitle","onWeekdaysSelectClickHandler","weekdayLoc","createWeekday","weekdaysMenu","id","Date","now","bindElement","weekday","angle","position","offset","autoHideHandler","canBeClosed","events","onPopupShow","onPopupClose","title","innerText","indexOf","length","onWeekdayMouseDown","currentWeekday","startX","clientX","controllableWeekdays","collectIntersectedWeekdays","right","getBoundingClientRect","left","intersected","onMouseMove","forEach","controllableWeekday","document","unbind","fromFormatted","renderTimeSelect","isSelected","minutes","onItemSelected","getMaxMinutes","toFormatted","getMinMinutes","time","callbacks","dataId","timeSelect","onTimeSelectClickHandler","showTimeMenu","timeStamps","hour","label","formatTime","timeMenu","items","timeStamp","html","onclick","MenuManager","create","onShow","onClose","maxHeight","minWidth","offsetWidth","timezonesPopup","getPopupWindow","popupContent","getContentContainer","selectedTimezoneItem","querySelector","scrollTop","offsetTop","offsetHeight","toLowerCase","replace","date","parseDate","getTime","sort","toString","singleDay","w","reduce","a","b","Settings","AVAILABLE_INTERVALS","MAX_RANGES","collapsed","isBoolean","notExpandable","workTimeStart","workTimeEnd","slotSize","ranges","rangeOptions","getRange","isArrayFilled","sortRanges","updateRanges","range","compareRanges","JSON","parse","stringify","range1","range2","weekdaysWeight1","getWeekdaysWeight","weekdaysWeight2","accumulator","rangesWithPopup","filter","rangePopupShown","slotSizePopupShown","slotSizeSelect","readOnlyPopupShown","readOnlyPopup","readOnlyClass","expandedClass","renderHeader","renderRule","renderSubtitle","renderExpandRuleButton","subtitle","getSubtitleText","updateSubtitle","isDefaultRule","expandRuleArrow","expandRuleButton","toggle","renderRanges","getSettingsSlotSizeSelect","updateRuleHeight","toggleClass","updateSharingSettingsCollapsedAction","isCollapsed","BX","ajax","runAction","data","rangesContainer","isDomNode","toDateString","isNotFirst","getMinutesFromDate","node","afterRange","newRange","after","deletedRange","slotSizeText","formatDuration","slotSizeSelectClickHandler","slotSizeMenu","slice","lastRange","removeRuleHeight","style","calculateRuleHeight","topMarginHeight","bottomMarginHeight","marginsHeight","slotSizeHeight","rangeHeight","pivotNode","closeReadOnlyPopup","getReadOnlyPopup","offsetLeft","darkMode","popupContainer","clearTimeout","closePopupTimeout","parsedTime","parseTime","DateTimeFormat","format","getFormat","h","m","isDifferentFrom","getDefaultRule","anotherRule","objectsEqual","getChanges","defaultRule","sizeChanged","daysChanged","changes","Analytics","ruleChanges","custom_days","custom_length","obj1","obj2","sortKeys","object","Object","keys","obj","key","HintInfo","props","bindOptions","borderRadius","wrapper","UserSelector","userInfo","onMembersAdded","openEntitySelector","renderTitle","renderUserSelectorWrapper","infoNotify","hintInfo","timer","userSelectorWrapper","renderUserSelector","userSelector","entityNode","getDefaultEntityNode","renderUserEntity","getEntityKey","entity","hasAvatar","avatar","Text","encode","preselectedItem","Dialog","targetNode","preselectedItems","enableSearch","zIndex","onUserSelectorSelect","onUserSelectorDeselect","hasChanges","entities","intranetUsersOnly","emailUsers","inviteEmployeeLink","inviteGuestLink","analyticsSource","filters","isUserSelectorDialogOpened","isOpen","item","customData","get","trim","append","clearSelectedUsers","clean","getPeopleCount","getSelectedUserIdList","result","values","MAX_AVATAR_COUNT","ListItem","openAvatarList","onCopyButtonClick","onDeleteButtonClick","renderAvatarContainer","renderDate","renderCopyButton","renderDeleteButton","avatarContainer","showMoreIcon","members","moreCounter","renderAvatar","member","renderMore","user","lastName","counter","uid","util","getRandomString","getAvatarPopupItems","maxWidth","subscribe","setPopupState","menuContainer","getMenuContainer","timeout","closeAvatarList","getAvatarPopupItem","userPath","pathToUser","dateCreate","formattedDate","formatDate","copyButton","icon","Icon","Main","LINK_3","EventEmitter","emit","shortUrl","hash","deleteButton","Actions","CROSS_30","MessageBox","message","buttons","getDeletePopupButtons","popupOptions","draggable","minHeight","Button","ButtonSize","MEDIUM","color","ButtonColor","DANGER","click","deleteLink","LIGHT_BORDER","state","setListItemPopupState","DEFAULT_LIST_HEIGHT","LIST_PADDING_SUM","List","sortJointLinksByFrequentUse","getLinkListInfo","eventSubscribe","onJointLinkCopy","onJointLinkDelete","then","response","userLinks","updateLinkList","isListEmpty","hideSortingButton","showSortingButton","getTitleNode","getListNode","getChevronBackIcon","getSortingButton","backButton","CHEVRON_LEFT","sortingButton","SORT","getSortingButtonText","changeListSort","sortingButtonText","list","getListItemsNode","getEmptyStateNode","linkListItems","getListItems","listItem","emptyState","getSortedByFrequentUseListItems","getSortedByDateListItems","frequentUse","maxListHeight","onLinkListClose","listItems","sortByFrequentUse","sortName","adjust","isOpenListItemPopup","isNil","isArray","isObject","DialogNew","HELP_DESK_CODE_CALENDAR","HELP_DESK_CODE_CRM","contentWrapper","contentTop","contentBody","contentBottom","listWrapper","buttonCopy","buttonHistory","buttonWhatSeeUsers","weekHolidays","Set","calendarSettings","day","getIndByWeekDay","sharingRule","has","settingsCollapsed","linkHash","copyLink","onSuccessfulCopyingLink","sendLinkCopiedList","peopleCount","bindEvents","window","saveSharingRule","getPopupWrapper","sendPopupOpened","closeLinkList","isClickInside","contains","target","isQrDialogShown","isSettingsPopupShown","isListItemPopupOpened","checkTopSlider","getBX","SidePanel","Instance","getTopSlider","getDialogQr","getPopupContentMain","getPopupContentList","getPopupContentTop","onOpenLink","getSettingsNode","getUserSelectorNode","getPopupContentBottom","getPopupCopyLinkButton","getPopupLinkHistoryButton","openLinkList","getPopupWhatSeeUsersButton","adjustClick","params","sendLinkCopied","linkTypes","multiple","saveJointLink","solo","memberIds","url","linkUrl","clipboard","copy","showNotification","open","focus","sendMembersAdded","openHelpDesk","top","Helper","getHelpDeskCodeDependsOnContext","infoNotifyHint","console","warn","sendRuleUpdated","newRule","ruleArray","error","getSettingsControlRule","SharingButton","PAY_ATTENTION_TO_NEW_FEATURE_DELAY","PAY_ATTENTION_TO_NEW_FEATURE_FIRST","PAY_ATTENTION_TO_NEW_FEATURE_NEW","PAY_ATTENTION_TO_NEW_FEATURE_REMIND","PAY_ATTENTION_TO_NEW_FEATURE_JOINT","PAY_ATTENTION_TO_NEW_FEATURE_WITHOUT_TEXT_MODS","PAY_ATTENTION_TO_NEW_FEATURE_WITH_TEXT_MODS","AVAILABLE_PAY_ATTENTION_TO_NEW_FEATURE_MODS","sharingConfig","getSharingConfig","payAttentionToNewFeatureMode","payAttentionToNewFeature","sharingFeatureLimit","sharingSettingsCollapsed","round","EXTRA_SMALL","ButtonIcon","LOCK","switcher","getNode","handleSharingButtonClick","renderTo","renderSwitcher","payAttentionToNewFeatureWithText","UI","InfoHelper","isSharingEnabled","openDialog","getSwitcherContainer","getSwitcherDivider","switcherWrap","handleSwitcherWrapClick","capture","Switcher","checked","handlers","toggled","handleSwitcherToggled","isChecked","showWarningPopup","stopPropagation","isToggledAfterErrorOccurred","enableSharing","disableSharing","isString","action","catch","pulsar","counterNode","newDialog","getContainer","config","week_holidays","week_start","work_time_start","work_time_end","warningPopup","getWarningPopupButtons","getSubmitButton","getCancelButton","handleSubmitButtonClick","handleCancelButtonClick","mode","payAttentionToNewFeatureWithoutText","getPulsar","container","Counter","value","Color","Size","guide","getGuide","showNextStep","setAngle","Guide","simpleMode","onEvents","steps","condition","bottom","guidePopup","setWidth","getComputedStyle","hideOnHover","SpotLight","targetElement","targetVertex","lightMode","onTargetEnter","Interface","buttonWrap","showSharingButton","sharingButton"],"mappings":"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"}