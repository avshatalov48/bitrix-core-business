this.BX=this.BX||{};(function(e,t,i,a){"use strict";var r,s,n;function l(e,t){o(e,t);t.add(e)}function o(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function c(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var u=new WeakSet;var h=new WeakSet;var d=new WeakSet;var p=new WeakSet;var b=new WeakSet;var f=new WeakSet;var m=function(e){babelHelpers.inherits(i,e);function i(e){var a;babelHelpers.classCallCheck(this,i);a=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(i).call(this));l(babelHelpers.assertThisInitialized(a),f);l(babelHelpers.assertThisInitialized(a),b);l(babelHelpers.assertThisInitialized(a),p);l(babelHelpers.assertThisInitialized(a),d);l(babelHelpers.assertThisInitialized(a),h);l(babelHelpers.assertThisInitialized(a),u);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"targetNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"tabs",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"template",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"activityName","");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"maxWidth",300);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"maxHeight",500);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"minWidth",100);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"minHeight",60);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"objectName","mixed_selector[object]");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"fieldName","mixed_selector[field]");babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"checkActivityChildren",true);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"activityFilter",[]);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"exceptErrorMessages",false);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"map",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuItems",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuTargetNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"menuId",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"objectInputNode",null);babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"fieldInputNode",null);a.setEventNamespace("BX.Bizproc.MixedSelector.BpMixedSelector");var r=t.Type.isPlainObject(e)?e:{};a.setTargetNode(r.targetNode);a.setObjectTabs(r.objectTabs);a.setTemplate(r.template);a.setActivityName(r.activityName);a.setSize(r.size);a.setInputNames(r.inputNames);a.setTargetTitle(r.targetTitle);a.setCheckActivityChildren(r.checkActivityChildren);a.setActivityFilter(r.activityFilter);a.setExceptErrorMessages(r.exceptErrorMessages);return a}babelHelpers.createClass(i,[{key:"setTargetNode",value:function e(i){if(t.Type.isDomNode(i)){this.targetNode=i}}},{key:"getTargetNode",value:function e(){return this.targetNode}},{key:"setObjectTabs",value:function e(i){if(t.Type.isPlainObject(i)){this.tabs=i}}},{key:"getObjectTabs",value:function e(){return this.tabs}},{key:"setTemplate",value:function e(i){if(t.Type.isArrayFilled(i)){this.template=i}}},{key:"getTemplate",value:function e(){return this.template}},{key:"setActivityName",value:function e(i){if(t.Type.isStringFilled(i)){this.activityName=i}}},{key:"getActivityName",value:function e(){return this.activityName}},{key:"setSize",value:function e(i){if(!t.Type.isPlainObject(i)){return}if(t.Type.isNumber(i.maxWidth)){this.maxWidth=i.maxWidth}if(t.Type.isNumber(i.minWidth)){this.minWidth=i.minWidth}if(t.Type.isNumber(i.maxHeight)){this.maxHeight=i.maxHeight}if(t.Type.isNumber(i.minHeight)){this.minHeight=i.minHeight}}},{key:"getSize",value:function e(){return{maxWidth:this.maxWidth,minWidth:this.minWidth,maxHeight:this.maxHeight,minHeight:this.minHeight}}},{key:"setInputNames",value:function e(i){if(!t.Type.isPlainObject(i)){return}if(t.Type.isStringFilled(i.object)){this.objectName=i.object}if(t.Type.isStringFilled(i.field)){this.fieldName=i.field}}},{key:"getInputNames",value:function e(){return{object:this.objectName,field:this.fieldName}}},{key:"setTargetTitle",value:function e(i){if(t.Type.isStringFilled(i)){this.targetTitle=i;return}this.targetTitle=t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_CHOOSE_TARGET")}},{key:"getTargetTitle",value:function e(){return this.targetTitle}},{key:"setCheckActivityChildren",value:function e(i){if(t.Type.isBoolean(i)){this.checkActivityChildren=i}}},{key:"getCheckActivityChildren",value:function e(){return this.checkActivityChildren}},{key:"setActivityFilter",value:function e(i){if(t.Type.isArray(i)){this.activityFilter=i}}},{key:"getActivityFilter",value:function e(){return this.activityFilter}},{key:"setExceptErrorMessages",value:function e(i){if(t.Type.isBoolean(i)){this.exceptErrorMessages=i}}},{key:"getExceptErrorMessages",value:function e(){return this.exceptErrorMessages}},{key:"getMenu",value:function e(){var i=this;if(this.menuId){return a.MenuManager.getMenuById(this.menuId)}this.menuId=BX.util.getRandomString();var r=this.getSize();return a.MenuManager.create(i.menuId,i.getMenuTargetNode(),i.getMenuItems(),{zIndex:200,autoHide:true,offsetLeft:t.Dom.getPosition(i.getMenuTargetNode()).width/2,angle:{position:"top",offset:0},maxWidth:r.maxWidth,maxHeight:r.maxHeight,minWidth:r.minWidth,minHeight:r.minHeight})}},{key:"getMenuTargetNode",value:function e(){return this.menuTargetNode}},{key:"getMenuItems",value:function e(){if(this.menuItems){return this.menuItems}this.menuItems=[];c(this,u,v).call(this);return this.menuItems}},{key:"getMenuItemsByTabName",value:function e(t){var i=this.getMenuItems();for(var a in i){if(i[a].tabName===t){return i[a].items}}return[]}},{key:"renderMixedSelector",value:function e(){var i=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<a href="#">',"</a>"])),BX.util.htmlspecialchars(this.getTargetTitle()));this.menuTargetNode=i;t.Event.bind(i,"click",c(this,f,I).bind(this));var a=t.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="hidden" \n\t\t\t\tname="','" \n\t\t\t\tdata-role="mixed-selector-object"\n\t\t\t\tvalue=""\n\t\t\t>\n\t\t'])),this.objectName);this.objectInputNode=a;var l=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<input \n\t\t\t\ttype="hidden" \n\t\t\t\tname="','" \n\t\t\t\tdata-role="mixed-selector-field"\n\t\t\t\tvalue=""\n\t\t\t>\n\t\t'])),this.fieldName);this.fieldInputNode=l;t.Dom.append(i,this.targetNode);t.Dom.append(a,this.targetNode);t.Dom.append(l,this.targetNode)}},{key:"getSelectedObjectValue",value:function e(){if(this.objectInputNode){return this.objectInputNode.value}return null}},{key:"getSelectedFieldValue",value:function e(){if(this.fieldInputNode){return this.fieldInputNode.value}return null}},{key:"setSelectedObjectAndField",value:function e(a,r,s){var n=this.getMenuTargetNode();var l=i.getAvailableTabsLocMessages();if(i.getAvailableTabsName().includes(a)){n.innerText="".concat(l[a],": ").concat(s)}else{n.innerText="".concat(l.Activity,": ").concat(s)}if(t.Type.isStringFilled(a)&&t.Type.isStringFilled(r)){this.objectInputNode.value=a;this.fieldInputNode.value=r}}}],[{key:"getAvailableTabsName",value:function e(){return["Parameter","Variable","Constant","GlobalConst","GlobalVar","Document","Activity"]}},{key:"getAvailableTabsLocMessages",value:function e(){return{Parameter:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_PARAMETER"),Variable:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_VARIABLE"),Constant:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_CONSTANT"),GlobalConst:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_CONSTANT"),GlobalVar:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_GLOBAL_VARIABLE"),Document:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_DOCUMENT_FIELDS"),Activity:t.Loc.getMessage("BIZPROC_MIXED_SELECTOR_EXT_ADDITIONAL_RESULT")}}}]);return i}(i.EventEmitter);function v(){var e=this;var i=this;var a=c(this,h,g).call(this);var r=m.getAvailableTabsLocMessages();var s=BX.util.object_keys(a);var n=function n(){if(s[l]==="Activity"){var o=c(e,p,T).call(e,e.template,a[s[l]]);var u=[];o.forEach((function(a){if(!t.Type.isArrayFilled(a)){return}var r=[];a.forEach((function(a){if(!t.Type.isStringFilled(a.description)){return}if((a.field!=="ErrorMessage"||e.getExceptErrorMessages()===false)&&(e.getActivityFilter().length===0||e.getActivityFilter().includes(a.activity))){r.push({text:t.Text.encode("".concat(a.text," (").concat(a.description,")")),object:a.object,field:a.field,property:a,onclick:c(i,b,N).bind(i)})}}));if(t.Type.isArrayFilled(r)){u.push({text:a[0].description,object:a[0].object,items:r})}}));if(t.Type.isArrayFilled(u)){e.menuItems.push({text:r[s[l]],items:u,tabName:"Activity"})}}else{e.menuItems.push({text:r[s[l]],items:c(e,d,y).call(e,a[s[l]],s[l]),tabName:s[l]})}};for(var l in s){n()}}function g(){if(this.map){return this.map}this.map={};var e=m.getAvailableTabsName();var t=Object.keys(this.tabs);for(var i in t){if(e.includes(t[i])&&Object.keys(this.tabs[t[i]]).length>0){this.map[t[i]]=this.tabs[t[i]]}}if(this.template.length<0&&this.map.Activity){delete this.map.Activity}return this.map}function y(e,t){var i=[];var a=Object.keys(e);for(var r in a){i.push({text:BX.util.htmlspecialchars(e[a[r]].Name),object:t,field:a[r],property:e[a[r]],onclick:c(this,b,N).bind(this)})}return i}function T(e,i){var a=this;var r=[];var s=function s(n){var l;if(e[n].Name===a.activityName&&!a.checkActivityChildren){return"continue"}var o=e[n].Type.toLowerCase();var u=(l=i[o])!==null&&l!==void 0?l:{};var h=u.RETURN;var d=u.ADDITIONAL_RESULT;if(h){var b=Object.keys(h);var f=[];for(var m in b){f.push({text:h[b[m]].NAME,description:e[n].Properties.Title||u.NAME,activity:o,value:"{=".concat(e[n].Name,":").concat(b[m],"}"),object:e[n].Name,field:b[m],property:{Name:h[b[m]].NAME,Type:h[b[m]].TYPE}})}if(f.length>0){r.push(f)}}else if(t.Type.isArray(d)){var v=e[n].Properties;d.forEach((function(t){if(v[t]){var i=Object.keys(v[t]);var a=[];for(var s in i){var l=v[t][i[s]];a.push({text:l.Name,description:v.Title||u.NAME,value:"{=".concat(e[n].Name,":").concat(i[s],"}"),object:e[n].Name,field:i[s],property:l})}if(a.length>0){r.push(a)}}}))}if(e[n].Children&&e[n].Children.length>0){var g=c(a,p,T).call(a,e[n].Children,i);r=r.concat(g)}};for(var n=0,l=e.length;n<l;++n){var o=s(n);if(o==="continue")continue}return r}function N(e,t){var a=this.getMenu();a.close();this.setSelectedObjectAndField(t.object,t.field,t.text);i.EventEmitter.emit(this,"onSelect",{item:t})}function I(e){var t=this.getMenu();t.show();e.preventDefault()}var E={BpMixedSelector:m};e.MixedSelector=E;e.BpMixedSelector=m})(this.BX.Bizproc=this.BX.Bizproc||{},BX,BX.Event,BX.Main);
//# sourceMappingURL=mixed-selector.bundle.map.js