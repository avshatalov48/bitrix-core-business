{"version":3,"file":"reactions.bundle.js","sources":["../src/reactions.js"],"sourcesContent":["/**\n * Bitrix UI\n * Reaction picker Vue component\n *\n * @package bitrix\n * @subpackage ui\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.fonts.opensans';\nimport './reactions.css';\nimport './icons.css';\n\nimport {BitrixVue} from 'ui.vue3';\nimport {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\nimport {ReactionsSelect, reactionType, reactionCssClass} from 'ui.reactions-select';\nimport {Lottie} from 'ui.lottie';\n\nconst ReactionTypeNone = 'none';\nconst ReactionOrder = Object.keys(reactionType);\n\nconst ReactionIconClass = {...reactionCssClass, none: 'ui-vue-reactions-icon-none'};\n\nexport const Reactions = BitrixVue.mutableComponent('bx-reactions',\n{\n\tprops: {\n\t\tname: {default: ''},\n\t\tvalues: {default: {}},\n\t\tcurrentUserId: {default: 0},\n\t\tcanOpenList: {default: true},\n\t},\n\tdata: () => ({\n\t\tlocalValues: {},\n\t\tuserReaction: ReactionTypeNone,\n\t\tbuttonAnimate: false,\n\t}),\n\temits: ['list', 'set'],\n\tmounted()\n\t{\n\t\tthis.userReactionAnimation = null;\n\t\tthis.selectorPopup = null;\n\t\tthis.selectorPopupHideTimeout = null;\n\t\tthis.selectorPopupShowTimeout = null;\n\n\t\tthis.localValues = {...this.values};\n\n\t\tif (Type.isStringFilled(this.name))\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.subscribe(`ui:reaction:press:${this.name}`, this.onPress);\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (this.selectorPopup)\n\t\t{\n\t\t\tthis.selectorPopup.hide();\n\t\t\tthis.selectorPopup = null;\n\t\t}\n\t\tif (this.userReactionAnimation)\n\t\t{\n\t\t\tthis.userReactionAnimation.destroy();\n\t\t}\n\t\tclearTimeout(this.selectorPopupHideTimeout);\n\t\tthis.selectorPopupHideTimeout = null;\n\t\tclearTimeout(this.selectorPopupShowTimeout);\n\t\tthis.selectorPopupShowTimeout = null;\n\n\t\tif (Type.isStringFilled(this.name))\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.unsubscribe(`ui:reaction:press:${this.name}`, this.onPress);\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tvalues: {\n\t\t\thandler(values) {\n\t\t\t\tthis.localValues = {...values};\n\t\t\t},\n\t\t\tdeep: true\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tlist(): Boolean\n\t\t{\n\t\t\tif (!this.canOpenList)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$emit('list', {values: this.localValues});\n\n\t\t\treturn true;\n\t\t},\n\n\t\tset(reaction)\n\t\t{\n\t\t\tif (!ReactionOrder.includes(reaction))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.localValues[this.userReaction])\n\t\t\t{\n\t\t\t\tthis.localValues[this.userReaction] = this.localValues[this.userReaction]\n\t\t\t\t\t.filter(element => element !== this.currentUserId)\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tif (!this.localValues[reaction])\n\t\t\t{\n\t\t\t\tthis.localValues = {...this.localValues, [reaction]: []};\n\t\t\t}\n\n\t\t\tthis.localValues[reaction].push(this.currentUserId);\n\n\t\t\tthis.buttonAnimate = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.buttonAnimate = false;\n\t\t\t}, 400);\n\n\t\t\tthis.$emit('set', {action: 'set', type: reaction});\n\n\t\t\tthis.animateReactionButton(reaction);\n\n\t\t\tthis.hideEmotionSelector(0);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tunset()\n\t\t{\n\t\t\tif (this.userReaction === ReactionTypeNone)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.localValues[this.userReaction])\n\t\t\t{\n\t\t\t\tthis.localValues[this.userReaction] = this.localValues[this.userReaction]\n\t\t\t\t\t.filter(element => element !== this.currentUserId)\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tthis.$emit('set', {action: 'remove', type: this.userReaction});\n\n\t\t\tthis.animateReactionButton(ReactionTypeNone);\n\n\t\t\tthis.hideEmotionSelector(0);\n\n\t\t\treturn true;\n\t\t},\n\n\t\tpress(reaction = reactionType.like)\n\t\t{\n\t\t\tif (this.userReaction === ReactionTypeNone)\n\t\t\t{\n\t\t\t\treturn this.set(reaction);\n\t\t\t}\n\n\t\t\tthis.unset();\n\t\t},\n\n\t\tshowEmotionSelector(event)\n\t\t{\n\t\t\tif (this.selectorPopup)\n\t\t\t{\n\t\t\t\tclearTimeout(this.selectorPopupHideTimeout);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst popupName = this.name ?? Date.now();\n\n\t\t\tthis.selectorPopup = new ReactionsSelect({\n\t\t\t\tname: popupName,\n\t\t\t\tposition: event.target\n\t\t\t})\n\t\t\t.subscribe('select', (selectEvent) => {\n\t\t\t\tconst {reaction} = selectEvent.getData();\n\t\t\t\tthis.set(reaction);\n\t\t\t\tthis.selectorPopup?.hide();\n\t\t\t})\n\t\t\t.subscribe('mouseleave', () => {\n\t\t\t\tthis.hideEmotionSelector(500);\n\t\t\t})\n\t\t\t.subscribe('mouseenter', () => {\n\t\t\t\tclearTimeout(this.selectorPopupHideTimeout);\n\t\t\t})\n\t\t\t.subscribe('hide', () => {\n\t\t\t\tclearTimeout(this.selectorPopupHideTimeout);\n\t\t\t\tthis.selectorPopup = null;\n\t\t\t});\n\n\t\t\tclearTimeout(this.selectorPopupShowTimeout);\n\t\t\tthis.selectorPopupShowTimeout = setTimeout(() => this.selectorPopup?.show(), 1000);\n\t\t},\n\n\t\thideEmotionSelector(timeout = 1000)\n\t\t{\n\t\t\tclearTimeout(this.selectorPopupShowTimeout);\n\t\t\tclearTimeout(this.selectorPopupHideTimeout);\n\n\t\t\tif (!timeout)\n\t\t\t{\n\t\t\t\tthis.selectorPopup?.hide();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis.selectorPopupHideTimeout = setTimeout(() => {\n\t\t\t\tthis.selectorPopup?.hide();\n\t\t\t}, timeout);\n\t\t},\n\n\t\tonPress(event: BaseEvent): void\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tif (!data.reaction)\n\t\t\t{\n\t\t\t\tdata.reaction = reactionType.like\n\t\t\t}\n\n\t\t\tthis.press(data.reaction);\n\t\t},\n\n\t\tanimateReactionButton(reaction)\n\t\t{\n\t\t\tif (this.currentUserId <= 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.userReactionAnimation)\n\t\t\t{\n\t\t\t\tthis.userReactionAnimation.destroy();\n\t\t\t}\n\n\t\t\tif (reaction === ReactionTypeNone)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.userReactionAnimation = Lottie.loadAnimation({\n\t\t\t\tanimationData: ReactionsSelect.getLottieAnimation(reaction),\n\t\t\t\tcontainer: this.$refs['reactions-button-icon'],\n\t\t\t\tloop: false,\n\t\t\t\tautoplay: false,\n\t\t\t\trenderer: 'svg',\n\t\t\t\trendererSettings: {\n\t\t\t\t\tviewBoxOnly: true,\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.userReactionAnimation.addEventListener('complete', () => {\n\t\t\t\tthis.userReactionAnimation.destroy();\n\t\t\t});\n\t\t\tthis.userReactionAnimation.addEventListener('destroy', () => {\n\t\t\t\tthis.userReactionAnimation = null;\n\t\t\t});\n\t\t\tthis.userReactionAnimation.play();\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\ttypes(): Array\n\t\t{\n\t\t\tthis.userReaction = ReactionTypeNone;\n\n\t\t\treturn ReactionOrder.filter(type =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!Type.isArray(this.localValues[type])\n\t\t\t\t\t|| this.localValues[type].length <= 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tthis.currentUserId > 0\n\t\t\t\t\t&& this.userReaction === ReactionTypeNone\n\t\t\t\t\t&& this.localValues[type].includes(this.currentUserId)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis.userReaction = type;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}).map(type => {\n\t\t\t\treturn {type, count: this.localValues[type].length};\n\t\t\t});\n\t\t},\n\n\t\tcounter(): Number\n\t\t{\n\t\t\treturn this.types.map(element => element.count).reduce((result, value) => result + value, 0);\n\t\t},\n\n\t\tisTypesShowed(): Boolean\n\t\t{\n\t\t\tif (this.counter <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn !(\n\t\t\t\tthis.userReaction !== ReactionTypeNone\n\t\t\t\t&& this.counter === 1\n\t\t\t);\n\t\t},\n\n\t\tisMobile(): Boolean\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\treturn (\n\t\t\t\tUA.includes('android')\n\t\t\t\t|| UA.includes('iphone')\n\t\t\t\t|| UA.includes('ipad')\n\t\t\t\t|| UA.includes('bitrixmobile')\n\t\t\t);\n\t\t},\n\n\t\tReactionIconClass: () => ReactionIconClass,\n\t},\n\ttemplate: `\n\t\t<div :class=\"['ui-vue-reactions', {'ui-vue-reactions-mobile': isMobile}]\">\n\t\t\t<transition name=\"ui-vue-reactions-result-animation\">\n\t\t\t\t<div v-if=\"isTypesShowed\" :class=\"['ui-vue-reactions-result', {'ui-vue-reactions-result-active': canOpenList}]\" @click=\"list\">\n\t\t\t\t\t<transition-group tag=\"div\" class=\"ui-vue-reactions-result-types\" name=\"ui-vue-reactions-result-type-animation\" >\n\t\t\t\t\t\t<span v-for=\"element in types\" :class=\"['ui-vue-reactions-result-type', ReactionIconClass[element.type]]\" :key=\"element.type\"></span>\n\t\t\t\t\t</transition-group>\t\n\t\t\t\t\t<div class=\"ui-vue-reactions-result-counter\">{{counter}}</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if=\"currentUserId > 0\"  class=\"ui-vue-reactions-button\" @click.prevent=\"press()\" @mouseenter=\"showEmotionSelector\" @mouseleave=\"hideEmotionSelector()\">\n\t\t\t\t<div class=\"ui-vue-reactions-button-container\">\n\t\t\t\t\t<div :class=\"['ui-vue-reactions-button-icon', ReactionIconClass[userReaction], {'ui-vue-reactions-button-pressed': buttonAnimate}]\" ref=\"reactions-button-icon\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n"],"names":["ReactionTypeNone","ReactionOrder","Object","keys","reactionType","ReactionIconClass","reactionCssClass","none","Reactions","BitrixVue","mutableComponent","props","name","default","values","currentUserId","canOpenList","data","localValues","userReaction","buttonAnimate","emits","mounted","userReactionAnimation","selectorPopup","selectorPopupHideTimeout","selectorPopupShowTimeout","Type","isStringFilled","$Bitrix","eventEmitter","subscribe","onPress","beforeUnmount","hide","destroy","clearTimeout","unsubscribe","watch","handler","deep","methods","list","$emit","set","reaction","includes","filter","element","push","setTimeout","action","type","animateReactionButton","hideEmotionSelector","unset","press","like","showEmotionSelector","event","popupName","Date","now","ReactionsSelect","position","target","selectEvent","getData","show","timeout","Lottie","loadAnimation","animationData","getLottieAnimation","container","$refs","loop","autoplay","renderer","rendererSettings","viewBoxOnly","addEventListener","play","computed","types","isArray","length","map","count","counter","reduce","result","value","isTypesShowed","isMobile","UA","navigator","userAgent","toLowerCase","template"],"mappings":"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"}