{"version":3,"file":"sourcefield.bundle.js","sources":["../src/internal/filter-stub.js","../src/internal/prepare-sources.js","../src/internal/prepare-value.js","../src/sourcefield.js"],"sourcesContent":["import {Loc} from 'landing.loc';\n\nexport default function getFilterStub(text = ''): {key: string, name: string, value: any}\n{\n\tlet name = text;\n\tif (name === '')\n\t{\n\t\tname = Loc.getMessage('LANDING_BLOCK__SOURCE_FILTER_STUB');\n\t}\n\n\treturn {\n\t\tkey: 'filterStub',\n\t\tname,\n\t\tvalue: '',\n\t};\n}","import {Type, Runtime} from 'main.core';\nimport getFilterStub from './filter-stub';\n\nexport type SourceItem = {\n\tname: string,\n\tvalue: string,\n\tfilter?: Array<{key: string, name: string, value: any}>,\n\tsort?: {\n\t\titems: Array<{name: string, value: string}>,\n\t},\n\turl?: string,\n\tsettings?: {\n\t\tdetailPage?: boolean,\n\t},\n};\n\nexport default function prepareSources(sources: Array<SourceItem>, stubText = '')\n{\n\tif (Type.isArray(sources))\n\t{\n\t\treturn sources.reduce((acc, item) => {\n\t\t\tif (\n\t\t\t\tType.isPlainObject(item)\n\t\t\t\t&& Type.isString(item.name)\n\t\t\t\t&& Type.isString(item.value)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst source = Runtime.clone(item);\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isArray(source.filter)\n\t\t\t\t\t|| source.filter.length <= 0\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tsource.filter = [Runtime.clone(getFilterStub(stubText))];\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!Type.isPlainObject(source.sort)\n\t\t\t\t\t|| !Type.isArray(source.sort.items)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tsource.sort = {items: []};\n\t\t\t\t}\n\n\t\t\t\treturn [...acc, source];\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n\n\treturn [];\n}","import {Type} from 'main.core';\nimport type {SourceItem} from './prepare-sources';\n\ntype Value = {\n\tsource: string,\n\tfilter: Array<{key: string, name: string, value: any}>,\n\tsort: {\n\t\tby: string,\n\t\torder: 'DESC' | 'ASC',\n\t},\n};\n\nfunction prepareFilter(filter, source)\n{\n\treturn filter.reduce((acc, field) => {\n\t\tif (Type.isPlainObject(field))\n\t\t{\n\t\t\treturn [...acc, {...field, url: source.url}];\n\t\t}\n\n\t\treturn acc;\n\t}, []);\n}\n\nexport default function prepareValue(value: any, sources: Array<SourceItem>): Value\n{\n\tconst [firstSource] = sources;\n\n\tif (!Type.isPlainObject(value))\n\t{\n\t\treturn {\n\t\t\tsource: firstSource.value,\n\t\t\tfilter: prepareFilter([...firstSource.filter], firstSource),\n\t\t\tsort: {\n\t\t\t\tby: firstSource.sort.items[0].key,\n\t\t\t\torder: 'DESC',\n\t\t\t},\n\t\t};\n\t}\n\n\tconst source = sources.find((item) => {\n\t\treturn item.value === value.source;\n\t});\n\n\tif (\n\t\t!Type.isArray(value.filter)\n\t\t|| value.filter.length <= 0\n\t)\n\t{\n\t\tif (source)\n\t\t{\n\t\t\tvalue.filter = [...source.filter];\n\t\t}\n\t}\n\n\tvalue.filter = prepareFilter(value.filter, source);\n\n\tif (!Type.isPlainObject(value.sort))\n\t{\n\t\tvalue.sort = {};\n\t}\n\n\tif (!Type.isString(value.sort.by))\n\t{\n\t\tif (source)\n\t\t{\n\t\t\tvalue.sort.by = source.sort.items[0].value;\n\t\t}\n\t}\n\n\tif (!Type.isString(value.sort.order))\n\t{\n\t\tvalue.sort.order = 'DESC';\n\t}\n\n\treturn value;\n}","import { Cache, Dom, Event, Runtime, Tag, Text, Type } from 'main.core';\nimport { Loc } from 'landing.loc';\nimport { Env } from 'landing.env';\nimport { BaseField } from 'landing.ui.field.basefield';\nimport type { SourceItem } from './internal/prepare-sources';\nimport prepareSources from './internal/prepare-sources';\nimport prepareValue from './internal/prepare-value';\nimport './css/style.css';\nimport getFilterStub from './internal/filter-stub';\n\n/**\n * @memberOf BX.Landing.UI.Field\n */\nexport class SourceField extends BaseField\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tDom.addClass(this.layout, 'landing-ui-field-source');\n\n\t\tthis.items = prepareSources(options.items, options.stubText);\n\t\tthis.value = prepareValue(options.value, this.items);\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.linkType = options.linkType ?? '';\n\t\tthis.onButtonClick = this.onButtonClick.bind(this);\n\t\tthis.onMenuItemClick = this.onMenuItemClick.bind(this);\n\t\tthis.onSliderMessage = this.onSliderMessage.bind(this);\n\t\tthis.onPlaceholderRemoveClick = this.onPlaceholderRemoveClick.bind(this);\n\t\tthis.onPlaceholderClick = this.onPlaceholderClick.bind(this);\n\n\t\tDom.append(this.getGrid(), this.layout);\n\t\tif (!options.hideSort)\n\t\t{\n\t\t\tDom.append(this.getSortByField().layout, this.layout);\n\t\t\tDom.append(this.getSortOrderField().layout, this.layout);\n\t\t}\n\n\t\tif (options.useLink)\n\t\t{\n\t\t\tDom.append(this.getLink(), this.layout);\n\t\t}\n\n\t\tif (options.showValueInHeader && options.showValueInHeader !== false)\n\t\t{\n\t\t\tDom.append(this.getValueLayoutWrapper(), this.header);\n\t\t}\n\n\t\tthis.setValue(this.value);\n\n\t\twindow.top.BX.addCustomEvent('SidePanel.Slider:onMessage', this.onSliderMessage);\n\t}\n\n\tgetItem(value: string): ?SourceItem\n\t{\n\t\treturn this.items.find((item) => {\n\t\t\treturn item.value === value;\n\t\t});\n\t}\n\n\tgetButtonField(): ?BX.Landing.UI.Button.BaseButton\n\t{\n\t\treturn this.getMenuItems().length > 1\n\t\t\t? this.cache.remember('buttonField', () => {\n\t\t\t\tnew BX.Landing.UI.Button.BaseButton('dropdown_button', {\n\t\t\t\t\ttext: Loc.getMessage('LINK_URL_SUGGESTS_SELECT'),\n\t\t\t\t\tclassName: 'landing-ui-button-select-link',\n\t\t\t\t\tonClick: this.onButtonClick,\n\t\t\t\t});\n\t\t\t})\n\t\t\t: null;\n\t}\n\n\tgetSortByField(): BX.Landing.UI.Field.DropdownInline\n\t{\n\t\treturn this.cache.remember('sortByField', () => {\n\t\t\tconst item = this.getItem(this.value.source);\n\t\t\treturn new BX.Landing.UI.Field.DropdownInline({\n\t\t\t\ttitle: Loc.getMessage('LANDING_CARDS__SOURCE_FIELD_SORT_TITLE').toLowerCase(),\n\t\t\t\titems: item.sort.items,\n\t\t\t\tcontent: this.value.sort.by,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSortOrderField(): BX.Landing.UI.Field.DropdownInline\n\t{\n\t\treturn this.cache.remember('sortOrderField', () => {\n\t\t\treturn new BX.Landing.UI.Field.DropdownInline({\n\t\t\t\ttitle: ', ',\n\t\t\t\titems: [\n\t\t\t\t\t{name: Loc.getMessage('LANDING_CARDS__SOURCE_FIELD_SORT_DESC'), value: 'DESC'},\n\t\t\t\t\t{name: Loc.getMessage('LANDING_CARDS__SOURCE_FIELD_SORT_ASC'), value: 'ASC'},\n\t\t\t\t],\n\t\t\t\tcontent: this.value.sort.order,\n\t\t\t});\n\t\t});\n\t}\n\n\tgetValueLayout(): HTMLSpanElement\n\t{\n\t\treturn this.cache.remember('valueLayout', () => {\n\t\t\treturn Tag.render`<span></span>`;\n\t\t});\n\t}\n\n\tgetValueLayoutWrapper(): HTMLSpanElement\n\t{\n\t\treturn this.cache.remember('valueLayoutWrapper', () => {\n\t\t\treturn Tag.render`<span>&nbsp;(${this.getValueLayout()})</span>`;\n\t\t});\n\t}\n\n\tgetInput(): HTMLDivElement\n\t{\n\t\treturn this.input;\n\t}\n\n\tgetGrid(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('grid', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-field-source-grid\">\n\t\t\t\t\t<div class=\"landing-ui-field-source-grid-left\">${this.getInput()}</div>\n\t\t\t\t\t<div class=\"landing-ui-field-source-grid-right\">${this.getButtonField()?.layout}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonButtonClick()\n\t{\n\t\tthis.getMenu().show();\n\t}\n\n\tonMenuItemClick(item)\n\t{\n\t\tconst value = prepareValue({source: item.value}, this.items);\n\t\tthis.setValue(value);\n\t\tthis.getMenu().close();\n\t\tthis.openSourceFilterSlider(item.url);\n\t}\n\n\tonPlaceholderClick(item, event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tthis.openSourceFilterSlider(item.url);\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\tonPlaceholderRemoveClick(item, event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tconst {currentTarget} = event;\n\n\t\tif (Type.isDomNode(currentTarget))\n\t\t{\n\t\t\tconst placeholder = currentTarget\n\t\t\t\t.closest('.landing-ui-field-source-placeholder');\n\n\t\t\tif (placeholder)\n\t\t\t{\n\t\t\t\tDom.remove(placeholder);\n\t\t\t}\n\n\t\t\tif (this.getPlaceholders().length <= 0)\n\t\t\t{\n\t\t\t\tconst value = prepareValue({source: this.getValue().source}, this.items);\n\t\t\t\tthis.prepareLink(value);\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.setFilter(value.filter);\n\t\t\t}\n\n\t\t\tthis.value.filter = this.getPlaceholders().map((placeholderNode) => {\n\t\t\t\treturn Dom.attr(placeholderNode, 'data-item');\n\t\t\t});\n\t\t}\n\t}\n\n\tonSliderMessage(event)\n\t{\n\t\tif (event.getEventId() === 'save')\n\t\t{\n\t\t\tconst sourceValue = {...this.getValue(), filter: event.getData().filter};\n\t\t\tconst value = prepareValue(sourceValue, this.items);\n\t\t\tthis.prepareLink(value);\n\n\t\t\tthis.value = value;\n\t\t\tthis.setFilter(value.filter);\n\t\t}\n\t}\n\n\topenSourceFilterSlider(url)\n\t{\n\t\tif (Type.isString(url))\n\t\t{\n\t\t\tconst siteId = Env.getInstance().getOptions().site_id;\n\n\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\tcacheable: false,\n\t\t\t\trequestMethod: 'post',\n\t\t\t\trequestParams: {\n\t\t\t\t\tfilter: this.getValue().filter,\n\t\t\t\t\tlandingParams: {\n\t\t\t\t\t\tsiteId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tgetMenuItems(): Array<{id: string, text: string, onclick: () => {}}>\n\t{\n\t\treturn this.cache.remember('menuItems', () => {\n\t\t\treturn this.items.map((item) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: item.value,\n\t\t\t\t\ttext: Text.encode(item.name),\n\t\t\t\t\tonclick: () => this.onMenuItemClick(item),\n\t\t\t\t};\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMenu(): BX.PopupMenuWindow\n\t{\n\t\treturn this.cache.remember('menu', () => {\n\t\t\tconst form = this.input.closest(\n\t\t\t\t'.landing-ui-field-source',\n\t\t\t);\n\n\t\t\tconst menu = new BX.PopupMenuWindow({\n\t\t\t\tid: `${this.selector}_${Text.getRandom()}`,\n\t\t\t\tbindElement: this.getButtonField()?.layout,\n\t\t\t\tautoHide: true,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'landing-ui-field-source-popup',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\tconst buttonPosition = Dom.getRelativePosition(\n\t\t\t\t\t\t\tthis.getButtonField()?.layout,\n\t\t\t\t\t\t\tform,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst offsetX = 0;\n\t\t\t\t\t\tconst popupWindowTop = buttonPosition.bottom;\n\n\t\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\t\tDom.style(menu.popupWindow.popupContainer, {\n\t\t\t\t\t\t\t\ttop: `${popupWindowTop}px`,\n\t\t\t\t\t\t\t\tleft: 'auto',\n\t\t\t\t\t\t\t\tright: `${offsetX}px`,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tDom.append(menu.popupWindow.popupContainer, form);\n\n\t\t\treturn menu;\n\t\t});\n\t}\n\n\taddPlaceholder(options)\n\t{\n\t\tconst placeholder = Tag.render`\n\t\t\t<div class=\"landing-ui-field-source-placeholder\">\n\t\t\t\t<span class=\"landing-ui-field-source-placeholder-text\">${Text.encode(options.name)}</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.attr(placeholder, {\n\t\t\t'data-item': options,\n\t\t\ttitle: options.name,\n\t\t});\n\n\t\tif (!options.url)\n\t\t{\n\t\t\tDom.addClass(placeholder.firstElementChild, 'landing-ui-field-source-placeholder-text-plain');\n\t\t}\n\n\t\tif (options.url)\n\t\t{\n\t\t\tconst removeButton = Tag.render`\n\t\t\t\t<span class=\"landing-ui-field-source-placeholder-remove\"></span>\n\t\t\t`;\n\n\t\t\tDom.append(removeButton, placeholder);\n\t\t\tEvent.bind(placeholder, 'click', this.onPlaceholderClick.bind(this, options));\n\t\t\tEvent.bind(removeButton, 'click', this.onPlaceholderRemoveClick.bind(this, options));\n\t\t}\n\n\t\tDom.append(placeholder, this.input);\n\t}\n\n\tgetPlaceholders(): Array<HTMLElement>\n\t{\n\t\treturn [...this.input.querySelectorAll('.landing-ui-field-source-placeholder')];\n\t}\n\n\tsetFilter(filter: Array<{key: string, name: string, value: any, url: ?string}>)\n\t{\n\t\tDom.clean(this.getInput());\n\n\t\tfilter.forEach((field) => {\n\t\t\tthis.addPlaceholder(field);\n\t\t});\n\t}\n\n\tsetSource({value, name}: SourceItem)\n\t{\n\t\tconst valueLayout = this.getValueLayout();\n\t\tDom.attr(valueLayout, 'data-value', value);\n\t\tvalueLayout.innerText = name;\n\t}\n\n\tsetSortByItems(items: {name: string, value: string})\n\t{\n\t\tif (Type.isArray(items))\n\t\t{\n\t\t\tthis.getSortByField().setItems(items);\n\t\t}\n\t}\n\n\tsetValue(value, preventEvent)\n\t{\n\t\tconst preparedValue = prepareValue(value, this.items);\n\t\tconst sourceItem = this.getItem(value.source);\n\n\t\tif (Type.isPlainObject(sourceItem))\n\t\t{\n\t\t\tif (\n\t\t\t\tpreparedValue.source !== this.value.source\n\t\t\t\t|| this.getPlaceholders().length <= 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.value = Runtime.clone(preparedValue);\n\n\t\t\t\tthis.setFilter(preparedValue.filter);\n\t\t\t\tthis.setSource(sourceItem);\n\n\t\t\t\tconst sortByField = this.getSortByField();\n\t\t\t\tsortByField.setItems(sourceItem.sort.items);\n\t\t\t\tsortByField.setValue(preparedValue.sort.by);\n\n\t\t\t\tconst orderByField = this.getSortOrderField();\n\t\t\t\torderByField.setValue(preparedValue.sort.order);\n\n\t\t\t\tif (!preventEvent)\n\t\t\t\t{\n\t\t\t\t\tthis.onValueChangeHandler(this);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetValue()\n\t{\n\t\tconst value = Runtime.clone(this.value);\n\n\t\tvalue.filter = value.filter\n\t\t\t.filter((field) => {\n\t\t\t\treturn field.key !== getFilterStub().key;\n\t\t\t})\n\t\t\t.map((field) => {\n\t\t\t\tReflect.deleteProperty(field, 'url');\n\t\t\t\treturn field;\n\t\t\t});\n\n\t\tvalue.sort.by = this.getSortByField().getValue();\n\t\tvalue.sort.order = this.getSortOrderField().getValue();\n\n\t\treturn value;\n\t}\n\n\tgetCurrentSource(): SourceItem\n\t{\n\t\tconst value = this.getValue();\n\t\treturn this.getItem(value.source);\n\t}\n\n\tisDetailPageAllowed()\n\t{\n\t\tconst source = this.getCurrentSource();\n\n\t\treturn (\n\t\t\t!Type.isPlainObject(source)\n\t\t\t|| !Type.isPlainObject(source.settings)\n\t\t\t|| source.settings.detailPage !== false\n\t\t);\n\t}\n\n\tgetLink(): HTMLDivElement\n\t{\n\t\tlet href = '#';\n\t\tlet hrefAttr = '';\n\t\tconst value = this.value?.filter?.[0]?.value ?? null;\n\t\tif (this.linkType === 'group' && value && value.startsWith('SG'))\n\t\t{\n\t\t\thref = `/workgroups/group/${value.slice(2)}/`;\n\t\t\threfAttr = `href=\"${href}\"`;\n\t\t}\n\n\t\treturn this.cache.remember('linkLayout', () => {\n\t\t\tconst text = BX.Landing.Loc.getMessage('LANDING_SOURCEFIELD_LINK_TEXT');\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-ui-field-link-container\">\n\t\t\t\t\t<a ${hrefAttr} target=\"_blank\" class=\"landing-ui-field-link\">\n\t\t\t\t\t\t${text}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tprepareLink(value)\n\t{\n\t\tconst linkElement = this.layout.querySelector('.landing-ui-field-link');\n\n\t\tif (linkElement && this.linkType === 'group')\n\t\t{\n\t\t\tconst newValue = value?.filter?.[0]?.value ?? null;\n\t\t\tif (newValue !== null && newValue.startsWith('SG'))\n\t\t\t{\n\t\t\t\tlinkElement.href = `/workgroups/group/${newValue.slice(2)}/`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlinkElement.removeAttribute('href');\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["getFilterStub","text","name","Loc","getMessage","key","value","prepareSources","sources","stubText","Type","isArray","reduce","acc","item","isPlainObject","isString","source","Runtime","clone","filter","length","sort","items","prepareFilter","field","url","prepareValue","firstSource","by","order","find","SourceField","options","Dom","addClass","layout","cache","Cache","MemoryCache","linkType","onButtonClick","bind","onMenuItemClick","onSliderMessage","onPlaceholderRemoveClick","onPlaceholderClick","append","getGrid","hideSort","getSortByField","getSortOrderField","useLink","getLink","showValueInHeader","getValueLayoutWrapper","header","setValue","window","top","BX","addCustomEvent","getMenuItems","remember","Landing","UI","Button","BaseButton","className","onClick","getItem","Field","DropdownInline","title","toLowerCase","content","Tag","render","getValueLayout","input","getInput","getButtonField","getMenu","show","close","openSourceFilterSlider","event","preventDefault","stopPropagation","currentTarget","isDomNode","placeholder","closest","remove","getPlaceholders","getValue","prepareLink","setFilter","map","placeholderNode","attr","getEventId","sourceValue","getData","siteId","Env","getInstance","getOptions","site_id","SidePanel","Instance","open","cacheable","requestMethod","requestParams","landingParams","id","Text","encode","onclick","form","menu","PopupMenuWindow","selector","getRandom","bindElement","autoHide","events","onPopupShow","buttonPosition","getRelativePosition","offsetX","popupWindowTop","bottom","requestAnimationFrame","style","popupWindow","popupContainer","left","right","firstElementChild","removeButton","Event","querySelectorAll","clean","forEach","addPlaceholder","valueLayout","innerText","setItems","preventEvent","preparedValue","sourceItem","setSource","sortByField","orderByField","onValueChangeHandler","Reflect","deleteProperty","getCurrentSource","settings","detailPage","href","hrefAttr","startsWith","slice","linkElement","querySelector","newValue","removeAttribute","BaseField"],"mappings":";;;;;;CAEe,SAASA,aAAa,GACrC;GAAA,IADsCC,IAAI,uEAAG,EAAE;GAE9C,IAAIC,IAAI,GAAGD,IAAI;GACf,IAAIC,IAAI,KAAK,EAAE,EACf;KACCA,IAAI,GAAGC,eAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC;;GAG3D,OAAO;KACNC,GAAG,EAAE,YAAY;KACjBH,IAAI,EAAJA,IAAI;KACJI,KAAK,EAAE;IACP;CACF;;CCCe,SAASC,cAAc,CAACC,OAA0B,EACjE;GAAA,IADmEC,QAAQ,uEAAG,EAAE;GAE/E,IAAIC,cAAI,CAACC,OAAO,CAACH,OAAO,CAAC,EACzB;KACC,OAAOA,OAAO,CAACI,MAAM,CAAC,UAACC,GAAG,EAAEC,IAAI,EAAK;OACpC,IACCJ,cAAI,CAACK,aAAa,CAACD,IAAI,CAAC,IACrBJ,cAAI,CAACM,QAAQ,CAACF,IAAI,CAACZ,IAAI,CAAC,IACxBQ,cAAI,CAACM,QAAQ,CAACF,IAAI,CAACR,KAAK,CAAC,EAE7B;SACC,IAAMW,MAAM,GAAGC,iBAAO,CAACC,KAAK,CAACL,IAAI,CAAC;SAElC,IACC,CAACJ,cAAI,CAACC,OAAO,CAACM,MAAM,CAACG,MAAM,CAAC,IACzBH,MAAM,CAACG,MAAM,CAACC,MAAM,IAAI,CAAC,EAE7B;WACCJ,MAAM,CAACG,MAAM,GAAG,CAACF,iBAAO,CAACC,KAAK,CAACnB,aAAa,CAACS,QAAQ,CAAC,CAAC,CAAC;;SAGzD,IACC,CAACC,cAAI,CAACK,aAAa,CAACE,MAAM,CAACK,IAAI,CAAC,IAC7B,CAACZ,cAAI,CAACC,OAAO,CAACM,MAAM,CAACK,IAAI,CAACC,KAAK,CAAC,EAEpC;WACCN,MAAM,CAACK,IAAI,GAAG;aAACC,KAAK,EAAE;YAAG;;SAG1B,gDAAWV,GAAG,IAAEI,MAAM;;OAGvB,OAAOJ,GAAG;MACV,EAAE,EAAE,CAAC;;GAGP,OAAO,EAAE;CACV;;;;ACrDA,CAYA,SAASW,aAAa,CAACJ,MAAM,EAAEH,MAAM,EACrC;GACC,OAAOG,MAAM,CAACR,MAAM,CAAC,UAACC,GAAG,EAAEY,KAAK,EAAK;KACpC,IAAIf,cAAI,CAACK,aAAa,CAACU,KAAK,CAAC,EAC7B;OACC,gDAAWZ,GAAG,oCAAMY,KAAK;SAAEC,GAAG,EAAET,MAAM,CAACS;;;KAGxC,OAAOb,GAAG;IACV,EAAE,EAAE,CAAC;CACP;AAEA,CAAe,SAASc,YAAY,CAACrB,KAAU,EAAEE,OAA0B,EAC3E;GACC,0CAAsBA,OAAO;KAAtBoB,WAAW;GAElB,IAAI,CAAClB,cAAI,CAACK,aAAa,CAACT,KAAK,CAAC,EAC9B;KACC,OAAO;OACNW,MAAM,EAAEW,WAAW,CAACtB,KAAK;OACzBc,MAAM,EAAEI,aAAa,gCAAKI,WAAW,CAACR,MAAM,GAAGQ,WAAW,CAAC;OAC3DN,IAAI,EAAE;SACLO,EAAE,EAAED,WAAW,CAACN,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAAClB,GAAG;SACjCyB,KAAK,EAAE;;MAER;;GAGF,IAAMb,MAAM,GAAGT,OAAO,CAACuB,IAAI,CAAC,UAACjB,IAAI,EAAK;KACrC,OAAOA,IAAI,CAACR,KAAK,KAAKA,KAAK,CAACW,MAAM;IAClC,CAAC;GAEF,IACC,CAACP,cAAI,CAACC,OAAO,CAACL,KAAK,CAACc,MAAM,CAAC,IACxBd,KAAK,CAACc,MAAM,CAACC,MAAM,IAAI,CAAC,EAE5B;KACC,IAAIJ,MAAM,EACV;OACCX,KAAK,CAACc,MAAM,kCAAOH,MAAM,CAACG,MAAM,CAAC;;;GAInCd,KAAK,CAACc,MAAM,GAAGI,aAAa,CAAClB,KAAK,CAACc,MAAM,EAAEH,MAAM,CAAC;GAElD,IAAI,CAACP,cAAI,CAACK,aAAa,CAACT,KAAK,CAACgB,IAAI,CAAC,EACnC;KACChB,KAAK,CAACgB,IAAI,GAAG,EAAE;;GAGhB,IAAI,CAACZ,cAAI,CAACM,QAAQ,CAACV,KAAK,CAACgB,IAAI,CAACO,EAAE,CAAC,EACjC;KACC,IAAIZ,MAAM,EACV;OACCX,KAAK,CAACgB,IAAI,CAACO,EAAE,GAAGZ,MAAM,CAACK,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACjB,KAAK;;;GAI5C,IAAI,CAACI,cAAI,CAACM,QAAQ,CAACV,KAAK,CAACgB,IAAI,CAACQ,KAAK,CAAC,EACpC;KACCxB,KAAK,CAACgB,IAAI,CAACQ,KAAK,GAAG,MAAM;;GAG1B,OAAOxB,KAAK;CACb;;;;;AC5EA;CAUA;CACA;CACA;AACA,KAAa0B,WAAW;GAAA;GAEvB,qBAAYC,OAAO,EACnB;KAAA;KAAA;KAAA;KACC,yGAAMA,OAAO;KACbC,aAAG,CAACC,QAAQ,CAAC,MAAKC,MAAM,EAAE,yBAAyB,CAAC;KAEpD,MAAKb,KAAK,GAAGhB,cAAc,CAAC0B,OAAO,CAACV,KAAK,EAAEU,OAAO,CAACxB,QAAQ,CAAC;KAC5D,MAAKH,KAAK,GAAGqB,YAAY,CAACM,OAAO,CAAC3B,KAAK,EAAE,MAAKiB,KAAK,CAAC;KACpD,MAAKc,KAAK,GAAG,IAAIC,eAAK,CAACC,WAAW,EAAE;KACpC,MAAKC,QAAQ,wBAAGP,OAAO,CAACO,QAAQ,iEAAI,EAAE;KACtC,MAAKC,aAAa,GAAG,MAAKA,aAAa,CAACC,IAAI,2CAAM;KAClD,MAAKC,eAAe,GAAG,MAAKA,eAAe,CAACD,IAAI,2CAAM;KACtD,MAAKE,eAAe,GAAG,MAAKA,eAAe,CAACF,IAAI,2CAAM;KACtD,MAAKG,wBAAwB,GAAG,MAAKA,wBAAwB,CAACH,IAAI,2CAAM;KACxE,MAAKI,kBAAkB,GAAG,MAAKA,kBAAkB,CAACJ,IAAI,2CAAM;KAE5DR,aAAG,CAACa,MAAM,CAAC,MAAKC,OAAO,EAAE,EAAE,MAAKZ,MAAM,CAAC;KACvC,IAAI,CAACH,OAAO,CAACgB,QAAQ,EACrB;OACCf,aAAG,CAACa,MAAM,CAAC,MAAKG,cAAc,EAAE,CAACd,MAAM,EAAE,MAAKA,MAAM,CAAC;OACrDF,aAAG,CAACa,MAAM,CAAC,MAAKI,iBAAiB,EAAE,CAACf,MAAM,EAAE,MAAKA,MAAM,CAAC;;KAGzD,IAAIH,OAAO,CAACmB,OAAO,EACnB;OACClB,aAAG,CAACa,MAAM,CAAC,MAAKM,OAAO,EAAE,EAAE,MAAKjB,MAAM,CAAC;;KAGxC,IAAIH,OAAO,CAACqB,iBAAiB,IAAIrB,OAAO,CAACqB,iBAAiB,KAAK,KAAK,EACpE;OACCpB,aAAG,CAACa,MAAM,CAAC,MAAKQ,qBAAqB,EAAE,EAAE,MAAKC,MAAM,CAAC;;KAGtD,MAAKC,QAAQ,CAAC,MAAKnD,KAAK,CAAC;KAEzBoD,MAAM,CAACC,GAAG,CAACC,EAAE,CAACC,cAAc,CAAC,4BAA4B,EAAE,MAAKjB,eAAe,CAAC;KAAC;;GACjF;KAAA;KAAA,wBAEOtC,KAAa,EACrB;OACC,OAAO,IAAI,CAACiB,KAAK,CAACQ,IAAI,CAAC,UAACjB,IAAI,EAAK;SAChC,OAAOA,IAAI,CAACR,KAAK,KAAKA,KAAK;QAC3B,CAAC;;;KACF;KAAA,iCAGD;OAAA;OACC,OAAO,IAAI,CAACwD,YAAY,EAAE,CAACzC,MAAM,GAAG,CAAC,GAClC,IAAI,CAACgB,KAAK,CAAC0B,QAAQ,CAAC,aAAa,EAAE,YAAM;SAC1C,IAAIH,EAAE,CAACI,OAAO,CAACC,EAAE,CAACC,MAAM,CAACC,UAAU,CAAC,iBAAiB,EAAE;WACtDlE,IAAI,EAAEE,eAAG,CAACC,UAAU,CAAC,0BAA0B,CAAC;WAChDgE,SAAS,EAAE,+BAA+B;WAC1CC,OAAO,EAAE,MAAI,CAAC5B;UACd,CAAC;QACF,CAAC,GACA,IAAI;;;KACP;KAAA,iCAGD;OAAA;OACC,OAAO,IAAI,CAACJ,KAAK,CAAC0B,QAAQ,CAAC,aAAa,EAAE,YAAM;SAC/C,IAAMjD,IAAI,GAAG,MAAI,CAACwD,OAAO,CAAC,MAAI,CAAChE,KAAK,CAACW,MAAM,CAAC;SAC5C,OAAO,IAAI2C,EAAE,CAACI,OAAO,CAACC,EAAE,CAACM,KAAK,CAACC,cAAc,CAAC;WAC7CC,KAAK,EAAEtE,eAAG,CAACC,UAAU,CAAC,wCAAwC,CAAC,CAACsE,WAAW,EAAE;WAC7EnD,KAAK,EAAET,IAAI,CAACQ,IAAI,CAACC,KAAK;WACtBoD,OAAO,EAAE,MAAI,CAACrE,KAAK,CAACgB,IAAI,CAACO;UACzB,CAAC;QACF,CAAC;;;KACF;KAAA,oCAGD;OAAA;OACC,OAAO,IAAI,CAACQ,KAAK,CAAC0B,QAAQ,CAAC,gBAAgB,EAAE,YAAM;SAClD,OAAO,IAAIH,EAAE,CAACI,OAAO,CAACC,EAAE,CAACM,KAAK,CAACC,cAAc,CAAC;WAC7CC,KAAK,EAAE,IAAI;WACXlD,KAAK,EAAE,CACN;aAACrB,IAAI,EAAEC,eAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;aAAEE,KAAK,EAAE;YAAO,EAC9E;aAACJ,IAAI,EAAEC,eAAG,CAACC,UAAU,CAAC,sCAAsC,CAAC;aAAEE,KAAK,EAAE;YAAM,CAC5E;WACDqE,OAAO,EAAE,MAAI,CAACrE,KAAK,CAACgB,IAAI,CAACQ;UACzB,CAAC;QACF,CAAC;;;KACF;KAAA,iCAGD;OACC,OAAO,IAAI,CAACO,KAAK,CAAC0B,QAAQ,CAAC,aAAa,EAAE,YAAM;SAC/C,OAAOa,aAAG,CAACC,MAAM;QACjB,CAAC;;;KACF;KAAA,wCAGD;OAAA;OACC,OAAO,IAAI,CAACxC,KAAK,CAAC0B,QAAQ,CAAC,oBAAoB,EAAE,YAAM;SACtD,OAAOa,aAAG,CAACC,MAAM,6GAAgB,MAAI,CAACC,cAAc,EAAE;QACtD,CAAC;;;KACF;KAAA,2BAGD;OACC,OAAO,IAAI,CAACC,KAAK;;;KACjB;KAAA,0BAGD;OAAA;OACC,OAAO,IAAI,CAAC1C,KAAK,CAAC0B,QAAQ,CAAC,MAAM,EAAE,YAAM;SAAA;SACxC,OAAOa,aAAG,CAACC,MAAM,iTAEkC,MAAI,CAACG,QAAQ,EAAE,2BACd,MAAI,CAACC,cAAc,EAAE,0DAArB,sBAAuB7C,MAAM;QAGjF,CAAC;;;KACF;KAAA,gCAGD;OACC,IAAI,CAAC8C,OAAO,EAAE,CAACC,IAAI,EAAE;;;KACrB;KAAA,gCAEerE,IAAI,EACpB;OACC,IAAMR,KAAK,GAAGqB,YAAY,CAAC;SAACV,MAAM,EAAEH,IAAI,CAACR;QAAM,EAAE,IAAI,CAACiB,KAAK,CAAC;OAC5D,IAAI,CAACkC,QAAQ,CAACnD,KAAK,CAAC;OACpB,IAAI,CAAC4E,OAAO,EAAE,CAACE,KAAK,EAAE;OACtB,IAAI,CAACC,sBAAsB,CAACvE,IAAI,CAACY,GAAG,CAAC;;;KACrC;KAAA,mCAEkBZ,IAAI,EAAEwE,KAAiB,EAC1C;OACCA,KAAK,CAACC,cAAc,EAAE;OACtB,IAAI,CAACF,sBAAsB,CAACvE,IAAI,CAACY,GAAG,CAAC;MACrC;;KAED;KAAA,yCACyBZ,IAAI,EAAEwE,KAAiB,EAChD;OACCA,KAAK,CAACC,cAAc,EAAE;OACtBD,KAAK,CAACE,eAAe,EAAE;OAEvB,IAAOC,aAAa,GAAIH,KAAK,CAAtBG,aAAa;OAEpB,IAAI/E,cAAI,CAACgF,SAAS,CAACD,aAAa,CAAC,EACjC;SACC,IAAME,WAAW,GAAGF,aAAa,CAC/BG,OAAO,CAAC,sCAAsC,CAAC;SAEjD,IAAID,WAAW,EACf;WACCzD,aAAG,CAAC2D,MAAM,CAACF,WAAW,CAAC;;SAGxB,IAAI,IAAI,CAACG,eAAe,EAAE,CAACzE,MAAM,IAAI,CAAC,EACtC;WACC,IAAMf,KAAK,GAAGqB,YAAY,CAAC;aAACV,MAAM,EAAE,IAAI,CAAC8E,QAAQ,EAAE,CAAC9E;YAAO,EAAE,IAAI,CAACM,KAAK,CAAC;WACxE,IAAI,CAACyE,WAAW,CAAC1F,KAAK,CAAC;WACvB,IAAI,CAACA,KAAK,GAAGA,KAAK;WAClB,IAAI,CAAC2F,SAAS,CAAC3F,KAAK,CAACc,MAAM,CAAC;;SAG7B,IAAI,CAACd,KAAK,CAACc,MAAM,GAAG,IAAI,CAAC0E,eAAe,EAAE,CAACI,GAAG,CAAC,UAACC,eAAe,EAAK;WACnE,OAAOjE,aAAG,CAACkE,IAAI,CAACD,eAAe,EAAE,WAAW,CAAC;UAC7C,CAAC;;;;KAEH;KAAA,gCAEeb,KAAK,EACrB;OACC,IAAIA,KAAK,CAACe,UAAU,EAAE,KAAK,MAAM,EACjC;SACC,IAAMC,WAAW,uCAAO,IAAI,CAACP,QAAQ,EAAE;WAAE3E,MAAM,EAAEkE,KAAK,CAACiB,OAAO,EAAE,CAACnF;WAAO;SACxE,IAAMd,KAAK,GAAGqB,YAAY,CAAC2E,WAAW,EAAE,IAAI,CAAC/E,KAAK,CAAC;SACnD,IAAI,CAACyE,WAAW,CAAC1F,KAAK,CAAC;SAEvB,IAAI,CAACA,KAAK,GAAGA,KAAK;SAClB,IAAI,CAAC2F,SAAS,CAAC3F,KAAK,CAACc,MAAM,CAAC;;;;KAE7B;KAAA,uCAEsBM,GAAG,EAC1B;OACC,IAAIhB,cAAI,CAACM,QAAQ,CAACU,GAAG,CAAC,EACtB;SACC,IAAM8E,MAAM,GAAGC,eAAG,CAACC,WAAW,EAAE,CAACC,UAAU,EAAE,CAACC,OAAO;SAErDhD,EAAE,CAACiD,SAAS,CAACC,QAAQ,CAACC,IAAI,CAACrF,GAAG,EAAE;WAC/BsF,SAAS,EAAE,KAAK;WAChBC,aAAa,EAAE,MAAM;WACrBC,aAAa,EAAE;aACd9F,MAAM,EAAE,IAAI,CAAC2E,QAAQ,EAAE,CAAC3E,MAAM;aAC9B+F,aAAa,EAAE;eACdX,MAAM,EAANA;;;UAGF,CAAC;;;;KAEH;KAAA,+BAGD;OAAA;OACC,OAAO,IAAI,CAACnE,KAAK,CAAC0B,QAAQ,CAAC,WAAW,EAAE,YAAM;SAC7C,OAAO,MAAI,CAACxC,KAAK,CAAC2E,GAAG,CAAC,UAACpF,IAAI,EAAK;WAC/B,OAAO;aACNsG,EAAE,EAAEtG,IAAI,CAACR,KAAK;aACdL,IAAI,EAAEoH,cAAI,CAACC,MAAM,CAACxG,IAAI,CAACZ,IAAI,CAAC;aAC5BqH,OAAO,EAAE;eAAA,OAAM,MAAI,CAAC5E,eAAe,CAAC7B,IAAI,CAAC;;YACzC;UACD,CAAC;QACF,CAAC;;;KACF;KAAA,0BAGD;OAAA;OACC,OAAO,IAAI,CAACuB,KAAK,CAAC0B,QAAQ,CAAC,MAAM,EAAE,YAAM;SAAA;SACxC,IAAMyD,IAAI,GAAG,MAAI,CAACzC,KAAK,CAACa,OAAO,CAC9B,0BAA0B,CAC1B;SAED,IAAM6B,IAAI,GAAG,IAAI7D,EAAE,CAAC8D,eAAe,CAAC;WACnCN,EAAE,YAAK,MAAI,CAACO,QAAQ,cAAIN,cAAI,CAACO,SAAS,EAAE,CAAE;WAC1CC,WAAW,2BAAE,MAAI,CAAC5C,cAAc,EAAE,0DAArB,sBAAuB7C,MAAM;WAC1C0F,QAAQ,EAAE,IAAI;WACdvG,KAAK,EAAE,MAAI,CAACuC,YAAY,EAAE;WAC1BM,SAAS,EAAE,+BAA+B;WAC1C2D,MAAM,EAAE;aACPC,WAAW,EAAE,uBAAM;eAAA;eAClB,IAAMC,cAAc,GAAG/F,aAAG,CAACgG,mBAAmB,2BAC7C,MAAI,CAACjD,cAAc,EAAE,2DAArB,uBAAuB7C,MAAM,EAC7BoF,IAAI,CACJ;eAED,IAAMW,OAAO,GAAG,CAAC;eACjB,IAAMC,cAAc,GAAGH,cAAc,CAACI,MAAM;eAE5CC,qBAAqB,CAAC,YAAM;iBAC3BpG,aAAG,CAACqG,KAAK,CAACd,IAAI,CAACe,WAAW,CAACC,cAAc,EAAE;mBAC1C9E,GAAG,YAAKyE,cAAc,OAAI;mBAC1BM,IAAI,EAAE,MAAM;mBACZC,KAAK,YAAKR,OAAO;kBACjB,CAAC;gBACF,CAAC;;;UAGJ,CAAC;SAEFjG,aAAG,CAACa,MAAM,CAAC0E,IAAI,CAACe,WAAW,CAACC,cAAc,EAAEjB,IAAI,CAAC;SAEjD,OAAOC,IAAI;QACX,CAAC;;;KACF;KAAA,+BAEcxF,OAAO,EACtB;OACC,IAAM0D,WAAW,GAAGf,aAAG,CAACC,MAAM,iPAE6BwC,cAAI,CAACC,MAAM,CAACrF,OAAO,CAAC/B,IAAI,CAAC,CAEnF;OAEDgC,aAAG,CAACkE,IAAI,CAACT,WAAW,EAAE;SACrB,WAAW,EAAE1D,OAAO;SACpBwC,KAAK,EAAExC,OAAO,CAAC/B;QACf,CAAC;OAEF,IAAI,CAAC+B,OAAO,CAACP,GAAG,EAChB;SACCQ,aAAG,CAACC,QAAQ,CAACwD,WAAW,CAACiD,iBAAiB,EAAE,gDAAgD,CAAC;;OAG9F,IAAI3G,OAAO,CAACP,GAAG,EACf;SACC,IAAMmH,YAAY,GAAGjE,aAAG,CAACC,MAAM,uKAE9B;SAED3C,aAAG,CAACa,MAAM,CAAC8F,YAAY,EAAElD,WAAW,CAAC;SACrCmD,eAAK,CAACpG,IAAI,CAACiD,WAAW,EAAE,OAAO,EAAE,IAAI,CAAC7C,kBAAkB,CAACJ,IAAI,CAAC,IAAI,EAAET,OAAO,CAAC,CAAC;SAC7E6G,eAAK,CAACpG,IAAI,CAACmG,YAAY,EAAE,OAAO,EAAE,IAAI,CAAChG,wBAAwB,CAACH,IAAI,CAAC,IAAI,EAAET,OAAO,CAAC,CAAC;;OAGrFC,aAAG,CAACa,MAAM,CAAC4C,WAAW,EAAE,IAAI,CAACZ,KAAK,CAAC;;;KACnC;KAAA,kCAGD;OACC,sCAAW,IAAI,CAACA,KAAK,CAACgE,gBAAgB,CAAC,sCAAsC,CAAC;;;KAC9E;KAAA,0BAES3H,MAAoE,EAC9E;OAAA;OACCc,aAAG,CAAC8G,KAAK,CAAC,IAAI,CAAChE,QAAQ,EAAE,CAAC;OAE1B5D,MAAM,CAAC6H,OAAO,CAAC,UAACxH,KAAK,EAAK;SACzB,MAAI,CAACyH,cAAc,CAACzH,KAAK,CAAC;QAC1B,CAAC;;;KACF;KAAA,gCAGD;OAAA,IADWnB,KAAK,QAALA,KAAK;SAAEJ,IAAI,QAAJA,IAAI;OAErB,IAAMiJ,WAAW,GAAG,IAAI,CAACrE,cAAc,EAAE;OACzC5C,aAAG,CAACkE,IAAI,CAAC+C,WAAW,EAAE,YAAY,EAAE7I,KAAK,CAAC;OAC1C6I,WAAW,CAACC,SAAS,GAAGlJ,IAAI;;;KAC5B;KAAA,+BAEcqB,KAAoC,EACnD;OACC,IAAIb,cAAI,CAACC,OAAO,CAACY,KAAK,CAAC,EACvB;SACC,IAAI,CAAC2B,cAAc,EAAE,CAACmG,QAAQ,CAAC9H,KAAK,CAAC;;;;KAEtC;KAAA,yBAEQjB,KAAK,EAAEgJ,YAAY,EAC5B;OACC,IAAMC,aAAa,GAAG5H,YAAY,CAACrB,KAAK,EAAE,IAAI,CAACiB,KAAK,CAAC;OACrD,IAAMiI,UAAU,GAAG,IAAI,CAAClF,OAAO,CAAChE,KAAK,CAACW,MAAM,CAAC;OAE7C,IAAIP,cAAI,CAACK,aAAa,CAACyI,UAAU,CAAC,EAClC;SACC,IACCD,aAAa,CAACtI,MAAM,KAAK,IAAI,CAACX,KAAK,CAACW,MAAM,IACvC,IAAI,CAAC6E,eAAe,EAAE,CAACzE,MAAM,IAAI,CAAC,EAEtC;WACC,IAAI,CAACf,KAAK,GAAGY,iBAAO,CAACC,KAAK,CAACoI,aAAa,CAAC;WAEzC,IAAI,CAACtD,SAAS,CAACsD,aAAa,CAACnI,MAAM,CAAC;WACpC,IAAI,CAACqI,SAAS,CAACD,UAAU,CAAC;WAE1B,IAAME,WAAW,GAAG,IAAI,CAACxG,cAAc,EAAE;WACzCwG,WAAW,CAACL,QAAQ,CAACG,UAAU,CAAClI,IAAI,CAACC,KAAK,CAAC;WAC3CmI,WAAW,CAACjG,QAAQ,CAAC8F,aAAa,CAACjI,IAAI,CAACO,EAAE,CAAC;WAE3C,IAAM8H,YAAY,GAAG,IAAI,CAACxG,iBAAiB,EAAE;WAC7CwG,YAAY,CAAClG,QAAQ,CAAC8F,aAAa,CAACjI,IAAI,CAACQ,KAAK,CAAC;WAE/C,IAAI,CAACwH,YAAY,EACjB;aACC,IAAI,CAACM,oBAAoB,CAAC,IAAI,CAAC;;;;;;KAIlC;KAAA,2BAGD;OACC,IAAMtJ,KAAK,GAAGY,iBAAO,CAACC,KAAK,CAAC,IAAI,CAACb,KAAK,CAAC;OAEvCA,KAAK,CAACc,MAAM,GAAGd,KAAK,CAACc,MAAM,CACzBA,MAAM,CAAC,UAACK,KAAK,EAAK;SAClB,OAAOA,KAAK,CAACpB,GAAG,KAAKL,aAAa,EAAE,CAACK,GAAG;QACxC,CAAC,CACD6F,GAAG,CAAC,UAACzE,KAAK,EAAK;SACfoI,OAAO,CAACC,cAAc,CAACrI,KAAK,EAAE,KAAK,CAAC;SACpC,OAAOA,KAAK;QACZ,CAAC;OAEHnB,KAAK,CAACgB,IAAI,CAACO,EAAE,GAAG,IAAI,CAACqB,cAAc,EAAE,CAAC6C,QAAQ,EAAE;OAChDzF,KAAK,CAACgB,IAAI,CAACQ,KAAK,GAAG,IAAI,CAACqB,iBAAiB,EAAE,CAAC4C,QAAQ,EAAE;OAEtD,OAAOzF,KAAK;;;KACZ;KAAA,mCAGD;OACC,IAAMA,KAAK,GAAG,IAAI,CAACyF,QAAQ,EAAE;OAC7B,OAAO,IAAI,CAACzB,OAAO,CAAChE,KAAK,CAACW,MAAM,CAAC;;;KACjC;KAAA,sCAGD;OACC,IAAMA,MAAM,GAAG,IAAI,CAAC8I,gBAAgB,EAAE;OAEtC,OACC,CAACrJ,cAAI,CAACK,aAAa,CAACE,MAAM,CAAC,IACxB,CAACP,cAAI,CAACK,aAAa,CAACE,MAAM,CAAC+I,QAAQ,CAAC,IACpC/I,MAAM,CAAC+I,QAAQ,CAACC,UAAU,KAAK,KAAK;;;KAExC;KAAA,0BAGD;OAAA;OACC,IAAIC,IAAI,GAAG,GAAG;OACd,IAAIC,QAAQ,GAAG,EAAE;OACjB,IAAM7J,KAAK,2CAAG,IAAI,CAACA,KAAK,sEAAV,YAAYc,MAAM,8EAAlB,mBAAqB,CAAC,CAAC,wDAAvB,oBAAyBd,KAAK,yEAAI,IAAI;OACpD,IAAI,IAAI,CAACkC,QAAQ,KAAK,OAAO,IAAIlC,KAAK,IAAIA,KAAK,CAAC8J,UAAU,CAAC,IAAI,CAAC,EAChE;SACCF,IAAI,+BAAwB5J,KAAK,CAAC+J,KAAK,CAAC,CAAC,CAAC,MAAG;SAC7CF,QAAQ,oBAAYD,IAAI,OAAG;;OAG5B,OAAO,IAAI,CAAC7H,KAAK,CAAC0B,QAAQ,CAAC,YAAY,EAAE,YAAM;SAC9C,IAAM9D,IAAI,GAAG2D,EAAE,CAACI,OAAO,CAAC7D,GAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC;SAEvE,OAAOwE,aAAG,CAACC,MAAM,6QAEVsF,QAAQ,EACVlK,IAAI;QAIT,CAAC;;;KACF;KAAA,4BAEWK,KAAK,EACjB;OACC,IAAMgK,WAAW,GAAG,IAAI,CAAClI,MAAM,CAACmI,aAAa,CAAC,wBAAwB,CAAC;OAEvE,IAAID,WAAW,IAAI,IAAI,CAAC9H,QAAQ,KAAK,OAAO,EAC5C;SAAA;SACC,IAAMgI,QAAQ,4BAAGlK,KAAK,aAALA,KAAK,wCAALA,KAAK,CAAEc,MAAM,oEAAb,cAAgB,CAAC,CAAC,mDAAlB,eAAoBd,KAAK,yEAAI,IAAI;SAClD,IAAIkK,QAAQ,KAAK,IAAI,IAAIA,QAAQ,CAACJ,UAAU,CAAC,IAAI,CAAC,EAClD;WACCE,WAAW,CAACJ,IAAI,+BAAwBM,QAAQ,CAACH,KAAK,CAAC,CAAC,CAAC,MAAG;UAC5D,MAED;WACCC,WAAW,CAACG,eAAe,CAAC,MAAM,CAAC;;;;;GAGrC;CAAA,EAra+BC,oCAAS;;;;;;;;"}