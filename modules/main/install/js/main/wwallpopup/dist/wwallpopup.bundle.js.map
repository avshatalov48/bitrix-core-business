{"version":3,"file":"wwallpopup.bundle.js","sources":["../src/wwallpopup.js"],"sourcesContent":["import { Cache, Loc, Tag, Type } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button } from 'ui.buttons';\n\nexport class WwallPopup\n{\n\tconstructor(options)\n\t{\n\t\tthis.colorTheme = options.colorTheme || 'danger';\n\t\tthis.title = options.title || null;\n\t\tthis.subtitle = options.subtitle || null;\n\t\tthis.text = options.text || null;\n\t\tthis.isToolTipShow = Type.isBoolean(options.isToolTipShow) ? options.isToolTipShow : false;\n\t\tthis.closeIcon = Type.isBoolean(options.closeIcon) ? options.closeIcon : true;\n\t\tthis.isSuccess = Type.isBoolean(options.isSuccess) ? options.isSuccess : false;\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.buttons = options.buttons || null;\n\t}\n\n\tgetTitleWrapper(): HTMLElement\n\t{\n\t\treturn this.cache.remember('titleBox', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class='adm-security-popup_title-box'>\n\t\t\t\t\t${this.getTitle()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst title = this.title || Loc.getMessage('SEC_WWALL_POPUP_TITLE');\n\t\tconst toolTip = this.isToolTipShow ? this.getTooltip() : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class='adm-security-popup_title'>\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t\t${toolTip}\n\t\t`;\n\t}\n\n\tgetTooltip()\n\t{\n\t\treturn Tag.render`\n\t\t\t<a class='tooltip adm-security-popup_tooltip adm-security-info_link' href='https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=35&LESSON_ID=27172' target='_blank'>\n\t\t\t\t${Loc.getMessage('SEC_WWALL_POPUP_TITLE_ABOUT')}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.cache.remember('popupContentWarningWrap', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class='adm-security-popup_wrap --${this.colorTheme}'>\n\t\t\t\t\t${this.getTitleWrapper()}\n\t\t\t\t\t<div class='adm-security-popup_content'>\n\t\t\t\t\t\t<div class=\"adm-security-popup_icon\"></div>\n\t\t\t\t\t\t<div class=\"adm-security-popup_inner\">\n\t\t\t\t\t\t\t<div class=\"adm-security-popup_inner-title\">\n\t\t\t\t\t\t\t\t${this.subtitle || this.getSubtitle()} \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"adm-security-popup_info\">\n\t\t\t\t\t\t\t\t${this.text || this.getPopupInfo()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetSubtitle(): ?string\n\t{\n\t\treturn this.isSuccess ? Loc.getMessage('SEC_WWALL_POPUP_ATTACK_TITLE')\n\t\t\t: (this.isPortal ? Loc.getMessage('SEC_WWALL_POPUP_WARNING_TITLE_CP') : Loc.getMessage('SEC_WWALL_POPUP_WARNING_TITLE'));\n\t}\n\n\tgetPopupInfo(): ?string\n\t{\n\t\treturn this.isSuccess ? Loc.getMessage('SEC_WWALL_POPUP_ATTACK_CONTENT')\n\t\t\t: (this.isPortal ? Loc.getMessage('SEC_WWALL_POPUP_WARNING_CONTENT_CP') : Loc.getMessage('SEC_WWALL_POPUP_WARNING_CONTENT'));\n\t}\n\n\tsetButtons()\n\t{\n\t\tif (this.buttons)\n\t\t{\n\t\t\treturn this.createCustomButtons();\n\t\t}\n\n\t\treturn this.createDefaultButtons();\n\t}\n\n\tcreateDefaultButtons(): [Button, Button]\n\t{\n\t\treturn [\n\t\t\tnew Button({\n\t\t\t\ttext: this.isSuccess ? Loc.getMessage('SEC_WWALL_POPUP_ACTION_OPEN') : Loc.getMessage('SEC_WWALL_POPUP_ACTION_UPDATE'),\n\t\t\t\tclassName: this.isSuccess ? 'adm-security-popup-btn-accept' : 'adm-security-popup-btn-refresh',\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tdocument.location.href = '/bitrix/admin/update_system.php';\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t\tnew Button({\n\t\t\t\ttext: this.isSuccess ? Loc.getMessage('SEC_WWALL_POPUP_ACTION_CONTINUE') : Loc.getMessage('SEC_WWALL_POPUP_ACTION_IGNORE'),\n\t\t\t\tclassName: 'adm-security-popup-btn-close',\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}),\n\t\t];\n\t}\n\n\tcreateCustomButtons()\n\t{\n\t\tconst buttons = [];\n\t\tif (this.buttons.primary)\n\t\t{\n\t\t\tbuttons.push(\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: this.buttons.primary.text,\n\t\t\t\t\tclassName: this.setButtonStyle(this.buttons.primary.type),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tif (this.buttons.primary.onclick)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.buttons.primary.onclick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\tif (this.buttons.secondary)\n\t\t{\n\t\t\tbuttons.push(\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: this.buttons.secondary.text,\n\t\t\t\t\tclassName: this.setButtonStyle(this.buttons.secondary.type),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tif (this.buttons.secondary.onclick)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.buttons.secondary.onclick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\tsetButtonStyle(type): string\n\t{\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'accept':\n\t\t\t\treturn 'adm-security-popup-btn-accept';\n\t\t\tcase 'refresh':\n\t\t\t\treturn 'adm-security-popup-btn-refresh';\n\t\t\tcase 'close':\n\t\t\tdefault:\n\t\t\t\treturn 'adm-security-popup-btn-close';\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.popup = new Popup({\n\t\t\tclassName: 'adm-security-popup',\n\t\t\tcloseIcon: this.closeIcon,\n\t\t\tcontentBackground: 'transparent',\n\t\t\toverlay: true,\n\t\t\tminWidth: 500,\n\t\t\tcontent: this.getContent(),\n\t\t\tbuttons: this.setButtons(),\n\t\t\tevents: {\n\t\t\t\tonPopupClose() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t},\n\t\t\t\tonPopupDestroy() {\n\t\t\t\t\tthis.popup = null;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tthis.popup.show();\n\t}\n\n\tclose()\n\t{\n\t\tthis.popup.close();\n\t}\n}\n"],"names":["WwallPopup","constructor","options","colorTheme","title","subtitle","text","isToolTipShow","Type","isBoolean","closeIcon","isSuccess","cache","Cache","MemoryCache","buttons","getTitleWrapper","remember","Tag","render","getTitle","Loc","getMessage","toolTip","getTooltip","getContent","getSubtitle","getPopupInfo","isPortal","setButtons","createCustomButtons","createDefaultButtons","Button","className","events","click","document","location","href","close","primary","push","setButtonStyle","type","onclick","secondary","show","popup","Popup","contentBackground","overlay","minWidth","content","onPopupClose","destroy","onPopupDestroy"],"mappings":"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"}