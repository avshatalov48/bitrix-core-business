{"version":3,"file":"sectioninterface.bundle.js","sources":["../src/editform.js","../src/trackingusersform.js","../src/trackinggroupsform.js","../src/trackingtypesform.js","../src/sectioninterface.js"],"sourcesContent":["import { Runtime, Dom, Event, Loc, Text, Type, Tag } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {EventEmitter} from 'main.core.events';\nimport {Dialog as EntitySelectorDialog} from 'ui.entity-selector';\n\n\nexport class EditForm extends EventEmitter\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface.EditForm');\n\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.sectionAccessTasks = options.sectionAccessTasks;\n\t\tthis.sectionManager = options.sectionManager;\n\t\tthis.closeCallback = options.closeCallback;\n\t\tthis.BX = Util.getBX();\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow(params = {})\n\t{\n\t\tthis.section = params.section;\n\t\tthis.create();\n\t\tthis.showAccess = params.showAccess !== false;\n\t\tthis.allowChangeName = params.allowChangeName !== false;\n\t\tif (this.showAccess)\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = '';\n\t\t\tthis.DOM.accessWrap.style.display = '';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.accessLink.style.display = 'none';\n\t\t\tthis.DOM.accessWrap.style.display = 'none';\n\t\t}\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\n\t\tif (params.section)\n\t\t{\n\t\t\tif (params.section.color)\n\t\t\t{\n\t\t\t\tthis.setColor(params.section.color);\n\t\t\t}\n\n\t\t\tthis.setAccess(params.section.access || params.section.data.ACCESS || {});\n\n\t\t\tif (params.section.name)\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.value = params.section.name;\n\t\t\t}\n\t\t}\n\n\t\tif (this.allowChangeName)\n\t\t{\n\t\t\tBX.focus(this.DOM.sectionTitleInput);\n\t\t\tif (this.DOM.sectionTitleInput.value !== '')\n\t\t\t{\n\t\t\t\tthis.DOM.sectionTitleInput.select();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.DOM.sectionTitleInput, '--disabled');\n\t\t\tthis.DOM.sectionTitleInput.disabled = true;\n\t\t}\n\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tthis.isOpenedState = false;\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tthis.wrap = this.DOM.outerWrap.querySelector('.calendar-form-content');\n\n\t\tif (this.wrap)\n\t\t{\n\t\t\tDom.clean(this.wrap);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.wrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-form-content'}}));\n\t\t}\n\n\t\tthis.DOM.formFieldsWrap = this.wrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(\n\t\t\t\tDom.create(\n\t\t\t\t\t'DIV',\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: {className: 'calendar-list-slider-widget-content-block'}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t// Title\n\t\tthis.DOM.sectionTitleInput = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-field-container calendar-field-container-string'}\n\t\t\t\t}\n\t\t\t)\n\t\t)\n\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-field-block'}}))\n\t\t\t.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {type: 'text', placeholder: Loc.getMessage('EC_SEC_SLIDER_SECTION_TITLE')},\n\t\t\t\tprops: {className: 'calendar-field calendar-field-string'}\n\t\t\t}));\n\n\t\tthis.DOM.optionsWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-list-slider-new-calendar-options-container'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.initSectionColorSelector();\n\n\t\tthis.initAccessController();\n\n\t\t// Buttons\n\t\tthis.buttonsWrap = this.DOM.formFieldsWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-list-slider-btn-container'}}));\n\n\t\tthis.saveBtn = new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_SAVE'),\n\t\t\tclassName: 'ui-btn ui-btn-success',\n\t\t\tevents: {click: this.save.bind(this)}\n\t\t});\n\t\tthis.saveBtn.renderTo(this.buttonsWrap);\n\n\t\tnew BX.UI.Button({\n\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_CANCEL'),\n\t\t\tclassName: 'ui-btn ui-btn-link',\n\t\t\tevents: {click: this.checkClose.bind(this)}\n\t\t}).renderTo(this.buttonsWrap);\n\n\t\tthis.isCreated = true;\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.checkClose();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckClose()\n\t{\n\t\tthis.close();\n\t}\n\n\tsave()\n\t{\n\t\tthis.saveBtn.setWaiting(true);\n\t\tthis.sectionManager.saveSection(\n\t\t\tthis.DOM.sectionTitleInput.value,\n\t\t\tthis.color,\n\t\t\tthis.access,\n\t\t\t{section: this.section}\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tthis.saveBtn.setWaiting(false);\n\t\t\t\tthis.close();\n\t\t\t});\n\t}\n\n\tinitSectionColorSelector()\n\t{\n\t\tthis.DOM.colorContWrap = this.DOM.optionsWrap.appendChild(Dom.create('DIV', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_COLOR')\n\t\t}));\n\t\tthis.colorIcon = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-selected' }\n\t\t}));\n\t\tthis.colorChangeLink = this.DOM.colorContWrap.appendChild(Dom.create('SPAN', {\n\t\t\tprops: { className: 'calendar-list-slider-new-calendar-option-color-change' },\n\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_CHANGE')\n\t\t}));\n\t\t\n\t\tEvent.bind(this.colorIcon, 'click', this.showSimplePicker.bind(this));\n\t\tEvent.bind(this.colorChangeLink, 'click', this.showSimplePicker.bind(this));\n\t}\n\n\tshowSimplePicker(value)\n\t{\n\t\tconst colors = Runtime.clone(Util.getDefaultColorList(), true);\n\t\tconst innerCont = Dom.create(\n\t\t\t'DIV',\n\t\t\t{\n\t\t\t\tprops: {className: 'calendar-simple-color-wrap calendar-field-container-colorpicker-square'}\n\t\t\t}\n\t\t);\n\t\tconst colorWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\t\tevents: {click: BX.delegate(this.simplePickerClick, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLinkWrap = innerCont.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'DIV',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link-wrap'}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tconst moreLink = moreLinkWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t'SPAN',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-simple-color-more-link'},\n\t\t\t\t\thtml: Loc.getMessage('EC_COLOR'),\n\t\t\t\t\tevents: {click: BX.delegate(this.showFullPicker, this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.simplePickerColorWrap = colorWrap;\n\t\tthis.colors = [];\n\n\t\tif (!colors.includes(this.color))\n\t\t{\n\t\t\tcolors.push(this.color);\n\t\t}\n\n\t\tfor (let i = 0; i < colors.length; i++)\n\t\t{\n\t\t\tthis.colors.push({\n\t\t\t\tcolor: colors[i],\n\t\t\t\tnode: colorWrap.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-field-colorpicker-color-item'},\n\t\t\t\t\tstyle: {backgroundColor: colors[i]},\n\t\t\t\t\tattrs: {'data-bx-calendar-color': colors[i]},\n\t\t\t\t\thtml: '<span class=\"calendar-field-colorpicker-color\"></span>'\n\t\t\t\t}))\n\t\t\t});\n\t\t}\n\n\t\tthis.lastActiveNode = this.colors[BX.util.array_search(this.color, colors) || 0].node;\n\t\tDom.addClass(this.lastActiveNode, 'active');\n\n\t\tthis.simpleColorPopup = BX.PopupWindowManager.create(\n\t\t\t\"simple-color-popup-\" + Util.getRandomInt(),\n\t\t\tthis.colorIcon,\n\t\t\t{\n\t\t\t\t//zIndex: this.zIndex,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 9,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: innerCont,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.simpleColorPopup.setAngle({offset: 10});\n\t\tthis.simpleColorPopup.show(true);\n\t}\n\n\tsimplePickerClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tconst value = target.getAttribute('data-bx-calendar-color');\n\t\t\tif(value !== null)\n\t\t\t{\n\t\t\t\tif (this.lastActiveNode)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.lastActiveNode, 'active');\n\t\t\t\t}\n\n\t\t\t\tDom.addClass(target, 'active');\n\t\t\t\tthis.lastActiveNode = target;\n\t\t\t\tthis.setColor(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFullPicker()\n\t{\n\t\tif (this.simpleColorPopup)\n\t\t{\n\t\t\tthis.simpleColorPopup.close();\n\t\t}\n\n\t\tif (!this.fullColorPicker)\n\t\t{\n\t\t\tthis.fullColorPicker = new BX.ColorPicker({\n\t\t\t\tbindElement: this.colorIcon,\n\t\t\t\tonColorSelected: BX.delegate(function(color){\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t}, this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupClose:BX.delegate(function(){\n\t\t\t\t\t\t}, this)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.fullColorPicker.open();\n\t}\n\n\tsetColor(value)\n\t{\n\t\tthis.colorIcon.style.backgroundColor = value;\n\t\tthis.color = value;\n\t}\n\n\tsetAccess(value)\n\t{\n\t\tlet rowsCount = 0;\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\trowsCount++;\n\t\t\t}\n\t\t}\n\t\tthis.accessRowsCount = rowsCount;\n\t\tthis.access = value;\n\n\t\tfor (let code in value)\n\t\t{\n\t\t\tif (value.hasOwnProperty(code))\n\t\t\t{\n\t\t\t\tthis.insertAccessRow(Util.getAccessName(code), code, value[code]);\n\t\t\t}\n\t\t}\n\t\tthis.checkAccessTableHeight();\n\t}\n\n\tinitAccessController()\n\t{\n\t\tthis.buildAccessController();\n\t\tif (this.sectionManager && this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\tthis.initDialogGroup();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.initDialogStandard();\n\t\t}\n\t\tthis.initAccessSelectorPopup();\n\t}\n\n\tinitAccessSelectorPopup()\n\t{\n\t\tEvent.bind(this.DOM.accessWrap, 'click', (e) => {\n\t\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\t\tif (Type.isElementNode(target))\n\t\t\t{\n\t\t\t\tif (target.getAttribute('data-bx-calendar-access-selector') !== null)\n\t\t\t\t{\n\t\t\t\t\t// show selector\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-selector');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showAccessSelectorPopup({\n\t\t\t\t\t\t\t\tnode: this.accessControls[code].removeIcon,\n\t\t\t\t\t\t\t\tsetValueCallback: (value) => {\n\t\t\t\t\t\t\t\t\tif (this.accessTasks[value] && this.accessControls[code])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.accessControls[code].valueNode.innerHTML =\n\t\t\t\t\t\t\t\t\t\t\tText.encode(this.accessTasks[value].title);\n\t\t\t\t\t\t\t\t\t\tthis.access[code] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target.getAttribute('data-bx-calendar-access-remove') !== null)\n\t\t\t\t{\n\t\t\t\t\tconst code = target.getAttribute('data-bx-calendar-access-remove');\n\t\t\t\t\tif (this.accessControls[code])\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.remove(this.accessControls[code].rowNode);\n\t\t\t\t\t\tthis.accessControls[code] = null;\n\t\t\t\t\t\tdelete this.access[code];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tbuildAccessController()\n\t{\n\t\tthis.DOM.accessLink = this.DOM.optionsWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-new-calendar-option-more\">${Loc.getMessage('EC_SEC_SLIDER_ACCESS')}</div>`,\n\t\t);\n\n\t\tthis.DOM.accessWrap = this.DOM.formFieldsWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-access-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-access-inner-wrap\">\n\t\t\t\t\t\t${this.DOM.accessTable = Tag.render`\n\t\t\t\t\t\t\t<table class=\"calendar-section-slider-access-table\"></table>\n\t\t\t\t\t\t`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-list-slider-new-calendar-options-container\">\n\t\t\t\t\t\t${this.DOM.accessButton = Tag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-new-calendar-option-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ACCESS_ADD')}\n\t\t\t\t\t\t\t</span>`\n\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,\n\t\t);\n\n\t\tthis.accessControls = {};\n\t\tthis.accessTasks = this.sectionAccessTasks;\n\n\t\tEvent.bind(this.DOM.accessLink, 'click', () => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(this.DOM.accessWrap, 'shown');\n\t\t\t}\n\t\t\tthis.checkAccessTableHeight();\n\t\t});\n\t}\n\n\tinitDialogStandard()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\tinitDialogGroup()\n\t{\n\t\tEvent.bind(this.DOM.accessButton, 'click', () => {\n\t\t\tthis.entitySelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.accessButton,\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: [],\n\t\t\t\tenableSearch: true,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleEntitySelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: { selectMode: 'usersAndDepartments' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'meta-user',\n\t\t\t\t\t\toptions: { 'all-users': true },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttabs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'groupAccess',\n\t\t\t\t\t\ttitle: this.sectionManager.ownerName,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'A',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_ADMIN'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'E',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MODERATORS'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'SG' + this.sectionManager.ownerId + '_' + 'K',\n\t\t\t\t\t\tentityId: 'group',\n\t\t\t\t\t\ttabs: 'groupAccess',\n\t\t\t\t\t\ttitle: Loc.getMessage('EC_ACCESS_GROUP_MEMBERS'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.entitySelectorDialog.show();\n\t\t});\n\t}\n\n\thandleEntitySelectorChanges()\n\t{\n\t\tconst entityList = this.entitySelectorDialog.getSelectedItems();\n\t\tthis.entitySelectorDialog.hide();\n\t\tif (Type.isArray(entityList))\n\t\t{\n\t\t\tentityList.forEach((entity) => {\n\t\t\t\tlet title;\n\t\t\t\tif (entity.entityId === 'group')\n\t\t\t\t{\n\t\t\t\t\ttitle = this.sectionManager.ownerName + ': ' + entity.title.text;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = entity.title.text;\n\t\t\t\t}\n\t\t\t\tconst code = Util.convertEntityToAccessCode(entity);\n\t\t\t\tUtil.setAccessName(code, title);\n\t\t\t\tthis.insertAccessRow(title, code);\n\t\t\t});\n\t\t}\n\n\t\tRuntime.debounce(() => {\n\t\t\tthis.entitySelectorDialog.destroy();\n\t\t}, 400)();\n\t}\n\n\t// todo: refactor it\n\tinsertAccessRow(title, code, value)\n\t{\n\t\tif (!this.accessControls[code])\n\t\t{\n\t\t\tif (value === undefined)\n\t\t\t{\n\t\t\t\tfor(let taskId in this.sectionAccessTasks)\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.sectionAccessTasks.hasOwnProperty(taskId)\n\t\t\t\t\t\t&& this.sectionAccessTasks[taskId].name === 'calendar_view'\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue = taskId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst\n\t\t\t\trowNode = Dom.adjust(this.DOM.accessTable.insertRow(-1), {props : {className: 'calendar-section-slider-access-table-row'}}),\n\t\t\t\ttitleNode = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\thtml: '<span class=\"calendar-section-slider-access-title\">' + Text.encode(title) + ':</span>'}),\n\t\t\t\tvalueCell = Dom.adjust(rowNode.insertCell(-1), {\n\t\t\t\t\tprops : {className: 'calendar-section-slider-access-table-cell'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-selector': code}\n\t\t\t\t}),\n\t\t\t\tselectNode = valueCell.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-container'}\n\t\t\t\t})),\n\t\t\t\tvalueNode = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\ttext: this.accessTasks[value] ? this.accessTasks[value].title : '',\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-value'}\n\t\t\t\t})),\n\t\t\t\tremoveIcon = selectNode.appendChild(Dom.create('SPAN', {\n\t\t\t\t\tprops: {className: 'calendar-section-slider-access-remove'},\n\t\t\t\t\tattrs: {'data-bx-calendar-access-remove': code}\n\t\t\t\t}));\n\n\t\t\tthis.access[code] = value;\n\n\t\t\tthis.accessControls[code] = {\n\t\t\t\trowNode: rowNode,\n\t\t\t\ttitleNode: titleNode,\n\t\t\t\tvalueNode: valueNode,\n\t\t\t\tremoveIcon: removeIcon\n\t\t\t};\n\t\t}\n\t}\n\n\tcheckAccessTableHeight()\n\t{\n\t\tif (this.checkTableTimeout)\n\t\t{\n\t\t\tthis.checkTableTimeout = clearTimeout(this.checkTableTimeout);\n\t\t}\n\n\t\tthis.checkTableTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.accessWrap, 'shown'))\n\t\t\t{\n\t\t\t\tif (this.DOM.accessWrap.offsetHeight - this.DOM.accessTable.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.accessWrap.style.maxHeight = parseInt(this.DOM.accessTable.offsetHeight) + 100 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.accessWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n\n\tshowAccessSelectorPopup(params)\n\t{\n\t\tif (\n\t\t\tthis.accessPopupMenu\n\t\t\t&& this.accessPopupMenu.popupWindow\n\t\t\t&& this.accessPopupMenu.popupWindow.isShown()\n\t\t)\n\t\t{\n\t\t\treturn this.accessPopupMenu.close();\n\t\t}\n\n\t\tconst _this = this;\n\t\tconst menuItems = [];\n\n\t\tfor(let taskId in this.accessTasks)\n\t\t{\n\t\t\tif (this.accessTasks.hasOwnProperty(taskId))\n\t\t\t{\n\t\t\t\tmenuItems.push(\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.accessTasks[taskId].title,\n\t\t\t\t\t\tonclick: (function (value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn function ()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tparams.setValueCallback(value);\n\t\t\t\t\t\t\t\t_this.accessPopupMenu.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})(taskId)\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.accessPopupMenu = this.BX.PopupMenu.create(\n\t\t\t'section-access-popup' + Util.randomInt(),\n\t\t\tparams.node,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.accessPopupMenu.show();\n\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Runtime, Dom, Event, Loc, Type, Tag, Text} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\nimport { Dialog, TagSelector } from 'ui.entity-selector';\n\nexport class TrackingUsersForm\n{\n\tDOM = {};\n\tisCreated = false;\n\n\tconstructor(options = {})\n\t{\n\t\tthis.interfaceType = 'users';\n\t\tthis.DOM.outerWrap = options.wrap;\n\t\tthis.trackingUsers = options.trackingUsers || [];\n\t\tthis.trackingUserIdList = this.trackingUsers.map((item) => {\n\t\t\treturn parseInt(item.ID)\n\t\t});\n\n\t\tthis.CHECKED_CLASS = 'calendar-list-slider-item-checkbox-checked';\n\t\tthis.selectorId = 'add-tracking' + Util.getRandomInt();\n\t\tthis.closeCallback = options.closeCallback;\n\n\t\tthis.superposedSections = Type.isArray(options.superposedSections) ? options.superposedSections : [];\n\t\tthis.selected = {};\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tthis.selected[section.id] = true;\n\t\t}, this);\n\n\t\tthis.isCreated = false;\n\t\tthis.keyHandlerBinded = this.keyHandler.bind(this);\n\t}\n\n\tshow()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t\tthis.checkInnerWrapHeight();\n\n\t\tEvent.bind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.updateSectionList();\n\n\t\tthis.firstTrackingUserIdList = Runtime.clone(this.trackingUserIdList);\n\t\tthis.isOpenedState = true;\n\t}\n\n\tclose()\n\t{\n\t\tEvent.unbind(document, 'keydown', this.keyHandlerBinded);\n\n\t\tthis.isOpenedState = false;\n\t\tDom.removeClass(this.DOM.outerWrap, 'show');\n\t\tthis.DOM.outerWrap.style.cssText = '';\n\n\t\tif (Type.isFunction(this.closeCallback))\n\t\t{\n\t\t\tthis.closeCallback();\n\t\t}\n\t}\n\n\tisOpened()\n\t{\n\t\treturn this.isOpenedState;\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } })\n\t\t);\n\n\t\tthis.userTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingUsers.map((item) => {\n\t\t\t\t\treturn ['user', parseInt(item.ID)]\n\t\t\t\t}),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tthis.userTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tcreateButtons()\n\t{\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-btn-container\">\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-primary\"\n\t\t\t\t\tonclick=\"${this.save.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_SAVE')}</button>\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-link\"\n\t\t\t\t\tonclick=\"${this.close.bind(this)}\"\n\t\t\t\t>${Loc.getMessage('EC_SEC_SLIDER_CANCEL')}</button>\n\t\t\t</div>`\n\t\t);\n\t}\n\n\thandleUserSelectorChanges()\n\t{\n\t\tconst selectedItems = this.userTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingUserIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'user')\n\t\t\t{\n\t\t\t\tthis.trackingUserIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\t\tsections: this.prepareTrackingSections(),\n\t\t\t\t\ttype: this.interfaceType\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.close();\n\t}\n\n\tprepareTrackingSections()\n\t{\n\t\tlet sections = [];\n\t\tthis.superposedSections.forEach((section) => {\n\t\t\tif (\n\t\t\t\tthis.interfaceType === 'users'\n\t\t\t\t&& section.type === 'user'\n\t\t\t\t&& this.trackingUserIdList\n\t\t\t\t&& !this.trackingUserIdList.includes(section.ownerId)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsections.push(parseInt(section.id));\n\t\t\t}\n\t\t}, this);\n\n\t\tfor (let id in this.sectionIndex)\n\t\t{\n\t\t\tif (this.sectionIndex.hasOwnProperty(id) && this.sectionIndex[id].checkbox)\n\t\t\t{\n\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t{\n\t\t\t\t\tif (!sections.includes(parseInt(id)))\n\t\t\t\t\t{\n\t\t\t\t\t\tsections.push(parseInt(id));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (sections.includes(parseInt(id)))\n\t\t\t\t{\n\t\t\t\t\tsections = sections.filter((section) => {return parseInt(section) !== parseInt(id)});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sections;\n\t}\n\n\tupdateSectionList(delayExecution)\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tif (delayExecution !== false)\n\t\t{\n\t\t\tthis.updateSectionTimeout = setTimeout(() => {\n\t\t\t\tthis.updateSectionList(false);\n\t\t\t}, 300);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIdList: this.trackingUserIdList,\n\t\t\t\t\ttype: 'users'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t// Success\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\t// Users calendars\n\t\t\t\t\tresponse.data.users.forEach((user) => {\n\t\t\t\t\t\tconst sections = response.data.sections.filter(function(section)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn parseInt(section.OWNER_ID) === parseInt(user.ID);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t${Text.encode(user.FORMATTED_NAME)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`);\n\n\t\t\t\t\t\tif (sections.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\t\tsectionList: sections,\n\t\t\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tcreateSectionBlock(params = {})\n\t{\n\t\tlet result = false;\n\t\tif (Type.isArray(params.sectionList) && params.sectionList.length\n\t\t\t&& Type.isElementNode(params.wrap))\n\t\t{\n\t\t\tlet listWrap;\n\t\t\tparams.wrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${listWrap = Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tEvent.bind(listWrap, 'click', this.sectionClick.bind(this));\n\n\t\t\tparams.sectionList.forEach((section) => {\n\t\t\t\tconst id = section.ID.toString();\n\t\t\t\tlet checkbox;\n\n\t\t\t\tconst li = listWrap.appendChild(Tag.render`\n\t\t\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${id}\">\n\t\t\t\t\t\t${checkbox = Tag.render`\n\t\t\t\t\t\t\t<div class=\"calendar-list-slider-item-checkbox\" style=\"background: ${section.COLOR}\"></div>\n\t\t\t\t\t\t`}\n\t\t\t\t\t\t<div class=\"calendar-list-slider-item-name\">${Text.encode(section.NAME)}</div>\n\t\t\t\t\t</li>\n\t\t\t\t`);\n\n\t\t\t\tthis.sectionIndex[id] = {\n\t\t\t\t\titem: li,\n\t\t\t\t\tcheckbox: checkbox\n\t\t\t\t};\n\n\t\t\t\tif (\n\t\t\t\t\tthis.selected[id]\n\t\t\t\t\t|| !Type.isArray(this.firstTrackingUserIdList)\n\t\t\t\t\t|| !this.firstTrackingUserIdList.includes(parseInt(section.OWNER_ID))\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(checkbox, this.CHECKED_CLASS);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsectionClick(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (Type.isElementNode(target))\n\t\t{\n\t\t\tif(target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tconst id = target.getAttribute('data-bx-calendar-section');\n\t\t\t\tif (this.sectionIndex[id] && this.sectionIndex[id].checkbox)\n\t\t\t\t{\n\t\t\t\t\tif (Dom.hasClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS))\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.sectionIndex[id].checkbox, this.CHECKED_CLASS);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tkeyHandler(e)\n\t{\n\t\tif(e.keyCode === Util.getKeyCode('escape'))\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse if(e.keyCode === Util.getKeyCode('enter'))\n\t\t{\n\t\t\tthis.save();\n\t\t}\n\t}\n\n\tcheckInnerWrapHeight()\n\t{\n\t\tif (this.checkHeightTimeout)\n\t\t{\n\t\t\tthis.checkHeightTimeout = clearTimeout(this.checkHeightTimeout);\n\t\t}\n\n\t\tthis.checkHeightTimeout = setTimeout(() => {\n\t\t\tif (Dom.hasClass(this.DOM.outerWrap, 'show'))\n\t\t\t{\n\t\t\t\tif (this.DOM.outerWrap.offsetHeight - this.DOM.innerWrap.offsetHeight < 36)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.outerWrap.style.maxHeight = parseInt(this.DOM.innerWrap.offsetHeight) + 200 + 'px';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}, 300);\n\t}\n}\n\n\n\n\n\n\n\n\n","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { TagSelector } from 'ui.entity-selector';\nimport { TrackingUsersForm } from \"./trackingusersform\"\n\nexport class TrackingGroupsForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.interfaceType = 'groups';\n\t\tthis.trackingGroupIdList = options.trackingGroups || [];\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\tthis.selectorWrap = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create('DIV', { props: { className: 'calendar-list-slider-selector-wrap' } })\n\t\t);\n\n\t\tthis.groupTagSelector = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tcontext: 'CALENDAR',\n\t\t\t\tpreselectedItems: this.trackingGroupIdList.map((id) => {\n\t\t\t\t\treturn ['project', id];\n\t\t\t\t}),\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleGroupSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tthis.groupTagSelector.renderTo(this.selectorWrap);\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\thandleGroupSelectorChanges()\n\t{\n\t\tconst selectedItems = this.groupTagSelector.getDialog().getSelectedItems();\n\t\tthis.trackingGroupIdList = [];\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (item.entityId === 'project')\n\t\t\t{\n\t\t\t\tthis.trackingGroupIdList.push(item.id);\n\t\t\t}\n\t\t});\n\t\tthis.updateSectionList();\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tthis.checkInnerWrapHeight();\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tgroupIdList: this.trackingGroupIdList,\n\t\t\t\t\ttype: 'groups'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\t// Groups calendars\n\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n}","import { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { Util } from 'calendar.util';\nimport {TrackingUsersForm} from \"./trackingusersform\"\n\nexport class TrackingTypesForm extends TrackingUsersForm\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.trackingGroups = options.trackingGroups || [];\n\t\tthis.selectGroups = true;\n\t\tthis.selectUsers = false;\n\t\tthis.addLinkMessage = Loc.getMessage('EC_SEC_SLIDER_SELECT_GROUPS');\n\t}\n\n\tshow ()\n\t{\n\t\tif (!this.isCreated)\n\t\t{\n\t\t\tthis.create();\n\t\t}\n\n\t\tthis.updateSectionList();\n\t\tthis.isOpenedState = true;\n\t\tDom.addClass(this.DOM.outerWrap, 'show');\n\t}\n\n\tcreate()\n\t{\n\t\tif (!this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\t}\n\n\t\t// List of sections\n\t\tthis.sectionsWrap = this.DOM.innerWrap.appendChild(\n\t\t\tTag.render`<div class=\"calendar-list-slider-sections-wrap\"></div>`\n\t\t);\n\n\t\tthis.createButtons();\n\n\t\tthis.isCreated = true;\n\t}\n\n\tupdateSectionList()\n\t{\n\t\tif (this.updateSectionLoader)\n\t\t{\n\t\t\tDom.remove(this.updateSectionLoader);\n\t\t}\n\t\tthis.updateSectionLoader = this.sectionsWrap.appendChild(\n\t\t\tDom.adjust(Util.getLoader(), {style: {height: '140px'}})\n\t\t);\n\n\t\tif (this.updateSectionTimeout)\n\t\t{\n\t\t\tthis.updateSectionTimeout = clearTimeout(this.updateSectionTimeout);\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.getTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: 'company'\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tDom.clean(this.sectionsWrap);\n\t\t\t\t\tthis.sectionIndex = {};\n\t\t\t\t\tthis.checkInnerWrapHeight();\n\n\t\t\t\t\tif (Type.isArray(response.data.sections)\n\t\t\t\t\t\t&& response.data.sections.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.createSectionBlock({\n\t\t\t\t\t\t\tsectionList: response.data.sections,\n\t\t\t\t\t\t\twrap: this.sectionsWrap\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sectionsWrap.appendChild(Tag.render`\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NO_SECTIONS')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.checkInnerWrapHeight();\n\t}\n\n\tsave()\n\t{\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tsections: this.prepareTrackingSections()\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(response) => {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t},\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\n\t\tthis.close();\n\t}\n}\n\n\n\n\n\n\n\n\n","// @flow\nimport { Util } from 'calendar.util';\nimport { IcalSyncPopup } from 'calendar.sync.interface';\nimport { Dom, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuItem } from 'main.popup';\nimport { EditForm } from './editform';\nimport { TrackingUsersForm } from './trackingusersform';\nimport { TrackingGroupsForm } from './trackinggroupsform';\nimport { TrackingTypesForm } from './trackingtypesform';\nimport { SectionManager } from 'calendar.sectionmanager';\n\nexport class SectionInterface extends EventEmitter\n{\n\tname = 'sectioninterface';\n\tuid = null;\n\tDOM = {};\n\tSLIDER_WIDTH = 400;\n\tSLIDER_DURATION = 80;\n\tsliderId = \"calendar:section-slider\";\n\tdenyClose = false;\n\tdeletedSectionsIds = [];\n\n\tconstructor({calendarContext, readonly, sectionManager})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.SectionInterface');\n\t\tthis.sectionManager = sectionManager;\n\t\tthis.calendarContext = calendarContext;\n\t\tthis.readonly = readonly;\n\t\tthis.BX = Util.getBX();\n\t\tthis.deleteSectionHandlerBinded = this.deleteSectionHandler.bind(this);\n\t\tthis.refreshSectionListBinded = this.refreshSectionList.bind(this);\n\n\t\tif(this.calendarContext !== null)\n\t\t{\n\t\t\tif (this.calendarContext.util.config.accessNames)\n\t\t\t{\n\t\t\t\tUtil.setAccessNames(this.calendarContext?.util?.config?.accessNames);\n\t\t\t}\n\t\t}\n\t}\n\n\tshow()\n\t{\n\t\tthis.BX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: this.createContent.bind(this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION,\n\t\t\tevents: {\n\t\t\t\tonCloseByEsc: this.escHide.bind(this),\n\t\t\t\tonClose: this.hide.bind(this),\n\t\t\t\tonCloseComplete: this.destroy.bind(this),\n\t\t\t\tonLoad: this.onLoadSlider.bind(this)\n\t\t\t}\n\t\t});\n\n\t\tthis.addEventEmitterSubscriptions();\n\t}\n\n\taddEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\n\t\tthis.BX.Event.EventEmitter.subscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t}\n\n\tdestroyEventEmitterSubscriptions()\n\t{\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-delete',\n\t\t\tthis.deleteSectionHandlerBinded\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:edit',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t\tthis.BX.Event.EventEmitter.unsubscribe(\n\t\t\t'BX.Calendar.Section:pull-reload-data',\n\t\t\tthis.refreshSectionListBinded\n\t\t);\n\t}\n\n\tescHide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId && this.denyClose)\n\t\t{\n\t\t\tevent.denyAction();\n\t\t}\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.closeForms();\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\t\t}\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSlider && event.getSlider().getUrl() === this.sliderId)\n\t\t{\n\t\t\tthis.destroyEventEmitterSubscriptions();\n\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:delete', this.deleteSectionHandlerBinded);\n\t\t\tUtil.getBX().Event.EventEmitter.unsubscribe('BX.Calendar.Section:pull-delete', this.deleteSectionHandlerBinded);\n\n\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", BX.proxy(this.destroy, this));\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t\tdelete this.DOM.localSectionListWrap;\n\n\t\t\tthis.deletedSectionsIds = [];\n\n\t\t\tif (this.sectionActionMenu)\n\t\t\t{\n\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t}\n\t\t\tif (this.trackingTypesForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingTypesForm;\n\t\t\t}\n\t\t\tif (this.trackingUsersForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingUsersForm;\n\t\t\t}\n\t\t\tif (this.trackingGroupsForm)\n\t\t\t{\n\t\t\t\tdelete this.trackingGroupsForm;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateContent()\n\t{\n\t\tthis.DOM.outerWrap = Tag.render`\n\t\t\t<div class=\"calendar-list-slider-wrap\"></div>\n\t\t`;\n\t\tthis.DOM.titleWrap = this.DOM.outerWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-list-slider-title-container\">\n\t\t\t\t\t<div class=\"calendar-list-slider-title\"> \n\t\t\t\t\t\t${Loc.getMessage('EC_SECTION_BUTTON')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tif (calendarContext && !this.readonly)\n\t\t{\n\t\t\tthis.DOM.sectionFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tcalendarContext\n\t\t\t&& !this.readonly\n\t\t\t&&\n\t\t\t(\n\t\t\t\t!calendarContext.util.isUserCalendar()\n\t\t\t\t|| calendarContext.util.userIsOwner()\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t// #1. Controls\n\t\t\tthis.createAddButton();\n\n\t\t\t// #2. Forms\n\t\t\tthis.DOM.trackingGroupsFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t`\n\t\t\t);\n\t\t\tthis.DOM.trackingUsersFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`\n\t\t\t);\n\t\t\tthis.DOM.trackingTypesFormWrap = this.DOM.outerWrap.appendChild(\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget calendar-list-slider-form-wrap\">\n\t\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\n\t\t\t\t`\n\t\t\t);\n\t\t}\n\n\t\t// #3. List of sections\n\t\tthis.createSectionList();\n\n\t\treturn this.DOM.outerWrap;\n\t}\n\n\tonLoadSlider(event)\n\t{\n\t\tthis.slider = event.getSlider();\n\t\tthis.sliderId = this.slider.getUrl();\n\t\tthis.DOM.content = this.slider.layout.content;\n\t}\n\n\tcreateSectionList()\n\t{\n\t\tthis.sliderSections = this.sectionManager.getSections().filter(section => {\n\t\t\treturn !this.deletedSectionsIds.find(id => id === section.id);\n\t\t});\n\t\tif (Type.isElementNode(this.DOM.sectonListOuterWrap))\n\t\t{\n\t\t\tDom.remove(this.DOM.sectonListOuterWrap);\n\t\t}\n\t\tthis.DOM.sectonListOuterWrap = this.DOM.outerWrap.appendChild(Tag.render`<div></div>`);\n\t\tEvent.bind(this.DOM.sectonListOuterWrap, 'click', this.sectionClickHandler.bind(this));\n\n\t\tthis.createLocalSectionsList();\n\t\tthis.createExternalSectionsList();\n\t}\n\n\tcreateLocalSectionsList()\n\t{\n\t\tthis.DOM.localSectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\tthis.getSectionListWrap(this.getLocalSectionListTitle())\n\t\t);\n\n\t\tthis.createSectionsBlock({\n\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\tsectionList: this.sliderSections.filter(section => {\n\t\t\t\treturn (section.externalTypeIsLocal() && section.belongsToView()) || section.isPseudo();\n\t\t\t})\n\t\t});\n\n\t\tthis.createCompanySectionList();\n\t\tthis.createUsersSectionList();\n\t\tthis.createGroupsSectionList();\n\t}\n\n\tcreateExternalSectionsList()\n\t{\n\t\tconst externalSections = this.sliderSections.filter(section => {\n\t\t\treturn !section.externalTypeIsLocal() && section.belongsToView();\n\t\t});\n\n\t\tthis.DOM.extSectionListWrap = [];\n\n\t\texternalSections.forEach(section => {\n\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\n\t\t\tthis.createSectionUnit({\n\t\t\t\tsection: section,\n\t\t\t\twrap: listWrap\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSectionListWrapForSection(section)\n\t{\n\t\tlet sectionExternalType = section.getExternalType();\n\t\tif (section.isGoogle())\n\t\t{\n\t\t\tsectionExternalType = 'google';\n\t\t}\n\t\tif (section.data['IS_EXCHANGE'])\n\t\t{\n\t\t\tsectionExternalType = 'exchange';\n\t\t}\n\n\t\tconst sectionExternalConnection = SectionManager.getSectionExternalConnection(section, sectionExternalType);\n\t\tconst calendarContext = this.calendarContext || Util.getCalendarContext();\n\n\t\tsection.data.CAL_DAV_CON = sectionExternalConnection?.addParams?.id || null;\n\t\tlet key = sectionExternalType + (\n\t\t\tsectionExternalConnection\n\t\t\t\t? sectionExternalConnection.getId()\n\t\t\t\t: '-disconnected'\n\t\t);\n\n\t\tif (!Type.isElementNode(this.DOM.extSectionListWrap[key]))\n\t\t{\n\t\t\tconst sectionListWrap = this.DOM.sectonListOuterWrap.appendChild(\n\t\t\t\tthis.getSectionListWrap(this.getExternalConnectionBlockTitle(\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: sectionExternalType,\n\t\t\t\t\t\tconnection: sectionExternalConnection\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tsectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-widget-content\">\n\t\t\t\t\t<div class=\"calendar-list-slider-widget-content-block\">\n\t\t\t\t\t\t${this.DOM.extSectionListWrap[key] = Tag.render`<ul class=\"calendar-list-slider-container\"/>`}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tif (\n\t\t\t\t!sectionExternalConnection\n\t\t\t\t&& calendarContext\n\t\t\t\t&& calendarContext.util.userIsOwner()\n\t\t\t\t&& !section.isArchive()\n\t\t\t\t&& (section.isExchange() && !calendarContext.util.config.bExchange)\n\t\t\t)\n\t\t\t{\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-widget-content-block')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<div data-bx-calendar-open-sync=\"Y\" class=\"calendar-list-slider-card-widget-bottom-button\">\n\t\t\t\t\t\t\t\t<span class=\"calendar-list-slider-link\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_ADJUST_SYNC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>`\n\t\t\t\t\t);\n\n\t\t\t\tsectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(\n\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text calendar-list-title-disabled\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('EC_SEC_SLIDER_SYNC_DISABLED')}\n\t\t\t\t\t\t\t</span>`,\n\t\t\t\t\t);\n\t\t\t}\n\t\t\telse if (section.isArchive())\n\t\t\t{\n\t\t\t\tconst hintNode = sectionListWrap.querySelector('.calendar-list-slider-card-widget-title')\n\t\t\t\t\t.appendChild(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-icon ui-icon-common-question calendar-list-slider-archive-hint\"\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE_HELPER')}\">\n\t\t\t\t\t\t\t<i></i>\t\n\t\t\t\t\t\t</div>\n\t\t\t\t`);\n\t\t\t\tif (Type.isDomNode(hintNode))\n\t\t\t\t{\n\t\t\t\t\tUtil.initHintNode(hintNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.DOM.extSectionListWrap[key];\n\t}\n\n\tgetExternalConnectionBlockTitle({type, connection}): string\n\t{\n\t\tlet title = '';\n\t\tconst connectionName = connection\n\t\t\t? connection.getConnectionAccountName() || connection.getConnectionName()\n\t\t\t: null\n\t\t;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase 'google':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_GOOGLE',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_GOOGLE_DIS')\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'office365':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_OFFICE365',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_OFFICE365_DIS')\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'icloud':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_ICLOUD',\n\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ICLOUD_DIS')\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'caldav':\n\t\t\t\tif (connectionName)\n\t\t\t\t{\n\t\t\t\t\tif (connection.getType() === 'yandex')\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_YANDEX',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = Loc.getMessage(\n\t\t\t\t\t\t\t'EC_SEC_SLIDER_TYPE_CALDAV',\n\t\t\t\t\t\t\t{ '#CONNECTION_NAME#': connectionName }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'exchange':\n\t\t\t\ttitle = Loc.getMessage('EC_CAL_SYNC_EXCHANGE');\n\t\t\t\tbreak;\n\t\t\tcase 'archive':\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_ARCHIVE');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttitle = Loc.getMessage('EC_SEC_SLIDER_TYPE_DEFAULT')\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tcreateCompanySectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter(function(section)\n\t\t{\n\t\t\treturn section.isCompanyCalendar() && !section.belongsToView();\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">${Loc.getMessage('EC_SEC_SLIDER_TITLE_COMP_CAL')}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: this.sliderSections.filter(section => {\n\t\t\t\t\treturn section.isCompanyCalendar();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateUsersSectionList()\n\t{\n\t\tthis.calendarContext.util.getSuperposedTrackedUsers().forEach((user) => {\n\t\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\t\treturn !section.belongsToView()\n\t\t\t\t\t&& section.type === 'user'\n\t\t\t\t\t&& section.data.OWNER_ID === user.ID;\n\t\t\t});\n\n\t\t\tif (sections.length > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">${Text.encode(user.FORMATTED_NAME)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t`);\n\n\t\t\t\tthis.createSectionsBlock({\n\t\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\t\tsectionList: sections\n\t\t\t\t});\n\t\t\t}\n\t\t}, this);\n\t}\n\n\tcreateGroupsSectionList()\n\t{\n\t\tconst sections = this.sliderSections.filter((section) => {\n\t\t\treturn !section.belongsToView() && section.type === 'group';\n\t\t});\n\n\t\tif (sections.length > 0)\n\t\t{\n\t\t\tthis.DOM.localSectionListWrap.appendChild(Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-section-title\">\n\t\t\t\t\t<span class=\"calendar-list-slider-card-section-title-text\">${Loc.getMessage('EC_SEC_SLIDER_TITLE_GROUP_CAL')}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\n\t\t\tthis.createSectionsBlock({\n\t\t\t\twrap: this.DOM.localSectionListWrap,\n\t\t\t\tsectionList: sections\n\t\t\t});\n\t\t}\n\t}\n\n\tgetSectionListWrap(title)\n\t{\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-list-slider-card-widget\">\n\t\t\t\t\t<div class=\"calendar-list-slider-card-widget-title\">\n\t\t\t\t\t\t<span class=\"calendar-list-slider-card-widget-title-text\">\n\t\t\t\t\t\t\t${title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t}\n\n\tgetLocalSectionListTitle()\n\t{\n\t\tif (this.sectionManager.calendarType === 'user')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_MY_CALENDARS_LIST');\n\t\t}\n\t\telse if (this.sectionManager.calendarType === 'group')\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_GROUP_CALENDARS_LIST');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('EC_SEC_SLIDER_TYPE_CALENDARS_LIST');\n\t\t}\n\t}\n\n\tcreateAddButton()\n\t{\n\t\tif (\n\t\t\tthis.calendarContext.util.config.perm\n\t\t\t&& this.calendarContext.util.config.perm.edit_section\n\t\t)\n\t\t{\n\t\t\tconst addButtonOuter = this.DOM.titleWrap.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-split ui-btn-light-border\" style=\"margin-right: 0\"></span>\n\t\t\t`);\n\t\t\tthis.DOM.addButton = addButtonOuter.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-main\">${Loc.getMessage('EC_ADD')}</span>\n\t\t\t`);\n\t\t\tthis.DOM.addButtonMore = addButtonOuter.appendChild(Tag.render`\n\t\t\t\t<span class=\"ui-btn-extra\"></span>\n\t\t\t`);\n\n\t\t\tEvent.bind(this.DOM.addButtonMore, 'click', this.showAddButtonPopup.bind(this));\n\t\t\tEvent.bind(this.DOM.addButton, 'click', this.showEditSectionForm.bind(this));\n\t\t}\n\t}\n\n\tshowAddButtonPopup()\n\t{\n\t\tif (this.addBtnMenu && this.addBtnMenu.popupWindow && this.addBtnMenu.popupWindow.isShown())\n\t\t{\n\t\t\treturn this.addBtnMenu.close();\n\t\t}\n\n\t\tconst menuItems = [\n\t\t\t\tnew MenuItem({\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_TITLE'),\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}),\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_NEW_MENU'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showEditSectionForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnew MenuItem({\n\t\t\t\t\ttext: Loc.getMessage('EC_SEC_SLIDER_POPUP_EXIST_TITLE'),\n\t\t\t\t\tdelimiter: true\n\t\t\t\t}),\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_COMP'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingTypesForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_USER'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingUsersForm();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: Loc.getMessage('EC_SEC_SLIDER_POPUP_MENU_ADD_GROUP'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.addBtnMenu.close();\n\t\t\t\t\t\tthis.showTrackingGroupsForm();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t];\n\n\t\tthis.addBtnMenu = this.BX.PopupMenu.create(\n\t\t\t'add-btn-' + Util.getRandomInt(),\n\t\t\tthis.DOM.addButtonMore,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : true,\n\t\t\t\tzIndex: this.zIndex,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 15,\n\t\t\t\tangle: true,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.addBtnMenu.show();\n\t}\n\n\tcreateSectionsBlock({sectionList, wrap})\n\t{\n\t\tif (Type.isArray(sectionList))\n\t\t{\n\t\t\tconst listWrap = wrap.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<div class=\"calendar-list-slider-widget-content-block\"></div>`)\n\t\t\t\t.appendChild(Tag.render`<ul class=\"calendar-list-slider-container\"></ul>`)\n\t\t\t;\n\n\t\t\tsectionList.forEach((section) => {\n\t\t\t\tthis.createSectionUnit({section, wrap: listWrap});\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateSectionUnit({section, wrap})\n\t{\n\t\tif (!section.DOM)\n\t\t{\n\t\t\tsection.DOM = {};\n\t\t}\n\t\tconst sectionId = section.id.toString();\n\t\tconst li = wrap.appendChild(Tag.render`\n\t\t\t<li class=\"calendar-list-slider-item\" data-bx-calendar-section=\"${sectionId}\"></li>\n\t\t`);\n\t\tconst checkbox = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-checkbox ${section.isShown() ? 'calendar-list-slider-item-checkbox-checked' : ''}\" style=\"background-color: ${section.color}\"></div>\n\t\t`);\n\t\tconst title = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-name\" title=\"${Text.encode(section.name)}\">${Text.encode(section.name)}</div>\n\t\t`);\n\n\t\tsection.DOM.item = li;\n\t\tsection.DOM.checkbox = checkbox;\n\t\tsection.DOM.title = title;\n\n\t\tsection.DOM.actionCont = li.appendChild(Tag.render`\n\t\t\t<div class=\"calendar-list-slider-item-actions-container\" data-bx-calendar-section-menu=\"${sectionId}\">\n\t\t\t\t<span class=\"calendar-list-slider-item-context-menu\"></span>\n\t\t\t</div>\n\t\t`);\n\t}\n\n\tsectionClickHandler(e)\n\t{\n\t\tconst target = Util.findTargetNode(e.target || e.srcElement, this.DOM.outerWrap);\n\t\tif (target && target.getAttribute)\n\t\t{\n\t\t\tif (target.getAttribute('data-bx-calendar-section-menu') !== null)\n\t\t\t{\n\t\t\t\tlet sectionId = target.getAttribute('data-bx-calendar-section-menu');\n\t\t\t\tsectionId = sectionId === 'tasks' ? sectionId : parseInt(sectionId);\n\t\t\t\tthis.showSectionMenu(this.sectionManager.getSection(sectionId), target);\n\t\t\t}\n\t\t\telse if(target.getAttribute('data-bx-calendar-section') !== null)\n\t\t\t{\n\t\t\t\tthis.switchSection(this.sectionManager.getSection(target.getAttribute('data-bx-calendar-section')));\n\t\t\t}\n\t\t\telse if(target.getAttribute('data-bx-calendar-open-sync') !== null)\n\t\t\t{\n\t\t\t\tthis.calendarContext.syncInterface.openSyncPanel();\n\t\t\t}\n\t\t}\n\t}\n\n\tfindCheckBoxNodes(id)\n\t{\n\t\treturn this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t'.calendar-list-slider-item[data-bx-calendar-section=\\''\n\t\t\t+ id\n\t\t\t+ '\\'] .calendar-list-slider-item-checkbox'\n\t\t);\n\t}\n\n\tswitchSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id)\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\n\t\t// TODO: should use eventEmtter\n\t\tthis.calendarContext.reload();\n\t}\n\n\n\tswitchOnSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (!section.isShown())\n\t\t\t{\n\t\t\t\tDom.addClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (!section.isShown())\n\t\t{\n\t\t\tsection.show();\n\t\t}\n\t}\n\n\tswitchOffSection(section)\n\t{\n\t\tconst checkboxNodes = this.findCheckBoxNodes(section.id);\n\n\t\tfor (let i = 0; i < checkboxNodes.length; i++)\n\t\t{\n\t\t\tif (section.isShown())\n\t\t\t{\n\t\t\t\tDom.removeClass(checkboxNodes[i], 'calendar-list-slider-item-checkbox-checked');\n\t\t\t}\n\t\t}\n\n\t\tif (section.isShown())\n\t\t{\n\t\t\tsection.hide();\n\t\t}\n\t}\n\n\n\tshowSectionMenu (section, menuItemNode)\n\t{\n\t\tconst menuItems = [];\n\t\tconst itemNode = menuItemNode.closest('[data-bx-calendar-section]');\n\t\tif (Type.isElementNode(itemNode))\n\t\t{\n\t\t\tDom.addClass(itemNode, 'active');\n\t\t}\n\n\t\tif(section.canDo('view_time'))\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_LEAVE_ONE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showOnlyOneSection(section, this.sectionManager.sections);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!section.isPseudo() && section.getLink() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_OPEN_LINK'),\n\t\t\t\thref: section.getLink()\n\t\t\t});\n\t\t}\n\n\t\tif (!this.readonly && section.canDo('edit_section') && !section.isPseudo())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({section: section});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (section.isSuperposed() && !section.belongsToView())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideSuperposedHandler(section);\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (section.canBeConnectedToOutlook() && section.data['EXTERNAL_TYPE'] === 'local')\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_CONNECT_TO_OUTLOOK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.connectToOutlook();\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\t!section.isPseudo()\n\t\t\t&& section.data.EXPORT\n\t\t\t&& section.data.EXPORT.LINK\n\t\t\t&& section.data['EXTERNAL_TYPE'] === 'local'\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXPORT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\n\t\t\t\t\tconst options = {\n\t\t\t\t\t\tsectionLink: section.data.EXPORT.LINK,\n\t\t\t\t\t\tcalendarPath: this.calendarContext.util.config.path,\n\t\t\t\t\t};\n\t\t\t\t\tif (IcalSyncPopup.checkPathes(options))\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.createInstance(options).show();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tIcalSyncPopup.showPopupWithPathesError();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tlet provider = undefined;\n\t\tlet connection = undefined;\n\n\t\tif (section.data.CAL_DAV_CON\n\t\t\t&& section.belongsToView()\n\t\t\t&& this.calendarContext.syncInterface\n\t\t)\n\t\t{\n\t\t\t[provider, connection] = this.calendarContext.syncInterface.getProviderById(section.data.CAL_DAV_CON);\n\t\t}\n\n\t\tif (\n\t\t\tsection.canDo('edit_section')\n\t\t\t&& section.belongsToView()\n\t\t\t&& !section.isPseudo()\n\t\t\t&& ((!section.isGoogle() && !connection)\n\t\t\t\t|| section.data['EXTERNAL_TYPE'] === 'local'\n\t\t\t\t|| !connection\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_DELETE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tsection.remove();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (section.canDo('edit_section') && connection)\n\t\t{\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365() || section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_EXTERNAL_ADJUST'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tif (provider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprovider.openActiveConnectionSlider(connection);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (section.isGoogle() || section.isIcloud() || section.isOffice365())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tsection.hideSyncSection();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\telse if (section.isCalDav())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\ttext: Loc.getMessage('EC_ACTION_HIDE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\t\tsection.hideExternalCalendarSection();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (section.isPseudo() && section.taskSectionBelongToUser())\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage('EC_SEC_EDIT'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tthis.showEditSectionForm({\n\t\t\t\t\t\tsection: section\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext : Loc.getMessage('EC_SEC_TASK_HIDE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.sectionActionMenu.close();\n\t\t\t\t\tBX.userOptions.save('calendar', 'user_settings', 'showTasks', 'N');\n\n\t\t\t\t\tDom.addClass(section.DOM.item, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tDom.clean(section.DOM.item, true);\n\t\t\t\t\t\tBX.reload();\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (menuItems && menuItems.length > 0)\n\t\t{\n\t\t\tthis.sectionActionMenu = top.BX.PopupMenu.create(\n\t\t\t\t'section-menu-' + Util.getRandomInt(),\n\t\t\t\tmenuItemNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc : true,\n\t\t\t\t\tautoHide : true,\n\t\t\t\t\tzIndex: this.zIndex,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 9,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: false\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.sectionActionMenu.show();\n\t\t\tthis.sectionActionMenu.popupWindow.subscribe('onClose', ()=>{\n\t\t\t\tif (Type.isElementNode(itemNode))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(itemNode, 'active');\n\t\t\t\t}\n\t\t\t\tthis.allowSliderClose();\n\t\t\t});\n\n\t\t\tthis.denySliderClose();\n\t\t}\n\t}\n\n\tdenySliderClose()\n\t{\n\t\tthis.denyClose = true;\n\t}\n\n\tallowSliderClose()\n\t{\n\t\tthis.denyClose = false;\n\t}\n\n\tcloseForms()\n\t{\n\t\tif (this.addBtnMenu)\n\t\t{\n\t\t\tthis.addBtnMenu.close();\n\t\t}\n\n\t\tif (this.editSectionForm)\n\t\t{\n\t\t\tthis.editSectionForm.close();\n\t\t}\n\n\t\tif (this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm.close();\n\t\t}\n\n\t\tif (this.trackingGroupsForm)\n\t\t{\n\t\t\tthis.trackingGroupsForm.close();\n\t\t}\n\n\t\tif (this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm.close();\n\t\t}\n\t}\n\n\tshowEditSectionForm(params ={})\n\t{\n\t\tthis.closeForms();\n\t\tconst formTitleNode = this.DOM.sectionFormWrap.querySelector('.calendar-list-slider-card-widget-title-text');\n\n\t\tthis.editSectionForm = new EditForm({\n\t\t\twrap: this.DOM.sectionFormWrap,\n\t\t\tsectionAccessTasks: this.sectionManager.getSectionAccessTasks(),\n\t\t\tsectionManager: this.sectionManager,\n\t\t\tcloseCallback: () => {\n\t\t\t\tthis.allowSliderClose();\n\t\t\t}\n\t\t});\n\n\t\tlet showAccessControl = true;\n\t\tif (params.section && (!params.section.belongsToView() || params.section.isPseudo()))\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION_PERSONAL');\n\t\t\tshowAccessControl = false;\n\t\t}\n\t\telse if (params.section && params.section.id)\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_EDIT_SECTION');\n\t\t\tshowAccessControl = params.section.canDo('access');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tformTitleNode.innerHTML = Loc.getMessage('EC_SEC_SLIDER_NEW_SECTION');\n\t\t}\n\n\t\tthis.editSectionForm.show({\n\t\t\tshowAccess: showAccessControl,\n\t\t\tallowChangeName: params.section ? !params.section.isPrimaryForConnection() : true,\n\t\t\tsection: params.section || {\n\t\t\t\tcolor: Util.getRandomColor(),\n\t\t\t\taccess: this.sectionManager.getDefaultSectionAccess()\n\t\t\t}\n\t\t});\n\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingTypesForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingTypesForm)\n\t\t{\n\t\t\tthis.trackingTypesForm = new TrackingTypesForm({\n\t\t\t\twrap: this.DOM.trackingTypesFormWrap,\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingTypesForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingUsersForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingUsersForm)\n\t\t{\n\t\t\tthis.trackingUsersForm = new TrackingUsersForm({\n\t\t\t\twrap: this.DOM.trackingUsersFormWrap,\n\t\t\t\ttrackingUsers: this.calendarContext.util.getSuperposedTrackedUsers(),\n\t\t\t\tsuperposedSections: this.sectionManager.getSuperposedSectionList(),\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingUsersForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tshowTrackingGroupsForm()\n\t{\n\t\tthis.closeForms();\n\n\t\tif (!this.trackingGroupsForm)\n\t\t{\n\t\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\t\tconst trackingGroups = this.calendarContext.util.getSuperposedTrackedGroups();\n\n\t\t\tsuperposedSections.forEach((section) => {\n\t\t\t\tif (section.getType() === 'group'\n\t\t\t\t\t&& !trackingGroups.includes(section.getOwnerId()))\n\t\t\t\t{\n\t\t\t\t\ttrackingGroups.push(section.getOwnerId());\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.trackingGroupsForm = new TrackingGroupsForm({\n\t\t\t\twrap: this.DOM.trackingGroupsFormWrap,\n\t\t\t\ttrackingGroups: trackingGroups,\n\t\t\t\tsuperposedSections: superposedSections,\n\t\t\t\tcloseCallback: () => {\n\t\t\t\t\tthis.allowSliderClose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.trackingGroupsForm.show();\n\t\tthis.denySliderClose();\n\t}\n\n\tdeleteSectionHandler(event)\n\t{\n\t\tif (event && event instanceof this.BX.Event.BaseEvent)\n\t\t{\n\t\t\tconst data = event.getData();\n\t\t\tconst sectionId = parseInt(data.sectionId, 10);\n\n\t\t\tthis.sliderSections.forEach((section, index) => {\n\t\t\t\tif (parseInt(section.id) === sectionId)\n\t\t\t\t{\n\t\t\t\t\tthis.sectionManager.deleteSectionHandler(sectionId);\n\t\t\t\t\tthis.deletedSectionsIds.push(sectionId);\n\t\t\t\t\tconst deleteSectionNodes = this.DOM.sectonListOuterWrap.querySelectorAll(\n\t\t\t\t\t\t`.calendar-list-slider-item[data-bx-calendar-section='${sectionId}']`\n\t\t\t\t\t);\n\n\t\t\t\t\tdeleteSectionNodes.forEach(node => {\n\t\t\t\t\t\tDom.addClass(node, 'calendar-list-slider-item-disappearing');\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!section.externalTypeIsLocal())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst listWrap = this.getSectionListWrapForSection(section);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tdeleteSectionNodes.forEach(node => {\n\t\t\t\t\t\t\t\tDom.remove(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.sliderSections = BX.util.deleteFromArray(this.sliderSections, index);\n\n\t\t\t\t\t\t\tif(!listWrap.querySelector('li.calendar-list-slider-item'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.remove(listWrap.closest('.calendar-list-slider-card-widget'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.closeForms()\n\t\t}\n\t}\n\n\thideSuperposedHandler(section)\n\t{\n\t\tconst superposedSections = this.sectionManager.getSuperposedSectionList();\n\t\tconst sections = [];\n\t\tlet i;\n\n\t\tfor (i = 0; i < superposedSections.length; i++)\n\t\t{\n\t\t\tif (parseInt(section.id) !== parseInt(superposedSections[i].id))\n\t\t\t{\n\t\t\t\tsections.push(parseInt(superposedSections[i].id));\n\t\t\t}\n\t\t}\n\n\t\tBX.ajax.runAction('calendar.api.calendarajax.setTrackingSections', {\n\t\t\t\tdata: {\n\t\t\t\t\tsections: sections\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t// Success\n\t\t\t\t(response) => {\n\t\t\t\t\tBX.reload();\n\t\t\t\t},\n\t\t\t\t// Failure\n\t\t\t\t(response) => {\n\t\t\t\t\tUtil.displayError(response.errors);\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\trefreshSectionList()\n\t{\n\t\tthis.createSectionList();\n\t}\n\n\tshowOnlyOneSection(section, sections)\n\t{\n\t\tfor (let curSection of sections)\n\t\t{\n\t\t\tif(curSection.id === section.id)\n\t\t\t{\n\t\t\t\tthis.switchOnSection(curSection);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.switchOffSection(curSection);\n\t\t\t}\n\t\t}\n\n\t\tthis.calendarContext.reload();\n\t}\n}"],"names":["EditForm","EventEmitter","constructor","options","DOM","isCreated","setEventNamespace","outerWrap","wrap","sectionAccessTasks","sectionManager","closeCallback","BX","Util","getBX","keyHandlerBinded","keyHandler","bind","show","params","section","create","showAccess","allowChangeName","accessLink","style","display","accessWrap","Event","document","Dom","addClass","color","setColor","setAccess","access","data","ACCESS","name","sectionTitleInput","value","focus","select","disabled","isOpenedState","close","unbind","removeClass","Type","isFunction","isOpened","querySelector","clean","appendChild","props","className","formFieldsWrap","attrs","type","placeholder","Loc","getMessage","optionsWrap","initSectionColorSelector","initAccessController","buttonsWrap","saveBtn","UI","Button","text","events","click","save","renderTo","checkClose","e","keyCode","getKeyCode","setWaiting","saveSection","then","colorContWrap","html","colorIcon","colorChangeLink","showSimplePicker","colors","Runtime","clone","getDefaultColorList","innerCont","colorWrap","delegate","simplePickerClick","moreLinkWrap","moreLink","showFullPicker","simplePickerColorWrap","includes","push","i","length","node","backgroundColor","lastActiveNode","util","array_search","simpleColorPopup","PopupWindowManager","getRandomInt","autoHide","closeByEsc","offsetTop","offsetLeft","lightShadow","content","cacheable","setAngle","offset","target","findTargetNode","srcElement","isElementNode","getAttribute","fullColorPicker","ColorPicker","bindElement","onColorSelected","popupOptions","zIndex","onPopupClose","open","rowsCount","code","hasOwnProperty","accessRowsCount","insertAccessRow","getAccessName","checkAccessTableHeight","buildAccessController","calendarType","initDialogGroup","initDialogStandard","initAccessSelectorPopup","accessControls","showAccessSelectorPopup","removeIcon","setValueCallback","accessTasks","valueNode","innerHTML","Text","encode","title","remove","rowNode","Tag","render","accessTable","accessButton","hasClass","entitySelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","enableSearch","handleEntitySelectorChanges","targetContainer","body","entities","id","selectMode","tabs","ownerName","items","ownerId","entityId","entityList","getSelectedItems","hide","isArray","forEach","entity","convertEntityToAccessCode","setAccessName","debounce","destroy","undefined","taskId","adjust","insertRow","titleNode","insertCell","valueCell","selectNode","checkTableTimeout","clearTimeout","setTimeout","offsetHeight","maxHeight","parseInt","accessPopupMenu","popupWindow","isShown","_this","menuItems","onclick","PopupMenu","randomInt","angle","TrackingUsersForm","interfaceType","trackingUsers","trackingUserIdList","map","item","ID","CHECKED_CLASS","selectorId","superposedSections","selected","checkInnerWrapHeight","updateSectionList","firstTrackingUserIdList","cssText","innerWrap","selectorWrap","userTagSelector","TagSelector","dialogOptions","handleUserSelectorChanges","sectionsWrap","createButtons","selectedItems","getDialog","ajax","runAction","userIdList","sections","prepareTrackingSections","response","location","reload","displayError","errors","sectionIndex","checkbox","filter","delayExecution","updateSectionLoader","getLoader","height","updateSectionTimeout","users","user","OWNER_ID","FORMATTED_NAME","createSectionBlock","sectionList","result","listWrap","sectionClick","toString","li","COLOR","NAME","checkHeightTimeout","TrackingGroupsForm","trackingGroupIdList","trackingGroups","groupTagSelector","handleGroupSelectorChanges","groupIdList","TrackingTypesForm","selectGroups","selectUsers","addLinkMessage","SectionInterface","calendarContext","readonly","uid","SLIDER_WIDTH","SLIDER_DURATION","sliderId","denyClose","deletedSectionsIds","deleteSectionHandlerBinded","deleteSectionHandler","refreshSectionListBinded","refreshSectionList","config","accessNames","setAccessNames","SidePanel","Instance","contentCallback","createContent","width","animationDuration","onCloseByEsc","escHide","onClose","onCloseComplete","onLoad","onLoadSlider","addEventEmitterSubscriptions","subscribe","destroyEventEmitterSubscriptions","unsubscribe","event","getSlider","getUrl","denyAction","closeForms","removeCustomEvent","proxy","localSectionListWrap","sectionActionMenu","trackingTypesForm","trackingUsersForm","trackingGroupsForm","titleWrap","getCalendarContext","sectionFormWrap","isUserCalendar","userIsOwner","createAddButton","trackingGroupsFormWrap","trackingUsersFormWrap","trackingTypesFormWrap","createSectionList","slider","layout","sliderSections","getSections","find","sectonListOuterWrap","sectionClickHandler","createLocalSectionsList","createExternalSectionsList","getSectionListWrap","getLocalSectionListTitle","createSectionsBlock","externalTypeIsLocal","belongsToView","isPseudo","createCompanySectionList","createUsersSectionList","createGroupsSectionList","externalSections","extSectionListWrap","getSectionListWrapForSection","createSectionUnit","sectionExternalType","getExternalType","isGoogle","sectionExternalConnection","SectionManager","getSectionExternalConnection","CAL_DAV_CON","addParams","key","getId","sectionListWrap","getExternalConnectionBlockTitle","connection","isArchive","isExchange","bExchange","hintNode","isDomNode","initHintNode","connectionName","getConnectionAccountName","getConnectionName","getType","isCompanyCalendar","getSuperposedTrackedUsers","perm","edit_section","addButtonOuter","addButton","addButtonMore","showAddButtonPopup","showEditSectionForm","addBtnMenu","MenuItem","delimiter","showTrackingTypesForm","showTrackingUsersForm","showTrackingGroupsForm","sectionId","actionCont","showSectionMenu","getSection","switchSection","syncInterface","openSyncPanel","findCheckBoxNodes","querySelectorAll","checkboxNodes","switchOnSection","switchOffSection","menuItemNode","itemNode","closest","canDo","showOnlyOneSection","getLink","href","isSuperposed","hideSuperposedHandler","canBeConnectedToOutlook","connectToOutlook","EXPORT","LINK","sectionLink","calendarPath","path","IcalSyncPopup","checkPathes","createInstance","showPopupWithPathesError","provider","getProviderById","isIcloud","isOffice365","isCalDav","openActiveConnectionSlider","hideSyncSection","hideExternalCalendarSection","taskSectionBelongToUser","userOptions","top","allowSliderClose","denySliderClose","editSectionForm","formTitleNode","getSectionAccessTasks","showAccessControl","isPrimaryForConnection","getRandomColor","getDefaultSectionAccess","getSuperposedSectionList","getSuperposedTrackedGroups","getOwnerId","BaseEvent","getData","index","deleteSectionNodes","deleteFromArray","curSection"],"mappings":"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"}