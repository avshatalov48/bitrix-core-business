{"version":3,"file":"renderparts.bundle.js","sources":["../src/index.js"],"sourcesContent":["import {Type, Loc, Dom} from 'main.core';\nimport {CommentRenderer} from 'tasks.comment-renderer';\n\nexport class RenderParts\n{\n\tstatic currentUserSonetGroupIdList = [];\n\tstatic mobile: false;\n\tstatic publicSection: false;\n\tstatic currentExtranetUser: false;\n\tstatic availableUsersList: [];\n\n\tstatic init(params)\n\t{\n\t\tif (!Type.isUndefined(params.currentUserSonetGroupIdList))\n\t\t{\n\t\t\tthis.currentUserSonetGroupIdList = params.currentUserSonetGroupIdList;\n\t\t}\n\t\tif (!Type.isUndefined(params.publicSection))\n\t\t{\n\t\t\tthis.publicSection = !!params.publicSection;\n\t\t}\n\t\tthis.mobile = !!params.mobile;\n\n\t\tif (!Type.isUndefined(params.currentExtranetUser))\n\t\t{\n\t\t\tthis.currentExtranetUser = !!params.currentExtranetUser;\n\t\t}\n\n\t\tif (this.currentExtranetUser)\n\t\t{\n\t\t\tif (Type.isPlainObject(params.availableUsersList))\n\t\t\t{\n\t\t\t\tparams.availableUsersList = Object.entries(params.availableUsersList).map(([key, value]) => value);\n\t\t\t}\n\n\t\t\tif (Type.isArray(params.availableUsersList))\n\t\t\t{\n\t\t\t\tthis.availableUsersList = params.availableUsersList.map(value => parseInt(value)).filter(value => !Type.isNil(value));\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getNodeSG(entity)\n\t{\n\t\tconst hidden = (\n\t\t\tType.isStringFilled(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY === 'group_members'\n\t\t\t&& !this.currentUserSonetGroupIdList.includes(entity.ENTITY_ID)\n\t\t);\n\n\t\tif (hidden)\n\t\t{\n\t\t\treturn this.getNodeHiddenDestination();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn (\n\t\t\t\t!this.mobile\n\t\t\t\t\t? Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t\t\t: Dom.create('span', {\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getNodeU(entity)\n\t{\n\t\tconst hidden = (\n\t\t\tthis.currentExtranetUser\n\t\t\t&& !this.availableUsersList.includes(entity.ENTITY_ID)\n\t\t);\n\n\t\tif (hidden)\n\t\t{\n\t\t\treturn this.getNodeHiddenDestination();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst classesList = [\n\t\t\t\t'blog-p-user-name',\n\t\t\t];\n\n\t\t\tif (entity.VISIBILITY === 'extranet')\n\t\t\t{\n\t\t\t\tclassesList.push('blog-p-user-name-extranet');\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t!this.mobile\n\t\t\t\t\t? Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tclassName: classesList.join(' '),\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME\n\t\t\t\t\t})\n\t\t\t\t\t: Dom.create('a', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\tstatic getNodeDR(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeTask(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& typeof entity.VISIBILITY != 'undefined'\n\t\t\t&& typeof entity.VISIBILITY.userId != 'undefined'\n\t\t\t&& parseInt(entity.VISIBILITY.userId) == parseInt(Loc.getMessage('USER_ID'))\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodePost(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& Type.isPlainObject(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY.available === true\n\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank'\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeCalendarEvent(entity)\n\t{\n\t\treturn (\n\t\t\t!this.mobile\n\t\t\t&& !this.publicSection\n\t\t\t&& entity.LINK.length > 0\n\t\t\t&& Type.isPlainObject(entity.VISIBILITY)\n\t\t\t&& entity.VISIBILITY.available === true\n\t\t\t\t? Dom.create('a', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\thref: entity.LINK,\n\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t},\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t\t\t: Dom.create('span', {\n\t\t\t\t\ttext: entity.NAME,\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic getNodeUA()\n\t{\n\t\treturn Dom.create('span', {\n\t\t\ttext: Loc.getMessage('SONET_RENDERPARTS_JS_DESTINATION_ALL'),\n\t\t});\n\t}\n\n\tstatic getNodeHiddenDestination()\n\t{\n\t\treturn Dom.create('span', {\n\t\t\ttext: Loc.getMessage('SONET_RENDERPARTS_JS_HIDDEN'),\n\t\t});\n\t}\n\n\tstatic getTaskCommentPart(entity): string\n\t{\n\t\treturn CommentRenderer.getCommentPart(entity);\n\t}\n}\n"],"names":["RenderParts","params","Type","isUndefined","currentUserSonetGroupIdList","publicSection","mobile","currentExtranetUser","isPlainObject","availableUsersList","Object","entries","map","key","value","isArray","parseInt","filter","isNil","entity","hidden","isStringFilled","VISIBILITY","includes","ENTITY_ID","getNodeHiddenDestination","Dom","create","attrs","href","LINK","target","text","NAME","classesList","push","props","className","join","length","userId","Loc","getMessage","available","CommentRenderer","getCommentPart"],"mappings":"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"}