{"version":3,"file":"document-card.bundle.js","sources":["../src/configurator/store-document-field-configurator.js","../src/configurator/store-document-field-configurator-manager.js","../src/product-list/controller.js","../src/card/controller.js","../src/controllers-factory.js","../src/editor-fields/row-summary.js","../src/editor-fields/contractor.js","../src/editor-fields/fields-factory.js","../src/model/model.js","../src/model/model-factory.js","../src/card/card.js","../src/feedback/button.js","../src/feedback/slider.js"],"sourcesContent":["import { Reflection, Loc } from 'main.core';\n\nexport default class StoreDocumentFieldConfigurator extends BX.UI.EntityEditorFieldConfigurator\n{\n\tstatic create(id, settings): StoreDocumentFieldConfigurator\n\t{\n\t\tconst self: StoreDocumentFieldConfigurator = new this();\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n\n\tgetOptionContainer()\n\t{\n\t\tconst optionContainer = super.getOptionContainer();\n\t\tthis._isRequiredCheckBox = this.getField().getData().requiredIsEditable ? this.getIsRequiredCheckBox() : null;\n\n\t\treturn optionContainer;\n\t}\n\n\tonSaveButtonClick(): void\n\t{\n\t\tthis.getField().getSchemeElement()._isRequired = this._isRequiredCheckBox.checked;\n\t\tsuper.onSaveButtonClick();\n\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:catalog.store.document.detail',\n\t\t\t'changeRequired',\n\t\t\t{\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\tdocumentType: this.getEditor().getModel().getData().DOC_TYPE,\n\t\t\t\t\tfieldName: this.getField()._id,\n\t\t\t\t\trequired: this.getField().isRequired() ? 'Y' : 'N',\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n\n\tgetIsRequiredCheckBox()\n\t{\n\t\tconst checkBox = this.createOption({ caption: Loc.getMessage('UI_ENTITY_EDITOR_UF_REQUIRED_FIELD') });\n\t\tcheckBox.checked = this._field && this._field.isRequired();\n\n\t\treturn checkBox;\n\t}\n}\n\nReflection.namespace('BX.Catalog').StoreDocumentFieldConfigurator = StoreDocumentFieldConfigurator;\n","import StoreDocumentFieldConfigurator from './store-document-field-configurator';\nimport { Type } from 'main.core';\n\nexport default class StoreDocumentFieldConfigurationManager extends BX.UI.EntityConfigurationManager\n{\n\tgetSimpleFieldConfigurator(params, parent): StoreDocumentFieldConfigurator\n\t{\n\t\tlet typeId = '';\n\t\tconst field = Type.isObject(params.field) ? params.field : null;\n\t\tif (field)\n\t\t{\n\t\t\ttypeId = field.getType();\n\t\t\tfield.setVisible(false);\n\n\t\t\tlet userType = field.getSchemeElement().getData().userType;\n\t\t\tuserType = Type.isString(userType) ? userType : false;\n\t\t\tif (userType)\n\t\t\t{\n\t\t\t\ttypeId = userType;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttypeId = Type.isString(params.TypeId) ? params.TypeId : BX.UI.EntityUserFieldType.string;\n\t\t}\n\n\t\tthis._fieldConfigurator = StoreDocumentFieldConfigurator.create(\n\t\t\t'',\n\t\t\t{\n\t\t\t\teditor: this._editor,\n\t\t\t\tschemeElement: null,\n\t\t\t\tmodel: parent._model,\n\t\t\t\tmode: BX.UI.EntityEditorMode.edit,\n\t\t\t\tparent,\n\t\t\t\ttypeId,\n\t\t\t\tfield,\n\t\t\t\tmandatoryConfigurator: null,\n\t\t\t},\n\t\t);\n\n\t\treturn this._fieldConfigurator;\n\t}\n\n\tstatic create(id, settings): StoreDocumentFieldConfigurationManager\n\t{\n\t\tconst self: StoreDocumentFieldConfigurationManager = new this();\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n}\n","import {Loc} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentCard from \"../card/card\";\n\nexport default class ProductListController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._setProductListHandler = this.handleSetProductList.bind(this);\n\t\tthis._tabShowHandler = this.onTabShow.bind(this);\n\n\t\tthis._editorControlChangeHandler = this.onEditorControlChange.bind(this);\n\n\t\tthis._currencyId = this._model.getField('CURRENCY', '');\n\n\t\tEventEmitter.subscribe(this._editor, 'onControlChanged', this.onEditorControlChange.bind(this));\n\t\tEventEmitter.subscribe('DocumentProductListController', this._setProductListHandler);\n\t\tEventEmitter.subscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorList:onItemSelect', (event) => {\n\t\t\tconst [field, params] = event.data;\n\n\t\t\tif (field?.getId() === 'TOTAL_WITH_CURRENCY')\n\t\t\t{\n\t\t\t\tthis.changeCurrency(params.item.value);\n\t\t\t}\n\t\t});\n\t}\n\n\thandleSetProductList(event)\n\t{\n\t\tconst productList = event.getData()[0];\n\t\tthis.setProductList(productList);\n\t\tEventEmitter.unsubscribe('DocumentProductListController', this._setProductListHandler);\n\t}\n\n\treinitializeProductList()\n\t{\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.reloadGrid(false);\n\t\t}\n\t}\n\n\tonTabShow(event: BaseEvent)\n\t{\n\t\tconst [tab] = event.getData();\n\t\tif (tab.id === 'tab_products' && this.productList)\n\t\t{\n\t\t\tthis.productList.handleOnTabShow();\n\t\t\tEventEmitter.unsubscribe('onEntityDetailsTabShow', this._tabShowHandler);\n\t\t\tEventEmitter.emit('onDocumentProductListTabShow', this);\n\t\t}\n\t}\n\n\tinnerCancel()\n\t{\n\t\tthis.rollback();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.onInnerCancel();\n\t\t}\n\n\t\tthis._currencyId = this._model.getField('CURRENCY');\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t\tthis.productList.updateTotalUiCurrency();\n\t\t}\n\n\t\tthis._isChanged = false;\n\t}\n\n\tgetCurrencyId = function()\n\t{\n\t\treturn this._currencyId;\n\t}\n\n\tsetProductList(productList)\n\t{\n\t\tif (this.productList === productList)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.destroy();\n\t\t}\n\n\t\tthis.productList = productList;\n\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.setController(this);\n\t\t\tthis.productList.setForm(this._editor.getFormElement());\n\n\t\t\tif (this.productList.getCurrencyId() !== this.getCurrencyId())\n\t\t\t{\n\t\t\t\tthis.productList.changeCurrencyId(this.getCurrencyId());\n\t\t\t}\n\n\t\t\tthis._prevProductCount = this._curProductCount = this.productList.getProductCount();\n\t\t}\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\tif (this.productList)\n\t\t{\n\t\t\tthis.productList.removeFormFields();\n\t\t}\n\n\t\tthis._editor._toolPanel.showViewModeButtons();\n\t}\n\n\tproductChange(disableSaveButton = false)\n\t{\n\t\tdisableSaveButton = disableSaveButton ?? false;\n\t\tthis.markAsChanged();\n\n\t\tif (disableSaveButton)\n\t\t{\n\t\t\tthis.disableSaveButton();\n\t\t}\n\n\t\tEventEmitter.emit('onDocumentProductChange', this.productList.getProductsFields());\n\t}\n\n\tonBeforeSubmit()\n\t{\n\t\tif (this.productList && (this.isChanged() || this._editor.isNew()))\n\t\t{\n\t\t\tthis.productList.compileProductData();\n\t\t}\n\t}\n\n\tenableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.enableSaveButton();\n\t\t}\n\t}\n\n\tdisableSaveButton()\n\t{\n\t\tif (this._editor?._toolPanel)\n\t\t{\n\t\t\tthis._editor._toolPanel.disableSaveButton();\n\t\t}\n\t}\n\n\tonEditorControlChange(event: BaseEvent)\n\t{\n\t\tconst [field, params] = event.getData();\n\t\tif (field instanceof BX.UI.EntityEditorMoney && params?.fieldName === 'CURRENCY')\n\t\t{\n\t\t\tthis.changeCurrency(params.fieldValue);\n\t\t}\n\t}\n\n\tchangeCurrency(currencyValue)\n\t{\n\t\tthis._currencyId = currencyValue;\n\n\t\tif (this.productList && this._currencyId)\n\t\t{\n\t\t\tthis.productList.changeCurrencyId(this._currencyId);\n\t\t\tthis.markAsChanged();\n\t\t}\n\t}\n\n\tsetTotal(totalData)\n\t{\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), false),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'FORMATTED_TOTAL_WITH_CURRENCY',\n\t\t\tBX.Currency.currencyFormat(totalData.totalCost, this.getCurrencyId(), true),\n\t\t);\n\n\t\tthis._model.setField(\n\t\t\t'TOTAL',\n\t\t\ttotalData.totalCost,\n\t\t);\n\n\t\tconst totalCurrencyControl = this._editor.getControlById('TOTAL_WITH_CURRENCY');\n\t\tif (totalCurrencyControl instanceof BX.UI.EntityEditorMoney)\n\t\t{\n\t\t\ttotalCurrencyControl.refreshLayout();\n\t\t}\n\t}\n\n\tvalidateProductList()\n\t{\n\t\tlet errorsArray = this.productList.validate();\n\t\tif (errorsArray.length > 0)\n\t\t{\n\t\t\tthis._editor._toolPanel.addError(errorsArray[0]);\n\t\t\tEventEmitter.emit('onProductsCheckFailed', errorsArray);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}","import {EventEmitter} from 'main.core.events';\n\nexport default class DocumentCardController extends BX.UI.EntityEditorController\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t\tthis._model.lockField('TOTAL');\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis.#subscribeToEvents();\n\t}\n\n\t#subscribeToEvents()\n\t{\n\t\tthis.#subscribeToProductRowSummaryEvents();\n\t}\n\n\t#subscribeToProductRowSummaryEvents()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.UI.EntityEditorProductRowSummary:onDetailProductListLinkClick',\n\t\t\t() => {\n\t\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t\t\t}\n\t\t);\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.UI.EntityEditorProductRowSummary:onAddNewRowInProductList',\n\t\t\t() => {\n\t\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tEventEmitter.emit('onFocusToProductList');\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t)\n\n\t}\n\n\tonAfterSave()\n\t{\n\t\tsuper.onAfterSave();\n\t\twindow.top.BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\tlet sliders = BX.SidePanel.Instance.getOpenSliders();\n\t\tsliders.forEach((slider) => {\n\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t{\n\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onDocumentCardSave');\n\t\t\t}\n\t\t});\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events';\nimport ProductListController from \"./product-list/controller\";\nimport DocumentCardController from \"./card/controller\";\n\nexport default class ControllersFactory\n{\n\tconstructor(eventName)\n\t{\n\t\tEventEmitter.subscribe(eventName, (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['entityCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'document_card')\n\t\t{\n\t\t\treturn new DocumentCardController(controlId, settings);\n\t\t}\n\n\t\tif (type === 'catalog_store_document_product_list')\n\t\t{\n\t\t\treturn new ProductListController(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import {Loc} from 'main.core';\nimport {EventEmitter} from \"main.core.events\";\nimport {CurrencyCore} from \"currency.currency-core\";\n\n/**\n * @deprecated Use BX.UI.EntityEditorProductRowSummary instead\n */\nexport default class ProductRowSummary extends BX.UI.EntityEditorField\n{\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._loader = null;\n\t\tthis._productsContainer = null;\n\t\tthis._previousData = [];\n\n\t\tthis._itemCount = 0;\n\t\tthis._totalCount = 0;\n\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t\tthis._moreButtonClickHandler = BX.delegate(this._onMoreButtonClick, this);\n\n\t\tthis._visibleItemsLimit = 5;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tvar data = this.getValue();\n\n\t\tif(!BX.type.isPlainObject(data))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar title = this.getTitle();\n\t\tvar items = BX.prop.getArray(data, 'items', []);\n\n\t\tthis._totalCount = BX.prop.getInteger(data, 'count', 0);\n\n\t\tthis._itemCount = items.length;\n\t\tvar length = this._itemCount;\n\t\tvar maxLength = this._visibleItemsLimit;\n\t\tvar restLength = 0;\n\t\tif(\n\t\t\t(length > maxLength)\n\t\t)\n\t\t{\n\t\t\trestLength = (this._totalCount - maxLength);\n\t\t\tlength = maxLength;\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\t\tthis._productsContainer = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-list'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tfor (var i = 0; i < length; i++)\n\t\t{\n\t\t\tthis.addProductRow(items[i]);\n\t\t}\n\n\t\tthis._moreButton = null;\n\t\tif (restLength > 0)\n\t\t{\n\t\t\tthis.addMoreButton(restLength);\n\t\t}\n\t\tthis.addTotalRow(data['total']);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'catalog-entity-widget-content-block-products'},\n\t\t\t\t\tchildren: [this._productsContainer]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\taddMoreButton(restLength)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._moreButtonRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create(\"div\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tthis._moreButton = BX.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-show-more'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: this._moreButtonClickHandler\n\t\t\t\t},\n\t\t\t\ttext: Loc.getMessage('DOCUMENT_PRODUCTS_NOT_SHOWN', {'#COUNT#': restLength.toString()}),\n\t\t\t}\n\t\t);\n\t\tnameCell.appendChild(this._moreButton);\n\n\t\trow.appendChild(\n\t\t\tBX.create('div', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\taddTotalRow(total)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\t\tthis._totalsRow = row;\n\t\tthis._productsContainer.appendChild(row);\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t},\n\t\t\thtml: Loc.getMessage('DOCUMENT_PRODUCTS_TOTAL'),\n\t\t});\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t},\n\t\t\thtml: CurrencyCore.currencyFormat(total.amount, total.currency, true),\n\t\t});\n\t\trow.appendChild(valueCell);\n\t}\n\n\taddAddProductButton()\n\t{\n\t\tlet addProductsLink = BX.create(\n\t\t\t'a',\n\t\t\t{\n\t\t\t\tprops: {href: '#'}\n\t\t\t}\n\t\t);\n\t\taddProductsLink.text = Loc.getMessage('DOCUMENT_PRODUCTS_ADD_PRODUCT');\n\t\taddProductsLink.onclick = () => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'})\n\t\t};\n\t\tlet row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-add-products',\n\t\t\t},\n\t\t\tchildren: [addProductsLink],\n\t\t});\n\t\tthis._productsContainer.appendChild(row);\n\t}\n\n\t_onMoreButtonClick(e)\n\t{\n\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', {tabId: 'tab_products'});\n\t}\n\n\tdoClearLayout()\n\t{\n\t\tthis._productsContainer = null;\n\t\tthis._moreButton = null;\n\t\tthis._moreButtonRow = null;\n\t\tthis._totalsRow = null;\n\t}\n\n\taddProductRow(data)\n\t{\n\t\tvar row = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item'\n\t\t\t}\n\t\t});\n\n\t\tthis._productsContainer.appendChild(row);\n\n\t\tvar nameCell = BX.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-item-name'\n\t\t\t}\n\t\t});\n\t\tnameCell.innerHTML = BX.util.htmlspecialchars(data['PRODUCT_NAME']);\n\t\trow.appendChild(nameCell);\n\n\t\tvar valueCell = BX.create(\n\t\t\t'div',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\trow.appendChild(valueCell);\n\n\t\tvalueCell.appendChild(\n\t\t\tBX.create(\n\t\t\t\t'div',\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'catalog-entity-widget-content-block-products-price-value'\n\t\t\t\t\t},\n\t\t\t\t\thtml: data['SUM']\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n}\n","import {ajax, Loc, Tag} from \"main.core\";\nimport {Dialog, TagSelector} from 'ui.entity-selector';\n\nexport default class Contractor extends BX.UI.EntityEditorField {\n\tconstructor(id, settings)\n\t{\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\n\t\tthis._input = null;\n\t\tthis.innerWrapper = null;\n\t\tthis.currentContractorName = '';\n\t\tthis.viewModeDisplay = null;\n\t}\n\n\tgetContentWrapper()\n\t{\n\t\treturn this.innerWrapper;\n\t}\n\n\tlayout(options = {})\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.ensureWrapperCreated({});\n\t\tthis.adjustWrapper();\n\n\t\tlet title = this.getTitle();\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\n\t\t}\n\n\t\tthis._wrapper.appendChild(this.createTitleNode(title));\n\n\t\tlet name = this.getName();\n\t\tlet value = this.getValue();\n\t\tlet data = this._schemeElement.getData();\n\t\tif (!this.currentContractorName)\n\t\t{\n\t\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t\t}\n\t\tthis._input = Tag.render`<input name=\"${name}\" type=\"hidden\" value=\"${value}\"/>`;\n\t\tthis._wrapper.appendChild(this._input);\n\n\t\tthis.innerWrapper = Tag.render`<div class=\"ui-entity-editor-content-block\"></div>`;\n\t\tthis._wrapper.appendChild(this.innerWrapper);\n\n\t\tif(this._mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tlet currentSelectedItems = [];\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcurrentSelectedItems.push({\n\t\t\t\t\tid: value,\n\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\ttitle: this.currentContractorName,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tlet contractorSelector = new TagSelector({\n\t\t\t\titems: currentSelectedItems,\n\t\t\t\tplaceholder: Loc.getMessage('DOCUMENT_CONTRACTOR_FIELD_PLACEHOLDER'),\n\t\t\t\ttextBoxWidth: '100%',\n\t\t\t\tmultiple: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: 'catalog_document_contractors',\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'contractor',\n\t\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR'),\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\t\tthis._input.value = event.data.item.getId();\n\t\t\t\t\t\t\tif (this.viewModeDisplay)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.currentContractorName = event.data.item.getTitle();\n\t\t\t\t\t\t\t\tthis.viewModeDisplay.innerHTML = BX.util.htmlspecialchars(this.currentContractorName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Search:onItemCreateAsync': this.createContractor.bind(this),\n\t\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\t\tthis._input.value = '';\n\t\t\t\t\t\t\tthis._changeHandler();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tcontractorSelector.renderTo(this.innerWrapper);\n\n\t\t\tif (BX.UI.EntityEditorModeOptions.check(this._modeOptions, BX.UI.EntityEditorModeOptions.individual))\n\t\t\t{\n\t\t\t\tcontractorSelector.getDialog().show();\n\t\t\t}\n\t\t}\n\t\telse // if(this._mode === BX.UI.EntityEditorMode.view)\n\t\t{\n\t\t\tif (this.hasContentToDisplay())\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${BX.util.htmlspecialchars(this.currentContractorName)}</div>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.viewModeDisplay = Tag.render`<div class=\"ui-entity-editor-content-block-text\">${Loc.getMessage('DOCUMENT_CONTRACTOR_NOT_FILLED')}</div>`;\n\t\t\t}\n\n\t\t\tthis.innerWrapper.appendChild(this.viewModeDisplay);\n\t\t}\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\n\t\t}\n\n\t\tif (this.isDragEnabled())\n\t\t{\n\t\t\tthis.initializeDragDropAbilities();\n\t\t}\n\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t}\n\n\tvalidate(result)\n\t{\n\t\tif(!(this._mode === BX.UI.EntityEditorMode.edit && this._input))\n\t\t{\n\t\t\tthrow \"BX.Catalog.DocumentCard.Contractor. Invalid validation context\";\n\t\t}\n\n\t\tthis.clearError();\n\n\t\tif(this.hasValidators())\n\t\t{\n\t\t\treturn this.executeValidators(result);\n\t\t}\n\n\t\tlet isValid = !(this.isRequired() || this.isRequiredByAttribute()) || BX.util.trim(this._input.value) !== \"\";\n\t\tif (!isValid)\n\t\t{\n\t\t\tresult.addError(BX.UI.EntityValidationError.create({ field: this }));\n\t\t\tthis.showRequiredFieldError(this._input);\n\t\t}\n\t\treturn isValid;\n\t}\n\n\thasValue()\n\t{\n\t\tif (this.getValue() === '0')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn super.hasValue();\n\t}\n\n\tgetModeSwitchType(mode)\n\t{\n\t\tlet result = BX.UI.EntityEditorModeSwitchType.common;\n\n\t\tif (mode === BX.UI.EntityEditorMode.edit)\n\t\t{\n\t\t\tresult |= BX.UI.EntityEditorModeSwitchType.button | BX.UI.EntityEditorModeSwitchType.content;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tcreateContractor(event)\n\t{\n\t\tlet {searchQuery} = event.getData();\n\t\tlet companyName = searchQuery.getQuery();\n\n\t\treturn new Promise(\n\t\t\t(resolve, reject) => {\n\t\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\t\tconst fields = {\n\t\t\t\t\tcompanyName,\n\t\t\t\t};\n\n\t\t\t\tdialog.showLoader();\n\t\t\t\tajax.runAction(\n\t\t\t\t\t'catalog.contractor.createContractor',\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfields\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.then(response => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\tentityId: 'contractor',\n\t\t\t\t\t\ttitle: searchQuery.getQuery(),\n\t\t\t\t\t\ttabs: dialog.getRecentTab().getId(),\n\t\t\t\t\t});\n\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.select();\n\t\t\t\t\t}\n\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tdialog.hideLoader();\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_ADD_CONTRACTOR_ERROR'),\n\t\t\t\t\t});\n\t\t\t\t\tdialog.hide();\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tgetContractorNameFromModel()\n\t{\n\t\treturn this._model.getSchemeField(this._schemeElement, 'contractorName', '');\n\t}\n\n\trollback()\n\t{\n\t\tthis.currentContractorName = this.getContractorNameFromModel();\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport ProductRowSummary from \"./row-summary\";\nimport Contractor from \"./contractor\";\n\nexport default class FieldsFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorControlFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['documentCard'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'contractor')\n\t\t{\n\t\t\treturn new Contractor(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}","export default class DocumentModel extends BX.UI.EntityModel\n{\n\tconstructor(id, settings) {\n\t\tsuper();\n\t\tthis.initialize(id, settings);\n\t}\n\n\tisCaptionEditable()\n\t{\n\t\treturn true;\n\t}\n\n\tgetCaption()\n\t{\n\t\tvar title = this.getField(\"TITLE\");\n\t\treturn BX.type.isString(title) ? title : \"\";\n\t}\n\n\tsetCaption(caption)\n\t{\n\t\tthis.setField(\"TITLE\", caption);\n\t}\n\n\tprepareCaptionData(data)\n\t{\n\t\tdata[\"TITLE\"] = this.getField(\"TITLE\", \"\");\n\t}\n}\n","import {type BaseEvent, EventEmitter} from 'main.core.events'\nimport DocumentModel from \"./model\";\n\nexport default class ModelFactory\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorModelFactory:onInitialize', (event: BaseEvent) => {\n\t\t\tconst [, eventArgs] = event.getCompatData();\n\t\t\teventArgs.methods['store_document'] = this.factory.bind(this);\n\t\t});\n\t}\n\n\tfactory(type, controlId, settings)\n\t{\n\t\tif (type === 'store_document')\n\t\t{\n\t\t\treturn new DocumentModel(controlId, settings);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n","import { BaseCard } from 'catalog.entity-card';\nimport { AnalyticsContextList, EnableWizardOpener } from 'catalog.store-enable-wizard';\nimport { Dom, Event, Loc, Reflection, Tag, Text, Type } from 'main.core';\nimport { type BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager, Popup } from 'main.popup';\nimport { Button } from 'ui.buttons';\nimport { Dialog } from 'ui.entity-selector';\nimport StoreDocumentFieldConfigurationManager from '../configurator/store-document-field-configurator-manager';\nimport ControllersFactory from '../controllers-factory';\nimport FieldsFactory from '../editor-fields/fields-factory';\nimport ModelFactory from '../model/model-factory';\nimport ProductListController from '../product-list/controller';\n\nclass DocumentCard extends BaseCard\n{\n\tstatic #instance;\n\n\tstatic #fieldFactory;\n\tstatic #modelFactory;\n\tstatic #controllersFactory;\n\n\tconstructor(id, settings)\n\t{\n\t\tsuper(id, settings);\n\t\tthis.documentType = settings.documentType;\n\t\tthis.isDocumentConducted = settings.documentStatus === 'Y';\n\t\tthis.componentName = settings.componentName;\n\t\tthis.signedParameters = settings.signedParameters;\n\t\tthis.isConductLocked = settings.isConductLocked;\n\t\tthis.masterSliderUrl = settings.masterSliderUrl;\n\t\tthis.isInventoryManagementDisabled = settings.isInventoryManagementDisabled;\n\t\tthis.inventoryManagementFeatureCode = settings.inventoryManagementFeatureCode;\n\t\tthis.editorName = settings.includeCrmEntityEditor ? 'BX.Crm.EntityEditor' : 'BX.UI.EntityEditor';\n\t\tthis.inventoryManagementSource = settings.inventoryManagementSource;\n\t\tthis.lockedCancellation = settings.lockedCancellation || false;\n\t\tthis.activeTabId = 'main';\n\n\t\tthis.isTabAnalyticsSent = false;\n\n\t\tthis.setSliderText();\n\t\tthis.addCopyLinkPopup();\n\t\tthis.subscribeToEvents();\n\n\t\tif (settings.documentTypeSelector)\n\t\t{\n\t\t\tthis.initDocumentTypeSelector();\n\t\t}\n\n\t\tDocumentCard.#instance = this;\n\n\t\t// setting this to true so that we can decide\n\t\t// whether to close the slider or not on the fly on backend (closeOnSave=Y)\n\t\tBX.UI.SidePanel.Wrapper.setParam('closeAfterSave', true);\n\t\tthis.showNotificationOnClose = false;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn DocumentCard.#instance;\n\t}\n\n\tinitDocumentTypeSelector()\n\t{\n\t\tconst documentTypeSelector = this.settings.documentTypeSelector;\n\t\tconst documentTypeSelectorTypes = this.settings.documentTypeSelectorTypes;\n\t\tif (!documentTypeSelector || !documentTypeSelectorTypes)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\t\tdocumentTypeSelectorTypes.forEach((type) => {\n\t\t\tmenuItems.push({\n\t\t\t\ttext: Loc.getMessage(`DOC_TYPE_SHORT_${type}`),\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\t\t\tif (slider)\n\t\t\t\t\t{\n\t\t\t\t\t\tslider.url = BX.Uri.addParam(slider.getUrl(), { DOCUMENT_TYPE: type });\n\t\t\t\t\t\tslider.url = BX.Uri.removeParam(slider.url, ['firstTime', 'focusedTab']);\n\n\t\t\t\t\t\tif (this.activeTabId !== 'main')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslider.url = BX.Uri.addParam(slider.getUrl(), { focusedTab: this.activeTabId });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (type === 'A' || type === 'S')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslider.requestMethod = 'post';\n\t\t\t\t\t\t\tslider.requestParams = {\n\t\t\t\t\t\t\t\tpreloadedFields: {\n\t\t\t\t\t\t\t\t\tDOCUMENT_FIELDS: this.getDocumentFieldsForTypeSwitching(),\n\t\t\t\t\t\t\t\t\tPRODUCTS: this.getProductsForTypeSwitching(),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tslider.setFrameSrc();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\tconst popupMenu = MenuManager.create({\n\t\t\tid: 'document-type-selector',\n\t\t\tbindElement: documentTypeSelector,\n\t\t\titems: menuItems,\n\t\t});\n\n\t\tdocumentTypeSelector.addEventListener('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tpopupMenu.show();\n\t\t});\n\t}\n\n\tgetDocumentFieldsForTypeSwitching()\n\t{\n\t\tconst documentFields = {};\n\t\tconst editor = this.getEditorInstance();\n\t\tif (!editor)\n\t\t{\n\t\t\treturn documentFields;\n\t\t}\n\n\t\tconst form = editor.getFormElement();\n\t\tconst formData = new FormData(form);\n\t\tconst formProps = Object.fromEntries(formData);\n\n\t\tconst fieldsToTransfer = ['TITLE', 'CURRENCY', 'TOTAL'];\n\t\tfieldsToTransfer.forEach((field) => {\n\t\t\tdocumentFields[field] = formProps[field] ?? '';\n\t\t});\n\n\t\treturn documentFields;\n\t}\n\n\tgetProductsForTypeSwitching()\n\t{\n\t\tconst products = [];\n\t\tif (!Reflection.getClass('BX.Catalog.Store.ProductList.Instance'))\n\t\t{\n\t\t\treturn products;\n\t\t}\n\n\t\tconst productFields = ['ID', 'STORE_TO', { ELEMENT_ID: 'SKU_ID' }, 'AMOUNT', 'PURCHASING_PRICE', 'BASE_PRICE', 'BASE_PRICE_EXTRA', 'BASE_PRICE_EXTRA_RATE'];\n\t\tBX.Catalog.Store.ProductList.Instance.getProductsFields().forEach((productRow) => {\n\t\t\tconst product = {};\n\t\t\tproductFields.forEach((field) => {\n\t\t\t\tif (Type.isObject(field))\n\t\t\t\t{\n\t\t\t\t\tconst destinationField = Object.keys(field)[0];\n\t\t\t\t\tconst sourceField = field[destinationField];\n\t\t\t\t\tproduct[destinationField] = productRow[sourceField] ?? '';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tproduct[field] = productRow[field] ?? '';\n\t\t\t\t}\n\t\t\t});\n\t\t\tproducts.push(product);\n\t\t});\n\n\t\treturn products;\n\t}\n\n\topenMasterSlider()\n\t{\n\t\tconst card = this;\n\n\t\tnew EnableWizardOpener().open(\n\t\t\tthis.masterSliderUrl,\n\t\t\t{\n\t\t\t\turlParams: {\n\t\t\t\t\tanalyticsContextSection: AnalyticsContextList.DOCUMENT_CARD,\n\t\t\t\t},\n\t\t\t\tdata: {\n\t\t\t\t\topenGridOnDone: false,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonCloseComplete: function(event) {\n\t\t\t\t\t\tconst slider = event.getSlider();\n\t\t\t\t\t\tif (!slider)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (slider.getData().get('isInventoryManagementEnabled'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcard.isConductLocked = false;\n\n\t\t\t\t\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\t\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tslider.allowChangeHistory = false;\n\t\t\t\t\t\t\t\t\tslider.getWindow().location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n\n\tadjustToolPanel()\n\t{}\n\n\tfocusOnTab(tabId)\n\t{\n\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', { tabId: tabId });\n\t}\n\n\t// deprecated\n\tsetViewModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showViewModeButtons();\n\t}\n\n\t// deprecated\n\tsetEditModeButtons(editor)\n\t{\n\t\teditor._toolPanel.showEditModeButtons();\n\t}\n\n\tgetEditorInstance()\n\t{\n\t\tconst editorInstance = Reflection.getClass(this.editorName);\n\t\tif (editorInstance)\n\t\t{\n\t\t\treturn editorInstance.getDefault();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsubscribeToEvents()\n\t{\n\t\tthis.subscribeToUserSelectorEvent();\n\t\tthis.subscribeToValidationFailedEvent();\n\t\tthis.subscribeToOnSaveEvent();\n\t\tthis.subscribeToTabOpenEvent();\n\t\tthis.subscribeToDirectActionEvent();\n\t\tthis.subscribeToEntityCreateEvent();\n\t\tthis.subscribeToBeforeEntityRedirectEvent();\n\t\tthis.subscribeToCreateUserFieldEvent();\n\t\tthis.subscribeToFieldConfiguratorEvent();\n\t}\n\n\tsubscribeToFieldConfiguratorEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityConfigurationManager:onInitialize', this.onConfigurationManagerInit.bind(this));\n\t}\n\n\tonConfigurationManagerInit(event: BaseEvent)\n\t{\n\t\tconst [, eventArgs] = event.getCompatData();\n\n\t\tif (!eventArgs.type || eventArgs.type === 'editor')\n\t\t{\n\t\t\teventArgs.configurationFieldManager = StoreDocumentFieldConfigurationManager.create(this.id, eventArgs);\n\t\t}\n\n\t\tevent.stopImmediatePropagation();\n\t}\n\n\tsubscribeToCreateUserFieldEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.UI.EntityConfigurationManager:onCreateClick', ((e) => {\n\t\t\te.data.isCanceled = true;\n\n\t\t\tconst editor = this.getEditorInstance();\n\t\t\tconst createUrl = editor.getConfigurationFieldManager().getCreationPageUrl('custom');\n\n\t\t\tif (createUrl)\n\t\t\t{\n\t\t\t\ttop.BX.SidePanel.Instance.open(createUrl);\n\t\t\t}\n\t\t}));\n\t}\n\n\tsubscribeToUserSelectorEvent()\n\t{\n\t\tif (this.editorName !== 'BX.UI.EntityEditor')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.UI.EntityEditorUser:openSelector', (event) => {\n\t\t\tconst eventData = event.data[1];\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: eventData.anchor,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tcontext: 'CATALOG_DOCUMENT',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (onSelectEvent) => {\n\t\t\t\t\t\tconst fieldId = eventData.id;\n\t\t\t\t\t\tconst selectedItem = onSelectEvent.data.item;\n\t\t\t\t\t\tconst userData = {\n\t\t\t\t\t\t\tentityId: selectedItem.id,\n\t\t\t\t\t\t\tavatar: selectedItem.avatar,\n\t\t\t\t\t\t\tname: Text.encode(selectedItem.title.text),\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (this.entityId > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst fields = {};\n\t\t\t\t\t\t\tfields[fieldId] = selectedItem.id;\n\t\t\t\t\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t\t\t\t\tthis.componentName,\n\t\t\t\t\t\t\t\t'save',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tsignedParameters: this.signedParameters,\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tfields: fields,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t).then((result) => {\n\t\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\teventData.callback(dialog, userData);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tsubscribeToValidationFailedEvent()\n\t{\n\t\tEventEmitter.subscribe(`${this.editorName}:onFailedValidation`, (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', { tabId: 'main' });\n\t\t});\n\t\tEventEmitter.subscribe('onProductsCheckFailed', (event) => {\n\t\t\tEventEmitter.emit('BX.Catalog.EntityCard.TabManager:onOpenTab', { tabId: 'tab_products' });\n\t\t});\n\t}\n\n\tsubscribeToOnSaveEvent()\n\t{\n\t\tEventEmitter.subscribe(`${this.editorName}:onSave`, (event) => {\n\t\t\tconst eventEditor = event.data[0];\n\t\t\tconst action = event.data[1]?.actionId;\n\t\t\tif (eventEditor && eventEditor._ajaxForm)\n\t\t\t{\n\t\t\t\teventEditor._toolPanel?.clearErrors();\n\n\t\t\t\tif (this.isInventoryManagementDisabled && this.inventoryManagementFeatureCode)\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\ttop.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (action === 'SAVE_AND_CONDUCT')\n\t\t\t\t{\n\t\t\t\t\tif (this.isConductLocked)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\t\tthis.openMasterSlider();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.validateControllers(eventEditor.getControllers()))\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\t\teventEditor._toolPanel?.setLocked(false);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (event.data[1].cancel)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst form = eventEditor._ajaxForms[action];\n\t\t\t\tif (form)\n\t\t\t\t{\n\t\t\t\t\tform.addUrlParams({\n\t\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\t\tinventoryManagementSource: this.inventoryManagementSource,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToTabOpenEvent()\n\t{\n\t\tEventEmitter.subscribe('BX.Catalog.EntityCard.TabManager:onSelectItem', (event) => {\n\t\t\tconst tabId = event.data.tabId;\n\t\t\tif (tabId === 'tab_products' && !this.isTabAnalyticsSent)\n\t\t\t{\n\t\t\t\tthis.sendAnalyticsData({\n\t\t\t\t\ttab: 'products',\n\t\t\t\t\tisNewDocument: this.entityId <= 0 ? 'Y' : 'N',\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\tinventoryManagementSource: this.inventoryManagementSource,\n\t\t\t\t});\n\t\t\t\tthis.isTabAnalyticsSent = true;\n\t\t\t}\n\n\t\t\tif (tabId)\n\t\t\t{\n\t\t\t\tthis.activeTabId = tabId;\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToDirectActionEvent()\n\t{\n\t\tEventEmitter.subscribe(`${this.editorName}:onDirectAction`, (event) => {\n\t\t\tconst eventEditor = event.data[0];\n\n\t\t\tif (this.isInventoryManagementDisabled && this.inventoryManagementFeatureCode)\n\t\t\t{\n\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\ttop.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.data[1]?.actionId === 'CONDUCT')\n\t\t\t{\n\t\t\t\teventEditor._toolPanel?.clearErrors();\n\n\t\t\t\tif (this.isConductLocked)\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\t\t\t\t\tthis.openMasterSlider();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.validateControllers(eventEditor.getControllers()))\n\t\t\t\t{\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\teventEditor._toolPanel?.setLocked(false);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.data[0]._ajaxForms.CONDUCT.addUrlParams({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\tinventoryManagementSource: this.inventoryManagementSource,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (event.data[1]?.actionId === 'CANCEL_CONDUCT')\n\t\t\t{\n\t\t\t\tif (this.isLockedCancellation())\n\t\t\t\t{\n\t\t\t\t\tthis.showCancellationInfo();\n\t\t\t\t\tevent.data[1].cancel = true;\n\t\t\t\t\tevent.data[0]._toolPanel?.setLocked(false);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.data[0]._ajaxForms.CANCEL_CONDUCT.addUrlParams({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\tinventoryManagementSource: this.inventoryManagementSource,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToEntityCreateEvent()\n\t{\n\t\tEventEmitter.subscribe('onEntityCreate', (event) => {\n\t\t\twindow.top.BX.onCustomEvent('DocumentCard:onEntityCreate');\n\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\tif (slider.getWindow()?.BX.Catalog?.DocumentGridManager)\n\t\t\t\t{\n\t\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onEntityCreate');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToBeforeEntityRedirectEvent()\n\t{\n\t\tEventEmitter.subscribe('beforeEntityRedirect', (event) => {\n\t\t\twindow.top.BX.onCustomEvent('DocumentCard:onBeforeEntityRedirect');\n\t\t\tBX.SidePanel.Instance.getOpenSliders().forEach((slider) => {\n\t\t\t\tslider.getWindow().BX.onCustomEvent('DocumentCard:onBeforeEntityRedirect');\n\t\t\t});\n\t\t\tconst editor = event?.data[0]?.sender;\n\t\t\tif (editor)\n\t\t\t{\n\t\t\t\teditor._toolPanel.disableSaveButton();\n\t\t\t\teditor.hideToolPanel();\n\n\t\t\t\tthis.showNotificationOnClose = event?.data[0]?.showNotificationOnClose === 'Y';\n\n\t\t\t\tif (this.showNotificationOnClose)\n\t\t\t\t{\n\t\t\t\t\tlet url = event.data[0].redirectUrl;\n\t\t\t\t\tif (!url)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\turl = BX.Uri.removeParam(url, 'closeOnSave');\n\n\t\t\t\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL'),\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('DOCUMENT_CONDUCT_SUCCESSFUL_VIEW'),\n\t\t\t\t\t\t\t\thref: url,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: function(event, balloon, action) {\n\t\t\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tvalidateControllers(controllers)\n\t{\n\t\tlet validateResult = true;\n\t\tif (Array.isArray(controllers))\n\t\t{\n\t\t\tcontrollers.forEach((controller) => {\n\t\t\t\tif (controller instanceof ProductListController && !controller.validateProductList())\n\t\t\t\t{\n\t\t\t\t\tvalidateResult = false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvalidateResult = false;\n\t\t}\n\n\t\treturn validateResult;\n\t}\n\n\tsendAnalyticsData(data)\n\t{\n\t\tBX.ajax.runAction(\n\t\t\t'catalog.analytics.sendAnalyticsLabel',\n\t\t\t{\n\t\t\t\tanalyticsLabel: data,\n\t\t\t},\n\t\t);\n\t}\n\n\taddCopyLinkPopup()\n\t{\n\t\tconst copyLinkButton = document.getElementById(this.settings.copyLinkButtonId);\n\t\tif (!copyLinkButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcopyLinkButton.onclick = () => {\n\t\t\tthis.copyDocumentLinkToClipboard();\n\t\t};\n\t}\n\n\tcopyDocumentLinkToClipboard()\n\t{\n\t\tconst url = BX.util.remove_url_param(window.location.href, ['IFRAME', 'IFRAME_TYPE']);\n\t\tif (!BX.clipboard.copy(url))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvar popup = new BX.PopupWindow(\n\t\t\t'catalog_copy_document_url_to_clipboard',\n\t\t\tdocument.getElementById(this.settings.copyLinkButtonId),\n\t\t\t{\n\t\t\t\tcontent: Loc.getMessage('DOCUMENT_LINK_COPIED'),\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tzIndex: 1000,\n\t\t\t\tangle: true,\n\t\t\t\tbindOptions: { position: 'top' },\n\t\t\t},\n\t\t);\n\t\tpopup.show();\n\n\t\tsetTimeout(() => { popup.close(); }, 1500);\n\t}\n\n\tstatic registerFieldFactory()\n\t{\n\t\tDocumentCard.#fieldFactory = new FieldsFactory();\n\t}\n\n\tstatic registerModelFactory()\n\t{\n\t\tDocumentCard.#modelFactory = new ModelFactory();\n\t}\n\n\tstatic registerDocumentControllersFactory(eventName)\n\t{\n\t\tDocumentCard.#controllersFactory = new ControllersFactory(eventName);\n\t}\n\n\tsetSliderText()\n\t{\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.getLabel().setText(Loc.getMessage(`SLIDER_LABEL_${this.documentType}`));\n\t\t}\n\t}\n\n\tdisableSaveAndConductButton()\n\t{\n\t\tif (!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = true;\n\t\tBX.addClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n\n\tenableSaveAndConductButton()\n\t{\n\t\tif (!this.conductAndSaveButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.conductAndSaveButton.disabled = false;\n\t\tBX.removeClass(this.conductAndSaveButton, 'ui-btn-disabled');\n\t}\n\n\tisLockedCancellation(): boolean\n\t{\n\t\treturn this.lockedCancellation;\n\t}\n\n\tshowCancellationInfo(): void\n\t{\n\t\tconst popup = new Popup(null, null, {\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcontent: this.getCancellationPopupContent(),\n\t\t\toverlay: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_YES'),\n\t\t\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.lockedCancellation = false;\n\n\t\t\t\t\t\tthis.getEditorInstance()?.performAction('CANCEL_CONDUCT');\n\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_NO'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.LINK,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tgetCancellationPopupContent(): HTMLElement\n\t{\n\t\tconst moreLink = Tag.render`<a href=\"#\" class=\"ui-form-link\">${Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_LINK')}</a>`;\n\n\t\tEvent.bind(moreLink, 'click', () => {\n\t\t\tconst articleId = 17858278;\n\t\t\ttop.BX.Helper.show(`redirect=detail&code=${articleId}`);\n\t\t});\n\n\t\tconst descriptionHtml = Tag.render`\n\t\t\t<div>${Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_HINT', {'#HELP_LINK#': '<help-link></help-link>'})}</div>\n\t\t`;\n\n\t\tDom.replace(descriptionHtml.querySelector('help-link'), moreLink);\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<h3>${Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_TITLE')}</h3>\n\t\t\t\t<div>${Text.encode(Loc.getMessage('CANCEL_CONDUCT_CANCELLATION_POPUP_QUESTION'))}\n\t\t\t\t<br>${descriptionHtml}<div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n\nexport default DocumentCard;\n","import {Loc, Tag} from 'main.core';\nimport 'ui.feedback.form';\n\nexport default class Button\n{\n\tstatic render(parentNode, highlight)\n\t{\n\t\tconst buttonTitle = Loc.getMessage('FEEDBACK_BUTTON_TITLE');\n\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-themes\" title=\"${buttonTitle}\">\n\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t${buttonTitle}\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t`;\n\t\tif (highlight)\n\t\t{\n\t\t\tbutton.style.zIndex = 140;\n\t\t\tbutton.style.backgroundColor = '#fff';\n\t\t}\n\n\t\tbutton.addEventListener('click', () => {\n\t\t\tBX.Catalog.DocumentCard.Slider.openFeedbackForm();\n\t\t});\n\n\t\tparentNode.appendChild(button);\n\n\t\treturn button;\n\t}\n}\n","import {Type, Uri} from \"main.core\";\n\nexport default class Slider\n{\n\tstatic openFeedbackForm()\n\t{\n\t\tconst url = new Uri('/bitrix/components/bitrix/catalog.feedback/slider.php');\n\t\turl.setQueryParams({feedback_type: 'feedback'});\n\n\t\treturn Slider.open(url.toString(), {width: 735});\n\t}\n\n\tstatic openIntegrationRequestForm(event, params={})\n\t{\n\t\tif (event && Type.isFunction(event.preventDefault))\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tif(!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tlet url = (new Uri('/bitrix/components/bitrix/catalog.feedback/slider.php'));\n\n\t\turl.setQueryParams({feedback_type: 'integration_request'});\n\t\turl.setQueryParams(params);\n\n\t\treturn Slider.open(url.toString(), {width: 735});\n\t}\n\n\tstatic open(url, options)\n\t{\n\t\tif(!Type.isPlainObject(options))\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\toptions = {...{cacheable: false, allowChangeHistory: false, events: {}}, ...options};\n\t\treturn new Promise((resolve) =>\n\t\t{\n\t\t\tif(Type.isString(url) && url.length > 1)\n\t\t\t{\n\t\t\t\toptions.events.onClose = function(event)\n\t\t\t\t{\n\t\t\t\t\tresolve(event.getSlider());\n\t\t\t\t};\n\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t}\n}"],"names":["StoreDocumentFieldConfigurator","optionContainer","_isRequiredCheckBox","getField","getData","requiredIsEditable","getIsRequiredCheckBox","getSchemeElement","_isRequired","checked","BX","ajax","runComponentAction","mode","data","documentType","getEditor","getModel","DOC_TYPE","fieldName","_id","required","isRequired","checkBox","createOption","caption","Loc","getMessage","_field","id","settings","self","initialize","UI","EntityEditorFieldConfigurator","Reflection","namespace","StoreDocumentFieldConfigurationManager","params","parent","typeId","field","Type","isObject","getType","setVisible","userType","isString","TypeId","EntityUserFieldType","string","_fieldConfigurator","create","editor","_editor","schemeElement","model","_model","EntityEditorMode","edit","mandatoryConfigurator","EntityConfigurationManager","ProductListController","_currencyId","_setProductListHandler","handleSetProductList","bind","_tabShowHandler","onTabShow","_editorControlChangeHandler","onEditorControlChange","EventEmitter","subscribe","event","getId","changeCurrency","item","value","productList","setProductList","unsubscribe","reloadGrid","tab","handleOnTabShow","emit","rollback","onInnerCancel","changeCurrencyId","updateTotalUiCurrency","_isChanged","destroy","setController","setForm","getFormElement","getCurrencyId","_prevProductCount","_curProductCount","getProductCount","removeFormFields","_toolPanel","showViewModeButtons","disableSaveButton","markAsChanged","getProductsFields","isChanged","isNew","compileProductData","enableSaveButton","EntityEditorMoney","fieldValue","currencyValue","totalData","setField","Currency","currencyFormat","totalCost","totalCurrencyControl","getControlById","refreshLayout","errorsArray","validate","length","addError","EntityEditorController","DocumentCardController","lockField","window","top","onCustomEvent","sliders","SidePanel","Instance","getOpenSliders","forEach","slider","getWindow","Catalog","DocumentGridManager","tabId","setTimeout","ControllersFactory","eventName","getCompatData","eventArgs","methods","factory","type","controlId","ProductRowSummary","_loader","_productsContainer","_previousData","_itemCount","_totalCount","_moreButton","_moreButtonRow","_totalsRow","_moreButtonClickHandler","delegate","_onMoreButtonClick","_visibleItemsLimit","options","_hasLayout","ensureWrapperCreated","adjustWrapper","getValue","isPlainObject","title","getTitle","items","prop","getArray","getInteger","maxLength","restLength","isDragEnabled","_wrapper","appendChild","createDragButton","createTitleNode","props","className","i","addProductRow","addMoreButton","addTotalRow","children","isContextMenuEnabled","createContextMenuButton","initializeDragDropAbilities","registerLayout","row","nameCell","attrs","events","click","text","toString","total","html","valueCell","CurrencyCore","amount","currency","addProductsLink","href","onclick","e","innerHTML","util","htmlspecialchars","EntityEditorField","Contractor","_input","innerWrapper","currentContractorName","viewModeDisplay","name","getName","_schemeElement","getContractorNameFromModel","Tag","render","_mode","currentSelectedItems","push","entityId","contractorSelector","TagSelector","placeholder","textBoxWidth","multiple","dialogOptions","context","entities","dynamicLoad","dynamicSearch","searchOptions","allowCreateItem","footerOptions","label","_changeHandler","createContractor","renderTo","EntityEditorModeOptions","check","_modeOptions","individual","getDialog","show","hasContentToDisplay","result","clearError","hasValidators","executeValidators","isValid","isRequiredByAttribute","trim","EntityValidationError","showRequiredFieldError","EntityEditorModeSwitchType","common","button","content","searchQuery","companyName","getQuery","Promise","resolve","reject","dialog","getTarget","fields","showLoader","runAction","then","response","hideLoader","addItem","tabs","getRecentTab","select","hide","Notification","Center","notify","getSchemeField","FieldsFactory","DocumentModel","EntityModel","ModelFactory","DocumentCard","isDocumentConducted","documentStatus","componentName","signedParameters","isConductLocked","masterSliderUrl","isInventoryManagementDisabled","inventoryManagementFeatureCode","editorName","includeCrmEntityEditor","inventoryManagementSource","lockedCancellation","activeTabId","isTabAnalyticsSent","setSliderText","addCopyLinkPopup","subscribeToEvents","documentTypeSelector","initDocumentTypeSelector","Wrapper","setParam","showNotificationOnClose","documentTypeSelectorTypes","menuItems","getTopSlider","url","Uri","addParam","getUrl","DOCUMENT_TYPE","removeParam","focusedTab","requestMethod","requestParams","preloadedFields","DOCUMENT_FIELDS","getDocumentFieldsForTypeSwitching","PRODUCTS","getProductsForTypeSwitching","setFrameSrc","popupMenu","MenuManager","bindElement","addEventListener","preventDefault","documentFields","getEditorInstance","form","formData","FormData","formProps","Object","fromEntries","fieldsToTransfer","products","getClass","productFields","ELEMENT_ID","Store","ProductList","productRow","product","destinationField","keys","sourceField","card","EnableWizardOpener","open","urlParams","analyticsContextSection","AnalyticsContextList","DOCUMENT_CARD","openGridOnDone","onCloseComplete","getSlider","get","allowChangeHistory","location","reload","showEditModeButtons","editorInstance","getDefault","subscribeToUserSelectorEvent","subscribeToValidationFailedEvent","subscribeToOnSaveEvent","subscribeToTabOpenEvent","subscribeToDirectActionEvent","subscribeToEntityCreateEvent","subscribeToBeforeEntityRedirectEvent","subscribeToCreateUserFieldEvent","subscribeToFieldConfiguratorEvent","onConfigurationManagerInit","configurationFieldManager","stopImmediatePropagation","isCanceled","createUrl","getConfigurationFieldManager","getCreationPageUrl","eventData","Dialog","targetNode","anchor","enableSearch","onSelectEvent","fieldId","selectedItem","userData","avatar","Text","encode","callback","eventEditor","action","actionId","_ajaxForm","clearErrors","cancel","setLocked","InfoHelper","openMasterSlider","validateControllers","getControllers","_ajaxForms","addUrlParams","isNewDocument","sendAnalyticsData","CONDUCT","isLockedCancellation","showCancellationInfo","CANCEL_CONDUCT","sender","hideToolPanel","redirectUrl","actions","balloon","close","controllers","validateResult","Array","isArray","controller","validateProductList","analyticsLabel","copyLinkButton","document","getElementById","copyLinkButtonId","copyDocumentLinkToClipboard","remove_url_param","clipboard","copy","popup","PopupWindow","darkMode","autoHide","zIndex","angle","bindOptions","position","getLabel","setText","conductAndSaveButton","disabled","addClass","removeClass","Popup","onPopupClose","getCancellationPopupContent","overlay","buttons","Button","color","Color","PRIMARY","performAction","LINK","moreLink","Event","articleId","Helper","descriptionHtml","Dom","replace","querySelector","BaseCard","parentNode","highlight","buttonTitle","style","backgroundColor","Slider","openFeedbackForm","setQueryParams","feedback_type","width","isFunction","cacheable","onClose"],"mappings":"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"}