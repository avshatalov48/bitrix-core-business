{"version":3,"file":"resourcebookinguserfield.bundle.js","sources":["../src/formfieldtunnerabstract.js","../src/formfieldtunnerpopupabstract.js","../src/formfieldtunnervaluepopupabstract.js","../src/controls/userselectorfieldtunner.js","../src/controls/resourceselectorfieldtunner.js","../src/controls/serviceselectorfieldtunner.js","../src/controls/durationselectorfieldtunner.js","../src/controls/dateselectorfieldtunner.js","../src/controls/timeselectorfieldtunner.js","../src/adjustfieldcontroller.js","../src/controls/userselectorfieldeditcontrol.js","../src/controls/resourceselectorfieldeditcontrol.js","../src/controls/plannerpopup.js","../src/editfieldcontroller.js","../src/controls/serviceselector.js","../src/controls/timezoneselector.js","../src/controls/modeselector.js","../src/customizecrmentityeditor.js","../src/calendarviewsettingsslider.js","../src/adminsettingsviewer.js","../src/resourcebookinguserfield.js"],"sourcesContent":["import {Dom, Type} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tthis.label = '';\n\t\tthis.formLabel = '';\n\t\tthis.displayed = false;\n\t\tthis.valuePopup = null;\n\t\tthis.statePopup = null;\n\t\tthis.displayCheckboxDisabled = false;\n\t\tthis.DOM = {};\n\t}\n\n\tbuild(params)\n\t{\n\t\tthis.updateConfig(params.params);\n\n\t\tthis.DOM.fieldWrap = Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-item'}});\n\n\t\tthis.DOM.labelWrap = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field'}\n\t\t}));\n\t\tthis.DOM.labelNode = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-title'}, text: this.getLabel()\n\t\t}));\n\n\t\t// Label in form\n\t\tthis.DOM.formTitleWrap = this.DOM.labelWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {\n\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle' + (this.isDisplayed() ? ' show' : '')\n\t\t\t}\n\t\t}));\n\t\tthis.DOM.formTitleLabel = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-subtitle-text'},\n\t\t\ttext: this.getFormLabel(),\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\t\tthis.DOM.formTitleEditIcon = this.DOM.formTitleWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-field-edit'},\n\t\t\tevents: {click: this.enableFormTitleEditMode.bind(this)}\n\t\t}));\n\n\t\t// Display checkbox\n\t\tthis.DOM.checkboxNode = this.DOM.fieldWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-checkbox-container'}})).appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\ttype: \"checkbox\", value: 'Y', checked: this.isDisplayed(), disabled: this.displayCheckboxDisabled\n\t\t\t}, events: {\n\t\t\t\tclick: this.checkDisplayMode.bind(this)\n\t\t\t}\n\t\t}));\n\n\t\t// State popup\n\t\tthis.buildStatePopup({\n\t\t\twrap: this.DOM.fieldWrap, config: params.config || {}\n\t\t});\n\n\t\t// Value popup\n\t\tthis.buildValuePopup({\n\t\t\twrap: this.DOM.fieldWrap,\n\t\t\tconfig: params.config || {}\n\t\t});\n\n\t\tif (Type.isFunction(params.changeSettingsCallback))\n\t\t{\n\t\t\tthis.changeSettingsCallback = params.changeSettingsCallback;\n\t\t}\n\n\t\tparams.wrap.appendChild(this.DOM.fieldWrap);\n\t}\n\n\tdestroy()\n\t{\n\t\tif (this.valuePopup && Type.isFunction(this.valuePopup.closePopup))\n\t\t{\n\t\t\tthis.valuePopup.closePopup();\n\t\t}\n\t\tif (this.statePopup && Type.isFunction(this.statePopup.closePopup))\n\t\t{\n\t\t\tthis.statePopup.closePopup();\n\t\t}\n\t}\n\n\tupdateConfig(params = {})\n\t{\n\t\tthis.setFormLabel(params.label || this.formLabel);\n\t\tif (params.show)\n\t\t{\n\t\t\tthis.displayed = params.show !== 'N';\n\t\t}\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t}\n\n\tgetLabel()\n\t{\n\t\treturn this.label;\n\t}\n\n\tgetFormLabel()\n\t{\n\t\treturn this.formLabel;\n\t}\n\n\tsetFormLabel(formLabel)\n\t{\n\t\tthis.formLabel = formLabel || '';\n\t}\n\n\tisDisplayed()\n\t{\n\t\treturn this.displayed;\n\t}\n\n\tcheckDisplayMode()\n\t{\n\t\tthis.displayed = !!this.DOM.checkboxNode.checked;\n\t\tif (this.displayed)\n\t\t{\n\t\t\tthis.displayInForm();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.hideInForm();\n\t\t}\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tDom.addClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\thideInForm ()\n\t{\n\t\tDom.removeClass(this.DOM.formTitleWrap, 'show');\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tenableFormTitleEditMode()\n\t{\n\t\tif (!this.DOM.formTitleInputNode)\n\t\t{\n\t\t\tthis.DOM.formTitleInputNode = this.DOM.formTitleWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-field-subtitle-text'\n\t\t\t\t},\n\t\t\t\tevents: {blur: this.finishFormTitleEditMode.bind(this)}\n\t\t\t}));\n\t\t}\n\n\t\tthis.DOM.formTitleInputNode.value = this.getFormLabel();\n\t\tthis.DOM.formTitleInputNode.style.display = '';\n\t\tthis.DOM.formTitleLabel.style.display = 'none';\n\t\tthis.DOM.formTitleEditIcon.style.display = 'none';\n\t\tthis.DOM.formTitleInputNode.focus();\n\t}\n\n\tfinishFormTitleEditMode()\n\t{\n\t\tthis.setFormLabel(this.DOM.formTitleInputNode.value);\n\t\tDom.adjust(this.DOM.formTitleLabel, {text: this.getFormLabel()});\n\t\tthis.DOM.formTitleLabel.style.display = '';\n\t\tthis.DOM.formTitleEditIcon.style.display = '';\n\t\tthis.DOM.formTitleInputNode.style.display = 'none';\n\t\tthis.triggerChangeRefresh();\n\t}\n\n\tgetSettingsValue()\n\t{\n\n\t}\n\n\ttriggerChangeRefresh()\n\t{\n\t\tsetTimeout(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}.bind(this), 50);\n\t}\n}\n\n\n\n\n","import {Dom, Event} from \"main.core\";\n\nexport class FormFieldTunnerPopupAbstract {\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.menuItems = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t\tthis.handleClickFunc = this.handleClick.bind(this);\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props:{className:'calendar-resbook-webform-settings-popup-select'}}));\n\n\t\tthis.DOM.currentStateLink = this.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\t\t\ttext: this.getCurrentModeState(),\n\t\t\t\t\tevents: {click: this.showPopup.bind(this)}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown() || this.disabled)\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tthis.menuItems = this.getMenuItems();\n\n\t\tEvent.unbind(document, 'click', this.handleClickFunc);\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.currentStateLink,\n\t\t\tthis.menuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tcacheable: false\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 30, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\t//this.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\n\t\t// BX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', function()\n\t\t// {\n\t\t// \tBX.PopupMenu.destroy(this.id);\n\t\t// \tthis.popup = null;\n\t\t// }.bind(this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet inputType = false, className, checked, inputNameStr = '';\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = menuItem.dataset.checked;\n\n\t\t\t\tlet menuItemClassName = 'menu-popup-item';\n\t\t\t\tif (menuItem.dataset.type === 'radio')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'radio';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-radio';\n\t\t\t\t\tif (menuItem.dataset.inputName)\n\t\t\t\t\t{\n\t\t\t\t\t\tinputNameStr = ' name=\"' + menuItem.dataset.inputName + '\" ';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (menuItem.dataset.type === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tinputType = 'checkbox';\n\t\t\t\t\tclassName = 'menu-popup-item-resource-checkbox';\n\t\t\t\t}\n\n\t\t\t\tlet innerHtml = '<div class=\"menu-popup-item-inner\">';\n\t\t\t\tif (menuItem.dataset.type === 'submenu-list')\n\t\t\t\t{\n\t\t\t\t\tmenuItemClassName += ' menu-popup-item-submenu';\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource menu-popup-item-resource-wide\">' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-text\">' +\n\t\t\t\t\t\t'<span>' + menuItem.text + '</span>' +\n\t\t\t\t\t\t'<span class=\"menu-popup-item-resource-subvalue\">' + (menuItem.dataset.textValue || menuItem.dataset.value) + '</span>' +\n\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t\telse if (inputType)\n\t\t\t\t{\n\t\t\t\t\tinnerHtml += '<div class=\"menu-popup-item-resource\">';\n\t\t\t\t\tif (inputType)\n\t\t\t\t\t{\n\t\t\t\t\t\tinnerHtml += '<input class=\"' + className + '\" type=\"' + inputType + '\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\" ' + inputNameStr + '>' +\n\t\t\t\t\t\t\t'<label class=\"menu-popup-item-text\"  for=\"' + menuItem.id + '\">' + menuItem.text + '</label>';\n\t\t\t\t\t}\n\t\t\t\t\tinnerHtml += '</div>';\n\t\t\t\t}\n\n\t\t\t\tinnerHtml += '</div>';\n\n\t\t\t\tmenuItem.layout.item.className = menuItemClassName;\n\t\t\t\tmenuItem.layout.item.innerHTML = innerHtml;\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(()=>{Event.bind(document, 'click', this.handleClickFunc);}, 50);\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn '';\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props : {className : ''}});\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') ||\n\t\t\tBX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap)\n\t\t)\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tif (this.changesTimeout)\n\t\t{\n\t\t\tthis.changesTimeout = clearTimeout(this.changesTimeout);\n\t\t}\n\t\tthis.changesTimeout = setTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\treturn this.closePopup({animation: true});\n\t\t}\n\t}\n\n\tsetDisabled()\n\t{\n\t\tthis.disabled = true;\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.closePopup();\n\t\t}\n\t\tDom.addClass(this.DOM.innerWrap, 'disabled');\n\t}\n\n\tsetEnabled()\n\t{\n\t\tthis.disabled = false;\n\t\tDom.removeClass(this.DOM.innerWrap, 'disabled');\n\t}\n}","import {BookingUtil, Dom} from \"calendar.resourcebooking\";\n\nexport class FormFieldTunnerValuePopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'resourcebooking-settings-value-popup-' + Math.round(Math.random() * 100000);\n\t\tthis.selectedValues = [];\n\t\tthis.DOM = {\n\t\t\touterWrap: params.wrap\n\t\t};\n\t}\n\n\tbuild()\n\t{\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: 'calendar-resbook-webform-settings-popup-select-result'}}));\n\n\t\tthis.DOM.valueLink = this.DOM.innerWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: 'calendar-resbook-webform-settings-popup-select-value'},\n\t\t\ttext: this.getCurrentValueState(),\n\t\t\tevents: {\n\t\t\t\tclick: this.showPopup.bind(this),\n\t\t\t\tmouseover: this.showHoverPopup.bind(this),\n\t\t\t\tmouseout: this.hideHoverPopup.bind(this)\n\t\t\t}\n\t\t}));\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.popup && this.popup.isShown())\n\t\t{\n\t\t\treturn this.popup.close();\n\t\t}\n\n\t\tthis.popup = new BX.PopupWindow(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tloseByEsc: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\twidth: this.getPopupWidth(),\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.getPopupContent()\n\t\t\t});\n\t\tthis.popup.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\n\t\tBX.unbind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\t\tBX.bind(this.DOM.innerWrap, 'click', BX.proxy(this.handlePopupClick, this));\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', BX.delegate(function ()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tthis.popup.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\t}\n\n\tisPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tshowHoverPopup()\n\t{\n\t}\n\n\thideHoverPopup()\n\t{\n\t}\n\n\thandlePopupCloose()\n\t{\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\treturn BX.message('WEBF_RES_NO_VALUE');\n\t}\n\n\tgetPopupContent()\n\t{\n\t\tthis.DOM.innerWrap = Dom.create(\"div\", {props: {className: ''}});\n\n\t\tthis.DOM.innerWrap.style.minWidth = '500px';\n\t\tthis.DOM.innerWrap.style.minHeight = '30px';\n\t\treturn this.DOM.innerWrap;\n\t}\n\n\tgetPopupWidth()\n\t{\n\t\treturn null;\n\t}\n\n\thandlePopupClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target.hasAttribute('data-bx-resbook-control-node') || BX.findParent(target, {attribute: 'data-bx-resbook-control-node'}, this.DOM.innerWrap))\n\t\t{\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsetTimeout(BX.delegate(function(){BX.onCustomEvent('ResourceBooking.webformSettings:onChanged');}, this), 50);\n\t}\n\n\tshowPopupLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hidePopupLoader();\n\t\t\tthis.DOM.popupLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(50));\n\t\t}\n\t}\n\n\thidePopupLoader()\n\t{\n\t\tDom.remove(this.DOM.popupLoader);\n\t}\n}\n\n\texport class FormFieldTunnerMultipleChecknoxPopupAbstract extends FormFieldTunnerValuePopupAbstract{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.id = 'resourcebooking-settings-multiple-checknox-' + Math.round(Math.random() * 100000);\n\t}\n\n\tshowPopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\treturn this.closePopup();\n\t\t}\n\n\t\tvar menuItems = [];\n\n\t\tthis.values.forEach(function(item)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\tid: item.id,\n\t\t\t\ttext: BX.util.htmlspecialchars(item.title),\n\t\t\t\tdataset: item.dataset,\n\t\t\t\tonclick: BX.proxy(this.menuItemClick, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tthis.selectAllMessage = this.selectAllMessage || 'select all';\n\t\t\tmenuItems.push({\n\t\t\t\ttext: this.selectAllMessage,\n\t\t\t\tonclick: BX.proxy(this.selectAllItemClick, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.valueLink,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.popupWindow.setAngle({offset: 60, position: 'top'});\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function()\n\t\t{\n\t\t\tthis.handlePopupCloose();\n\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\tthis.popup = null;\n\t\t}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tvar checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.id)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(itemId){return itemId === menuItem.id});\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.values.find(function(value){\n\t\t\t\t\treturn !this.selectedValues.find(function(itemId){return itemId === value.id});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + menuItem.text + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar\n\t\t\tselectAllcheckbox,\n\t\t\ttarget = e.target || e.srcElement,\n\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\tfoundValue = this.values.find(function(value){return value.id === menuItem.id;});\n\n\t\tif (foundValue)\n\t\t{\n\t\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\") || Dom.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t{\n\t\t\t\tif (!Dom.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t{\n\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t}\n\n\t\t\t\tif (checkbox.checked)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(foundValue);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.deselectItem(foundValue);\n\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t{\n\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\tselectItem(value)\n\t{\n\t\tif (!BX.util.in_array(value.id, this.selectedValues))\n\t\t{\n\t\t\tthis.selectedValues.push(value.id);\n\t\t}\n\t}\n\tdeselectItem(value)\n\t{\n\t\tvar index = BX.util.array_search(value.id, this.selectedValues);\n\t\tif (index >= 0)\n\t\t{\n\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t}\n\t}\n\n\tselectAllItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target && (Dom.hasClass(target, \"menu-popup-item\") || Dom.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t{\n\t\t\tvar checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\tif (Dom.hasClass(target, \"menu-popup-item\"))\n\t\t\t{\n\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t}\n\n\t\t\tvar i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t{\n\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t}\n\t\t\tthis.selectedValues = [];\n\t\t\tif (this.selectAllChecked)\n\t\t\t{\n\t\t\t\tthis.values.forEach(function(value){this.selectedValues.push(value.id);}, this);\n\t\t\t}\n\t\t\tthis.handleControlChanges();\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (this.isPopupShown() && !BX.isParentForNode(this.popupContainer, target))\n\t\t{\n\t\t\tthis.closePopup({animation: true});\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tclosePopup()\n\t{\n\t\tif (this.isPopupShown())\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerValuePopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom, Tag, Text} from \"main.core\";\nimport {MenuItem} from \"main.popup\";\nimport { Dialog as EntitySelectorDialog } from 'ui.entity-selector';\nimport {EventEmitter} from 'main.core.events';\n\n\nexport class UserSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_USERS');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_USERS_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.selectedUsers = [];\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tthis.statePopup = new UsersStatePopup(params);\n\t}\n\n\tbuildValuePopup(params)\n\t{\n\t\tthis.selectedUsers = Type.isArray(params.config.selected)\n\t\t\t? params.config.selected\n\t\t\t: params.config.selected.split('|');\n\n\t\tthis.DOM.valueWrap = params.wrap;\n\n\t\tthis.DOM.valueWrap.appendChild(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"calendar-resbook-webform-settings-popup-select-result\">\n\t\t\t\t\t${this.DOM.usersValueLink = Tag.render`\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"calendar-resbook-webform-settings-popup-select-value\"\n\t\t\t\t\t\t\tonclick=\"${this.showUserSelectorDialog.bind(this)}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t${this.getCurrentUsersValueText()}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`}\n\t\t\t\t</div>\n\t\t\t`\n\t\t);\n\t}\n\n\tgetCurrentUsersValueText()\n\t{\n\t\tconst count = this.selectedUsers.length;\n\t\treturn count\n\t\t\t? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_USER', count))\n\t\t\t: Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\tshowUserSelectorDialog()\n\t{\n\t\tif (!(this.userSelectorDialog instanceof EntitySelectorDialog))\n\t\t{\n\t\t\tthis.userSelectorDialog = new EntitySelectorDialog({\n\t\t\t\ttargetNode: this.DOM.usersValueLink,\n\t\t\t\tcontext: 'RESOURCEBOOKING',\n\t\t\t\tpreselectedItems: this.selectedUsers.map((userId) => {return ['user', userId]}),\n\t\t\t\tenableSearch: true,\n\t\t\t\tzIndex: this.zIndex + 10,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t\t'Item:onDeselect': this.handleUserSelectorChanges.bind(this),\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tanalyticsSource: 'calendar',\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\n\t\tthis.userSelectorDialog.show();\n\t}\n\n\thandleUserSelectorChanges()\n\t{\n\t\tthis.selectedUsers = [];\n\n\t\tthis.userSelectorDialog.getSelectedItems().forEach((item) => {\n\t\t\tif (item.entityId === \"user\")\n\t\t\t{\n\t\t\t\tthis.selectedUsers.push(item.id);\n\t\t\t}\n\t\t});\n\n\t\tthis.DOM.usersValueLink.innerHTML = this.getCurrentUsersValueText();\n\n\t\tEventEmitter.emit('ResourceBooking.settingsUserSelector:onChanged');\n\t\tsetTimeout(() => {EventEmitter.emit('ResourceBooking.webformSettings:onChanged')}, 50);\n\t}\n\n\tdisplayInForm()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tvalue: this.selectedUsers\n\t\t};\n\t}\n}\n\nclass UsersStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'usersStatePopup';\n\t\tthis.inputName = 'user-select-mode';\n\t\tthis.id = 'users-state-' + Math.round(Math.random() * 1000);\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE'),\n\t\t\t\tdelimiter: true\n\t\t\t}),\n\t\t\t{\n\t\t\t\tid: 'users-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'users-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_FREE_USER'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tvar target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset && menuItem.dataset.inputName === this.inputName\n\t\t)\n\t\t{\n\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t}\n\t\tthis.handleControlChanges();\n\t\tsetTimeout(this.closePopup.bind(this), 50);\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_USER_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_USER_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {Loc, Type, Dom} from \"main.core\";\nimport {MenuItem} from \"main.popup\";\n\nexport class ResourceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_RESOURCES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_RESOURCES_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig(params);\n\t\tthis.defaultMode = params.defaultMode;\n\t\tthis.multiple = params.multiple === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultMode = params.defaultMode || this.defaultMode;\n\t\tparams.multiple = params.multiple == null ? this.multiple : params.multiple;\n\t\tthis.statePopup = new ResourcesStatePopup(params);\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ResourcesValuePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setEnabled();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t\tthis.statePopup.setDisabled();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultMode: this.statePopup.getDefaultMode(),\n\t\t\tmultiple: this.statePopup.getMultiple() ? 'Y' : 'N',\n\t\t\tvalue: this.valuePopup.getSelectedId()\n\t\t};\n\t}\n}\n\n\nclass ResourcesStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesStatePopup';\n\t\tthis.inputName = 'resource-select-mode';\n\t\tthis.defaultMode = params.defaultMode === 'none' ? 'none' : 'auto';\n\t\tthis.multiple = !!params.multiple;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_TITLE'),\n\t\t\t\tdelimiter: true\n\t\t\t}),\n\t\t\t{\n\t\t\t\tid: 'resources-state-list',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DEFAULT_EMPTY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'none',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'none'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-auto',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_AUTO_SELECT_RES'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'auto',\n\t\t\t\t\tinputName: this.inputName,\n\t\t\t\t\tchecked: this.defaultMode === 'auto'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'resources-state-multiple',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_MULTIPLE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.multiple\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_SHORT') +\n\t\t\t\t(this.defaultMode === 'none'\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: (',<br>' + Loc.getMessage('WEBF_RES_AUTO_SELECT_RES_SHORT'))\n\t\t\t\t))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_RES_FROM_LIST_AUTO');\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.inputName)\n\t\t\t{\n\t\t\t\tthis.defaultMode = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === 'resources-state-multiple')\n\t\t\t{\n\t\t\t\tthis.multiple = !!target.checked;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetDefaultMode()\n\t{\n\t\treturn this.defaultMode;\n\t}\n\n\tgetMultiple()\n\t{\n\t\treturn this.multiple;\n\t}\n}\n\n\nclass ResourcesValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'resourcesValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('USER_TYPE_RESOURCE_SELECT_ALL');\n\n\t\tlet\n\t\t\tselectedItems, selectedIndex = {},\n\t\t\tselectAll = params.config.selected === null;\n\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[selectedItems[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\t\tif (Type.isArray(params.config.resources))\n\t\t{\n\t\t\tparams.config.resources.forEach(function(resource)\n\t\t\t{\n\t\t\t\tlet valueId = this.prepareValueId(resource);\n\t\t\t\tthis.values.push({\n\t\t\t\t\tid: valueId,\n\t\t\t\t\ttitle: resource.title,\n\t\t\t\t\tdataset: resource\n\t\t\t\t});\n\n\t\t\t\tif (selectAll || selectedIndex[resource.id])\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push(valueId);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_RESOURCE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n\n\tprepareValueId(resource)\n\t{\n\t\treturn resource.type + '|' + resource.id;\n\t}\n\n\tgetSelectedId()\n\t{\n\t\tlet result = [];\n\t\tthis.getSelectedValues().forEach(function(value)\n\t\t{\n\t\t\tlet val = value.split('|');\n\t\t\tif (val && val[1])\n\t\t\t{\n\t\t\t\tresult.push(parseInt(val[1]));\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n}\n\n\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerMultipleChecknoxPopupAbstract} from \"../formfieldtunnervaluepopupabstract\";\nimport {ResourcebookingUserfield} from \"../resourcebookinguserfield\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type, Dom} from \"main.core\";\n\nexport class ServiceSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_SERVICES');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_SERVICE_LABEL');\n\t\tthis.displayed = true;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tif (params && Type.isDomNode(params.wrap))\n\t\t{\n\t\t\tparams.wrap.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className:'calendar-resbook-webform-settings-popup-select disabled'},\n\t\t\t\thtml: '<span class=\"calendar-resbook-webform-settings-popup-select-value\">' + Loc.getMessage('WEBF_RES_FROM_LIST') + '</span>'\n\t\t\t}));\n\t\t}\n\t}\n\n\tbuildValuePopup (params)\n\t{\n\t\tthis.valuePopup = new ServiceValuePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tvalue: this.valuePopup.getSelectedValues()\n\t\t};\n\t}\n}\n\n\nclass ServiceValuePopup extends FormFieldTunnerMultipleChecknoxPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'ServiceValuePopup';\n\t\tthis.selectAllMessage = Loc.getMessage('WEBF_RES_SELECT_ALL_SERVICES');\n\n\t\tlet selectAll = params.config.selected === null || params.config.selected === '' || params.config.selected === undefined;\n\t\tthis.values = [];\n\t\tthis.selectedValues = [];\n\n\t\tlet selectedItems, selectedIndex = {};\n\t\tif (Type.isArray(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected;\n\t\t}\n\t\telse if (Type.isString(params.config.selected))\n\t\t{\n\t\t\tselectedItems = params.config.selected.split('|');\n\t\t}\n\n\t\tif (Type.isArray(selectedItems))\n\t\t{\n\t\t\tfor(let i = 0; i < selectedItems.length; i++)\n\t\t\t{\n\t\t\t\tselectedIndex[BookingUtil.translit(selectedItems[i])] = true;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.config.services))\n\t\t{\n\t\t\tparams.config.services.forEach(function(service)\n\t\t\t{\n\t\t\t\tservice.id = BookingUtil.translit(service.name);\n\t\t\t\tif (service.id !== '')\n\t\t\t\t{\n\t\t\t\t\tthis.values.push({\n\t\t\t\t\t\tid: service.id,\n\t\t\t\t\t\ttitle: service.name + ' - ' + BookingUtil.getDurationLabel(service.duration),\n\t\t\t\t\t\tdataset: service\n\t\t\t\t\t});\n\n\t\t\t\t\tif (selectAll || selectedIndex[BookingUtil.translit(service.name)])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues.push(service.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.config = {};\n\t\tthis.build();\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.valueLink, {text: this.getCurrentValueState()});\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\treturn this.selectedValues.length ? this.selectedValues : '#EMPTY-SERVICE-LIST#';\n\t}\n\n\tgetCurrentValueState()\n\t{\n\t\tlet count = this.selectedValues.length;\n\t\treturn count ? (count + ' ' + ResourcebookingUserfield.getPluralMessage('WEBF_RES_SERVICE', count)) : Loc.getMessage('WEBF_RES_NO_VALUE');\n\t}\n}\n\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\n\nexport class DurationSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DURATION');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DURATION_LABEL');\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.defaultValue = params.defaultValue;\n\t\tthis.manualInput = params.manualInput === 'Y';\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.isDisplayed = this.isDisplayed.bind(this);\n\t\tparams.defaultValue = this.defaultValue;\n\t\tparams.manualInput = this.manualInput;\n\t\tthis.statePopup = new DurationStatePopup(params);\n\t}\n\n\tdisplayInForm ()\n\t{\n\t\tsuper.displayInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\thideInForm ()\n\t{\n\t\tsuper.hideInForm();\n\t\tthis.statePopup.handleControlChanges();\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tshow: this.isDisplayed() ? 'Y' : 'N',\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tdefaultValue: this.statePopup.getDefaultValue(),\n\t\t\tmanualInput: this.statePopup.getManualInput() ? 'Y' : 'N'\n\t\t};\n\t}\n}\n\n\nclass DurationStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'durationStatePopup';\n\t\tthis.inputName = 'duration-select-mode';\n\t\tthis.manualInput = !!params.manualInput;\n\t\tthis.defaultValue = params.defaultValue || 60;\n\t\tthis.isDisplayed = Type.isFunction(params.isDisplayed) ? params.isDisplayed : function(){return false;};\n\t\tthis.durationList = BookingUtil.getDurationList(params.fullDay);\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'duration-default-value',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_DURATION_AUTO'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.defaultValue,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.defaultValue)\n\t\t\t\t},\n\t\t\t\titems: this.getDefaultMenuItems()\n\t\t\t}].concat((this.isDisplayed()\n\t\t\t? [\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'duration-manual-input',\n\t\t\t\t\ttext: Loc.getMessage('WEBF_RES_SELECT_MANUAL_INPUT'),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\t\tchecked: this.manualInput\n\t\t\t\t\t},\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t}\n\t\t\t]\n\t\t\t: []));\n\t}\n\n\tgetDefaultMenuItems()\n\t{\n\t\tlet menuItems = [];\n\n\t\tif (Type.isArray(this.durationList))\n\t\t{\n\t\t\tthis.durationList.forEach(function(item)\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: 'duration-' + item.value,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\ttype: 'duration',\n\t\t\t\t\t\tvalue: item.value\n\t\t\t\t\t},\n\t\t\t\t\ttext: item.label,\n\t\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t\t});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.durationList.find(function(item){return parseInt(item.value) === parseInt(duration)});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn this.isDisplayed()\n\t\t\t?\n\t\t\t(Loc.getMessage('WEBF_RES_SELECT_DURATION_FROM_LIST_SHORT')\n\t\t\t\t+ (',<br>' + Loc.getMessage('WEBF_RES_SELECT_DURATION_BY_DEFAULT') + ' ' + this.getDurationLabelByValue(this.defaultValue)))\n\t\t\t:\n\t\t\tLoc.getMessage('WEBF_RES_SELECT_DURATION_AUTO') + ' ' + this.getDurationLabelByValue(this.defaultValue);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t\tBX.onCustomEvent(this, \"ResourceBooking.userSettingsField:onControlChanged\", []);\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.id === 'duration-manual-input')\n\t\t\t{\n\t\t\t\tthis.manualInput = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'duration')\n\t\t{\n\t\t\tthis.defaultValue = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetManualInput()\n\t{\n\t\treturn this.manualInput;\n\t}\n\n\tgetDefaultValue()\n\t{\n\t\treturn this.defaultValue;\n\t}\n}","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {Loc, Type, Dom} from \"main.core\";\nimport { MenuItem } from 'main.popup';\n\nexport class DateSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_DATE');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_DATE_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.start = params.start;\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.start = params.start || this.start;\n\t\tthis.statePopup = new DateStatePopup(params);\n\t}\n\n\tgetValue ()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tstart: this.statePopup.getStart()\n\t\t};\n\t}\n}\n\n\nclass DateStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'dateStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\t\tthis.startInputName = 'date-select-start';\n\t\tthis.style = params.style === 'popup' ? 'popup' : 'line'; // popup|line\n\t\tthis.start = params.start === 'today' ? 'today' : 'free'; // today|free\n\t\tthis.build();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE'),\n\t\t\t\tdelimiter: true\n\t\t\t}),\n\t\t\t{\n\t\t\t\tid: 'date-state-style-popup',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'popup',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'popup'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-style-line',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'line',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'line'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM'),\n\t\t\t\tdelimiter: true\n\t\t\t}),\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-today',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'today',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'today'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'date-state-start-from-free',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'free',\n\t\t\t\t\tinputName: this.startInputName,\n\t\t\t\t\tchecked: this.start === 'free'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'popup'\n\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_STYLE_POPUP')\n\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_STYLE_LINE'))\n\t\t\t+ ', '\n\t\t\t+ (this.start === 'today'\n\t\t\t\t? Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_TODAY_SHORT')\n\t\t\t\t: Loc.getMessage('WEBF_RES_CALENDAR_START_FROM_FREE_SHORT'));\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tDom.adjust(this.DOM.currentStateLink, {text: this.getCurrentModeState()});\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.dataset.inputName === this.startInputName)\n\t\t\t{\n\t\t\t\tthis.start = menuItem.dataset.value;\n\t\t\t}\n\t\t}\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetStart()\n\t{\n\t\treturn this.start;\n\t}\n}\n\n","import {FormFieldTunnerAbstract} from \"../formfieldtunnerabstract\";\nimport {FormFieldTunnerPopupAbstract} from \"../formfieldtunnerpopupabstract\";\nimport {BookingUtil} from \"calendar.resourcebooking\";\nimport {Loc, Type} from \"main.core\";\nimport {MenuItem} from \"main.popup\";\n\nexport class TimeSelectorFieldTunner extends FormFieldTunnerAbstract {\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.label = Loc.getMessage('WEBF_RES_TIME');\n\t\tthis.formLabel = Loc.getMessage('WEBF_RES_TIME_LABEL');\n\t\tthis.displayed = true;\n\t\tthis.displayCheckboxDisabled = true;\n\t}\n\n\tupdateConfig(params)\n\t{\n\t\tsuper.updateConfig();\n\t\tthis.style = params.style;\n\t\tthis.showOnlyFree = params.showOnlyFree === 'Y';\n\t\tthis.showFinishTime = params.showFinishTime === 'Y';\n\t\tthis.scale = parseInt(params.scale);\n\t}\n\n\tbuildStatePopup(params)\n\t{\n\t\tparams.style = params.style || this.style;\n\t\tparams.showOnlyFree = this.showOnlyFree;\n\t\tparams.showFinishTime = this.showFinishTime;\n\t\tparams.scale = this.scale;\n\t\tthis.statePopup = new TimeStatePopup(params);\n\t}\n\n\tgetValue()\n\t{\n\t\treturn {\n\t\t\tlabel: this.getFormLabel(),\n\t\t\tstyle: this.statePopup.getStyle(),\n\t\t\tshowFinishTime: this.statePopup.getShowFinishTime(),\n\t\t\tshowOnlyFree: this.statePopup.getShowOnlyFree(),\n\t\t\tscale: this.statePopup.getScale()\n\t\t};\n\t}\n}\n\n\nclass TimeStatePopup extends FormFieldTunnerPopupAbstract\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\t\tthis.name = 'timeStatePopup';\n\t\tthis.styleInputName = 'date-select-style';\n\n\t\tthis.showOnlyFree = params.showOnlyFree;\n\t\tthis.showFinishTime = params.showFinishTime;\n\t\tthis.scale = params.scale;\n\t\tthis.stateShowFreeId = 'time-state-show-free';\n\t\tthis.stateShowFinishId = 'time-state-show-finish';\n\t\tthis.style = params.style === 'select' ? 'select' : 'slots'; // select|slots\n\n\t\tthis.build();\n\t}\n\n\tbuild()\n\t{\n\t\tsuper.build();\n\t\tthis.handleControlChanges();\n\t}\n\n\tgetMenuItems()\n\t{\n\t\treturn [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE'),\n\t\t\t\tdelimiter: true\n\t\t\t}),\n\t\t\t{\n\t\t\t\tid: 'time-state-style-select',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'select',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'select'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-style-slots',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'radio',\n\t\t\t\t\tvalue: 'slots',\n\t\t\t\t\tinputName: this.styleInputName,\n\t\t\t\t\tchecked: this.style === 'slots'\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'time-state-scale',\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'submenu-list',\n\t\t\t\t\tvalue: this.scale,\n\t\t\t\t\ttextValue: this.getDurationLabelByValue(this.scale)\n\t\t\t\t},\n\t\t\t\titems: this.getDurationMenuItems()\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFreeId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FREE_ONLY'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showOnlyFree\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: this.stateShowFinishId,\n\t\t\t\ttext: Loc.getMessage('WEBF_RES_TIME_SHOW_FINISH_TIME'),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\tchecked: this.showFinishTime\n\t\t\t\t},\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t}\n\t\t];\n\t}\n\n\tgetCurrentModeState()\n\t{\n\t\treturn (this.style === 'select'\n\t\t\t? Loc.getMessage('WEBF_RES_TIME_STYLE_SELECT')\n\t\t\t: Loc.getMessage('WEBF_RES_TIME_STYLE_SLOT'))\n\t\t\t+ ',<br>'\n\t\t\t+ Loc.getMessage('WEBF_RES_TIME_BOOKING_SIZE') + ': '\n\t\t\t+ this.getDurationLabelByValue(this.scale);\n\t}\n\n\thandleControlChanges()\n\t{\n\t\tsuper.handleControlChanges();\n\t\tthis.DOM.currentStateLink.innerHTML = this.getCurrentModeState();\n\t}\n\n\tmenuItemClick(e, menuItem)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Type.isDomNode(target) && target.nodeName.toLowerCase() === 'input'\n\t\t\t&& menuItem.dataset)\n\t\t{\n\t\t\tif (menuItem.dataset.inputName === this.styleInputName)\n\t\t\t{\n\t\t\t\tthis.style = menuItem.dataset.value;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFreeId)\n\t\t\t{\n\t\t\t\tthis.showOnlyFree = !!target.checked;\n\t\t\t}\n\t\t\telse if (menuItem.id === this.stateShowFinishId)\n\t\t\t{\n\t\t\t\tthis.showFinishTime = !!target.checked;\n\t\t\t}\n\t\t}\n\t\telse if (menuItem.dataset && menuItem.dataset.type === 'scale')\n\t\t{\n\t\t\tthis.scale = parseInt(menuItem.dataset.value);\n\t\t}\n\n\t\tthis.handleControlChanges();\n\t}\n\n\n\tgetDurationMenuItems()\n\t{\n\t\tlet\n\t\t\tdurationList = this.getDurationList(),\n\t\t\tmenuItems = [];\n\n\t\tdurationList.forEach(function(duration){\n\t\t\tmenuItems.push({\n\t\t\t\tid: 'duration-' + duration.value,\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: 'scale',\n\t\t\t\t\tvalue: duration.value\n\t\t\t\t},\n\t\t\t\ttext: duration.label,\n\t\t\t\tonclick: this.menuItemClick.bind(this)\n\t\t\t});\n\t\t}, this);\n\n\t\treturn menuItems;\n\t}\n\n\n\tgetDurationList()\n\t{\n\t\tif (!this.durationList)\n\t\t{\n\t\t\tthis.durationList = BookingUtil.getDurationList(false);\n\t\t\tthis.durationList = this.durationList.filter(function(duration)\n\t\t\t{\n\t\t\t\treturn duration.value && duration.value >= 15 && duration.value <= 240;\n\t\t\t});\n\t\t}\n\t\treturn this.durationList;\n\t}\n\n\tgetDurationLabelByValue(duration)\n\t{\n\t\tlet foundDuration = this.getDurationList().find(function(item){return item.value === duration});\n\t\treturn foundDuration ? foundDuration.label : null;\n\t}\n\n\tgetStyle()\n\t{\n\t\treturn this.style;\n\t}\n\n\tgetScale()\n\t{\n\t\treturn this.scale;\n\t}\n\n\tgetShowOnlyFree()\n\t{\n\t\treturn this.showOnlyFree ? 'Y' : 'N';\n\t}\n\n\tgetShowFinishTime()\n\t{\n\t\treturn this.showFinishTime ? 'Y' : 'N';\n\t}\n}\n\n\n","import {BookingUtil, FieldViewControllerEdit, FieldViewControllerPreview, Dom, Loc, Type, BaseEvent, EventEmitter, Runtime} from \"calendar.resourcebooking\";\nimport {ResourcebookingUserfield} from \"./resourcebookinguserfield\";\nimport {UserSelectorFieldTunner} from \"./controls/userselectorfieldtunner\";\nimport {ResourceSelectorFieldTunner} from \"./controls/resourceselectorfieldtunner\";\nimport {ServiceSelectorFieldTunner} from \"./controls/serviceselectorfieldtunner\";\nimport {DurationSelectorFieldTunner} from \"./controls/durationselectorfieldtunner\";\nimport {DateSelectorFieldTunner} from \"./controls/dateselectorfieldtunner\";\nimport {TimeSelectorFieldTunner} from \"./controls/timeselectorfieldtunner\";\nimport 'helper';\n\nexport class AdjustFieldController extends EventEmitter\n{\n\tconstructor(params)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Calendar.ResourcebookingUserfield.AdjustFieldController');\n\n\t\tthis.params = params;\n\t\tthis.complexFields = {};\n\t\tthis.userFieldParams = null;\n\t\tthis.id = 'resbook-settings-popup-' + Math.round(Math.random() * 100000);\n\n\t\tthis.settingsData = AdjustFieldController.getSettingsData(this.params.settings.data);\n\t\tthis.params.settings.data = this.settingsData;\n\n\t\tthis.DOM = {\n\t\t\tinnerWrap: this.params.innerWrap,\n\t\t\tsettingsWrap: this.params.innerWrap.appendChild(Dom.create(\"div\", {attrs: {'data-bx-resource-field-settings': 'Y'}})),\n\t\t\tcaptionNode: this.params.captionNode,\n\t\t\tsettingsInputs: {}\n\t\t};\n\t}\n\n\tinit()\n\t{\n\t\t// Request field params\n\t\tthis.showFieldLoader();\n\n\t\tResourcebookingUserfield.getUserFieldParams({\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\t(fieldParams) => {\n\t\t\t\tthis.hideFieldLoader();\n\t\t\t\tthis.userFieldParams = fieldParams;\n\n\t\t\t\tthis.fieldLayout = new FieldViewControllerEdit({\n\t\t\t\t\twrap: this.DOM.innerWrap,\n\t\t\t\t\tdisplayTitle: false,\n\t\t\t\t\ttitle: this.getCaption(),\n\t\t\t\t\tsettings: this.getSettings()\n\t\t\t\t});\n\t\t\t\tthis.fieldLayout.build();\n\t\t\t\tthis.updateSettingsDataInputs();\n\n\t\t\t\tthis.emit('afterInit', new BaseEvent({\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfieldName: this.params.entityName,\n\t\t\t\t\t\tsettings: this.getSettings()\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t);\n\t}\n\n\tshowSettingsPopup()\n\t{\n\t\tResourcebookingUserfield.getUserFieldParams(\n\t\t{\n\t\t\tfieldName: this.params.entityName,\n\t\t\tselectedUsers: this.getSelectedUsers()\n\t\t}).then(\n\t\t\tfunction(fieldParams)\n\t\t\t{\n\t\t\t\tthis.userFieldParams = fieldParams;\n\t\t\t\tthis.settingsPopupId = 'calendar-resourcebooking-settings-popup-' + Math.round(Math.random() * 100000);\n\t\t\t\tthis.settingsPopup = new BX.PopupWindow(\n\t\t\t\t\tthis.settingsPopupId,\n\t\t\t\t\tnull,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: this.getSettingsContentNode(),\n\t\t\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-window',\n\t\t\t\t\t\tautoHide: false,\n\t\t\t\t\t\tlightShadow: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\toverlay: {backgroundColor: 'black', opacity: 500},\n\t\t\t\t\t\tzIndex: -400,\n\t\t\t\t\t\ttitleBar: Loc.getMessage('WEBF_RES_SETTINGS'),\n\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\tbuttons : [new BX.PopupWindowButton({})]\n\t\t\t\t\t});\n\n\t\t\t\tlet buttonNodeWrap = this.settingsPopup.buttons[0].buttonNode.parentNode;\n\t\t\t\tDom.remove(this.settingsPopup.buttons[0].buttonNode);\n\t\t\t\tthis.settingsPopup.buttons[0].buttonNode = buttonNodeWrap.appendChild(Dom.create(\n\t\t\t\t\t\"button\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops : { className : 'ui-btn ui-btn-success'},\n\t\t\t\t\t\tevents: {click: function(){this.settingsPopup.close();}.bind(this)},\n\t\t\t\t\t\ttext : Loc.getMessage('WEBF_RES_CLOSE_SETTINGS_POPUP')\n\t\t\t\t\t}\n\t\t\t\t));\n\n\t\t\t\tBX.removeClass(this.settingsPopup.buttons[0].buttonNode, 'popup-window-button');\n\t\t\t\tthis.settingsPopup.show();\n\n\t\t\t\tBX.addCustomEvent(this.settingsPopup, 'onPopupClose', function(popup)\n\t\t\t\t{\n\t\t\t\t\tthis.destroyControls();\n\t\t\t\t\tthis.settingsPopup.destroy(this.id);\n\t\t\t\t\tthis.settingsPopup = null;\n\t\t\t\t\tif (this.previewFieldLayout)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.previewFieldLayout.destroy();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetSettingsContentNode()\n\t{\n\t\tlet outerWrap = Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup'}});\n\n\t\tlet leftWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-inner'}}));\n\t\tthis.buildSettingsForm({wrap: leftWrap});\n\n\t\tlet previewWrap = outerWrap.appendChild(Dom.create(\"div\", {props : { className : 'calendar-resbook-webform-settings-popup-preview'}}));\n\n\t\tthis.previewFieldLayout = new FieldViewControllerPreview({\n\t\t\twrap: previewWrap,\n\t\t\ttitle: this.getCaption(),\n\t\t\tsettings: this.getSettings()\n\t\t});\n\t\tthis.previewFieldLayout.build();\n\n\t\tBX.addCustomEvent('ResourceBooking.webformSettings:onChanged', this.handleWebformSettingsChanges.bind(this));\n\n\t\treturn outerWrap;\n\t}\n\n\tbuildSettingsForm(params)\n\t{\n\t\tlet\n\t\t\tsettings = this.getSettings(),\n\t\t\twrap = params.wrap,\n\t\t\ttitleId = 'title-' + this.id;\n\n\t\tthis.DOM.captionWrap = wrap.appendChild(Dom.create(\"div\", {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-title'},\n\t\t\thtml: '<label for=\"' + titleId + '\" class=\"calendar-resbook-webform-settings-popup-label\">' + Loc.getMessage('WEBF_RES_NAME_LABEL') + '</label>'\n\t\t}));\n\t\tthis.DOM.captionInput = this.DOM.captionWrap.appendChild(Dom.create(\"input\", {\n\t\t\tattrs: {\n\t\t\t\tid: titleId,\n\t\t\t\tclassName: 'calendar-resbook-webform-settings-popup-input',\n\t\t\t\ttype: 'text',\n\t\t\t\tvalue: this.getCaption()\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tchange: this.updateCaption.bind(this),\n\t\t\t\tblur: this.updateCaption.bind(this),\n\t\t\t\tkeyup: this.updateCaption.bind(this)\n\t\t\t}\n\t\t}));\n\t\tthis.updateCaption();\n\n\t\tthis.DOM.fieldsOuterWrap = wrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-content'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-head\">' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_NAME') + '</span>' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-decs\">' + Loc.getMessage('WEBF_RES_FIELD_NAME_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<div class=\"calendar-resbook-webform-settings-popup-head-inner\">' +\n\t\t\t\t'<span class=\"calendar-resbook-webform-settings-popup-head-text\">' + Loc.getMessage('WEBF_RES_FIELD_SHOW_IN_FORM') + '</span>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'</div>'\n\t\t}));\n\n\t\tthis.DOM.fieldsWrap = this.DOM.fieldsOuterWrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-list'}\n\t\t}));\n\n\t\tif (settings.userfieldSettings.useUsers)\n\t\t{\n\t\t\tthis.buildComplexField('users', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.users,\n\t\t\t\tconfig: {\n\t\t\t\t\tusers: settings.userfieldSettings.users,\n\t\t\t\t\tselected: settings.data.users.value\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('ResourceBooking.settingsUserSelector:onChanged', this.checkBitrix24Limitation.bind(this));\n\t\t}\n\n\t\tif (settings.userfieldSettings.useResources)\n\t\t{\n\t\t\tthis.buildComplexField('resources', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.resources,\n\t\t\t\tconfig: {\n\t\t\t\t\tresources: settings.userfieldSettings.resources,\n\t\t\t\t\tselected: settings.data.resources.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (settings.userfieldSettings.useServices)\n\t\t{\n\t\t\tthis.buildComplexField('services', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.services,\n\t\t\t\tconfig: {\n\t\t\t\t\tservices: settings.userfieldSettings.services,\n\t\t\t\t\tselected: settings.data.services.value\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.buildComplexField('duration', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.duration\n\t\t\t});\n\t\t}\n\n\t\tthis.buildComplexField('date', {\n\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\tparams: settings.data.date\n\t\t});\n\n\t\tif (!settings.userfieldSettings.fullDay)\n\t\t{\n\t\t\tthis.buildComplexField('time', {\n\t\t\t\twrap: this.DOM.fieldsWrap,\n\t\t\t\tchangeSettingsCallback: this.updateSettings.bind(this),\n\t\t\t\tparams: settings.data.time\n\t\t\t});\n\t\t}\n\n\t\tthis.DOM.fieldsWrap.appendChild(Dom.create('div', {\n\t\t\tprops : { className : 'calendar-resbook-webform-settings-popup-item'},\n\t\t\thtml: '<div class=\"calendar-resbook-webform-settings-popup-decs\">' +\n\t\t\t\t(Loc.getMessage('WEBF_RES_BOOKING_SETTINGS_HELP')\n\t\t\t\t\t.replace('#START_LINK#', '<a href=\"javascript:void(0);\"' +\n\t\t\t\t\t\t' onclick=\"if (top.BX.Helper){top.BX.Helper.show(\\'redirect=detail&code=8366733\\');}\">')\n\t\t\t\t\t.replace('#END_LINK#', '</a>')) +\n\t\t\t\t'</div>'\n\t\t}));\n\t}\n\n\tdestroyControls()\n\t{\n\t\tfor (let k in this.complexFields)\n\t\t{\n\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].destroy))\n\t\t\t{\n\t\t\t\tthis.complexFields[k].destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleWebformSettingsChanges()\n\t{\n\t\tif (this.refreshLayoutTimeout)\n\t\t{\n\t\t\tthis.refreshLayoutTimeout = clearTimeout(this.refreshLayoutTimeout);\n\t\t}\n\n\t\tthis.refreshLayoutTimeout = setTimeout(function()\n\t\t{\n\t\t\t// Update settings and inputs\n\t\t\tfor (let k in this.complexFields)\n\t\t\t{\n\t\t\t\tif (this.complexFields.hasOwnProperty(k) && Type.isFunction(this.complexFields[k].getValue))\n\t\t\t\t{\n\t\t\t\t\tthis.settingsData[k] = this.complexFields[k].getValue();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateSettingsDataInputs();\n\n\t\t\t// Refresh preview\n\t\t\tthis.previewFieldLayout.refreshLayout(this.settingsData);\n\t\t\t// Refresh form layout (behind the settings popup)\n\t\t\tthis.fieldLayout.refreshLayout(this.settingsData);\n\n\t\t\t// Small Hack to make form look better - height adjusment\n\t\t\tthis.previewFieldLayout.getOuterWrap().style.maxHeight = Math.round(this.previewFieldLayout.getInnerWrap().offsetHeight * 0.73) + 'px';\n\t\t}.bind(this), 100);\n\t}\n\n\tbuildComplexField(type, params)\n\t{\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'users':\n\t\t\t\tthis.complexFields[type] = new UserSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'resources':\n\t\t\t\tthis.complexFields[type] = new ResourceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'services':\n\t\t\t\tthis.complexFields[type] = new ServiceSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'duration':\n\t\t\t\tthis.complexFields[type] = new DurationSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t\tcase 'date':\n\t\t\t \tthis.complexFields[type] = new DateSelectorFieldTunner();\n\t\t\t \tbreak;\n\t\t\tcase 'time':\n\t\t\t\tthis.complexFields[type] = new TimeSelectorFieldTunner();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (Type.isObject(this.complexFields[type]))\n\t\t{\n\t\t\tthis.complexFields[type].build(params);\n\t\t}\n\t}\n\n\tstatic getSettingsData(data)\n\t{\n\t\tlet\n\t\t\tfield, option,\n\t\t\tsettingsData = BX.clone(AdjustFieldController.getDefaultSettingsData(), true);\n\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tfor (field in data)\n\t\t\t{\n\t\t\t\tif (data.hasOwnProperty(field) && settingsData[field])\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(data[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (option in data[field])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (data[field].hasOwnProperty(option))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsettingsData[field][option] = data[field][option];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsData[field] = data[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn settingsData;\n\t}\n\n\tstatic getDefaultSettingsData()\n\t{\n\t\treturn {\n\t\t\tusers : {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_USERS_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tresources: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_RESOURCES_LABEL'),\n\t\t\t\tdefaultMode: 'auto', // none|auto\n\t\t\t\tmultiple: 'N',\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tservices: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_SERVICE_LABEL'),\n\t\t\t\tvalue: null\n\t\t\t},\n\t\t\tduration: {\n\t\t\t\tshow: 'Y',\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DURATION_LABEL'),\n\t\t\t\tdefaultValue: 60,\n\t\t\t\tmanualInput: 'N'\n\t\t\t},\n\t\t\tdate: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_DATE_LABEL'),\n\t\t\t\tstyle: 'line', // line|popup\n\t\t\t\tstart: 'today'\n\t\t\t},\n\t\t\ttime: {\n\t\t\t\tlabel: Loc.getMessage('WEBF_RES_TIME_LABEL'),\n\t\t\t\tstyle: 'slots',\n\t\t\t\tshowOnlyFree: 'Y',\n\t\t\t\tshowFinishTime: 'N',\n\t\t\t\tscale: 60\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedUsers()\n\t{\n\t\treturn this.settingsData && this.settingsData.users && Type.isString(this.settingsData.users.value) ? this.settingsData.users.value.split('|') : [];\n\t}\n\n\tupdateSettingsDataInputs()\n\t{\n\t\tlet field, option;\n\t\tfor (field in this.settingsData)\n\t\t{\n\t\t\tif (this.settingsData.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tif (Type.isPlainObject(this.settingsData[field]))\n\t\t\t\t{\n\t\t\t\t\tfor (option in this.settingsData[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.settingsData[field].hasOwnProperty(option))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.updateSettingsInputValue([field, option], this.settingsData[field][option]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.updateSettingsInputValue([field], this.settingsData[field]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateSettingsInputValue(key, value)\n\t{\n\t\tlet uniKey = key.join('-');\n\t\tif (!this.DOM.settingsInputs[uniKey])\n\t\t{\n\t\t\tthis.DOM.settingsInputs[uniKey] = this.DOM.settingsWrap.appendChild(Dom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: this.params.formName + '[SETTINGS_DATA][' + key.join('][') + ']'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tvalue = value.join('|');\n\t\t}\n\n\t\tthis.DOM.settingsInputs[uniKey].value = value;\n\t}\n\n\tshowFieldLoader()\n\t{\n\t\tif (this.DOM.innerWrap)\n\t\t{\n\t\t\tthis.hideFieldLoader();\n\t\t\tthis.DOM.fieldLoader = this.DOM.innerWrap.appendChild(BookingUtil.getLoader(100));\n\t\t}\n\t}\n\n\thideFieldLoader()\n\t{\n\t\tDom.remove(this.DOM.fieldLoader);\n\t}\n\n\tgetSettings()\n\t{\n\t\tif (!this.params.settings.userfieldSettings)\n\t\t{\n\t\t\tthis.params.settings.userfieldSettings = {\n\t\t\t\tresources: this.userFieldParams.SETTINGS.SELECTED_RESOURCES,\n\t\t\t\tusers: this.userFieldParams.SETTINGS.SELECTED_USERS,\n\t\t\t\tservices: this.userFieldParams.SETTINGS.SERVICE_LIST,\n\t\t\t\tfullDay: this.userFieldParams.SETTINGS.FULL_DAY === 'Y',\n\t\t\t\tuseResources: this.userFieldParams.SETTINGS.USE_RESOURCES === 'Y'\n\t\t\t\t\t&& this.userFieldParams.SETTINGS.SELECTED_RESOURCES.length,\n\t\t\t\tuseUsers: this.userFieldParams.SETTINGS.USE_USERS === 'Y',\n\t\t\t\tuseServices: this.userFieldParams.SETTINGS.USE_SERVICES === 'Y',\n\t\t\t\tresourceLimit: this.userFieldParams.SETTINGS.RESOURCE_LIMIT,\n\t\t\t\tuserIndex: this.userFieldParams.SETTINGS.USER_INDEX\n\t\t\t}\n\t\t}\n\n\t\treturn this.params.settings;\n\t}\n\n\tupdateSettings(settings)\n\t{\n\t}\n\n\tgetCaption()\n\t{\n\t\treturn this.params.settings.caption;\n\t}\n\n\tupdateCaption()\n\t{\n\t\tlet caption = this.DOM.captionInput.value;\n\t\tif (this.params.settings.caption !== caption || !this.DOM.settingsInputs.caption)\n\t\t{\n\t\t\tthis.params.settings.caption = caption;\n\t\t\tif (this.previewFieldLayout)\n\t\t\t{\n\t\t\t\tthis.previewFieldLayout.updateTitle(this.params.settings.caption);\n\t\t\t}\n\n\t\t\t// Update title\n\t\t\tif (!this.DOM.settingsInputs.caption)\n\t\t\t{\n\t\t\t\tthis.DOM.settingsInputs.caption = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\t\tname: this.params.formName + '[CAPTION]'\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t\tthis.DOM.settingsInputs.caption.value = this.params.settings.caption;\n\n\t\t\tif (this.DOM.captionNode)\n\t\t\t{\n\t\t\t\tDom.adjust(this.DOM.captionNode, {text: this.params.settings.caption});\n\t\t\t}\n\t\t}\n\t}\n\n\tisRequired()\n\t{\n\t\treturn this.params.settings.required === 'Y';\n\t}\n\n\tupdateRequiredValue()\n\t{\n\t\tthis.params.settings.required = this.DOM.requiredCheckbox.checked ? 'Y' : 'N';\n\t\tif (!this.DOM.settingsInputs.required)\n\t\t{\n\t\t\tthis.DOM.settingsInputs.required = this.DOM.settingsWrap.appendChild(Dom.create(\"input\", {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: \"hidden\",\n\t\t\t\t\tname: this.params.formName + '[REQUIRED]'\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tthis.DOM.settingsInputs.required.value = this.params.settings.required;\n\t}\n\n\tcheckBitrix24Limitation()\n\t{\n\t\tlet\n\t\t\tcount = 0,\n\t\t\tsettings = this.getSettings();\n\n\t\tif (Type.isArray(this.params.settings.userfieldSettings.resources))\n\t\t{\n\t\t\tcount += this.params.settings.userfieldSettings.resources.length;\n\t\t}\n\n\t\tif (settings.userfieldSettings.useUsers && this.complexFields.users)\n\t\t{\n\t\t\tlet usersValue = this.complexFields.users.getValue();\n\t\t\tif (usersValue && Type.isArray(usersValue.value))\n\t\t\t{\n\t\t\t\tcount += usersValue.value.length;\n\t\t\t}\n\t\t}\n\n\t\tif (settings.userfieldSettings.resourceLimit > 0 && count > settings.userfieldSettings.resourceLimit)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t}\n\t}\n}","import { BookingUtil, Event, Loc, Dom } from 'calendar.resourcebooking';\n\nexport class UserSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.id = this.params.id || 'user-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.wrapNode = this.params.wrapNode;\n\t\tthis.destinationInputName = this.params.inputName || 'EVENT_DESTINATION';\n\t\tthis.params.selectGroups = false;\n\t\tthis.addMessage = this.params.addMessage || BX.message('USER_TYPE_RESOURCE_ADD_USER');\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\n\t\tif (!this.params.itemsSelected)\n\t\t{\n\t\t\tthis.params.itemsSelected = this.getSocnetDestinationConfig('itemsSelected');\n\t\t}\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\twrapNode: this.params.wrapNode\n\t\t};\n\n\t\tthis.create();\n\t}\n\n\tcreate ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tDom.addClass(this.DOM.outerWrap, 'calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\t\t}\n\n\t\tlet id = this.id;\n\n\t\tBX.bind(this.wrapNode, 'click', BX.delegate(function (e)\n\t\t{\n\t\t\tlet target = e.target || e.srcElement;\n\t\t\tif (target.className === 'calendar-resourcebook-content-block-control-delete') // Delete button\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.deleteItem(target.getAttribute('data-item-id'), target.getAttribute('data-item-type'), id);\n\t\t\t\tlet block = BX.findParent(target, {className: 'calendar-resourcebook-content-block-control-inner'});\n\t\t\t\tif (block && BX.hasClass(block, 'shown'))\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(block, 'shown');\n\t\t\t\t\tsetTimeout(function(){BX.remove(block);}, 300);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.SocNetLogDestination.openDialog(id);\n\t\t\t}\n\t\t}, this));\n\n\t\tthis.socnetDestinationInputWrap = this.wrapNode.appendChild(BX.create('SPAN', {props: {className: 'calendar-resourcebook-destination-input-box'}}));\n\t\tthis.socnetDestinationInput = this.socnetDestinationInputWrap.appendChild(BX.create('INPUT', {\n\t\t\tprops: {\n\t\t\t\tid: id + '-inp',\n\t\t\t\tclassName: 'calendar-resourcebook-destination-input'\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tkeydown: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchBeforeHandler(e, {\n\t\t\t\t\t\tformName: id, inputId: id + '-inp'\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tkeyup: function (e)\n\t\t\t\t{\n\t\t\t\t\treturn BX.SocNetLogDestination.searchHandler(e, {\n\t\t\t\t\t\tformName: id,\n\t\t\t\t\t\tinputId: id + '-inp',\n\t\t\t\t\t\tlinkId: 'event-grid-dest-add-link',\n\t\t\t\t\t\tsendAjax: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.socnetDestinationLink = this.wrapNode.appendChild(BX.create('DIV', {\n\t\t\tprops: {className: 'calendar-resourcebook-content-block-control-text calendar-resourcebook-content-block-control-text-add'},\n\t\t\ttext: this.addMessage\n\t\t}));\n\n\t\tthis.init();\n\t}\n\n\tshow ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tDom.addClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\thide ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tisShown ()\n\t{\n\t\tif (this.DOM.outerWrap)\n\t\t{\n\t\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t\t}\n\t}\n\n\tinit ()\n\t{\n\t\tif (!this.socnetDestinationInput || !this.wrapNode)\n\t\t\treturn;\n\n\t\tlet _this = this;\n\n\t\tthis.params.items = this.getSocnetDestinationConfig('items');\n\t\tthis.params.itemsLast = this.getSocnetDestinationConfig('itemsLast');\n\n\t\tif (this.params.selectGroups === false)\n\t\t{\n\t\t\tthis.params.items.groups = {};\n\t\t\tthis.params.items.department = {};\n\t\t\tthis.params.items.sonetgroups = {};\n\t\t}\n\n\t\tBX.SocNetLogDestination.init({\n\t\t\tname: this.id,\n\t\t\tsearchInput: this.socnetDestinationInput,\n\t\t\textranetUser: false,\n\t\t\tuserSearchArea: 'I',\n\t\t\tbindMainPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tbindSearchPopup: {\n\t\t\t\tnode: this.wrapNode, offsetTop: '5px', offsetLeft: '15px'\n\t\t\t},\n\t\t\tcallback: {\n\t\t\t\tselect: BX.proxy(this.selectCallback, this),\n\t\t\t\tunSelect: BX.proxy(this.unSelectCallback, this),\n\t\t\t\topenDialog: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseDialog: BX.proxy(this.closeDialogCallback, this),\n\t\t\t\topenSearch: BX.proxy(this.openDialogCallback, this),\n\t\t\t\tcloseSearch: function ()\n\t\t\t\t{\n\t\t\t\t\t_this.closeDialogCallback(true);\n\t\t\t\t}\n\t\t\t},\n\t\t\titems: this.params.items,\n\t\t\titemsLast: this.params.itemsLast,\n\t\t\titemsSelected: this.params.itemsSelected,\n\t\t\tdepartmentSelectDisable: this.params.selectGroups === false\n\t\t});\n\t}\n\n\tcloseAll ()\n\t{\n\t\tif (BX.SocNetLogDestination.isOpenDialog())\n\t\t{\n\t\t\tBX.SocNetLogDestination.closeDialog();\n\t\t}\n\t\tBX.SocNetLogDestination.closeSearch();\n\t}\n\n\tselectCallback(item, type)\n\t{\n\t\tif (type === 'users')\n\t\t{\n\t\t\tthis.addUserBlock(item);\n\t\t\tBX.onCustomEvent('OnResourceBookDestinationAddNewItem', [item, this.id]);\n\t\t\tthis.socnetDestinationInput.value = '';\n\t\t}\n\t}\n\n\taddUserBlock(item, animation)\n\t{\n\t\tif (this.checkLimit && !this.checkLimit())\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tif (this.getAttendeesCodesList().includes(item.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blocks = this.wrapNode.querySelectorAll(`calendar-resourcebook-content-block-control-inner[data-id='${item.id}']`);\n\t\tfor (let i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tconst itemWrap = this.wrapNode.appendChild(BX.create(\"DIV\", {\n\t\t\tattrs: {\n\t\t\t\t'data-id': item.id, className: \"calendar-resourcebook-content-block-control-inner green\"\n\t\t\t},\n\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-control-text\">' + item.name + '</div>' + '<div data-item-id=\"' + item.id + '\" data-item-type=\"users\" class=\"calendar-resourcebook-content-block-control-delete\"></div>' + '<input type=\"hidden\" name=\"' + this.destinationInputName + '[U][]' + '\" value=\"' + item.id + '\">'\n\t\t}));\n\n\t\tif (animation !== false)\n\t\t{\n\t\t\tsetTimeout(BX.delegate(function (){Dom.addClass(itemWrap, 'shown');}, this), 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(itemWrap, 'shown');\n\t\t}\n\n\t\tthis.wrapNode.appendChild(this.socnetDestinationInputWrap);\n\t\tthis.wrapNode.appendChild(this.socnetDestinationLink);\n\t}\n\n\tunSelectCallback(item)\n\t{\n\t\tlet elements = BX.findChildren(this.wrapNode, {attribute: {'data-id': item.id}}, true);\n\t\tif (elements != null)\n\t\t{\n\t\t\tfor (let j = 0; j < elements.length; j++)\n\t\t\t{\n\t\t\t\tBX.remove(elements[j]);\n\t\t\t}\n\t\t}\n\n\t\tBX.onCustomEvent('OnResourceBookDestinationUnselect', [item, this.id]);\n\t\tthis.socnetDestinationInput.value = '';\n\t\tthis.socnetDestinationLink.innerHTML = this.addMessage;\n\t}\n\n\topenDialogCallback ()\n\t{\n\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'inline-block');\n\t\tBX.style(this.socnetDestinationLink, 'display', 'none');\n\t\tBX.focus(this.socnetDestinationInput);\n\t}\n\n\tcloseDialogCallback(cleanInputValue)\n\t{\n\t\tif (!BX.SocNetLogDestination.isOpenSearch() && this.socnetDestinationInput.value.length <= 0)\n\t\t{\n\t\t\tBX.style(this.socnetDestinationInputWrap, 'display', 'none');\n\t\t\tBX.style(this.socnetDestinationLink, 'display', 'inline-block');\n\t\t\tif (cleanInputValue === true)\n\t\t\t\tthis.socnetDestinationInput.value = '';\n\n\t\t\t// Disable backspace\n\t\t\tif (BX.SocNetLogDestination.backspaceDisable || BX.SocNetLogDestination.backspaceDisable != null)\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\n\t\t\tBX.bind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable = function(e)\n\t\t\t{\n\t\t\t\tif (e.keyCode === 8)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsetTimeout(function()\n\t\t\t{\n\t\t\t\tBX.unbind(window, 'keydown', BX.SocNetLogDestination.backspaceDisable);\n\t\t\t\tBX.SocNetLogDestination.backspaceDisable = null;\n\t\t\t}, 5000);\n\t\t}\n\t}\n\n\tgetCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tcodes = [], i, value;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalue = BX.util.trim(inputsList[i].value);\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tcodes.push(inputsList[i].value);\n\t\t\t}\n\t\t}\n\t\treturn codes;\n\t}\n\n\tgetAttendeesCodes()\n\t{\n\t\tlet\n\t\t\tinputsList = this.wrapNode.getElementsByTagName('INPUT'),\n\t\t\tvalues = [],\n\t\t\ti;\n\n\t\tfor (i = 0; i < inputsList.length; i++)\n\t\t{\n\t\t\tvalues.push(inputsList[i].value);\n\t\t}\n\n\t\treturn this.convertAttendeesCodes(values);\n\t}\n\n\tconvertAttendeesCodes(values)\n\t{\n\t\tlet attendeesCodes = {};\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(code){\n\t\t\t\tif (code.substr(0, 2) === 'DR')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"department\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'UA')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"groups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 2) === 'SG')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"sonetgroups\";\n\t\t\t\t}\n\t\t\t\telse if (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tattendeesCodes[code] = \"users\";\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn attendeesCodes;\n\t}\n\n\tgetAttendeesCodesList(codes)\n\t{\n\t\tlet result = [];\n\t\tif (!codes)\n\t\t\tcodes = this.getAttendeesCodes();\n\t\tfor (let i in codes)\n\t\t{\n\t\t\tif (codes.hasOwnProperty(i))\n\t\t\t{\n\t\t\t\tresult.push(i);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetSocnetDestinationConfig(key)\n\t{\n\t\tlet\n\t\t\tres,\n\t\t\tsocnetDestination = this.params.socnetDestination || {};\n\n\t\tif (key === 'items')\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' || socnetDestination.DENY_TOALL\n\t\t\t\t\t? {}\n\t\t\t\t\t: {UA: {id: 'UA', name: BX.message('USER_TYPE_RESOURCE_TO_ALL_USERS')}},\n\t\t\t\tsonetgroups: socnetDestination.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.DEPARTMENT || {},\n\t\t\t\tdepartmentRelation: socnetDestination.DEPARTMENT_RELATION || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsLast' && socnetDestination.LAST)\n\t\t{\n\t\t\tres = {\n\t\t\t\tusers: socnetDestination.LAST.USERS || {},\n\t\t\t\tgroups: socnetDestination.EXTRANET_USER === 'Y' ? {} : {UA: true},\n\t\t\t\tsonetgroups: socnetDestination.LAST.SONETGROUPS || {},\n\t\t\t\tdepartment: socnetDestination.LAST.DEPARTMENT || {}\n\t\t\t};\n\t\t}\n\t\telse if (key === 'itemsSelected')\n\t\t{\n\t\t\tres = socnetDestination.SELECTED || {};\n\t\t}\n\t\treturn res || {};\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tlet\n\t\t\tresult = [], i,\n\t\t\tinputs = this.wrapNode.querySelectorAll('input');\n\n\t\tfor (i = 0; i < inputs.length; i++)\n\t\t{\n\t\t\tif (inputs[i].type === 'hidden' && inputs[i].value)\n\t\t\t{\n\t\t\t\tif (inputs[i].value.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tresult.push(parseInt(inputs[i].value.substr(1)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetValues(userList, trigerOnChange)\n\t{\n\t\tlet i, user;\n\t\tconst blocks = this.wrapNode.querySelectorAll('.calendar-resourcebook-content-block-control-inner');\n\t\tfor (i = 0; i < blocks.length; i++)\n\t\t{\n\t\t\tBX.remove(blocks[i]);\n\t\t}\n\n\t\tfor (i = 0; i < userList.length; i++)\n\t\t{\n\t\t\tif (BX.SocNetLogDestination.obItems[this.id]['users'])\n\t\t\t{\n\t\t\t\tuser = BX.SocNetLogDestination.obItems[this.id]['users']['U' + userList[i]];\n\t\t\t\tif (user)\n\t\t\t\t{\n\t\t\t\t\tthis.addUserBlock({\n\t\t\t\t\t\tid: 'U' + userList[i],\n\t\t\t\t\t\tname: user.name\n\t\t\t\t\t}, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t{\n\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t}\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n}","import {BookingUtil} from \"calendar.resourcebooking\";\n\nexport class ResourceSelectorFieldEditControl\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params || {};\n\t\tthis.editMode = !!this.params.editMode;\n\t\tthis.id = this.params.id || 'resource-selector-' + Math.round(Math.random() * 100000);\n\t\tthis.resourceList = BX.type.isArray(params.resourceList) ? params.resourceList : [];\n\t\tthis.checkLimit = BX.type.isFunction(params.checkLimitCallback) ? params.checkLimitCallback : false;\n\t\tthis.checkLimitForNew = BX.type.isFunction(params.checkLimitCallbackForNew) ? params.checkLimitCallbackForNew : false;\n\n\t\tthis.selectedValues = [];\n\t\tthis.selectedValuesIndex = {};\n\n\t\tthis.selectedBlocks = [];\n\t\tthis.newValues = [];\n\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap,\n\t\t\tblocksWrap: this.params.blocksWrap || false,\n\t\t\tlistWrap: this.params.listWrap\n\t\t};\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.controlsWrap = this.params.controlsWrap;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.DOM.arrowNode = BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-detail-icon calendar-resourcebook-content-block-detail-icon-arrow\"}});\n\t\t}\n\n\t\tthis.onChangeCallback = this.params.onChangeCallback || null;\n\n\t\tthis.create();\n\t\tthis.setValues(params.values);\n\t}\n\n\n\tcreate ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'calendar-resourcebook-resource-list-wrap calendar-resourcebook-folding-block' + (this.params.shown !== false ? ' shown' : ''));\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.DOM.addButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_ADD'),\n\t\t\t\tevents: {click: BX.delegate(this.addResourceBlock, this)}\n\t\t\t}));\n\n\t\t\tif (this.resourceList.length > 0)\n\t\t\t{\n\t\t\t\tthis.DOM.selectButton = this.DOM.controlsWrap.appendChild(BX.create(\"span\", {\n\t\t\t\t\tprops: {className: \"calendar-resource-content-block-add-link\"},\n\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT'),\n\t\t\t\t\tevents: {click: BX.delegate(this.openResourcesPopup, this)}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.bind(this.DOM.blocksWrap, 'click', BX.delegate(this.handleBlockClick, this));\n\t\t}\n\t}\n\n\tshow ()\n\t{\n\t\tBX.addClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thide ()\n\t{\n\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\tBX.removeClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\tisShown ()\n\t{\n\t\treturn BX.hasClass(this.DOM.outerWrap, 'shown');\n\t}\n\n\thandleBlockClick (e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\n\t\tif (target)\n\t\t{\n\t\t\tlet blockValue = target.getAttribute('data-bx-remove-block');\n\t\t\tif (blockValue)\n\t\t\t{\n\t\t\t\t// Remove from blocks\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\t// Remove from values\n\t\t\t\tthis.selectedValues.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.title === blockValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selectedValues = BX.util.deleteFromArray(this.selectedValues, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\n\t\t\t\tif (BX.type.isFunction(this.onChangeCallback))\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t\t}\n\n\t\t\t\tthis.checkBlockWrapState();\n\t\t\t}\n\n\t\t\tif (!blockValue)\n\t\t\t{\n\t\t\t\tthis.openResourcesPopup();\n\t\t\t}\n\t\t}\n\t}\n\n\topenResourcesPopup ()\n\t{\n\t\tif (!this.resourceList.length)\n\t\t{\n\t\t\treturn this.addResourceBlock();\n\t\t}\n\n\t\tif (this.isResourcesPopupShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItems = [];\n\n\t\tthis.resourceList.forEach(function(resource)\n\t\t{\n\t\t\tif (resource.deleted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.util.htmlspecialchars(resource.title),\n\t\t\t\tdataset: {\n\t\t\t\t\ttype: resource.type,\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttitle: resource.title\n\t\t\t\t},\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet\n\t\t\t\t\t\tselectAllcheckbox,\n\t\t\t\t\t\ttarget = e.target || e.srcElement,\n\t\t\t\t\t\tcheckbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox'),\n\t\t\t\t\t\tfoundResource = this.resourceList.find(function(resource)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn parseInt(resource.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t\t\t&& resource.type === menuItem.dataset.type;\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\tif (foundResource)\n\t\t\t\t\t{\n\t\t\t\t\t\t// Complete removing of the resource\n\t\t\t\t\t\tif (target && BX.hasClass(target, \"calendar-resourcebook-content-block-control-delete\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet menuItemNode = BX.findParent(target, {className: 'menu-popup-item'});\n\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tBX.addClass(menuItemNode, 'menu-popup-item-resource-remove-loader');\n\n\t\t\t\t\t\t\t\tmenuItemNode.appendChild(BookingUtil.getLoader(25));\n\t\t\t\t\t\t\t\tlet textNode = menuItemNode.querySelector('.menu-popup-item-text');\n\t\t\t\t\t\t\t\tif (textNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttextNode.innerHTML = BX.message('USER_TYPE_RESOURCE_DELETING');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfoundResource.deleted = true;\n\t\t\t\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemNode.style.maxHeight = '0';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (!this.resourceList.find(function(resource){return !resource.deleted;}))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.PopupMenu.destroy(this.id);\n\t\t\t\t\t\t\t\t\tthis.DOM.selectButton.style.opacity = 0;\n\n\t\t\t\t\t\t\t\t\tsetTimeout(BX.delegate(function(){BX.remove(this.DOM.selectButton);}, this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, this), 500);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\") || BX.hasClass(target, \"menu-popup-item-inner\") ))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!BX.hasClass(target, \"menu-popup-item-resource-checkbox\"))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (checkbox.checked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\t\t\tthis.checkResourceInputs();\n\n\t\t\t\t\t\t\t\tselectAllcheckbox = this.popupContainer.querySelector('.menu-popup-item-all-resources-checkbox');\n\t\t\t\t\t\t\t\tthis.selectAllChecked = false;\n\t\t\t\t\t\t\t\tif (selectAllcheckbox)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tselectAllcheckbox.checked = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}, this);\n\n\t\tif (menuItems.length > 1)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_SELECT_ALL'),\n\t\t\t\tonclick: BX.delegate(function(e, menuItem)\n\t\t\t\t{\n\t\t\t\t\tlet target = e.target || e.srcElement;\n\t\t\t\t\tif (target && (BX.hasClass(target, \"menu-popup-item\") || BX.hasClass(target, \"menu-popup-item-resource-checkbox\")))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet checkbox = menuItem.layout.item.querySelector('.menu-popup-item-resource-checkbox');\n\n\t\t\t\t\t\tif (BX.hasClass(target, \"menu-popup-item\"))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckbox.checked = !checkbox.checked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet i, checkboxes = this.popupContainer.querySelectorAll('input.menu-popup-item-resource-checkbox');\n\t\t\t\t\t\tthis.selectAllChecked = checkbox.checked;\n\n\t\t\t\t\t\tfor (i = 0; i < checkboxes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcheckboxes[i].checked = this.selectAllChecked;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.resourceList.forEach(function(resource){\n\t\t\t\t\t\t\tif (resource.deleted)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.selectAllChecked)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\tvalue: resource.title,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.removeResourceBlock({\n\t\t\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\t\t\ttrigerOnChange: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\t\t\t\tthis.checkResourceInputs();\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis.popup = BX.PopupMenu.create(\n\t\t\tthis.id,\n\t\t\tthis.DOM.selectButton || this.DOM.blocksWrap,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\tclassName: 'popup-window-resource-select',\n\t\t\t\tcloseByEsc : true,\n\t\t\t\tautoHide : false,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 0\n\t\t\t}\n\t\t);\n\n\t\tthis.popup.show(true);\n\t\tthis.popupContainer = this.popup.popupWindow.popupContainer;\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tthis.popupContainer.style.width = parseInt(this.DOM.blocksWrap.offsetWidth) + 'px';\n\t\t}\n\n\t\tBX.addCustomEvent(this.popup.popupWindow, 'onPopupClose', BX.proxy(function(){BX.PopupMenu.destroy(this.id);}, this));\n\n\t\tthis.popup.menuItems.forEach(function(menuItem)\n\t\t{\n\t\t\tlet checked;\n\t\t\tif (menuItem.dataset && menuItem.dataset.type)\n\t\t\t{\n\t\t\t\tchecked = this.selectedValues.find(function(item)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(item.id) === parseInt(menuItem.dataset.id)\n\t\t\t\t\t\t&& item.type === menuItem.dataset.type;\n\t\t\t\t});\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox\" type=\"checkbox\"' + (checked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.util.htmlspecialchars(menuItem.dataset.title) + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t(this.editMode ? '<div class=\"calendar-resourcebook-content-block-control-delete\"></div>' : '') +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectAllChecked = !this.resourceList.find(function(resource){\n\t\t\t\t\treturn !this.selectedValues.find(function(item)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn parseInt(item.id) === parseInt(resource.id)\n\t\t\t\t\t\t\t&& item.type === resource.type\n\t\t\t\t\t});\n\t\t\t\t},this);\n\n\t\t\t\tmenuItem.layout.item.className = 'menu-popup-item menu-popup-item-resource-all';\n\t\t\t\tmenuItem.layout.item.innerHTML = '<div class=\"menu-popup-item-inner\">' +\n\t\t\t\t\t'<div class=\"menu-popup-item-resource\">' +\n\t\t\t\t\t'<input class=\"menu-popup-item-resource-checkbox menu-popup-item-all-resources-checkbox\" type=\"checkbox\"' + (this.selectAllChecked ? 'checked=\"checked\"' : '') + ' id=\"' + menuItem.id + '\">' +\n\t\t\t\t\t'<label class=\"menu-popup-item-text\" for=\"' + menuItem.id + '\">' + BX.message('USER_TYPE_RESOURCE_SELECT_ALL') + '</label>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t}, this);\n\n\t\tsetTimeout(BX.delegate(function(){\n\t\t\tBX.bind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}, this), 50);\n\t}\n\n\taddResourceBlock(params)\n\t{\n\t\tif (!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif ((params.resource && (this.checkLimit && !this.checkLimit() && window.B24))\n\t\t\t||\n\t\t\t(!params.resource && (this.checkLimitForNew && !this.checkLimitForNew() && window.B24)))\n\t\t{\n\t\t\treturn BookingUtil.showLimitationPopup();\n\t\t}\n\n\t\tlet\n\t\t\t_this = this,\n\t\t\tblockEntry;\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (params.resource && this.selectedValues.find(function(val)\n\t\t\t{\n\t\t\t\treturn val.id && parseInt(val.id) === parseInt(params.resource.id)\n\t\t\t\t\t&& val.type === params.resource.type;\n\t\t\t}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!params.value)\n\t\t\t{\n\t\t\t\tparams.value = '';\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\twrap : this.DOM.listWrap\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail calendar-resourcebook-outer-resource-wrap\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource\"}}))\n\t\t\t\t\t.appendChild(BX.create(\"div\", {props:{className: \"calendar-resourcebook-content-block-detail-resource-inner calendar-resourcebook-content-block-detail-resource-inner-wide\"}}))\n\t\t\t};\n\n\t\t\tblockEntry.input = blockEntry.wrap.appendChild(BX.create(\"input\", {\n\t\t\t\tprops:{\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-input\",\n\t\t\t\t\tvalue: params.value,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tplaceholder: BX.message('USER_TYPE_RESOURCE_NAME')\n\t\t\t\t},\n\t\t\t\tdataset: {\n\t\t\t\t\tresourceType: params.resource ? params.resource.type : '',\n\t\t\t\t\tresourceId: params.resource ? params.resource.id : ''\n\t\t\t\t}\n\t\t\t}));\n\t\t\tblockEntry.delButton = blockEntry.wrap.appendChild(BX.create(\"div\", {\n\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-control-delete\"},\n\t\t\t\tevents: {click(){\n\t\t\t\t\t\tBX.remove(BX.findParent(this, {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t\t\t_this.selectedValues = _this.getSelectedValues();\n\t\t\t\t\t\t_this.checkResourceInputs();\n\t\t\t\t\t}}\n\t\t\t}));\n\n\t\t\tif (params.focusInput !== false)\n\t\t\t{\n\t\t\t\tBX.focus(blockEntry.input);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.value && this.selectedBlocks.find(function(val){return val.value && val.value === params.value;}))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tblockEntry = {\n\t\t\t\tvalue: params.value,\n\t\t\t\tresource: params.resource || false,\n\t\t\t\twrap : this.DOM.blocksWrap.appendChild(BX.create(\"div\", {\n\t\t\t\t\tprops:{\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-inner\"\n\t\t\t\t\t\t\t+ (params.animation ? '' : ' shown')\n\t\t\t\t\t\t\t+ (params.transparent ? ' transparent' : '')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-text\"},\n\t\t\t\t\t\t\ttext: params.value || ''\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tattrs: {'data-bx-remove-block': params.value},\n\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-control-delete\"}\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}))\n\t\t\t};\n\n\t\t\tthis.selectedBlocks.push(blockEntry);\n\n\t\t\t// Show it with animation\n\t\t\tif (params.animation)\n\t\t\t{\n\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(blockEntry.wrap, 'shown');\n\t\t\t\t}, this), 1);\n\t\t\t}\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\n\t\t\tthis.checkBlockWrapState();\n\t\t}\n\n\t\t// Adjust outer wrap max height\n\t\tif (this.DOM.listWrap && this.DOM.outerWrap)\n\t\t{\n\t\t\tif (BX.hasClass(this.DOM.outerWrap, 'shown'))\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = Math.max(10000, this.DOM.listWrap.childNodes.length * 45 + 100) + 'px';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.outerWrap.style.maxHeight = '';\n\t\t\t}\n\t\t}\n\n\t\treturn blockEntry;\n\t}\n\n\tremoveResourceBlock(params)\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId,\n\t\t\t\ti, inputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType === params.resource.type && parseInt(resourceId) === parseInt(params.resource.id))\n\t\t\t\t{\n\t\t\t\t\tBX.remove(BX.findParent(inputs[i], {className: 'calendar-resourcebook-outer-resource-wrap'}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.resource)\n\t\t\t{\n\t\t\t\tthis.selectedBlocks.find(function(element, index)\n\t\t\t\t{\n\t\t\t\t\tif (element.value === params.resource.title)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(element.wrap, 'shown');\n\t\t\t\t\t\tsetTimeout(BX.delegate(function ()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.remove(element.wrap)\n\t\t\t\t\t\t}, this), 300);\n\n\t\t\t\t\t\tthis.selectedBlocks = BX.util.deleteFromArray(this.selectedBlocks, index);\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\t\t\tthis.checkBlockWrapState();\n\n\t\t\tif (params.trigerOnChange !== false && this.onChangeCallback && BX.type.isFunction(this.onChangeCallback))\n\t\t\t{\n\t\t\t\tsetTimeout(BX.proxy(this.onChangeCallback, this), 100);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckResourceInputs()\n\t{\n\t\tif (this.editMode)\n\t\t{\n\t\t\tif (!this.selectedValues.length)\n\t\t\t{\n\t\t\t\tthis.addResourceBlock({animation: true});\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckBlockWrapState()\n\t{\n\t\tif (!this.editMode)\n\t\t{\n\t\t\tif (!this.selectedBlocks.length)\n\t\t\t{\n\t\t\t\tif (!this.DOM.emptyPlaceholder)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder = this.DOM.blocksWrap.appendChild(\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops : {className : \"calendar-resourcebook-content-block-control-empty\"},\n\t\t\t\t\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-text\">' + BX.message('USER_TYPE_RESOURCE_LIST_PLACEHOLDER') + '</span>'\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.emptyPlaceholder.className = \"calendar-resourcebook-content-block-control-empty\";\n\t\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.emptyPlaceholder);\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(BX.delegate(function(){\n\t\t\t\t\tif (BX.isNodeInDom(this.DOM.emptyPlaceholder))\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.addClass(this.DOM.emptyPlaceholder, 'show');\n\t\t\t\t\t}\n\t\t\t\t}, this), 50);\n\t\t\t}\n\t\t\telse if (this.DOM.emptyPlaceholder)\n\t\t\t{\n\t\t\t\tBX.remove(this.DOM.emptyPlaceholder);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (this.isResourcesPopupShown() && !BX.isParentForNode(this.popupContainer, target)\n\t\t)\n\t\t{\n\t\t\tthis.closeResourcesPopup({animation: true});\n\t\t}\n\t}\n\n\tisResourcesPopupShown()\n\t{\n\t\treturn this.popup && this.popup.popupWindow &&\n\t\t\tthis.popup.popupWindow.isShown && this.popup.popupWindow.isShown() &&\n\t\t\tthis.popup.popupWindow.popupContainer &&\n\t\t\tBX.isNodeInDom(this.popup.popupWindow.popupContainer)\n\t}\n\n\tcloseResourcesPopup(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t\tthis.popupContainer.style.maxHeight = '';\n\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t}\n\t}\n\n\tgetValues()\n\t{\n\t\treturn this.resourceList;\n\t}\n\n\taddToSelectedValues(value)\n\t{\n\t\tif (!this.selectedValues.find(function(val){return parseInt(val.id) === parseInt(value.id) && val.type === value.type;}))\n\t\t{\n\t\t\tthis.selectedValues.push(value);\n\t\t}\n\t}\n\n\tgetSelectedValues()\n\t{\n\t\tthis.selectedValues = [];\n\t\tif (this.editMode)\n\t\t{\n\t\t\tlet\n\t\t\t\tresourceType, resourceId, i,\n\t\t\t\tinputs = this.DOM.listWrap.querySelectorAll('.calendar-resourcebook-content-input');\n\n\t\t\tfor (i = 0; i < inputs.length; i++)\n\t\t\t{\n\t\t\t\tresourceType = inputs[i].getAttribute('data-resource-type');\n\t\t\t\tresourceId = inputs[i].getAttribute('data-resource-id');\n\t\t\t\tif (resourceType && resourceId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: resourceType, id: resourceId, title: inputs[i].value});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.selectedValues.push({type: 'resource', title: inputs[i].value});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.selectedBlocks.forEach(function(element){\n\t\t\t\tthis.selectedValues.push({type: element.resource.type, id: element.resource.id});\n\t\t\t}, this);\n\t\t}\n\n\t\treturn this.selectedValues;\n\t}\n\n\tgetDeletedValues()\n\t{\n\t\treturn this.resourceList.filter(function(resource){return resource.deleted;});\n\t}\n\n\tsetValues(values, trigerOnChange)\n\t{\n\t\tthis.selectedBlocks.forEach(function(element){BX.remove(element.wrap);});\n\t\tthis.selectedBlocks = [];\n\t\ttrigerOnChange = trigerOnChange !== false;\n\n\t\tif (BX.type.isArray(values))\n\t\t{\n\t\t\tvalues.forEach(function(value)\n\t\t\t{\n\t\t\t\tlet foundResource = this.resourceList.find(function(resource)\n\t\t\t\t{\n\t\t\t\t\treturn parseInt(resource.id) === parseInt(value.id) && resource.type === value.type;\n\t\t\t\t}, this);\n\n\t\t\t\tif (foundResource)\n\t\t\t\t{\n\t\t\t\t\tthis.addResourceBlock({\n\t\t\t\t\t\tresource: foundResource,\n\t\t\t\t\t\tvalue: foundResource.title,\n\t\t\t\t\t\ttrigerOnChange: trigerOnChange\n\t\t\t\t\t});\n\t\t\t\t\tthis.addToSelectedValues(foundResource);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tif (this.editMode)\n\t\t{\n\t\t\tthis.selectedValues = this.getSelectedValues();\n\t\t\tthis.checkResourceInputs();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.DOM.arrowNode)\n\t\t\t{\n\t\t\t\tthis.DOM.blocksWrap.appendChild(this.DOM.arrowNode);\n\t\t\t}\n\t\t}\n\n\t\tthis.checkBlockWrapState();\n\t}\n}","import { Type, Dom, Event, BookingUtil } from \"calendar.resourcebooking\";\nimport { Popup } from 'main.popup';\n\nexport class PlannerPopup\n{\n\tconstructor(params)\n\t{\n\t}\n\n\tshow(params)\n\t{\n\t\tif (!params)\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\t\tthis.params = params;\n\t\tthis.bindNode = params.bindNode;\n\t\tthis.plannerId = this.params.plannerId;\n\t\tthis.config = this.params.plannerConfig;\n\n\t\tif (this.isShown() || !this.bindNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.lastPlannerIdShown && this.lastPlannerIdShown !== this.plannerId)\n\t\t{\n\t\t\tthis.close({animation: false});\n\t\t}\n\n\t\tthis.currentEntries = [];\n\n\t\tthis.plannerWrap = Dom.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\tid: this.plannerId,\n\t\t\t\tclassName: 'calendar-planner-wrapper'\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis.popup = new Popup(this.plannerId + \"_popup\",\n\t\t\tthis.bindNode,\n\t\t\t{\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetTop: - parseInt(this.bindNode.offsetHeight) - 20,\n\t\t\t\toffsetLeft: this.bindNode.offsetWidth + 38,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcontent: this.plannerWrap\n\t\t\t})\n\n\t\tthis.popup.setAngle({offset: 100, position: 'left'});\n\t\tthis.popup.show();\n\t\t\n\t\tthis.lastPlannerIdShown = this.plannerId;\n\n\t\tlet\n\t\t\tbindPos = BX.pos(this.bindNode),\n\t\t\twinSize = BX.GetWindowSize();\n\n\t\tthis.plannerWidth = winSize.innerWidth - bindPos.right - 160;\n\t\tthis.config.width = this.plannerWidth;\n\t\t\n\t\tif (this.popup && this.popup.popupContainer)\n\t\t{\n\t\t\tDom.addClass(this.popup.popupContainer, 'calendar-resbook-planner-popup');\n\t\t\tDom.addClass(this.popup.popupContainer, 'show');\n\t\t\tthis.popup.popupContainer.style.width = (this.plannerWidth + 40) + 'px';\n\t\t\tEvent.bind(document, 'click', this.handleClick.bind(this));\n\t\t}\n\t\tthis.showPlanner();\n\n\t\tBX.addCustomEvent(this.popup, 'onPopupClose', this.close.bind(this));\n\t}\n\n\tupdate(params, refreshParams)\n\t{\n\t\tif (!this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet\n\t\t\tcodes = [], i, k, code,\n\t\t\tcodeIndex = {},\n\t\t\tplannerConfig = BX.clone(this.config, true),\n\t\t\tfromTimestamp, toTimestamp,\n\t\t\tdateFrom, dateTo;\n\n\t\tif (Type.isPlainObject(this.lastUpdateParams) && Type.isPlainObject(params) && refreshParams !== true)\n\t\t{\n\t\t\tfor (k in params)\n\t\t\t{\n\t\t\t\tif (params.hasOwnProperty(k))\n\t\t\t\t{\n\t\t\t\t\tthis.lastUpdateParams[k] = params[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tparams = this.lastUpdateParams;\n\t\t}\n\n\t\t// Save selector information\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tthis.lastUpdateParams = params;\n\t\t}\n\n\t\tparams.focusSelector = params.focusSelector !== false;\n\n\t\tif (params.from && params.to)\n\t\t{\n\t\t\tdateFrom = BookingUtil.parseDate(params.from);\n\t\t\tdateTo = BookingUtil.parseDate(params.to);\n\t\t\tfromTimestamp = dateFrom.getTime();\n\t\t\ttoTimestamp = dateTo.getTime();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (params.selector.fullDay)\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 12;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 14;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfromTimestamp = params.selector.from.getTime() - BookingUtil.getDayLength() * 3;\n\t\t\t\ttoTimestamp = params.selector.from.getTime() + BookingUtil.getDayLength() * 5;\n\t\t\t}\n\n\t\t\tdateFrom = new Date(fromTimestamp);\n\t\t\tdateTo = new Date(toTimestamp);\n\n\t\t\tplannerConfig.scaleDateFrom = dateFrom;\n\t\t\tplannerConfig.scaleDateTo = dateTo;\n\t\t}\n\n\t\tif (Type.isArray(params.userList))\n\t\t{\n\t\t\tfor (i = 0; i < params.userList.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.userList[i].id;\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isArray(params.selectedUsers))\n\t\t{\n\t\t\tfor (i = 0; i < params.selectedUsers.length; i++)\n\t\t\t{\n\t\t\t\tcode = 'U' + params.selectedUsers[i];\n\t\t\t\tif (!codeIndex[code])\n\t\t\t\t{\n\t\t\t\t\tcodes.push(code);\n\t\t\t\t\tcodeIndex[code] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet requestData = {\n\t\t\tcodes: codes,\n\t\t\tresources: params.resourceList,\n\t\t\tfrom: BookingUtil.formatDate(null, fromTimestamp / 1000),\n\t\t\tto: BookingUtil.formatDate(null, toTimestamp / 1000),\n\t\t\tcurrentEventList: this.params.currentEventList || []\n\t\t};\n\n\t\tif (this.checkUpdateParams(requestData) && this.isShown())\n\t\t{\n\t\t\tthis.showPlannerLoader();\n\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getplannerdata', {\n\t\t\t\tdata: requestData\n\t\t\t}).then(function (response)\n\t\t\t\t{\n\t\t\t\t\tthis.hidePlannerLoader();\n\n\t\t\t\t\tif (this.lastRequestData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.lastRequestData.response = response;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.currentEntries = response.data.entries;\n\t\t\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t\t\t{\n\t\t\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t\t\t||\n\t\t\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\t\t\tshow: false\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t}\n\t\telse if (Type.isPlainObject(this.lastRequestData.response))\n\t\t{\n\t\t\tlet response = this.lastRequestData.response;\n\t\t\tthis.currentEntries = response.data.entries;\n\t\t\tthis.currentAccessibility = response.data.accessibility;\n\t\t\tthis.currentLoadedDataFrom = dateFrom;\n\t\t\tthis.currentLoadedDataTo = dateTo;\n\n\t\t\tif (Type.isArray(response.data.entries))\n\t\t\t{\n\t\t\t\tresponse.data.entries.forEach(function(entry)\n\t\t\t\t{\n\t\t\t\t\tentry.selected = ((entry.type === 'user'\n\t\t\t\t\t\t&& params.selectedUsers.find(function(userId){return parseInt(entry.id) === parseInt(userId);}))\n\t\t\t\t\t\t||\n\t\t\t\t\t\t(entry.type === 'resource'\n\t\t\t\t\t\t\t&& params.selectedResources.find(function(item){return entry.type === item.type && parseInt(entry.id) === parseInt(item.id);}))\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isShown())\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('OnCalendarPlannerDoUpdate', [\n\t\t\t\t\t{\n\t\t\t\t\t\tplannerId: this.plannerId,\n\t\t\t\t\t\tconfig: plannerConfig,\n\t\t\t\t\t\tfocusSelector: params.focusSelector,\n\t\t\t\t\t\tselector: {\n\t\t\t\t\t\t\tfrom: params.selector.from,\n\t\t\t\t\t\t\tto: params.selector.to,\n\t\t\t\t\t\t\tfullDay: params.selector.fullDay,\n\t\t\t\t\t\t\tanimation: params.focusSelector,\n\t\t\t\t\t\t\tupdateScaleLimits: params.focusSelector\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tentries: response.data.entries,\n\t\t\t\t\t\t\taccessibility: response.data.accessibility\n\t\t\t\t\t\t},\n\t\t\t\t\t\tloadedDataFrom: dateFrom,\n\t\t\t\t\t\tloadedDataTo: dateTo,\n\t\t\t\t\t\tshow: false\n\t\t\t\t\t}\n\t\t\t\t]);\n\t\t\t}\n\t\t}\n\t}\n\n\tcheckUpdateParams (requestData)\n\t{\n\t\tlet requestPlannerUpdate = false;\n\t\tif (!this.lastRequestData || this.lastRequestPlannerId !== this.plannerId)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 1. Compare dates\n\t\tif (!requestPlannerUpdate && requestData.from !== this.lastRequestData.from)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\t\t// 2. Compare users\n\t\tif (\n\t\t\t!requestPlannerUpdate\n\t\t\t&& Type.isArray(requestData.codes) && Type.isArray(this.lastRequestData.codes)\n\t\t\t&& BX.util.array_diff(requestData.codes, this.lastRequestData.codes).length > 0\n\t\t)\n\t\t{\n\t\t\trequestPlannerUpdate = true;\n\t\t}\n\n\t\t// 3. Compare resources\n\t\tif (!requestPlannerUpdate && Type.isArray(requestData.resources) && Type.isArray(this.lastRequestData.resources))\n\t\t{\n\t\t\tif (requestData.resources.length !== this.lastRequestData.resources.length)\n\t\t\t{\n\t\t\t\trequestPlannerUpdate = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet resIndex = {};\n\t\t\t\trequestData.resources.forEach(function (res)\n\t\t\t\t{\n\t\t\t\t\tresIndex[res.type + '_' + res.id] = true\n\t\t\t\t});\n\n\t\t\t\tthis.lastRequestData.resources.forEach(function(res)\n\t\t\t\t{\n\t\t\t\t\tif (!resIndex[res.type + '_' + res.id])\n\t\t\t\t\t{\n\t\t\t\t\t\trequestPlannerUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Save request data for future comparing\n\t\tif (requestPlannerUpdate)\n\t\t{\n\t\t\tthis.lastRequestData = requestData;\n\t\t\tthis.lastRequestPlannerId = this.plannerId;\n\t\t}\n\n\t\treturn requestPlannerUpdate;\n\t}\n\n\tshowPlanner()\n\t{\n\t\tthis.planner = new CalendarPlanner(\n\t\t\tthis.params.plannerConfig,\n\t\t\t{\n\t\t\t\tconfig: this.config,\n\t\t\t\tdata: {\n\t\t\t\t\taccessibility: this.currentAccessibility || {},\n\t\t\t\t\tentries: this.currentEntries\n\t\t\t\t},\n\t\t\t\tselector: {\n\t\t\t\t\tfrom: this.params.selector.from,\n\t\t\t\t\tto: this.params.selector.to,\n\t\t\t\t\tfullDay: this.params.selector.fullDay,\n\t\t\t\t\tupdateScaleLimits: true,\n\t\t\t\t\tupdateScaleType: false,\n\t\t\t\t\tfocus: true,\n\t\t\t\t\tRRULE: false,\n\t\t\t\t\tanimation: false\n\t\t\t\t},\n\t\t\t\tloadedDataFrom: this.currentLoadedDataFrom,\n\t\t\t\tloadedDataTo: this.currentLoadedDataTo,\n\t\t\t\tfocusSelector: true,\n\t\t\t\tplannerId: this.plannerId,\n\t\t\t\tshow: true\n\t\t\t}\n\t\t);\n\n\t\t// planner events\n\t\tif (Type.isFunction(this.params.selectorOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorChanged', this.params.selectorOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.selectEntriesOnChangeCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectedEntriesOnChange', this.params.selectEntriesOnChangeCallback);\n\t\t}\n\t\tif (Type.isFunction(this.params.checkSelectorStatusCallback))\n\t\t{\n\t\t\tBX.addCustomEvent('OnCalendarPlannerSelectorStatusOnChange', this.params.checkSelectorStatusCallback);\n\t\t}\n\n\t\tBX.addCustomEvent('OnCalendarPlannerScaleChanged', BX.proxy(function(params)\n\t\t{\n\t\t\tthis.update({\n\t\t\t\tfrom: params.from,\n\t\t\t\tto: params.to,\n\t\t\t\tfocusSelector: params.focusSelector === true\n\t\t\t});\n\t\t}, this));\n\n\t}\n\n\tshowPlannerLoader()\n\t{\n\t\tif (this.planner && this.planner.outerWrap)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tDom.remove(this.loader);\n\t\t\t}\n\t\t\tthis.loader = this.planner.outerWrap.appendChild(BookingUtil.getLoader(150));\n\t\t}\n\t}\n\n\thidePlannerLoader()\n\t{\n\t\tif (this.loader)\n\t\t{\n\t\t\tDom.remove(this.loader);\n\t\t\tthis.loader = false;\n\t\t}\n\t}\n\n\tclose(params)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tif (params && params.animation)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.popup.popupContainer, 'show');\n\t\t\t\tsetTimeout(BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tparams.animation = false;\n\t\t\t\t\tthis.close(params);\n\t\t\t\t}, this), 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.unbind(document, 'click', BX.proxy(this.handleClick, this));\n\t\t\t\tBX.removeCustomEvent(this.popup, 'onPopupClose', BX.proxy(this.close, this));\n\t\t\t\tthis.popup.destroy();\n\t\t\t\tthis.planner = null;\n\t\t\t\tthis.popup = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tisShown()\n\t{\n\t\treturn this.lastPlannerIdShown === this.plannerId\n\t\t\t&& this.popup\n\t\t\t&& this.popup.isShown()\n\t\t;\n\t}\n\n\tgetPlannerId()\n\t{\n\t\tif (typeof this.plannerId === 'undefined')\n\t\t{\n\t\t\tthis.plannerId = 'calendar-planner-' + Math.round(Math.random() * 100000);\n\t\t}\n\t\treturn this.plannerId;\n\t}\n\n\thandleClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (\n\t\t\tthis.isShown()\n\t\t\t&& !BX.isParentForNode(this.bindNode, target)\n\t\t\t&& !BX.isParentForNode(BX('BXSocNetLogDestination'), target)\n\t\t\t&& !BX.isParentForNode(this.popup.popupContainer, target)\n\t\t\t&& !Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t)\n\t\t{\n\t\t\tif (!document.querySelector('div.popup-window-resource-select'))\n\t\t\t{\n\t\t\t\tthis.close({animation: true});\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\n\n\n","import {BookingUtil, Dom, Loc, Event, Type, SelectInput} from \"calendar.resourcebooking\";\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\nimport {PlannerPopup} from \"./controls/plannerpopup\";\n\nexport class EditFieldController\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.plannerPopup = null;\n\n\t\tthis.DOM = {\n\t\t\touterWrap: BX(params.controlId),\n\t\t\tvalueInputs: []\n\t\t};\n\n\t\tthis.isNew = !this.params.value || !this.params.value.DATE_FROM;\n\n\t\tif (this.params.socnetDestination)\n\t\t{\n\t\t\tResourcebookingUserfield.setSocnetDestination(this.params.socnetDestination);\n\t\t}\n\t}\n\n\tinit()\n\t{\n\t\tthis.buildUserfieldWrap();\n\t\tthis.createEventHandlers();\n\t\tthis.setControlValues();\n\t}\n\n\tbuildUserfieldWrap()\n\t{\n\t\tthis.buildDateControl();\n\t\tthis.buildTimeControl();\n\t\tthis.buildServiceControl();\n\t\tthis.buildDurationControl();\n\t\tthis.buildUserSelectorControl();\n\t\tthis.buildResourceSelectorControl();\n\t}\n\n\tcreateEventHandlers()\n\t{\n\t\tEvent.bind(this.DOM.outerWrap, 'click',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.fromInput, 'focus',this.showPlannerPopup.bind(this));\n\t\tEvent.bind(this.DOM.durationInput, 'focus',this.showPlannerPopup.bind(this));\n\n\t\tsetTimeout(function(){\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldSetValidator',\n\t\t\t[\n\t\t\t\tthis.params.controlId,\n\t\t\t\tfunction(result)\n\t\t\t\t{\n\t\t\t\t\tif (!this.params.allowOverbooking && this.isOverbooked())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (result && result.addError && BX.Crm && BX.Crm.EntityValidationError)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.addError(BX.Crm.EntityValidationError.create({field: this}));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t\t}.bind(this)\n\t\t\t]);\n\t\t}.bind(this), 100);\n\n\t\tsetTimeout(this.onChangeValues.bind(this), 100);\n\t}\n\n\tsetControlValues()\n\t{\n\t\tthis.allValuesValue = null;\n\n\t\tlet\n\t\t\tdateFrom,\n\t\t\tduration,\n\t\t\tdefaultDuration = this.params.fullDay ? 1440 : 60, // One day or one hour as default\n\t\t\tdateTo;\n\n\t\tif (this.isNew)\n\t\t{\n\t\t\tlet params = ResourcebookingUserfield.getParamsFromHash(this.params.userfieldId);\n\t\t\tif (params && params.length > 1)\n\t\t\t{\n\t\t\t\tdateFrom = BX.parseDate(params[0]);\n\t\t\t\tdateTo = BX.parseDate(params[1]);\n\t\t\t\tif (dateFrom && dateTo)\n\t\t\t\t{\n\t\t\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!dateFrom)\n\t\t\t{\n\t\t\t\tdateFrom = new Date();\n\t\t\t\tlet\n\t\t\t\t\troundMin = 30,\n\t\t\t\t\tr = (roundMin || 10) * 60 * 1000,\n\t\t\t\t\ttimestamp = Math.ceil(dateFrom.getTime() / r) * r;\n\t\t\t\tdateFrom = new Date(timestamp);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdateFrom = BX.parseDate(this.params.value.DATE_FROM);\n\t\t\tdateTo = BX.parseDate(this.params.value.DATE_TO);\n\t\t\tduration = Math.round(Math.max((dateTo.getTime() - dateFrom.getTime()) / 60000, 0));\n\t\t}\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = defaultDuration;\n\t\t}\n\n\t\tthis.DOM.fromInput.value = BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\t\tif (this.DOM.timeFromInput)\n\t\t{\n\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t}\n\n\t\tif (this.durationList)\n\t\t{\n\t\t\tthis.durationList.setValue(duration);\n\t\t}\n\n\t\tif (this.serviceList)\n\t\t{\n\t\t\tthis.serviceList.setValue(this.params.value.SERVICE_NAME || '');\n\t\t}\n\n\t\tlet selectedUsers = [];\n\t\tlet selectedResources = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.TYPE === 'user')\n\t\t\t\t{\n\t\t\t\t\tselectedUsers.push(parseInt(entry.RESOURCE_ID));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\tid: parseInt(entry.RESOURCE_ID),\n\t\t\t\t\t\ttype: entry.TYPE\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t}\n\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t}\n\t}\n\n\tbuildDateControl()\n\t{\n\t\tthis.DOM.dateTimeWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\n\t\tthis.DOM.dateWrap = this.DOM.dateTimeWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.fromInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\tvalue: '',\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DATE_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tclick: EditFieldController.showCalendarPicker,\n\t\t\t\tchange: this.triggerUpdatePlanner.bind(this)\n\t\t\t},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime'}\n\t\t}));\n\n\t\tthis.DOM.emptyInput = this.DOM.dateWrap.appendChild(Dom.create('INPUT', {attrs: {value: '',type: 'text'}, props: {className: 'calendar-resbook-empty-input'}}));\n\t}\n\n\tbuildTimeControl()\n\t{\n\t\tif (!this.params.fullDay)\n\t\t{\n\t\t\tthis.DOM.timeWrap = this.DOM.dateTimeWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.timeFromInput = this.DOM.timeWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_TIME_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '100px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tthis.fromTime = new SelectInput({\n\t\t\t\tinput: this.DOM.timeFromInput,\n\t\t\t\tvalues: BookingUtil.getSimpleTimeList(),\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tonAfterMenuOpen: (ind, popupMenu) => {\n\t\t\t\t\tif (!ind && popupMenu)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst formatDatetime = BX.isAmPmMode()\n\t\t\t\t\t\t\t? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '')\n\t\t\t\t\t\t\t: Loc.getMessage(\"FORMAT_DATETIME\");\n\t\t\t\t\t\tconst dateFrom = BookingUtil.parseDate(\n\t\t\t\t\t\t\tthis.DOM.fromInput.value + ' ' + this.DOM.timeFromInput.value,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tformatDatetime\n\t\t\t\t\t\t);\n\t\t\t\t\t\tlet i, menuItem;\n\t\t\t\t\t\tconst nearestTimeValue = BookingUtil.adaptTimeValue({\n\t\t\t\t\t\t\th: dateFrom.getHours(),\n\t\t\t\t\t\t\tm: dateFrom.getMinutes()\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (nearestTimeValue && nearestTimeValue.label)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (i = 0; i < popupMenu.menuItems.length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuItem = popupMenu.menuItems[i];\n\t\t\t\t\t\t\t\tif (menuItem\n\t\t\t\t\t\t\t\t\t&& nearestTimeValue.label === menuItem.text\n\t\t\t\t\t\t\t\t\t&& menuItem.layout)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpopupMenu.layout.menuContainer.scrollTop = menuItem.layout.item.offsetTop - 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildServiceControl()\n\t{\n\t\tif (this.params.useServices && Type.isArray(this.params.serviceList) && this.params.serviceList.length > 0)\n\t\t{\n\t\t\tif (this.params.fullDay)\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.DOM.durationWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-content-block-detail-wrap-flex\"}}));\n\t\t\t}\n\n\t\t\tthis.DOM.servicesWrap = this.DOM.durationWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span></div>'\n\t\t\t\t}));\n\n\t\t\tthis.DOM.serviceInput = this.DOM.servicesWrap.appendChild(Dom.create('INPUT', {\n\t\t\t\tattrs: {\n\t\t\t\t\tvalue: '',\n\t\t\t\t\t//value: this.params.value.SERVICE_NAME || '',\n\t\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL'),\n\t\t\t\t\ttype: 'text'\n\t\t\t\t},\n\t\t\t\tstyle: {width: '200px'},\n\t\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t\t}));\n\n\t\t\tlet serviceListValues = [];\n\t\t\tthis.params.serviceList.forEach(function(service)\n\t\t\t{\n\t\t\t\tif (service.name !== '')\n\t\t\t\t{\n\t\t\t\t\tserviceListValues.push({value: service.duration, label: service.name});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.isNew && serviceListValues.length >= 1)\n\t\t\t{\n\t\t\t\tthis.DOM.serviceInput.value = serviceListValues[0].label;\n\t\t\t\t//duration = parseInt(serviceListValues[0].value);\n\t\t\t}\n\n\t\t\tthis.serviceList = new SelectInput({\n\t\t\t\tinput: this.DOM.serviceInput,\n\t\t\t\tvalues: serviceListValues,\n\t\t\t\tonChangeCallback: function(state)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isPlainObject(state) && state.realValue)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.durationList.setValue(parseInt(state.realValue));\n\t\t\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tbuildDurationControl()\n\t{\n\t\tif (!this.DOM.durationWrap)\n\t\t{\n\t\t\tthis.DOM.durationWrap = this.DOM.dateTimeWrap;\n\t\t}\n\n\t\t// region Duration\n\t\tthis.DOM.durationControlWrap = this.DOM.durationWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-detail-inner calendar-resourcebook-content-block-detail-wrap-down\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-detail\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-title\"><span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span></div>'\n\t\t\t}));\n\n\t\tthis.DOM.durationInput = this.DOM.durationControlWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs: {\n\t\t\t\t//value: duration,\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL'),\n\t\t\t\ttype: 'text'\n\t\t\t},\n\t\t\tstyle: {width: '90px'},\n\t\t\tprops: {className: 'calendar-resbook-date-input calendar-resbook-field-datetime-menu'}\n\t\t}));\n\n\t\t//this.duration = parseInt(duration);\n\t\tthis.durationList = new SelectInput({\n\t\t\tinput: this.DOM.durationInput,\n\t\t\tvalues: BookingUtil.getDurationList(this.params.fullDay),\n\t\t\t//value: duration,\n\t\t\tonChangeCallback: function()\n\t\t\t{\n\t\t\t\tthis.duration = BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\t\t\tthis.triggerUpdatePlanner();\n\t\t\t}.bind(this)\n\t\t});\n\t}\n\n\tbuildUserSelectorControl()\n\t{\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {\n\t\t\t\tprops: {className: 'calendar-resbook-users-selector-wrap'}\n\t\t\t}));\n\n\t\t\tthis.DOM.userSelectorWrap = this.DOM.outerWrap.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-control-field'}}));\n\t\t\t\n\t\t\tlet userSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.userSelectorWrap\n\t\t\t\t.appendChild(Dom.create('DIV', {props: {className: 'calendar-resourcebook-content-block-title'}}))\n\t\t\t\t.appendChild(Dom.create('SPAN', {props: {className: 'calendar-resourcebook-content-block-title-text'}, text: userSelectorTitle}));\n\t\t\tthis.DOM.userListWrap = this.DOM.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tlet itemsSelected = {};\n\t\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t\t{\n\t\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t\t{\n\t\t\t\t\tif (entry.TYPE === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst userKey = 'U' + parseInt(entry.RESOURCE_ID);\n\t\t\t\t\t\titemsSelected[userKey] = 'users';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.userSelector = new UserSelectorFieldEditControl({\n\t\t\t\twrapNode: this.DOM.userListWrap,\n\t\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\t\taddMessage: Loc.getMessage('USER_TYPE_RESOURCE_SELECT_USER'),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this),\n\t\t\t\titemsSelected: itemsSelected,\n\t\t\t});\n\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationAddNewItem', this.triggerUpdatePlanner.bind(this));\n\t\t\tBX.addCustomEvent('OnResourceBookDestinationUnselect', this.triggerUpdatePlanner.bind(this));\n\t\t}\n\t}\n\n\tbuildResourceSelectorControl()\n\t{\n\t\tif (this.params.useResources)\n\t\t{\n\t\t\tthis.DOM.resourcesWrap = this.DOM.outerWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\t\tlet resSelectorTitle = Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME');\n\t\t\tthis.DOM.resourcesWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: resSelectorTitle}));\n\t\t\tthis.DOM.resourcesListWrap = this.DOM.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\t\tthis.resourceSelector = new ResourceSelectorFieldEditControl({\n\t\t\t\touterWrap: this.DOM.resourcesWrap,\n\t\t\t\tblocksWrap: this.DOM.resourcesListWrap,\n\t\t\t\tvalues: [],\n\t\t\t\tresourceList: this.params.resourceList,\n\t\t\t\tonChangeCallback: this.triggerUpdatePlanner.bind(this),\n\t\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showCalendarPicker(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tBX.calendar({node: target, field: target, bTime: false});\n\t\tBX.focus(target);\n\t}\n\n\tonChangeValues()\n\t{\n\t\tthis.duration = this.duration || BookingUtil.parseDuration(this.DOM.durationInput.value);\n\t\tconst duration = this.duration * 60;\n\t\tlet\n\t\t\tallValuesValue = '',\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tdateFrom,\n\t\t\tdateFromValue = '',\n\t\t\tserviceName = this.DOM.serviceInput ? this.DOM.serviceInput.value : '',\n\t\t\tentries = [];\n\n\t\tdateFrom = this.params.fullDay ? BookingUtil.parseDate(this.DOM.fromInput.value) : BookingUtil.parseDate(this.DOM.fromInput.value + ' ' + this.DOM.timeFromInput.value, false, false, formatDatetime);\n\n\t\tif (Type.isDate(dateFrom))\n\t\t{\n\t\t\tif (this.params.useResources)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedResourceList());\n\t\t\t}\n\n\t\t\tif (this.params.useUsers)\n\t\t\t{\n\t\t\t\tentries = entries.concat(this.getSelectedUserList());\n\t\t\t}\n\t\t\tdateFromValue = BookingUtil.formatDate(BookingUtil.getDateTimeFormat(), dateFrom.getTime() / 1000);\n\t\t}\n\n\t\t// Clear inputs\n\t\tthis.DOM.valueInputs.forEach(function(input){BX.remove(input);});\n\t\tthis.DOM.valueInputs = [];\n\n\t\tentries.forEach(function(entry)\n\t\t{\n\t\t\tlet value = entry.type + '|' + entry.id + '|' + dateFromValue + '|' + duration + '|' + serviceName;\n\t\t\tallValuesValue += value + '#';\n\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}, this);\n\n\n\t\tif (!entries.length)\n\t\t{\n\t\t\tthis.DOM.valueInputs.push(this.DOM.outerWrap.appendChild(\n\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: this.params.inputName,\n\t\t\t\t\t\tvalue: 'empty',\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}})));\n\t\t}\n\n\t\tif (this.allValuesValue !== null && this.allValuesValue !== allValuesValue)\n\t\t{\n\t\t\tBX.onCustomEvent(window, 'onCrmEntityEditorUserFieldExternalChanged', [this.params.controlId]);\n\t\t\tBX.fireEvent(this.DOM.emptyInput, 'change');\n\t\t}\n\t\tthis.allValuesValue = allValuesValue;\n\t}\n\n\tshowPlannerPopup()\n\t{\n\t\tlet currentEventList = [];\n\t\tif (this.params.value && Type.isArray(this.params.value.ENTRIES))\n\t\t{\n\t\t\tthis.params.value.ENTRIES.forEach(function(entry)\n\t\t\t{\n\t\t\t\tcurrentEventList.push(entry.EVENT_ID);\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isNull(this.plannerPopup))\n\t\t{\n\t\t\tthis.plannerPopup = new PlannerPopup();\n\t\t}\n\n\t\tthis.plannerPopup.show({\n\t\t\tplannerId: this.params.plannerId,\n\t\t\tbindNode: this.DOM.outerWrap,\n\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\tselector: this.getSelectorData(),\n\t\t\tselectorOnChangeCallback: this.plannerSelectorOnChange.bind(this),\n\t\t\tselectEntriesOnChangeCallback: this.plannerSelectedEntriesOnChange.bind(this),\n\t\t\tcheckSelectorStatusCallback: this.checkSelectorStatusCallback.bind(this),\n\t\t\tcurrentEventList: currentEventList\n\t\t});\n\n\t\tthis.triggerUpdatePlanner();\n\t}\n\n\ttriggerUpdatePlanner()\n\t{\n\t\tif (!Type.isNull(this.plannerPopup)\n\t\t\t&& this.plannerPopup.plannerId === this.params.plannerId\n\t\t\t&& this.plannerPopup.isShown())\n\t\t{\n\t\t\tthis.plannerPopup.update({\n\t\t\t\tplannerId: this.params.plannerId,\n\t\t\t\tplannerConfig: this.getPlannerConfig(),\n\t\t\t\tselector: this.getSelectorData(),\n\t\t\t\tresourceList: this.getResourceList(),\n\t\t\t\tselectedResources: this.resourceSelector ? this.resourceSelector.getSelectedValues() : false,\n\t\t\t\tuserList: this.getUserList(),\n\t\t\t\tselectedUsers: this.userSelector ? this.userSelector.getSelectedValues() : false\n\t\t\t},\n\t\t\ttrue);\n\t\t}\n\n\t\tthis.onChangeValues();\n\t}\n\n\tgetPlannerConfig()\n\t{\n\t\tif (!this.params.plannerConfig)\n\t\t{\n\t\t\tthis.params.plannerConfig = {\n\t\t\t\tid: this.params.plannerId,\n\t\t\t\tselectEntriesMode: true,\n\t\t\t\tscaleLimitOffsetLeft: 2,\n\t\t\t\tscaleLimitOffsetRight: 2,\n\t\t\t\tmaxTimelineSize: 300,\n\t\t\t\tminEntryRows: 300,\n\t\t\t\tentriesListWidth: 120,\n\t\t\t\ttimelineCellWidth: 49,\n\t\t\t\tminWidth: 300,\n\t\t\t\taccuracy: 300,\n\t\t\t\tworkTime: [parseInt(this.params.workTime[0]), parseInt(this.params.workTime[1])]\n\t\t\t};\n\t\t}\n\n\t\tthis.params.plannerConfig.clickSelectorScaleAccuracy = Math.max((this.duration * 60) || 300, 3600);\n\n\t\treturn this.params.plannerConfig;\n\t}\n\n\tplannerSelectorOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId\n\t\t\t&& Type.isDate(params.dateFrom)\n\t\t\t&& Type.isDate(params.dateTo)\n\t\t)\n\t\t{\n\t\t\tlet\n\t\t\t\tdateFrom = params.dateFrom,\n\t\t\t\tdateTo = params.dateTo;\n\n\t\t\tthis.DOM.fromInput.value =  BookingUtil.formatDate(BookingUtil.getDateFormat(), dateFrom);\n\n\t\t\tif (this.DOM.timeFromInput)\n\t\t\t{\n\t\t\t\tthis.DOM.timeFromInput.value = BookingUtil.formatDate(BookingUtil.getTimeFormatShort(), dateFrom);\n\t\t\t}\n\n\t\t\t// Duration in minutes\n\t\t\tthis.duration = (dateTo.getTime() - dateFrom.getTime() + (this.params.fullDay ? BookingUtil.getDayLength() : 0)) / 60000;\n\t\t\tthis.duration = Math.round(Math.max(this.duration, 0));\n\t\t\tthis.durationList.setValue(this.duration);\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tplannerSelectedEntriesOnChange(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && Type.isArray(params.entries))\n\t\t{\n\t\t\tlet\n\t\t\t\tselectedResources = [],\n\t\t\t\tselectedUsers = [];\n\n\t\t\tparams.entries.forEach(function(entry)\n\t\t\t{\n\t\t\t\tif (entry.selected)\n\t\t\t\t{\n\t\t\t\t\tif (entry.type === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedUsers.push(entry.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselectedResources.push({\n\t\t\t\t\t\t\tid: entry.id,\n\t\t\t\t\t\t\ttype: entry.type\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.resourceSelector)\n\t\t\t{\n\t\t\t\tthis.resourceSelector.setValues(selectedResources, false);\n\t\t\t}\n\t\t\tif (this.userSelector)\n\t\t\t{\n\t\t\t\tthis.userSelector.setValues(selectedUsers, false);\n\t\t\t}\n\n\t\t\tthis.onChangeValues();\n\t\t}\n\t}\n\n\tcheckSelectorStatusCallback(params)\n\t{\n\t\tif (params.plannerId === this.params.plannerId && !this.params.allowOverbooking)\n\t\t{\n\t\t\tlet errorClass = 'calendar-resbook-error';\n\t\t\tthis.overbooked = params.status === 'busy';\n\n\t\t\tif (this.overbooked)\n\t\t\t{\n\t\t\t\tif (!this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tthis.DOM.errorNode = this.DOM.dateTimeWrap.appendChild(Dom.create(\"div\", {\n\t\t\t\t\t\tprops: {className: \"calendar-resbook-content-error-text\"},\n\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_BOOKED_ERROR')\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tsetTimeout(BX.delegate(function(){BX.focus(this.DOM.fromInput)}, this), 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.DOM.errorNode)\n\t\t\t\t{\n\t\t\t\t\tBX.remove(this.DOM.errorNode);\n\t\t\t\t\tthis.DOM.errorNode = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.DOM.fromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.fromInput, errorClass);\n\t\t\t\t}\n\t\t\t\tif (this.DOM.timeFromInput)\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(this.DOM.timeFromInput, errorClass);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectorData()\n\t{\n\t\tlet\n\t\t\tformatDatetime = BX.isAmPmMode() ? Loc.getMessage(\"FORMAT_DATETIME\").replace(':SS', '') : Loc.getMessage(\"FORMAT_DATETIME\"),\n\t\t\tselector, dateTo,\n\t\t\tduration = this.duration,\n\t\t\tdateFrom = BookingUtil.parseDate(this.DOM.fromInput.value + (this.DOM.timeFromInput ? ' ' + this.DOM.timeFromInput.value : ''), false, false, formatDatetime);\n\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = this.params.fullDay ? 1440 : 60;\n\t\t}\n\n\t\tif (!Type.isDate(dateFrom))\n\t\t{\n\t\t\tdateFrom = new Date();\n\t\t}\n\n\t\tdateTo = new Date(dateFrom.getTime() + duration * 60000 - (this.params.fullDay ? BookingUtil.getDayLength() : 0));\n\n\t\tselector = {\n\t\t\tfrom: dateFrom,\n\t\t\tto: dateTo,\n\t\t\tfullDay: this.params.fullDay,\n\t\t\tupdateScaleLimits: true\n\t\t};\n\n\t\treturn selector;\n\t}\n\n\tgetResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\tgetSelectedResourceList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.resourceSelector)\n\t\t{\n\t\t\tthis.resourceSelector.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tentries.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: parseInt(value.id),\n\t\t\t\t\t\ttype : value.type,\n\t\t\t\t\t\tname : value.title\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetUserList()\n\t{\n\t\tlet entries = [], index = {}, userId;\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tif (Type.isArray(this.params.userList))\n\t\t\t{\n\t\t\t\tthis.params.userList.forEach(function(userId){\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(code.substr(1));\n\t\t\t\t\tif (!index[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\tentries.push({id: userId, type : 'user'});\n\t\t\t\t\t\tindex[userId] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn entries;\n\t}\n\n\tgetSelectedUserList()\n\t{\n\t\tlet entries = [];\n\t\tif (this.userSelector)\n\t\t{\n\t\t\tthis.userSelector.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tentries.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: parseInt(code.substr(1)),\n\t\t\t\t\t\t\ttype : 'user'\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn entries;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.params.resourceLimit <= 0 || this.getTotalResourceCount() <= this.params.resourceLimit;\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\t\tif (this.params.useResources && this.resourceSelector)\n\t\t{\n\t\t\tresult += this.resourceSelector.getValues().length;\n\t\t}\n\n\t\tif (this.params.useUsers)\n\t\t{\n\t\t\tresult += this.getSelectedUserList().length;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tisOverbooked()\n\t{\n\t\treturn this.overbooked;\n\t}\n}\n","import {BookingUtil, Type, Dom, Loc, SelectInput} from \"calendar.resourcebooking\";\n\nexport class ServiceSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.outerCont = this.params.outerCont;\n\t\tthis.fieldSettings = this.params.fieldSettings || {};\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.serviceListOuterWrap = this.outerCont.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-wrap calendar-resourcebook-service-list-wrap\"}}));\n\n\t\tthis.durationTitleId = 'duration-title-wrap-' + Math.round(Math.random() * 100000);\n\t\tthis.servicesTitleWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {\n\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-inner\"},\n\t\t\t\thtml: '<div class=\"calendar-resourcebook-content-block-detail-resource\">' +\n\t\t\t\t\t'<div class=\"calendar-resourcebook-content-block-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"' + this.durationTitleId + '\" class=\"calendar-resourcebook-content-block-title calendar-resourcebook-content-block-duration-title\">' +\n\t\t\t\t\t'<span class=\"calendar-resourcebook-content-block-title-text\">' + Loc.getMessage('USER_TYPE_RESOURCE_DURATION_LABEL') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t}));\n\n\t\tthis.serviceListRowsWrap = this.serviceListOuterWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-inner\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail\"}}));\n\n\t\tBX.bind(this.serviceListRowsWrap, 'click', this.handlePopupClick.bind(this));\n\t\tif (Type.isArray(this.fieldSettings.SERVICE_LIST) && this.fieldSettings.SERVICE_LIST.length > 0)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST.forEach(function(service)\n\t\t\t{\n\t\t\t\tthis.addRow(service, false);\n\t\t\t}, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.addRow(false, false);\n\t\t}\n\n\t\tthis.serviceListAddWrap = this.serviceListOuterWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tthis.serviceAddButton = this.serviceListAddWrap.appendChild(Dom.create(\"span\", {\n\t\t\tprops: {className: \"calendar-resource-content-block-add-link calendar-resource-content-block-add-link-icon\"},\n\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICE'),\n\t\t\tevents: {click: this.addRow.bind(this)}\n\t\t}));\n\t\tBX.bind(window, 'resize', this.checkDurationTitlePosition.bind(this));\n\t\tthis.checkDurationTitlePosition();\n\n\t\tthis.show(this.fieldSettings.USE_SERVICES === 'Y');\n\t}\n\n\tshow(show)\n\t{\n\t\tif (show)\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = '';\n\t\t\tDom.addClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.serviceListOuterWrap.style.display = 'none';\n\t\t\tDom.removeClass(this.serviceListOuterWrap, 'show');\n\t\t}\n\t}\n\n\taddRow(row, animation)\n\t{\n\t\tanimation = animation !== false;\n\n\t\tif (!Type.isPlainObject(row))\n\t\t{\n\t\t\trow = {name: '', duration: this.getDefaultDuration()}\n\t\t}\n\n\t\tlet service = {\n\t\t\touterWrap: this.serviceListRowsWrap\n\t\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource calendar-resourcebook-service-row\"}}))\n\t\t};\n\n\t\tif (animation)\n\t\t{\n\t\t\tsetTimeout(function(){\n\t\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t\t}, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(service.outerWrap, 'show');\n\t\t}\n\n\t\tservice.wrap = service.outerWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-detail-resource-inner\"}}));\n\n\t\tservice.nameInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resourcebook-content-input calendar-resourcebook-service-input\",\n\t\t\t\tplaceholder: Loc.getMessage('USER_TYPE_RESOURCE_SERVICE_PLACEHOLDER'),\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.name\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationInput = service.wrap.appendChild(Dom.create(\"input\", {\n\t\t\tprops: {\n\t\t\t\tclassName: \"calendar-resbook-duration-input calendar-resbook-field-datetime-menu\",\n\t\t\t\ttype: \"text\",\n\t\t\t\tvalue: row.duration\n\t\t\t},\n\t\t\tattrs: {}\n\t\t}));\n\n\t\tservice.durationList = new SelectInput({\n\t\t\tinput: service.durationInput,\n\t\t\tgetValues: function(){\n\t\t\t\tlet fullday = false;\n\t\t\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t\t\t{\n\t\t\t\t\tfullday = this.params.getFullDayValue();\n\t\t\t\t}\n\t\t\t\treturn BookingUtil.getDurationList(fullday);\n\t\t\t}.bind(this),\n\t\t\tvalue: row.duration\n\t\t});\n\n\t\tservice.deleteWrap = service.wrap.appendChild(Dom.create(\"DIV\", {\n\t\t\tprops: {className: \"calendar-resourcebook-content-block-detail-delete\"},\n\t\t\thtml: '<span class=\"calendar-resourcebook-content-block-control-delete calendar-resourcebook-content-block-control-delete-detail\"></span>'\n\t\t}));\n\n\t\t// Adjust outer wrap max height\n\t\tthis.serviceListOuterWrap.style.maxHeight = Math.max(500, this.serviceListRowsWrap.childNodes.length * 45 + 100) + 'px';\n\t}\n\n\tcheckDurationTitlePosition(timeout)\n\t{\n\t\tif (timeout !== false)\n\t\t{\n\t\t\tif (this.checkDurationTitlePositionTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.checkDurationTitlePositionTimeout);\n\t\t\t}\n\n\t\t\tthis.checkDurationTitlePositionTimeout = setTimeout(function(){\n\n\t\t\t\tthis.checkDurationTitlePosition(false);\n\t\t\t}.bind(this), 100);\n\t\t\treturn;\n\t\t}\n\n\t\tlet durationInput = this.serviceListOuterWrap.querySelector('input.calendar-resbook-duration-input');\n\t\tif (this.durationTitleId && BX(this.durationTitleId) && durationInput)\n\t\t{\n\t\t\tBX(this.durationTitleId).style.left = (durationInput.offsetLeft + 15) + 'px';\n\t\t}\n\t}\n\n\tgetDefaultDuration()\n\t{\n\t\tlet fullday = false;\n\t\tif (Type.isFunction(this.params.getFullDayValue))\n\t\t{\n\t\t\tfullday = this.params.getFullDayValue();\n\t\t}\n\t\treturn fullday ? 1440 : 30;\n\t}\n\n\tclickHandler(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tDom.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){Dom.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetValues(e)\n\t{\n\t\tlet\n\t\t\tserviceList = [],\n\t\t\tnameInput, durationInput,\n\t\t\ti, rows = this.serviceListRowsWrap.querySelectorAll('.calendar-resourcebook-service-row');\n\n\t\tfor (i = 0; i < rows.length; i++)\n\t\t{\n\t\t\tif (Dom.hasClass(rows[i], 'show'))\n\t\t\t{\n\t\t\t\tnameInput = rows[i].querySelector('input.calendar-resourcebook-service-input');\n\t\t\t\tdurationInput = rows[i].querySelector('input.calendar-resbook-duration-input');\n\n\t\t\t\tif (nameInput && durationInput)\n\t\t\t\t{\n\t\t\t\t\tserviceList.push({\n\t\t\t\t\t\tname: nameInput.value,\n\t\t\t\t\t\tduration: BookingUtil.parseDuration(durationInput.value)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn serviceList;\n\t}\n\n\tcheckRows()\n\t{\n\t\tlet serviceList = this.getValues();\n\t\tif (!serviceList.length)\n\t\t{\n\t\t\tthis.show(false);\n\t\t\tif (Type.isFunction(this.params.onFullClearHandler))\n\t\t\t{\n\t\t\t\tthis.params.onFullClearHandler();\n\t\t\t}\n\t\t\tthis.addRow(false, false);\n\t\t}\n\t}\n\n\n\thandlePopupClick(e)\n\t{\n\t\tlet target = e.target || e.srcElement;\n\t\tif (Dom.hasClass(target, 'calendar-resourcebook-content-block-control-delete')\n\t\t\t|| Dom.hasClass(target, 'calendar-resourcebook-content-block-detail-delete')) // Delete button\n\t\t{\n\t\t\tlet resWrap = BX.findParent(target, {className: 'calendar-resourcebook-service-row'});\n\t\t\tif (resWrap)\n\t\t\t{\n\t\t\t\tBX.removeClass(resWrap, 'show');\n\t\t\t\tsetTimeout(function(){BX.remove(resWrap);}, 500);\n\t\t\t\tthis.checkRows();\n\t\t\t}\n\t\t}\n\t}\n}","import {Type, Dom, Loc} from \"calendar.resourcebooking\";\nexport class TimezoneSelector\n{\n\tstatic timezoneList;\n\n\tconstructor(params)\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.DOM = {\n\t\t\touterWrap: this.params.outerWrap\n\t\t};\n\t\tDom.addClass(this.DOM.outerWrap, 'fields enumeration field-item');\n\t\tthis.create();\n\t}\n\n\tcreate()\n\t{\n\t\tthis.DOM.select = this.DOM.outerWrap.appendChild(Dom.create('select'));\n\t\tthis.DOM.select.options.add(\n\t\t\tnew Option(\n\t\t\t\tLoc.getMessage('USER_TYPE_LOADING_TIMEZONE_LIST'),\n\t\t\t\tthis.params.selectedValue || '',\n\t\t\t\ttrue,\n\t\t\t\ttrue)\n\t\t);\n\n\t\tthis.getTimezoneList().then(\n\t\t\tfunction(timezoneList)\n\t\t\t{\n\t\t\t\tDom.remove(this.DOM.select.options[0]);\n\t\t\t\ttimezoneList.forEach(function(timezone)\n\t\t\t\t{\n\t\t\t\t\tlet selected = this.params.selectedValue ? this.params.selectedValue === timezone.value : timezone.selected;\n\n\t\t\t\t\tthis.DOM.select.options.add(\n\t\t\t\t\t\tnew Option(\n\t\t\t\t\t\t\ttimezone.label,\n\t\t\t\t\t\t\ttimezone.value,\n\t\t\t\t\t\t\tselected,\n\t\t\t\t\t\t\tselected));\n\t\t\t\t}, this);\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetTimezoneList(params)\n\t{\n\t\tparams = params || {};\n\n\t\treturn new Promise((resolve) => {\n\t\t\tif (!TimezoneSelector.timezoneList || params.clearCache)\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.calendarajax.getTimezoneList')\n\t\t\t\t\t.then(function (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tTimezoneSelector.timezoneList = [];\n\t\t\t\t\t\t\tfor (let key in response.data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(key))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tTimezoneSelector.timezoneList.push({\n\t\t\t\t\t\t\t\t\t\tvalue: response.data[key].timezone_id,\n\t\t\t\t\t\t\t\t\t\tlabel: response.data[key].title,\n\t\t\t\t\t\t\t\t\t\tselected: response.data[key].default\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\tfunction (response)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(TimezoneSelector.timezoneList);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetValue()\n\t{\n\t\treturn this.DOM.select.value;\n\t}\n}\n\n\n\n\n\n\n\n","import {Type, Dom, Loc, Event} from \"calendar.resourcebooking\";\n\nexport class ModeSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.params = params;\n\t\tthis.outerWrap = this.create();\n\t}\n\n\tcreate()\n\t{\n\t\tlet\n\t\t\twrapNode = Dom.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\tprops:{className: \"calendar-resourcebook-content-block-select calendar-resourcebook-mode-selector\"}\n\t\t\t\t}\n\t\t\t),\n\t\t\tmenuItems = [\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResources))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResources();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS'),\n\t\t\t\t\tonclick: function(e, item){\n\t\t\t\t\t\tif (Type.isFunction(this.params.showResourcesAndUsers))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.showResourcesAndUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\twrapNode.innerHTML = item.text;\n\t\t\t\t\t\tthis.modeSwitcherPopup.close();\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t],\n\t\t\tswitcherId = 'mode-switcher-' + Math.round(Math.random() * 100000);\n\n\n\t\tEvent.bind(wrapNode, 'click', function(){\n\t\t\tif (this.modeSwitcherPopup && this.modeSwitcherPopup.popupWindow && this.modeSwitcherPopup.popupWindow.isShown())\n\t\t\t{\n\t\t\t\treturn this.modeSwitcherPopup.close();\n\t\t\t}\n\n\t\t\tthis.modeSwitcherPopup = BX.PopupMenu.create(\n\t\t\t\tswitcherId,\n\t\t\t\twrapNode,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc : true,\n\t\t\t\t\tautoHide : true,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 20,\n\t\t\t\t\tangle: true\n\t\t\t\t}\n\t\t\t);\n\t\t\tthis.modeSwitcherPopup.show();\n\n\t\t\tBX.addCustomEvent(this.modeSwitcherPopup.popupWindow, 'onPopupClose', function()\n\t\t\t{\n\t\t\t\tBX.PopupMenu.destroy(switcherId);\n\t\t\t\tthis.modeSwitcherPopup = null;\n\t\t\t}.bind(this));\n\t\t}.bind(this));\n\n\t\tif (this.params.useUsers && !this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_USERS');\n\t\t}\n\t\telse if (this.params.useUsers && this.params.useResources)\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES_AND_USERS');\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapNode.innerHTML = Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE_RESOURCES');\n\t\t}\n\n\t\treturn wrapNode;\n\t}\n\n\tgetOuterWrap()\n\t{\n\t\treturn this.outerWrap;\n\t}\n}\n","import {BookingUtil} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\nimport {TimezoneSelector} from \"./controls/timezoneselector\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourcebookingUserfield} from \"calendar.resourcebookinguserfield\";\n\nexport let customizeCrmEntityEditor = function(CrmConfigurator)\n{\n\tlet Configurator = function()\n\t{\n\t\tConfigurator.superclass.constructor.apply(this);\n\t};\n\tBX.extend(Configurator, CrmConfigurator);\n\n\tConfigurator.create = function(id, settings)\n\t{\n\t\tlet self = new Configurator();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t};\n\n\tConfigurator.prototype.layout = function(options, params)\n\t{\n\t\tif(this._hasLayout)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif(!BX.type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {}\n\t\t}\n\n\t\tif(this._mode === BX.Crm.EntityEditorMode.view)\n\t\t{\n\t\t\tthrow \"EntityEditorUserFieldConfigurator. View mode is not supported by this control type.\";\n\t\t}\n\n\t\tthis.getBitrix24Limitation({\n\t\t\tcallback: BX.delegate(function(limit)\n\t\t\t{\n\t\t\t\tthis.RESOURCE_LIMIT = limit;\n\t\t\t}, this)\n\t\t});\n\n\t\tif(this._field)\n\t\t{\n\t\t\tthis.fieldInfo = this._field.getFieldInfo();\n\t\t}\n\t\telse if (!params.settings)\n\t\t{\n\t\t\treturn this.getDefaultUserfieldSettings({\n\t\t\t\tdisplayCallback: BX.delegate(function(settings)\n\t\t\t\t{\n\t\t\t\t\tthis.layout(options, {settings: settings});\n\t\t\t\t}, this)\n\t\t\t});\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", {props: {className: \"calendar-resourcebook-content\"}});\n\t\tthis._innerWrapper = this._wrapper\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tvar\n\t\t\tfieldSettings = this.fieldInfo ? this.fieldInfo.SETTINGS : params.settings,\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [],\n\t\t\tisNew = this._field === null,\n\t\t\ttitle = this.getMessage(\"labelField\"),\n\t\t\tmanager = this._editor.getUserFieldManager(),\n\t\t\tlabel = this._field ? this._field.getTitle() : manager.getDefaultFieldLabel(this._typeId);\n\n\t\tthis.RESOURCE_LIMIT = fieldSettings.RESOURCE_LIMIT || 0;\n\n\t\t// region Field Title\n\t\tthis._labelInput = BX.create(\"input\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-widget-content-input\",\n\t\t\t\t\t\ttype: \"text\",\n\t\t\t\t\t\tvalue: label\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t// Title\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-widget-content-block-title\" },\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-widget-content-block-title-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Input\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._labelInput ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t// Hr\n\t\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\t// region Users&Resources Mode selector\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t// endregion\n\n\t\tvar optionWrapper = this._innerWrapper.appendChild(BX.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (fieldSettings.RESOURCES\n\t\t\t&& BX.type.isPlainObject(fieldSettings.RESOURCES['resource'])\n\t\t\t&& BX.type.isArray(fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tfieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tfieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this),\n\t\t\tcheckLimitCallbackForNew: this.checkResourceCountLimitForNewEntries.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// region Users Selector\n\t\tthis.userSelectorWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control\"}}));\n\n\t\tvar itemsSelected = [];\n\t\tif (BX.type.isArray(fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tfieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: ResourcebookingUserfield.getSocnetDestination(),\n\t\t\titemsSelected: itemsSelected,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\t\t// endregion\n\n\t\t// Region Data, Time and services\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis.timezoneSettingsWrap = optionWrapper.appendChild(\n\t\t\tBX.create(\"div\", {props: {\n\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-options\" },\n\t\t\t\tstyle: {display: fieldSettings.FULL_DAY === 'Y' ? 'none' : ''}\n\t\t\t}));\n\n\t\tthis.timezoneSettingsWrap.appendChild(BX.create(\"hr\", {props: {className: \"crm-entity-widget-hr\"}}));\n\t\tthis.timezoneSettingsWrap\n\t\t\t.appendChild(BX.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(BX.create(\"span\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: BX.message('USER_TYPE_RESOURCE_TIMEZONE_SETTINGS_TITLE') + ':'}));\n\n\t\tthis.timezoneSelectorWrap = this.timezoneSettingsWrap.appendChild(BX.create(\"div\", {\n\t\t\tstyle: {display: fieldSettings.USE_USER_TIMEZONE === 'Y' ? 'none' : ''}\n\t\t}));\n\n\t\tthis.timezoneSelectWrap = this.timezoneSelectorWrap\n\t\t\t.appendChild(BX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block-field\" }\n\t\t\t\t}\n\t\t\t));\n\n\n\t\tthis.timezoneSelector = new TimezoneSelector({\n\t\t\touterWrap: this.timezoneSelectWrap,\n\t\t\tselectedValue: fieldSettings.TIMEZONE\n\t\t});\n\n\t\tthis.useUserTimezoneCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_USER_TIMEZONE === 'Y'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis.timezoneSettingsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.useUserTimezoneCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_USE_USER_TIMEZONE') })\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: BX.proxy(this.handleUserTimezoneCheckbox, this)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis._fulldayCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.FULL_DAY === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.handleFullDayMode, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._fulldayCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis._servicesCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tclick : BX.delegate(function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this._servicesCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._servicesCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tonFullClearHandler: function()\n\t\t\t{\n\t\t\t\tthis._servicesCheckBox.checked = false;\n\t\t\t}.bind(this),\n\t\t\tfieldSettings: fieldSettings,\n\t\t\tgetFullDayValue: function(){return this._fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\toptionWrapper.appendChild(\n\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } })\n\t\t);\n\n\t\t//region Checkbox \"Is Required\"\n\t\tthis.additionaOptionsWrap = optionWrapper.appendChild(BX.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-options\"}}));\n\n\t\tthis._isRequiredCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: this._field && this._field.isRequired() } }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._isRequiredCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"isRequiredField\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Show Always\"\n\t\tthis._showAlwaysCheckBox = BX.create(\"input\", { props: { type: \"checkbox\" } });\n\t\tif(isNew)\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = BX.prop.getBoolean(this._settings, \"showAlways\", true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._showAlwaysCheckBox.checked = this._field.checkOptionFlag(\n\t\t\t\tBX.Crm.EntityEditorControlOptions.showAlways\n\t\t\t);\n\t\t}\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._showAlwaysCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: this.getMessage(\"showAlways\") })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Overbooking\"\n\t\tthis._overbookingCheckBox = BX.create(\n\t\t\t\"input\",\n\t\t\t{ props: { type: \"checkbox\", checked: fieldSettings.ALLOW_OVERBOOKING === 'Y'} }\n\t\t);\n\n\t\tthis.additionaOptionsWrap.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis._overbookingCheckBox,\n\t\t\t\t\t\t\tBX.create(\"span\", { text: BX.message('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\tthis._innerWrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: \"calendar-resourcebook-content-block-btn-container\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"hr\", { props: { className: \"crm-entity-widget-hr\" } }),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-primary\"},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_SAVE\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onSaveButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"button\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: {type: \"button\", className: \"ui-btn ui-btn-sm ui-btn-light-border\" },\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_EDITOR_CANCEL\"),\n\t\t\t\t\t\t\t\tevents: {  click: BX.delegate(this.onCancelButtonClick, this) }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.fieldSettings = fieldSettings;\n\t\tthis.registerLayout(options);\n\t\tthis._hasLayout = true;\n\t};\n\n\tConfigurator.prototype.getDefaultUserfieldSettings = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getdefaultuserfieldsettings', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.displayCallback))\n\t\t\t\t{\n\t\t\t\t\tparams.displayCallback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.getBitrix24Limitation = function(params)\n\t{\n\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getbitrix24limitation', {\n\t\t\tdata: {}\n\t\t}).then(function (response)\n\t\t\t{\n\t\t\t\tif (params && BX.type.isFunction(params.callback))\n\t\t\t\t{\n\t\t\t\t\tparams.callback(response.data);\n\t\t\t\t}\n\t\t\t},\n\t\t\tfunction (response) {\n\t\t\t\t/**\n\t\t\t\t {\n\t\t\t\t\t\t \"status\": \"error\",\n\t\t\t\t\t\t \"errors\": [...]\n\t\t\t\t\t }\n\t\t\t\t **/\n\t\t\t});\n\t};\n\n\tConfigurator.prototype.onSaveButtonClick = function()\n\t{\n\t\tif(this._isLocked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.RESOURCE_LIMIT > 0 && this.getTotalResourceCount() > this.RESOURCE_LIMIT)\n\t\t{\n\t\t\tBookingUtil.showLimitationPopup();\n\t\t\treturn;\n\t\t}\n\n\t\tvar params =\n\t\t\t{\n\t\t\t\ttypeId: this._typeId,\n\t\t\t\tlabel: this._labelInput.value,\n\t\t\t\tmandatory: this._isRequiredCheckBox.checked,\n\t\t\t\tshowAlways: this._showAlwaysCheckBox.checked,\n\t\t\t\tmultiple: true\n\t\t\t};\n\n\t\tif(this._field)\n\t\t{\n\t\t\tparams[\"field\"] = this._field;\n\t\t}\n\n\t\tthis.fieldSettings.USE_RESOURCES = this.resourceList.isShown() ? 'Y' : 'N';\n\t\tthis.fieldSettings.USE_USERS = this.userList.isShown() ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES['resource']))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES = [];\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\n\t\t\tthis.resourceList.getDeletedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tthis.fieldSettings.SELECTED_RESOURCES.push(value);\n\t\t\t}, this);\n\t\t}\n\n\n\t\tif (this.fieldSettings && this.userList)\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS = [0];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tthis.fieldSettings.SELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}\n\n\t\tthis.fieldSettings.USE_SERVICES = this._servicesCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.SERVICE_LIST = [];\n\t\tif (this._servicesCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.fieldSettings.SERVICE_LIST = this.serviceList.getValues();\n\t\t}\n\n\t\tthis.fieldSettings.FULL_DAY = this._fulldayCheckBox.checked ? 'Y' : 'N';\n\t\tthis.fieldSettings.ALLOW_OVERBOOKING = this._overbookingCheckBox.checked ? 'Y' : 'N';\n\n\t\tif (this.fieldSettings.FULL_DAY === 'N')\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = this.timezoneSelector.getValue();\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = this.useUserTimezoneCheckBox.checked ? 'Y' : 'N';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fieldSettings.TIMEZONE = '';\n\t\t\tthis.fieldSettings.USE_USER_TIMEZONE = 'N';\n\t\t}\n\n\t\tparams[\"settings\"] = this.fieldSettings;\n\n\t\tBX.onCustomEvent(this, \"onSave\", [ this, params]);\n\t};\n\n\tConfigurator.prototype.getTotalResourceCount = function()\n\t{\n\t\tvar result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (BX.type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& BX.type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& BX.type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t{\n\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t{\n\t\t\t\t\tresult++;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimitForNewEntries = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.checkResourceCountLimit = function()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t};\n\n\tConfigurator.prototype.handleFullDayMode = function()\n\t{\n\t\tthis.timezoneSettingsWrap.style.display = this._fulldayCheckBox.checked ? 'none' : '';\n\t};\n\n\tConfigurator.prototype.handleUserTimezoneCheckbox = function()\n\t{\n\t\tthis.timezoneSelectorWrap.style.display = this.useUserTimezoneCheckBox.checked ? 'none' : '';\n\t};\n\n\n\treturn Configurator;\n};","export class CalendarViewSettingsSlider\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = 'calendar_custom_settings_' + Math.round(Math.random() * 1000000);\n\t\tthis.zIndex = 3100;\n\t\tthis.sliderId = \"calendar:resbook-settings-slider\";\n\n\t\tthis.SLIDER_WIDTH = 400;\n\t\tthis.SLIDER_DURATION = 80;\n\t\tthis.DOM = {};\n\n\t\tthis.params = params;\n\t}\n\n\tshow()\n\t{\n\t\tBX.SidePanel.Instance.open(this.sliderId, {\n\t\t\tcontentCallback: BX.delegate(this.create, this),\n\t\t\twidth: this.SLIDER_WIDTH,\n\t\t\tanimationDuration: this.SLIDER_DURATION\n\t\t});\n\n\t\tthis.hideHandler = this.hide.bind(this);\n\t\tthis.destroyHandler = this.destroy.bind(this);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\tBX.addCustomEvent(\"SidePanel.Slider:onCloseComplete\", );\n\t}\n\n\tclose()\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t}\n\n\thide(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\t// if (this.denyClose)\n\t\t\t// {\n\t\t\t// \tevent.denyAction();\n\t\t\t// }\n\t\t\t// else\n\t\t\t// {\n\t\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onClose\", this.hideHandler);\n\t\t\t//}\n\t\t}\n\t}\n\n\tdestroy(event)\n\t{\n\t\tif (event && event.getSliderPage && event.getSliderPage().getUrl() === this.sliderId)\n\t\t{\n\t\t\tBX.removeCustomEvent(\"SidePanel.Slider:onCloseComplete\", this.destroyHandler);\n\t\t\tBX.SidePanel.Instance.destroy(this.sliderId);\n\t\t}\n\t}\n\n\tcreate()\n\t{\n\t\tlet promise = new BX.Promise();\n\n\t\tlet html = '<div class=\"webform-buttons calendar-form-buttons-fixed\">' +\n\t\t\t'<span id=\"' + this.id + '_save\" class=\"webform-small-button webform-small-button-blue\">' + BX.message('USER_TYPE_RESOURCE_SAVE') + '</span>' +\n\t\t\t'<span id=\"' + this.id + '_close\" class=\"webform-button-link\">' + BX.message('USER_TYPE_RESOURCE_CLOSE') + '</span>' +\n\t\t\t'</div>' +\n\t\t\t'<div class=\"calendar-slider-calendar-wrap\">' +\n\t\t\t'<div class=\"calendar-slider-header\"><div class=\"calendar-head-area\"><div class=\"calendar-head-area-inner\"><div class=\"calendar-head-area-title\">' +\n\t\t\t'<span class=\"calendar-head-area-name\">' + BX.message('USER_TYPE_RESOURCE_SETTINGS') + \t\t\t'</span>' +\n\t\t\t'</div></div></div></div>' +\n\t\t\t'<div class=\"resource-booking-slider-workarea\"><div class=\"resource-booking-slider-content\"><div id=\"' + this.id + '_content\" class=\"resource-booking-settings\"></div></div></div></div>';\n\n\t\tpromise.fulfill(html);\n\t\tsetTimeout(this.initControls.bind(this), 100);\n\n\t\treturn promise;\n\t}\n\n\tinitControls()\n\t{\n\t\tthis.DOM.content = BX(this.id + '_content');\n\n\t\tBX.bind(BX(this.id + '_save'), 'click', this.save.bind(this));\n\t\tBX.bind(BX(this.id + '_close'), 'click', this.close.bind(this));\n\n\t\t// 1. Field\n\t\tif (this.params && BX.type.isArray(this.params.filterSelectValues))\n\t\t{\n\t\t\tthis.DOM.fieldOuterWrap = this.DOM.content.appendChild(BX.create('DIV', {attrs: {className: 'calendar-settings-control'}}));\n\t\t\tthis.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {\n\t\t\t\tattrs: {className: 'calendar-settings-control-name'},\n\t\t\t\ttext: BX.message('USER_TYPE_RESOURCE_FILTER_NAME')\n\t\t\t}));\n\n\t\t\tthis.DOM.fieldSelect = this.DOM.fieldOuterWrap.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-container calendar-field-container-select'}}))\n\t\t\t\t.appendChild(BX.create('DIV', {attrs: {className: 'calendar-field-block'}}))\n\t\t\t\t.appendChild(BX.create('select', {attrs: {className: 'calendar-field calendar-field-select'}}));\n\n\t\t\tthis.params.filterSelectValues.forEach(function(value){\n\t\t\t\tthis.DOM.fieldSelect.options.add(\n\t\t\t\t\tnew Option(value.TEXT, value.VALUE, this.params.filterSelect === value.VALUE, this.params.filterSelect === value.VALUE));\n\t\t\t}, this);\n\t\t}\n\t}\n\n\tsave()\n\t{\n\t\tlet entityType = this.params.entityType || 'none';\n\t\tBX.userOptions.save('calendar', 'resourceBooking', entityType, this.DOM.fieldSelect.value);\n\t\tthis.close();\n\t\tBX.reload();\n\t}\n}\n\n\n\n","import {Event, Dom, Loc, Type} from \"calendar.resourcebooking\";\nimport {ServiceSelector} from \"./controls/serviceselector\"\nimport {UserSelectorFieldEditControl} from \"./controls/userselectorfieldeditcontrol\";\nimport {ModeSelector} from \"./controls/modeselector\";\nimport {ResourceSelectorFieldEditControl} from \"./controls/resourceselectorfieldeditcontrol\";\n\nexport class AdminSettingsViewer\n{\n\tconstructor(params = {})\n\t{\n\t\tthis.params = Type.isPlainObject(params) ? params : {};\n\t\tthis.fieldSettings = Type.isPlainObject(this.params.settings) ? this.params.settings : {};\n\n\t\tthis.DOM = {\n\t\t\touterWrap: document.getElementById(this.params.outerWrapId),\n\t\t\tform: document.forms[this.params.formName]\n\t\t};\n\t}\n\n\tshowLayout()\n\t{\n\t\tif (!this.DOM.outerWrap || !this.DOM.form)\n\t\t\treturn;\n\n\t\tEvent.bind(this.DOM.form, 'submit', this.onSubmit.bind(this));\n\n\t\tDom.addClass(this.DOM.outerWrap, 'calendar-resourcebook-content calendar-resourcebook-content-admin-settings');\n\n\t\tthis.DOM.innerWrap = this.DOM.outerWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-wrap\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-inner\"}}));\n\n\t\tlet\n\t\t\tresourceList = [],\n\t\t\tselectedResourceList = [];\n\n\t\tthis.DOM.innerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tDom.create(\n\t\t\t\t\t\t\t\t\"span\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: {className: \"calendar-resourcebook-content-block-title-text\"},\n\t\t\t\t\t\t\t\t\ttext: Loc.getMessage('USER_TYPE_RESOURCE_CHOOSE')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tnew ModeSelector({\n\t\t\t\t\t\t\t\tuseResources: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\t\t\t\t\t\tuseUsers: this.fieldSettings.USE_USERS === 'Y',\n\t\t\t\t\t\t\t\tshowUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.hide();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResources: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.hide();\n\t\t\t\t\t\t\t\t}.bind(this),\n\t\t\t\t\t\t\t\tshowResourcesAndUsers: function(){\n\t\t\t\t\t\t\t\t\tthis.resourceList.show();\n\t\t\t\t\t\t\t\t\tthis.userList.show();\n\t\t\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t\t\t}).getOuterWrap()\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.DOM.optionWrap = this.DOM.innerWrap.appendChild(Dom.create(\n\t\t\t\"div\",\n\t\t\t{\n\t\t\t\tprops: { className: \"calendar-resourcebook-content-block\" }\n\t\t\t}\n\t\t));\n\n\t\t// region Use Resources Option\n\t\tthis.resourcesWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.resourcesTitleWrap = this.resourcesWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_RESOURCE_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.resourcesListWrap = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-new-entries-wrap calendar-resourcebook-content-block-detail-inner\"}}));\n\n\t\tthis.resourcesListLowControls = this.resourcesWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resource-content-block-add-field\"}}));\n\n\t\tif (this.fieldSettings.RESOURCES\n\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES['resource'])\n\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES['resource'].SECTIONS))\n\t\t{\n\t\t\tthis.fieldSettings.RESOURCES['resource'].SECTIONS.forEach(function(resource)\n\t\t\t{\n\t\t\t\tresourceList.push({\n\t\t\t\t\tid: resource.ID,\n\t\t\t\t\ttitle: resource.NAME,\n\t\t\t\t\ttype: resource.CAL_TYPE\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_RESOURCES))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_RESOURCES.forEach(function(resource)\n\t\t\t{\n\t\t\t\tselectedResourceList.push({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\ttype: resource.type\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tthis.resourceList = new ResourceSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_RESOURCES === 'Y',\n\t\t\teditMode: true,\n\t\t\touterWrap: this.resourcesWrap,\n\t\t\tlistWrap: this.resourcesListWrap,\n\t\t\tcontrolsWrap: this.resourcesListLowControls,\n\t\t\tvalues: selectedResourceList,\n\t\t\tresourceList: resourceList,\n\t\t\tcheckLimitCallback: this.checkResourceCountLimit.bind(this)\n\t\t});\n\n\t\tthis.userSelectorWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\"}}));\n\n\t\tthis.usersTitleWrap = this.userSelectorWrap\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}}))\n\t\t\t.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_USERS_CONTROL_DEFAULT_NAME') + ':'}));\n\n\t\tthis.usersListWrap = this.userSelectorWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-control custom-field-item\"}}));\n\n\t\tlet itemsSelected = [];\n\t\tif (Type.isArray(this.fieldSettings.SELECTED_USERS))\n\t\t{\n\t\t\tthis.fieldSettings.SELECTED_USERS.forEach(function(user)\n\t\t\t{\n\t\t\t\titemsSelected.push('U' + parseInt(user));\n\t\t\t});\n\t\t}\n\n\t\tthis.userList = new UserSelectorFieldEditControl({\n\t\t\tshown: this.fieldSettings.USE_USERS === 'Y',\n\t\t\touterWrap: this.userSelectorWrap,\n\t\t\twrapNode: this.usersListWrap,\n\t\t\tsocnetDestination: this.params.socnetDestination,\n\t\t\titemsSelected: itemsSelected\n\t\t});\n\n\t\t// Region Data, Time and services\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.datetimeOptionsWrap = this.DOM.optionWrap.appendChild(Dom.create(\"div\", {props: { className: \"calendar-resourcebook-content-block-control-field calendar-resourcebook-content-block-control-field-add\" }}));\n\n\t\tthis.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title\"}})).appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-title-text\"}, text: Loc.getMessage('USER_TYPE_RESOURCE_DATETIME_BLOCK_TITLE') + ':'}));\n\n\t\tthis.datetimeOptionsInnerWrap = this.datetimeOptionsWrap.appendChild(Dom.create(\"div\", {props: {className: \"calendar-resourcebook-content-block-options\"}}));\n\t\t// endregion\n\n\t\t//region Checkbox \"Full day\"\n\t\tthis.DOM.fulldayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: { type: \"checkbox\", checked: this.fieldSettings.FULL_DAY === 'Y'}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.fulldayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_FULL_DAY') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\n\t\t//region Checkbox \"Add services\"\n\t\tthis.DOM.useServicedayCheckBox = Dom.create(\n\t\t\t\"input\",\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\tchecked: this.fieldSettings.USE_SERVICES === 'Y'\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'click' : function(){\n\t\t\t\t\t\tif (this.serviceList)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.serviceList.show(this.DOM.useServicedayCheckBox.checked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this)\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.datetimeOptionsInnerWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.useServicedayCheckBox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_ADD_SERVICES') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis.serviceList = new ServiceSelector({\n\t\t\touterCont: this.datetimeOptionsInnerWrap,\n\t\t\tfieldSettings: this.fieldSettings,\n\t\t\tgetFullDayValue: function(){return this.DOM.fulldayCheckBox.checked}.bind(this)\n\t\t});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\"hr\", { props: { className: \"calendar-resbook-hr\"}})\n\t\t);\n\n\t\tthis.DOM.overbookingCheckbox = Dom.create(\"input\", {props: {type: \"checkbox\", checked: this.fieldSettings.ALLOW_OVERBOOKING === 'Y'}});\n\n\t\tthis.DOM.optionWrap.appendChild(\n\t\t\tDom.create(\n\t\t\t\t\"label\",\n\t\t\t\t{\n\t\t\t\t\tprops: {className: 'calendar-resourcebook-content-block-option'},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.DOM.overbookingCheckbox,\n\t\t\t\t\t\t\tDom.create(\"span\", { text: Loc.getMessage('USER_TYPE_RESOURCE_OVERBOOKING') })\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\t//endregion\n\t}\n\n\tonSubmit(e)\n\t{\n\t\tif (!this.DOM.inputsWrap)\n\t\t{\n\t\t\tthis.DOM.inputsWrap = this.DOM.outerWrap.appendChild(Dom.create(\"DIV\"));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.clean(this.DOM.inputsWrap);\n\t\t}\n\n\t\tlet inputName = this.params.htmlControl.NAME;\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_USERS]',\n\t\t\t\tvalue: this.userList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_RESOURCES]',\n\t\t\t\tvalue: this.resourceList.isShown() ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[USE_SERVICES]',\n\t\t\t\tvalue: this.DOM.useServicedayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[FULL_DAY]',\n\t\t\t\tvalue: this.DOM.fulldayCheckBox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\tthis.DOM.inputsWrap.appendChild(Dom.create('INPUT', {\n\t\t\tattrs:{\n\t\t\t\tname: inputName + '[ALLOW_OVERBOOKING]',\n\t\t\t\tvalue: this.DOM.overbookingCheckbox.checked ? 'Y' : 'N',\n\t\t\t\ttype: 'hidden'\n\t\t\t}}));\n\n\t\t// Selected resources\n\t\tif (this.resourceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.resourceList.getSelectedValues().concat(this.resourceList.getDeletedValues()), inputName + '[SELECTED_RESOURCES]');\n\t\t}\n\n\t\t// // Selected users\n\t\tif (this.userList)\n\t\t{\n\t\t\tlet SELECTED_USERS = [];\n\t\t\tthis.userList.getAttendeesCodesList().forEach(function(code)\n\t\t\t{\n\t\t\t\tif (code.substr(0, 1) === 'U')\n\t\t\t\t{\n\t\t\t\t\tSELECTED_USERS.push(parseInt(code.substr(1)));\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, SELECTED_USERS, inputName + '[SELECTED_USERS]');\n\t\t}\n\n\t\tif (this.DOM.useServicedayCheckBox.checked && this.serviceList)\n\t\t{\n\t\t\tthis.prepareFormDataInputs(this.DOM.inputsWrap, this.serviceList.getValues(), inputName + '[SERVICE_LIST]');\n\t\t}\n\t}\n\n\tprepareFormDataInputs(wrap, data, inputName)\n\t{\n\t\tdata.forEach(function(value, ind)\n\t\t{\n\t\t\tif (Type.isPlainObject(value))\n\t\t\t{\n\t\t\t\tlet k;\n\t\t\t\tfor (k in value)\n\t\t\t\t{\n\t\t\t\t\tif (value.hasOwnProperty(k))\n\t\t\t\t\t{\n\t\t\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\t\t\tattrs:{\n\t\t\t\t\t\t\t\tname: inputName + '[' + ind + '][' + k + ']',\n\t\t\t\t\t\t\t\tvalue: value[k],\n\t\t\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t\t\t}}));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twrap.appendChild(Dom.create('INPUT', {\n\t\t\t\t\tattrs:{\n\t\t\t\t\t\tname: inputName + '[' + ind + ']',\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\ttype: 'hidden'\n\t\t\t\t\t}}));\n\t\t\t}\n\t\t}, this);\n\t}\n\n\tgetTotalResourceCount()\n\t{\n\t\tlet result = 0;\n\n\t\tif (this.fieldSettings)\n\t\t{\n\t\t\tif (Type.isPlainObject(this.fieldSettings.RESOURCES)\n\t\t\t\t&& Type.isPlainObject(this.fieldSettings.RESOURCES.resource)\n\t\t\t\t&& Type.isArray(this.fieldSettings.RESOURCES.resource.SECTIONS)\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult += this.fieldSettings.RESOURCES.resource.SECTIONS.length;\n\t\t\t}\n\n\t\t\tif (this.resourceList)\n\t\t\t{\n\t\t\t\tresult -= this.resourceList.getDeletedValues().length;\n\n\t\t\t\tthis.resourceList.getSelectedValues().forEach(function(value)\n\t\t\t\t{\n\t\t\t\t\tif (!value.id && value.title !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult++;\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t}\n\n\t\t\tif (this.userList)\n\t\t\t{\n\t\t\t\tresult += this.userList.getAttendeesCodesList().length;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcheckResourceCountLimitForNewEntries()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() < this.RESOURCE_LIMIT;\n\t}\n\n\tcheckResourceCountLimit()\n\t{\n\t\treturn this.RESOURCE_LIMIT <= 0 || this.getTotalResourceCount() <= this.RESOURCE_LIMIT;\n\t}\n}","import {AdjustFieldController} from \"./adjustfieldcontroller\";\nimport {EditFieldController} from \"./editfieldcontroller\";\nimport {Type} from \"main.core\";\nimport {Resourcebooking, BookingUtil} from \"calendar.resourcebooking\";\nimport {customizeCrmEntityEditor} from \"./customizecrmentityeditor\"\nimport {CalendarViewSettingsSlider} from \"./calendarviewsettingsslider\"\nimport {AdminSettingsViewer} from \"./adminsettingsviewer\"\n\nexport {Resourcebooking, BookingUtil, AdminSettingsViewer};\nexport class ResourcebookingUserfield\n{\n\tstatic fieldParamsCache = {};\n\tstatic socnetDestination = null;\n\n\t/**\n\t * Creates instance of Resourcebooking field for crm form edit interface (not for live form)\n\t * and initialize it with given field params\n\t * Used in CRM webform module to display and adjust resourcebooking field\n\t *\n\t * @param {array} params - incoming data params\n\t */\n\tstatic initCrmFormFieldController(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {\n\t\t\t\tfield:{}\n\t\t\t};\n\t\t}\n\n\t\tlet bookingFieldParams = {};\n\t\tif (Type.isDomNode(params.field.node))\n\t\t{\n\t\t\tbookingFieldParams.outerWrap = params.field.node;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error(\"The argument \\\"params.field.node\\\" must be a DOM node.\");\n\t\t}\n\n\t\tbookingFieldParams.innerWrap = bookingFieldParams.outerWrap.querySelector('.crm-webform-resourcebooking-wrap');\n\t\tif (!bookingFieldParams.innerWrap)\n\t\t{\n\t\t\tthrow new Error(\"Can't find necessary DOM node \\\"div.crm-webform-resourcebooking-wrap\\\"\");\n\t\t}\n\n\t\tbookingFieldParams.name = params.field.name;\n\t\tbookingFieldParams.formName = 'FIELD[' + params.field.name + ']';\n\t\tbookingFieldParams.captionNode = params.field.lblCaption;\n\t\tbookingFieldParams.entityFieldName = params.field.entity_field_name;\n\t\tbookingFieldParams.entityName = params.field.dict.entity_field_name;\n\n\t\tbookingFieldParams.settings = {\n\t\t\tcaption: params.field.captionValue || params.field.dict.caption,\n\t\t\trequired: params.field.isRequired || params.field.dict.required,\n\t\t\tdata: (Type.isPlainObject(params.field.booking) && Type.isPlainObject(params.field.booking.settings_data))\n\t\t\t\t? params.field.booking.settings_data\n\t\t\t\t: (params.field.settingsData || [])\n\t\t};\n\n\t\tlet adjustFieldController = new AdjustFieldController(bookingFieldParams);\n\t\tadjustFieldController.init();\n\n\t\treturn adjustFieldController;\n\t}\n\n\tstatic initEditFieldController(params)\n\t{\n\t\tlet editFieldController = new EditFieldController(params);\n\t\teditFieldController.init();\n\n\t\treturn editFieldController;\n\t}\n\n\tstatic getCrmFieldConfigurator(id, settings)\n\t{\n\t\tif(window.BX && BX.Crm && Type.isFunction(BX.Crm.EntityEditorUserFieldConfigurator))\n\t\t{\n\t\t\treturn customizeCrmEntityEditor(BX.Crm.EntityEditorUserFieldConfigurator).create(id, settings);\n\t\t}\n\t}\n\n\tstatic getUserFieldParams(params = {})\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet fieldName = params.fieldName || '';\n\n\t\t\tif (params.clearCache || !ResourcebookingUserfield.fieldParamsCache[params.fieldName])\n\t\t\t{\n\t\t\t\tBX.ajax.runAction('calendar.api.resourcebookingajax.getfieldparams', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfieldname: params.fieldName,\n\t\t\t\t\t\tselectedUsers: params.selectedUsers || []\n\t\t\t\t\t}\n\t\t\t\t}).then((response) => {\n\t\t\t\t\t\tResourcebookingUserfield.fieldParamsCache[fieldName] = response.data;\n\t\t\t\t\t\tresolve(response.data);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(ResourcebookingUserfield.fieldParamsCache[fieldName]);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getPluralMessage(messageId, number)\n\t{\n\t\tlet pluralForm, langId;\n\n\t\tlangId = BX.message('LANGUAGE_ID') || 'en';\n\t\tnumber = parseInt(number);\n\n\t\tif (number < 0)\n\t\t{\n\t\t\tnumber = -1*number;\n\t\t}\n\n\t\tif (langId)\n\t\t{\n\t\t\tswitch (langId)\n\t\t\t{\n\t\t\t\tcase 'ru':\n\t\t\t\tcase 'ua':\n\n\t\t\t\t\tif ((number % 10 === 1) && (number % 100 !== 11))\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = ((number%10 >= 2) && (number%10 <= 4) && ((number%100 < 10) || (number%100 >= 20)))\n\t\t\t\t\t\t\t? 1\n\t\t\t\t\t\t\t: 2;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pl':\n\t\t\t\t\tif (number <= 4)\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = number === 1 ? 0 : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tpluralForm = 2;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: // en, de and other languages\n\t\t\t\t\tpluralForm = (number !== 1) ? 1 : 0;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpluralForm = 1;\n\t\t}\n\n\t\treturn BX.message(messageId + '_PLURAL_' + pluralForm);\n\t}\n\n\tstatic getParamsFromHash(userfieldId)\n\t{\n\t\tlet\n\t\t\tparams, regRes,\n\t\t\thash = unescape(window.location.hash);\n\n\t\tif (hash)\n\t\t{\n\t\t\tregRes = new RegExp('#calendar:' + userfieldId + '\\\\|(.*)', 'ig').exec(hash);\n\t\t\tif (regRes && regRes.length > 1)\n\t\t\t{\n\t\t\t\tparams = regRes[1].split('|');\n\t\t\t}\n\t\t}\n\t\treturn params;\n\t}\n\n\tstatic openExternalSettingsSlider(params)\n\t{\n\t\tlet settingsSlider = new CalendarViewSettingsSlider(params);\n\t\tsettingsSlider.show();\n\t}\n\n\tstatic setSocnetDestination(socnetDestination)\n\t{\n\t\tResourcebookingUserfield.socnetDestination = socnetDestination;\n\t}\n\n\tstatic getSocnetDestination()\n\t{\n\t\treturn ResourcebookingUserfield.socnetDestination;\n\t}\n}"],"names":["FormFieldTunnerAbstract","constructor","label","formLabel","displayed","valuePopup","statePopup","displayCheckboxDisabled","DOM","build","params","updateConfig","fieldWrap","Dom","create","props","className","labelWrap","appendChild","labelNode","text","getLabel","formTitleWrap","isDisplayed","formTitleLabel","getFormLabel","events","click","enableFormTitleEditMode","bind","formTitleEditIcon","checkboxNode","attrs","type","value","checked","disabled","checkDisplayMode","buildStatePopup","wrap","config","buildValuePopup","Type","isFunction","changeSettingsCallback","destroy","closePopup","setFormLabel","show","displayInForm","hideInForm","addClass","triggerChangeRefresh","removeClass","formTitleInputNode","blur","finishFormTitleEditMode","style","display","focus","adjust","getSettingsValue","setTimeout","BX","onCustomEvent","FormFieldTunnerPopupAbstract","id","Math","round","random","menuItems","outerWrap","handleClickFunc","handleClick","innerWrap","currentStateLink","getCurrentModeState","showPopup","isPopupShown","getMenuItems","Event","unbind","document","popup","PopupMenu","closeByEsc","autoHide","offsetTop","offsetLeft","cacheable","popupWindow","setAngle","offset","position","popupContainer","forEach","menuItem","inputType","inputNameStr","dataset","menuItemClassName","inputName","innerHtml","textValue","layout","item","innerHTML","close","maxHeight","isShown","isNodeInDom","getPopupContent","handlePopupClick","e","target","srcElement","hasAttribute","findParent","attribute","handleControlChanges","changesTimeout","clearTimeout","delegate","menuItemClick","isParentForNode","animation","setDisabled","setEnabled","FormFieldTunnerValuePopupAbstract","selectedValues","valueLink","getCurrentValueState","mouseover","showHoverPopup","mouseout","hideHoverPopup","PopupWindow","loseByEsc","width","getPopupWidth","lightShadow","content","proxy","addCustomEvent","handlePopupCloose","message","minWidth","minHeight","showPopupLoader","hidePopupLoader","popupLoader","BookingUtil","getLoader","remove","FormFieldTunnerMultipleChecknoxPopupAbstract","values","push","util","htmlspecialchars","title","onclick","length","selectAllMessage","selectAllItemClick","find","itemId","selectAllChecked","selectAllcheckbox","checkbox","querySelector","foundValue","hasClass","selectItem","deselectItem","in_array","index","array_search","deleteFromArray","i","checkboxes","querySelectorAll","getSelectedValues","UserSelectorFieldTunner","Loc","getMessage","selectedUsers","defaultMode","UsersStatePopup","isArray","selected","split","valueWrap","Tag","render","usersValueLink","showUserSelectorDialog","getCurrentUsersValueText","count","ResourcebookingUserfield","getPluralMessage","userSelectorDialog","EntitySelectorDialog","targetNode","context","preselectedItems","map","userId","enableSearch","zIndex","handleUserSelectorChanges","entities","options","inviteGuestLink","emailUsers","analyticsSource","getSelectedItems","entityId","EventEmitter","emit","getValue","getDefaultMode","name","MenuItem","delimiter","isDomNode","nodeName","toLowerCase","ResourceSelectorFieldTunner","multiple","ResourcesStatePopup","ResourcesValuePopup","getMultiple","getSelectedId","selectedItems","selectedIndex","selectAll","isString","resources","resource","valueId","prepareValueId","result","val","parseInt","ServiceSelectorFieldTunner","html","ServiceValuePopup","undefined","translit","services","service","getDurationLabel","duration","DurationSelectorFieldTunner","defaultValue","manualInput","DurationStatePopup","getDefaultValue","getManualInput","durationList","getDurationList","fullDay","getDurationLabelByValue","items","getDefaultMenuItems","concat","foundDuration","DateSelectorFieldTunner","start","DateStatePopup","getStyle","getStart","styleInputName","startInputName","TimeSelectorFieldTunner","showOnlyFree","showFinishTime","scale","TimeStatePopup","getShowFinishTime","getShowOnlyFree","getScale","stateShowFreeId","stateShowFinishId","getDurationMenuItems","filter","AdjustFieldController","setEventNamespace","complexFields","userFieldParams","settingsData","getSettingsData","settings","data","settingsWrap","captionNode","settingsInputs","init","showFieldLoader","getUserFieldParams","fieldName","entityName","getSelectedUsers","then","fieldParams","hideFieldLoader","fieldLayout","FieldViewControllerEdit","displayTitle","getCaption","getSettings","updateSettingsDataInputs","BaseEvent","showSettingsPopup","settingsPopupId","settingsPopup","getSettingsContentNode","overlay","backgroundColor","opacity","titleBar","closeIcon","buttons","PopupWindowButton","buttonNodeWrap","buttonNode","parentNode","destroyControls","previewFieldLayout","leftWrap","buildSettingsForm","previewWrap","FieldViewControllerPreview","handleWebformSettingsChanges","titleId","captionWrap","captionInput","change","updateCaption","keyup","fieldsOuterWrap","fieldsWrap","userfieldSettings","useUsers","buildComplexField","updateSettings","users","checkBitrix24Limitation","useResources","useServices","date","time","replace","k","hasOwnProperty","refreshLayoutTimeout","refreshLayout","getOuterWrap","getInnerWrap","offsetHeight","isObject","field","option","clone","getDefaultSettingsData","isPlainObject","updateSettingsInputValue","key","uniKey","join","formName","fieldLoader","SETTINGS","SELECTED_RESOURCES","SELECTED_USERS","SERVICE_LIST","FULL_DAY","USE_RESOURCES","USE_USERS","USE_SERVICES","resourceLimit","RESOURCE_LIMIT","userIndex","USER_INDEX","caption","updateTitle","isRequired","required","updateRequiredValue","requiredCheckbox","usersValue","showLimitationPopup","UserSelectorFieldEditControl","wrapNode","destinationInputName","selectGroups","addMessage","checkLimit","checkLimitCallback","itemsSelected","getSocnetDestinationConfig","shown","SocNetLogDestination","deleteItem","getAttribute","block","openDialog","socnetDestinationInputWrap","socnetDestinationInput","keydown","searchBeforeHandler","inputId","searchHandler","linkId","sendAjax","socnetDestinationLink","hide","_this","itemsLast","groups","department","sonetgroups","searchInput","extranetUser","userSearchArea","bindMainPopup","node","bindSearchPopup","callback","select","selectCallback","unSelect","unSelectCallback","openDialogCallback","closeDialog","closeDialogCallback","openSearch","closeSearch","departmentSelectDisable","closeAll","isOpenDialog","addUserBlock","getAttendeesCodesList","includes","blocks","itemWrap","elements","findChildren","j","cleanInputValue","isOpenSearch","backspaceDisable","window","keyCode","preventDefault","getCodes","inputsList","getElementsByTagName","codes","trim","getAttendeesCodes","convertAttendeesCodes","attendeesCodes","code","substr","res","socnetDestination","USERS","EXTRANET_USER","DENY_TOALL","UA","SONETGROUPS","DEPARTMENT","departmentRelation","DEPARTMENT_RELATION","LAST","SELECTED","inputs","setValues","userList","trigerOnChange","user","obItems","onChangeCallback","getId","ResourceSelectorFieldEditControl","editMode","resourceList","checkLimitForNew","checkLimitCallbackForNew","selectedValuesIndex","selectedBlocks","newValues","blocksWrap","listWrap","controlsWrap","arrowNode","addButton","addResourceBlock","selectButton","openResourcesPopup","handleBlockClick","blockValue","element","checkBlockWrapState","isResourcesPopupShown","deleted","foundResource","removeResourceBlock","checkResourceInputs","menuItemNode","textNode","offsetWidth","B24","blockEntry","input","placeholder","resourceType","resourceId","delButton","focusInput","transparent","children","max","childNodes","emptyPlaceholder","closeResourcesPopup","getValues","addToSelectedValues","getDeletedValues","PlannerPopup","bindNode","plannerId","plannerConfig","lastPlannerIdShown","currentEntries","plannerWrap","Popup","bindPos","pos","winSize","GetWindowSize","plannerWidth","innerWidth","right","showPlanner","update","refreshParams","codeIndex","fromTimestamp","toTimestamp","dateFrom","dateTo","lastUpdateParams","focusSelector","from","to","parseDate","getTime","selector","getDayLength","Date","scaleDateFrom","scaleDateTo","requestData","formatDate","currentEventList","checkUpdateParams","showPlannerLoader","ajax","runAction","response","hidePlannerLoader","lastRequestData","entries","currentAccessibility","accessibility","currentLoadedDataFrom","currentLoadedDataTo","entry","selectedResources","updateScaleLimits","loadedDataFrom","loadedDataTo","requestPlannerUpdate","lastRequestPlannerId","array_diff","resIndex","planner","CalendarPlanner","updateScaleType","RRULE","selectorOnChangeCallback","selectEntriesOnChangeCallback","checkSelectorStatusCallback","loader","removeCustomEvent","getPlannerId","EditFieldController","plannerPopup","controlId","valueInputs","isNew","DATE_FROM","setSocnetDestination","buildUserfieldWrap","createEventHandlers","setControlValues","buildDateControl","buildTimeControl","buildServiceControl","buildDurationControl","buildUserSelectorControl","buildResourceSelectorControl","showPlannerPopup","fromInput","durationInput","allowOverbooking","isOverbooked","addError","Crm","EntityValidationError","Promise","resolve","onChangeValues","allValuesValue","defaultDuration","getParamsFromHash","userfieldId","roundMin","r","timestamp","ceil","DATE_TO","getDateFormat","timeFromInput","getTimeFormatShort","setValue","serviceList","SERVICE_NAME","ENTRIES","TYPE","RESOURCE_ID","resourceSelector","userSelector","dateTimeWrap","dateWrap","showCalendarPicker","triggerUpdatePlanner","emptyInput","timeWrap","fromTime","SelectInput","getSimpleTimeList","onAfterMenuOpen","ind","popupMenu","formatDatetime","isAmPmMode","nearestTimeValue","adaptTimeValue","h","getHours","m","getMinutes","menuContainer","scrollTop","durationWrap","servicesWrap","serviceInput","serviceListValues","state","realValue","parseDuration","durationControlWrap","userSelectorWrap","userSelectorTitle","userListWrap","userKey","getSocnetDestination","checkResourceCountLimit","resourcesWrap","resSelectorTitle","resourcesListWrap","calendar","bTime","dateFromValue","serviceName","isDate","getSelectedResourceList","getSelectedUserList","getDateTimeFormat","fireEvent","EVENT_ID","isNull","getPlannerConfig","getSelectorData","plannerSelectorOnChange","plannerSelectedEntriesOnChange","getResourceList","getUserList","selectEntriesMode","scaleLimitOffsetLeft","scaleLimitOffsetRight","maxTimelineSize","minEntryRows","entriesListWidth","timelineCellWidth","accuracy","workTime","clickSelectorScaleAccuracy","errorClass","overbooked","status","errorNode","getTotalResourceCount","ServiceSelector","outerCont","fieldSettings","serviceListOuterWrap","durationTitleId","servicesTitleWrap","serviceListRowsWrap","addRow","serviceListAddWrap","serviceAddButton","checkDurationTitlePosition","row","getDefaultDuration","nameInput","fullday","getFullDayValue","deleteWrap","timeout","checkDurationTitlePositionTimeout","left","clickHandler","resWrap","checkRows","rows","onFullClearHandler","TimezoneSelector","add","Option","selectedValue","getTimezoneList","timezoneList","timezone","clearCache","timezone_id","default","ModeSelector","showResources","modeSwitcherPopup","showUsers","showResourcesAndUsers","switcherId","angle","customizeCrmEntityEditor","CrmConfigurator","Configurator","superclass","apply","extend","self","initialize","prototype","_hasLayout","_mode","EntityEditorMode","view","getBitrix24Limitation","limit","_field","fieldInfo","getFieldInfo","getDefaultUserfieldSettings","displayCallback","_wrapper","_innerWrapper","selectedResourceList","manager","_editor","getUserFieldManager","getTitle","getDefaultFieldLabel","_typeId","_labelInput","optionWrapper","resourcesTitleWrap","resourcesListLowControls","RESOURCES","SECTIONS","ID","NAME","CAL_TYPE","checkResourceCountLimitForNewEntries","usersTitleWrap","usersListWrap","datetimeOptionsWrap","datetimeOptionsInnerWrap","timezoneSettingsWrap","timezoneSelectorWrap","USE_USER_TIMEZONE","timezoneSelectWrap","timezoneSelector","TIMEZONE","useUserTimezoneCheckBox","handleUserTimezoneCheckbox","_fulldayCheckBox","handleFullDayMode","_servicesCheckBox","additionaOptionsWrap","_isRequiredCheckBox","_showAlwaysCheckBox","prop","getBoolean","_settings","checkOptionFlag","EntityEditorControlOptions","showAlways","_overbookingCheckBox","ALLOW_OVERBOOKING","onSaveButtonClick","onCancelButtonClick","registerLayout","_isLocked","typeId","mandatory","CalendarViewSettingsSlider","sliderId","SLIDER_WIDTH","SLIDER_DURATION","SidePanel","Instance","open","contentCallback","animationDuration","hideHandler","destroyHandler","event","getSliderPage","getUrl","promise","fulfill","initControls","save","filterSelectValues","fieldOuterWrap","fieldSelect","TEXT","VALUE","filterSelect","entityType","userOptions","reload","AdminSettingsViewer","getElementById","outerWrapId","form","forms","showLayout","onSubmit","optionWrap","fulldayCheckBox","useServicedayCheckBox","overbookingCheckbox","inputsWrap","clean","htmlControl","prepareFormDataInputs","initCrmFormFieldController","bookingFieldParams","Error","lblCaption","entityFieldName","entity_field_name","dict","captionValue","booking","settings_data","adjustFieldController","initEditFieldController","editFieldController","getCrmFieldConfigurator","EntityEditorUserFieldConfigurator","fieldParamsCache","fieldname","messageId","number","pluralForm","langId","regRes","hash","unescape","location","RegExp","exec","openExternalSettingsSlider","settingsSlider"],"mappings":"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"}