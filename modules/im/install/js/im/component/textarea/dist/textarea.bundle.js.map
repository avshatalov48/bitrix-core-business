{"version":3,"file":"textarea.bundle.js","sources":["../src/textarea.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Textarea Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport './textarea.css';\nimport {BitrixVue} from \"ui.vue\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Utils} from \"im.lib.utils\";\nimport {Browser} from 'main.core';\nimport {Vuex} from \"ui.vue.vuex\";\n\nimport { EventEmitter } from 'main.core.events';\nimport { EventType, DeviceType } from \"im.const\";\n\nBitrixVue.component('bx-im-component-textarea',\n{\n\t/**\n\t * @emits 'send' {text: string}\n\t * @emits 'edit' {}\n\t * @emits 'writes' {text: string}\n\t * @emits 'focus' {event: object} -- 'event' - focus event\n\t * @emits 'blur' {event: object} -- 'event' - blur event\n\t * @emits 'keyup' {event: object} -- 'event' - keyup event\n\t * @emits 'keydown' {event: object} -- 'event' - keydown event\n\t * @emits 'appButtonClick' {appId: string, event: object} -- 'appId' - application name, 'event' - event click\n\t * @emits 'fileSelected' {fileInput: domNode} -- 'fileInput' - dom node element\n\t */\n\n\tprops:\n\t{\n\t\tsiteId: { default: 'default' },\n\t\tuserId: { default: 0 },\n\t\tdialogId: { default: 0 },\n\t\tenableCommand: { default: true },\n\t\tenableMention: { default: true },\n\t\tdesktopMode: { default: false },\n\t\tenableEdit: { default: false },\n\t\tenableFile: { default: false },\n\t\tsendByEnter: { default: true },\n\t\tautoFocus: { default: null },\n\t\twritesEventLetter: { default: 0 },\n\t\tstyles: {\n\t\t\ttype: Object,\n\t\t\tdefault: function () {\n\t\t\t\treturn {}\n\t\t\t}\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tplaceholderMessage: '',\n\t\t\tcurrentMessage: '',\n\t\t\tpreviousMessage: '',\n\t\t\tcommandListen: false,\n\t\t\tmentionListen: false,\n\t\t\tstylesDefault: Object.freeze({button: { backgroundColor: null, iconColor: null }})\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.textarea.insertText, this.onInsertText);\n\t\tEventEmitter.subscribe(EventType.textarea.setFocus, this.onFocusSet);\n\t\tEventEmitter.subscribe(EventType.textarea.setBlur, this.onFocusClear);\n\n\t\tthis.localStorage = LocalStorage;\n\n\t\tthis.textareaHistory = this.localStorage.get(this.siteId, this.userId, 'textarea-history', {});\n\t\tthis.currentMessage = this.textareaHistory[this.dialogId] || '';\n\t\tthis.placeholderMessage = this.currentMessage;\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.textarea.insertText, this.onInsertText);\n\t\tEventEmitter.unsubscribe(EventType.textarea.setFocus, this.onFocusSet);\n\t\tEventEmitter.unsubscribe(EventType.textarea.setBlur, this.onFocusClear);\n\n\t\tclearTimeout(this.messageStoreTimeout);\n\t\tthis.localStorage.set(this.siteId, this.userId, 'textarea-history', this.textareaHistory);\n\t\tthis.localStorage = null;\n\t},\n\tcomputed:\n\t{\n\t\ttextareaClassName()\n\t\t{\n\t\t\treturn ['bx-im-textarea', {\n\t\t\t\t'bx-im-textarea-dark-background': this.isDarkBackground,\n\t\t\t\t'bx-im-textarea-mobile': this.isMobile,\n\t\t\t}];\n\t\t},\n\n\t\tbuttonStyle()\n\t\t{\n\t\t\tlet styles = Object.assign({}, this.stylesDefault, this.styles);\n\n\t\t\tlet isIconDark = false;\n\t\t\tif (styles.button.iconColor)\n\t\t\t{\n\t\t\t\tisIconDark = Utils.isDarkColor(styles.button.iconColor);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tisIconDark = !Utils.isDarkColor(styles.button.backgroundColor);\n\t\t\t}\n\n\t\t\tstyles.button.className = isIconDark? 'bx-im-textarea-send-button': 'bx-im-textarea-send-button bx-im-textarea-send-button-bright-arrow';\n\t\t\tstyles.button.style = styles.button.backgroundColor? 'background-color: '+styles.button.backgroundColor+';': '';\n\n\t\t\treturn styles;\n\t\t},\n\t\tisDarkBackground()\n\t\t{\n\t\t\treturn this.application.options.darkBackground;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn this.application.device.type === DeviceType.mobile;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_MESSENGER_TEXTAREA_', this)\n\t\t},\n\t\tisIE11()\n\t\t{\n\t\t\treturn Browser.isIE11();\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\tdirectives: {\n\t\t'bx-im-focus':\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.value === true\n\t\t\t\t\t|| params.value === null && !this.isMobile\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\telement.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\t/**\n\t\t *\n\t\t * @param text\n\t\t * @param breakline - true/false (default)\n\t\t * @param position - start, current (default), end\n\t\t * @param cursor - start, before, after (default), end\n\t\t * @param focus - set focus on textarea\n\t\t */\n\t\tinsertText(text, breakline = false, position = 'current', cursor = 'after', focus = true)\n\t\t{\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tlet selectionStart = textarea.selectionStart;\n\t\t\tlet selectionEnd = textarea.selectionEnd;\n\n\t\t\tif (position == 'start')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\ttextarea.value = text + textarea.value;\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = 0;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (position == 'current')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value.substring(0, selectionStart).trim().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = \"\\n\"+text;\n\t\t\t\t\t}\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value && !textarea.value.endsWith(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = ' '+text;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttextarea.value = textarea.value.substring(0, selectionStart) + text + textarea.value.substring(selectionEnd, textarea.value.length);\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = selectionStart+text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = selectionStart;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (position == 'end')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value.substring(0, selectionStart).trim().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = \"\\n\"+text;\n\t\t\t\t\t}\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value && !textarea.value.endsWith(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = ' '+text;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttextarea.value = textarea.value+text;\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = textarea.value.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = textarea.value.length-text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (focus)\n\t\t\t{\n\t\t\t\tif (cursor == 'start')\n\t\t\t\t{\n\t\t\t\t\ttextarea.selectionStart = 0;\n\t\t\t\t\ttextarea.selectionEnd = 0;\n\t\t\t\t}\n\t\t\t\telse if (cursor == 'end')\n\t\t\t\t{\n\t\t\t\t\ttextarea.selectionStart = textarea.value.length;\n\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t}\n\n\t\t\t\ttextarea.focus();\n\t\t\t}\n\n\t\t\tthis.textChangeEvent();\n\t\t},\n\n\t\tsendMessage(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tEventEmitter.emit(EventType.textarea.sendMessage, {text: this.currentMessage.trim()});\n\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tif (textarea)\n\t\t\t{\n\t\t\t\ttextarea.value = '';\n\t\t\t}\n\n\t\t\tif (this.autoFocus === null || this.autoFocus)\n\t\t\t{\n\t\t\t\ttextarea.focus();\n\t\t\t}\n\n\t\t\tthis.textChangeEvent();\n\t\t},\n\n\t\ttextChangeEvent()\n\t\t{\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tif (!textarea)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet text = textarea.value.trim();\n\t\t\tif (this.currentMessage === text)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.writesEventLetter <= text.length)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.startWriting, {text});\n\t\t\t}\n\n\t\t\tthis.previousMessage = this.currentMessage;\n\t\t\tthis.previousSelectionStart = textarea.selectionStart;\n\t\t\tthis.previousSelectionEnd = this.previousSelectionStart;\n\t\t\tthis.currentMessage = text;\n\n\t\t\tif (text.toString().length > 0)\n\t\t\t{\n\t\t\t\tthis.textareaHistory[this.dialogId] = text;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdelete this.textareaHistory[this.dialogId];\n\t\t\t}\n\n\t\t\tclearTimeout(this.messageStoreTimeout);\n\t\t\tthis.messageStoreTimeout = setTimeout(() => {\n\t\t\t\tthis.localStorage.set(this.siteId, this.userId, 'textarea-history', this.textareaHistory, this.userId? 0: 10);\n\t\t\t}, 500);\n\t\t},\n\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tthis.$emit('keydown', event);\n\n\t\t\tlet textarea = event.target;\n\t\t\tlet text = textarea.value.trim();\n\t\t\tlet isMac = Utils.platform.isMac();\n\t\t\tlet isCtrlTEnable = Utils.platform.isBitrixDesktop() || !Utils.browser.isChrome();\n\n\t\t\t// TODO see more im/install/js/im/im.js:12324\n\t\t\tif (this.commandListen)\n\t\t\t{\n\t\t\t}\n\t\t\telse if (this.mentionListen)\n\t\t\t{\n\t\t\t}\n\t\t\telse if (!(event.altKey && event.ctrlKey))\n\t\t\t{\n\t\t\t\tif (this.enableMention && (event.shiftKey  && (event.keyCode == 61 || event.keyCode == 50 || event.keyCode == 187 || event.keyCode == 187)) || event.keyCode == 107)\n\t\t\t\t{\n\t\t\t\t\t// mention case\n\t\t\t\t}\n\t\t\t\telse if (this.enableCommand && (event.keyCode == 191 || event.keyCode == 111 || event.keyCode == 220))\n\t\t\t\t{\n\t\t\t\t\t// command case\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (event.keyCode == 27)\n\t\t\t{\n\t\t\t\tif (textarea.value != '' && textarea === document.activeElement)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t}\n\t\t\t\tif (event.shiftKey)\n\t\t\t\t{\n\t\t\t\t\ttextarea.value = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.metaKey || event.ctrlKey)\n\t\t\t{\n\t\t\t\t// TODO translit messages\n\t\t\t\tif (\n\t\t\t\t\tisCtrlTEnable && event.key === 't'\n\t\t\t\t\t|| !isCtrlTEnable && event.key === 'e'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// translit case\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\telse if (['b','s','i','u'].includes(event.key))\n\t\t\t\t{\n\t\t\t\t\tlet selectionStart = textarea.selectionStart;\n\t\t\t\t\tlet selectionEnd = textarea.selectionEnd;\n\n\t\t\t\t\tlet tagStart = '['+event.key.toLowerCase()+']';\n\t\t\t\t\tlet tagEnd = '[/'+event.key.toLowerCase()+']';\n\t\t\t\t\tlet selected = textarea.value.substring(selectionStart, selectionEnd);\n\n\t\t\t\t\tif (selected.startsWith(tagStart) && selected.endsWith(tagEnd))\n\t\t\t\t\t{\n\t\t\t\t\t\tselected = selected.substring(tagStart.length, selected.indexOf(tagEnd));\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselected = tagStart + selected + tagEnd;\n\t\t\t\t\t}\n\n\t\t\t\t\ttextarea.value = textarea.value.substring(0, selectionStart) + selected + textarea.value.substring(selectionEnd, textarea.value.length);\n\n\t\t\t\t\ttextarea.selectionStart = selectionStart;\n\t\t\t\t\ttextarea.selectionEnd = selectionStart + selected.length;\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tthis.insertText(\"\\t\");\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (this.enableEdit && event.keyCode == 38 && text.length <= 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.edit, {});\n\t\t\t}\n\t\t\telse if (event.keyCode == 13)\n\t\t\t{\n\t\t\t\tif (this.isMobile)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (this.sendByEnter == true)\n\t\t\t\t{\n\t\t\t\t\tif (event.ctrlKey || event.altKey || event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!event.shiftKey)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.insertText(\"\\n\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (text.length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (event.ctrlKey == true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t\telse if (isMac && (event.metaKey == true || event.altKey == true))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ((event.ctrlKey || event.metaKey) && event.key == 'z')\n\t\t\t{\n\t\t\t\tif (this.previousMessage)\n\t\t\t\t{\n\t\t\t\t\ttextarea.value = this.previousMessage;\n\t\t\t\t\ttextarea.selectionStart = this.previousSelectionStart;\n\t\t\t\t\ttextarea.selectionEnd = this.previousSelectionEnd;\n\n\t\t\t\t\tthis.previousMessage = '';\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonKeyUp(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.keyUp, {event, text: this.currentMessage});\n\t\t\tthis.textChangeEvent();\n\t\t},\n\t\tonPaste(event)\n\t\t{\n\t\t\tthis.$nextTick(this.textChangeEvent);\n\t\t},\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.textChangeEvent();\n\t\t},\n\t\tonFocus(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.focus, event);\n\t\t},\n\t\tonBlur(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.blur, event);\n\t\t},\n\t\tonAppButtonClick(appId, event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.appButtonClick, {appId, event});\n\t\t},\n\t\tonInsertText({data: event = {}})\n\t\t{\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.insertText(event.text, event.breakline, event.position, event.cursor, event.focus);\n\n\t\t\tEventEmitter.emit(EventType.textarea.keyUp, {event, text: this.currentMessage});\n\n\t\t\treturn true;\n\t\t},\n\t\tonFocusSet()\n\t\t{\n\t\t\tthis.$refs.textarea.focus();\n\n\t\t\treturn true;\n\t\t},\n\t\tonFocusClear()\n\t\t{\n\t\t\tthis.$refs.textarea.blur();\n\n\t\t\treturn true;\n\t\t},\n\t\tonFileClick(event)\n\t\t{\n\t\t\tevent.target.value = \"\";\n\t\t},\n\t\tonFileSelect(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.fileSelected, {\n\t\t\t\tfileChangeEvent: event,\n\t\t\t\tfileInput: event.target\n\t\t\t});\n\t\t},\n\t\tlog(text, skip, event)\n\t\t{\n\t\t\tconsole.warn(text);\n\t\t\tif (skip == 1)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t\tpreventDefault(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :class=\"textareaClassName\">\n\t\t\t<div class=\"bx-im-textarea-box\">\n\t\t\t\t<textarea ref=\"textarea\" class=\"bx-im-textarea-input\" @keydown=\"onKeyDown\" @keyup=\"onKeyUp\" @paste=\"onPaste\" @input=\"onInput\" @focus=\"onFocus\" @blur=\"onBlur\" v-bx-im-focus=\"autoFocus\" :placeholder=\"localize.BX_MESSENGER_TEXTAREA_PLACEHOLDER\">{{placeholderMessage}}</textarea>\n\t\t\t\t<transition enter-active-class=\"bx-im-textarea-send-button-show\" leave-active-class=\"bx-im-textarea-send-button-hide\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tv-if=\"currentMessage\" \n\t\t\t\t\t\t:class=\"buttonStyle.button.className\" \n\t\t\t\t\t\t:style=\"buttonStyle.button.style\" \n\t\t\t\t\t\t:title=\"localize.BX_MESSENGER_TEXTAREA_BUTTON_SEND\"\n\t\t\t\t\t\t@click=\"sendMessage\" \n\t\t\t\t\t\t@touchend=\"sendMessage\" \n\t\t\t\t\t\t@mousedown=\"preventDefault\" \n\t\t\t\t\t\t@touchstart=\"preventDefault\" \n\t\t\t\t\t/>\n\t\t\t\t</transition>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-textarea-app-box\">\n\t\t\t\t<label v-if=\"enableFile && !isIE11\" class=\"bx-im-textarea-app-button bx-im-textarea-app-file\" :title=\"localize.BX_MESSENGER_TEXTAREA_FILE\">\n\t\t\t\t\t<input type=\"file\" @click=\"onFileClick($event)\" @change=\"onFileSelect($event)\" multiple>\n\t\t\t\t</label>\n\t\t\t\t<button class=\"bx-im-textarea-app-button bx-im-textarea-app-smile\" :title=\"localize.BX_MESSENGER_TEXTAREA_SMILE\" @click=\"onAppButtonClick('smile', $event)\"></button>\n\t\t\t\t<button v-if=\"false\" class=\"bx-im-textarea-app-button bx-im-textarea-app-gif\" :title=\"localize.BX_MESSENGER_TEXTAREA_GIPHY\" @click=\"onAppButtonClick('giphy', $event)\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n"],"names":["BitrixVue","component","props","siteId","default","userId","dialogId","enableCommand","enableMention","desktopMode","enableEdit","enableFile","sendByEnter","autoFocus","writesEventLetter","styles","type","Object","data","placeholderMessage","currentMessage","previousMessage","commandListen","mentionListen","stylesDefault","freeze","button","backgroundColor","iconColor","created","EventEmitter","subscribe","EventType","textarea","insertText","onInsertText","setFocus","onFocusSet","setBlur","onFocusClear","localStorage","LocalStorage","textareaHistory","get","beforeDestroy","unsubscribe","clearTimeout","messageStoreTimeout","set","computed","textareaClassName","isDarkBackground","isMobile","buttonStyle","assign","isIconDark","Utils","isDarkColor","className","style","application","options","darkBackground","device","DeviceType","mobile","localize","getFilteredPhrases","isIE11","Browser","Vuex","mapState","state","directives","inserted","element","params","value","focus","methods","text","breakline","position","cursor","$refs","selectionStart","selectionEnd","length","substring","trim","endsWith","textChangeEvent","sendMessage","event","preventDefault","emit","startWriting","previousSelectionStart","previousSelectionEnd","toString","setTimeout","onKeyDown","$emit","target","isMac","platform","isCtrlTEnable","isBitrixDesktop","browser","isChrome","altKey","ctrlKey","shiftKey","keyCode","document","activeElement","stopPropagation","metaKey","key","includes","tagStart","toLowerCase","tagEnd","selected","startsWith","indexOf","edit","onKeyUp","keyUp","onPaste","$nextTick","onInput","onFocus","onBlur","blur","onAppButtonClick","appId","appButtonClick","onFileClick","onFileSelect","fileSelected","fileChangeEvent","fileInput","log","skip","console","warn","template"],"mappings":"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"}