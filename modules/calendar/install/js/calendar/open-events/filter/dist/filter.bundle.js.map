{"version":3,"file":"filter.bundle.js","sources":["../src/filter.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\n\nconst MIN_QUERY_LENGTH = 3;\n\nexport class Filter extends EventEmitter\n{\n\t#filterId: string;\n\t#filter: BX.Main.Filter;\n\n\tconstructor(filterId: string)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Calendar.OpenEvents.Filter');\n\n\t\tthis.#filterId = filterId;\n\t\tthis.#filter = BX.Main.filterManager.getById(this.#filterId);\n\n\t\tthis.#bindEvents();\n\t}\n\n\tget id(): string\n\t{\n\t\treturn this.#filterId;\n\t}\n\n\tget fields(): any\n\t{\n\t\treturn this.#filter.getFilterFieldsValues();\n\t}\n\n\tisDateFieldApplied(): boolean\n\t{\n\t\treturn this.fields.DATE_datesel && this.fields.DATE_datesel !== 'NONE';\n\t}\n\n\tgetFilterFieldsKey(): string\n\t{\n\t\treturn JSON.stringify(this.fields);\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.beforeApplyHandler = this.#beforeApplyHandler.bind(this);\n\t\tthis.applyHandler = this.#applyHandler.bind(this);\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:beforeApply', this.beforeApplyHandler);\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', this.applyHandler);\n\t}\n\n\t#beforeApplyHandler(event)\n\t{\n\t\tconst [ filterId ] = event.getData();\n\t\tif (filterId !== this.#filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('beforeApply');\n\t}\n\n\t#applyHandler(event)\n\t{\n\t\tconst [ filterId ] = event.getData();\n\t\tif (filterId !== this.#filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isFilterEmpty())\n\t\t{\n\t\t\tthis.emit('clear');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit('apply');\n\t\t}\n\t}\n\n\t#isFilterEmpty(): boolean\n\t{\n\t\treturn this.#arePresetsEmpty() && this.#isSearchEmpty();\n\t}\n\n\t#arePresetsEmpty(): boolean\n\t{\n\t\treturn !this.#filter.getSearch().getLastSquare();\n\t}\n\n\t#isSearchEmpty(): boolean\n\t{\n\t\treturn this.#filter.getSearch().getSearchString().length < MIN_QUERY_LENGTH;\n\t}\n}\n"],"names":["MIN_QUERY_LENGTH","Filter","EventEmitter","constructor","filterId","setEventNamespace","BX","Main","filterManager","getById","id","fields","getFilterFieldsValues","isDateFieldApplied","DATE_datesel","getFilterFieldsKey","JSON","stringify","beforeApplyHandler","bind","applyHandler","subscribe","event","getData","emit","getSearch","getLastSquare","getSearchString","length"],"mappings":";;;;;;CAEA,MAAMA,gBAAgB,GAAG,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE3B,CAAO,MAAMC,MAAM,SAASC,6BAAY,CACxC;GAICC,WAAW,CAACC,UAAgB,EAC5B;KACC,KAAK,EAAE;KAAC;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAER,IAAI,CAACC,iBAAiB,CAAC,4BAA4B,CAAC;KAEpD,4CAAI,0BAAaD,UAAQ;KACzB,4CAAI,sBAAWE,EAAE,CAACC,IAAI,CAACC,aAAa,CAACC,OAAO,yCAAC,IAAI,wBAAW;KAE5D,4CAAI;;GAGL,IAAIC,EAAE,GACN;KACC,+CAAO,IAAI;;GAGZ,IAAIC,MAAM,GACV;KACC,OAAO,4CAAI,oBAASC,qBAAqB,EAAE;;GAG5CC,kBAAkB,GAClB;KACC,OAAO,IAAI,CAACF,MAAM,CAACG,YAAY,IAAI,IAAI,CAACH,MAAM,CAACG,YAAY,KAAK,MAAM;;GAGvEC,kBAAkB,GAClB;KACC,OAAOC,IAAI,CAACC,SAAS,CAAC,IAAI,CAACN,MAAM,CAAC;;CAuDpC;CAAC,wBAnDA;GACC,IAAI,CAACO,kBAAkB,GAAG,4CAAI,4CAAqBC,IAAI,CAAC,IAAI,CAAC;GAC7D,IAAI,CAACC,YAAY,GAAG,4CAAI,gCAAeD,IAAI,CAAC,IAAI,CAAC;GAEjDjB,6BAAY,CAACmB,SAAS,CAAC,4BAA4B,EAAE,IAAI,CAACH,kBAAkB,CAAC;GAC7EhB,6BAAY,CAACmB,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACD,YAAY,CAAC;CAClE;CAAC,8BAEmBE,KAAK,EACzB;GACC,MAAM,CAAElB,QAAQ,CAAE,GAAGkB,KAAK,CAACC,OAAO,EAAE;GACpC,IAAInB,QAAQ,6CAAK,IAAI,uBAAU,EAC/B;KACC;;GAGD,IAAI,CAACoB,IAAI,CAAC,aAAa,CAAC;CACzB;CAAC,wBAEaF,KAAK,EACnB;GACC,MAAM,CAAElB,QAAQ,CAAE,GAAGkB,KAAK,CAACC,OAAO,EAAE;GACpC,IAAInB,QAAQ,6CAAK,IAAI,uBAAU,EAC/B;KACC;;GAGD,4CAAI,IAAI,qCACR;KACC,IAAI,CAACoB,IAAI,CAAC,OAAO,CAAC;IAClB,MAED;KACC,IAAI,CAACA,IAAI,CAAC,OAAO,CAAC;;CAEpB;CAAC,2BAGD;GACC,OAAO,4CAAI,mFAAuB,IAAI,mCAAiB;CACxD;CAAC,6BAGD;GACC,OAAO,CAAC,4CAAI,oBAASC,SAAS,EAAE,CAACC,aAAa,EAAE;CACjD;CAAC,2BAGD;GACC,OAAO,4CAAI,oBAASD,SAAS,EAAE,CAACE,eAAe,EAAE,CAACC,MAAM,GAAG5B,gBAAgB;CAC5E;;;;;;;;"}