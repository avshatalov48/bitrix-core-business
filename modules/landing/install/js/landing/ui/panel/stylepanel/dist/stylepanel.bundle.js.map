{"version":3,"file":"stylepanel.bundle.js","sources":["../src/stylepanel.js"],"sourcesContent":["import {Cache, Dom, Runtime, Text} from 'main.core';\nimport {Loader} from 'main.loader';\nimport {Content} from 'landing.ui.panel.content';\nimport {Loc} from 'landing.loc';\nimport {PageObject} from 'landing.pageobject';\n\nimport 'ui.fonts.opensans';\nimport './css/style.css';\n\nconst showPseudoContent = Symbol('showPseudoContent');\nconst hidePseudoContent = Symbol('hidePseudoContent');\nconst disableEditorPointerEvents = Symbol('disableEditorPointerEvents');\nconst enableEditorPointerEvents = Symbol('enableEditorPointerEvents');\n\n/**\n * @memberOf BX.Landing.UI.Panel\n */\nexport class StylePanel extends Content\n{\n\tshouldAdjustTopPanelControls = false;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.UI.Panel.StylePanel');\n\n\t\tthis.setTitle(Loc.getMessage('LANDING_DESIGN_PANEL_HEADER'));\n\t\tthis.pseudoContent = Runtime.clone(this.content);\n\t\tthis.loader = new Loader({\n\t\t\ttarget: this.pseudoContent,\n\t\t\toffset: {top: '-10%'},\n\t\t});\n\t\tthis.lsCache = new Cache.LocalStorageCache();\n\t\tthis.cache = new Cache.MemoryCache();\n\t\tthis.switcher = this.getSwitcher();\n\t\tthis.closeByEsc = false;\n\n\t\tDom.addClass(this.layout, 'landing-ui-panel-style');\n\t\tDom.addClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\tDom.attr(this.layout, 'hidden', 'true');\n\n\t\tDom.clean(this.pseudoContent);\n\t\tDom.style(this.pseudoContent, 'margin-left', '20px');\n\t\tDom.append(this.pseudoContent, this.body);\n\n\t\tDom.append(this.switcher.layout, this.footer);\n\t\tDom.prepend(this.layout, this.getViewContainer());\n\n\t\tif (window.localStorage)\n\t\t{\n\t\t\tconst state = window.localStorage.getItem('selectGroup') === 'true';\n\t\t\tthis.lsCache.set('selectGroup', state.toString());\n\t\t}\n\t}\n\n\tstatic getInstance(): StylePanel\n\t{\n\t\tconst rootWindow = PageObject.getRootWindow();\n\n\t\tif (!rootWindow.BX.Landing.UI.Panel.StylePanel.instance && !StylePanel.instance)\n\t\t{\n\t\t\trootWindow.BX.Landing.UI.Panel.StylePanel.instance = new StylePanel();\n\t\t}\n\n\t\treturn (rootWindow.BX.Landing.UI.Panel.StylePanel.instance || StylePanel.instance);\n\t}\n\n\tgetSwitcher(): BX.Landing.UI.Field.Switch\n\t{\n\t\treturn this.cache.remember('switcher', () => {\n\t\t\treturn new BX.Landing.UI.Field.Switch({\n\t\t\t\ttitle: Loc.getMessage('LANDING_STYLE_PANEL_SELECT_GROUP_SWITCH'),\n\t\t\t\tonValueChange: () => {\n\t\t\t\t\tif (window.localStorage)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.localStorage.setItem('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t\t}\n\t\t\t\t\tthis.lsCache.set('selectGroup', this.switcher.getValue().toString());\n\t\t\t\t},\n\t\t\t\tvalue: Text.toBoolean(this.lsCache.get('selectGroup')),\n\t\t\t});\n\t\t});\n\t}\n\n\tgetViewContainer(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewContainer', () => {\n\t\t\treturn PageObject.getRootWindow().document.querySelector('.landing-ui-view-container');\n\t\t});\n\t}\n\n\tgetViewWrapper(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('viewWrapper', () => {\n\t\t\treturn this.getViewContainer().querySelector('.landing-ui-view-wrapper');\n\t\t});\n\t}\n\n\t[showPseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', true);\n\t\tDom.attr(this.pseudoContent, 'hidden', null);\n\t}\n\n\t[hidePseudoContent]()\n\t{\n\t\tDom.attr(this.content, 'hidden', null);\n\t\tDom.attr(this.pseudoContent, 'hidden', true);\n\t}\n\n\tstatic [enableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', null);\n\t}\n\n\tstatic [disableEditorPointerEvents]()\n\t{\n\t\tDom.style(document.body, 'pointer-events', 'none');\n\t}\n\n\tshow(formMode): Promise<StylePanel>\n\t{\n\t\tthis[showPseudoContent]();\n\t\tStylePanel[disableEditorPointerEvents]();\n\n\t\tif (formMode)\n\t\t{\n\t\t\tif (!Dom.hasClass(this.layout, 'landing-ui-style-form-mode'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.layout, 'landing-ui-style-form-mode');\n\n\t\t\t\t/*Dom.style(this.overlay, {\n\t\t\t\t\t'z-index': 9998,\n\t\t\t\t\twidth: '880px',\n\t\t\t\t});*/\n\t\t\t\tDom.insertAfter(this.overlay, this.layout);\n\t\t\t\tDom.removeClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//Dom.remove(this.overlay);\n\t\t\tDom.addClass(this.overlay, 'landing-ui-panel-style-overlay');\n\t\t\tDom.removeClass(this.layout, 'landing-ui-style-form-mode');\n\t\t}\n\n\t\tDom.remove(this.overlay);\n\n\t\treturn super.show()\n\t\t\t.then(() => {\n\t\t\t\tthis.loader.show();\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis[hidePseudoContent]();\n\t\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\t}, 300);\n\n\t\t\t\tif (!formMode)\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.getViewWrapper(), 'max-width', 'calc(100% - 320px)');\n\t\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\t\t\t\t}\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:enable', []);\n\t\t\t\tthis.emit('enable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n\n\thide(): Promise<StylePanel>\n\t{\n\t\tStylePanel[disableEditorPointerEvents]();\n\t\tDom.style(this.getViewWrapper(), 'max-width', null);\n\n\t\treturn super.hide()\n\t\t\t.then(() => {\n\t\t\t\tStylePanel[enableEditorPointerEvents]();\n\t\t\t\tDom.addClass(document.body, 'landing-ui-collapsed');\n\n\t\t\t\tBX.onCustomEvent('BX.Landing.Style:disable', []);\n\t\t\t\tthis.emit('disable', {panel: this});\n\n\t\t\t\treturn this;\n\t\t\t});\n\t}\n\n\tprepareFooter(isMultiSelector = true)\n\t{\n\t\tif (isMultiSelector)\n\t\t{\n\t\t\tthis.footer.hidden = false;\n\t\t\tDom.removeClass(this.body, 'landing-ui-panel-content-body_long');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.footer.hidden = true;\n\t\t\tDom.addClass(this.body, 'landing-ui-panel-content-body_long');\n\t\t}\n\t}\n}\n"],"names":["showPseudoContent","Symbol","hidePseudoContent","disableEditorPointerEvents","enableEditorPointerEvents","StylePanel","options","setEventNamespace","setTitle","Loc","getMessage","pseudoContent","Runtime","clone","content","loader","Loader","target","offset","top","lsCache","Cache","LocalStorageCache","cache","MemoryCache","switcher","getSwitcher","closeByEsc","Dom","addClass","layout","overlay","attr","clean","style","append","body","footer","prepend","getViewContainer","window","localStorage","state","getItem","set","toString","remember","BX","Landing","UI","Field","Switch","title","onValueChange","setItem","getValue","value","Text","toBoolean","get","PageObject","getRootWindow","document","querySelector","formMode","hasClass","insertAfter","removeClass","remove","then","show","setTimeout","getViewWrapper","onCustomEvent","emit","panel","isMultiSelector","hidden","rootWindow","Panel","instance","Content"],"mappings":"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"}