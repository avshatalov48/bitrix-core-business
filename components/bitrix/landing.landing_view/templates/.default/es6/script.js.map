{"version":3,"file":"script.js","sources":["src/controls/controls.action.js","src/controls/controls.loc.js","src/controls/controls.ui.js","src/controls/controls.js","src/device/device.data.js","src/device/device.ui.js","src/device/device.js"],"sourcesContent":["import { Type } from 'main.core';\n\ntype ActionOptions = {\n\tiframe: HTMLIFrameElement,\n};\n\nexport class Action\n{\n\t#iframe: HTMLIFrameElement;\n\n\tconstructor(options: ActionOptions)\n\t{\n\t\tthis.#iframe = options.iframe;\n\n\t\tif (!Type.isDomNode(this.#iframe))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'frame' option as iFrame Element.\");\n\t\t}\n\t}\n\n\t/**\n\t * Sends action with payload to child window.\n\t *\n\t * @param {string} action Command to internal iframe.\n\t * @param {Object} payload Command's payload.\n\t */\n\t#postInternalCommand(action, payload)\n\t{\n\t\tthis.#iframe.contentWindow.postMessage({action, payload}, window.location.origin);\n\t}\n\n\t/**\n\t * Handles on Designer click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonDesignerBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onDesignerBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Style Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonStyleBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onStyleBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Edit Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonEditBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onEditBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Down Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSortDownBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSortDownBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Up Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSortUpBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSortUpBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Remove Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonRemoveBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onRemoveBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Change State Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonChangeStateBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onChangeStateBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Cut Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonCutBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onCutBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Copy Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonCopyBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onCopyBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Paste Block click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonPasteBlockClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onPasteBlockClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Feedback click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonFeedbackClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onFeedbackClick', {blockId});\n\t}\n\n\t/**\n\t * Handles on Save In Library click.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tonSaveInLibraryClick(blockId: number)\n\t{\n\t\tthis.#postInternalCommand('onSaveInLibraryClick', {blockId});\n\t}\n\n\t/**\n\t * Hide opened editor panel.\n\t */\n\tonHideEditorPanel()\n\t{\n\t\tthis.#postInternalCommand('onHideEditorPanel');\n\t}\n}\n","\n\nexport class Loc\n{\n\tstatic messages: {[type: string]: string};\n\n\tstatic loadMessages(messages: {[type: string]: string})\n\t{\n\t\tLoc.messages = messages;\n\t}\n\n\tstatic getMessage(code: string): string\n\t{\n\t\treturn Loc.messages[code];\n\t}\n}\n","import { Event, Tag } from 'main.core';\nimport { Menu, MenuItem, MenuManager } from 'main.popup';\n\nimport { Loc } from './controls.loc';\n\ntype LeftContainerOptions = {\n\tdesignerBlockClick: ?() => {},\n\tstyleBlockClick: ?() => {},\n\teditBlockClick: ?() => {},\n};\n\ntype RightContainerOptions = {\n\tblockId: number,\n\tstate: boolean,\n\tsortDownBlockClick: ?() => {},\n\tsortUpBlockClick: ?() => {},\n\tremoveBlockClick: ?() => {},\n\tonOpenAdditionalMenu: ?() => {},\n\tchangeStateClick: ?() => {},\n\tcutClick: ?() => {},\n\tcopyClick: ?() => {},\n\tpasteClick: ?() => {},\n\tfeedbackClick: ?() => {},\n\tsaveInLibrary: ?() => {},\n};\n\ntype AdditionalActions = {\n\tstate: boolean,\n\tonOpenAdditionalMenu: ?() => {},\n\tchangeStateClick: ?() => {},\n\tcutClick: ?() => {},\n\tcopyClick: ?() => {},\n\tpasteClick: ?() => {},\n\tfeedbackClick: ?() => {},\n\tsaveInLibrary: ?() => {},\n};\n\nexport class UI\n{\n\tstatic pendingMenuItems = {};\n\n\t/**\n\t * Till Menu for this block not show, sets predefined prop value for menu item.\n\t *\n\t * @param {number} blockId\n\t * @param {string} itemCode\n\t * @param {string} itemProp\n\t * @param {mixed} value\n\t */\n\tstatic setPendingMenuItemValue(blockId: number, itemCode: string, itemProp: string, value)\n\t{\n\t\tif (!UI.pendingMenuItems[blockId])\n\t\t{\n\t\t\tUI.pendingMenuItems[blockId] = {};\n\t\t}\n\t\tif (!UI.pendingMenuItems[blockId][itemCode])\n\t\t{\n\t\t\tUI.pendingMenuItems[blockId][itemCode] = {};\n\t\t}\n\n\t\tUI.pendingMenuItems[blockId][itemCode][itemProp] = value;\n\t}\n\n\t/**\n\t * Returns predefined prop value for menu item (if exists).\n\t *\n\t * @param {number} blockId\n\t * @param {string} itemCode\n\t * @param {string} itemProp\n\t */\n\tstatic getPendingMenuItemValue(blockId: number, itemCode: string, itemProp: string)\n\t{\n\t\tif (UI.pendingMenuItems[blockId] && UI.pendingMenuItems[blockId][itemCode])\n\t\t{\n\t\t\treturn UI.pendingMenuItems[blockId][itemCode][itemProp] || null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns Designer Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getDesignerBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_DESIGNER_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${title}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Style Block Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getStyleBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_STYLE_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_STYLE_BLOCK_TITLE');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Edit Block Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getEditBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\t//data-id=\"content\"\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_EDIT_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_EDIT_BLOCK_TITLE');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action --separate${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" title=\"${title}\" data-id=\"content\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns left container for block's actions.\n\t *\n\t * @param {LeftContainerOptions} options Options for left container.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getLeftContainer(options: LeftContainerOptions): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-external-left-container\">\n\t\t\t\t<div class=\"landing-ui-external-left-top-hr\"></div>\n\t\t\t\t<div class=\"landing-ui-external-body\">\n\t\t\t\t\t<div class=\"landing-ui-external-panel\">\n\t\t\t\t\t\t${UI.getDesignerBlockButton(options.designerBlockClick)}\n\t\t\t\t\t\t${UI.getStyleBlockButton(options.styleBlockClick)}\n\t\t\t\t\t\t${UI.getEditBlockButton(options.editBlockClick)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"landing-ui-external-left-bottom-hr\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t/**\n\t * Returns Sort Down Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getSortDownBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_DOWN_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"down\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Sort Up Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getSortUpBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_UP_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"up\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns Additional Items Menu for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t * @return {Menu}\n\t */\n\tstatic getBlockAdditionalMenu(blockId: number): Menu\n\t{\n\t\treturn MenuManager.getMenuById('block_actions_' + blockId);\n\t}\n\n\t/**\n\t * Closes Additional Items Menu for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t */\n\tstatic closeBlockAdditionalMenu(blockId: number)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\t/**\n\t * Change state for Additional Menu Item 'Activate'.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {boolean} state State.\n\t */\n\tstatic changeStateMenuItem(blockId: number, state: boolean)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tconst title = Loc.getMessage(\n\t\t\t!state\n\t\t\t\t? 'LANDING_TPL_EXT_BUTTON_ACTIONS_SHOW'\n\t\t\t\t: 'LANDING_TPL_EXT_BUTTON_ACTIONS_HIDE'\n\t\t);\n\n\t\tif (menu)\n\t\t{\n\t\t\tBX.Landing.Utils.setTextContent(menu.getMenuItem('show_hide').getLayout()['text'], title);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUI.setPendingMenuItemValue(blockId, 'show_hide', 'state', state);\n\t\t}\n\t}\n\n\t/**\n\t * Enables/disables paste-item.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {boolean} enablePaste Flag.\n\t */\n\tstatic changePasteMenuItem(blockId: number, enablePaste: boolean)\n\t{\n\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\tif (menu)\n\t\t{\n\t\t\tconst item = menu.getMenuItem('paste');\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tif (enablePaste)\n\t\t\t\t{\n\t\t\t\t\titem.enable();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.disable();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tUI.setPendingMenuItemValue(blockId, 'paste', 'disabled', !enablePaste);\n\t\t}\n\t}\n\n\t/**\n\t * Returns List of Actions for Block.\n\t *\n\t * @param {number} blockId Block id.\n\t * @param {AdditionalActions} actions Additional actions for Block.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getActionsList(blockId: number, actions: AdditionalActions): HTMLButtonElement\n\t{\n\t\tconst label = Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_BLOCK');\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_BLOCK_TITLE');\n\n\t\tconst actionButton = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action\" type=\"button\" data-id=\"actions\" title=\"${title}\">\n\t\t\t\t<span class=\"landing-ui-button-text\">${label}</span>\n\t\t\t</button>\n\t\t`;\n\n\t\t// when click is occurred open exists menu or create new one\n\t\tEvent.bind(actionButton, 'click', (event) => {\n\n\t\t\tif (actions.onOpenAdditionalMenu)\n\t\t\t{\n\t\t\t\tactions.onOpenAdditionalMenu(blockId);\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\n\t\t\tconst menu = UI.getBlockAdditionalMenu(blockId);\n\t\t\tif (menu)\n\t\t\t{\n\t\t\t\tmenu.show();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMenuManager.create({\n\t\t\t\tid: 'block_actions_' + blockId,\n\t\t\t\tbindElement: actionButton,\n\t\t\t\tclassName: 'landing-ui-block-actions-popup',\n\t\t\t\tangle: { position: 'top', offset: 95 },\n\t\t\t\toffsetTop: -6,\n\t\t\t\toffsetLeft: -26,\n\t\t\t\titems: [\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'show_hide',\n\t\t\t\t\t\tdisabled: !actions.changeStateClick,\n\t\t\t\t\t\ttext: Loc.getMessage(\n\t\t\t\t\t\t\t(actions.state || UI.getPendingMenuItemValue(blockId, 'show_hide', 'state'))\n\t\t\t\t\t\t\t\t? 'LANDING_TPL_EXT_BUTTON_ACTIONS_HIDE'\n\t\t\t\t\t\t\t\t: 'LANDING_TPL_EXT_BUTTON_ACTIONS_SHOW'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.changeStateClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'cut',\n\t\t\t\t\t\tdisabled: !actions.cutClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_CUT'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.cutClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'copy',\n\t\t\t\t\t\tdisabled: !actions.copyClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_COPY'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.copyClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'paste',\n\t\t\t\t\t\tdisabled: !actions.pasteClick || UI.getPendingMenuItemValue(blockId, 'paste', 'disabled'),\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_PASTE'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.pasteClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'feedback',\n\t\t\t\t\t\tdisabled: !actions.feedbackClick,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_FEEDBACK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.feedbackClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tactions.saveInLibrary\n\t\t\t\t\t\t? new MenuItem({ delimiter: true })\n\t\t\t\t\t\t: null,\n\t\t\t\t\tnew MenuItem({\n\t\t\t\t\t\tid: 'save_in_library',\n\t\t\t\t\t\tdisabled: !actions.saveInLibrary,\n\t\t\t\t\t\ttext: Loc.getMessage('LANDING_TPL_EXT_BUTTON_ACTIONS_SAVE_IN_LIBRARY'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tactions.saveInLibrary();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t}).show();\n\t\t});\n\n\t\treturn actionButton;\n\t}\n\n\t/**\n\t * Returns Remove Button.\n\t *\n\t * @param {() => {}} onClick Click handler.\n\t * @return {HTMLButtonElement}\n\t */\n\tstatic getRemoveBlockButton(onClick: ?() => {}): HTMLButtonElement\n\t{\n\t\tconst title = Loc.getMessage('LANDING_TPL_EXT_BUTTON_REMOVE_BLOCK');\n\t\tconst button = Tag.render`\n\t\t\t<button class=\"landing-ui-button landing-ui-button-action${onClick ? '' : ' landing-ui-disabled'}\" type=\"button\" data-id=\"remove\" title=\"${title}\"><span class=\"landing-ui-button-text\">&nbsp;</span></button>\n\t\t`;\n\n\t\tif (onClick)\n\t\t{\n\t\t\tEvent.bind(button, 'click', onClick);\n\t\t}\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Returns right container for block's actions.\n\t *\n\t * @param {RightContainerOptions} options Options for right container.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getRightContainer(options: RightContainerOptions): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"landing-ui-external-right-container\">\n\t\t\t\t<div class=\"landing-ui-external-right-top-hr\"></div>\n\t\t\t\t<div class=\"landing-ui-external-body\">\n\t\t\t\t\t<div class=\"landing-ui-external-panel\">\n\t\t\t\t\t\t${UI.getSortDownBlockButton(options.sortDownBlockClick)}\n\t\t\t\t\t\t${UI.getSortUpBlockButton(options.sortUpBlockClick)}\n\t\t\t\t\t\t${UI.getActionsList(options.blockId, options)}\n\t\t\t\t\t\t${UI.getRemoveBlockButton(options.removeBlockClick)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"landing-ui-external-right-bottom-hr\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Dom, Type } from 'main.core';\n\nimport { Action } from './controls.action';\nimport { Loc } from './controls.loc';\nimport { UI } from './controls.ui';\n\ntype Block = {\n\tid: number,\n\tstate: boolean,\n\tpermissions: {\n\t\tallowDesignBlock: boolean,\n\t\tallowModifyStyles: boolean,\n\t\tallowEditContent: boolean,\n\t\tallowSorting: boolean,\n\t\tallowRemove: boolean,\n\t\tallowChangeState: boolean,\n\t\tallowPaste: boolean,\n\t\tallowSaveInLibrary: boolean,\n\t},\n\tleftContainer?: HTMLElement,\n\trightContainer?: HTMLElement,\n};\n\ntype ExternalControlsOptions = {\n\tcontainer: HTMLElement,\n\tiframeWrapper: HTMLElement,\n\tmessages: {[type: string]: string},\n};\n\nexport class ExternalControls\n{\n\n\t#action: Action;\n\t#externalBlocks: Map;\n\t#container: HTMLElement;\n\t#iframeWrapper: HTMLElement;\n\t#currentOpenBlockId: ?number;\n\t#currentOpenMenuBlock: ?number;\n\n\tconstructor(options: ExternalControlsOptions)\n\t{\n\t\toptions = options || {};\n\n\t\tthis.#container = options.container;\n\t\tthis.#iframeWrapper = options.iframeWrapper;\n\n\t\tif (!Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'container' option as Dom Node.\");\n\t\t}\n\t\tif (!Type.isDomNode(this.#iframeWrapper))\n\t\t{\n\t\t\tthrow new Error(\"Missed 'iframe' option as Dom Node.\");\n\t\t}\n\n\t\tthis.#externalBlocks = new Map();\n\t\tthis.#action = new Action({\n\t\t\tiframe: this.#iframeWrapper.querySelector('iframe'),\n\t\t});\n\n\t\tLoc.loadMessages(options.messages);\n\n\t\twindow.addEventListener('message', this.#listenChildFrame.bind(this));\n\n\t\tthis.#container.addEventListener('click', (event) => {\n\t\t\tthis.#action.onHideEditorPanel();\n\t\t});\n\n\t\twindow.addEventListener('storage', this.#onStorageChange.bind(this));\n\t}\n\n\t/**\n\t * Handler on listening child iframe commands.\n\t *\n\t * @param event\n\t */\n\t#listenChildFrame(event)\n\t{\n\t\tconst data = event.data || {};\n\n\t\tif (!data.payload)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.action === 'register')\n\t\t{\n\t\t\tthis.#registerBlocks(data.payload.blocks);\n\t\t}\n\t\telse if (data.action === 'showcontrols')\n\t\t{\n\t\t\tthis.#showControls(data.payload.blockId, data.payload.top, data.payload.height);\n\t\t}\n\t\telse if (data.action === 'changestate')\n\t\t{\n\t\t\tthis.#changeState(data.payload.blockId, data.payload.state);\n\t\t}\n\t\telse if (data.action === 'mode')\n\t\t{\n\t\t\tthis.#onChangeMode(data.payload);\n\t\t}\n\t\telse if (data.action === 'hideall')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t}\n\t\telse if (data.action === 'showblockcontrols')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t\tthis.#hideAndShowControls(data.payload.blockId);\n\t\t}\n\t}\n\n\t/**\n\t * Handler on listening Storage changing.\n\t */\n\t#onStorageChange()\n\t{\n\t\tconst blocks = this.#externalBlocks.values();\n\t\tconst allowPaste = !!window.localStorage.getItem('landingBlockId');\n\n\t\tfor (let i = 0, c = this.#externalBlocks.size; i < c; i++)\n\t\t{\n\t\t\tconst blockItem = blocks.next().value;\n\n\t\t\tUI.changePasteMenuItem(blockItem.id, allowPaste);\n\t\t\tthis.#updateBlock(\n\t\t\t\tblockItem.id,\n\t\t\t\t{...blockItem, permissions: {...blockItem.permissions, allowPaste}}\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Registers Block's controls for current page.\n\t *\n\t * @param {Array<Block>} blocks Array of Blocks.\n\t */\n\t#registerBlocks(blocks: Array<Block>)\n\t{\n\t\tblocks.map(block => {\n\n\t\t\tconst blockId = block.id;\n\n\t\t\t// left controls\n\t\t\tblock.leftContainer = UI.getLeftContainer({\n\t\t\t\tdesignerBlockClick: block.permissions.allowDesignBlock ? () => {\n\t\t\t\t\tthis.#action.onDesignerBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t\tstyleBlockClick: block.permissions.allowModifyStyles ? () => {\n\t\t\t\t\tthis.#action.onStyleBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t\teditBlockClick: block.permissions.allowEditContent ? () => {\n\t\t\t\t\tthis.#action.onEditBlockClick(blockId);\n\t\t\t\t} : null,\n\t\t\t});\n\n\t\t\t// right controls\n\t\t\tblock.rightContainer = UI.getRightContainer({\n\t\t\t\tblockId,\n\t\t\t\tstate: block.state,\n\t\t\t\tsortDownBlockClick: block.permissions.allowSorting ? () => {\n\t\t\t\t\tthis.#action.onSortDownBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t} : null,\n\t\t\t\tsortUpBlockClick: block.permissions.allowSorting ? () => {\n\t\t\t\t\tthis.#action.onSortUpBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t} : null,\n\t\t\t\tremoveBlockClick: block.permissions.allowRemove ? () => {\n\t\t\t\t\tthis.#action.onRemoveBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t}: null,\n\t\t\t\tonOpenAdditionalMenu: (blockId) => {\n\t\t\t\t\tthis.#currentOpenMenuBlock = blockId;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.#action.onHideEditorPanel();\n\t\t\t\t\t}, 0);\n\t\t\t\t},\n\t\t\t\tchangeStateClick: block.permissions.allowChangeState ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onChangeStateBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t}: null,\n\t\t\t\tcutClick: block.permissions.allowRemove ? () => {\n\t\t\t\t\tthis.#action.onCutBlockClick(blockId);\n\t\t\t\t\tthis.#hideAllControls();\n\t\t\t\t}: null,\n\t\t\t\tcopyClick: () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onCopyBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t},\n\t\t\t\tpasteClick: block.permissions.allowPaste ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onPasteBlockClick(blockId);\n\t\t\t\t\tthis.#hideAndShowControls(blockId);\n\t\t\t\t}: null,\n\t\t\t\tfeedbackClick: () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onFeedbackClick(blockId);\n\t\t\t\t},\n\t\t\t\tsaveInLibrary: block.permissions.allowSaveInLibrary ? () => {\n\t\t\t\t\tUI.closeBlockAdditionalMenu(blockId);\n\t\t\t\t\tthis.#action.onSaveInLibraryClick(blockId);\n\t\t\t\t}: null,\n\t\t\t});\n\n\t\t\tDom.append(block.leftContainer, this.#container);\n\t\t\tDom.append(block.rightContainer, this.#container);\n\n\t\t\tDom.hide(block.leftContainer);\n\t\t\tDom.hide(block.rightContainer);\n\n\t\t\tthis.#externalBlocks.set(blockId, block);\n\t\t});\n\t}\n\n\t/**\n\t * Creates new block or takes it from Map.\n\t *\n\t * @param {number} blockId Block id.\n\t * @return {Block}\n\t */\n\t#getBlock(blockId: number): ?Block\n\t{\n\t\treturn this.#externalBlocks.get(parseInt(blockId));\n\t}\n\n\t/**\n\t * Updates Block.\n\t *\n\t * @param blockId Block id.\n\t * @param {Block} data New Block data.\n\t */\n\t#updateBlock(blockId: number, data: Block)\n\t{\n\t\tthis.#externalBlocks.set(parseInt(blockId), data);\n\t}\n\n\t/**\n\t * Changes state for the Block.\n\t *\n\t * @param {number} blockId Block id\n\t * @param state\n\t */\n\t#changeState(blockId: number, state: boolean)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\t\tif (block)\n\t\t{\n\t\t\tUI.changeStateMenuItem(blockId, state);\n\t\t\tthis.#updateBlock(blockId, {...block, state});\n\t\t}\n\t}\n\n\t/**\n\t * Hides all controls.\n\t */\n\t#hideAllControls()\n\t{\n\t\tif (this.#currentOpenBlockId)\n\t\t{\n\t\t\tconst blockItem = this.#externalBlocks.get(this.#currentOpenBlockId);\n\t\t\tDom.hide(blockItem.leftContainer);\n\t\t\tDom.hide(blockItem.rightContainer);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst blocks = this.#externalBlocks.values();\n\t\t\tfor (let i = 0, c = this.#externalBlocks.size; i < c; i++)\n\t\t\t{\n\t\t\t\tconst blockItem = blocks.next().value;\n\t\t\t\tDom.hide(blockItem.leftContainer);\n\t\t\t\tDom.hide(blockItem.rightContainer);\n\t\t\t}\n\t\t}\n\n\t\t// if some menu is opened, close it\n\t\tif (this.#currentOpenMenuBlock)\n\t\t{\n\t\t\tUI.closeBlockAdditionalMenu(this.#currentOpenMenuBlock);\n\t\t\tthis.#currentOpenMenuBlock = null;\n\t\t}\n\t}\n\n\t/**\n\t * Shows controls for block.\n\t *\n\t * @param {number} blockId Block's id.\n\t * @param {number} top Block's top position.\n\t * @param {number} height Block's height.\n\t */\n\t#showControls(blockId: number, top: number, height: number)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\n\t\tif (!block)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst iframeRect = this.#iframeWrapper.getBoundingClientRect();\n\t\tthis.#hideAllControls();\n\t\tthis.#currentOpenBlockId = block.id;\n\t\tthis.#action.onHideEditorPanel();\n\t\ttop = parseInt(top);\n\n\t\t// adjust top and bottom borders\n\t\tif (top < 0 && height + top > 50)\n\t\t{\n\t\t\theight = height + top;\n\t\t\ttop = 0;\n\t\t\tDom.addClass(block.leftContainer, 'hide-top');\n\t\t\tDom.addClass(block.rightContainer, 'hide-top');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(block.leftContainer, 'hide-top');\n\t\t\tDom.removeClass(block.rightContainer, 'hide-top');\n\t\t}\n\n\t\tDom.show(block.leftContainer);\n\t\tDom.show(block.rightContainer);\n\n\t\t// adjust top and heights\n\t\tblock.leftContainer.style.width = iframeRect.left + 'px';\n\t\tblock.leftContainer.style.top = top + 'px';\n\t\tblock.leftContainer.style.height = height + 'px';\n\n\t\tblock.rightContainer.style.width = iframeRect.left + 'px';\n\t\tblock.rightContainer.style.left = iframeRect.left + iframeRect.width + 'px';\n\t\tblock.rightContainer.style.top = top + 'px';\n\t\tblock.rightContainer.style.height = height + 'px';\n\t}\n\n\t/**\n\t * Hides and shows controls (blink) for specific Block.\n\t *\n\t * @param {blockId} blockId Block id.\n\t */\n\t#hideAndShowControls(blockId: number)\n\t{\n\t\tconst block = this.#getBlock(blockId);\n\t\tif (block)\n\t\t{\n\t\t\tthis.#currentOpenBlockId = null;\n\t\t\tDom.hide(block.leftContainer);\n\t\t\tDom.hide(block.rightContainer);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#currentOpenBlockId = block.id;\n\t\t\t\tDom.show(block.leftContainer);\n\t\t\t\tDom.show(block.rightContainer);\n\t\t\t}, 500);\n\t\t}\n\t}\n\n\t/**\n\t * When user toggles mode (internal vs external controls).\n\t *\n\t * @param {{[type: string]: string}} data New mode data.\n\t */\n\t#onChangeMode(data: {[type: string]: string})\n\t{\n\t\tif (data.type === 'internal')\n\t\t{\n\t\t\tthis.#hideAllControls();\n\t\t}\n\t}\n}\n","export type DeviceItem = {\n\tname: string,\n\tcode: string,\n\tclassName: string,\n\tlangCode?: string,\n};\n\nexport const Devices = {\n\tdefaultDevice: {\n\t\ttablet: 'iphone14pro',\n\t\tmobile: 'iphone14pro',\n\t},\n\tdevices: {\n\t\tdelimiter1: {\n\t\t\tcode: 'delimiter',\n\t\t\tlangCode: 'LANDING_PREVIEW_DEVICE_MOBILES',\n\t\t},\n\t\tiphone14pro: {\n\t\t\tname: 'iPhone 14 Pro',\n\t\t\tcode: 'iphone14pro',\n\t\t\tclassName: '--iphone-14-pro',\n\t\t\twidth: 393,\n\t\t\theight: 852\n\t\t},\n\t\tiPhoneXR: {\n\t\t\tname: 'iPhone XR',\n\t\t\tcode: 'iPhoneXR',\n\t\t\tclassName: '--iphone-xr',\n\t\t\twidth: 414,\n\t\t\theight: 896\n\t\t},\n\t\tiPhoneSE: {\n\t\t\tname: 'iPhone SE',\n\t\t\tcode: 'iPhoneSE',\n\t\t\tclassName: '--iphone-se',\n\t\t\twidth: 375,\n\t\t\theight: 667\n\t\t},\n\t\tSamsungGalaxyNote10: {\n\t\t\tname: 'Samsung Galaxy Note10',\n\t\t\tcode: 'SamsungGalaxyNote10',\n\t\t\tclassName: '--samsung-galaxy-note10',\n\t\t\twidth: 412,\n\t\t\theight: 896\n\t\t},\n\t\tSamsungGalaxyS8: {\n\t\t\tname: 'Samsung Galaxy S8+',\n\t\t\tcode: 'SamsungGalaxyS8',\n\t\t\tclassName: '--samsung-galaxy-s8-plus',\n\t\t\twidth: 360,\n\t\t\theight: 740\n\t\t},\n\t\tGooglePixel4: {\n\t\t\tname: 'Google Pixel 4',\n\t\t\tcode: 'GooglePixel4',\n\t\t\tclassName: '--google-pixel-4',\n\t\t\twidth: 353,\n\t\t\theight: 745\n\t\t},\n\t\tdelimiter2: {\n\t\t\tcode: 'delimiter',\n\t\t\tlangCode: 'LANDING_PREVIEW_DEVICE_TABLETS',\n\t\t},\n\t\tiPad: {\n\t\t\tname: 'iPad',\n\t\t\tcode: 'iPad',\n\t\t\tclassName: '--ipad',\n\t\t\twidth: 810,\n\t\t\theight: 1080\n\t\t},\n\t\tiPadMini: {\n\t\t\tname: 'iPad Mini',\n\t\t\tcode: 'iPadMini',\n\t\t\tclassName: '--ipad-mini',\n\t\t\twidth: 744,\n\t\t\theight: 1133\n\t\t},\n\t\tSamsungGalaxyTabS8: {\n\t\t\tname: 'Samsung Galaxy Tab S8',\n\t\t\tcode: 'SamsungGalaxyTabS8',\n\t\t\tclassName: '--samsung-galaxy-tab-s8',\n\t\t\twidth: 800,\n\t\t\theight: 1280\n\t\t},\n\t}\n}\n","import { Dom, Tag } from 'main.core';\nimport { MenuItem, MenuManager } from 'main.popup';\n\nimport { DeviceItem } from './device.data';\n\ntype Options = {\n\tframeUrl: string,\n\tclickHandler: () => {},\n\tmessages: {[type: string]: string},\n};\n\nclass DeviceUI\n{\n\tstatic messages: {[type: string]: string};\n\n\t/**\n\t * Returns Landing Preview Block above the screen.\n\t *\n\t * @param {Options} options Preview options.\n\t * @return {HTMLDivElement}\n\t */\n\tstatic getPreview(options: Options): HTMLDivElement\n\t{\n\t\tif (options.messages)\n\t\t{\n\t\t\tDeviceUI.messages = options.messages;\n\t\t}\n\n\t\tif (!localStorage.getItem('deviceOrientation'))\n\t\t{\n\t\t\tlocalStorage.setItem('deviceOrientation', 'portrait');\n\t\t}\n\n\t\tconst switcherClick = (event) => {\n\t\t\tlocalStorage.setItem('deviceHidden', !Dom.hasClass(layout.switcher, 'landing-switcher-hide'));\n\t\t\tDom.toggleClass(layout.switcher, 'landing-switcher-hide');\n\t\t\tDom.toggleClass(layout.wrapper, 'landing-device-wrapper-hidden');\n\t\t};\n\n\t\tconst rotateClick = (event) => {\n\t\t\tif (localStorage.getItem('deviceOrientation') === 'portrait')\n\t\t\t{\n\t\t\t\tlocalStorage.setItem('deviceOrientation', 'landscape');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlocalStorage.setItem('deviceOrientation', 'portrait');\n\t\t\t}\n\n\t\t\tlayout.wrapper.style.setProperty(`width`, `${layout.wrapper.offsetHeight}px`);\n\t\t\tlayout.wrapper.style.setProperty(`height`, `${layout.wrapper.offsetWidth}px`);\n\t\t\tlayout.frame.style.setProperty(`width`, `${layout.frame.offsetHeight}px`);\n\t\t\tlayout.frame.style.setProperty(`height`, `${layout.frame.offsetWidth}px`);\n\t\t\tlayout.wrapper.querySelector('[data-role=\"device-orientation\"]').innerHTML = localStorage.getItem('deviceOrientation');\n\t\t};\n\n\t\tconst hidden = localStorage.getItem('deviceHidden') === 'true';\n\n\t\tconst layout = {\n\t\t\twrapper: Tag.render`\n\t\t\t\t<div class=\"landing-device-wrapper${hidden ? ' landing-device-wrapper-hidden' : ''}\">\n\t\t\t\t\t<div class=\"landing-device-name\" onclick=\"${options.clickHandler}\">\n\t\t\t\t\t\t<span data-role=\"device-name\">Device</span>\n\t\t\t\t\t\t<span data-role=\"device-orientation\" class=\"landing-device-orientation\">Orientation</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tswitcher: Tag.render`<div class=\"landing-device-switcher${hidden ? ' landing-switcher-hide' : ''}\" onclick=\"${switcherClick}\" data-role=\"landing-device-switcher\"></div>`,\n\t\t\trotate: Tag.render`<div class=\"landing-device-rotate\" onclick=\"${rotateClick}\" data-role=\"landing-device-rotate\"></div>`,\n\t\t\tframe: Tag.render`<iframe data-role=\"landing-device-preview-iframe\" src=\"${options.frameUrl}\"></iframe>`,\n\t\t\tframeWrapper: Tag.render`<div class=\"landing-device-preview\" data-role=\"landing-device-preview\"></div>`\n\t\t};\n\n\t\tlayout.wrapper.appendChild(layout.switcher);\n\t\tlayout.wrapper.appendChild(layout.rotate);\n\t\tlayout.wrapper.appendChild(layout.frameWrapper);\n\t\tlayout.frameWrapper.appendChild(layout.frame);\n\n\t\treturn layout.wrapper;\n\t}\n\n\t/**\n\t * Creates and open menu with list of devices.\n\t *\n\t * @param {HTMLElement} bindElement HTML element to bind position of menu.\n\t * @param {Array<DeviceItem>} devices List of devices.\n\t * @param {(device: DeviceItem) => {}} clickHandler Invokes when user clicked on the menu item.\n\t */\n\tstatic openDeviceMenu(bindElement: HTMLElement, devices: Array<DeviceItem>, clickHandler: (device: DeviceItem) => {})\n\t{\n\n\t\tconst menuId = 'device_selector';\n\t\tlet menu = MenuManager.getMenuById(menuId);\n\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.show();\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tdevices.map((device) => {\n\t\t\tif (device.code === 'delimiter')\n\t\t\t{\n\t\t\t\tmenuItems.push(new MenuItem({\n\t\t\t\t\tdelimiter: true,\n\t\t\t\t\ttext: device.langCode ? DeviceUI.messages[device.langCode] : '',\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmenuItems.push(new MenuItem({\n\t\t\t\tid: device.className,\n\t\t\t\thtml: `${device.name}`,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tMenuManager.getMenuById(menuId).close();\n\t\t\t\t\tclickHandler(device);\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\n\t\tif (bindElement)\n\t\t{\n\t\t\tbindElement = bindElement.parentNode;\n\t\t}\n\n\t\tmenu = MenuManager.create({\n\t\t\tid: menuId,\n\t\t\tbindElement,\n\t\t\tclassName: 'landing-ui-block-actions-popup',\n\t\t\titems: menuItems,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 40,\n\t\t\tminWidth: bindElement.offsetWidth,\n\t\t\tanimation: 'fading-slide'\n\t\t});\n\n\t\tmenu.show();\n\t}\n}\n\nexport default DeviceUI;\n","import { Dom, Tag, Event } from 'main.core';\nimport { Loc } from '../controls/controls.loc';\n\nimport { Devices, DeviceItem } from './device.data';\nimport DeviceUI from './device.ui';\n\ntype Options = {\n\teditorFrameWrapper: HTMLElement,\n\tframeUrl: string,\n\tmessages: {[type: string]: string},\n};\n\nexport class Device\n{\n\t#options;\n\t#frameUrl: string;\n\t#editorFrameWrapper: HTMLElement;\n\t#previewElement: HTMLDivElement;\n\t#previewWindow;// window object of iframe\n\t#previewLoader: HTMLDivElement;\n\t#currentDevice: ?DeviceItem = null;\n\t#editorEnabled: boolean = false;\n\t#pendingReload: boolean = false;\n\t#commandsToRefresh = [\n\t\t'Landing::upBlock',\n\t\t'Landing::downBlock',\n\t\t'Landing::showBlock',\n\t\t'Landing::hideBlock',\n\t\t'Landing::markDeletedBlock',\n\t\t'Landing::addBlock',\n\t\t'Landing::copyBlock',\n\t\t'Landing::moveBlock',\n\t\t'Block::changeNodeName',\n\t\t'Block::updateContent',\n\t\t'Block::getContent',\n\t\t'Landing\\\\Block::addCard',\n\t\t'Landing\\\\Block::cloneCard',\n\t\t'Landing\\\\Block::removeCard',\n\t\t'Landing\\\\Block::updateNodes',\n\t\t'Landing\\\\Block::updateStyles',\n\t\t'Landing\\\\Block::saveForm',// fake-action\n\t];\n\n\t/**\n\t * Device constructor.\n\t *\n\t * @param {Options} options Constructor options.\n\t */\n\tconstructor(options: Options)\n\t{\n\t\tthis.#frameUrl = options.frameUrl;\n\t\tthis.#editorFrameWrapper = options.editorFrameWrapper;\n\t\tthis.#options = options;\n\t\tthis.#registerListeners(options);\n\t\tthis.#buildPreview(options);\n\n\t\tthis.#showPreview();\n\t\tthis.#setDevice(this.#resolveDeviceByType('mobile'));\n\t}\n\n\t/**\n\t * Registers Handlers you need.\n\t *\n\t * @param {Options} options Constructor options.\n\t */\n\t#registerListeners(options: Options)\n\t{\n\t\t// when user click different window size\n\t\tBX.addCustomEvent('BX.Landing.Main:editorSizeChange', (deviceType: string) =>\n\t\t{\n\t\t\tthis.#setDevice(this.#resolveDeviceByType(deviceType));\n\t\t});\n\n\t\t// listen messages from editor frame\n\t\twindow.addEventListener('message', event => {\n\t\t\tconst data = event.data || {};\n\n\t\t\tif (data.action === 'editorenable')\n\t\t\t{\n\t\t\t\tif (!!data.payload.enable)\n\t\t\t\t{\n\t\t\t\t\tthis.#editorEnabled = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.#pendingReload)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#reloadPreviewWindow();\n\t\t\t\t\t}\n\t\t\t\t\tthis.#editorEnabled = false;\n\t\t\t\t\tthis.#pendingReload = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (data.action === 'backendaction')\n\t\t\t{\n\t\t\t\tthis.#backendAction(data.payload);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Invokes when backend request occurred.\n\t *\n\t * @param {{action: string, data: Object}} payload Payload data.\n\t */\n\t#backendAction(payload: {action: string, data: Object})\n\t{\n\t\tif (this.#commandsToRefresh.includes(payload.action))\n\t\t{\n\t\t\tif (this.#editorEnabled)\n\t\t\t{\n\t\t\t\tthis.#pendingReload = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet blockId = null;\n\n\t\t\t\tif (payload.data?.block)\n\t\t\t\t{\n\t\t\t\t\tblockId = payload.data?.block;\n\t\t\t\t}\n\n\t\t\t\tif (payload.data?.updateNodes?.data?.block)\n\t\t\t\t{\n\t\t\t\t\tblockId = payload.data?.updateNodes?.data?.block;\n\t\t\t\t}\n\n\t\t\t\tthis.#reloadPreviewWindow(blockId);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reloads preview window.\n\t * @param {number} blockId\n\t */\n\t#reloadPreviewWindow(blockId: ?number)\n\t{\n\t\tif (this.#previewWindow)\n\t\t{\n\t\t\tconst blockIdPrefix = 'editor';\n\t\t\tconst timestamp = Date.now();\n\n\t\t\tthis.#previewWindow.location.href = this.#frameUrl + '?ts=' + timestamp + '&scrollTo=' + blockIdPrefix + blockId;\n\t\t}\n\t}\n\n\t/**\n\t * Scrolls preview window for some percent.\n\t *\n\t * @param {number} topInPercent Percent from top to scroll.\n\t */\n\t#scrollDevice(topInPercent: number)\n\t{\n\t\tif (this.#previewWindow)\n\t\t{\n\t\t\tconst document = this.#previewWindow.document;\n\n\t\t\tconst scrollHeight = Math.max(\n\t\t\t\tdocument.body.scrollHeight, document.documentElement.scrollHeight,\n\t\t\t\tdocument.body.offsetHeight, document.documentElement.offsetHeight,\n\t\t\t\tdocument.body.clientHeight, document.documentElement.clientHeight\n\t\t\t);\n\n\t\t\tthis.#previewWindow.scroll(0, scrollHeight * topInPercent / 100);\n\t\t}\n\t}\n\n\t/**\n\t * Resolves and returns Device by its code.\n\t *\n\t * @param {string} deviceType Device type.\n\t * @return {DeviceItem}\n\t */\n\t#resolveDeviceByType(deviceType: string): DeviceItem\n\t{\n\t\tlet deviceCode = localStorage.getItem('deviceCode');\n\t\tif (deviceCode && Devices.devices[deviceCode])\n\t\t{\n\t\t\treturn Devices.devices[deviceCode];\n\t\t}\n\n\t\tdeviceCode = Devices.defaultDevice?.[deviceType];\n\t\tif (!deviceCode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn Devices.devices[deviceCode];\n\t}\n\n\t#getPreviewNode(): HTMLDivElement\n\t{\n\t\tif (!this.#previewLoader)\n\t\t{\n\t\t\tLoc.loadMessages(this.#options.messages);\n\n\t\t\tthis.#previewLoader = Tag.render`\n\t\t\t\t<div class=\"landing-device-loader\">\n\t\t\t\t\t<div class=\"landing-device-loader-icon\"></div>\n\t\t\t\t\t<div class=\"landing-device-loader-text\">${Loc.getMessage('LANDING_TPL_PREVIEW_LOADING')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#previewLoader;\n\t}\n\n\t#setPreview(target: HTMLElement)\n\t{\n\t\tif (!target)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.append(this.#getPreviewNode(), target)\n\t}\n\n\t#removePreview()\n\t{\n\t\tDom.addClass(this.#getPreviewNode(), '--hide');\n\t\tEvent.bind(this.#getPreviewNode(), 'transitionend', () => {\n\t\t\tDom.remove(this.#getPreviewNode());\n\t\t});\n\t}\n\n\t/**\n\t * Sets new device.\n\t *\n\t * @param {DeviceItem|null} newDevice Device.\n\t */\n\t#setDevice(newDevice: ?DeviceItem)\n\t{\n\t\tif (!newDevice)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlocalStorage.setItem('deviceCode', newDevice.code);\n\n\t\t// remove old class within preview\n\t\tif (this.#currentDevice)\n\t\t{\n\t\t\tDom.removeClass(this.#previewElement, this.#currentDevice.className);\n\t\t\tthis.#previewElement.style.removeProperty(`top`);\n\t\t}\n\n\t\tthis.#currentDevice = newDevice;\n\t\tthis.#previewElement.querySelector('[data-role=\"device-name\"]').innerHTML = newDevice.name;\n\t\tthis.#previewElement.querySelector('[data-role=\"device-orientation\"]').innerHTML = localStorage.getItem('deviceOrientation');\n\t\tconst frame = this.#previewElement.querySelector('[data-role=\"landing-device-preview-iframe\"]');\n\t\tconst frameWrapper = this.#previewElement.querySelector('[data-role=\"landing-device-preview\"]');\n\n\t\tframe.onload = () => this.#removePreview();\n\n\t\t// scale for device\n\t\tif (frame\n\t\t\t&& frameWrapper\n\t\t\t&& this.#currentDevice.width\n\t\t\t&& this.#currentDevice.height)\n\t\t{\n\t\t\tconst scale = window.innerHeight / (this.#currentDevice.height + 300);\n\t\t\tconst padding = parseInt(window.getComputedStyle(frameWrapper).padding);\n\n\t\t\tlet param1 = this.#currentDevice.width;\n\t\t\tlet param2 = this.#currentDevice.height;\n\n\t\t\tif (localStorage.getItem('deviceOrientation') === 'landscape')\n\t\t\t{\n\t\t\t\tparam1 = this.#currentDevice.height;\n\t\t\t\tparam2 = this.#currentDevice.width;\n\t\t\t}\n\n\t\t\tframe.style.setProperty(`width`, `${param1}px`);\n\t\t\tframe.style.setProperty(`height`, `${param2}px`);\n\t\t\tframeWrapper.style.setProperty(`transform`, `scale(${scale})`);\n\t\t\tthis.#previewElement.style.setProperty(`width`, `${(param1 + (padding * 2)) * scale}px`);\n\t\t\tthis.#previewElement.style.setProperty(`height`, `${(param2 + (padding * 2)) * scale}px`);\n\t\t}\n\n\t\tDom.addClass(this.#previewElement, this.#currentDevice.className);\n\t}\n\n\t/**\n\t * Gets top scroll of editor window and adjusts device preview window.\n\t */\n\t#adjustPreviewScroll()\n\t{\n\t\tconst documentEditorFrame = this.#editorFrameWrapper.querySelector('iframe').contentWindow.document;\n\t\tconst scrollHeight = Math.max(\n\t\t\tdocumentEditorFrame.body.scrollHeight, documentEditorFrame.documentElement.scrollHeight,\n\t\t\tdocumentEditorFrame.body.offsetHeight, documentEditorFrame.documentElement.offsetHeight,\n\t\t\tdocumentEditorFrame.body.clientHeight, documentEditorFrame.documentElement.clientHeight\n\t\t);\n\t\tconst scrollTop = documentEditorFrame.documentElement.scrollTop || documentEditorFrame.body.scrollTop;\n\n\t\tthis.#scrollDevice(scrollTop / scrollHeight * 100);\n\t}\n\n\t/**\n\t * Creates Preview Popup.\n\t *\n\t * @param {Options} options Preview options.\n\t */\n\t#buildPreview(options: Options)\n\t{\n\t\tif (!this.#previewElement)\n\t\t{\n\t\t\tthis.#previewElement = DeviceUI.getPreview({\n\t\t\t\tframeUrl: options.frameUrl,\n\t\t\t\tclickHandler: this.#onClickDeviceSelector.bind(this),\n\t\t\t\tmessages: options.messages,\n\t\t\t});\n\t\t\tDom.hide(this.#previewElement);\n\t\t\tdocument.body.appendChild(this.#previewElement);\n\n\t\t\t//#170065\n\t\t\t//this.#previewElement.querySelector('iframe').contentWindow.addEventListener('load', () => {\n\t\t\t\tif (!this.#previewWindow)\n\t\t\t\t{\n\t\t\t\t\tthis.#previewWindow = this.#previewElement.querySelector('iframe').contentWindow;\n\t\t\t\t\tconst previewDocument = this.#previewElement.querySelector('iframe').contentWindow.document\n\t\t\t\t\tDom.removeClass(previewDocument.querySelector('html'), 'bx-no-touch');\n\t\t\t\t\tDom.addClass(previewDocument.querySelector('html'), 'bx-touch');\n\t\t\t\t}\n\t\t\t\tthis.#adjustPreviewScroll();\n\t\t\t//});\n\t\t}\n\t}\n\n\t/**\n\t * Invokes by clicking on device selector.\n\t */\n\t#onClickDeviceSelector()\n\t{\n\t\tDeviceUI.openDeviceMenu(\n\t\t\tthis.#previewElement.querySelector('[data-role=\"device-name\"]'),\n\t\t\tObject.values(Devices.devices),\n\t\t\tthis.#setDevice.bind(this)\n\t\t);\n\t}\n\n\t/**\n\t * Creates and Shows Preview Popup.\n\t */\n\t#showPreview()\n\t{\n\t\tDom.show(this.#previewElement);\n\t\tthis.#setPreview(this.#previewElement);\n\t}\n\n\t/**\n\t * Hides Preview Popup.\n\t */\n\t#hidePreview()\n\t{\n\t\tDom.hide(this.#previewElement);\n\t}\n}\n"],"names":["Action","options","iframe","Type","isDomNode","Error","blockId","action","payload","contentWindow","postMessage","window","location","origin","Loc","messages","code","UI","itemCode","itemProp","value","pendingMenuItems","onClick","title","getMessage","button","Tag","render","Event","bind","label","getDesignerBlockButton","designerBlockClick","getStyleBlockButton","styleBlockClick","getEditBlockButton","editBlockClick","MenuManager","getMenuById","menu","getBlockAdditionalMenu","close","state","BX","Landing","Utils","setTextContent","getMenuItem","getLayout","setPendingMenuItemValue","enablePaste","item","enable","disable","actions","actionButton","event","onOpenAdditionalMenu","stopPropagation","show","create","id","bindElement","className","angle","position","offset","offsetTop","offsetLeft","items","MenuItem","disabled","changeStateClick","text","getPendingMenuItemValue","onclick","cutClick","copyClick","pasteClick","feedbackClick","saveInLibrary","delimiter","getSortDownBlockButton","sortDownBlockClick","getSortUpBlockButton","sortUpBlockClick","getActionsList","getRemoveBlockButton","removeBlockClick","ExternalControls","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","container","iframeWrapper","Map","querySelector","loadMessages","addEventListener","_classPrivateMethodGet","onHideEditorPanel","data","blocks","top","height","values","allowPaste","localStorage","getItem","i","c","size","blockItem","next","changePasteMenuItem","permissions","map","block","leftContainer","getLeftContainer","allowDesignBlock","onDesignerBlockClick","allowModifyStyles","onStyleBlockClick","allowEditContent","onEditBlockClick","rightContainer","getRightContainer","allowSorting","onSortDownBlockClick","onSortUpBlockClick","allowRemove","onRemoveBlockClick","setTimeout","allowChangeState","closeBlockAdditionalMenu","onChangeStateBlockClick","onCutBlockClick","onCopyBlockClick","onPasteBlockClick","onFeedbackClick","allowSaveInLibrary","onSaveInLibraryClick","Dom","append","hide","set","get","parseInt","changeStateMenuItem","iframeRect","getBoundingClientRect","addClass","removeClass","style","width","left","type","Devices","defaultDevice","tablet","mobile","devices","delimiter1","langCode","iphone14pro","name","iPhoneXR","iPhoneSE","SamsungGalaxyNote10","SamsungGalaxyS8","GooglePixel4","delimiter2","iPad","iPadMini","SamsungGalaxyTabS8","DeviceUI","setItem","switcherClick","hasClass","layout","switcher","toggleClass","wrapper","rotateClick","setProperty","offsetHeight","offsetWidth","frame","innerHTML","hidden","clickHandler","rotate","frameUrl","frameWrapper","appendChild","menuId","menuItems","device","push","html","parentNode","minWidth","animation","Device","editorFrameWrapper","addCustomEvent","deviceType","includes","updateNodes","blockIdPrefix","timestamp","Date","now","href","topInPercent","document","scrollHeight","Math","max","body","documentElement","clientHeight","scroll","deviceCode","target","remove","newDevice","removeProperty","onload","scale","innerHeight","padding","getComputedStyle","param1","param2","documentEditorFrame","scrollTop","getPreview","previewDocument","openDeviceMenu","Object"],"mappings":"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"}