{"version":3,"file":"sidebar.bundle.js","sources":["../src/component/bx-messenger-sidebar.js","../src/sidebar.js"],"sourcesContent":["/**\n * Bitrix im\n * Sidebar vue component\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2019 Bitrix\n */\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\n\n/**\n * @notice Do not mutate or clone this component! It is under development.\n */\nBitrixVue.component('bx-im-component-sidebar',\n\t{\n\t\tdata: function()\n\t\t{\n\t\t\treturn {\n\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\n\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\t...Vuex.mapState({\n\t\t\t\t\trecent: state => state.recent.collection.general,\n\t\t\t\t\tpinned: state => state.recent.collection.pinned\n\t\t\t\t}),\n\n\t\t\t\trecentData()\n\t\t\t\t{\n\t\t\t\t\treturn [...this.recent, ...this.pinned];\n\t\t\t\t}\n\t\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tgetController()\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Data.get('controller');\n\t\t\t\t},\n\n\t\t\t\tgetStore()\n\t\t\t\t{\n\t\t\t\t\treturn this.getController().store;\n\t\t\t\t},\n\n\t\t\t\tonScroll(event)\n\t\t\t\t{\n\t\t\t\t\tif (this.oneScreenRemaining(event))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getController().recent.loadMore();\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonClick(event)\n\t\t\t\t{\n\t\t\t\t\tthis.getController().recent.openOldDialog(event);\n\t\t\t\t},\n\n\t\t\t\tonRightClick(event)\n\t\t\t\t{\n\t\t\t\t\tthis.getController().recent.openOldContextMenu(event);\n\t\t\t\t},\n\n\t\t\t\toneScreenRemaining(event)\n\t\t\t\t{\n\t\t\t\t\treturn event.target.scrollTop + event.target.clientHeight >= event.target.scrollHeight - event.target.clientHeight;\n\t\t\t\t}\n\t\t\t},\n\t\ttemplate: `\n\t\t\t<div class=\"sidebar-wrap\">\n\t\t\t\t<bx-im-view-list-sidebar\n\t\t\t\t\t:recentData=\"recentData\"\n\t\t\t\t\t@scroll=\"onScroll\"\n\t\t\t\t\t@click=\"onClick\"\n\t\t\t\t\t@rightClick=\"onRightClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t`\n\t});","/**\n * Bitrix Im\n * Core application\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\nimport {Core} from \"im.application.core\";\nimport {VueVendorV2} from \"ui.vue\";\n\n// vue components\nimport './component/bx-messenger-sidebar';\nimport './sidebar.css';\nimport \"im.view.list.recent\";\nimport \"im.view.list.sidebar\";\n\nexport class SidebarApplication\n{\n\t/* region 01. Initialize */\n\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.templateTemp = null;\n\t\tthis.rootNodeTemp = this.params.nodeTemp || document.createElement('div');\n\n\t\tthis.eventBus = new VueVendorV2;\n\n\t\tthis.initCore()\n\t\t\t.then(() => this.initParams())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initComplete())\n\t\t;\n\t}\n\n\tinitCore()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tCore.ready().then(controller => {\n\t\t\t\tthis.controller = controller;\n\t\t\t\tresolve();\n\t\t\t})\n\t\t});\n\t}\n\n\tinitParams()\n\t{\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComponent()\n\t{\n\t\treturn this.controller.createVue(this, {\n\t\t\tel: this.rootNode,\n\t\t\ttemplate: `<bx-im-component-sidebar/>`,\n\t\t})\n\t\t.then(vue => {\n\t\t\tthis.template = vue;\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t})\n\t}\n\n\tinitComplete()\n\t{\n\t\tthis.inited = true;\n\t\tthis.initPromise.resolve(this);\n\n\t\treturn this.requestData();\n\t}\n\n\trequestData()\n\t{\n\t\tthis.controller.recent.drawPlaceholders();\n\t\tthis.controller.recent.getRecentData();\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\t/* endregion 01. Initialize */\n\n\t/* region 02. Event Bus */\n\temit(eventName, params = {})\n\t{\n\t\tthis.eventBus.$emit(eventName, params);\n\n\t\treturn true;\n\t}\n\n\tlisten(eventName, callback)\n\t{\n\t\tif (typeof callback !== 'function')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.eventBus.$on(eventName, callback);\n\n\t\treturn true;\n\t}\n\t/* endregion 02. Event Bus */\n}"],"names":["BitrixVue","component","data","created","computed","Vuex","mapState","recent","state","collection","general","pinned","recentData","methods","getController","$Bitrix","Data","get","getStore","store","onScroll","event","oneScreenRemaining","loadMore","onClick","openOldDialog","onRightClick","openOldContextMenu","target","scrollTop","clientHeight","scrollHeight","template","SidebarApplication","params","inited","initPromise","BX","Promise","rootNode","node","document","createElement","templateTemp","rootNodeTemp","nodeTemp","eventBus","VueVendorV2","initCore","then","initParams","initComponent","initComplete","resolve","reject","Core","ready","controller","createVue","el","vue","requestData","drawPlaceholders","getRecentData","promise","eventName","$emit","callback","$on"],"mappings":"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"}