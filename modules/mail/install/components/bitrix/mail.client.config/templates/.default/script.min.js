BX.namespace("BX.MailClientConfig");BX.MailClientConfig.Edit={isSuccessSyncStatus:null,oauthUserIsEmpty:true,isOauthMode:false,isForbiddenToShare:false,smtp:{switcherChecked:false,switcherDisabled:false},crm:{integrationAvailable:false,switcherChecked:false},isCrmIntegrationAvailable:false,isCrmSwitcherChecked:false,init:function(e){if(BX.type.isNotEmptyObject(e)){this.isForbiddenToShare=e.isForbiddenToShare||false;this.smtp.switcherChecked=e.isSmtpSwitcherChecked||false;this.smtp.switcherDisabled=e.isSmtpSwitcherDisabled||false;this.crm.switcherChecked=e.isCrmSwitcherChecked||false;this.crm.integrationAvailable=e.isCrmIntegrationAvailable||false;this.oauthUserIsEmpty=e.oauthUserIsEmpty||false;this.isSuccessSyncStatus=null;this.isOauthMode=e.isOauthMode||false;if(e.isSuccessSyncStatus!==undefined){this.isSuccessSyncStatus=e.isSuccessSyncStatus}}if(this.isSuccessSyncStatus===false){if(this.isOauthMode){this.showOauthAuthorizationBlock();this.showOauthErrorTour()}else{this.showPasswordErrorTour()}}if(this.isOauthMode&&this.oauthUserIsEmpty){this.showOauthAuthorizationBlock()}var t=BX.findChildrenByClassName(document,"mail-set-singleselect",true);for(var i in t){if(!t.hasOwnProperty(i)){continue}this.singleselect(t[i])}BX.bind(BX("mail_connect_mb_crm_new_lead_for_link"),"click",(function(e){var t=BX("mail_connect_mb_crm_new_lead_for");var i=t.offsetHeight>0;t.style.display=i?"none":"";BX[i?"removeClass":"addClass"](this,"mail-set-textarea-show-open")}));this.setSmtpSwitcher();this.setCrmSwitcher()},singleselect:function(e){var t=BX.findChildren(e,{tag:"input",attr:{type:"radio"}},true);for(var i in t){if(!t.hasOwnProperty(i)){continue}BX.bind(t[i],"change",(function(){if(this.checked){if(this.value==0){var t=BX(e.getAttribute("data-checked"));if(t){var i=BX.findNextSibling(this,{tag:"label",attr:{for:this.id}});var s=BX.findNextSibling(t,{tag:"label",attr:{for:t.id}});if(i&&s)BX.adjust(i,{text:s.innerHTML})}}else{e.setAttribute("data-checked",this.id)}}}))}BX.bind(e,"click",(function(t){t=t||window.event;t.skip_singleselect=e}));BX.bind(document,"click",(function(t){t=t||window.event;if(t.skip_singleselect!==e){BX(e.getAttribute("data-checked")).checked=true}}))},beforeOpenDialog:function(){return new Promise((function(e,t){if(BX.MailClientConfig.Edit.isForbiddenToShare){BX.MailClientConfig.Edit.alertForbiddenToShare();return t()}return e()}))},alertForbiddenToShare:function(){B24.licenseInfoPopup.show("mail-shared-mailbox-limit",BX.message("MAIL_MAILBOX_LICENSE_SHARED_LIMIT_TITLE"),BX.message("MAIL_MAILBOX_LICENSE_SHARED_LIMIT_BODY"))},setBlockSwitcher(e,t,i,s,a=false){const o=BX(e);const r=BX(i);if(!o||!r){return}const n=r.querySelector(".mail-connect-form-items");const c=r.querySelector(".mail-connect-title-block");if(!n||!c){return}const l=()=>{BX.Dom.hide(n);BX.Dom.addClass(c,"mail-connect-title-hidden-block");BX.Dom.removeClass(r,"mail-connect-section-block")};const h=()=>{BX.Dom.show(n);BX.Dom.removeClass(c,"mail-connect-title-hidden-block");BX.Dom.addClass(r,"mail-connect-section-block")};const m=BX(t);const d=new BX.UI.Switcher({node:o,checked:s,size:"small",disabled:a??false,handlers:{toggled:()=>{if(d.checked===true){h()}else{l()}if(m){m.click()}}}});if(!s){l()}},showOauthErrorTour(){this.oauthErrorTour=new BX.UI.Tour.Guide({id:"mail-config-oauth-error-tour",simpleMode:true,steps:[{target:"#mail_connect_mb_oauth_btn",title:BX.message("MAIL_CONFIG_OAUTH_ERROR_TOUR_TITLE"),text:BX.message("MAIL_CONFIG_OAUTH_ERROR_TOUR_TEXT"),position:"bottom",article:"19083990"}]});this.oauthErrorTour.start()},showPasswordErrorTour(){this.oauthErrorTour=new BX.UI.Tour.Guide({id:"mail-config-password-error-tour",simpleMode:true,steps:[{target:"#mail_password_form_wrapper",title:BX.message("MAIL_CONFIG_PASSWORD_ERROR_TOUR_TITLE"),text:BX.message("MAIL_CONFIG_PASSWORD_ERROR_TOUR_TEXT"),position:"bottom",article:"19083990"}]});this.oauthErrorTour.start()},showOauthAuthorizationBlock(){var e=BX("mail_connect_form");var t=BX("mail-client-config-email-oauth-field-error");var i=BX("mail-client-config-email-oauth-field-success");var s=BX("mail-email-oauth");var a=BX("mail_connect_mb_oauth_field");if(s){BX.hide(s);BX.hide(t);BX.hide(i)}if(a){a.value="N"}if(!e.elements["fields[mailbox_id]"]){var o=BX("mail_connect_mb_name_field");if(!o["__filled"]){o.value=""}}BX.Dom.style(BX("mail_connect_mb_oauth_status"),"display","none");BX.Dom.style(BX("mail_connect_mb_oauth_btn"),"display",null)},setSmtpSwitcher(){this.setBlockSwitcher("mail-connect-smtp-settings-title","mail_connect_mb_server_smtp_switch","mail-connect-section-smtp-block",this.smtp.switcherChecked,this.smtp.switcherDisabled)},setCrmSwitcher(){if(!this.crm.integrationAvailable){return}this.setBlockSwitcher("mail-connect-crm-settings-title","mail_connect_mb_crm_switch","mail-connect-section-crm-block",this.crm.switcherChecked)}};
//# sourceMappingURL=script.map.js