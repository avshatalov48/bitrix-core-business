{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nlet\n\tBX = window.BX,\n\tBXMobileApp = window.BXMobileApp;\n\nlet nodeText = (function ()\n{\n\tlet nodeText = function (node, container)\n\t{\n\t\tthis.node = node;\n\t\tthis.container = container;\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tBX.bind(this.container, \"click\", this.click);\n\t};\n\tnodeText.prototype = {\n\t\tclick: function (e)\n\t\t{\n\t\t\tthis.show();\n\t\t\treturn BX.PreventDefault(e);\n\t\t},\n\t\tshow: function ()\n\t\t{\n\t\t\tthis.node.value = this.node.value.replace(/<br\\s*[\\/]?>/gi, '');\n\t\t\twindow.app.exec('showPostForm', {\n\t\t\t\tattachButton: {items: []},\n\t\t\t\tattachFileSettings: {},\n\t\t\t\tattachedFiles: [],\n\t\t\t\textraData: {},\n\t\t\t\tmentionButton: {},\n\t\t\t\tsmileButton: {},\n\t\t\t\tmessage: {text: BX.util.htmlspecialcharsback(this.node.value)},\n\t\t\t\tokButton: {\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tname: Loc.getMessage('interface_form_save')\n\t\t\t\t},\n\t\t\t\tcancelButton: {\n\t\t\t\t\tcallback: function ()\n\t\t\t\t\t{\n\t\t\t\t\t},\n\t\t\t\t\tname: Loc.getMessage('interface_form_cancel')\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcallback: function (data)\n\t\t{\n\t\t\tconsole.log(data.text);\n\t\t\tdata.text = (data.text || '');\n\t\t\tthis.node.value = data.text;\n\t\t\tif (data.text === '')\n\t\t\t{\n\t\t\t\tthis.container.innerHTML = `<span class=\"placeholder\">${this.node.getAttribute('placeholder')}</span>`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.container.textContent = data.text;\n\t\t\t}\n\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.node]);\n\t\t}\n\t};\n\treturn nodeText;\n})();\n\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.String = function (params)\n{\n\tthis.init(params);\n};\n\nBX.Mobile.Field.String.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\tresult = new nodeText(node, BX(`${node.id}_target`));\n\t\t}\n\t\treturn result;\n\t}\n};"],"names":["BX","window","BXMobileApp","nodeText","node","container","click","delegate","callback","bind","prototype","e","show","PreventDefault","value","replace","app","exec","attachButton","items","attachFileSettings","attachedFiles","extraData","mentionButton","smileButton","message","text","util","htmlspecialcharsback","okButton","name","Loc","getMessage","cancelButton","data","console","log","innerHTML","getAttribute","textContent","onCustomEvent","Mobile","Field","String","params","init","__proto__","bindElement","result","id"],"mappings":"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"}