this.BX=this.BX||{};(function(e,t,n,a,o){"use strict";var i,r;var s=function(){function e(t){babelHelpers.classCallCheck(this,e);this.gridId=t.gridId;this.filterId=t.filterId;this.grid=BX.Main.gridManager.getInstanceById(this.gridId);this.isConductDisabled=t.isConductDisabled;this.masterSliderUrl=t.masterSliderUrl;this.isInventoryManagementDisabled=t.isInventoryManagementDisabled;this.inventoryManagementFeatureCode=t.inventoryManagementFeatureCode;this.inventoryManagementSource=t.inventoryManagementSource}babelHelpers.createClass(e,[{key:"getSelectedIds",value:function e(){return this.grid.getRows().getSelectedIds()}},{key:"deleteDocument",value:function e(n){var o=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}a.MessageBox.confirm(t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_DELETE_CONTENT_2"),(function(e,a){a.setWaiting();t.ajax.runAction("catalog.document.deleteList",{data:{documentIds:[n]},analyticsLabel:{inventoryManagementSource:o.inventoryManagementSource}}).then((function(){e.close();o.grid.reload()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:t.errors[0].message})}e.close()}))}),t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_DELETE_BUTTON_CONFIRM"),(function(e){return e.close()}),t.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"conductDocument",value:function e(n){var o=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var r={data:{documentIds:[n]}};if(i!==""){r.analyticsLabel={documentType:i}}r.analyticsLabel.inventoryManagementSource=this.inventoryManagementSource;r.analyticsLabel.mode="single";a.MessageBox.confirm(t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CONDUCT_CONTENT_2"),(function(e,n){n.setWaiting();t.ajax.runAction("catalog.document.conductList",r).then((function(){e.close();o.grid.reload()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:t.errors[0].message})}e.close()}))}),t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CONDUCT_BUTTON_CONFIRM"),(function(e){return e.close()}),t.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"cancelDocument",value:function e(n){var o=this;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var c=t.Extension.getSettings("catalog.document-grid");var l={data:{documentIds:[n]}};if(s!==""){l.analyticsLabel={documentType:s}}l.analyticsLabel.mode="single";l.analyticsLabel.inventoryManagementSource=this.inventoryManagementSource;var d=t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_CONTENT_2");if(c.get("isProductBatchMethodSelected")){var u=t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_BATCH_SELECTED_CONTENT",{"#HELP_LINK#":"<help-link></help-link>"});d=t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(["\n\t\t\t\t<div>\n\t\t\t\t\t<div>","</div>\n\t\t\t\t\t<div>","</div>\n\t\t\t\t</div>\n\t\t\t"])),d,u);var g=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<a href="#" class="ui-form-link">\n\t\t\t\t\t',"\n\t\t\t\t</a>\n\t\t\t"])),t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_BATCH_SELECTED_CONTENT_LINK"));t.Event.bind(g,"click",(function(){var e=17858278;top.BX.Helper.show("redirect=detail&code=".concat(e))}));t.Dom.replace(d.querySelector("help-link"),g)}a.MessageBox.confirm(d,(function(e,n){n.setWaiting();t.ajax.runAction("catalog.document.cancelList",l).then((function(){e.close();o.grid.reload()}))["catch"]((function(t){if(t.errors){BX.UI.Notification.Center.notify({content:t.errors[0].message})}e.close()}))}),t.Loc.getMessage("DOCUMENT_GRID_DOCUMENT_CANCEL_BUTTON_CONFIRM"),(function(e){return e.close()}),t.Loc.getMessage("DOCUMENT_GRID_BUTTON_BACK"))}},{key:"deleteSelectedDocuments",value:function e(){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}var a=this.getSelectedIds();t.ajax.runAction("catalog.document.deleteList",{data:{documentIds:a},analyticsLabel:{inventoryManagementSource:this.inventoryManagementSource}}).then((function(e){n.grid.reload()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:e.message})}}))}n.grid.reload()}))}},{key:"conductSelectedDocuments",value:function e(){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var a=this.getSelectedIds();t.ajax.runAction("catalog.document.conductList",{data:{documentIds:a},analyticsLabel:{mode:"list",inventoryManagementSource:this.inventoryManagementSource}}).then((function(e){n.grid.reload()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:e.message})}}))}n.grid.reload()}))}},{key:"cancelSelectedDocuments",value:function e(){var n=this;if(this.isInventoryManagementDisabled&&this.inventoryManagementFeatureCode){top.BX.UI.InfoHelper.show(this.inventoryManagementFeatureCode);return}if(this.isConductDisabled){this.openStoreMasterSlider();return}var a=this.getSelectedIds();t.ajax.runAction("catalog.document.cancelList",{data:{documentIds:a},analyticsLabel:{mode:"list",inventoryManagementSource:this.inventoryManagementSource}}).then((function(e){n.grid.reload()}))["catch"]((function(e){if(e.errors){e.errors.forEach((function(e){if(e.message){BX.UI.Notification.Center.notify({content:e.message})}}))}n.grid.reload()}))}},{key:"processApplyButtonClick",value:function e(){var t=this.grid.getActionsPanel().getValues();var n=t["action_button_".concat(this.gridId)];if(n==="conduct"){this.conductSelectedDocuments()}if(n==="cancel"){this.cancelSelectedDocuments()}}},{key:"applyFilter",value:function e(t){var n=BX.Main.filterManager.getById(this.filterId);if(!n){return}n.getApi().extendFilter(t)}},{key:"openHowToStart",value:function e(){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=14566618");event.preventDefault()}}},{key:"openHowToTransfer",value:function e(){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=14566610");event.preventDefault()}}},{key:"openHowToControlGoodsMovement",value:function e(){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=14566670");event.preventDefault()}}},{key:"openHowToAccountForLosses",value:function e(){if(top.BX.Helper){top.BX.Helper.show("redirect=detail&code=14566652");event.preventDefault()}}},{key:"openStoreMasterSlider",value:function e(){(new o.EnableWizardOpener).open(this.masterSliderUrl,{urlParams:{analyticsContextSection:o.AnalyticsContextList.DOCUMENT_LIST},data:{openGridOnDone:false},events:{onCloseComplete:function e(t){var n=t.getSlider();if(!n){return}if(n.getData().get("isInventoryManagementEnabled")){document.location.reload()}}}})}}],[{key:"hideSettingsMenu",value:function e(){n.PopupManager.getPopupById("docFieldsSettingsMenu").close()}},{key:"openUfSlider",value:function t(n,a){n.preventDefault();e.hideSettingsMenu();BX.SidePanel.Instance.open(a.options.href,{allowChangeHistory:false,cacheable:false})}}]);return e}();e.DocumentGridManager=s})(this.BX.Catalog=this.BX.Catalog||{},BX,BX.Main,BX.UI.Dialogs,BX.Catalog.Store);
//# sourceMappingURL=document-grid.bundle.map.js