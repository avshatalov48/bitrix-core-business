{"version":3,"file":"script.js","sources":["src/pull-requests.js","src/user-selector/create-chat-footer.js","src/user-selector/user-selector.js","src/chat.js","src/invite.js","src/settings-elements/chat-action.js","src/settings-elements/follow.js","src/settings-elements/info.js","src/settings-elements/members.js","src/settings-elements/pin.js","src/settings-elements/roles.js","src/group-settings.js","src/user-settings.js","src/settings.js","src/video-call.js","src/menu.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\n\nexport class PullRequests extends EventEmitter\n{\n\t#entityId: number;\n\t#currentUserId: number;\n\n\tconstructor(entityId: number, currentUserId: number)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Menu.PullRequests');\n\n\t\tthis.#entityId = parseInt(entityId, 10);\n\t\tthis.#currentUserId = parseInt(currentUserId, 10);\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'socialnetwork';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\tworkgroup_user_add: this.#update.bind(this),\n\t\t\tworkgroup_user_delete: this.#update.bind(this),\n\t\t\tworkgroup_user_update: this.#update.bind(this),\n\t\t\tworkgroup_update: this.#update.bind(this),\n\t\t\tuser_spaces_counter: this.#updateCounters.bind(this),\n\t\t\tspace_feature_change: this.#updateMenuItem.bind(this),\n\t\t};\n\t}\n\n\t#update(data): void\n\t{\n\t\tif (parseInt(data.params.GROUP_ID, 10) === this.#entityId)\n\t\t{\n\t\t\tthis.emit('update');\n\t\t}\n\t}\n\n\t#updateCounters(data): void\n\t{\n\t\tif (data.userId && parseInt(data.userId, 10) === this.#currentUserId)\n\t\t{\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tdata.space = data.spaces.find((space) => space.id === this.#entityId);\n\n\t\t\tif (!data.space)\n\t\t\t{\n\t\t\t\t// no counters for this space\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdata.space = {\n\t\t\t\t\tid: this.#entityId,\n\t\t\t\t\tmetrics: {\n\t\t\t\t\t\tcountersTasksTotal: 0,\n\t\t\t\t\t\tcountersCalendarTotal: 0,\n\t\t\t\t\t\tcountersLiveFeedTotal: 0,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.emit('updateCounters', data);\n\t\t}\n\t}\n\n\t#updateMenuItem(data): void\n\t{\n\t\tif (data.GROUP_ID === this.#entityId && data.USER_ID === this.#currentUserId)\n\t\t{\n\t\t\tthis.emit('updateMenuItem', data);\n\t\t}\n\t}\n}\n","import { Tag, Loc, Runtime } from 'main.core';\nimport { DefaultFooter } from 'ui.entity-selector';\nimport type { Dialog } from 'ui.entity-selector';\nimport { Button, ButtonColor, ButtonSize } from 'ui.buttons';\n\nexport default class CreateChatFooter extends DefaultFooter\n{\n\t#buttons: {\n\t\tcreateChatButton: Button,\n\t\tcancelButton: Button,\n\t};\n\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.#buttons = {\n\t\t\tcreateChatButton: null,\n\t\t\tcancelButton: null,\n\t\t};\n\n\t\tthis.handleDialogDestroy = this.handleDialogDestroy.bind(this);\n\t\tthis.handleSelectedItemsUpdated = this.handleSelectedItemsUpdated.bind(this);\n\n\t\tthis.bindEvents();\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\tthis.options.containerClass = 'sn-ui-selector-footer-create-chat';\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.renderCreateChatButton()}\n\t\t\t\t${this.renderCancelButton()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\trenderCreateChatButton(): HTMLElement\n\t{\n\t\tthis.#buttons.createChatButton = new Button({\n\t\t\ttext: Loc.getMessage('SOCNET_ENTITY_SELECTOR_CREATE'),\n\t\t\tround: true,\n\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\tsize: ButtonSize.SMALL,\n\t\t\tevents: {\n\t\t\t\tclick: this.createChatButtonClickHandler.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tthis.#buttons.createChatButton.setDisabled(true);\n\n\t\treturn this.#buttons.createChatButton.getContainer();\n\t}\n\n\tcreateChatButtonClickHandler(): void\n\t{\n\t\tconst userIds = this.getDialog().getSelectedItems().map((item) => item.getId());\n\n\t\tthis.#buttons.createChatButton.setWaiting(true);\n\t\tthis.createChatAction(userIds).then(async (response) => {\n\t\t\tconst chatId = 'chat' + response.data;\n\n\t\t\tconst { Messenger } = await Runtime.loadExtension('im.public.iframe');\n\t\t\tMessenger.openChat(chatId);\n\n\t\t\tthis.#buttons.createChatButton.setWaiting(false);\n\t\t\tthis.getDialog().deselectAll();\n\t\t\tthis.getDialog().hide();\n\t\t});\n\t}\n\n\tcreateChatAction(userIds): Promise\n\t{\n\t\treturn BX.ajax.runAction('socialnetwork.api.chat.create', {\n\t\t\tdata: {\n\t\t\t\tuserIds,\n\t\t\t},\n\t\t});\n\t}\n\n\trenderCancelButton(): HTMLElement\n\t{\n\t\tthis.#buttons.cancelButton = new Button({\n\t\t\ttext: Loc.getMessage('SOCNET_ENTITY_SELECTOR_CANCEL'),\n\t\t\tround: true,\n\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\tsize: ButtonSize.SMALL,\n\t\t\tevents: {\n\t\t\t\tclick: this.cancelButtonClickHandler.bind(this),\n\t\t\t},\n\t\t});\n\n\t\treturn this.#buttons.cancelButton.getContainer();\n\t}\n\n\tcancelButtonClickHandler(): void\n\t{\n\t\tthis.getDialog().hide();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tthis.getDialog().subscribe('onDestroy', this.handleDialogDestroy);\n\t\tthis.getDialog().subscribe('Item:onSelect', this.handleSelectedItemsUpdated);\n\t\tthis.getDialog().subscribe('Item:onDeselect', this.handleSelectedItemsUpdated);\n\t}\n\n\tunbindEvents(): void\n\t{\n\t\tthis.getDialog().unsubscribe('onDestroy', this.handleDialogDestroy);\n\t\tthis.getDialog().unsubscribe('Item:onSelect', this.handleSelectedItemsUpdated);\n\t\tthis.getDialog().unsubscribe('Item:onDeselect', this.handleSelectedItemsUpdated);\n\t}\n\n\thandleSelectedItemsUpdated(): void\n\t{\n\t\tif (!this.#buttons.createChatButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#buttons.createChatButton.setDisabled(this.getDialog().getSelectedItems().length === 0);\n\t}\n\n\thandleDialogDestroy(): void\n\t{\n\t\tthis.unbindEvents();\n\t}\n}","import { Loc, Tag, Dom } from 'main.core';\nimport { Dialog, BaseHeader } from 'ui.entity-selector';\nimport { EventEmitter } from 'main.core.events';\nimport CreateChatFooter from './create-chat-footer';\n\nexport class UserSelector extends EventEmitter\n{\n\t#bindElement: HTMLElement;\n\t#title: string;\n\t#preselectedItems: any[];\n\t#onClose: function;\n\t#onLoad: function;\n\t#groupId: number;\n\t#createChat: boolean;\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('SocialNetwork.Spaces.UserSelector');\n\n\t\tthis.#bindElement = options.bindElement;\n\n\t\tthis.#title = options.title;\n\n\t\tthis.#preselectedItems = options.preselectedItems ?? [];\n\n\t\tthis.#onClose = options.onClose ?? (() => {});\n\t\tthis.#onLoad = options.onLoad ?? (() => {});\n\n\t\tthis.#groupId = options.groupId ?? 0;\n\t\tthis.#createChat = options.createChat ?? false;\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\tif (!this.dialog)\n\t\t{\n\t\t\tconst title = this.#title;\n\n\t\t\tclass UserSelectorDialogHeader extends BaseHeader\n\t\t\t{\n\t\t\t\trender(): HTMLElement\n\t\t\t\t{\n\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t<div class=\"sn-spaces__entity-dialog-header\">${title}</div>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.dialog = new Dialog({\n\t\t\t\ttargetNode: this.#bindElement,\n\t\t\t\twidth: 400,\n\t\t\t\tdropdownMode: true,\n\t\t\t\theader: UserSelectorDialogHeader,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcontext: 'socialnetwork.spaces',\n\t\t\t\tpreselectedItems: this.#preselectedItems,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\tsubstituteEntityId: this.#createChat ? 'project-user' : null,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tfooterInviteIntranetOnly: true,\n\t\t\t\t\t\t\tshowInvitationFooter: !this.#createChat,\n\t\t\t\t\t\t\tprojectId: this.#groupId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchTabOptions: this.#createChat && {\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('SN_SPACES_USER_SELECTOR_SEARCH_TAB_EMPTY_TITLE'),\n\t\t\t\t\t\tsubtitle: Loc.getMessage('SN_SPACES_USER_SELECTOR_SEARCH_TAB_EMPTY_TEXT'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: this.#onClose,\n\t\t\t\t\tonLoad: this.#onLoad,\n\t\t\t\t\t'SearchTab:onLoad': this.#onLoad,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tif (this.#createChat)\n\t\t\t{\n\t\t\t\tthis.dialog.setFooter(CreateChatFooter);\n\t\t\t}\n\n\t\t\tthis.#bindSliderEvents();\n\t\t}\n\n\t\treturn this.dialog;\n\t}\n\n\treload()\n\t{\n\t\tthis.dialog.loadState = 'UNSENT';\n\t\tthis.dialog.load();\n\t}\n\n\t#bindSliderEvents()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpenStart', (event) => {\n\t\t\tconst slider = event.target;\n\n\t\t\tif (this.#getImBar())\n\t\t\t{\n\t\t\t\tDom.style(this.#getImBar(), 'zIndex', slider.getZindex());\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onBeforeCloseComplete', (event) => {\n\t\t\tconst slider = event.target;\n\n\t\t\tif (this.#isInviteSlider(slider) && this.#getImBar())\n\t\t\t{\n\t\t\t\tDom.style(this.#getImBar(), 'zIndex', '');\n\t\t\t}\n\t\t});\n\t}\n\n\t#isInviteSlider(slider)\n\t{\n\t\treturn slider.options.data?.entitySelectorId === this.dialog.getId();\n\t}\n\n\t#getImBar()\n\t{\n\t\treturn document.getElementById('bx-im-bar');\n\t}\n}\n","import { ajax, Loc } from 'main.core';\nimport { Messenger } from 'im.public';\nimport { Dialog } from 'ui.entity-selector';\nimport { UserSelector } from './user-selector/user-selector';\n\ntype Params = {\n\tentityType: 'group' | 'user',\n\tentityId: number,\n\tgroupMembersList: any,\n}\n\nexport class Chat\n{\n\t#entityType: 'group' | 'user';\n\t#entityId: number;\n\t#groupMembersList: any;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#entityType = params.entityType;\n\t\tthis.#entityId = params.entityId;\n\t\tthis.#groupMembersList = params.groupMembersList;\n\t}\n\n\tstartVideoCall()\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax.runAction('intranet.controlbutton.getVideoCallChat', {\n\t\t\tdata: {\n\t\t\t\tentityType: this.#entityType === 'group' ? 'workgroup' : 'user',\n\t\t\t\tentityId: this.#entityId,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tentity: this.#entityType,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tMessenger.startVideoCall(`chat${response.data}`, true);\n\t\t\t}\n\n\t\t\tthis.chatLockCounter = 0;\n\t\t}, (response) => {\n\t\t\tif (\n\t\t\t\tresponse.errors[0].code === 'lock_error'\n\t\t\t\t&& this.chatLockCounter < 4\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.chatLockCounter++;\n\t\t\t\tthis.startVideoCall();\n\t\t\t}\n\t\t});\n\t}\n\n\topenChat()\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax.runAction('intranet.controlbutton.getChat', {\n\t\t\tdata: {\n\t\t\t\tentityType: this.#entityType === 'group' ? 'workgroup' : 'user',\n\t\t\t\tentityId: this.#entityId,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tentity: this.#entityType,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tMessenger.openChat(`chat${parseInt(response.data, 10)}`);\n\t\t\t}\n\n\t\t\tthis.chatLockCounter = 0;\n\t\t}, (response) => {\n\t\t\tif (response.errors[0].code === 'lock_error' && this.chatLockCounter < 4)\n\t\t\t{\n\t\t\t\tthis.chatLockCounter++;\n\t\t\t\tthis.openChat();\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateChat(node)\n\t{\n\t\tthis.getDialog(node).show();\n\t}\n\n\tgetDialog(node): Dialog\n\t{\n\t\tif (!this.userSelector)\n\t\t{\n\t\t\tthis.userSelector = new UserSelector({\n\t\t\t\tbindElement: node,\n\t\t\t\tcreateChat: true,\n\t\t\t\ttitle: Loc.getMessage('SN_SPACES_CREATE_CHAT'),\n\t\t\t\tonLoad: this.#updateMemberNodes.bind(this),\n\t\t\t\tgroupId: this.#entityId,\n\t\t\t});\n\t\t}\n\n\t\treturn this.userSelector.getDialog();\n\t}\n\n\tupdate(groupDataPromise)\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tgroupDataPromise.then((response) => {\n\t\t\tthis.#groupMembersList = response.groupMembersList;\n\n\t\t\tthis.userSelector?.reload();\n\t\t});\n\t}\n\n\t#updateMemberNodes()\n\t{\n\t\tconst membersIds = this.#groupMembersList\n\t\t\t.filter((user) => user.isMember)\n\t\t\t.map((item) => parseInt(item.id))\n\t\t;\n\n\t\tthis.getDialog().getItems().forEach((item) => {\n\t\t\tconst isHidden = !membersIds.includes(item.getId());\n\t\t\titem.setHidden(isHidden);\n\n\t\t\tif (isHidden && item.isSelected())\n\t\t\t{\n\t\t\t\titem.deselect();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { UserSelector } from './user-selector/user-selector';\n\nexport class Invite extends EventEmitter\n{\n\t#node: HTMLElement;\n\t#invitedUsers: number[];\n\t#cannotInvite: number[];\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('SocialNetwork.Spaces.Invite');\n\n\t\tthis.#node = options.node;\n\t\tthis.#invitedUsers = this.#prepareInvited(options.groupMembersList);\n\t\tthis.#cannotInvite = this.#prepareCannotInvite(options.groupMembersList);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getDialog().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getDialog().hide();\n\t}\n\n\t#onClose()\n\t{\n\t\tconst users = [...this.dialog.getSelectedItems()].map((item) => item.id);\n\t\tif (!this.#arraysAreEqual(users, this.#invitedUsers))\n\t\t{\n\t\t\tthis.#invitedUsers = users;\n\t\t\tthis.emit('usersSelected', this.#invitedUsers);\n\t\t}\n\t\tthis.emit('onClose');\n\t}\n\n\t#arraysAreEqual(arr1, arr2)\n\t{\n\t\treturn [...arr1].sort().toString() === [...arr2].sort().toString();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\tthis.getDialogPopup().isShown();\n\t}\n\n\tgetDialogPopup()\n\t{\n\t\treturn this.getDialog().getPopup();\n\t}\n\n\tgetDialog()\n\t{\n\t\tif (!this.dialog)\n\t\t{\n\t\t\tconst userSelector = new UserSelector({\n\t\t\t\tbindElement: this.#node,\n\t\t\t\ttitle: Loc.getMessage('SN_SPACES_MENU_SPACE_INVITE_MEMBERS'),\n\t\t\t\tpreselectedItems: this.#prepareItems(),\n\t\t\t\tonClose: this.#onClose.bind(this),\n\t\t\t\tonLoad: this.#updateCannotInviteNodes.bind(this),\n\t\t\t});\n\n\t\t\tthis.dialog = userSelector.getDialog();\n\n\t\t\tthis.dialog.getPopup().setAngle({\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: this.#node.offsetWidth + parseInt(getComputedStyle(this.#node).marginLeft),\n\t\t\t});\n\t\t}\n\n\t\treturn this.dialog;\n\t}\n\n\tupdate(groupDataPromise)\n\t{\n\t\tgroupDataPromise.then((response) => {\n\t\t\tthis.#invitedUsers = this.#prepareInvited(response.groupMembersList);\n\t\t\tthis.#cannotInvite = this.#prepareCannotInvite(response.groupMembersList);\n\n\t\t\tthis.#updateCannotInviteNodes();\n\t\t});\n\t}\n\n\t#updateCannotInviteNodes()\n\t{\n\t\tthis.dialog?.getItems().forEach((item) => {\n\t\t\tconst isNotInInvited = !this.#invitedUsers.includes(item.getId());\n\t\t\tconst isHidden = this.#cannotInvite.includes(item.getId());\n\t\t\titem.setHidden(isHidden);\n\n\t\t\tif ((isHidden || isNotInInvited) && item.isSelected())\n\t\t\t{\n\t\t\t\titem.deselect();\n\t\t\t}\n\t\t});\n\t}\n\n\t#prepareInvited(users): number[]\n\t{\n\t\treturn users\n\t\t\t.filter((user) => user.invited)\n\t\t\t.map((user) => parseInt(user.id));\n\t}\n\n\t#prepareCannotInvite(users): number[]\n\t{\n\t\treturn users\n\t\t\t.filter((user) => !user.invited)\n\t\t\t.map((user) => parseInt(user.id));\n\t}\n\n\t#prepareItems()\n\t{\n\t\treturn this.#invitedUsers.map((userId) => ['user', parseInt(userId)]);\n\t}\n}","import { Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype Params = {\n\tcanUse: boolean,\n}\n\nexport class ChatAction extends EventEmitter\n{\n\t#canUse: boolean;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.ChatAction');\n\n\t\tthis.#canUse = params.canUse === true;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst videoCallId = 'spaces-settings-video-call';\n\t\tconst openChatId = 'spaces-settings-open-chat';\n\t\tconst createChatId = 'spaces-settings-create-chat';\n\n\t\tconst disabled = this.#canUse ? '' : '--disabled';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-communication\">\n\t\t\t\t<div\n\t\t\t\t\tdata-id=\"${videoCallId}\"\n\t\t\t\t\tclass=\"sn-spaces__popup-communication-item ${disabled}\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --video-1\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 26px;\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div class=\"sn-spaces__popup-communication-item_text\">\n\t\t\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_CHAT_VIDEO_CALL_HD')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tdata-id=\"${openChatId}\"\n\t\t\t\t\tclass=\"sn-spaces__popup-communication-item ${disabled}\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --chat-1\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 26px;\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div class=\"sn-spaces__popup-communication-item_text\">\n\t\t\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_CHAT_OPEN')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tdata-id=\"${createChatId}\"\n\t\t\t\t\tclass=\"sn-spaces__popup-communication-item ${disabled}\" \n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --add-chat\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 26px;\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div class=\"sn-spaces__popup-communication-item_text\">\n\t\t\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_CHAT_CREATE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector(`[data-id='${videoCallId}']`),\n\t\t\t'click',\n\t\t\t() => this.emit('videoCall'),\n\t\t);\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector(`[data-id='${openChatId}']`),\n\t\t\t'click',\n\t\t\t() => this.emit('openChat'),\n\t\t);\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector(`[data-id='${createChatId}']`),\n\t\t\t'click',\n\t\t\t() => this.emit('createChat'),\n\t\t);\n\n\t\treturn node;\n\t}\n}\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype Params = {\n\tfollow: boolean,\n\tcanUse: boolean,\n}\n\nexport class Follow extends EventEmitter\n{\n\t#follow: boolean;\n\t#canUse: boolean;\n\t#disabled: boolean;\n\t#node: HTMLElement;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.Follow');\n\n\t\tthis.#follow = params.follow;\n\t\tthis.#canUse = params.canUse === true;\n\n\t\tthis.#disabled = false;\n\n\t\tthis.#bindEvents();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst followId = 'spaces-settings-follow';\n\n\t\tconst iconClass = this.#follow ? '--sound-on' : '--sound-off';\n\n\t\tconst disabled = this.#canUse ? '' : '--disabled';\n\n\t\tthis.#node = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"${followId}\"\n\t\t\t\tclass=\"sn-spaces__popup-item --mini ${disabled}\"\n\t\t\t>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set ${iconClass}\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 22px;\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round-name\">\n\t\t\t\t\t${this.#getLabel(this.#follow)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#node, 'click', this.#toggle.bind(this));\n\n\t\treturn this.#node;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.#disabled = false;\n\t}\n\n\t#toggle()\n\t{\n\t\tif (this.#disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#disabled = true;\n\n\t\tthis.#follow = !this.#follow;\n\n\t\tthis.emit('update', this.#follow);\n\n\t\tthis.#changeIcon(this.#follow);\n\n\t\tthis.#changeLabel(this.#follow);\n\t}\n\n\t#changeIcon(follow: boolean)\n\t{\n\t\tconst iconNode = this.#node.querySelector('.ui-icon-set');\n\t\tif (follow)\n\t\t{\n\t\t\tDom.removeClass(iconNode, '--sound-off');\n\t\t\tDom.addClass(iconNode, '--sound-on');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(iconNode, '--sound-on');\n\t\t\tDom.addClass(iconNode, '--sound-off');\n\t\t}\n\t}\n\n\t#changeLabel(follow: boolean)\n\t{\n\t\tconst nameNode = this.#node.querySelector('.sn-spaces__popup-icon-round-name');\n\t\tnameNode.textContent = this.#getLabel(follow);\n\t}\n\n\t#getLabel(follow: boolean): string\n\t{\n\t\treturn follow\n\t\t\t? Loc.getMessage('SN_SPACES_MENU_FOLLOW_N')\n\t\t\t: Loc.getMessage('SN_SPACES_MENU_FOLLOW_Y')\n\t\t;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('followChanged', function(event) {\n\t\t\tthis.#follow = event.data.isFollowed;\n\t\t\tthis.#changeLabel(this.#follow);\n\t\t\tthis.#changeIcon(this.#follow);\n\t\t}.bind(this));\n\t}\n}","import { Dom, Event, Loc, Tag, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport type { GroupData } from '../group-settings';\nimport { Perms } from '../group-settings';\nimport { Logo, LogoData } from 'socialnetwork.logo';\nimport { GroupPrivacy } from 'socialnetwork.group-privacy';\nimport { Controller } from 'socialnetwork.controller';\n\ntype Params = {\n\ttitle: number,\n\tlogo: LogoData,\n\tprivacyCode: string,\n\tactions: Perms,\n}\n\nexport class Info extends EventEmitter\n{\n\t#groupId: number;\n\t#title: string;\n\t#logo: LogoData;\n\t#privacyCode: string;\n\t#privacyPopup: GroupPrivacy;\n\t#actions: Perms;\n\n\t#layout: {\n\t\twrapNode: HTMLElement,\n\t\tavatar: HTMLElement,\n\t\ttitleNode: HTMLElement,\n\t\ttitleTextNode: HTMLElement,\n\t\teditTitleNode: HTMLElement,\n\t\teditTitleInput: HTMLInputElement,\n\t\tprivacyTextNode: HTMLElement,\n\t\tmoreButtonNode: HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.Info');\n\n\t\tthis.#layout = {};\n\t\tthis.#groupId = params.groupId;\n\t\tthis.#title = params.title;\n\t\tthis.#logo = params.logo;\n\t\tthis.#privacyCode = params.privacyCode;\n\t\tthis.#actions = params.actions;\n\t}\n\n\tupdate(groupData: GroupData): void\n\t{\n\t\tconst { name, privacyCode, avatar } = groupData;\n\n\t\tif (name)\n\t\t{\n\t\t\tthis.#setTitle(name);\n\t\t}\n\t\tif (privacyCode)\n\t\t{\n\t\t\tthis.#setPrivacy(privacyCode);\n\t\t}\n\t\tif (avatar)\n\t\t{\n\t\t\tthis.#setAvatar(avatar);\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrapNode = Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item --main\">\n\t\t\t\t<div class=\"sn-spaces__popup-settings_logo\">\n\t\t\t\t\t${this.#renderSpaceAvatar()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__popup-settings_info\">\n\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t${this.#renderEditTitle()}\n\t\t\t\t\t${this.#renderPrivacy()}\n\t\t\t\t</div>\n\t\t\t\t${this.#renderMoreButton()}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.wrapNode, 'click', (event) => {\n\t\t\tif (event.target === this.#layout.wrapNode || event.target === this.#layout.moreButtonNode)\n\t\t\t{\n\t\t\t\tthis.emit('more');\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.wrapNode;\n\t}\n\n\t#renderSpaceAvatar(): HTMLElement\n\t{\n\t\tconst logo = new Logo(this.#logo);\n\n\t\tconst avatarNode = Tag.render`\n\t\t\t<div class=\"sn-spaces__space-logo ${logo.getClass() ?? ''}\">\n\t\t\t\t${logo.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.avatar?.replaceWith(avatarNode);\n\t\tthis.#layout.avatar = avatarNode;\n\n\t\treturn this.#layout.avatar;\n\t}\n\n\t#renderMoreButton(): HTMLElement\n\t{\n\t\tthis.#layout.moreButtonNode = Tag.render`\n\t\t\t<div \n\t\t\t\tdata-id=\"spaces-settings-space-info-btn\"\n\t\t\t\tclass=\"ui-icon-set --chevron-right\"\n\t\t\t\ttitle=\"${Loc.getMessage('SN_SPACES_MENU_INFO_MORE_BTN')}\"\n\t\t\t></div>\n\t\t`;\n\n\t\treturn this.#layout.moreButtonNode;\n\t}\n\n\t#startEditTitle()\n\t{\n\t\tDom.addClass(this.#layout.titleNode, '--hidden');\n\t\tDom.removeClass(this.#layout.editTitleNode, '--hidden');\n\n\t\tconst input = this.#layout.editTitleInput;\n\n\t\tinput.focus();\n\t\tinput.setSelectionRange(input.value.length, input.value.length);\n\t}\n\n\t#stopEditTitle()\n\t{\n\t\tDom.addClass(this.#layout.editTitleNode, '--hidden');\n\t\tDom.removeClass(this.#layout.titleNode, '--hidden');\n\t}\n\n\t#setTitle(value: string)\n\t{\n\t\tthis.#title = value;\n\t\tthis.#layout.editTitleInput.value = this.#title;\n\n\t\tthis.#layout.titleTextNode.textContent = Text.encode(this.#title);\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\tthis.#layout.titleNode = Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-settings_title\">\n\t\t\t\t${this.#renderTitleText()}\n\t\t\t\t${this.#actions.canEdit ? this.#renderPencilIcon() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.titleNode;\n\t}\n\n\t#renderTitleText(): HTMLElement\n\t{\n\t\tthis.#layout.titleTextNode = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"spaces-settings-space-info-name\"\n\t\t\t\tclass=\"sn-spaces__popup-settings_name\"\n\t\t\t>\n\t\t\t\t${Text.encode(this.#title)}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.titleTextNode;\n\t}\n\n\t#renderEditTitle(): HTMLElement\n\t{\n\t\tconst uiClasses = 'ui-ctl ui-ctl-textbox ui-ctl--w100 ui-ctl--transp '\n\t\t\t+ 'ui-ctl-no-border ui-ctl-xs ui-ctl-no-padding';\n\n\t\tthis.#layout.editTitleNode = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"spaces-settings-space-info-edit\"\n\t\t\t\tclass=\"sn-spaces__popup-settings_title --hidden\"\n\t\t\t>\n\t\t\t\t<div class=\"${uiClasses}\">\n\t\t\t\t\t${this.#renderEditTitleInput()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst input = this.#layout.editTitleInput;\n\n\t\tEvent.bind(input, 'keydown', (event: KeyboardEvent) => {\n\t\t\tif (event.key === 'Escape' || event.key === 'Enter')\n\t\t\t{\n\t\t\t\tinput.blur();\n\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(input, 'blur', () => {\n\t\t\tif (this.#title !== input.value)\n\t\t\t{\n\t\t\t\tthis.#setTitle(input.value);\n\n\t\t\t\tController.changeTitle(this.#groupId, this.#title);\n\t\t\t\tthis.emit('changeTitle', this.#title);\n\t\t\t}\n\n\t\t\tthis.#stopEditTitle();\n\t\t});\n\n\t\treturn this.#layout.editTitleNode;\n\t}\n\n\t#renderEditTitleInput()\n\t{\n\t\tthis.#layout.editTitleInput = Tag.render`\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element sn-spaces__popup-settings_name-input\"\n\t\t\t\tvalue=\"${Text.encode(this.#title)}\"\n\t\t\t>\n\t\t`;\n\n\t\treturn this.#layout.editTitleInput;\n\t}\n\n\t#renderPrivacy(): HTMLElement\n\t{\n\t\tthis.#privacyPopup = this.#createPrivacyPopup();\n\n\t\tconst node = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"spaces-settings-space-info-privacy\"\n\t\t\t\tclass=\"sn-spaces__popup-settings_select-private\"\n\t\t\t>\n\t\t\t\t${this.#renderPrivacyText()}\n\t\t\t\t${this.#actions.canEdit ? this.#renderPrivacyIcon() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#actions.canEdit)\n\t\t{\n\t\t\tEvent.bind(node, 'click', this.#showPrivacy.bind(this));\n\t\t}\n\n\t\treturn node;\n\t}\n\n\t#createPrivacyPopup(): GroupPrivacy\n\t{\n\t\tconst privacyPopup = new GroupPrivacy({\n\t\t\tprivacyCode: this.#privacyCode,\n\t\t});\n\n\t\tprivacyPopup.subscribe('onShow', () => this.emit('setAutoHide', false));\n\t\tprivacyPopup.subscribe('onAfterClose', () => this.emit('setAutoHide', true));\n\t\tprivacyPopup.subscribe('changePrivacy', this.#changePrivacy.bind(this));\n\n\t\treturn privacyPopup;\n\t}\n\n\t#showPrivacy(event)\n\t{\n\t\tthis.#privacyPopup.show(event.target);\n\t}\n\n\t#renderPrivacyText(): HTMLElement\n\t{\n\t\tthis.#layout.privacyTextNode = Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-settings_select-private-text\">\n\t\t\t\t${this.#privacyPopup.getLabel()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.privacyTextNode;\n\t}\n\n\t#renderPencilIcon(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"spaces-settings-space-info-title-edit\" \n\t\t\t\tclass=\"ui-icon-set --pencil-40\"\n\t\t\t\tstyle=\"--ui-icon-set__icon-size: 18px;\"\n\t\t\t></div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#startEditTitle.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#renderPrivacyIcon(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"ui-icon-set --chevron-down\"\n\t\t\t\tstyle=\"--ui-icon-set__icon-size: 14px;\"\n\t\t\t></div>\n\t\t`;\n\t}\n\n\t#changePrivacy(baseEvent: BaseEvent)\n\t{\n\t\tconst privacyCode: 'open' | 'closed' | 'secret' = baseEvent.getData();\n\n\t\tthis.#setPrivacy(privacyCode);\n\n\t\tController.changePrivacy(this.#groupId, privacyCode);\n\n\t\tthis.emit('changePrivacy', privacyCode);\n\t}\n\n\t#setPrivacy(privacyCode: 'open' | 'closed' | 'secret')\n\t{\n\t\tthis.#privacyCode = privacyCode;\n\t\tthis.#privacyPopup.setPrivacy(this.#privacyCode);\n\t\tthis.#layout.privacyTextNode.textContent = this.#privacyPopup.getLabel();\n\t}\n\n\t#setAvatar(avatar: string)\n\t{\n\t\tthis.#logo = {\n\t\t\tid: avatar,\n\t\t\ttype: 'image',\n\t\t};\n\t\tthis.#renderSpaceAvatar();\n\t}\n}\n","import { Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Perms, Member } from 'socialnetwork.controller';\n\ntype Params = {\n\tamount: number,\n\tlist: Array<Member>,\n\tcounters: { [key: string]: number },\n\tactions: Perms,\n}\n\ntype GroupedMembers = {\n\towner: Member,\n\tmoderators: Array<Member>,\n\tusers: Array<Member>,\n}\n\nexport class Members extends EventEmitter\n{\n\t#amount: number;\n\t#list: Array<Member>;\n\t#counters: { [key: string]: number };\n\t#actions: Perms;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.Members');\n\n\t\tthis.#amount = params.amount;\n\t\tthis.#list = params.list;\n\t\tthis.#counters = params.counters;\n\t\tthis.#actions = params.actions;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst inviteBtnId = 'spaces-settings-create-members-btn';\n\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item_expandable\">\n\t\t\t\t<div class=\"sn-spaces__popup-item --expandable\">\n\t\t\t\t\t<div class=\"sn-spaces__popup-item_icon-block\">\n\t\t\t\t\t\t<div class=\"sn-spaces__popup-item_icon\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"ui-icon-set --persons-3\"\n\t\t\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 27px;\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"sn-spaces__popup-item_main-info\">\n\t\t\t\t\t\t<div class=\"sn-spaces__popup-item_members\">\n\t\t\t\t\t\t\t<div class=\"sn-spaces__popup-item_members-info\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_MEMBERS_LABEL')}: ${parseInt(this.#amount, 10)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.#canInvite() ? this.#renderInviteBtn(inviteBtnId) : ''}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#renderList()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#canInvite() && this.#hasCounters() ? this.#renderCounters() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst inviteNode = node.querySelector(`[data-id='${inviteBtnId}']`);\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector('.--expandable'),\n\t\t\t'click',\n\t\t\t(event) => {\n\t\t\t\tif (!inviteNode || !event.target.isEqualNode(inviteNode))\n\t\t\t\t{\n\t\t\t\t\tthis.emit('showUsers', 'all');\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\treturn node;\n\t}\n\n\t#renderInviteBtn(inviteBtnId: string): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div \n\t\t\t\tdata-id=\"${inviteBtnId}\" \n\t\t\t\tclass=\"ui-popupcomponentmaker__btn --border sn----spaces__popup-settings_btn\"\n\t\t\t>\n\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_MEMBERS_INVITE_BTN')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => this.emit('invite'));\n\n\t\treturn node;\n\t}\n\n\t#renderList(): HTMLElement\n\t{\n\t\tconst groupedMembers = this.#prepareList();\n\n\t\tconst visibleAmount = 3;\n\t\tconst moderators = groupedMembers.moderators.slice(0, visibleAmount);\n\t\tconst users = groupedMembers.users.slice(0, visibleAmount);\n\n\t\tconst amount = this.#amount - (1 + moderators.length + users.length);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item_lists\">\n\t\t\t\t<div class=\"sn-spaces__popup-item_list\">\n\t\t\t\t\t${this.#renderOwner(groupedMembers.owner)}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"sn-spaces__popup-item_list\"\n\t\t\t\t\tstyle=\"${moderators.length > 0 ? '' : 'display: none;'}\"\n\t\t\t\t>\n\t\t\t\t\t${moderators.map((member: Member) => {\n\t\t\t\t\t\treturn this.#renderModerator(member);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"sn-spaces__popup-item_list\"\n\t\t\t\t\tstyle=\"${users.length > 0 ? '' : 'display: none;'}\"\n\t\t\t\t>\n\t\t\t\t\t${users.map((member: Member) => {\n\t\t\t\t\t\treturn this.#renderUser(member);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"sn-spaces__popup-item_list-quantity\"\n\t\t\t\t\tstyle=\"${amount > 0 ? '' : 'display: none;'}\"\n\t\t\t\t>+${amount}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderCounters(): HTMLElement\n\t{\n\t\tconst outCounter = parseInt(this.#counters.workgroup_requests_out, 10);\n\t\tconst inCounter = parseInt(this.#counters.workgroup_requests_in, 10);\n\n\t\tconst outId = 'spaces-settings-members-counter-out';\n\t\tconst inId = 'spaces-settings-members-counter-in';\n\n\t\tconst renderOut = () => {\n\t\t\tif (!this.#hasOutCounters())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"${outId}\" class=\"sn-spaces__popup-item --primary\">\n\t\t\t\t\t<div class=\"sn-spaces__popup-item_counter\">${outCounter}</div>\n\t\t\t\t\t<span class=\"\">${Loc.getMessage('SN_SPACES_MENU_MEMBERS_GREEN_LABEL')}</span>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --chevron-right\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 14px;\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst renderIn = () => {\n\t\t\tif (!this.#hasInCounters())\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"${inId}\" class=\"sn-spaces__popup-item --warning\">\n\t\t\t\t\t<div class=\"sn-spaces__popup-item_counter\">${inCounter}</div>\n\t\t\t\t\t<span class=\"\">${Loc.getMessage('SN_SPACES_MENU_MEMBERS_RED_LABEL')}</span>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --chevron-right\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 14px;\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\tconst node = Tag.render`\n\t\t\t<div>\n\t\t\t\t${renderOut()}\n\t\t\t\t${renderIn()}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector(`[data-id='${outId}']`),\n\t\t\t'click',\n\t\t\t() => this.emit('showUsers', 'out'),\n\t\t);\n\n\t\tEvent.bind(\n\t\t\tnode.querySelector(`[data-id='${inId}']`),\n\t\t\t'click',\n\t\t\t() => this.emit('showUsers', 'in'),\n\t\t);\n\n\t\treturn node;\n\t}\n\n\t#renderOwner(member: Member): HTMLElement\n\t{\n\t\tconst crownIconSrc = '/bitrix/components/bitrix/socialnetwork.spaces.menu/'\n\t\t\t+ 'templates/.default/images/sn-spaces__popup-icon_super-admin.svg'\n\t\t;\n\n\t\tconst uiClasses = member.photo ? '' : 'ui-icon ui-icon-common-user ui-icon-xs';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item_list-item --super-admin ${uiClasses}\">\n\t\t\t\t${this.#renderAvatar(member.photo)}\n\t\t\t\t<img src=\"${crownIconSrc}\" class=\"sn-spaces__popup-icon_svg\" alt=\"crown\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderModerator(member: Member): HTMLElement\n\t{\n\t\tconst crownIconSrc = '/bitrix/components/bitrix/socialnetwork.spaces.menu/'\n\t\t\t+ 'templates/.default/images/sn-spaces__popup-icon_admin.svg'\n\t\t;\n\n\t\tconst uiClasses = member.photo ? '' : 'ui-icon ui-icon-common-user ui-icon-xs';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item_list-item --admin ${uiClasses}\">\n\t\t\t\t${this.#renderAvatar(member.photo)}\n\t\t\t\t<img src=\"${crownIconSrc}\" class=\"sn-spaces__popup-icon_svg\" alt=\"crown\">\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderUser(member: Member): HTMLElement\n\t{\n\t\tconst uiClasses = member.photo ? '' : 'ui-icon ui-icon-common-user ui-icon-xs';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sn-spaces__popup-item_list-item ${uiClasses}\">\n\t\t\t\t${this.#renderAvatar(member.photo)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderAvatar(photo: string): HTMLElement\n\t{\n\t\tif (photo)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<i\n\t\t\t\t\tclass=\"sn-spaces__popup-item_list-item-img\"\n\t\t\t\t\tstyle=\"background-image: url('${encodeURI(photo)}');\"\n\t\t\t\t></i>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<i></i>`;\n\t}\n\n\t#prepareList(): GroupedMembers\n\t{\n\t\tconst members = {\n\t\t\towner: null,\n\t\t\tmoderators: [],\n\t\t\tusers: [],\n\t\t};\n\n\t\tthis.#list.forEach((member: Member) => {\n\t\t\tif (member.isOwner)\n\t\t\t{\n\t\t\t\tmembers.owner = member;\n\t\t\t}\n\t\t\telse if (member.isModerator)\n\t\t\t{\n\t\t\t\tmembers.moderators.push(member);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.users.push(member);\n\t\t\t}\n\t\t});\n\n\t\treturn members;\n\t}\n\n\t#canInvite(): boolean\n\t{\n\t\treturn this.#actions.canEdit || this.#actions.canInvite;\n\t}\n\n\t#hasCounters(): boolean\n\t{\n\t\tconst outCounter = parseInt(this.#counters.workgroup_requests_out, 10);\n\t\tconst inCounter = parseInt(this.#counters.workgroup_requests_in, 10);\n\n\t\treturn outCounter > 0 || inCounter > 0;\n\t}\n\n\t#hasOutCounters(): boolean\n\t{\n\t\treturn parseInt(this.#counters.workgroup_requests_out, 10) > 0;\n\t}\n\n\t#hasInCounters(): boolean\n\t{\n\t\treturn parseInt(this.#counters.workgroup_requests_in, 10) > 0;\n\t}\n}\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype Params = {\n\tpin: boolean,\n\tcanUse: boolean,\n}\n\nexport class Pin extends EventEmitter\n{\n\t#pin: boolean;\n\t#disabled: boolean;\n\t#canUse: boolean;\n\t#node: HTMLElement;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.Pin');\n\n\t\tthis.#pin = params.pin;\n\t\tthis.#canUse = params.canUse === true;\n\n\t\tthis.#disabled = false;\n\n\t\tthis.#bindEvents();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst pinId = 'spaces-settings-pin';\n\n\t\tconst iconClass = this.#pin ? '--pin-2' : '--pin-1';\n\n\t\tconst disabled = this.#canUse ? '' : '--disabled';\n\n\t\tthis.#node = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"${pinId}\"\n\t\t\t\tclass=\"sn-spaces__popup-item --mini ${disabled}\"\n\t\t\t>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set ${iconClass}\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 22px;\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round-name\">\n\t\t\t\t\t${this.#getLabel(this.#pin)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#node, 'click', this.#toggle.bind(this));\n\n\t\treturn this.#node;\n\t}\n\n\tunDisable()\n\t{\n\t\tthis.#disabled = false;\n\t}\n\n\t#toggle()\n\t{\n\t\tif (this.#disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#disabled = true;\n\n\t\tthis.#pin = !this.#pin;\n\n\t\tthis.emit('update', this.#pin);\n\n\t\tthis.#changeIcon(this.#pin);\n\n\t\tthis.#changeLabel(this.#pin);\n\t}\n\n\t#changeIcon(pin: boolean)\n\t{\n\t\tconst iconNode = this.#node.querySelector('.ui-icon-set');\n\t\tif (pin)\n\t\t{\n\t\t\tDom.removeClass(iconNode, '--pin-1');\n\t\t\tDom.addClass(iconNode, '--pin-2');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(iconNode, '--pin-2');\n\t\t\tDom.addClass(iconNode, '--pin-1');\n\t\t}\n\t}\n\n\t#changeLabel(pin: boolean)\n\t{\n\t\tconst nameNode = this.#node.querySelector('.sn-spaces__popup-icon-round-name');\n\t\tnameNode.textContent = this.#getLabel(pin);\n\t}\n\n\t#getLabel(pin: boolean): string\n\t{\n\t\treturn pin\n\t\t\t? Loc.getMessage('SN_SPACES_MENU_PIN_N')\n\t\t\t: Loc.getMessage('SN_SPACES_MENU_PIN_Y')\n\t\t;\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tEventEmitter.subscribe('pinChanged', function(event) {\n\t\t\tthis.#pin = event.data.isPinned;\n\t\t\tthis.#changeLabel(this.#pin);\n\t\t\tthis.#changeIcon(this.#pin);\n\t\t}.bind(this));\n\t}\n}","import { Event, Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype Params = {\n\tcanEdit: boolean,\n}\n\nexport class Roles extends EventEmitter\n{\n\t#canEdit: boolean;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.Settings.Roles');\n\n\t\tthis.#canEdit = params.canEdit === true;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst rolesId = 'spaces-settings-roles';\n\n\t\tconst disabled = this.#canEdit ? '' : '--disabled';\n\n\t\tconst node = Tag.render`\n\t\t\t<div\n\t\t\t\tdata-id=\"${rolesId}\"\n\t\t\t\tclass=\"sn-spaces__popup-item --mini ${disabled}\"\n\t\t\t>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --crown-1\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 22px;\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sn-spaces__popup-icon-round-name\">\n\t\t\t\t\t${Loc.getMessage('SN_SPACES_MENU_ROLES')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', () => {\n\t\t\tif (this.#canEdit)\n\t\t\t{\n\t\t\t\tthis.emit('click');\n\t\t\t}\n\t\t});\n\n\t\treturn node;\n\t}\n}\n","import { AjaxError, Cache, Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Controller, GroupData } from 'socialnetwork.controller';\nimport { LogoData } from 'socialnetwork.logo';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport { Chat } from './chat';\nimport { ChatAction } from './settings-elements/chat-action';\nimport { Follow } from './settings-elements/follow';\nimport { Info } from './settings-elements/info';\nimport { Members } from './settings-elements/members';\nimport { Pin } from './settings-elements/pin';\nimport { Roles } from './settings-elements/roles';\n\ntype Params = {\n\tbindElement: HTMLElement,\n\tgroupId: number,\n\tlogo: LogoData,\n\tchat: Chat,\n\tavailableFeatures: { [option: 'discussions' | 'tasks' | 'calendar' | 'files']: boolean },\n\tisMember?: boolean,\n}\n\nexport class GroupSettings\n{\n\t#cache = new Cache.MemoryCache();\n\n\t#menu: PopupComponentsMaker;\n\t#info: Info;\n\t#groupData: GroupData;\n\t#groupSettings;\n\n\t#layout = {\n\t\tmembers: null,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#setParams(params);\n\n\t\tthis.#menu = this.#createMenu();\n\t}\n\n\tshow()\n\t{\n\t\tthis.#menu.show();\n\t\tthis.#adjustPopup();\n\t}\n\n\tupdate(groupDataPromise: Promise)\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tgroupDataPromise.then((groupData: GroupData) => {\n\t\t\tthis.#groupData = groupData;\n\t\t\tthis.#info.update(groupData);\n\t\t});\n\n\t\tthis.#renderMembers(groupDataPromise);\n\t}\n\n\t#adjustPopup()\n\t{\n\t\tconst popup = this.#menu.getPopup();\n\t\tconst popupContainer = popup.getPopupContainer();\n\t\tconst popupRect = popupContainer.getBoundingClientRect();\n\n\t\tif (Math.abs(popupRect.right - popup.bindElement.getBoundingClientRect().right) >= 2)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst left = popupRect.left;\n\t\tconst leftAdjusted = popupRect.right + 20 - popupRect.width;\n\n\t\tconst angleContainer = popup.angle.element;\n\n\t\tDom.style(popupContainer, 'left', `${leftAdjusted}px`);\n\t\tDom.style(\n\t\t\tangleContainer,\n\t\t\t'left',\n\t\t\t`${parseInt(Dom.style(angleContainer, 'left'), 10) - (leftAdjusted - left)}px`,\n\t\t);\n\t}\n\n\t#setParams(params: Params)\n\t{\n\t\tthis.#cache.set('params', params);\n\t}\n\n\t#getParam(param: string): any\n\t{\n\t\treturn this.#cache.get('params')[param];\n\t}\n\n\t#createMenu(): PopupComponentsMaker\n\t{\n\t\tconst groupDataPromise = Controller.getGroupData(\n\t\t\tthis.#getParam('groupId'),\n\t\t\t[\n\t\t\t\t'AVATAR',\n\t\t\t\t'ACTIONS',\n\t\t\t\t'NUMBER_OF_MEMBERS',\n\t\t\t\t'LIST_OF_MEMBERS',\n\t\t\t\t'GROUP_MEMBERS_LIST',\n\t\t\t\t'PRIVACY_TYPE',\n\t\t\t\t'PIN',\n\t\t\t\t'USER_DATA',\n\t\t\t\t'COUNTERS',\n\t\t\t\t'DESCRIPTION',\n\t\t\t\t'EFFICIENCY',\n\t\t\t\t'SUBJECT_DATA',\n\t\t\t\t'DATE_CREATE',\n\t\t\t],\n\t\t);\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tgroupDataPromise.then((groupData: GroupData) => {\n\t\t\tthis.#groupData = groupData;\n\t\t});\n\n\t\treturn new PopupComponentsMaker({\n\t\t\tid: 'spaces-settings-menu',\n\t\t\ttarget: this.#getParam('bindElement'),\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderInfo(groupDataPromise),\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderChat(),\n\t\t\t\t\t\t\twithoutBackground: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderMembers(groupDataPromise),\n\t\t\t\t\t\t\twithoutBackground: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderFollow(groupDataPromise),\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderPin(groupDataPromise),\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: this.#renderRoles(groupDataPromise),\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t}\n\n\t#renderInfo(groupDataPromise: Promise): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tgroupDataPromise\n\t\t\t\t.then((groupData: GroupData) => {\n\t\t\t\t\tthis.#info = new Info({\n\t\t\t\t\t\tgroupId: groupData.id,\n\t\t\t\t\t\ttitle: groupData.name,\n\t\t\t\t\t\tlogo: this.#getParam('logo'),\n\t\t\t\t\t\tprivacyCode: groupData.privacyCode,\n\t\t\t\t\t\tactions: groupData.actions,\n\t\t\t\t\t});\n\t\t\t\t\tthis.#info.subscribe('setAutoHide', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tthis.#menu.getPopup().setAutoHide(baseEvent.getData());\n\t\t\t\t\t});\n\t\t\t\t\tthis.#info.subscribe('more', this.#openSettingsSlider.bind(this));\n\n\t\t\t\t\tresolve(this.#info.render());\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#renderChat(): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst chat = new ChatAction({\n\t\t\t\tcanUse: this.#getParam('isMember'),\n\t\t\t});\n\n\t\t\tchat.subscribe('videoCall', () => {\n\t\t\t\tthis.#menu.close();\n\t\t\t\tthis.#getParam('chat').startVideoCall();\n\t\t\t});\n\t\t\tchat.subscribe('openChat', () => {\n\t\t\t\tthis.#menu.close();\n\t\t\t\tthis.#getParam('chat').openChat();\n\t\t\t});\n\t\t\tchat.subscribe('createChat', () => {\n\t\t\t\tthis.#menu.close();\n\t\t\t\tthis.#getParam('chat').createChat(this.#getParam('bindElement'));\n\t\t\t});\n\n\t\t\tresolve({\n\t\t\t\tnode: chat.render(),\n\t\t\t\toptions: {\n\t\t\t\t\tdisabled: !this.#getParam('isMember'),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#renderMembers(groupDataPromise: Promise): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tgroupDataPromise\n\t\t\t\t.then((groupData: GroupData) => {\n\t\t\t\t\tconst members = new Members({\n\t\t\t\t\t\tamount: groupData.numberOfMembers,\n\t\t\t\t\t\tlist: groupData.listOfMembers,\n\t\t\t\t\t\tcounters: groupData.counters,\n\t\t\t\t\t\tactions: groupData.actions,\n\t\t\t\t\t});\n\t\t\t\t\tmembers.subscribe('showUsers', (baseEvent: BaseEvent<'all' | 'in' | 'out'>) => {\n\t\t\t\t\t\tthis.#menu.close();\n\t\t\t\t\t\tController.openGroupUsers(baseEvent.getData());\n\t\t\t\t\t});\n\t\t\t\t\tmembers.subscribe('invite', () => {\n\t\t\t\t\t\tthis.#menu.close();\n\t\t\t\t\t\tController.openGroupInvite();\n\t\t\t\t\t});\n\n\t\t\t\t\tconst layoutMembers = members.render();\n\t\t\t\t\tif (this.#layout.members)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#layout.members.replaceWith(layoutMembers);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.#layout.members = layoutMembers;\n\n\t\t\t\t\tresolve(this.#layout.members);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#renderFollow(groupDataPromise: Promise): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tgroupDataPromise\n\t\t\t\t.then((groupData: GroupData) => {\n\t\t\t\t\tconst follow = new Follow({\n\t\t\t\t\t\tfollow: groupData.isSubscribed,\n\t\t\t\t\t\tcanUse: this.#getParam('isMember'),\n\t\t\t\t\t});\n\n\t\t\t\t\tfollow.subscribe('update', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tthis.#changeSubscribe(this.#groupData.id, baseEvent.getData(), follow);\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tnode: follow.render(),\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tdisabled: !this.#getParam('isMember'),\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#renderPin(groupDataPromise: Promise): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tgroupDataPromise\n\t\t\t\t.then((groupData: GroupData) => {\n\t\t\t\t\tconst pin = new Pin({\n\t\t\t\t\t\tpin: groupData.isPin,\n\t\t\t\t\t\tcanUse: this.#getParam('isMember'),\n\t\t\t\t\t});\n\n\t\t\t\t\tpin.subscribe('update', (baseEvent: BaseEvent) => {\n\t\t\t\t\t\tthis.#changePin(this.#groupData.id, baseEvent.getData(), pin);\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tnode: pin.render(),\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tdisabled: !this.#getParam('isMember'),\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#renderRoles(groupDataPromise: Promise): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tgroupDataPromise\n\t\t\t\t.then((groupData: GroupData) => {\n\t\t\t\t\tconst roles = new Roles({\n\t\t\t\t\t\tcanEdit: groupData.actions.canEditFeatures,\n\t\t\t\t\t});\n\n\t\t\t\t\troles.subscribe('click', () => {\n\t\t\t\t\t\tthis.#menu.close();\n\t\t\t\t\t\tController.openGroupFeatures();\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tnode: roles.render(),\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tdisabled: !groupData.actions.canEditFeatures,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\t#changeSubscribe(groupId: number, isSubscribed: boolean, follow: Follow)\n\t{\n\t\tController.setSubscription(groupId, isSubscribed).then(() => {\n\t\t\tfollow?.unDisable();\n\t\t}).catch((error: AjaxError) => {\n\t\t\tfollow?.unDisable();\n\n\t\t\tthis.#consoleError('changeSubscribe', error);\n\t\t});\n\t}\n\n\t#changePin(groupId: number, isPinned: boolean, pin: Pin)\n\t{\n\t\tController.changePin(groupId, isPinned).then(() => {\n\t\t\tpin?.unDisable();\n\t\t}).catch((error: AjaxError) => {\n\t\t\tpin?.unDisable();\n\n\t\t\tthis.#consoleError('changePin', error);\n\t\t});\n\t}\n\n\tasync #openSettingsSlider(): void\n\t{\n\t\t(await this.#getGroupSettings()).openInSlider();\n\t\tthis.#menu.close();\n\t}\n\n\tasync #getGroupSettings(): Promise\n\t{\n\t\tthis.#groupSettings ??= await this.#createGroupSettings();\n\n\t\treturn this.#groupSettings;\n\t}\n\n\tasync #createGroupSettings(): Promise\n\t{\n\t\tconst { GroupSettings } = await top.BX.Runtime.loadExtension('socialnetwork.group-settings');\n\n\t\treturn new GroupSettings({\n\t\t\tgroupData: this.#groupData,\n\t\t\tlogo: this.#getParam('logo'),\n\t\t});\n\t}\n\n\t#consoleError(action: string, error: AjaxError)\n\t{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(`GroupSettings: ${action} error`, error);\n\t}\n}\n","import { Cache } from 'main.core';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\n\ntype Params = {\n\tbindElement: HTMLElement,\n\tuserId: number,\n}\n\nexport class UserSettings\n{\n\t#cache = new Cache.MemoryCache();\n\n\t#menu: PopupComponentsMaker;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#setParams(params);\n\t}\n\n\tshow()\n\t{\n\n\t}\n\n\t#setParams(params: Params)\n\t{\n\t\tthis.#cache.set('params', params);\n\t}\n\n\t#getParam(param: string): any\n\t{\n\t\treturn this.#cache.get('params')[param];\n\t}\n}\n","import { Cache } from 'main.core';\nimport { Chat } from './chat';\nimport { GroupSettings } from './group-settings';\nimport { UserSettings } from './user-settings';\nimport type { LogoData } from 'socialnetwork.logo';\n\ntype Params = {\n\tbindElement: HTMLElement,\n\ttype: 'group' | 'user',\n\tentityId: number,\n\tlogo?: LogoData,\n\tchat: Chat,\n\tavailableFeatures: { [option: 'discussions' | 'tasks' | 'calendar' | 'files']: boolean },\n\tisMember?: boolean,\n}\n\nimport './css/settings.css';\n\nexport class Settings\n{\n\t#cache = new Cache.MemoryCache();\n\n\t#settings: UserSettings | GroupSettings;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#setParams(params);\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#settings)\n\t\t{\n\t\t\tif (this.#getParam('type') === 'user')\n\t\t\t{\n\t\t\t\tthis.#settings = new UserSettings({\n\t\t\t\t\tbindElement: this.#getParam('bindElement'),\n\t\t\t\t\tuserId: this.#getParam('entityId'),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#settings = new GroupSettings({\n\t\t\t\t\tbindElement: this.#getParam('bindElement'),\n\t\t\t\t\tavailableFeatures: this.#getParam('availableFeatures'),\n\t\t\t\t\tisMember: this.#getParam('isMember'),\n\t\t\t\t\tgroupId: this.#getParam('entityId'),\n\t\t\t\t\tlogo: this.#getParam('logo'),\n\t\t\t\t\tchat: this.#getParam('chat'),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#settings.show();\n\t}\n\n\tupdate(groupDataPromise: Promise)\n\t{\n\t\tthis.#settings?.update(groupDataPromise);\n\t}\n\n\t#setParams(params: Params)\n\t{\n\t\tthis.#cache.set('params', params);\n\t}\n\n\t#getParam(param: string): any\n\t{\n\t\treturn this.#cache.get('params')[param];\n\t}\n}\n","import { Dom, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu } from 'main.popup';\n\ntype Params = {\n\tbindElement: HTMLElement,\n}\n\nexport class VideoCall extends EventEmitter\n{\n\t#menu: Menu;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Spaces.VideoCall');\n\n\t\tthis.#menu = this.#createMenu(params.bindElement);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#menu.toggle();\n\t}\n\n\t#createMenu(bindElement: HTMLElement): Menu\n\t{\n\t\tconst menu = new Menu({\n\t\t\tid: 'spaces-video-call-menu',\n\t\t\tbindElement,\n\t\t\tcloseByEsc: true,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset: 31,\n\t\t\t},\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\tdataset: { id: 'spaces-menu-video-call-hd' },\n\t\t\ttext: Loc.getMessage('SN_SPACES_MENU_VIDEO_CALL_HD'),\n\t\t\tclassName: 'sn-spaces-menu-video-call-hd-icon',\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit('hd');\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\tdelimiter: true,\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\tdataset: { id: 'spaces-menu-video-call-chat' },\n\t\t\ttext: Loc.getMessage('SN_SPACES_MENU_VIDEO_CALL_CHAT'),\n\t\t\tclassName: 'sn-spaces-menu-video-call-chat-icon',\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit('chat');\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\n\t\tmenu.addMenuItem({\n\t\t\tdataset: { id: 'spaces-menu-create-chat' },\n\t\t\ttext: Loc.getMessage('SN_SPACES_MENU_CREATE_CHAT'),\n\t\t\tclassName: 'sn-spaces-menu-create-chat-icon',\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit('createChat');\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\n\t\treturn menu;\n\t}\n}\n","import { Loc, Dom, Type, Tag, Event, Cache, Runtime, Uri } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { PULL as Pull } from 'pull.client';\nimport { Meetings } from 'tasks.scrum.meetings';\nimport { Methodology } from 'tasks.scrum.methodology';\nimport { PullRequests } from './pull-requests';\nimport { Chat } from './chat';\nimport { Invite } from './invite';\nimport { Logo, LogoData } from 'socialnetwork.logo';\nimport { Settings } from './settings';\nimport { VideoCall } from './video-call';\nimport { Controller } from 'socialnetwork.controller';\n\nimport type { GroupData } from 'socialnetwork.group-settings';\n\nimport './css/menu.css';\n\ntype Params = {\n\ttype: 'group' | 'user',\n\tentityId?: number,\n\tcurrentUserId: number,\n\tgroupMembersList: any,\n\tlogo?: LogoData,\n\tpathToFeatures?: string,\n\tpathToDiscussions?: string,\n\tpathToUsers?: string,\n\tpathToInvite?: string,\n\tpathToScrumTeamSpeed?: string,\n\tpathToScrumBurnDown?: string,\n\tpathToGroupTasksTask?: string,\n\tcanInvite: boolean,\n\tavailableFeatures: { [option: 'discussions' | 'tasks' | 'calendar' | 'files']: boolean },\n\tisNew?: boolean,\n\tisMember?: boolean,\n};\n\nexport class Menu\n{\n\t#cache = new Cache.MemoryCache();\n\n\t#videoCall: ?VideoCall;\n\t#scrumMeetings: ?Meetings;\n\t#scrumMethodology: ?Methodology;\n\t#invite: ?Invite;\n\t#layout: {\n\t\tavatar: HTMLElement,\n\t\tinviteNode: HTMLElement,\n\t};\n\n\t#logo: LogoData;\n\t#settings: ?Settings;\n\t#pathToDiscussions: string;\n\n\t#chat: Chat;\n\t#discussionAhaMomentShown = false;\n\n\t#groupInvitedList: any = [];\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#layout = {};\n\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tparams.entityId = Type.isUndefined(params.entityId) ? 0 : parseInt(params.entityId, 10);\n\n\t\tthis.#setParams(params);\n\n\t\tthis.#initServices(params);\n\n\t\tthis.#subscribeToPull();\n\t}\n\n\trenderLogoTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('BX.Socialnetwork.Spaces.Menu: HTMLElement for space not found');\n\t\t}\n\n\t\tthis.#layout.avatar = container;\n\t\tthis.#renderSpaceAvatar();\n\t}\n\n\trenderUserLogoTo(container: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\tthrow new Error('BX.Socialnetwork.Spaces.Menu: HTMLElement for space not found');\n\t\t}\n\n\t\tDom.addClass(\n\t\t\tcontainer,\n\t\t\t[\n\t\t\t\t'sonet-common-workgroup-avatar',\n\t\t\t\t'--common-space',\n\t\t\t],\n\t\t);\n\n\t\tDom.append(Tag.render`<i></i>`, container);\n\t}\n\n\trenderToolbarTo(container: HTMLElement)\n\t{\n\t\tif (this.#getParam('isMember'))\n\t\t{\n\t\t\tDom.append(this.#renderVideoCall(), container);\n\t\t}\n\n\t\tif (this.#getParam('canInvite'))\n\t\t{\n\t\t\tDom.append(this.#renderInvite(), container);\n\t\t}\n\n\t\tDom.append(this.#renderSettings(), container);\n\t}\n\n\trenderScrumToolbarTo(container: HTMLElement)\n\t{\n\t\tconst availableFeatures = this.#getParam('availableFeatures');\n\n\t\tif (\n\t\t\tthis.#getParam('isMember')\n\t\t\t&& availableFeatures.tasks\n\t\t\t&& availableFeatures.calendar\n\t\t)\n\t\t{\n\t\t\tDom.append(this.#renderScrumVideoCall(), container);\n\t\t}\n\n\t\tif (availableFeatures.tasks)\n\t\t{\n\t\t\tDom.append(this.#renderScrumElements(), container);\n\t\t}\n\n\t\tif (this.#getParam('canInvite'))\n\t\t{\n\t\t\tDom.append(this.#renderInvite(), container);\n\t\t}\n\n\t\tDom.append(this.#renderSettings(), container);\n\t}\n\n\trenderUserToolbarTo(container: HTMLElement)\n\t{\n\t\tDom.append(this.#renderUserVideoCall(), container);\n\t\tDom.append(this.#renderUserSettings(), container);\n\t}\n\n\t#subscribeToPull()\n\t{\n\t\tconst pullRequests = new PullRequests(\n\t\t\tthis.#getParam('entityId'),\n\t\t\tthis.#getParam('currentUserId'),\n\t\t);\n\t\tpullRequests.subscribe('update', this.#update.bind(this));\n\t\tpullRequests.subscribe('updateCounters', this.#updateCounters.bind(this));\n\t\tpullRequests.subscribe('updateMenuItem', this.#updateMenuItem.bind(this));\n\n\t\tPull.subscribe(pullRequests);\n\t}\n\n\t#update()\n\t{\n\t\tconst groupDataPromise = Controller.getGroupData(\n\t\t\tthis.#getParam('entityId'),\n\t\t\t[\n\t\t\t\t'AVATAR',\n\t\t\t\t'ACTIONS',\n\t\t\t\t'NUMBER_OF_MEMBERS',\n\t\t\t\t'LIST_OF_MEMBERS',\n\t\t\t\t'GROUP_MEMBERS_LIST',\n\t\t\t\t'PRIVACY_TYPE',\n\t\t\t\t'PIN',\n\t\t\t\t'USER_DATA',\n\t\t\t\t'COUNTERS',\n\t\t\t\t'DESCRIPTION',\n\t\t\t\t'EFFICIENCY',\n\t\t\t\t'SUBJECT_DATA',\n\t\t\t\t'DATE_CREATE',\n\t\t\t],\n\t\t);\n\t\tthis.#settings?.update(groupDataPromise);\n\t\tthis.#getInvite().update(groupDataPromise);\n\t\tthis.#chat.update(groupDataPromise);\n\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tgroupDataPromise.then((groupData: GroupData) => {\n\t\t\tconst { avatar } = groupData;\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tthis.#setAvatar(avatar);\n\t\t\t}\n\t\t});\n\t}\n\n\t#updateCounters(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tif (Type.isUndefined(data.space))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst userId = data.userId;\n\t\tconst spaceId = parseInt(data.space.id, 10);\n\n\t\tconst tasksTotal = data.space.metrics.countersTasksTotal;\n\t\tconst calendarTotal = data.space.metrics.countersCalendarTotal;\n\t\tconst discussionsTotal = data.space.metrics.countersLiveFeedTotal;\n\n\t\tconst menu = (spaceId === 0)\n\t\t\t? BX.Main.interfaceButtonsManager.getById(`spaces_user_menu_${userId}`)\n\t\t\t: BX.Main.interfaceButtonsManager.getById(`spaces_group_menu_${spaceId}`)\n\t\t;\n\n\t\tif (menu)\n\t\t{\n\t\t\tconst btn = `spaces_top_menu_${userId}_${spaceId}`;\n\t\t\tconst tasksBtn = `${btn}_tasks`;\n\t\t\tconst calendarBtn = `${btn}_calendar`;\n\t\t\tconst discussionBtn = `${btn}_discussions`;\n\n\t\t\tmenu.updateCounter(tasksBtn, tasksTotal);\n\t\t\tmenu.updateCounter(calendarBtn, calendarTotal);\n\t\t\tmenu.updateCounter(discussionBtn, discussionsTotal);\n\t\t}\n\t}\n\n\t#updateMenuItem(baseEvent: BaseEvent)\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tif (Type.isUndefined(data.FEATURE))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst feature = data.FEATURE;\n\t\tconst spaceId = parseInt(data.GROUP_ID, 10);\n\n\t\tif (!spaceId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst featureName = feature.featureName;\n\t\tconst featureId = `spaces_group_menu_${spaceId}_${featureName}`;\n\t\tconst menu = BX.Main.interfaceButtonsManager.getById(`spaces_group_menu_${spaceId}`);\n\t\tconst menuItem = menu.getItemById(featureId);\n\n\t\tif (data.ACTION === 'add')\n\t\t{\n\t\t\tconst itemMenuData = this.#prepareData(baseEvent);\n\t\t\tmenu.addMenuItem(itemMenuData);\n\t\t}\n\n\t\tif (data.ACTION === 'delete')\n\t\t{\n\t\t\tconst activeItem = menu.getActive();\n\n\t\t\tif (activeItem.DATA_ID === featureName)\n\t\t\t{\n\t\t\t\tconst uri = new Uri(this.#pathToDiscussions);\n\t\t\t\ttop.BX.Socialnetwork.Spaces.space.reloadPageContent(uri.toString());\n\t\t\t}\n\n\t\t\tmenu.deleteMenuItem(menuItem);\n\t\t}\n\n\t\tif (data.ACTION === 'change')\n\t\t{\n\t\t\tconst featureText = feature.customName ?? feature.name;\n\t\t\tmenu.updateMenuItemText(menuItem, featureText);\n\t\t}\n\t}\n\n\t#prepareData(baseEvent: BaseEvent): Object\n\t{\n\t\tconst data = baseEvent.getData();\n\t\tif (Type.isUndefined(data.FEATURE))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst feature = data.FEATURE;\n\t\tconst spaceId = parseInt(data.GROUP_ID, 10);\n\t\tconst featureName = feature.featureName;\n\t\tconst featureId = `spaces_group_menu_${spaceId}_${featureName}`;\n\t\tlet name = feature.name;\n\n\t\tif (feature.customName)\n\t\t{\n\t\t\tname = feature.customName.length > 0 ? feature.customName : feature.name;\n\t\t}\n\n\t\treturn {\n\t\t\tcounterId: featureId,\n\t\t\tdataId: featureName,\n\t\t\tid: featureId,\n\t\t\tonClick: `top.BX.Socialnetwork.Spaces.space.reloadPageContent(\"/spaces/group/${spaceId}/${featureName}/\");`,\n\t\t\ttext: name,\n\t\t\turl: '',\n\t\t};\n\t}\n\n\t#setAvatar(avatar: string)\n\t{\n\t\tthis.#logo = {\n\t\t\tid: avatar,\n\t\t\ttype: 'image',\n\t\t};\n\t\tthis.#renderSpaceAvatar();\n\t}\n\n\t#setParams(params: Params)\n\t{\n\t\tthis.#cache.set('params', params);\n\n\t\tif (params.groupMembersList)\n\t\t{\n\t\t\tthis.#groupInvitedList = params.groupMembersList\n\t\t\t\t.filter((user) => user.invited)\n\t\t\t\t.map((user) => parseInt(user.id, 10))\n\t\t\t;\n\t\t}\n\n\t\tthis.#logo = params.logo;\n\t\tthis.#pathToDiscussions = params.pathToDiscussions;\n\t}\n\n\t#initServices(params: Params)\n\t{\n\t\tthis.#chat = new Chat({\n\t\t\tentityType: this.#getParam('type'),\n\t\t\tentityId: this.#getParam('entityId'),\n\t\t\tgroupMembersList: this.#getParam('groupMembersList'),\n\t\t});\n\t}\n\n\t#getParam(param: string): any\n\t{\n\t\treturn this.#cache.get('params')[param];\n\t}\n\n\t#renderSpaceAvatar(): HTMLElement\n\t{\n\t\tconst logo = new Logo(this.#logo);\n\n\t\tconst avatarNode = Tag.render`\n\t\t\t<div class=\"sn-spaces__space-logo ${logo.getClass() ?? ''}\">\n\t\t\t\t${logo.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.avatar.replaceWith(avatarNode);\n\t\tthis.#layout.avatar = avatarNode;\n\n\t\treturn this.#layout.avatar;\n\t}\n\n\t#renderVideoCall(): HTMLElement\n\t{\n\t\tconst { node, chevronDown } = Tag.render`\n\t\t\t<div\n\t\t\t\tref=\"node\"\n\t\t\t\tdata-id=\"spaces-video-call-menu\"\n\t\t\t\tclass=\"sn-spaces__menu-toolbar_btn\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --video-1\"></div>\n\t\t\t\t<div\n\t\t\t\t\tref=\"chevronDown\"\n\t\t\t\t\tclass=\"ui-icon-set --chevron-down\"\n\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 14px;\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#videoCallClick.bind(this, chevronDown));\n\n\t\treturn node;\n\t}\n\n\t#renderScrumVideoCall(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div data-id=\"spaces-scrum-video-call-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t<div class=\"ui-icon-set --video-1\"></div>\n\t\t\t\t<div class=\"ui-icon-set --chevron-down\" style=\"--ui-icon-set__icon-size: 14px;\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#scrumVideoCallClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#renderScrumElements(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div data-id=\"spaces-scrum-elements-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t<div class=\"ui-icon-set --elements\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#scrumElementsClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#renderUserVideoCall(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div data-id=\"spaces-video-call-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t<div class=\"ui-icon-set --video-1\"></div>\n\t\t\t\t<div class=\"ui-icon-set --chevron-down\" style=\"--ui-icon-set__icon-size: 14px;\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#userVideoCallClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#renderInvite(): HTMLElement\n\t{\n\t\tif (!this.#layout.inviteNode)\n\t\t{\n\t\t\tthis.#layout.inviteNode = Tag.render`\n\t\t\t\t<div data-id=\"spaces-invite-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t\t<div class=\"ui-icon-set --person-plus\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.inviteNode, 'click', this.#inviteClick.bind(this));\n\n\t\t\tif (this.#getParam('isNew'))\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.#showSpotlight(this.#layout.inviteNode), 500);\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.inviteNode;\n\t}\n\n\t#renderSettings(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div data-id=\"spaces-settings-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t<div class=\"ui-icon-set --more\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#settingsClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#renderUserSettings(): HTMLElement\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div data-id=\"spaces-settings-menu\" class=\"sn-spaces__menu-toolbar_btn\">\n\t\t\t\t<div class=\"ui-icon-set --more\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(node, 'click', this.#userSettingsClick.bind(this));\n\n\t\treturn node;\n\t}\n\n\t#videoCallClick(bindElement: HTMLElement)\n\t{\n\t\tif (!this.#videoCall)\n\t\t{\n\t\t\tthis.#videoCall = new VideoCall({\n\t\t\t\tbindElement: bindElement,\n\t\t\t});\n\t\t\tthis.#videoCall.subscribe('hd', () => {\n\t\t\t\tthis.#chat.startVideoCall();\n\t\t\t});\n\t\t\tthis.#videoCall.subscribe('chat', () => {\n\t\t\t\tthis.#chat.openChat();\n\t\t\t});\n\t\t\tthis.#videoCall.subscribe('createChat', () => {\n\t\t\t\tthis.#chat.createChat(bindElement);\n\t\t\t});\n\t\t}\n\n\t\tthis.#videoCall.show();\n\t}\n\n\t#scrumVideoCallClick(event)\n\t{\n\t\tif (!this.#scrumMeetings)\n\t\t{\n\t\t\tthis.#scrumMeetings = new Meetings({\n\t\t\t\tgroupId: this.#getParam('entityId'),\n\t\t\t});\n\t\t}\n\n\t\tthis.#scrumMeetings.showMenu(event.target);\n\t}\n\n\t#scrumElementsClick(event)\n\t{\n\t\tif (!this.#scrumMethodology)\n\t\t{\n\t\t\tthis.#scrumMethodology = new Methodology({\n\t\t\t\tgroupId: this.#getParam('entityId'),\n\t\t\t\tteamSpeedPath: this.#getParam('pathToScrumTeamSpeed'),\n\t\t\t\tburnDownPath: this.#getParam('pathToScrumBurnDown'),\n\t\t\t\tpathToTask: this.#getParam('pathToGroupTasksTask'),\n\t\t\t});\n\t\t}\n\n\t\tthis.#scrumMethodology.showMenu(event.target);\n\t}\n\n\t#userVideoCallClick(event)\n\t{\n\n\t}\n\n\t#inviteClick()\n\t{\n\t\tconst invite = this.#getInvite();\n\n\t\tif (invite.isShown())\n\t\t{\n\t\t\tinvite.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinvite.show();\n\t\t}\n\t}\n\n\t#getInvite(): Invite\n\t{\n\t\tif (!this.#invite)\n\t\t{\n\t\t\tthis.#invite = new Invite({\n\t\t\t\tnode: this.#layout.inviteNode,\n\t\t\t\tgroupMembersList: this.#getParam('groupMembersList'),\n\t\t\t});\n\n\t\t\tthis.#invite.subscribe('onClose', this.#onInviteClose.bind(this));\n\t\t\tthis.#invite.subscribe('usersSelected', this.#onUsersSelected.bind(this));\n\t\t}\n\n\t\treturn this.#invite;\n\t}\n\n\t#onUsersSelected(event)\n\t{\n\t\tconst users = event.data;\n\t\tthis.#inviteUsers(users);\n\t}\n\n\t#onInviteClose()\n\t{\n\t\tif (this.#getParam('isNew') && !this.#discussionAhaMomentShown)\n\t\t{\n\t\t\tconst startDiscussionButton = document.querySelector('[data-id=spaces-discussions-add-main-btn]');\n\t\t\tif (!startDiscussionButton)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#showSpotlight(startDiscussionButton, {\n\t\t\t\ttitle: Loc.getMessage('SN_SPACES_DISCUSSION_AHA_MOMENT_TITLE'),\n\t\t\t\ttext: Loc.getMessage('SN_SPACES_DISCUSSION_AHA_MOMENT_TEXT'),\n\t\t\t});\n\n\t\t\tthis.#discussionAhaMomentShown = true;\n\t\t}\n\t}\n\n\t#showSpotlight(node, ahaMoment = null)\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tRuntime.loadExtension(['spotlight', 'ui.tour']).then(() => {\n\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\ttargetElement: node,\n\t\t\t\ttargetVertex: 'middle-center',\n\t\t\t});\n\n\t\t\tDom.addClass(node, '--active');\n\t\t\tspotlight.bindEvents({\n\t\t\t\tonTargetEnter: () => {\n\t\t\t\t\tDom.removeClass(node, '--active');\n\t\t\t\t\tspotlight.close();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tspotlight.setColor('#2fc6f6');\n\t\t\tspotlight.show();\n\n\t\t\tif (ahaMoment)\n\t\t\t{\n\t\t\t\tthis.#showAhaMoment(node, {\n\t\t\t\t\ttitle: ahaMoment.title,\n\t\t\t\t\ttext: ahaMoment.text,\n\t\t\t\t\tspotlight,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tasync #showAhaMoment(node, params): void\n\t{\n\t\tconst { Guide } = await Runtime.loadExtension('ui.tour');\n\n\t\tconst guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: node,\n\t\t\t\t\ttitle: params.title,\n\t\t\t\t\ttext: params.text,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tguide.showNextStep();\n\n\t\tconst guidePopup = guide.getPopup();\n\t\tguidePopup.setWidth(380);\n\t\tguidePopup.getContentContainer().style.paddingRight = getComputedStyle(guidePopup.closeIcon)['width'];\n\t\tguidePopup.setAngle({ offset: node.offsetWidth / 2 - 5 });\n\t\tguidePopup.subscribe('onClose', () => params.spotlight.close());\n\t\tguidePopup.subscribe('onDestroy', () => params.spotlight.close());\n\t\tguidePopup.setAutoHide(true);\n\t}\n\n\t#inviteUsers(users)\n\t{\n\t\tconst invited = users.filter((userId) => !this.#groupInvitedList.includes(userId));\n\t\tconst removed = this.#groupInvitedList.filter((userId) => !users.includes(userId));\n\t\tthis.#groupInvitedList = users;\n\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tController.inviteUsers(this.#getParam('entityId'), users).then(\n\t\t\t() => {\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.#getInvitationMessage(invited, removed),\n\t\t\t\t});\n\t\t\t},\n\t\t\t(error) => console.log(error),\n\t\t);\n\t}\n\n\t#getInvitationMessage(invited, removed)\n\t{\n\t\tconst hasInvited = invited.length > 0;\n\t\tconst hasRemoved = removed.length > 0;\n\n\t\tif (hasInvited && !hasRemoved)\n\t\t{\n\t\t\treturn Loc.getMessage('SN_SPACES_INVITATIONS_SENT');\n\t\t}\n\n\t\tif (!hasInvited && hasRemoved)\n\t\t{\n\t\t\treturn Loc.getMessage('SN_SPACES_INVITATIONS_REMOVED');\n\t\t}\n\n\t\tif (hasInvited && hasRemoved)\n\t\t{\n\t\t\treturn Loc.getMessage('SN_SPACES_INVITATIONS_CHANGED');\n\t\t}\n\n\t\treturn Loc.getMessage('SN_SPACES_INVITATIONS_SENT');\n\t}\n\n\t#settingsClick(event)\n\t{\n\t\tif (!this.#settings)\n\t\t{\n\t\t\tthis.#settings = new Settings({\n\t\t\t\tbindElement: event.target,\n\t\t\t\tavailableFeatures: this.#getParam('availableFeatures'),\n\t\t\t\tisMember: this.#getParam('isMember'),\n\t\t\t\ttype: this.#getParam('type'),\n\t\t\t\tentityId: this.#getParam('entityId'),\n\t\t\t\tlogo: this.#logo,\n\t\t\t\tchat: this.#chat,\n\t\t\t});\n\t\t}\n\n\t\tthis.#settings.show();\n\t}\n\n\t#userSettingsClick(event)\n\t{\n\n\t}\n}\n"],"names":["PullRequests","entityId","currentUserId","setEventNamespace","parseInt","workgroup_user_add","bind","workgroup_user_delete","workgroup_user_update","workgroup_update","user_spaces_counter","space_feature_change","EventEmitter","data","params","GROUP_ID","emit","userId","space","spaces","find","id","metrics","countersTasksTotal","countersCalendarTotal","countersLiveFeedTotal","USER_ID","CreateChatFooter","dialog","options","_classPrivateFieldInitSpec","createChatButton","cancelButton","handleDialogDestroy","handleSelectedItemsUpdated","bindEvents","containerClass","Tag","render","renderCreateChatButton","renderCancelButton","Button","text","Loc","getMessage","round","color","ButtonColor","PRIMARY","size","ButtonSize","SMALL","events","click","createChatButtonClickHandler","setDisabled","getContainer","userIds","getDialog","getSelectedItems","map","item","getId","setWaiting","createChatAction","then","response","chatId","Runtime","loadExtension","Messenger","openChat","deselectAll","hide","BX","ajax","runAction","LIGHT_BORDER","cancelButtonClickHandler","subscribe","unsubscribe","length","unbindEvents","DefaultFooter","UserSelector","_classPrivateMethodInitSpec","bindElement","title","preselectedItems","onClose","onLoad","groupId","createChat","UserSelectorDialogHeader","BaseHeader","Dialog","targetNode","width","dropdownMode","header","enableSearch","context","entities","substituteEntityId","footerInviteIntranetOnly","showInvitationFooter","projectId","searchTabOptions","stubOptions","subtitle","onHide","setFooter","_classPrivateMethodGet","loadState","load","event","slider","target","Dom","style","getZindex","entitySelectorId","document","getElementById","Chat","entityType","groupMembersList","analyticsLabel","entity","startVideoCall","chatLockCounter","errors","code","node","show","userSelector","groupDataPromise","reload","membersIds","filter","user","isMember","getItems","forEach","isHidden","includes","setHidden","isSelected","deselect","Invite","getDialogPopup","isShown","getPopup","setAngle","position","offset","offsetWidth","getComputedStyle","marginLeft","users","arr1","arr2","sort","toString","isNotInInvited","invited","ChatAction","canUse","videoCallId","openChatId","createChatId","disabled","Event","querySelector","Follow","follow","followId","iconClass","iconNode","removeClass","addClass","nameNode","textContent","isFollowed","Info","logo","privacyCode","actions","groupData","name","avatar","wrapNode","moreButtonNode","Logo","avatarNode","getClass","replaceWith","titleNode","editTitleNode","input","editTitleInput","focus","setSelectionRange","value","titleTextNode","Text","encode","canEdit","uiClasses","key","blur","stopImmediatePropagation","Controller","changeTitle","privacyPopup","GroupPrivacy","privacyTextNode","getLabel","baseEvent","getData","changePrivacy","setPrivacy","type","Members","amount","list","counters","inviteBtnId","inviteNode","isEqualNode","groupedMembers","visibleAmount","moderators","slice","owner","member","outCounter","workgroup_requests_out","inCounter","workgroup_requests_in","outId","inId","renderOut","renderIn","crownIconSrc","photo","encodeURI","members","isOwner","isModerator","push","canInvite","Pin","pin","pinId","isPinned","Roles","rolesId","GroupSettings","Cache","MemoryCache","update","popup","popupContainer","getPopupContainer","popupRect","getBoundingClientRect","Math","abs","right","left","leftAdjusted","angleContainer","angle","element","set","param","get","getGroupData","PopupComponentsMaker","content","html","backgroundColor","withoutBackground","Promise","resolve","setAutoHide","chat","close","numberOfMembers","listOfMembers","openGroupUsers","openGroupInvite","layoutMembers","isSubscribed","isPin","roles","canEditFeatures","openGroupFeatures","setSubscription","unDisable","error","changePin","openInSlider","top","action","console","UserSettings","Settings","availableFeatures","VideoCall","toggle","menu","Menu","closeByEsc","addMenuItem","dataset","className","onclick","delimiter","Type","isUndefined","container","isDomNode","Error","append","tasks","calendar","pullRequests","Pull","spaceId","tasksTotal","calendarTotal","discussionsTotal","Main","interfaceButtonsManager","getById","btn","tasksBtn","calendarBtn","discussionBtn","updateCounter","FEATURE","feature","featureName","featureId","menuItem","getItemById","ACTION","itemMenuData","activeItem","getActive","DATA_ID","uri","Uri","Socialnetwork","Spaces","reloadPageContent","deleteMenuItem","featureText","customName","updateMenuItemText","counterId","dataId","onClick","url","pathToDiscussions","chevronDown","setTimeout","Meetings","showMenu","Methodology","teamSpeedPath","burnDownPath","pathToTask","invite","startDiscussionButton","ahaMoment","spotlight","SpotLight","targetElement","targetVertex","onTargetEnter","setColor","Guide","guide","simpleMode","onEvents","steps","condition","bottom","showNextStep","guidePopup","setWidth","getContentContainer","paddingRight","closeIcon","removed","inviteUsers","UI","Notification","Center","notify","log","hasInvited","hasRemoved"],"mappings":"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"}