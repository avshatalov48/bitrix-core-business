{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Reflection, Type} from \"main.core\";\nimport {TagSelector} from 'ui.entity-selector';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Component');\n\nclass TaskList\n{\n\t#gridId: string;\n\t#delegateToSelector: TagSelector;\n\t#delegateToUserId: number = 0;\n\n\tconstructor(options: {gridId: string})\n\t{\n\t\tthis.#gridId = options.gridId;\n\n\t\tthis.#initSelectors();\n\t}\n\n\t#initSelectors(): void\n\t{\n\t\tconst self = this;\n\n\t\tthis.#delegateToSelector = new TagSelector({\n\t\t\tmultiple: false,\n\t\t\ttagMaxWidth: 180,\n\t\t\tevents: {\n\t\t\t\tonTagAdd(event)\n\t\t\t\t{\n\t\t\t\t\tself.#delegateToUserId = parseInt(event.getData().tag.getId());\n\n\t\t\t\t\tif (!Type.isInteger(self.#delegateToUserId))\n\t\t\t\t\t{\n\t\t\t\t\t\tself.#delegateToUserId = 0;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonTagRemove()\n\t\t\t\t{\n\t\t\t\t\tself.#delegateToUserId = 0;\n\t\t\t\t},\n\t\t\t},\n\t\t\tdialogOptions: {\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\t}\n\n\tinit(): void\n\t{\n\t\tconst delegateToWrapper = document.getElementById('ACTION_DELEGATE_TO_WRAPPER');\n\t\tif (delegateToWrapper)\n\t\t{\n\t\t\tthis.#delegateToSelector.renderTo(delegateToWrapper);\n\t\t}\n\t}\n\n\tapplyActionPanelValues(): void\n\t{\n\t\tconst grid = this.getGrid()\n\t\tconst actionsPanel = grid?.getActionsPanel();\n\n\t\tif (grid && actionsPanel)\n\t\t{\n\t\t\tconst data = {\n\t\t\t\t['action_all_rows_' + this.#gridId]: actionsPanel.getForAllCheckbox()?.checked ? 'Y' : 'N',\n\t\t\t\tACTION_DELEGATE_TO_ID: this.#delegateToUserId,\n\t\t\t\tID: grid.getRows().getSelectedIds(),\n\t\t\t};\n\t\t\tfor (const [key, value] of Object.entries(actionsPanel.getValues()))\n\t\t\t{\n\t\t\t\tdata[key] = Type.isString(value) ? value.trim().replace(/^['\"]+|['\"]+$/g, '') : value;\n\t\t\t}\n\n\t\t\tthis.getGrid()?.reloadTable('POST', data, () => this.init());\n\t\t}\n\t}\n\n\treloadGrid()\n\t{\n\t\tconst grid = this.getGrid();\n\t\tif (grid)\n\t\t{\n\t\t\tgrid.reload();\n\t\t}\n\t}\n\n\tgetGrid(): ?BX.Main.grid\n\t{\n\t\tif (this.#gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager && BX.Main.gridManager.getInstanceById(this.#gridId);\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nnamespace.TaskList = TaskList;"],"names":["namespace","Reflection","TaskList","options","gridId","delegateToWrapper","document","getElementById","renderTo","grid","getGrid","actionsPanel","getActionsPanel","data","getForAllCheckbox","checked","getRows","getSelectedIds","Object","entries","getValues","key","value","Type","isString","trim","replace","reloadTable","init","reload","BX","Main","gridManager","getInstanceById","self","TagSelector","multiple","tagMaxWidth","events","onTagAdd","event","parseInt","getData","tag","getId","isInteger","onTagRemove","dialogOptions","entities","id","intranetUsersOnly","inviteEmployeeLink"],"mappings":";;;;;;;AAAA,CAGA,IAAMA,SAAS,GAAGC,oBAAU,CAACD,SAAS,CAAC,sBAAsB,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA,IAEzDE,QAAQ;GAMb,kBAAYC,OAAyB,EACrC;KAAA;KAAA;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAH4B;;KAI3B,sCAAI,WAAWA,OAAO,CAACC,MAAM;KAE7B,2BAAI,wCAAJ,IAAI;;GACJ;KAAA;KAAA,uBAuCD;OACC,IAAMC,iBAAiB,GAAGC,QAAQ,CAACC,cAAc,CAAC,4BAA4B,CAAC;OAC/E,IAAIF,iBAAiB,EACrB;SACC,sCAAI,uBAAqBG,QAAQ,CAACH,iBAAiB,CAAC;;;;KAErD;KAAA,yCAGD;OAAA;OACC,IAAMI,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;OAC3B,IAAMC,YAAY,GAAGF,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEG,eAAe,EAAE;OAE5C,IAAIH,IAAI,IAAIE,YAAY,EACxB;SAAA;SACC,IAAME,IAAI,mDACR,kBAAkB,qCAAG,IAAI,UAAQ,EAAG,yBAAAF,YAAY,CAACG,iBAAiB,EAAE,kDAAhC,sBAAkCC,OAAO,GAAG,GAAG,GAAG,GAAG,iGACnE,IAAI,gEACvBN,IAAI,CAACO,OAAO,EAAE,CAACC,cAAc,EAAE,SACnC;SACD,mCAA2BC,MAAM,CAACC,OAAO,CAACR,YAAY,CAACS,SAAS,EAAE,CAAC,qCACnE;WADK;aAAOC,GAAG;aAAEC,KAAK;WAErBT,IAAI,CAACQ,GAAG,CAAC,GAAGE,cAAI,CAACC,QAAQ,CAACF,KAAK,CAAC,GAAGA,KAAK,CAACG,IAAI,EAAE,CAACC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,GAAGJ,KAAK;;SAGtF,qBAAI,CAACZ,OAAO,EAAE,kDAAd,cAAgBiB,WAAW,CAAC,MAAM,EAAEd,IAAI,EAAE;WAAA,OAAM,KAAI,CAACe,IAAI,EAAE;WAAC;;;;KAE7D;KAAA,6BAGD;OACC,IAAMnB,IAAI,GAAG,IAAI,CAACC,OAAO,EAAE;OAC3B,IAAID,IAAI,EACR;SACCA,IAAI,CAACoB,MAAM,EAAE;;;;KAEd;KAAA,0BAGD;OACC,sCAAI,IAAI,YACR;SACC,OAAOC,EAAE,CAACC,IAAI,CAACC,WAAW,IAAIF,EAAE,CAACC,IAAI,CAACC,WAAW,CAACC,eAAe,mCAAC,IAAI,WAAS;;OAGhF,OAAO,IAAI;;;GACX;CAAA;CAAA,2BAlFD;GACC,IAAMC,IAAI,GAAG,IAAI;GAEjB,sCAAI,uBAAuB,IAAIC,6BAAW,CAAC;KAC1CC,QAAQ,EAAE,KAAK;KACfC,WAAW,EAAE,GAAG;KAChBC,MAAM,EAAE;OACPC,QAAQ,oBAACC,KAAK,EACd;SACC,kCAAAN,IAAI,qBAAqBO,QAAQ,CAACD,KAAK,CAACE,OAAO,EAAE,CAACC,GAAG,CAACC,KAAK,EAAE,CAAC;SAE9D,IAAI,CAACrB,cAAI,CAACsB,SAAS,mCAACX,IAAI,qBAAmB,EAC3C;WACC,kCAAAA,IAAI,qBAAqB,CAAC;;QAE3B;OACDY,WAAW,yBACX;SACC,kCAAAZ,IAAI,qBAAqB,CAAC;;MAE3B;KACDa,aAAa,EAAE;OACdC,QAAQ,EAAE,CACT;SACCC,EAAE,EAAE,MAAM;SACV9C,OAAO,EAAE;WACR+C,iBAAiB,EAAE,IAAI;WACvBC,kBAAkB,EAAE;;QAErB;;IAGH,CAAC;CACH;CAoDDnD,SAAS,CAACE,QAAQ,GAAGA,QAAQ;;;;"}