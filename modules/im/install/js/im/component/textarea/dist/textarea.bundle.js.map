{"version":3,"file":"textarea.bundle.js","sources":["../src/textarea.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Textarea Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2019 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport './textarea.css';\nimport {BitrixVue} from \"ui.vue\";\nimport {LocalStorage} from \"im.lib.localstorage\";\nimport {Utils} from \"im.lib.utils\";\nimport {Browser} from 'main.core';\nimport {Vuex} from \"ui.vue.vuex\";\n\nimport { EventEmitter } from 'main.core.events';\nimport { EventType, DeviceType } from \"im.const\";\n\nBitrixVue.component('bx-im-component-textarea',\n{\n\t/**\n\t * @emits 'send' {text: string}\n\t * @emits 'edit' {}\n\t * @emits 'writes' {text: string}\n\t * @emits 'focus' {event: object} -- 'event' - focus event\n\t * @emits 'blur' {event: object} -- 'event' - blur event\n\t * @emits 'keyup' {event: object} -- 'event' - keyup event\n\t * @emits 'keydown' {event: object} -- 'event' - keydown event\n\t * @emits 'appButtonClick' {appId: string, event: object} -- 'appId' - application name, 'event' - event click\n\t * @emits 'fileSelected' {fileInput: domNode} -- 'fileInput' - dom node element\n\t */\n\n\tprops:\n\t{\n\t\tsiteId: { default: 'default' },\n\t\tuserId: { default: 0 },\n\t\tdialogId: { default: 0 },\n\t\tenableCommand: { default: true },\n\t\tenableMention: { default: true },\n\t\tdesktopMode: { default: false },\n\t\tenableEdit: { default: false },\n\t\tenableFile: { default: false },\n\t\tsendByEnter: { default: true },\n\t\tautoFocus: { default: null },\n\t\twritesEventLetter: { default: 0 },\n\t\tstyles: {\n\t\t\ttype: Object,\n\t\t\tdefault: function () {\n\t\t\t\treturn {}\n\t\t\t}\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tplaceholderMessage: '',\n\t\t\tcurrentMessage: '',\n\t\t\tpreviousMessage: '',\n\t\t\tcommandListen: false,\n\t\t\tmentionListen: false,\n\t\t\tstylesDefault: Object.freeze({button: { backgroundColor: null, iconColor: null }})\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.textarea.insertText, this.onInsertText);\n\t\tEventEmitter.subscribe(EventType.textarea.setFocus, this.onFocusSet);\n\t\tEventEmitter.subscribe(EventType.textarea.setBlur, this.onFocusClear);\n\n\t\tthis.localStorage = LocalStorage;\n\n\t\tthis.textareaHistory = this.localStorage.get(this.siteId, this.userId, 'textarea-history', {});\n\t\tthis.currentMessage = this.textareaHistory[this.dialogId] || '';\n\t\tthis.placeholderMessage = this.currentMessage;\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.textarea.insertText, this.onInsertText);\n\t\tEventEmitter.unsubscribe(EventType.textarea.setFocus, this.onFocusSet);\n\t\tEventEmitter.unsubscribe(EventType.textarea.setBlur, this.onFocusClear);\n\n\t\tclearTimeout(this.messageStoreTimeout);\n\t\tthis.localStorage.set(this.siteId, this.userId, 'textarea-history', this.textareaHistory);\n\t\tthis.localStorage = null;\n\t},\n\tcomputed:\n\t{\n\t\ttextareaClassName()\n\t\t{\n\t\t\treturn ['bx-im-textarea', {\n\t\t\t\t'bx-im-textarea-dark-background': this.isDarkBackground,\n\t\t\t\t'bx-im-textarea-mobile': this.isMobile,\n\t\t\t}];\n\t\t},\n\n\t\tbuttonStyle()\n\t\t{\n\t\t\tlet styles = Object.assign({}, this.stylesDefault, this.styles);\n\n\t\t\tlet isIconDark = false;\n\t\t\tif (styles.button.iconColor)\n\t\t\t{\n\t\t\t\tisIconDark = Utils.isDarkColor(styles.button.iconColor);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tisIconDark = !Utils.isDarkColor(styles.button.backgroundColor);\n\t\t\t}\n\n\t\t\tstyles.button.className = isIconDark? 'bx-im-textarea-send-button': 'bx-im-textarea-send-button bx-im-textarea-send-button-bright-arrow';\n\t\t\tstyles.button.style = styles.button.backgroundColor? 'background-color: '+styles.button.backgroundColor+';': '';\n\n\t\t\treturn styles;\n\t\t},\n\t\tisDarkBackground()\n\t\t{\n\t\t\treturn this.application.options.darkBackground;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn this.application.device.type === DeviceType.mobile;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_MESSENGER_TEXTAREA_', this)\n\t\t},\n\t\tisIE11()\n\t\t{\n\t\t\treturn Browser.isIE11();\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t})\n\t},\n\tdirectives: {\n\t\t'bx-im-focus':\n\t\t{\n\t\t\tinserted(element, params)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tparams.value === true\n\t\t\t\t\t|| params.value === null && !this.isMobile\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\telement.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\t/**\n\t\t *\n\t\t * @param text\n\t\t * @param breakline - true/false (default)\n\t\t * @param position - start, current (default), end\n\t\t * @param cursor - start, before, after (default), end\n\t\t * @param focus - set focus on textarea\n\t\t */\n\t\tinsertText(text, breakline = false, position = 'current', cursor = 'after', focus = true)\n\t\t{\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tlet selectionStart = textarea.selectionStart;\n\t\t\tlet selectionEnd = textarea.selectionEnd;\n\n\t\t\tif (position == 'start')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\ttextarea.value = text + textarea.value;\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = 0;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (position == 'current')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value.substring(0, selectionStart).trim().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = \"\\n\"+text;\n\t\t\t\t\t}\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value && !textarea.value.endsWith(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = ' '+text;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttextarea.value = textarea.value.substring(0, selectionStart) + text + textarea.value.substring(selectionEnd, textarea.value.length);\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = selectionStart+text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = selectionStart;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (position == 'end')\n\t\t\t{\n\t\t\t\tif (breakline)\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value.substring(0, selectionStart).trim().length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = \"\\n\"+text;\n\t\t\t\t\t}\n\t\t\t\t\ttext = text+\"\\n\";\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (textarea.value && !textarea.value.endsWith(' '))\n\t\t\t\t\t{\n\t\t\t\t\t\ttext = ' '+text;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttextarea.value = textarea.value+text;\n\n\t\t\t\tif (focus)\n\t\t\t\t{\n\t\t\t\t\tif (cursor == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = textarea.value.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t\telse if (cursor == 'before')\n\t\t\t\t\t{\n\t\t\t\t\t\ttextarea.selectionStart = textarea.value.length-text.length;\n\t\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (focus)\n\t\t\t{\n\t\t\t\tif (cursor == 'start')\n\t\t\t\t{\n\t\t\t\t\ttextarea.selectionStart = 0;\n\t\t\t\t\ttextarea.selectionEnd = 0;\n\t\t\t\t}\n\t\t\t\telse if (cursor == 'end')\n\t\t\t\t{\n\t\t\t\t\ttextarea.selectionStart = textarea.value.length;\n\t\t\t\t\ttextarea.selectionEnd = textarea.selectionStart;\n\t\t\t\t}\n\n\t\t\t\ttextarea.focus();\n\t\t\t}\n\n\t\t\tthis.textChangeEvent();\n\t\t},\n\n\t\tsendMessage(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tEventEmitter.emit(EventType.textarea.sendMessage, {text: this.currentMessage.trim()});\n\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tif (textarea)\n\t\t\t{\n\t\t\t\ttextarea.value = '';\n\t\t\t}\n\n\t\t\tif (this.autoFocus === null || this.autoFocus)\n\t\t\t{\n\t\t\t\ttextarea.focus();\n\t\t\t}\n\n\t\t\tthis.textChangeEvent();\n\t\t},\n\n\t\ttextChangeEvent()\n\t\t{\n\t\t\tlet textarea = this.$refs.textarea;\n\t\t\tif (!textarea)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet text = textarea.value.trim();\n\t\t\tif (this.currentMessage === text)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.writesEventLetter <= text.length)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.startWriting, {text});\n\t\t\t}\n\n\t\t\tthis.previousMessage = this.currentMessage;\n\t\t\tthis.previousSelectionStart = textarea.selectionStart;\n\t\t\tthis.previousSelectionEnd = this.previousSelectionStart;\n\t\t\tthis.currentMessage = text;\n\n\t\t\tif (text.toString().length > 0)\n\t\t\t{\n\t\t\t\tthis.textareaHistory[this.dialogId] = text;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdelete this.textareaHistory[this.dialogId];\n\t\t\t}\n\n\t\t\tclearTimeout(this.messageStoreTimeout);\n\t\t\tthis.messageStoreTimeout = setTimeout(() => {\n\t\t\t\tthis.localStorage.set(this.siteId, this.userId, 'textarea-history', this.textareaHistory, this.userId? 0: 10);\n\t\t\t}, 500);\n\t\t},\n\n\t\tonKeyDown(event)\n\t\t{\n\t\t\tthis.$emit('keydown', event);\n\n\t\t\tlet textarea = event.target;\n\t\t\tlet text = textarea.value.trim();\n\t\t\tlet isMac = Utils.platform.isMac();\n\t\t\tlet isCtrlTEnable = Utils.platform.isBitrixDesktop() || !Utils.browser.isChrome();\n\n\t\t\t// TODO see more im/install/js/im/im.js:12324\n\t\t\tif (this.commandListen)\n\t\t\t{\n\t\t\t}\n\t\t\telse if (this.mentionListen)\n\t\t\t{\n\t\t\t}\n\t\t\telse if (!(event.altKey && event.ctrlKey))\n\t\t\t{\n\t\t\t\tif (this.enableMention && (event.shiftKey  && (event.keyCode == 61 || event.keyCode == 50 || event.keyCode == 187 || event.keyCode == 187)) || event.keyCode == 107)\n\t\t\t\t{\n\t\t\t\t\t// mention case\n\t\t\t\t}\n\t\t\t\telse if (this.enableCommand && (event.keyCode == 191 || event.keyCode == 111 || event.keyCode == 220))\n\t\t\t\t{\n\t\t\t\t\t// command case\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (event.keyCode == 27)\n\t\t\t{\n\t\t\t\tif (textarea.value != '' && textarea === document.activeElement)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t}\n\t\t\t\tif (event.shiftKey)\n\t\t\t\t{\n\t\t\t\t\ttextarea.value = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (event.metaKey || event.ctrlKey)\n\t\t\t{\n\t\t\t\t// TODO translit messages\n\t\t\t\tif (\n\t\t\t\t\tisCtrlTEnable && event.key === 't'\n\t\t\t\t\t|| !isCtrlTEnable && event.key === 'e'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t// translit case\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\telse if (['b','s','i','u'].includes(event.key))\n\t\t\t\t{\n\t\t\t\t\tlet selectionStart = textarea.selectionStart;\n\t\t\t\t\tlet selectionEnd = textarea.selectionEnd;\n\n\t\t\t\t\tlet tagStart = '['+event.key.toLowerCase()+']';\n\t\t\t\t\tlet tagEnd = '[/'+event.key.toLowerCase()+']';\n\t\t\t\t\tlet selected = textarea.value.substring(selectionStart, selectionEnd);\n\n\t\t\t\t\tif (selected.startsWith(tagStart) && selected.endsWith(tagEnd))\n\t\t\t\t\t{\n\t\t\t\t\t\tselected = selected.substring(tagStart.length, selected.indexOf(tagEnd));\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tselected = tagStart + selected + tagEnd;\n\t\t\t\t\t}\n\n\t\t\t\t\ttextarea.value = textarea.value.substring(0, selectionStart) + selected + textarea.value.substring(selectionEnd, textarea.value.length);\n\n\t\t\t\t\ttextarea.selectionStart = selectionStart;\n\t\t\t\t\ttextarea.selectionEnd = selectionStart + selected.length;\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (event.keyCode == 9)\n\t\t\t{\n\t\t\t\tthis.insertText(\"\\t\");\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (this.enableEdit && event.keyCode == 38 && text.length <= 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.textarea.edit, {});\n\t\t\t}\n\t\t\telse if (event.keyCode == 13)\n\t\t\t{\n\t\t\t\tif (this.isMobile)\n\t\t\t\t{\n\t\t\t\t}\n\t\t\t\telse if (this.sendByEnter == true)\n\t\t\t\t{\n\t\t\t\t\tif (event.ctrlKey || event.altKey || event.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!event.shiftKey)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.insertText(\"\\n\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (text.length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (event.ctrlKey == true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t\telse if (isMac && (event.metaKey == true || event.altKey == true))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.sendMessage(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ((event.ctrlKey || event.metaKey) && event.key == 'z')\n\t\t\t{\n\t\t\t\tif (this.previousMessage)\n\t\t\t\t{\n\t\t\t\t\ttextarea.value = this.previousMessage;\n\t\t\t\t\ttextarea.selectionStart = this.previousSelectionStart;\n\t\t\t\t\ttextarea.selectionEnd = this.previousSelectionEnd;\n\n\t\t\t\t\tthis.previousMessage = '';\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonKeyUp(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.keyUp, {event, text: this.currentMessage});\n\t\t\tthis.textChangeEvent();\n\t\t},\n\t\tonPaste(event)\n\t\t{\n\t\t\tthis.$nextTick(this.textChangeEvent);\n\t\t},\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.textChangeEvent();\n\t\t},\n\t\tonFocus(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.focus, event);\n\t\t},\n\t\tonBlur(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.blur, event);\n\t\t},\n\t\tonAppButtonClick(appId, event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.appButtonClick, {appId, event});\n\t\t},\n\t\tonInsertText({data: event = {}})\n\t\t{\n\t\t\tif (!event.text)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.insertText(event.text, event.breakline, event.position, event.cursor, event.focus);\n\n\t\t\tEventEmitter.emit(EventType.textarea.keyUp, {event, text: this.currentMessage});\n\n\t\t\treturn true;\n\t\t},\n\t\tonFocusSet()\n\t\t{\n\t\t\tthis.$refs.textarea.focus();\n\n\t\t\treturn true;\n\t\t},\n\t\tonFocusClear()\n\t\t{\n\t\t\tthis.$refs.textarea.blur();\n\n\t\t\treturn true;\n\t\t},\n\t\tonFileClick(event)\n\t\t{\n\t\t\tevent.target.value = \"\";\n\t\t},\n\t\tonFileSelect(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.textarea.fileSelected, {\n\t\t\t\tfileChangeEvent: event,\n\t\t\t\tfileInput: event.target\n\t\t\t});\n\t\t},\n\t\tlog(text, skip, event)\n\t\t{\n\t\t\tconsole.warn(text);\n\t\t\tif (skip == 1)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t\tpreventDefault(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :class=\"textareaClassName\">\n\t\t\t<div class=\"bx-im-textarea-box\">\n\t\t\t\t<textarea ref=\"textarea\" class=\"bx-im-textarea-input\" @keydown=\"onKeyDown\" @keyup=\"onKeyUp\" @paste=\"onPaste\" @input=\"onInput\" @focus=\"onFocus\" @blur=\"onBlur\" v-bx-im-focus=\"autoFocus\" :placeholder=\"localize.BX_MESSENGER_TEXTAREA_PLACEHOLDER\">{{placeholderMessage}}</textarea>\n\t\t\t\t<transition enter-active-class=\"bx-im-textarea-send-button-show\" leave-active-class=\"bx-im-textarea-send-button-hide\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tv-if=\"currentMessage\" \n\t\t\t\t\t\t:class=\"buttonStyle.button.className\" \n\t\t\t\t\t\t:style=\"buttonStyle.button.style\" \n\t\t\t\t\t\t:title=\"localize.BX_MESSENGER_TEXTAREA_BUTTON_SEND\"\n\t\t\t\t\t\t@click=\"sendMessage\" \n\t\t\t\t\t\t@touchend=\"sendMessage\" \n\t\t\t\t\t\t@mousedown=\"preventDefault\" \n\t\t\t\t\t\t@touchstart=\"preventDefault\" \n\t\t\t\t\t/>\n\t\t\t\t</transition>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-textarea-app-box\">\n\t\t\t\t<label v-if=\"enableFile && !isIE11\" class=\"bx-im-textarea-app-button bx-im-textarea-app-file\" :title=\"localize.BX_MESSENGER_TEXTAREA_FILE\">\n\t\t\t\t\t<input type=\"file\" @click=\"onFileClick($event)\" @change=\"onFileSelect($event)\" multiple>\n\t\t\t\t</label>\n\t\t\t\t<button class=\"bx-im-textarea-app-button bx-im-textarea-app-smile\" :title=\"localize.BX_MESSENGER_TEXTAREA_SMILE\" @click=\"onAppButtonClick('smile', $event)\"></button>\n\t\t\t\t<button v-if=\"false\" class=\"bx-im-textarea-app-button bx-im-textarea-app-gif\" :title=\"localize.BX_MESSENGER_TEXTAREA_GIPHY\" @click=\"onAppButtonClick('giphy', $event)\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`\n});\n"],"names":["BitrixVue","component","props","siteId","userId","dialogId","enableCommand","enableMention","desktopMode","enableEdit","enableFile","sendByEnter","autoFocus","writesEventLetter","styles","type","Object","data","placeholderMessage","currentMessage","previousMessage","commandListen","mentionListen","stylesDefault","freeze","button","backgroundColor","iconColor","created","EventEmitter","subscribe","EventType","textarea","insertText","onInsertText","setFocus","onFocusSet","setBlur","onFocusClear","localStorage","LocalStorage","textareaHistory","get","beforeDestroy","unsubscribe","clearTimeout","messageStoreTimeout","set","computed","textareaClassName","isDarkBackground","isMobile","buttonStyle","assign","isIconDark","Utils","isDarkColor","className","style","application","options","darkBackground","device","DeviceType","mobile","localize","getFilteredPhrases","isIE11","Browser","Vuex","mapState","state","directives","inserted","element","params","value","focus","methods","text","breakline","position","cursor","$refs","selectionStart","selectionEnd","length","substring","trim","endsWith","textChangeEvent","sendMessage","event","preventDefault","emit","startWriting","previousSelectionStart","previousSelectionEnd","toString","setTimeout","onKeyDown","$emit","target","isMac","platform","isCtrlTEnable","isBitrixDesktop","browser","isChrome","altKey","ctrlKey","shiftKey","keyCode","document","activeElement","stopPropagation","metaKey","key","includes","tagStart","toLowerCase","tagEnd","selected","startsWith","indexOf","edit","onKeyUp","keyUp","onPaste","$nextTick","onInput","onFocus","onBlur","blur","onAppButtonClick","appId","appButtonClick","onFileClick","onFileSelect","fileSelected","fileChangeEvent","fileInput","log","skip","console","warn","template"],"mappings":"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"}