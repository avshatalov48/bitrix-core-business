{"version":3,"file":"recent-list.bundle.js","sources":["../src/components/recent-item/components/message-text.js","../src/components/recent-item/components/item-counter.js","../src/components/recent-item/components/message-status.js","../src/components/recent-item/recent-item.js","../src/components/active-call.js","../src/components/create-chat.js","../src/components/empty-state.js","../src/components/loading-state.js","../src/classes/broadcast-manager.js","../src/classes/like-manager.js","../src/recent-list.js"],"sourcesContent":["import { Text, type JsonObject } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Parser } from 'im.v2.lib.parser';\n\nimport type { ImModelUser, ImModelChat, ImModelRecentItem, ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const MessageText = {\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['recent/getMessage'](this.recentItem.dialogId);\n\t\t},\n\t\tneedsBirthdayPlaceholder(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['recent/needsBirthdayPlaceholder'](this.recentItem.dialogId);\n\t\t},\n\t\tneedsVacationPlaceholder(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['recent/needsVacationPlaceholder'](this.recentItem.dialogId);\n\t\t},\n\t\tshowLastMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showLastMessage);\n\t\t},\n\t\thiddenMessageText(): string\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.$store.getters['users/getPosition'](this.recentItem.dialogId);\n\t\t\t}\n\n\t\t\treturn this.loc('IM_LIST_RECENT_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tisLastMessageAuthor(): boolean\n\t\t{\n\t\t\treturn this.message.authorId === Core.getUserId();\n\t\t},\n\t\tlastMessageAuthorAvatar(): string\n\t\t{\n\t\t\tconst authorDialog = this.$store.getters['chats/get'](this.message.authorId);\n\n\t\t\tif (!authorDialog)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn authorDialog.avatar;\n\t\t},\n\t\tlastMessageAuthorAvatarStyle(): Object\n\t\t{\n\t\t\treturn { backgroundImage: `url('${this.lastMessageAuthorAvatar}')` };\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\tif (this.message.isDeleted)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_LIST_RECENT_DELETED_MESSAGE');\n\t\t\t}\n\n\t\t\tconst formattedText = Parser.purifyRecent(this.recentItem);\n\t\t\tif (!formattedText)\n\t\t\t{\n\t\t\t\treturn this.isUser ? this.$store.getters['users/getPosition'](this.recentItem.dialogId) : this.hiddenMessageText;\n\t\t\t}\n\n\t\t\treturn formattedText;\n\t\t},\n\t\tformattedMessageText(): string\n\t\t{\n\t\t\tconst SPLIT_INDEX = 27;\n\n\t\t\treturn Utils.text.insertUnseenWhitespace(this.messageText, SPLIT_INDEX);\n\t\t},\n\t\tpreparedDraftContent(): string\n\t\t{\n\t\t\tconst phrase = this.loc('IM_LIST_RECENT_MESSAGE_DRAFT_2');\n\t\t\tconst PLACEHOLDER_LENGTH = '#TEXT#'.length;\n\t\t\tconst prefix = phrase.slice(0, -PLACEHOLDER_LENGTH);\n\t\t\tconst text = Text.encode(this.formattedDraftText);\n\n\t\t\treturn `\n\t\t\t\t<span class=\"bx-im-list-recent-item__message_draft-prefix\">${prefix}</span>\n\t\t\t\t<span class=\"bx-im-list-recent-item__message_text_content\">${text}</span>\n\t\t\t`;\n\t\t},\n\t\tformattedDraftText(): string\n\t\t{\n\t\t\treturn Parser.purify({ text: this.recentItem.draft.text, showIconIfEmptyText: false });\n\t\t},\n\t\tformattedVacationEndDate(): string\n\t\t{\n\t\t\treturn DateTimeFormat.format('d.m.Y', this.user.absent);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn !this.isUser;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent-item__message_container\">\n\t\t\t<span class=\"bx-im-list-recent-item__message_text\">\n\t\t\t\t<span v-if=\"recentItem.draft.text\" v-html=\"preparedDraftContent\"></span>\n\t\t\t\t<div v-else-if=\"recentItem.invitation.isActive\" class=\"bx-im-list-recent-item__balloon_container --invitation\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__balloon\">{{ loc('IM_LIST_RECENT_INVITATION_NOT_ACCEPTED') }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"needsBirthdayPlaceholder\" class=\"bx-im-list-recent-item__balloon_container --birthday\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__balloon\">{{ loc('IM_LIST_RECENT_BIRTHDAY') }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"needsVacationPlaceholder\" class=\"bx-im-list-recent-item__balloon_container --vacation\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__balloon\">\n\t\t\t\t\t\t{{ loc('IM_LIST_RECENT_VACATION', {'#VACATION_END_DATE#': formattedVacationEndDate}) }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<template v-else-if=\"!showLastMessage\">\n\t\t\t\t\t{{ hiddenMessageText }}\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<span v-if=\"isLastMessageAuthor\" class=\"bx-im-list-recent-item__message_author-icon --self\"></span>\n\t\t\t\t\t<template v-else-if=\"isChat && message.authorId\">\n\t\t\t\t\t\t<span v-if=\"lastMessageAuthorAvatar\" :style=\"lastMessageAuthorAvatarStyle\" class=\"bx-im-list-recent-item__message_author-icon --user\"></span>\n\t\t\t\t\t\t<span v-else class=\"bx-im-list-recent-item__message_author-icon --user --default\"></span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<span class=\"bx-im-list-recent-item__message_text_content\">{{ formattedMessageText }}</span>\n\t\t\t\t</template>\n\t\t\t</span>\n\t\t</div>\n\t`\n};","import { Core } from 'im.v2.application.core';\nimport { ChatType } from 'im.v2.const';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelRecentItem, ImModelUser } from 'im.v2.model';\n\n// @vue/component\nexport const ItemCounter = {\n\tname: 'ItemCounter',\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisChatMuted: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisSelfChat(): boolean\n\t\t{\n\t\t\treturn this.isUser && this.user.id === Core.getUserId();\n\t\t},\n\t\tinvitation(): { isActive: boolean, originator: number, canResend: boolean }\n\t\t{\n\t\t\treturn this.recentItem.invitation;\n\t\t},\n\t\tformattedCounter(): string\n\t\t{\n\t\t\treturn this.dialog.counter > 99 ? '99+' : this.dialog.counter.toString();\n\t\t},\n\t\tshowCounterContainer(): boolean\n\t\t{\n\t\t\treturn !this.needsBirthdayPlaceholder && !this.invitation.isActive;\n\t\t},\n\t\tshowPinnedIcon(): boolean\n\t\t{\n\t\t\treturn this.recentItem.pinned && this.dialog.counter === 0 && !this.recentItem.unread;\n\t\t},\n\t\tshowUnreadWithoutCounter(): boolean\n\t\t{\n\t\t\treturn this.recentItem.unread && this.dialog.counter === 0;\n\t\t},\n\t\tshowUnreadWithCounter(): boolean\n\t\t{\n\t\t\treturn this.recentItem.unread && this.dialog.counter > 0;\n\t\t},\n\t\tshowCounter(): boolean\n\t\t{\n\t\t\treturn !this.recentItem.unread && this.dialog.counter > 0 && !this.isSelfChat;\n\t\t},\n\t\tneedsBirthdayPlaceholder(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['recent/needsBirthdayPlaceholder'](this.recentItem.dialogId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"showCounterContainer\" :class=\"{'--extended': dialog.counter > 99, '--withUnread': recentItem.unread}\" class=\"bx-im-list-recent-item__counter_wrap\">\n\t\t\t<div class=\"bx-im-list-recent-item__counter_container\">\n\t\t\t\t<div v-if=\"showPinnedIcon\" class=\"bx-im-list-recent-item__pinned-icon\"></div>\n\t\t\t\t<div v-else-if=\"showUnreadWithoutCounter\" :class=\"{'--muted': isChatMuted}\"  class=\"bx-im-list-recent-item__counter_number --no-counter\"></div>\n\t\t\t\t<div v-else-if=\"showUnreadWithCounter\" :class=\"{'--muted': isChatMuted}\"  class=\"bx-im-list-recent-item__counter_number --with-counter\">\n\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"showCounter\" :class=\"{'--muted': isChatMuted}\" class=\"bx-im-list-recent-item__counter_number\">\n\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { ChatType, OwnMessageStatus } from 'im.v2.const';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelRecentItem, ImModelUser, ImModelMessage } from 'im.v2.model';\n\nconst StatusIcon = {\n\tnone: '',\n\tlike: 'like',\n\tsending: 'sending',\n\tsent: 'sent',\n\tviewed: 'viewed',\n};\n\n// @vue/component\nexport const MessageStatus = {\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['recent/getMessage'](this.recentItem.dialogId);\n\t\t},\n\t\tmessageStatus(): $Values<typeof OwnMessageStatus>\n\t\t{\n\t\t\tif (this.message.sending)\n\t\t\t{\n\t\t\t\treturn OwnMessageStatus.sending;\n\t\t\t}\n\n\t\t\tif (this.message.viewedByOthers)\n\t\t\t{\n\t\t\t\treturn OwnMessageStatus.viewed;\n\t\t\t}\n\n\t\t\treturn OwnMessageStatus.sent;\n\t\t},\n\t\tstatusIcon(): $Values<typeof StatusIcon>\n\t\t{\n\t\t\tif (!this.isLastMessageAuthor || this.isBot || this.needsBirthdayPlaceholder || this.hasDraft)\n\t\t\t{\n\t\t\t\treturn StatusIcon.none;\n\t\t\t}\n\n\t\t\tif (this.isSelfChat)\n\t\t\t{\n\t\t\t\treturn StatusIcon.none;\n\t\t\t}\n\n\t\t\tif (this.recentItem.liked)\n\t\t\t{\n\t\t\t\treturn StatusIcon.like;\n\t\t\t}\n\n\t\t\treturn this.messageStatus;\n\t\t},\n\t\tisLastMessageAuthor(): boolean\n\t\t{\n\t\t\treturn this.message?.authorId === Core.getUserId();\n\t\t},\n\t\tisSelfChat(): boolean\n\t\t{\n\t\t\treturn this.isUser && this.user.id === Core.getUserId();\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisBot(): boolean\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn this.user.bot;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\thasDraft(): boolean\n\t\t{\n\t\t\treturn Boolean(this.recentItem.draft.text);\n\t\t},\n\t\tneedsBirthdayPlaceholder(): boolean\n\t\t{\n\t\t\tif (!this.isUser)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.$store.getters['recent/needsBirthdayPlaceholder'](this.recentItem.dialogId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent-item__status-icon\" :class=\"'--' + statusIcon\"></div>\n\t`,\n};\n","import 'main.date';\nimport { type JsonObject } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, Settings, Layout } from 'im.v2.const';\nimport { Avatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport { MessageText } from './components/message-text';\nimport { ItemCounter } from './components/item-counter';\nimport { MessageStatus } from './components/message-status';\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport './css/recent-item.css';\n\nimport type { ImModelRecentItem, ImModelChat, ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const RecentItem = {\n\tname: 'RecentItem',\n\tcomponents: { Avatar, ChatTitle, MessageText, MessageStatus, ItemCounter },\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\tif (this.needsBirthdayPlaceholder)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_LIST_RECENT_BIRTHDAY_DATE');\n\t\t\t}\n\n\t\t\treturn this.formatDate(this.message.date);\n\t\t},\n\t\tformattedCounter(): string\n\t\t{\n\t\t\treturn this.dialog.counter > 99 ? '99+' : this.dialog.counter.toString();\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tlayout(): { name: string, entityId: string }\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['recent/getMessage'](this.recentItem.dialogId);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn !this.isUser;\n\t\t},\n\t\tisChatSelected(): boolean\n\t\t{\n\t\t\tif (this.layout.name !== Layout.chat.name)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.layout.entityId === this.recentItem.dialogId;\n\t\t},\n\t\tisChatMuted(): boolean\n\t\t{\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst isMuted = this.dialog.muteList.find((element) => {\n\t\t\t\treturn element === Core.getUserId();\n\t\t\t});\n\n\t\t\treturn Boolean(isMuted);\n\t\t},\n\t\tisSomeoneTyping(): boolean\n\t\t{\n\t\t\treturn this.dialog.writingList.length > 0;\n\t\t},\n\t\tneedsBirthdayPlaceholder(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['recent/needsBirthdayPlaceholder'](this.recentItem.dialogId);\n\t\t},\n\t\tshowLastMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showLastMessage);\n\t\t},\n\t\tinvitation(): { isActive: boolean, originator: number, canResend: boolean }\n\t\t{\n\t\t\treturn this.recentItem.invitation;\n\t\t},\n\t\twrapClasses(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--pinned': this.recentItem.pinned,\n\t\t\t\t'--selected': this.isChatSelected,\n\t\t\t};\n\t\t},\n\t\titemClasses(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--no-text': !this.showLastMessage,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tformatDate(date): string\n\t\t{\n\t\t\treturn DateFormatter.formatByTemplate(date, DateTemplate.recent);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :data-id=\"recentItem.dialogId\" :class=\"wrapClasses\" class=\"bx-im-list-recent-item__wrap\">\n\t\t\t<div :class=\"itemClasses\" class=\"bx-im-list-recent-item__container\">\n\t\t\t\t<div class=\"bx-im-list-recent-item__avatar_container\">\n\t\t\t\t\t<div v-if=\"invitation.isActive\" class=\"bx-im-list-recent-item__avatar_invitation\"></div>\n\t\t\t\t\t<div v-else class=\"bx-im-list-recent-item__avatar_content\">\n\t\t\t\t\t\t<Avatar :dialogId=\"recentItem.dialogId\" :size=\"AvatarSize.XL\" :withSpecialTypeIcon=\"!isSomeoneTyping\" />\n\t\t\t\t\t\t<div v-if=\"isSomeoneTyping\" class=\"bx-im-list-recent-item__avatar_typing\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-list-recent-item__content_container\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__content_header\">\n\t\t\t\t\t\t<ChatTitle :dialogId=\"recentItem.dialogId\" :withMute=\"true\" />\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-item__date\">\n\t\t\t\t\t\t\t<MessageStatus :item=\"item\" />\n\t\t\t\t\t\t\t<span>{{ formattedDate }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__content_bottom\">\n\t\t\t\t\t\t<MessageText :item=\"recentItem\" />\n\t\t\t\t\t\t<ItemCounter :item=\"recentItem\" :isChatMuted=\"isChatMuted\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\n\nimport { RecentCallStatus } from 'im.v2.const';\nimport { Avatar, AvatarSize, ChatTitle, Button as MessengerButton, ButtonSize, ButtonColor, ButtonIcon } from 'im.v2.component.elements';\nimport { CallManager } from 'im.v2.lib.call';\n\nimport '../css/active-call.css';\n\nimport type { ImModelCallItem } from 'im.v2.model';\nimport type { CustomColorScheme } from 'im.v2.component.elements';\n\n// @vue/component\nexport const ActiveCall = {\n\tname: 'ActiveCall',\n\tcomponents: { Avatar, ChatTitle, MessengerButton },\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t}\n\t},\n\temits: ['click'],\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tButtonIcon: () => ButtonIcon,\n\t\tactiveCall(): ImModelCallItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tpreparedName(): string\n\t\t{\n\t\t\treturn Text.decode(this.activeCall.name);\n\t\t},\n\t\tanotherDeviceColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\tborderColor: '#bbde4d',\n\t\t\t\ticonColor: '#525c69',\n\t\t\t\ttextColor: '#525c69',\n\t\t\t\thoverColor: 'transparent',\n\t\t\t};\n\t\t},\n\t\tisTabWithActiveCall(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.$store.getters['recent/calls/hasActiveCall']()\n\t\t\t\t&& Boolean(this.getCallManager().hasCurrentCall())\n\t\t\t);\n\t\t},\n\t\thasJoined(): boolean\n\t\t{\n\t\t\treturn this.activeCall.state === RecentCallStatus.joined;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonJoinClick()\n\t\t{\n\t\t\tthis.getCallManager().joinCall(this.activeCall.call.id);\n\t\t},\n\t\tonLeaveCallClick()\n\t\t{\n\t\t\tthis.getCallManager().leaveCurrentCall();\n\t\t},\n\t\tonClick(event)\n\t\t{\n\t\t\tconst recentItem = this.$store.getters['recent/get'](this.activeCall.dialogId);\n\t\t\tif (!recentItem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$emit('click', { item: recentItem, $event: event });\n\t\t},\n\t\treturnToCall()\n\t\t{\n\t\t\tif (this.activeCall.state !== RecentCallStatus.joined)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getCallManager().unfoldCurrentCall();\n\t\t},\n\t\tgetCallManager(): CallManager\n\t\t{\n\t\t\treturn CallManager.getInstance();\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :data-id=\"activeCall.dialogId\" class=\"bx-im-list-recent-item__wrap\">\n\t\t\t<div @click=\"onClick\" class=\"bx-im-list-recent-item__container bx-im-list-recent-active-call__container\">\n\t\t\t\t<div class=\"bx-im-list-recent-item__avatar_container\">\n\t\t\t\t\t<Avatar :dialogId=\"activeCall.dialogId\" :size=\"AvatarSize.XL\" />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-list-recent-item__content_container\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-active-call__title_container\">\n\t\t\t\t\t\t<ChatTitle :text=\"preparedName\" />\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-active-call__title_icon\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"!hasJoined\" class=\"bx-im-list-recent-active-call__actions_container\">\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-active-call__actions_item --join\">\n\t\t\t\t\t\t\t<MessengerButton @click.stop=\"onJoinClick\" :size=\"ButtonSize.M\" :color=\"ButtonColor.Success\" :isRounded=\"true\" :text=\"loc('IM_LIST_RECENT_ACTIVE_CALL_JOIN')\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else-if=\"hasJoined && isTabWithActiveCall\" class=\"bx-im-list-recent-active-call__actions_container\">\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-active-call__actions_item --return\">\n\t\t\t\t\t\t\t<MessengerButton @click.stop=\"returnToCall\" :size=\"ButtonSize.M\" :color=\"ButtonColor.Success\" :isRounded=\"true\" :text=\"loc('IM_LIST_RECENT_ACTIVE_CALL_RETURN')\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else-if=\"hasJoined && !isTabWithActiveCall\" class=\"bx-im-list-recent-active-call__actions_container\">\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-active-call__actions_item --another-device\">\n\t\t\t\t\t\t\t<MessengerButton :size=\"ButtonSize.M\" :customColorScheme=\"anotherDeviceColorScheme\" :isRounded=\"true\" :text=\"loc('IM_LIST_RECENT_ACTIVE_CALL_ANOTHER_DEVICE')\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, type JsonObject } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { Layout, ChatType } from 'im.v2.const';\n\nimport '../css/create-chat.css';\n\nconst DefaultTitleByChatType = {\n\t[ChatType.chat]: Loc.getMessage('IM_LIST_RECENT_CREATE_CHAT_DEFAULT_TITLE'),\n\t[ChatType.videoconf]: Loc.getMessage('IM_LIST_RECENT_CREATE_CONFERENCE_DEFAULT_TITLE'),\n};\n\n// @vue/component\nexport const CreateChat = {\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tchatTitle: '',\n\t\t\tchatAvatarFile: '',\n\t\t\tchatType: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tchatCreationIsOpened(): boolean\n\t\t{\n\t\t\tconst { name: currentLayoutName } = this.$store.getters['application/getLayout'];\n\n\t\t\treturn currentLayoutName === Layout.createChat.name;\n\t\t},\n\t\tpreparedTitle(): string\n\t\t{\n\t\t\tif (this.chatTitle === '')\n\t\t\t{\n\t\t\t\treturn DefaultTitleByChatType[this.chatType];\n\t\t\t}\n\n\t\t\treturn this.chatTitle;\n\t\t},\n\t\tpreparedAvatar(): string | null\n\t\t{\n\t\t\tif (!this.chatAvatarFile)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn URL.createObjectURL(this.chatAvatarFile);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tconst existingTitle = CreateChatManager.getInstance().getChatTitle();\n\t\tif (existingTitle)\n\t\t{\n\t\t\tthis.chatTitle = existingTitle;\n\t\t}\n\n\t\tconst existingAvatar = CreateChatManager.getInstance().getChatAvatar();\n\t\tif (existingAvatar)\n\t\t{\n\t\t\tthis.chatAvatarFile = existingAvatar;\n\t\t}\n\n\t\tthis.chatType = CreateChatManager.getInstance().getChatType();\n\n\t\tCreateChatManager.getInstance().subscribe(\n\t\t\tCreateChatManager.events.titleChange,\n\t\t\t(event: BaseEvent<string>) => {\n\t\t\t\tthis.chatTitle = event.getData();\n\t\t\t},\n\t\t);\n\n\t\tCreateChatManager.getInstance().subscribe(\n\t\t\tCreateChatManager.events.avatarChange,\n\t\t\t(event: BaseEvent<string>) => {\n\t\t\t\tthis.chatAvatarFile = event.getData();\n\t\t\t},\n\t\t);\n\n\t\tCreateChatManager.getInstance().subscribe(\n\t\t\tCreateChatManager.events.chatTypeChange,\n\t\t\t(event: BaseEvent<string>) => {\n\t\t\t\tthis.chatType = event.getData();\n\t\t\t},\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\tonClick()\n\t\t{\n\t\t\tvoid LayoutManager.getInstance().setLayout({\n\t\t\t\tname: Layout.createChat.name,\n\t\t\t\tentityId: this.chatType,\n\t\t\t});\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent-create-chat__container\">\n\t\t\t<div class=\"bx-im-list-recent-item__wrap\" :class=\"{'--selected': chatCreationIsOpened}\" @click=\"onClick\">\n\t\t\t\t<div class=\"bx-im-list-recent-item__container\">\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__avatar_container\">\n\t\t\t\t\t\t<div v-if=\"!preparedAvatar\" class=\"bx-im-list-recent-create-chat__avatar --default\"></div>\n\t\t\t\t\t\t<img v-else class=\"bx-im-list-recent-create-chat__avatar --image\" :src=\"preparedAvatar\" :alt=\"chatTitle\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-list-recent-item__content_container\">\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-item__content_header\">\n\t\t\t\t\t\t\t<div class=\"bx-im-list-recent-create-chat__header\">\n\t\t\t\t\t\t\t\t{{ preparedTitle }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-list-recent-item__content_bottom\">\n\t\t\t\t\t\t\t<div class=\"bx-im-list-recent-item__message_container\">\n\t\t\t\t\t\t\t\t{{ loc('IM_LIST_RECENT_CREATE_CHAT_SUBTITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Button as MessengerButton, ButtonSize, ButtonColor } from 'im.v2.component.elements';\n\nimport '../css/empty-state.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const EmptyState = {\n\tname: 'EmptyState',\n\tcomponents: { MessengerButton },\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tinviteUsersLink(): string\n\t\t{\n\t\t\tconst AJAX_PATH = '/bitrix/services/main/ajax.php';\n\t\t\tconst COMPONENT_NAME = 'bitrix:intranet.invitation';\n\t\t\tconst ACTION_NAME = 'getSliderContent';\n\t\t\tconst params = new URLSearchParams({\n\t\t\t\taction: ACTION_NAME,\n\t\t\t\tsite_id: Core.getSiteId(),\n\t\t\t\tc: COMPONENT_NAME,\n\t\t\t\tmode: 'ajax',\n\t\t\t});\n\n\t\t\treturn `${AJAX_PATH}?${params.toString()}`;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonInviteUsersClick()\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(this.inviteUsersLink);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent-empty-state__container\">\n\t\t\t<div class=\"bx-im-list-recent-empty-state__image\"></div>\n\t\t\t<div class=\"bx-im-list-recent-empty-state__title\">{{ loc('IM_LIST_RECENT_EMPTY_STATE_TITLE') }}</div>\n\t\t\t<div class=\"bx-im-list-recent-empty-state__subtitle\">{{ loc('IM_LIST_RECENT_EMPTY_STATE_SUBTITLE') }}</div>\n\t\t\t<div class=\"bx-im-list-recent-empty-state__button\">\n\t\t\t\t<MessengerButton\n\t\t\t\t\t:size=\"ButtonSize.L\"\n\t\t\t\t\t:isRounded=\"true\"\n\t\t\t\t\t:text=\"loc('IM_LIST_RECENT_EMPTY_STATE_INVITE_USERS')\"\n\t\t\t\t\t@click=\"onInviteUsersClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/loading-state.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const LoadingState = {\n\tname: 'LoadingState',\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent-loading-state__container\"></div>\n\t`,\n};\n","import {EventEmitter} from 'main.core.events';\nimport {Type} from 'main.core';\nimport {Utils} from 'im.v2.lib.utils';\n\nexport class BroadcastManager extends EventEmitter\n{\n\tstatic instance = null;\n\tstatic channelName = 'im-recent';\n\tstatic eventNamespace = 'BX.Messenger.v2.Recent.BroadcastManager';\n\tstatic events = {\n\t\trecentListUpdate: 'recentListUpdate'\n\t};\n\n\tstatic getInstance()\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(BroadcastManager.eventNamespace);\n\t\tthis.init();\n\t}\n\n\tisSupported()\n\t{\n\t\treturn !Type.isUndefined(window.BroadcastChannel) && !Utils.platform.isBitrixDesktop();\n\t}\n\n\tinit()\n\t{\n\t\tif (!this.isSupported())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.channel = new BroadcastChannel(BroadcastManager.channelName);\n\t\tthis.channel.addEventListener('message', ({data: {type, data}}) => {\n\t\t\tthis.emit(type, data);\n\t\t});\n\t}\n\n\tsendRecentList(recentData: Object)\n\t{\n\t\tif (!this.isSupported())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.channel.postMessage({\n\t\t\ttype: BroadcastManager.events.recentListUpdate,\n\t\t\tdata: recentData\n\t\t});\n\t}\n}","import {EventEmitter, BaseEvent} from 'main.core.events';\n\nimport {Core} from 'im.v2.application.core';\nimport {EventType} from 'im.v2.const';\n\nimport type {OnDialogInitedEvent} from 'im.v2.const';\n\nexport class LikeManager\n{\n\tstore: Object;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t}\n\n\tinit()\n\t{\n\t\tthis.onDialogInitedHandler = this.onDialogInited.bind(this);\n\t\tEventEmitter.subscribe(EventType.dialog.onDialogInited, this.onDialogInitedHandler);\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.onDialogInited, this.onDialogInitedHandler);\n\t}\n\n\tonDialogInited(event: BaseEvent<OnDialogInitedEvent>)\n\t{\n\t\tconst { dialogId } = event.getData();\n\t\tconst recentItem = this.store.getters['recent/get'](dialogId);\n\t\tif (!recentItem || !recentItem.liked)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.store.dispatch('recent/like', {\n\t\t\tid: dialogId,\n\t\t\tliked: false,\n\t\t});\n\t}\n}\n","import { BaseEvent } from 'main.core.events';\n\nimport { ChatType, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { RecentService } from 'im.v2.provider.service';\nimport { RecentMenu } from 'im.v2.lib.menu';\nimport { DraftManager } from 'im.v2.lib.draft';\nimport { CreateChatManager } from 'im.v2.lib.create-chat';\n\nimport { RecentItem } from './components/recent-item/recent-item';\nimport { ActiveCall } from './components/active-call';\nimport { CreateChat } from './components/create-chat';\nimport { EmptyState } from './components/empty-state';\nimport { LoadingState } from './components/loading-state';\n\nimport { BroadcastManager } from './classes/broadcast-manager';\nimport { LikeManager } from './classes/like-manager';\n\nimport './css/recent-list.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelRecentItem, ImModelCallItem } from 'im.v2.model';\n\n// @vue/component\nexport const RecentList = {\n\tname: 'RecentList',\n\tcomponents: { LoadingState, RecentItem, ActiveCall, CreateChat, EmptyState },\n\temits: ['chatClick'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tisLoadingNextPage: false,\n\t\t\tlistIsScrolled: false,\n\t\t\tisCreatingChat: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tcollection(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.getRecentService().getCollection();\n\t\t},\n\t\tisEmptyCollection(): boolean\n\t\t{\n\t\t\treturn this.collection.length === 0;\n\t\t},\n\t\tpreparedItems(): ImModelRecentItem[]\n\t\t{\n\t\t\tconst filteredCollection = this.collection.filter((item) => {\n\t\t\t\tlet result = true;\n\t\t\t\tif (!this.showBirthdays && item.isBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\n\t\t\t\tif (item.isFakeElement && !this.isFakeItemNeeded(item))\n\t\t\t\t{\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\treturn [...filteredCollection].sort((a, b) => {\n\t\t\t\tconst firstDate = this.$store.getters['recent/getMessageDate'](a.dialogId);\n\t\t\t\tconst secondDate = this.$store.getters['recent/getMessageDate'](b.dialogId);\n\n\t\t\t\treturn secondDate - firstDate;\n\t\t\t});\n\t\t},\n\t\tactiveCalls(): ImModelCallItem[]\n\t\t{\n\t\t\treturn this.$store.getters['recent/calls/get'];\n\t\t},\n\t\tpinnedItems(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.preparedItems.filter((item) => {\n\t\t\t\treturn item.pinned === true;\n\t\t\t});\n\t\t},\n\t\tgeneralItems(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.preparedItems.filter((item) => {\n\t\t\t\treturn item.pinned === false;\n\t\t\t});\n\t\t},\n\t\tshowBirthdays(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showBirthday);\n\t\t},\n\t\tshowInvited(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showInvited);\n\t\t},\n\t\tfirstPageLoaded(): boolean\n\t\t{\n\t\t\treturn this.getRecentService().firstPageIsLoaded;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tthis.contextMenuManager = new RecentMenu();\n\n\t\tthis.initBroadcastManager();\n\t\tthis.initLikeManager();\n\t\tthis.initCreateChatManager();\n\n\t\tthis.isLoading = true;\n\t\tawait this.getRecentService().loadFirstPage({ ignorePreloadedItems: true });\n\t\tthis.isLoading = false;\n\n\t\tDraftManager.getInstance().initDraftHistory();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenuManager.destroy();\n\t\tthis.destroyBroadcastManager();\n\t\tthis.destroyLikeManager();\n\t\tthis.destroyCreateChatManager();\n\t},\n\tmethods:\n\t{\n\t\tasync onScroll(event)\n\t\t{\n\t\t\tthis.listIsScrolled = event.target.scrollTop > 0;\n\n\t\t\tthis.contextMenuManager.close();\n\t\t\tif (!this.oneScreenRemaining(event) || !this.getRecentService().hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoadingNextPage = true;\n\t\t\tawait this.getRecentService().loadNextPage();\n\t\t\tthis.isLoadingNextPage = false;\n\t\t},\n\t\tonClick(item)\n\t\t{\n\t\t\tthis.$emit('chatClick', item.dialogId);\n\t\t},\n\t\tonRightClick(item, event)\n\t\t{\n\t\t\tif (Utils.key.isCombination(event, 'Alt+Shift'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst context = {\n\t\t\t\t...item,\n\t\t\t\tcompactMode: false,\n\t\t\t};\n\n\t\t\tthis.contextMenuManager.openMenu(context, event.currentTarget);\n\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tonCallClick({ item, $event })\n\t\t{\n\t\t\tthis.onClick(item, $event);\n\t\t},\n\t\toneScreenRemaining(event): boolean\n\t\t{\n\t\t\tconst bottomPointOfVisibleContent = event.target.scrollTop + event.target.clientHeight;\n\t\t\tconst containerHeight = event.target.scrollHeight;\n\t\t\tconst oneScreenHeight = event.target.clientHeight;\n\n\t\t\treturn bottomPointOfVisibleContent >= containerHeight - oneScreenHeight;\n\t\t},\n\t\tinitBroadcastManager()\n\t\t{\n\t\t\tthis.onRecentListUpdate = (event) => {\n\t\t\t\tthis.getRecentService().setPreloadedData(event.data);\n\t\t\t};\n\t\t\tthis.broadcastManager = BroadcastManager.getInstance();\n\t\t\tthis.broadcastManager.subscribe(BroadcastManager.events.recentListUpdate, this.onRecentListUpdate);\n\t\t},\n\t\tdestroyBroadcastManager()\n\t\t{\n\t\t\tthis.broadcastManager = BroadcastManager.getInstance();\n\t\t\tthis.broadcastManager.unsubscribe(BroadcastManager.events.recentListUpdate, this.onRecentListUpdate);\n\t\t},\n\t\tinitLikeManager()\n\t\t{\n\t\t\tthis.likeManager = new LikeManager();\n\t\t\tthis.likeManager.init();\n\t\t},\n\t\tdestroyLikeManager()\n\t\t{\n\t\t\tthis.likeManager.destroy();\n\t\t},\n\t\tinitCreateChatManager()\n\t\t{\n\t\t\tif (CreateChatManager.getInstance().isCreating())\n\t\t\t{\n\t\t\t\tthis.isCreatingChat = true;\n\t\t\t}\n\n\t\t\tthis.onCreationStatusChange = (event: BaseEvent<boolean>) => {\n\t\t\t\tthis.isCreatingChat = event.getData();\n\t\t\t};\n\t\t\tCreateChatManager.getInstance().subscribe(\n\t\t\t\tCreateChatManager.events.creationStatusChange,\n\t\t\t\tthis.onCreationStatusChange,\n\t\t\t);\n\t\t},\n\t\tdestroyCreateChatManager()\n\t\t{\n\t\t\tCreateChatManager.getInstance().unsubscribe(\n\t\t\t\tCreateChatManager.events.creationStatusChange,\n\t\t\t\tthis.onCreationStatusChange,\n\t\t\t);\n\t\t},\n\t\tisFakeItemNeeded(item: ImModelRecentItem): boolean\n\t\t{\n\t\t\tconst dialog = this.$store.getters['chats/get'](item.dialogId, true);\n\t\t\tconst isUser = dialog.type === ChatType.user;\n\t\t\tconst hasBirthday = isUser && this.showBirthdays && this.$store.getters['users/hasBirthday'](item.dialogId);\n\n\t\t\treturn this.showInvited || hasBirthday;\n\t\t},\n\t\tgetRecentService(): RecentService\n\t\t{\n\t\t\tif (!this.service)\n\t\t\t{\n\t\t\t\tthis.service = RecentService.getInstance();\n\t\t\t}\n\n\t\t\treturn this.service;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-recent__scope bx-im-list-recent__container\">\n\t\t\t<div v-if=\"activeCalls.length > 0\" class=\"bx-im-list-recent__calls_container\" :class=\"{'--with-shadow': listIsScrolled}\">\n\t\t\t\t<ActiveCall\n\t\t\t\t\tv-for=\"activeCall in activeCalls\"\n\t\t\t\t\t:key=\"activeCall.dialogId\"\n\t\t\t\t\t:item=\"activeCall\"\n\t\t\t\t\t@click=\"onCallClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<CreateChat v-if=\"isCreatingChat\"></CreateChat>\n\t\t\t<LoadingState v-if=\"isLoading && !firstPageLoaded\" />\n\t\t\t<div v-else @scroll=\"onScroll\" class=\"bx-im-list-recent__scroll-container\">\n\t\t\t\t<EmptyState v-if=\"isEmptyCollection\" />\n\t\t\t\t<div v-if=\"pinnedItems.length > 0\" class=\"bx-im-list-recent__pinned_scope bx-im-list-recent__pinned_container\">\n\t\t\t\t\t<RecentItem\n\t\t\t\t\t\tv-for=\"item in pinnedItems\"\n\t\t\t\t\t\t:key=\"item.dialogId\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t@click=\"onClick(item, $event)\"\n\t\t\t\t\t\t@click.right=\"onRightClick(item, $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-list-recent__general_container\">\n\t\t\t\t\t<RecentItem\n\t\t\t\t\t\tv-for=\"item in generalItems\"\n\t\t\t\t\t\t:key=\"item.dialogId\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t@click=\"onClick(item, $event)\"\n\t\t\t\t\t\t@click.right=\"onRightClick(item, $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\t\n\t\t\t\t<LoadingState v-if=\"isLoadingNextPage\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["MessageText","props","item","type","Object","required","data","computed","recentItem","dialog","$store","getters","dialogId","user","message","needsBirthdayPlaceholder","needsVacationPlaceholder","showLastMessage","Settings","recent","hiddenMessageText","isUser","loc","isLastMessageAuthor","authorId","Core","getUserId","lastMessageAuthorAvatar","authorDialog","avatar","lastMessageAuthorAvatarStyle","backgroundImage","messageText","isDeleted","formattedText","Parser","purifyRecent","formattedMessageText","SPLIT_INDEX","Utils","text","insertUnseenWhitespace","preparedDraftContent","phrase","PLACEHOLDER_LENGTH","length","prefix","slice","Text","encode","formattedDraftText","purify","draft","showIconIfEmptyText","formattedVacationEndDate","DateTimeFormat","format","absent","ChatType","isChat","methods","phraseCode","replacements","$Bitrix","Loc","getMessage","template","ItemCounter","name","isChatMuted","Boolean","isSelfChat","id","invitation","formattedCounter","counter","toString","showCounterContainer","isActive","showPinnedIcon","pinned","unread","showUnreadWithoutCounter","showUnreadWithCounter","showCounter","StatusIcon","none","like","sending","sent","viewed","MessageStatus","messageStatus","OwnMessageStatus","viewedByOthers","statusIcon","isBot","hasDraft","liked","bot","RecentItem","components","Avatar","ChatTitle","AvatarSize","formattedDate","formatDate","date","layout","isChatSelected","Layout","chat","entityId","isMuted","muteList","find","element","isSomeoneTyping","writingList","wrapClasses","itemClasses","DateFormatter","formatByTemplate","DateTemplate","ActiveCall","MessengerButton","emits","ButtonSize","ButtonColor","ButtonIcon","activeCall","preparedName","decode","anotherDeviceColorScheme","backgroundColor","borderColor","iconColor","textColor","hoverColor","isTabWithActiveCall","getCallManager","hasCurrentCall","hasJoined","state","RecentCallStatus","joined","onJoinClick","joinCall","call","onLeaveCallClick","leaveCurrentCall","onClick","event","$emit","$event","returnToCall","unfoldCurrentCall","CallManager","getInstance","DefaultTitleByChatType","videoconf","CreateChat","chatTitle","chatAvatarFile","chatType","chatCreationIsOpened","currentLayoutName","createChat","preparedTitle","preparedAvatar","URL","createObjectURL","created","existingTitle","CreateChatManager","getChatTitle","existingAvatar","getChatAvatar","getChatType","subscribe","events","titleChange","getData","avatarChange","chatTypeChange","LayoutManager","setLayout","EmptyState","inviteUsersLink","AJAX_PATH","COMPONENT_NAME","ACTION_NAME","params","URLSearchParams","action","site_id","getSiteId","c","mode","onInviteUsersClick","BX","SidePanel","Instance","open","LoadingState","BroadcastManager","EventEmitter","instance","constructor","setEventNamespace","eventNamespace","init","isSupported","Type","isUndefined","window","BroadcastChannel","platform","isBitrixDesktop","channel","channelName","addEventListener","emit","sendRecentList","recentData","postMessage","recentListUpdate","LikeManager","store","getStore","onDialogInitedHandler","onDialogInited","bind","EventType","destroy","unsubscribe","dispatch","RecentList","isLoading","isLoadingNextPage","listIsScrolled","isCreatingChat","collection","getRecentService","getCollection","isEmptyCollection","preparedItems","filteredCollection","filter","result","showBirthdays","isBirthdayPlaceholder","isFakeElement","isFakeItemNeeded","sort","a","b","firstDate","secondDate","activeCalls","pinnedItems","generalItems","showBirthday","showInvited","firstPageLoaded","firstPageIsLoaded","contextMenuManager","RecentMenu","initBroadcastManager","initLikeManager","initCreateChatManager","loadFirstPage","ignorePreloadedItems","DraftManager","initDraftHistory","beforeUnmount","destroyBroadcastManager","destroyLikeManager","destroyCreateChatManager","onScroll","target","scrollTop","close","oneScreenRemaining","hasMoreItemsToLoad","loadNextPage","onRightClick","key","isCombination","context","compactMode","openMenu","currentTarget","preventDefault","onCallClick","bottomPointOfVisibleContent","clientHeight","containerHeight","scrollHeight","oneScreenHeight","onRecentListUpdate","setPreloadedData","broadcastManager","likeManager","isCreating","onCreationStatusChange","creationStatusChange","hasBirthday","service","RecentService"],"mappings":"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"}