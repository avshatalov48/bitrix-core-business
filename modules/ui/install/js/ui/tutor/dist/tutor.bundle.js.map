{"version":3,"file":"tutor.bundle.js","sources":["../src/step.js","../src/manager.js","../src/scenario.js"],"sourcesContent":["import { Type, Event } from 'main.core';\n\nexport class Step extends Event.EventEmitter\n{\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Tutor.Step');\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\n\t\tthis.id = options.id || null;\n\t\tthis.title = options.title || null;\n\t\tthis.description = options.description || null;\n\t\tthis.url = options.url || '';\n\t\tthis.isCompleted = options.isCompleted || false;\n\t\tthis.video = options.video || null;\n\t\tthis.helpLink = options.helpLink || null;\n\t\tthis.highlight = options.highlight || null;\n\t\tthis.isActive = options.isActive === true;\n\t\tthis.isShownForSlider = options.isShownForSlider || false;\n\t\tthis.initOptions = options;\n\n\t\tthis.videoObj = null;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {string}\n\t */\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Object}\n\t */\n\tgetVideoObj()\n\t{\n\t\treturn this.videoObj;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetHighlightOptions()\n\t{\n\t\treturn this.highlight;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {string}\n\t */\n\tgetDescription()\n\t{\n\t\treturn this.description;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {string}\n\t */\n\tgetUrl()\n\t{\n\t\treturn this.url;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Boolean}\n\t */\n\tgetCompleted()\n\t{\n\t\treturn this.isCompleted;\n\t}\n\n\tgetVideo()\n\t{\n\t\treturn this.video;\n\t}\n\n\tgetHelpLink()\n\t{\n\t\treturn this.helpLink;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {string}\n\t */\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Object}\n\t */\n\tgetInitOptions()\n\t{\n\t\treturn this.initOptions;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tactivate()\n\t{\n\t\tthis.isActive = true;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tgetShownForSlider()\n\t{\n\t\treturn this.isShownForSlider;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tdeactivate()\n\t{\n\t\tthis.isActive = false;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic getFullEventName(shortName)\n\t{\n\t\treturn shortName;\n\t}\n}","import { Dom, Event, Tag, Loc, Type } from 'main.core';\nimport { Scenario } from './scenario';\nimport { Step } from './step';\nimport { Guide } from 'ui.tour';\nimport { Loader } from \"main.loader\";\nimport 'ui.feedback.form';\n\nexport class Manager extends Event.EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Tutor.Manager');\n\t}\n\n\tsetOptions(options, domain, feedbackFormId)\n\t{\n\t\toptions = options || {};\n\n\t\tthis.tutorialData = options.tutorialData || {};\n\t\tthis.eventService = options.eventService || {};\n\t\tthis.lastCheckTime = options.lastCheckTime || 0;\n\t\tthis.domain = options.domain || '';\n\t\tthis.feedbackFormId = options.feedbackFormId || '';\n\t\tif(Type.isString(domain) && domain.length > 0)\n\t\t{\n\t\t\tthis.domain = domain;\n\t\t}\n\t\tif(Type.isString(feedbackFormId) && feedbackFormId.length > 0)\n\t\t{\n\t\t\tthis.feedbackFormId = feedbackFormId;\n\t\t}\n\t}\n\n\tgetDomain()\n\t{\n\t\treturn this.domain;\n\t}\n\n\tgetCurrentTutorialData()\n\t{\n\t\treturn this.tutorialData;\n\t}\n\n\tgetCurrentEventService()\n\t{\n\t\treturn this.eventService;\n\t}\n\n\tgetCurrentLastCheckTime()\n\t{\n\t\treturn this.lastCheckTime;\n\t}\n\n\t/**\n\t * @return {Manager}\n\t */\n\tstatic getInstance()\n\t{\n\t\treturn this.instance;\n\t}\n\n\t/**\n\t * @return {Scenario}\n\t */\n\tstatic getScenarioInstance()\n\t{\n\t\treturn this.scenarioInstance;\n\t}\n\n\tstatic init(options, domain, feedbackFormId)\n\t{\n\t\tlet instance = this.getInstance();\n\t\tif (!(instance instanceof Manager))\n\t\t{\n\t\t\tthis.instance = new Manager();\n\t\t\tinstance = this.getInstance();\n\t\t\tthis.emit('onInitManager');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinstance = this.getInstance();\n\t\t}\n\t\tinstance.setOptions(options, domain, feedbackFormId);\n\n\t\treturn instance;\n\t}\n\n\tstatic initScenario(options)\n\t{\n\t\tlet instance = this.getScenarioInstance();\n\t\tif (!(instance instanceof Scenario))\n\t\t{\n\t\t\tthis.scenarioInstance = new Scenario();\n\t\t\tinstance = this.getScenarioInstance();\n\t\t\tthis.emit('onInitScenario');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tinstance = this.getScenarioInstance();\n\t\t}\n\t\tinstance.setOptions(options);\n\n\t\treturn instance;\n\t}\n\n\tstatic showButton(animation)\n\t{\n\t\treturn this.getImButton(animation);\n\t}\n\n\tstatic getRootImButton()\n\t{\n\t\treturn document.getElementById('ui-tutor-btn-wrap');\n\t}\n\n\tstatic hasImButton()\n\t{\n\t\treturn !!this.getRootImButton();\n\t}\n\n\tstatic getImButton(animation)\n\t{\n\t\tif(!this.layout.imButton)\n\t\t{\n\t\t\tlet buttonWrapper = this.getRootImButton();\n\t\t\tif(buttonWrapper)\n\t\t\t{\n\t\t\t\tlet buttonInner = Tag.render`\n\t\t\t\t\t<div class=\"ui-tutor-btn\"></div>\n\t\t\t\t`;\n\t\t\t\tif (animation)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(buttonWrapper, 'ui-tutor-btn-wrap-animate');\n\t\t\t\t}\n\t\t\t\tDom.append(buttonInner, buttonWrapper);\n\t\t\t\tDom.addClass(buttonWrapper, 'ui-tutor-btn-wrap-show');\n\t\t\t\tthis.layout.imButton = buttonWrapper;\n\t\t\t\tEvent.bind(this.layout.imButton, \"click\", () => {\n\t\t\t\t\tthis.emit('clickImButton');\n\t\t\t\t});\n\n\t\t\t\tlet usersPanel = document.querySelector('.bx-im-users-wrap');\n\t\t\t\tif (document.querySelector('#bx-im-btn-call'))\n\t\t\t\t{\n\t\t\t\t\tusersPanel.style.bottom = '175px';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tusersPanel.style.bottom = '120px';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.layout.imButton;\n\t}\n\n\tstatic showSmallPopup(text)\n\t{\n\t\tthis.smallPopupText = text;\n\t\tthis.getSmallPopup().style.display = 'block';\n\t\tthis.smallPopupText = '';\n\n\t\tif (Dom.hasClass(this.getSmallPopup(), 'ui-tutor-popup-welcome-hide'))\n\t\t{\n\t\t\tDom.removeClass(this.getSmallPopup(), 'ui-tutor-popup-welcome-hide');\n\t\t}\n\t}\n\n\tstatic hideSmallPopup(skipAnimation)\n\t{\n\t\tskipAnimation = skipAnimation === true;\n\t\tconst removeHandler = function() {\n\t\t\tDom.remove(this.getSmallPopup());\n\t\t\tif(this.hasOwnProperty('smallPopup'))\n\t\t\t{\n\t\t\t\tdelete this.smallPopup;\n\t\t\t}\n\t\t\tthis.emit('onCompleteHideSmallPopup');\n\t\t}.bind(this);\n\t\tDom.removeClass(this.getSmallPopup(), 'ui-tutor-popup-welcome-show');\n\t\tDom.addClass(this.getSmallPopup(), 'ui-tutor-popup-welcome-hide');\n\t\tif(skipAnimation)\n\t\t{\n\t\t\tremoveHandler();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(removeHandler, 300);\n\t\t}\n\t}\n\n\tstatic showWelcomePopup(text)\n\t{\n\t\tthis.emit('onShowWelcomePopup');\n\t\tthis.showSmallPopup(text);\n\t}\n\n\tstatic hideWelcomePopup()\n\t{\n\t\tthis.emit('onBeforeHideWelcomePopup');\n\t\tthis.hideSmallPopup();\n\t\tthis.emit('onAfterHideWelcomePopup');\n\t}\n\n\tstatic showNoticePopup(text)\n\t{\n\t\tthis.emit('onShowNoticePopup');\n\t\tthis.showSmallPopup(text);\n\t}\n\n\tstatic hideNoticePopup()\n\t{\n\t\tthis.emit('onBeforeHideNoticePopup');\n\t\tthis.hideSmallPopup();\n\t\tthis.emit('onAfterHideNoticePopup');\n\t}\n\n\tstatic getSmallPopup()\n\t{\n\t\tconst clickSmallPopupHandler = () => {\n\t\t\tthis.emit('onClickSmallPopupBtn');\n\t\t};\n\t\tif (!this.smallPopup)\n\t\t{\n\t\t\tthis.smallPopup =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup\" onclick=\"${clickSmallPopupHandler.bind(this)}\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-header\">\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-icon\"></span>\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-title-wrap\">\n\t\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-title\">${Loc.getMessage('JS_UI_TUTOR_TITLE')}</span> \n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-content\">\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-text\">${this.smallPopupText}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-icon-angle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\tthis.emit('onCreateSmallPopupNode');\n\t\t\tDom.addClass(this.smallPopup, 'ui-tutor-popup-welcome-show');\n\t\t\tthis.emit('onBeforeAppendSmallPopupNode');\n\t\t\tDom.append(this.smallPopup, document.body);\n\t\t\tthis.emit('onAfterAppendSmallPopupNode');\n\t\t}\n\n\t\treturn this.smallPopup;\n\t}\n\n\tstatic showStartPopup(title, text)\n\t{\n\t\tthis.emit('onShowStartPopup');\n\t\tthis.startTitle = title;\n\t\tthis.startText = text;\n\t\tDom.addClass(this.getStartPopup(), 'ui-tutor-popup-show');\n\t\tthis.startPopup.style.display = 'flex';\n\t\tthis.startTitle = '';\n\t\tthis.startText = '';\n\t};\n\n\tstatic closeStartPopup()\n\t{\n\t\tDom.remove(this.getStartPopup());\n\t\tdelete this.startPopup;\n\t}\n\n\tstatic getStartPopup()\n\t{\n\t\tif (!this.startPopup)\n\t\t{\n\t\t\tthis.startPopup =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup ui-tutor-popup-start\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-header\">\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-icon\"></span>\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-title-wrap\">\n\t\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-title\">${Loc.getMessage('JS_UI_TUTOR_TITLE')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-content\">\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-title\">${this.startTitle}</div>\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-text\">${this.startText}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-footer\">\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-btn\">\n\t\t\t\t\t\t\t\t${this.getBeginBtn()}\n\t\t\t\t\t\t\t\t${this.getDeferBtn()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-icon-angle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\tthis.emit('onCreateStartPopupNode');\n\t\t\tDom.append(this.startPopup, document.body);\n\t\t\tthis.emit('onAfterAppendStartPopupNode');\n\t\t}\n\n\t\treturn this.startPopup;\n\t}\n\n\tstatic getBeginBtn()\n\t{\n\t\tif (!this.beginBtn)\n\t\t{\n\t\t\tthis.beginBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-round\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_BEGIN')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\tEvent.bind(this.beginBtn, \"click\", ()=> {\n\t\t\t\tthis.emit('clickBeginBtn');\n\t\t\t});\n\t\t}\n\n\t\treturn this.beginBtn;\n\t}\n\n\tstatic getDeferBtn()\n\t{\n\t\tif (!this.deferBtn)\n\t\t{\n\t\t\tthis.deferBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-link\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_CLOSE_POPUP_BTN')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\tEvent.bind(this.deferBtn, \"click\", () => {\n\t\t\t\tthis.emit('clickDeferBtn');\n\t\t\t});\n\t\t}\n\n\t\treturn this.deferBtn;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic getFullEventName(shortName)\n\t{\n\t\treturn shortName;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tstatic getInformer()\n\t{\n\t\tif (!this.informer)\n\t\t{\n\t\t\tthis.informer =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-informer\" id=\"ui-tutor-informer\"></div>\n\t\t\t\t`;\n\t\t\tlet informerParentNode = this.getImButton();\n\t\t\tif(this.isCollapsedShow)\n\t\t\t{\n\t\t\t\tinformerParentNode = this.getCollapseBlock();\n\t\t\t}\n\t\t\tif(informerParentNode)\n\t\t\t{\n\t\t\t\tDom.append(this.informer, informerParentNode);\n\t\t\t}\n\t\t}\n\n\t\treturn this.informer;\n\t}\n\n\tstatic setCount(num)\n\t{\n\t\tthis.emit('onBeforeSetCount');\n\t\tif (num < 1)\n\t\t{\n\t\t\tthis.removeInformer();\n\t\t\tdelete this.informer;\n\t\t\tthis.isInformerShow = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getInformer().textContent = num;\n\t\t\tthis.isInformerShow = true;\n\t\t}\n\t\tthis.emit('onAfterSetCount');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic removeInformer()\n\t{\n\t\tif(this.isInformerShow)\n\t\t{\n\t\t\tDom.remove(this.getInformer());\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic showCollapsedBlock(step, withGuide, showAfterAnimation)\n\t{\n\t\twithGuide = withGuide !== false;\n\t\tshowAfterAnimation = showAfterAnimation !== false;\n\t\tthis.emit('onBeforeShowCollapsedBlock');\n\t\tif(!this.isCollapsedShow)\n\t\t{\n\t\t\tthis.emit('onStartShowCollapsedBlock');\n\t\t\tif(!(step instanceof Step))\n\t\t\t{\n\t\t\t\tstep = new Step(step);\n\t\t\t}\n\t\t\tthis.collapsedStep = step;\n\n\t\t\tlet collapsedBlock = this.getCollapseBlock();\n\t\t\tlet showFunction = function() {\n\t\t\t\tcollapsedBlock.style.display = 'flex';\n\t\t\t};\n\t\t\tif(showAfterAnimation)\n\t\t\t{\n\t\t\t\tsetTimeout(showFunction.bind(this), 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tshowFunction.call(this);\n\t\t\t}\n\t\t\tthis.getCollapseTitle().innerHTML = step.getTitle();\n\t\t\tif(this.isInformerShow)\n\t\t\t{\n\t\t\t\tDom.append(this.getInformer(), collapsedBlock);\n\t\t\t}\n\t\t\tthis.isCollapsedShow = true;\n\t\t\tthis.emit('onShowCollapsedBlock');\n\t\t}\n\n\t\tif (withGuide)\n\t\t{\n\t\t\tthis.showGuide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.checkButtonsState();\n\t\t}\n\t}\n\n\tstatic setCollapsedInvisible()\n\t{\n\t\tthis.hideNode(this.getCollapseBlock());\n\t}\n\n\tstatic setCollapsedVisible()\n\t{\n\t\tthis.showNode(this.getCollapseBlock());\n\t}\n\n\tstatic checkButtonsState()\n\t{\n\t\tthis.emit('onCheckButtonsState');\n\t\tlet step = this.collapsedStep;\n\t\tif(!step)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(step.getCompleted())\n\t\t{\n\t\t\tif(this.activeGuide)\n\t\t\t{\n\t\t\t\tthis.hideNode(this.getRepeatBtn());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showNode(this.getRepeatBtn());\n\t\t\t}\n\t\t\tthis.hideNode(this.getCompletedBtn());\n\t\t\tthis.hideNode(this.getStartBtn());\n\t\t}\n\t\telse if(step.isActive)\n\t\t{\n\t\t\tthis.showNode(this.getCompletedBtn());\n\t\t\tif(this.activeGuide || !this.isShowRepeatWithCompleted)\n\t\t\t{\n\t\t\t\tthis.hideNode(this.getRepeatBtn());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showNode(this.getRepeatBtn());\n\t\t\t}\n\t\t\tthis.hideNode(this.getStartBtn());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNode(this.getStartBtn());\n\t\t\tthis.hideNode(this.getRepeatBtn());\n\t\t\tthis.hideNode(this.getCompletedBtn());\n\t\t}\n\t}\n\n\tstatic showGuide()\n\t{\n\t\tthis.emit('onBeforeShowGuide');\n\t\tlet step = this.collapsedStep;\n\t\tif (!this.activeGuide && step)\n\t\t{\n\t\t\tthis.emit('onStartShowGuide');\n\t\t\tthis.activeGuide = new Guide({\n\t\t\t\tsimpleMode: true,\n\t\t\t\tsteps: [\n\t\t\t\t\tstep.getHighlightOptions()\n\t\t\t\t],\n\t\t\t});\n\t\t\tthis.activeGuide.subscribe(Guide.getFullEventName(\"onFinish\"), this.finishGuide.bind(this));\n\t\t\tthis.activeGuide.start();\n\t\t\tDom.remove(this.activeGuide.getPopup().closeIcon);\n\t\t\tthis.emit('showCollapseWithGuide');\n\t\t\tthis.checkButtonsState();\n\t\t}\n\t}\n\n\tstatic closeGuide()\n\t{\n\t\tif(this.activeGuide instanceof Guide)\n\t\t{\n\t\t\tthis.activeGuide.close();\n\t\t\tthis.emit('onAfterGuide');\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic getCollapseBlock()\n\t{\n\t\tif (!this.layout.collapseBlock)\n\t\t{\n\t\t\tthis.layout.collapseBlock =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup ui-tutor-popup-collapse\" onclick=\"${this.clickCollapseBlockHandler.bind(this)}\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-content\">\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-step-subject\">${Loc.getMessage('JS_UI_TUTOR_STEP_TITLE')}</div>\n\t\t\t\t\t\t\t${this.getCollapseTitle()}\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-collapse-btn\">\n\t\t\t\t\t\t\t\t${this.getStartBtn()}\n\t\t\t\t\t\t\t\t${this.getRepeatBtn()}\n\t\t\t\t\t\t\t\t${this.getCompletedBtn()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\tthis.emit('onCreateCollapsedBlockNode');\n\t\t\tDom.append(this.layout.collapseBlock, document.body);\n\t\t\tthis.emit('onAfterAppendCollapsedBlockNode');\n\t\t}\n\n\t\treturn this.layout.collapseBlock;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic getStartBtn()\n\t{\n\t\tif (!this.startBtn)\n\t\t{\n\t\t\tthis.startBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-round ui-btn-xs\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_START')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\tEvent.bind(this.startBtn, \"click\", (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.emit('clickStartBtn');\n\t\t\t});\n\t\t}\n\n\t\treturn this.startBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic getRepeatBtn()\n\t{\n\t\tif (!this.repeatBtn)\n\t\t{\n\t\t\tthis.repeatBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-round ui-btn-xs\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_REPEAT')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\tEvent.bind(this.repeatBtn, \"click\", (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.emit('clickRepeatBtn');\n\t\t\t});\n\t\t}\n\n\t\treturn this.repeatBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic getCompletedBtn()\n\t{\n\t\tif (!this.completedBtn)\n\t\t{\n\t\t\tthis.completedBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-success ui-btn-round ui-btn-xs\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_COMPLETED_SHORT')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\n\t\t\tEvent.bind(this.completedBtn, \"click\", (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.emit('clickCompletedBtn');\n\t\t\t});\n\t\t}\n\n\t\treturn this.completedBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic getCollapseTitle()\n\t{\n\t\tif (!this.layout.collapseTitle)\n\t\t{\n\t\t\tthis.layout.collapseTitle =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-step-title\"></div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.collapseTitle;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tstatic closeCollapsePopup(event)\n\t{\n\t\tthis.closeCollapseEntity();\n\t\tthis.emit('clickCloseCollapseBlock');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic clickCollapseBlockHandler()\n\t{\n\t\tthis.emit('clickCollapseBlock');\n\t}\n\n\tstatic finishGuide()\n\t{\n\t\tdelete this.activeGuide;\n\t\tthis.checkButtonsState();\n\t\tthis.emit('completeCloseGuide');\n\t}\n\n\tstatic closeCollapseEntity()\n\t{\n\t\tthis.emit('onBeforeHideCollapsedBlock');\n\t\tthis.getCollapseBlock().style.display = 'none';\n\t\tthis.getImButton().style.display = 'block';\n\t\tif(this.activeGuide instanceof Guide)\n\t\t{\n\t\t\tthis.activeGuide.close();\n\t\t}\n\t\tif(this.isInformerShow)\n\t\t{\n\t\t\tDom.append(this.getInformer(), this.getImButton());\n\t\t}\n\t\tdelete this.collapsedStep;\n\t\tthis.isCollapsedShow = false;\n\t\tthis.emit('onHideCollapsedBlock');\n\t}\n\n\tstatic showLoader()\n\t{\n\t\tthis.emit('onBeforeShowLoader');\n\t\tthis.startTitle = '';\n\t\tthis.startText = '';\n\t\tthis.layout.loader = new Loader({\n\t\t\ttarget: this.getStartPopup(),\n\t\t\tsize: 85\n\t\t});\n\t\tthis.layout.loader.show();\n\t\tthis.getStartPopup().style.display = 'flex';\n\t\tDom.addClass(this.getStartPopup(), \"ui-tutor-popup-load\");\n\t\tthis.emit('onAfterShowLoader');\n\t}\n\n\tstatic hideLoader()\n\t{\n\t\tif (this.layout.loader)\n\t\t{\n\t\t\tthis.layout.loader.destroy();\n\t\t\tthis.getStartPopup().style.display = 'none';\n\t\t}\n\t}\n\n\tstatic showCollapsedLoader()\n\t{\n\t\tthis.emit('onBeforeShowCollapsedLoader');\n\t\tthis.layout.collapseLoader = new Loader({\n\t\t\ttarget: this.getCollapseBlock(),\n\t\t\tsize: 34\n\t\t});\n\t\tthis.layout.collapseLoader.show();\n\t\tthis.getCollapseBlock().style.display = 'flex';\n\t\tDom.addClass(this.getCollapseBlock(), \"ui-tutor-popup-collapse-load\");\n\t\tthis.emit('onAfterShowCollapsedLoader');\n\t}\n\n\tstatic hideCollapsedLoader()\n\t{\n\t\tthis.emit('onBeforeHideCollapsedLoader');\n\t\tif (this.layout.collapseLoader)\n\t\t{\n\t\t\tthis.layout.collapseLoader.destroy();\n\t\t\tDom.removeClass(this.getCollapseBlock(), \"ui-tutor-popup-collapse-load\");\n\t\t\tthis.getCollapseBlock().style.display = 'none';\n\t\t}\n\t\tthis.emit('onAfterHideCollapsedLoader');\n\t}\n\n\tstatic showNode (node)\n\t{\n\t\tnode.style.display = 'block';\n\t}\n\n\tstatic hideNode (node)\n\t{\n\t\tnode.style.display = 'none';\n\t}\n\n\tstatic checkFollowLink(step, scenario)\n\t{\n\t\tthis.emit('onStartCheckFollowLink');\n\t\tstep = step || this.collapsedStep;\n\t\tif(step instanceof Step)\n\t\t{\n\t\t\tscenario = scenario || {};\n\t\t\tif (!(window.location.pathname === step.getUrl()))\n\t\t\t{\n\t\t\t\tlet beforeEvent = 'onBeforeRedirectToActionPage';\n\t\t\t\tif(scenario instanceof Scenario)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(scenario.getStartBtn(), 'ui-btn-wait');\n\t\t\t\t\tscenario.fireCurrentStepEvent(beforeEvent);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(this.getStartBtn(), 'ui-btn-wait');\n\t\t\t\t\tthis.emit(beforeEvent, {step});\n\t\t\t\t}\n\t\t\t\twindow.location = step.getUrl();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(scenario instanceof Scenario)\n\t\t\t\t{\n\t\t\t\t\tscenario.showCollapseBlock(step);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstep.activate();\n\t\t\t\t\tthis.showCollapsedBlock(step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.emit('onFinishCheckFollowLink');\n\t}\n\n\tstatic fireEvent(eventName)\n\t{\n\t\tthis.emit(eventName);\n\t}\n}\n\n/**\n * @private\n */\nManager.instance = null;\nManager.scenarioInstance = null;\nManager.activeGuide = null;\nManager.isShowRepeatWithCompleted = true;\nManager.layout = {\n\timButton: null,\n\tcollapseBlock: null,\n\tcollapseTitle: null,\n};","import { Type, Dom, Event, Tag, Loc } from 'main.core';\nimport {Step} from './step.js';\nimport {Manager} from './manager.js';\n\nexport class Scenario extends Event.EventEmitter {\n\tconstructor(options = {}) {\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.UI.Tutor.Scenario');\n\n\t\tthis.stepPopup = null;\n\t\tthis.arrowTimer = null;\n\t\tthis.guide = null;\n\t\tthis.loader = null;\n\n\t\tthis.arrowWrap = null;\n\t\tthis.prevArrow = null;\n\t\tthis.nextArrow = null;\n\n\t\tthis.currentStepIndex = 0;\n\t\tthis.currentStep = null;\n\t\tthis.isAddedSteps = false;\n\t\tthis.hasArrows = false;\n\n\t\tthis.isLoading = true;\n\n\t\tthis.setOptions(options);\n\n\t\tthis.btn = document.getElementById('ui-tutor-btn-wrap');\n\t\tthis.informer = document.getElementById('ui-tutor-informer');\n\n\t\tthis.layout = {\n\t\t\tstepBlock: null,\n\t\t\tprogress: null,\n\t\t\tcounter: null,\n\t\t\tcounterContainer: null,\n\t\t\ttitle: null,\n\t\t\tdescription: null,\n\t\t\tcollapseBlock: null,\n\t\t\tcollapseTitle: null,\n\t\t\tcollapseDescription: null,\n\t\t\tcontent: null,\n\t\t\tcontentInner: null,\n\t\t\tcontentBlock: null,\n\t\t\turl: null,\n\t\t\ttarget: null,\n\t\t\tstartBtn: null,\n\t\t\tnextBtn: null,\n\t\t\trepeatBtn: null,\n\t\t\tdeferBtn: null,\n\t\t\thelp: null,\n\t\t\tcompletedBtn: null,\n\t\t\tcompletedBlock: null,\n\t\t\tfinishedBlock: null,\n\t\t\tsupportLink: null\n\t\t};\n\n\t\tthis.sections = [\n\t\t\t'settings',\n\t\t\t'scenario',\n\t\t\t'work'\n\t\t];\n\n\t\tthis.loadYoutubeApiScript();\n\n\t\tthis.subscribe(\"onYouTubeReady\", () => {\n\t\t\tthis.setVideoItems();\n\t\t});\n\t}\n\n\tloadYoutubeApiScript()\n\t{\n\t\tconst onYouTubeReadyEvent = function() {\n\t\t\tthis.emit(\"onYouTubeReady\", { scenario: this});\n\t\t}.bind(this);\n\n\t\tif (!window.YT)\n\t\t{\n\t\t\tlet isNeedCheckYT = true;\n\t\t\tconst tag = document.createElement('script');\n\t\t\ttag.src = \"https://www.youtube.com/iframe_api\";\n\t\t\tconst firstScriptTag = document.getElementsByTagName('script')[0];\n\t\t\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n\n\t\t\tlet ytCheckerTimer = setInterval(function() {\n\t\t\t\tif (isNeedCheckYT)\n\t\t\t\t{\n\t\t\t\t\tif (window.YT && Type.isFunction(window.YT.Player))\n\t\t\t\t\t{\n\t\t\t\t\t\tclearInterval(ytCheckerTimer);\n\t\t\t\t\t\tonYouTubeReadyEvent();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 200);\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tclearInterval(ytCheckerTimer);\n\t\t\t\tisNeedCheckYT = false;\n\t\t\t}, 2000);\n\t\t}\n\t\telse {\n\t\t\tsetTimeout(function() {\n\t\t\t\tonYouTubeReadyEvent();\n\t\t\t}.bind(this), 100);\n\t\t}\n\n\t}\n\n\tsetOptions (options)\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeSetOptions', false);\n\t\toptions = Type.isPlainObject(options) ? options : {};\n\t\tlet currentStep = this.getCurrentStep();\n\n\t\t/** @var {Step[]} */\n\t\tthis.steps = [];\n\t\tif (Array.isArray(options.steps))\n\t\t{\n\t\t\toptions.steps.forEach(step => {\n\t\t\t\tthis.steps.push(new Step(step));\n\t\t\t});\n\t\t}\n\t\tif (currentStep instanceof Step)\n\t\t{\n\t\t\tlet stepInList = this.findStepById(currentStep.getId());\n\t\t\tif (stepInList)\n\t\t\t{\n\t\t\t\tcurrentStep = stepInList;\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(options.currentStepId) && options.currentStepId.length > 0)\n\t\t{\n\t\t\tlet stepInList = this.findStepById(options.currentStepId);\n\t\t\tif (stepInList)\n\t\t\t{\n\t\t\t\tcurrentStep = stepInList;\n\t\t\t\tif(options.currentStepIsActive === true)\n\t\t\t\t{\n\t\t\t\t\tcurrentStep.activate();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!currentStep)\n\t\t{\n\t\t\tlet uncompletedStep = this.getFirstUncompletedStep();\n\t\t\tif (uncompletedStep)\n\t\t\t{\n\t\t\t\tcurrentStep = uncompletedStep;\n\t\t\t}\n\t\t}\n\t\tif (!currentStep && this.steps && this.steps[0])\n\t\t{\n\t\t\tcurrentStep = this.steps[0];\n\t\t}\n\t\tthis.setCurrentStep(currentStep);\n\n\t\tif (options)\n\t\t{\n\t\t\tthis.isLoading = false;\n\t\t}\n\n\t\tthis.title = options.title || '';\n\t\tthis.supportLink = options.supportLink || '';\n\t\tthis.isFinished = options.isFinished || false;\n\t\tthis.fireCurrentStepEvent('onAfterSetOptions', false);\n\t}\n\n\t/**\n\t * @param {Step} step\n\t */\n\tsetCurrentStep(step)\n\t{\n\t\tif (step instanceof Step)\n\t\t{\n\t\t\tthis.currentStep = step;\n\t\t\tlet steps = this.steps;\n\n\t\t\tif (Type.isArray(steps))\n\t\t\t{\n\t\t\t\tthis.currentStepIndex = steps.indexOf(step);\n\t\t\t}\n\t\t\tthis.fireCurrentStepEvent('onStartStep');\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t */\n\tstart(complexAnimation)\n\t{\n\t\tthis.emit(\"onStart\", { scenario: this});\n\n\t\tif (complexAnimation) // animate transition from collapsed popup to step popup\n\t\t{\n\t\t\tthis.complexAnimation = true;\n\t\t}\n\t\tthis.showPopup(this.getStepPopup());\n\t\tthis.toggleCompletedState();\n\t\tthis.toggleNavBtn();\n\t\tthis.setPopupData();\n\n\t\tif (this.isAddedSteps)\n\t\t{\n\t\t\tthis.hideFinalState();\n\t\t}\n\n\t\tif (!this.hasArrows)\n\t\t{\n\t\t\tthis.initArrows();\n\t\t}\n\n\t\tthis.complexAnimation = false;\n\t\tthis.fireCurrentStepEvent('onShowComplete');\n\t}\n\n\tfindStepById(stepId)\n\t{\n\t\tfor (let i = 0; i < this.steps.length; i++)\n\t\t{\n\t\t\tconst step = this.steps[i];\n\t\t\tif (step.getId() === stepId)\n\t\t\t{\n\t\t\t\treturn step;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetStepPopup()\n\t{\n\t\tconst clickOnCloseIcon = () => {\n\t\t\tthis.emit(\"onClickOnCloseIcon\", { scenario: this});\n\t\t};\n\n\t\tif (!this.stepPopup)\n\t\t{\n\t\t\tthis.stepPopup =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup ui-tutor-popup-step\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-header\">\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-icon\"></span>\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-title\">\n\t\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-counter\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_TITLE')}.\n\t\t\t\t\t\t\t\t\t${this.getCounterContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-header-subtitle\">${this.title}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t${this.getDeferLink()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-content\">\n\t\t\t\t\t\t\t${this.getContentBlock()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-step-wrap\">\n\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-step-inner\">\n\t\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-arrow-wrap\"></div>\n\t\t\t\t\t\t\t\t<div class=\"ui-tutor-popup-step-list-wrap\">\n\t\t\t\t\t\t\t\t\t${this.getStepBlock()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-icon-close\" onclick=\"${clickOnCloseIcon.bind(this)}\"></div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-icon-angle\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\tthis.fireCurrentStepEvent('onCreateStepPopupNode');\n\t\t\tDom.append(this.stepPopup, document.body);\n\t\t\tthis.fireCurrentStepEvent('onAfterAppendStepPopupNode');\n\t\t}\n\n\t\treturn this.stepPopup;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetContentBlock()\n\t{\n\t\tif (!this.layout.contentBlock)\n\t\t{\n\t\t\tthis.layout.contentBlock =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-content-block\">\n\t\t\t\t\t\t${this.getContentInner()}\n\t\t\t\t\t\t${this.getFooter()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.contentBlock;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetFooter()\n\t{\n\t\tif (!this.layout.footer)\n\t\t{\n\t\t\tthis.layout.footer =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-footer\">\n\t\t\t\t\t\t${this.getNavigation()}\n\t\t\t\t\t\t${this.getBtnContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\tif (Manager.getInstance() && Manager.getInstance().feedbackFormId) {\n\t\t\t\tDom.append(this.getSupportLink(), this.layout.footer);\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.layout.footer;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetContentInner()\n\t{\n\t\tif (!this.layout.contentInner)\n\t\t{\n\t\t\tthis.layout.contentInner =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-content-inner\">\n\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t${this.getDescription()}\n\t\t\t\t\t\t${this.getHelpBlock()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.contentInner;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetBtnContainer()\n\t{\n\t\tif (!this.layout.btnContainer)\n\t\t{\n\t\t\tthis.layout.btnContainer =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-btn\">\n\t\t\t\t\t\t${this.getStartBtn()}\n\t\t\t\t\t\t${this.getRepeatBtn()}\n\t\t\t\t\t\t${this.getCompletedBtn()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.btnContainer;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetNavigation()\n\t{\n\t\tif (!this.layout.navigation)\n\t\t{\n\t\t\tthis.layout.navigation =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-nav\"></div>\n\t\t\t\t`;\n\n\t\t\tthis.layout.backBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-nav-item ui-tutor-popup-nav-item-prev\" onclick=\"${this.clickOnBackBtn.bind(this)}\"></span>\n\t\t\t\t`;\n\n\t\t\tthis.layout.nextBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-nav-item ui-tutor-popup-nav-item-next\" onclick=\"${this.clickOnNextBtn.bind(this)}\"></span>\n\t\t\t\t`;\n\n\t\t\tDom.append(this.layout.backBtn, this.layout.navigation);\n\t\t\tDom.append(this.layout.nextBtn, this.layout.navigation);\n\t\t}\n\n\t\treturn this.layout.navigation;\n\t}\n\n\t/**\n\t * @private\n\t * @param {HTMLElement} node\n\t */\n\tsetInformer(node)\n\t{\n\t\tthis.setInformerCount(this.steps.length - this.getCompletedSteps());\n\t}\n\n\t/**\n\t * @public\n\t * @param {Number} num\n\t */\n\tsetInformerExternal(num)\n\t{\n\t\tthis.setInformerCount(num);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetInformerCount(num)\n\t{\n\t\tManager.setCount(num);\n\t}\n\n\t/**\n\t * @public\n\t * @param {Event} event\n\t * @param {Boolean} complexAnimation\n\t */\n\tcloseStepPopup(event, complexAnimation)\n\t{\n\t\tif (!this.stepPopup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (event)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t}\n\t\tthis.fireCurrentStepEvent('onCloseStepPopup');\n\t\tif (complexAnimation) // animate transition from collapsed popup to step popup\n\t\t{\n\t\t\tthis.complexAnimation = true;\n\t\t}\n\t\tthis.fadeAnimation(this.getStepPopup());\n\t\tsetTimeout(function () {\n\t\t\tthis.hideNode(this.getStepPopup());\n\t\t}.bind(this), 310);\n\t\tthis.complexAnimation = false;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {number}\n\t */\n\tgetCompletedSteps()\n\t{\n\t\tlet total = 0;\n\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t{\n\t\t\tif (this.steps[i].isCompleted)\n\t\t\t{\n\t\t\t\ttotal += 1;\n\t\t\t}\n\t\t}\n\t\treturn total;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetStepCounter()\n\t{\n\t\tthis.getCounter().textContent = Loc.getMessage('JS_UI_TUTOR_COUNTER_NUMBER')\n\t\t\t.replace('#NUMBER#', this.steps.indexOf(this.getCurrentStep()) + 1)\n\t\t\t.replace('#NUMBER_TOTAL#', this.steps.length);\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetCounterContainer()\n\t{\n\t\tif (!this.layout.counterContainer)\n\t\t{\n\t\t\tthis.layout.counterContainer =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-header-counter-step\">\n\t\t\t\t\t\t${this.getCounter()}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.counterContainer;\n\t}\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetCounter()\n\t{\n\t\tif (!this.layout.counter)\n\t\t{\n\t\t\tthis.layout.counter =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-header-counter-number\"></span>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.counter;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetDeferLink()\n\t{\n\t\tif (!this.layout.deferLink)\n\t\t{\n\t\t\tthis.layout.deferLink =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-defer-link\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_DEFER')}\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\n\t\t\tconst deferMenu = new BX.PopupMenuWindow({\n\t\t\t\tangle: true,\n\t\t\t\toffsetLeft: 15,\n\t\t\t\tclassName: 'ui-tutor-popup-defer-menu',\n\t\t\t\tbindElement: this.layout.deferLink,\n\t\t\t\titems: [\n\t\t\t\t\t{ text: Loc.getMessage('JS_UI_TUTOR_DEFER_MENU_HOUR'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.emit(\"onDeferOneHour\", { scenario: this});\n\t\t\t\t\t\t\tdeferMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\t{ text: Loc.getMessage('JS_UI_TUTOR_DEFER_MENU_TOMORROW'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.emit(\"onDeferTomorrow\", { scenario: this});\n\t\t\t\t\t\t\tdeferMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('JS_UI_TUTOR_DEFER_MENU_WEEK'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.emit(\"onDeferWeek\", { scenario: this});\n\t\t\t\t\t\t\tdeferMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('JS_UI_TUTOR_DEFER_MENU_FOREVER'),\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tthis.emit(\"onDeferForever\", { scenario: this});\n\t\t\t\t\t\t\tdeferMenu.close();\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tEvent.bind(this.layout.deferLink, \"click\", () => {\n\t\t\t\tdeferMenu.show();\n\t\t\t});\n\t\t}\n\n\t\treturn this.layout.deferLink;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetStartBtn()\n\t{\n\t\tif (!this.layout.startBtn)\n\t\t{\n\t\t\tthis.layout.startBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-round\" onclick=\"${this.clickStartHandler.bind(this)}\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_START')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.startBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetCompletedBtn()\n\t{\n\t\tif (!this.layout.completedBtn)\n\t\t{\n\t\t\tthis.layout.completedBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-success ui-btn-round\" onclick=\"${this.showSuccessState.bind(this)}\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_COMPLETED')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.completedBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetRepeatBtn()\n\t{\n\t\tif (!this.layout.repeatBtn)\n\t\t{\n\t\t\tthis.layout.repeatBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-primary ui-btn-round\" onclick=\"${this.repeatStep.bind(this)}\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_REPEAT')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.repeatBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetDeferBtn()\n\t{\n\t\tif (!this.layout.deferBtn)\n\t\t{\n\t\t\tthis.layout.deferBtn =\n\t\t\t\tTag.render`\n\t\t\t\t\t<button class=\"ui-btn ui-btn-link ui-btn-round\" onclick=\"${this.closeStepPopup.bind(this)}\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_DEFER')}\n\t\t\t\t\t</button>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.deferBtn;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetCompletedBLock()\n\t{\n\t\tif (!this.layout.completedBlock)\n\t\t{\n\t\t\tthis.layout.completedBlock =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-completed\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-completed-icon\"></div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-completed-text\">${Loc.getMessage('JS_UI_TUTOR_STEP_COMPLETED')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.completedBlock;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetTitle()\n\t{\n\t\tif (!this.layout.title)\n\t\t{\n\t\t\tthis.layout.title =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-step-title\"></div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.title;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetDescription()\n\t{\n\t\tif (!this.layout.description)\n\t\t{\n\t\t\tthis.layout.description =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-step-decs\"></div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.description;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetSupportLink()\n\t{\n\t\tif (!this.layout.supportLink)\n\t\t{\n\t\t\tthis.layout.supportLink =\n\t\t\t\tTag.render`\n\t\t\t\t\t<a class=\"ui-tutor-popup-support-link\" onclick=\"${this.supportLinkHandler.bind(this)}\">\n\t\t\t\t\t\t${Loc.getMessage('JS_UI_TUTOR_BTN_SUPPORT')}\n\t\t\t\t\t</a>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.supportLink;\n\t}\n\n\tsetInvisible()\n\t{\n\t\tthis.hideNode(this.getStepPopup());\n\t}\n\n\tsetVisible()\n\t{\n\t\tthis.showNode(this.getStepPopup());\n\t}\n\n\tsupportLinkHandler()\n\t{\n\t\tthis.emit('supportLinkClick');\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetStepBlock()\n\t{\n\t\tif (!this.layout.stepBlock)\n\t\t{\n\t\t\tthis.layout.stepBlock =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-step-list\"></div>\n\t\t\t\t`;\n\n\t\t\tthis.layout.stepItems = [];\n\n\t\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t\t{\n\t\t\t\tconst currentStepIndex =\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<span class=\"ui-tutor-popup-step-item\" data-step=${i} onclick=\"${this.switchStep.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"ui-tutor-popup-step-item-number\">${i + 1}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`;\n\n\t\t\t\tthis.layout.stepItems.push(currentStepIndex);\n\t\t\t\tDom.append(currentStepIndex, this.layout.stepBlock);\n\t\t\t}\n\t\t\tthis.setStepItems();\n\t\t}\n\n\t\treturn this.layout.stepBlock;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetStepItems()\n\t{\n\t\tif (this.layout && this.layout.stepItems)\n\t\t{\n\t\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t\t{\n\t\t\t\tif (this.layout.stepItems[i])\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.layout.stepItems[i], 'ui-tutor-popup-step-item-current');\n\t\t\t\t\tif (i === this.currentStepIndex)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.layout.stepItems[i], 'ui-tutor-popup-step-item-current');\n\t\t\t\t\t}\n\t\t\t\t\tif (this.steps[i].isCompleted)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.layout.stepItems[i], 'ui-tutor-popup-step-item-completed');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetHelpBlock()\n\t{\n\t\tif (!this.layout.help)\n\t\t{\n\t\t\tthis.layout.help =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-help\">\n\t\t\t\t\t\t${this.getHelpLink()}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.help;\n\t}\n\n\tsetVideoItems()\n\t{\n\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t{\n\t\t\tconst currentVideo =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-video\" data-step=${i}></div>\n\t\t\t\t`;\n\t\t\tDom.prepend(currentVideo, this.getHelpBlock());\n\n\t\t\tif (window.YT && Type.isObject(window.YT) && Type.isFunction(window.YT.Player) && this.steps[i].video !== null)\n\t\t\t{\n\t\t\t\tconst playerData = {\n\t\t\t\t\tvideoId: this.steps[i].video,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'onReady': function(event) {\n\t\t\t\t\t\t\tevent.target.mute();\n\t\t\t\t\t\t\tevent.target.pauseVideo();\n\t\t\t\t\t\t\tevent.target.setPlaybackQuality('hd720');\n\n\t\t\t\t\t\t\tif (+event.target.getIframe().getAttribute('data-step') === this.currentStepIndex)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.addClass(event.target.getIframe(), 'ui-tutor-popup-video-show');\n\t\t\t\t\t\t\t\tevent.target.playVideo();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}.bind(this)\n\t\t\t\t\t},\n\t\t\t\t\tplayerVars: {\n\t\t\t\t\t\tcc_load_policy: 1,\n\t\t\t\t\t\tcc_lang_pref: 'ru',\n\t\t\t\t\t\trel: 0\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tthis.fireCurrentStepEvent('onBeforeCreateVideo', true, {\n\t\t\t\t\tplayerData\n\t\t\t\t});\n\t\t\t\tthis.steps[i].videoObj = new YT.Player(currentVideo, playerData);\n\t\t\t\tthis.fireCurrentStepEvent('onAfterCreateVideo');\n\t\t\t}\n\t\t}\n\t}\n\n\tpauseCurrentVideo()\n\t{\n\t\tlet step = this.getCurrentStep();\n\n\t\tif (window.YT && step instanceof Step)\n\t\t{\n\t\t\tlet video = step.getVideoObj();\n\t\t\tif (Type.isObject(video) && video.pauseVideo)\n\t\t\t{\n\t\t\t\tvideo.pauseVideo();\n\t\t\t}\n\t\t}\n\t}\n\n\tplayCurrentVideo()\n\t{\n\t\tlet step = this.getCurrentStep();\n\n\t\tif (window.YT && step instanceof Step)\n\t\t{\n\t\t\tlet video = step.getVideoObj();\n\t\t\tif (Type.isObject(video) && video.playVideo)\n\t\t\t{\n\t\t\t\tvideo.playVideo();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHelpLink()\n\t{\n\t\tif (!this.layout.link)\n\t\t{\n\t\t\tthis.layout.link =\n\t\t\t\tTag.render`\n\t\t\t\t\t<span class=\"ui-tutor-popup-help-link\" onclick=\"${this.handleClickLinkHandler.bind(this)}\">\n\t\t\t\t\t\t<span class=\"ui-tutor-popup-help-link-text\">${Loc.getMessage('JS_UI_TUTOR_ARTICLE_HELP_TOPIC')}</span>\n\t\t\t\t\t</span>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.link;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleClickLinkHandler()\n\t{\n\t\tthis.emit('helpLinkClick');\n\t}\n\n\t/**\n\t * @public\n\t * @param {HTMLElement} node\n\t */\n\tshowPopup(node)\n\t{\n\t\tthis.showAnimation(node);\n\t\tnode.style.display = 'block';\n\t}\n\n\t/**\n\t * @public\n\t * @param {HTMLElement} node\n\t */\n\tshowNode (node)\n\t{\n\t\tnode.style.display = 'block';\n\t}\n\n\t/**\n\t * @public\n\t * @param {HTMLElement} node\n\t */\n\thideNode (node)\n\t{\n\t\tnode.style.display = 'none';\n\t}\n\n\t/**\n\t * @public\n\t * @param {HTMLElement} node\n\t */\n\tremovePopup(node)\n\t{\n\t\tDom.remove(node);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tclickOnNextBtn()\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeClickNavNextBtn');\n\t\tif (this.getCompletedSteps() === this.steps.length && !this.isFinished)\n\t\t{\n\t\t\tthis.isAddedSteps = false;\n\t\t\tDom.remove(this.getNewStepsSection());\n\t\t\tDom.removeClass(this.getFinishedBlock(), 'ui-tutor-popup-finished-new');\n\t\t\tthis.showFinalState();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCompletedSteps() === this.steps.length && this.currentStepIndex + 1 === this.steps.length)\n\t\t{\n\t\t\tthis.currentStepIndex = -1;\n\t\t}\n\n\t\tDom.removeClass(this.getStartBtn(), 'ui-btn-wait');\n\t\tthis.increaseCurrentIndex();\n\t\tthis.showStep();\n\t\tthis.toggleNavBtn();\n\t\tthis.fireCurrentStepEvent('onAfterClickNavNextBtn');\n\t}\n\n\tclickOnBackBtn()\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeClickNavBackBtn');\n\t\tthis.reduceCurrentIndex();\n\t\tthis.toggleNavBtn();\n\t\tthis.showStep();\n\t\tthis.fireCurrentStepEvent('onAfterClickNavBackBtn');\n\t}\n\n\ttoggleNavBtn()\n\t{\n\t\tDom.removeClass(this.layout.backBtn, 'ui-tutor-popup-nav-item-disabled');\n\t\tDom.removeClass(this.layout.nextBtn, 'ui-tutor-popup-nav-item-disabled');\n\n\t\tif (this.currentStepIndex === 0)\n\t\t{\n\t\t\tDom.addClass(this.layout.backBtn, 'ui-tutor-popup-nav-item-disabled');\n\t\t}\n\t\tif (this.currentStepIndex + 1 === this.steps.length)\n\t\t{\n\t\t\tDom.addClass(this.layout.nextBtn, 'ui-tutor-popup-nav-item-disabled');\n\t\t}\n\t}\n\n\tshowStep()\n\t{\n\t\t// when last step is completed, but some steps are not\n\t\tif (this.clickOnCompletedBtn && this.currentStepIndex === this.steps.length)\n\t\t{\n\t\t\tlet nextUncompletedStep = this.getFirstUncompletedStep();\n\t\t\tif (nextUncompletedStep)\n\t\t\t{\n\t\t\t\tthis.setCurrentStep(nextUncompletedStep);\n\t\t\t}\n\t\t}\n\n\t\tthis.scrollToStep();\n\t\tthis.toggleCompletedState();\n\t\tthis.setPopupData();\n\n\t\tthis.clickOnCompletedBtn = false;\n\t\tthis.fireCurrentStepEvent('onAfterShowStep');\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\tswitchStep()\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeSwitchStep');\n\t\tthis.setCurrentStep(this.steps[+window.event.target.getAttribute('data-step')]);\n\t\tthis.fireCurrentStepEvent('onAfterSwitchStep');\n\n\t\tif (this.layout.finishedBlock)\n\t\t{\n\t\t\tthis.hideFinalState();\n\t\t}\n\n\t\tthis.showStep();\n\t\tthis.toggleNavBtn();\n\t\tthis.fireCurrentStepEvent('onEndSwitchStep');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetFirstUncompletedStep()\n\t{\n\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t{\n\t\t\tif (!this.steps[i].isCompleted)\n\t\t\t{\n\t\t\t\treturn this.steps[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttoggleCompletedState()\n\t{\n\t\tconst currentStep = this.getCurrentStep();\n\t\tif (currentStep)\n\t\t{\n\t\t\tif (currentStep.getCompleted())\n\t\t\t{\n\t\t\t\tthis.showNode(this.getRepeatBtn());\n\t\t\t\tthis.hideNode(this.getStartBtn());\n\t\t\t\tthis.hideNode(this.getCompletedBtn());\n\t\t\t}\n\t\t\telse if (currentStep.isActive)\n\t\t\t{\n\t\t\t\tthis.showNode(this.getCompletedBtn());\n\t\t\t\tthis.hideNode(this.getStartBtn());\n\t\t\t\tthis.showNode(this.getRepeatBtn());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showNode(this.getStartBtn());\n\t\t\t\tthis.hideNode(this.getCompletedBtn());\n\t\t\t\tthis.hideNode(this.getRepeatBtn());\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetPopupData()\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeSetPopupData');\n\t\tconst currentStep = this.getCurrentStep();\n\t\tif (currentStep)\n\t\t{\n\t\t\tthis.getTitle().innerHTML = currentStep.getTitle();\n\t\t\tthis.getDescription().innerHTML = currentStep.getDescription();\n\t\t\tManager.getCollapseTitle().innerHTML = currentStep.getTitle();\n\n\t\t\tif (this.getCurrentStep().getVideo() && window.YT)\n\t\t\t{\n\t\t\t\tthis.setCurrentVideo();\n\t\t\t}\n\n\t\t\tthis.setStepCounter();\n\t\t\tthis.setStepItems();\n\t\t}\n\t\tthis.fireCurrentStepEvent('onAfterSetPopupData');\n\t}\n\n\tsetCurrentVideo()\n\t{\n\t\tthis.fireCurrentStepEvent('onSetCurrentVideo');\n\t\tfor (let i = 0; i < this.steps.length; i += 1)\n\t\t{\n\t\t\tlet video = this.steps[i].getVideoObj();\n\t\t\tif (window.YT && i === this.currentStepIndex && video && video.playVideo)\n\t\t\t{\n\t\t\t\tDom.addClass(video.getIframe(), 'ui-tutor-popup-video-show');\n\t\t\t\tvideo.playVideo();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (video) {\n\t\t\t\t\tDom.removeClass(video.getIframe(), 'ui-tutor-popup-video-show');\n\n\t\t\t\t\tif (video.pauseVideo)\n\t\t\t\t\t{\n\t\t\t\t\t\tvideo.pauseVideo();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @returns {Step}\n\t */\n\tgetCurrentStep()\n\t{\n\t\treturn this.currentStep;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tincreaseCurrentIndex()\n\t{\n\t\tif (this.currentStepIndex === this.steps.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentStepIndex += 1;\n\t\tthis.setCurrentStep(this.steps[this.currentStepIndex]);\n\t}\n\n\t/**\n\t * @private\n\t */\n\treduceCurrentIndex()\n\t{\n\t\tif (this.currentStepIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentStepIndex -= 1;\n\t\tthis.setCurrentStep(this.steps[this.currentStepIndex]);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tshowCollapseBlock(step, withGuide)\n\t{\n\t\twithGuide = withGuide !== false;\n\t\tthis.closeStepPopup(null, true);\n\t\tManager.showCollapsedBlock(step, withGuide);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tminimize()\n\t{\n\t\tthis.pauseCurrentVideo();\n\t\tthis.fireCurrentStepEvent('onMinimize');\n\t\tthis.showCollapseBlock(this.getCurrentStep(), false);\n\t}\n\n\trepeatStep()\n\t{\n\t\tthis.followLink();\n\t}\n\n\tclickStartHandler()\n\t{\n\t\tthis.followLink();\n\t}\n\t/**\n\t * @private\n\t */\n\tfollowLink(step)\n\t{\n\t\tlet currentStep = this.getCurrentStep();\n\t\tif (step instanceof Step)\n\t\t{\n\t\t\tcurrentStep = step;\n\t\t}\n\t\tthis.pauseCurrentVideo();\n\n\t\tthis.setActiveStep(currentStep);\n\t\tManager.checkFollowLink(currentStep, this);\n\t}\n\n\tsetActiveStep(step)\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeSetActiveStep');\n\t\tif (this.currentActiveStep instanceof Step)\n\t\t{\n\t\t\tthis.currentActiveStep.deactivate();\n\t\t}\n\t\tstep.activate();\n\t\tthis.currentActiveStep = step;\n\t\tthis.fireCurrentStepEvent('onAfterSetActiveStep');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tshowSuccessState()\n\t{\n\t\tconst currentStep = this.getCurrentStep();\n\t\tthis.clickOnCompletedBtn = true;\n\t\tcurrentStep.isCompleted = true;\n\t\tthis.fireCurrentStepEvent('onFinishStep');\n\n\t\tif (currentStep.getCompleted())\n\t\t{\n\t\t\tDom.addClass(this.layout.stepItems[this.currentStepIndex], 'ui-tutor-popup-step-item-completed');\n\t\t}\n\t\tDom.addClass(this.getContentBlock(), 'ui-tutor-popup-content-block-animate');\n\n\t\tsetTimeout(function () {\n\t\t\tDom.replace(this.getHelpBlock(), this.getCompletedBLock());\n\t\t\tthis.getFooter().style.display = \"none\";\n\t\t\tthis.getDescription().style.display = \"none\";\n\t\t\tthis.getTitle().style.display = \"none\";\n\t\t}.bind(this), 300);\n\n\t\tsetTimeout(function () {\n\t\t\tDom.addClass(this.getCompletedBLock(), 'ui-tutor-popup-completed-animate')\n\t\t}.bind(this), 800);\n\n\t\tsetTimeout(function () {\n\t\t\tDom.replace(this.getCompletedBLock(), this.getHelpBlock());\n\t\t\tthis.getTitle().style.display = \"block\";\n\t\t\tthis.getDescription().style.display = \"block\";\n\t\t\tthis.getFooter().style.display = \"flex\";\n\n\t\t\tthis.clickOnNextBtn();\n\t\t}.bind(this), 1500);\n\n\t\tsetTimeout(function () {\n\t\t\tDom.removeClass(this.getCompletedBLock(), 'ui-tutor-popup-completed-animate');\n\t\t\tDom.removeClass(this.getContentBlock(), 'ui-tutor-popup-content-block-animate');\n\n\t\t\tlet counter = this.stepPopup.querySelector(\".ui-tutor-popup-header-counter-number\");\n\t\t\tcounter.innerHTML = Loc.getMessage('JS_UI_TUTOR_COUNTER_NUMBER')\n\t\t\t\t.replace('#NUMBER#', this.steps.indexOf(this.getCurrentStep()) + 1)\n\t\t\t\t.replace('#NUMBER_TOTAL#', this.steps.length);\n\t\t\tthis.fireCurrentStepEvent('onAfterShowSuccessState');\n\t\t}.bind(this), 1700);\n\n\t}\n\n\tfireCurrentStepEvent(eventName, fireStepEvent, extra)\n\t{\n\t\tfireStepEvent = fireStepEvent !== false;\n\t\tconst currentStep = this.getCurrentStep();\n\n\t\tconst data = {\n\t\t\tstep : currentStep,\n\t\t\tscenario: this\n\t\t};\n\t\tif (extra)\n\t\t{\n\t\t\tdata.extra = extra;\n\t\t}\n\t\tif (currentStep && fireStepEvent)\n\t\t{\n\t\t\tcurrentStep.emit(eventName, data);\n\t\t}\n\t\tthis.emit(eventName, data);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tshowFinalState()\n\t{\n\t\tthis.fireCurrentStepEvent('onFinalState');\n\n\t\tif (this.layout.stepItems)\n\t\t{\n\t\t\tDom.removeClass(this.layout.stepItems[this.currentStepIndex], 'ui-tutor-popup-step-item-current');\n\t\t}\n\n\t\tDom.append(this.getFinishedBlock(), this.getContentInner());\n\t\tDom.replace(this.getStartBtn(), this.getFinishedNotice());\n\t\tDom.remove(this.getCompletedBtn());\n\n\t\tDom.remove(this.getSupportLink());\n\t\tDom.remove(this.getNavigation());\n\t\tDom.remove(this.getHelpBlock());\n\n\t\tDom.remove(this.getRepeatBtn());\n\t\tDom.remove(this.getTitle());\n\t\tDom.remove(this.getDescription());\n\t\tDom.remove(this.getDeferLink());\n\n\t\tthis.isFinished = true;\n\t\tthis.fireCurrentStepEvent('onAfterFinalState');\n\t}\n\n\t/**\n\t * @private\n\t */\n\thideFinalState()\n\t{\n\t\tthis.fireCurrentStepEvent('onBeforeHideFinalState');\n\t\tif (this.getCurrentStep().getCompleted())\n\t\t{\n\t\t\tDom.replace(this.getFinishedNotice(), this.getRepeatBtn());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.getFinishedNotice(), this.getStartBtn());\n\t\t}\n\n\t\tDom.replace(this.getFinishedBlock(), this.getHelpBlock());\n\n\t\tif (Manager.getInstance().feedbackFormId) {\n\t\t\tDom.append(this.getSupportLink(), this.getFooter());\n\t\t}\n\t\tDom.prepend(this.getNavigation(), this.getFooter());\n\t\tDom.prepend(this.getDescription(), this.getContentInner());\n\t\tDom.prepend(this.getTitle(), this.getContentInner());\n\n\t\tif (this.layout.deferBtn)\n\t\t{\n\t\t\tDom.remove(this.getDeferBtn());\n\t\t\tDom.prepend(this.getStartBtn(), this.getBtnContainer());\n\t\t}\n\n\t\tconst header = this.getStepPopup().querySelector('.ui-tutor-popup-header');\n\t\tDom.append(this.getDeferLink(), header);\n\t\tthis.fireCurrentStepEvent('onAfterHideFinalState');\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetFinishedBlock()\n\t{\n\t\tif (!this.layout.finishedBlock)\n\t\t{\n\t\t\tthis.layout.finishedBlock =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-finished\">\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-finished-title\">${Loc.getMessage('JS_UI_TUTOR_FINAL_CONGRATULATIONS')}</div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-finished-icon\"></div>\n\t\t\t\t\t\t<div class=\"ui-tutor-popup-finished-text\">${Loc.getMessage('JS_UI_TUTOR_FINAL_TEXT')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.finishedBlock;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetFinishedNotice()\n\t{\n\t\tif (!this.layout.finishedNotice)\n\t\t{\n\t\t\tthis.layout.finishedNotice =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-finished-notice\">${Loc.getMessage('JS_UI_TUTOR_FINAL_NOTICE')}</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.finishedNotice;\n\t}\n\n\t/**\n\t * @public\n\t * @returns {HTMLElement}\n\t */\n\tgetNewStepsSection()\n\t{\n\t\tif (!this.layout.newStepsSection)\n\t\t{\n\t\t\tthis.layout.newStepsSection =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-new-text\">${Loc.getMessage('JS_UI_TUTOR_STEP_NEW')}</div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.layout.newStepsSection;\n\t}\n\n\t/**\n\t * @public\n\t */\n\tshowNewSteps()\n\t{\n\t\tDom.addClass(this.getFinishedBlock(), 'ui-tutor-popup-finished-new');\n\t\tthis.showPopup(this.getStepPopup());\n\t\tthis.showFinalState();\n\n\t\tDom.append(this.getNewStepsSection(), this.getFinishedBlock());\n\t\tDom.replace(this.getFinishedNotice(), Manager.getBeginBtn());\n\t\tDom.append(this.getDeferBtn(), this.getBtnContainer());\n\n\t\tthis.setStepCounter();\n\t\tthis.initArrows();\n\t\tthis.scrollToStep();\n\n\t\tthis.isAddedSteps = true;\n\t\tthis.isFinished = false;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tinitArrows()\n\t{\n\t\tthis.stepListWrap = document.querySelector('.ui-tutor-popup-step-list-wrap');\n\t\tthis.arrowWrap = document.querySelector('.ui-tutor-popup-arrow-wrap');\n\n\t\tif (this.stepListWrap && this.stepListWrap.scrollWidth > this.stepListWrap.offsetWidth)\n\t\t{\n\t\t\tDom.append(this.getPrevArrow(), this.arrowWrap);\n\t\t\tDom.append(this.getNextArrow(), this.arrowWrap);\n\n\t\t\tthis.stepListWrap.addEventListener('scroll', this.toggleArrows.bind(this));\n\n\t\t\tthis.prevArrow.addEventListener('mouseenter', this.scrollToLeft.bind(this));\n\t\t\tthis.prevArrow.addEventListener('mouseleave', this.stopAutoScroll.bind(this));\n\t\t\tthis.nextArrow.addEventListener('mouseenter', this.scrollToRight.bind(this));\n\t\t\tthis.nextArrow.addEventListener('mouseleave', this.stopAutoScroll.bind(this));\n\n\t\t\tthis.toggleNextArrow();\n\t\t\tthis.getStepBlock().classList.add(\"ui-tutor-popup-step-list-wide\");\n\n\t\t\tthis.hasArrows = true;\n\t\t}\n\t}\n\n\tgetPrevArrow()\n\t{\n\t\tif (!this.prevArrow)\n\t\t{\n\t\t\tthis.prevArrow =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-arrow ui-tutor-popup-arrow-prev\"></div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.prevArrow;\n\t}\n\n\tgetNextArrow()\n\t{\n\t\tif (!this.nextArrow)\n\t\t{\n\t\t\tthis.nextArrow =\n\t\t\t\tTag.render`\n\t\t\t\t\t<div class=\"ui-tutor-popup-arrow ui-tutor-popup-arrow-next\"></div>\n\t\t\t\t`;\n\t\t}\n\n\t\treturn this.nextArrow;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tscrollToLeft()\n\t{\n\t\tthis.arrowTimer = setInterval(function() {\n\t\t\tthis.stepListWrap.scrollLeft -= 5;\n\t\t}.bind(this), 20);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tscrollToRight()\n\t{\n\t\tthis.arrowTimer = setInterval(function() {\n\t\t\tthis.stepListWrap.scrollLeft += 5;\n\t\t}.bind(this), 20);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstopAutoScroll()\n\t{\n\t\tclearInterval(this.arrowTimer);\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttoggleArrows()\n\t{\n\t\tthis.togglePrevArrow();\n\t\tthis.toggleNextArrow();\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttoggleNextArrow()\n\t{\n\t\tif (this.stepListWrap.scrollWidth > this.stepListWrap.offsetWidth\n\t\t\t&& (this.stepListWrap.offsetWidth + this.stepListWrap.scrollLeft) < this.stepListWrap.scrollWidth)\n\t\t{\n\t\t\tDom.addClass(this.nextArrow, 'ui-tutor-popup-arrow-show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.nextArrow, 'ui-tutor-popup-arrow-show');\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttogglePrevArrow()\n\t{\n\t\tif (this.stepListWrap.scrollLeft > 0)\n\t\t{\n\t\t\tDom.addClass(this.prevArrow, 'ui-tutor-popup-arrow-show');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.prevArrow, 'ui-tutor-popup-arrow-show');\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tshowAnimation(popup)\n\t{\n\t\tDom.removeClass(popup, 'ui-tutor-popup-hide-complex');\n\t\tDom.removeClass(popup, 'ui-tutor-popup-hide');\n\n\t\tif (this.complexAnimation)\n\t\t{\n\t\t\tDom.addClass(popup, 'ui-tutor-popup-show-complex');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(popup, 'ui-tutor-popup-show');\n\t\t}\n\n\t}\n\n\t/**\n\t * @private\n\t */\n\tfadeAnimation(popup)\n\t{\n\t\tDom.removeClass(popup, 'ui-tutor-popup-show-complex');\n\t\tDom.removeClass(popup, 'ui-tutor-popup-show');\n\n\t\tif (this.complexAnimation)\n\t\t{\n\t\t\tDom.addClass(popup, 'ui-tutor-popup-hide-complex');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(popup, 'ui-tutor-popup-hide');\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tscrollToStep()\n\t{\n\t\tlet posList = null;\n\t\tlet posStep = null;\n\t\tif (this.stepListWrap)\n\t\t{\n\t\t\tposList = Dom.getPosition(this.stepListWrap);\n\t\t\tposStep = Dom.getPosition(this.stepListWrap.querySelector('[data-step=\"' + this.currentStepIndex + '\"]'));\n\t\t}\n\t\tconst offset = 7; // padding 2px and margin 5px\n\n\t\tif (!Type.isNull(posStep) && posStep.left + posStep.width > posList.left + posList.width )\n\t\t{\n\t\t\tthis.stepListWrap.scrollLeft += posStep.left - (posList.left + posList.width) + posStep.width + offset;\n\t\t}\n\n\t\tif (!Type.isNull(posStep) && posStep.left < posList.left)\n\t\t{\n\t\t\tthis.stepListWrap.scrollLeft -= posList.left - posStep.left + offset;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic getFullEventName(shortName)\n\t{\n\t\treturn shortName;\n\t}\n\n\tstatic getInstance()\n\t{\n\t\treturn Manager.getScenarioInstance();\n\t}\n\n\tstatic init(options)\n\t{\n\t\treturn Manager.initScenario(options);\n\t}\n}"],"names":["Step","Event","EventEmitter","constructor","options","setEventNamespace","Type","isPlainObject","id","title","description","url","isCompleted","video","helpLink","highlight","isActive","isShownForSlider","initOptions","videoObj","getTitle","getVideoObj","getHighlightOptions","getDescription","getUrl","getCompleted","getVideo","getHelpLink","getId","getInitOptions","activate","getShownForSlider","deactivate","getFullEventName","shortName","Manager","setOptions","domain","feedbackFormId","tutorialData","eventService","lastCheckTime","isString","length","getDomain","getCurrentTutorialData","getCurrentEventService","getCurrentLastCheckTime","getInstance","instance","getScenarioInstance","scenarioInstance","init","emit","initScenario","Scenario","showButton","animation","getImButton","getRootImButton","document","getElementById","hasImButton","layout","imButton","buttonWrapper","buttonInner","Tag","render","Dom","addClass","append","bind","usersPanel","querySelector","style","bottom","showSmallPopup","text","smallPopupText","getSmallPopup","display","hasClass","removeClass","hideSmallPopup","skipAnimation","removeHandler","remove","hasOwnProperty","smallPopup","setTimeout","showWelcomePopup","hideWelcomePopup","showNoticePopup","hideNoticePopup","clickSmallPopupHandler","Loc","getMessage","body","showStartPopup","startTitle","startText","getStartPopup","startPopup","closeStartPopup","getBeginBtn","getDeferBtn","beginBtn","deferBtn","getInformer","informer","informerParentNode","isCollapsedShow","getCollapseBlock","setCount","num","removeInformer","isInformerShow","textContent","showCollapsedBlock","step","withGuide","showAfterAnimation","collapsedStep","collapsedBlock","showFunction","call","getCollapseTitle","innerHTML","showGuide","checkButtonsState","setCollapsedInvisible","hideNode","setCollapsedVisible","showNode","activeGuide","getRepeatBtn","getCompletedBtn","getStartBtn","isShowRepeatWithCompleted","Guide","simpleMode","steps","subscribe","finishGuide","start","getPopup","closeIcon","closeGuide","close","collapseBlock","clickCollapseBlockHandler","startBtn","event","stopPropagation","repeatBtn","completedBtn","collapseTitle","closeCollapsePopup","closeCollapseEntity","showLoader","loader","Loader","target","size","show","hideLoader","destroy","showCollapsedLoader","collapseLoader","hideCollapsedLoader","node","checkFollowLink","scenario","window","location","pathname","beforeEvent","fireCurrentStepEvent","showCollapseBlock","fireEvent","eventName","stepPopup","arrowTimer","guide","arrowWrap","prevArrow","nextArrow","currentStepIndex","currentStep","isAddedSteps","hasArrows","isLoading","btn","stepBlock","progress","counter","counterContainer","collapseDescription","content","contentInner","contentBlock","nextBtn","help","completedBlock","finishedBlock","supportLink","sections","loadYoutubeApiScript","setVideoItems","onYouTubeReadyEvent","YT","isNeedCheckYT","tag","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","ytCheckerTimer","setInterval","isFunction","Player","clearInterval","getCurrentStep","Array","isArray","forEach","push","stepInList","findStepById","currentStepId","currentStepIsActive","uncompletedStep","getFirstUncompletedStep","setCurrentStep","isFinished","indexOf","complexAnimation","showPopup","getStepPopup","toggleCompletedState","toggleNavBtn","setPopupData","hideFinalState","initArrows","stepId","i","clickOnCloseIcon","getCounterContainer","getDeferLink","getContentBlock","getStepBlock","getContentInner","getFooter","footer","getNavigation","getBtnContainer","getSupportLink","getHelpBlock","btnContainer","navigation","backBtn","clickOnBackBtn","clickOnNextBtn","setInformer","setInformerCount","getCompletedSteps","setInformerExternal","closeStepPopup","fadeAnimation","total","setStepCounter","getCounter","replace","deferLink","deferMenu","BX","PopupMenuWindow","angle","offsetLeft","className","bindElement","items","onclick","clickStartHandler","showSuccessState","repeatStep","getCompletedBLock","supportLinkHandler","setInvisible","setVisible","stepItems","switchStep","setStepItems","currentVideo","prepend","isObject","playerData","videoId","events","mute","pauseVideo","setPlaybackQuality","getIframe","getAttribute","playVideo","playerVars","cc_load_policy","cc_lang_pref","rel","pauseCurrentVideo","playCurrentVideo","link","handleClickLinkHandler","showAnimation","removePopup","getNewStepsSection","getFinishedBlock","showFinalState","increaseCurrentIndex","showStep","reduceCurrentIndex","clickOnCompletedBtn","nextUncompletedStep","scrollToStep","setCurrentVideo","minimize","followLink","setActiveStep","currentActiveStep","fireStepEvent","extra","data","getFinishedNotice","header","finishedNotice","newStepsSection","showNewSteps","stepListWrap","scrollWidth","offsetWidth","getPrevArrow","getNextArrow","addEventListener","toggleArrows","scrollToLeft","stopAutoScroll","scrollToRight","toggleNextArrow","classList","add","scrollLeft","togglePrevArrow","popup","posList","posStep","getPosition","offset","isNull","left","width"],"mappings":"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"}