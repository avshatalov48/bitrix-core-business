{"version":3,"file":"router.bundle.js","sources":["../src/router.js"],"sourcesContent":["import 'sidepanel';\n\nexport class Router\n{\n\tstatic init()\n\t{\n\t\tif (top !== window)\n\t\t{\n\t\t\ttop.BX.Runtime.loadExtension('bizproc.router').then(({ Router }) => {\n\t\t\t\tRouter.init();\n\t\t\t}).catch(e => console.error(e));\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#bind();\n\t}\n\n\tstatic #bind()\n\t{\n\t\ttop.BX.SidePanel.Instance.bindAnchors({\n\t\t\trules:\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t'/rpa/task/',\n\t\t\t\t\t\t],\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\twidth: 580,\n\t\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcondition: [\n\t\t\t\t\t\t\t'/company/personal/bizproc/([a-zA-Z0-9\\\\.]+)/',\n\t\t\t\t\t\t],\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\t\tloader: 'bizproc:workflow-info',\n\t\t\t\t\t\t\twidth: this.#detectSliderWidth(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t});\n\t}\n\n\tstatic #detectSliderWidth(): number\n\t{\n\t\tif (window.innerWidth < 1500)\n\t\t{\n\t\t\treturn null; // default slider width\n\t\t}\n\n\t\treturn 1500 + Math.floor((window.innerWidth - 1500) / 3);\n\t}\n\n\tstatic #openSlider(url: string, options: Object): void\n\t{\n\t\ttop.BX.Runtime\n\t\t\t.loadExtension('sidepanel')\n\t\t\t.then(() => {\n\t\t\t\tBX.SidePanel.Instance.open(url, options);\n\t\t\t})\n\t\t\t.catch((response) => console.error(response.errors));\n\t}\n\n\tstatic openWorkflowLog(workflowId: string): void\n\t{\n\t\tconst url = `/bitrix/components/bitrix/bizproc.log/slider.php?WORKFLOW_ID=${workflowId}`;\n\t\tconst options = {\n\t\t\twidth: this.#detectSliderWidth(),\n\t\t\tcacheable: false,\n\t\t};\n\t\tthis.#openSlider(url, options);\n\t}\n\n\tstatic openWorkflow(workflowId: string): void\n\t{\n\t\tconst url = `/company/personal/bizproc/${workflowId}/`;\n\t\tconst options = {\n\t\t\twidth: this.#detectSliderWidth(),\n\t\t\tcacheable: false,\n\t\t\tloader: 'bizproc:workflow-info',\n\t\t};\n\t\tthis.#openSlider(url, options);\n\t}\n\n\tstatic openWorkflowTask(taskId: number, userId: number): void\n\t{\n\t\tlet url = `/company/personal/bizproc/${taskId}/`;\n\t\tif (userId > 0)\n\t\t{\n\t\t\turl += `?USER_ID=${userId}`;\n\t\t}\n\t\tconst options = {\n\t\t\twidth: this.#detectSliderWidth(),\n\t\t\tcacheable: false,\n\t\t\tloader: 'bizproc:workflow-info',\n\t\t};\n\t\tthis.#openSlider(url, options);\n\t}\n}\n"],"names":["Router","init","top","window","BX","Runtime","loadExtension","then","catch","e","console","error","openWorkflowLog","workflowId","url","options","width","cacheable","openWorkflow","loader","openWorkflowTask","taskId","userId","SidePanel","Instance","bindAnchors","rules","condition","allowChangeHistory","innerWidth","Math","floor","open","response","errors"],"mappings":";;;;;CAAmB;CAAA;CAAA;AAEnB,CAAO,MAAMA,MAAM,CACnB;GACC,OAAOC,IAAI,GACX;KACC,IAAIC,GAAG,KAAKC,MAAM,EAClB;OACCD,GAAG,CAACE,EAAE,CAACC,OAAO,CAACC,aAAa,CAAC,gBAAgB,CAAC,CAACC,IAAI,CAAC,CAAC;SAAEP;QAAQ,KAAK;SACnEA,MAAM,CAACC,IAAI,EAAE;QACb,CAAC,CAACO,KAAK,CAACC,CAAC,IAAIC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC,CAAC;OAE/B;;KAGD,4CAAI;;GAoDL,OAAOG,eAAe,CAACC,UAAkB,EACzC;KACC,MAAMC,GAAG,GAAI,gEAA+DD,UAAW,EAAC;KACxF,MAAME,OAAO,GAAG;OACfC,KAAK,0CAAE,IAAI,2CAAqB;OAChCC,SAAS,EAAE;MACX;KACD,4CAAI,4BAAaH,GAAG,EAAEC,OAAO;;GAG9B,OAAOG,YAAY,CAACL,UAAkB,EACtC;KACC,MAAMC,GAAG,GAAI,6BAA4BD,UAAW,GAAE;KACtD,MAAME,OAAO,GAAG;OACfC,KAAK,0CAAE,IAAI,2CAAqB;OAChCC,SAAS,EAAE,KAAK;OAChBE,MAAM,EAAE;MACR;KACD,4CAAI,4BAAaL,GAAG,EAAEC,OAAO;;GAG9B,OAAOK,gBAAgB,CAACC,MAAc,EAAEC,MAAc,EACtD;KACC,IAAIR,GAAG,GAAI,6BAA4BO,MAAO,GAAE;KAChD,IAAIC,MAAM,GAAG,CAAC,EACd;OACCR,GAAG,IAAK,YAAWQ,MAAO,EAAC;;KAE5B,MAAMP,OAAO,GAAG;OACfC,KAAK,0CAAE,IAAI,2CAAqB;OAChCC,SAAS,EAAE,KAAK;OAChBE,MAAM,EAAE;MACR;KACD,4CAAI,4BAAaL,GAAG,EAAEC,OAAO;;CAE/B;CAAC,kBAnFA;GACCb,GAAG,CAACE,EAAE,CAACmB,SAAS,CAACC,QAAQ,CAACC,WAAW,CAAC;KACrCC,KAAK,EACJ,CACC;OACCC,SAAS,EAAE,CACV,YAAY,CACZ;OACDZ,OAAO,EAAE;SACRC,KAAK,EAAE,GAAG;SACVC,SAAS,EAAE,KAAK;SAChBW,kBAAkB,EAAE;;MAErB,EACD;OACCD,SAAS,EAAE,CACV,8CAA8C,CAC9C;OACDZ,OAAO,EAAE;SACRE,SAAS,EAAE,KAAK;SAChBE,MAAM,EAAE,uBAAuB;SAC/BH,KAAK,0CAAE,IAAI;;MAEZ;IAEH,CAAC;CACH;CAAC,+BAGD;GACC,IAAIb,MAAM,CAAC0B,UAAU,GAAG,IAAI,EAC5B;KACC,OAAO,IAAI,CAAC;;;GAGb,OAAO,IAAI,GAAGC,IAAI,CAACC,KAAK,CAAC,CAAC5B,MAAM,CAAC0B,UAAU,GAAG,IAAI,IAAI,CAAC,CAAC;CACzD;CAAC,sBAEkBf,GAAW,EAAEC,OAAe,EAC/C;GACCb,GAAG,CAACE,EAAE,CAACC,OAAO,CACZC,aAAa,CAAC,WAAW,CAAC,CAC1BC,IAAI,CAAC,MAAM;KACXH,EAAE,CAACmB,SAAS,CAACC,QAAQ,CAACQ,IAAI,CAAClB,GAAG,EAAEC,OAAO,CAAC;IACxC,CAAC,CACDP,KAAK,CAAEyB,QAAQ,IAAKvB,OAAO,CAACC,KAAK,CAACsB,QAAQ,CAACC,MAAM,CAAC,CAAC;CACtD;CAAC,sBA/DWlC,MAAM;GAAA;CAAA;CAAA,sBAANA,MAAM;GAAA;CAAA;CAAA,sBAANA,MAAM;GAAA;CAAA;;;;;;;;"}