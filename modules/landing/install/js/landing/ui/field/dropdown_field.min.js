(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.setTextContent;var i=BX.Landing.Utils.escapeText;var n=BX.Landing.Utils.data;var e=BX.Landing.Utils.offsetTop;var o=BX.Landing.Utils.offsetLeft;BX.Landing.UI.Field.Dropdown=function(i){this.items="items"in i&&i.items?i.items:{};BX.Landing.UI.Field.BaseField.apply(this,arguments);this.setEventNamespace("BX.Landing.UI.Field.Dropdown");this.subscribeFromOptions(BX.Landing.UI.Component.fetchEventsFromOptions(i));this.onChangeHandler=typeof i.onChange==="function"?i.onChange:function(){};this.layout.classList.add("landing-ui-field-dropdown");this.popup=null;this.input.addEventListener("click",this.onInputClick.bind(this));document.addEventListener("click",this.onDocumentClick.bind(this));var e=BX.Landing.PageObject.getRootWindow();e.document.addEventListener("click",this.onDocumentClick.bind(this));if(BX.type.isPlainObject(this.items)){var o=Object.keys(this.items);this.items=o.map(function(t){return{name:this.items[t],value:t}},this)}if(BX.Type.isArrayFilled(this.items)){t(this.input,this.items[0].name);n(this.input,"value",this.items[0].value)}else{t(this.input,BX.Landing.Loc.getMessage("LANDING_DROPDOWN_NOT_FILLED"));n(this.input,"value","")}if(this.content!==""){this.setValue(this.content)}};BX.Landing.UI.Field.Dropdown.prototype={constructor:BX.Landing.UI.Field.Dropdown,__proto__:BX.Landing.UI.Field.BaseField.prototype,onInputClick:function(t){t.stopPropagation();if(!this.popup||!this.contentRoot&&this.popupRoot&&!this.popupRoot.contains(this.popup.popupWindow.popupContainer)){this.popup=new BX.PopupMenuWindow({id:"dropdown_"+ +new Date,bindElement:this.input,bindOptions:{forceBindPosition:true},targetContainer:this.contentRoot,maxHeight:196,items:this.items.map(function(t){return{html:t.html,text:!t.html?i(t.name):undefined,onclick:function(){this.onItemClick(t)}.bind(this)}},this),events:{onPopupClose:function(){this.input.classList.remove("landing-ui-active");this.layout.classList.remove("landing-ui-active")}.bind(this)}});if(!this.contentRoot){this.popupRoot=this.layout.parentElement.parentElement.parentElement;this.popupRoot.appendChild(this.popup.popupWindow.popupContainer);this.popupRoot.style.position="relative"}}this.layout.classList.add("landing-ui-active");this.input.classList.add("landing-ui-active");if(this.popup.popupWindow.isShown()){this.popup.close()}else{this.popup.show()}var n=this.input.getBoundingClientRect();if(!this.contentRoot){var s=o(this.input,this.popupRoot);var p=e(this.input,this.popupRoot);this.popup.popupWindow.popupContainer.style.top=p+n.height+"px";this.popup.popupWindow.popupContainer.style.left=s+"px"}this.popup.popupWindow.popupContainer.style.width=n.width+"px"},onItemClick:function(i){t(this.input,i.name);n(this.input,"value",i.value);this.popup.close();this.onChangeHandler(i.value,this.items,this.postfix,this.property);this.onValueChangeHandler(this);BX.fireEvent(this.input,"input");this.emit("onChange")},getValue:function(){var t=this.input.dataset.value;if(t!=="undefined"&&typeof t!=="undefined"){return t}if(BX.Type.isArrayFilled(this.items)){return this.items[0].value}},setValue:function(i){this.items.forEach(function(e){if(i==e.value){t(this.input,e.name);n(this.input,"value",e.value)}},this)},isChanged:function(){return this.content!=this.getValue()},onDocumentClick:function(){if(this.popup){this.popup.close()}}}})();
//# sourceMappingURL=dropdown_field.map.js