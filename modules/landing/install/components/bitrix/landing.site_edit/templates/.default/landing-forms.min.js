(function(){"use strict";BX.namespace("BX.Landing");const t=BX.Landing.Utils.slice;const e=BX.Landing.Utils.proxy;const i=BX.Landing.Utils.bind;const n=BX.Landing.Utils.addClass;const o=BX.Landing.Utils.removeClass;const s=BX.Landing.Utils.data;const l=BX.Landing.Utils.onTransitionEnd;const a=(t={})=>{const e=t?.siteId;const i=top.BX.AI?top.BX.AI.Picker:BX.AI.Picker;if(!e){throw new Error("BX.Landing.landing-forms: siteId is required parameter for AI")}if(!i){return}const n=new i({moduleId:"landing",contextId:`text_site_${e}`,analyticLabel:"landing_text",history:true,onSelect:t.onSelect,onTariffRestriction:function(){BX.UI.InfoHelper.show("limit_sites_TextAssistant_AI")}});n.setLangSpace(BX.AI.Picker.LangSpace.text);n.text()};BX.Landing.EditTitleForm=function(t){this.siteId=t.siteId;this.isAiAvailable=Boolean(t.isAiAvailable)===true;this.isAiActive=Boolean(t.isAiActive)===true;this.aiUnactiveInfoCode=t.aiUnactiveInfoCode??null;this.node=t.node;this.isEventTargetNode=Boolean(t.isEventTargetNode)===true;this.controlButtonContainer=this.node.querySelector(".landing-editable-field-buttons");this.btn=this.node.querySelector(".ui-title-input-btn-js");this.aiBtnContainer=this.node.querySelector(".landing-editable-field-button.--ai");this.label=this.node.querySelector(".landing-editable-field-label-js");this.input=this.node.querySelector(".landing-editable-field-input-js");this.hideInput=this.hideInput.bind(this);this.showInput=this.showInput.bind(this);this.adjustInputHeight=this.adjustInputHeight.bind(this);BX.bind(this.input,"input",this.adjustInputHeight);BX.bind(this.input,"paste",this.adjustInputHeight);BX.bind(this.btn,"click",this.showInput);if(this.isEventTargetNode){BX.bind(this.label,"click",this.showInput)}if(this.isAiAvailable&&this.aiBtnContainer){this.initAiBtn()}};BX.Landing.EditTitleForm.prototype={initAiBtn:function(){const t=BX.Tag.render`
				<div class="ui-title-input-btn">
					<div class="ui-icon-set --ai"></div>
				</div>
			`;BX.bind(t,"click",(()=>{if(this.isAiActive){a({onSelect:t=>{const e=t.data.replace(/(\r\n|\r|\n)/g,"<br>");this.label.innerText=e;this.input.value=e;this.adjustInputHeight()},siteId:this.siteId})}else if(this.aiUnactiveInfoCode&&this.aiUnactiveInfoCode.length>0){BX.UI.InfoHelper.show(this.aiUnactiveInfoCode)}}));BX.Dom.append(t,this.aiBtnContainer)},adjustInputHeight:function(){if(!this.input){return}BX.Dom.style(this.input,{height:"auto"});requestAnimationFrame((()=>{BX.Dom.style(this.input,{height:`${this.input.scrollHeight}px`})}))},showInput:function(t){t.stopPropagation();BX.Dom.style(this.label,"display","none");BX.Dom.addClass(this.controlButtonContainer,"--hidden");BX.Dom.style(this.input,"display","block");this.adjustInputHeight();this.input.focus();if(!BX.Dom.hasClass(this.input,"landing-editable-field-input-js-init")){this.input.selectionStart=this.input.value.length;BX.Dom.addClass(this.input,"landing-editable-field-input-js-init")}BX.bind(this.input,"focusout",this.hideInput)},hideInput:function(){this.label.textContent=this.input.value;BX.Dom.style(this.label,"display",null);BX.Dom.style(this.input,"display",null);BX.Dom.removeClass(this.controlButtonContainer,"--hidden");BX.unbind(document,"focusout",this.hideInput)}};BX.Landing.FieldLengthLimited=function(t){t.forEach((function(t){BX.bind(t.field,"keyup",(function(){if(t.length){if(t.field.value.length<=t.length){t.node.textContent=t.field.value}else{t.node.textContent=t.field.value.substring(0,t.length)}}else{t.node.textContent=t.field.value}}))}))};BX.Landing.Favicon=function(){const t=BX("landing-form-favicon-change");const e=BX("landing-form-favicon-input");const i=BX("landing-form-favicon-value");const n=BX("landing-form-favicon-form");const o=BX("landing-form-favicon-src");const s=BX("landing-form-favicon-error");if(!n||!e||!t){return}BX.bind(t,"click",(function(t){BX.fireEvent(e,"click");BX.PreventDefault(t)}));BX.bind(e,"change",(function(t){BX.ajax.submitAjax(n,{method:"POST",dataType:"json",onsuccess:function(t){if(t.type==="success"&&typeof t.result!=="undefined"&&t.result!==false){i.value=t.result.id;o.setAttribute("src",t.result.src)}else{s.style.color="red"}}});BX.PreventDefault(t)}))};BX.Landing.Custom404And503=function(t,e){BX.bind(t,"change",(t=>{if(t.currentTarget.value===""){e.checked=false;e.click()}else{e.checked=true}}));BX.addCustomEvent("BX.UI.LayoutForm:onToggle",(i=>{if(i.getData().checkbox&&i.getData().checkbox===e){if(!i.getData().checkbox.checked){t.value=""}}}))};BX.Landing.Copyright=function(t,e){BX.bind(e,"change",(function(){let e=t.getAttribute("action");e=e.replace(/&feature_copyright=[YN]/,"");e+="&feature_copyright="+(this.checked?"Y":"N");t.setAttribute("action",e)}))};BX.Landing.Access=function(t){BX.Landing.Access.selected=t.selected;this.table=t.table;const e="RIGHTS";const i=t.form;const n=t.select;let o=t.inc;BX.Access.Init({other:{disabled_cr:true}});BX.Access.SetSelected(BX.Landing.Access.selected,e);function s(){BX.Access.ShowForm({callback:t=>{for(let i in t){if(t.hasOwnProperty(i)){for(let s in t[i]){if(t[i].hasOwnProperty(s)){let l=this.table.rows.length;let a=this.table.insertRow(l-1);a.classList.add("landing-form-rights");BX.Landing.Access.selected[s]=true;a.insertCell(-1);a.insertCell(-1);a.cells[0].innerHTML=BX.Access.GetProviderName(i)+" "+BX.util.htmlspecialchars(t[i][s].name)+":"+'<input type="hidden" name="fields['+e+"][ACCESS_CODE]["+o+']" value="'+s+'">';a.cells[0].classList.add("landing-form-rights-right");a.cells[1].classList.add("landing-form-rights-left");a.cells[1].innerHTML=n.replace("#inc#",o)+' <a href="javascript:void(0);" onclick="BX.Landing.Access.onRowDelete(this);"'+' data-id="'+s+'" class="landing-form-rights-delete"></a>';o++}}}}},bind:e})}i.addEventListener("click",s.bind(this))};BX.Landing.Access.selected=[];BX.Landing.Access.onRowDelete=function(t){BX.Landing.Access.selected[BX.data(BX(t),"id")]=false;BX.remove(BX.findParent(BX(t),{tag:"tr"},true))};BX.Landing.Layout=function(t){this.params=t;this.params.messages=this.params.messages||{};this.container=this.params.container;this.areas=[];const e=[].slice.call(this.container.querySelectorAll(".landing-form-layout-item"));e.forEach((t=>{t.addEventListener("click",this.handleLayoutClick.bind(this))}));this.createBlocks(e[0].dataset.block);if(typeof this.params.areasCount!=="undefined"){this.changeLayout(this.params.areasCount,this.params.current)}const i=this.container.querySelector(".landing-form-select-buttons");i.addEventListener("click",this.handlerOnArrowClick.bind(this));if(this.params.tplUse){this.useCheck=this.params.tplUse;this.inputs=this.container.querySelectorAll(".layout-switcher");BX.addCustomEvent("BX.UI.LayoutForm:onToggle",(t=>{if(t.getData().checkbox&&t.getData().checkbox===this.useCheck){this.container.classList.add("landing-form-page-layout-short");this.inputs.forEach((t=>{t.checked=false}))}}))}};BX.Landing.Layout.prototype={handlerOnArrowClick:function(t){const e=this.container.querySelector(".landing-form-list-inner");if(t.target.classList.contains("landing-form-select-next")){e.classList.add("--prev")}else{e.classList.remove("--prev")}},createBlocks:function(t){const e=this.params.tplRefs.value.split(",");this.areas=[];const i=this.container.querySelector(".landing-form-layout-block-container");i.innerHTML="";for(let n=0;n<t;n++){const t=BX.create("div",{attrs:{className:"landing-form-layout-block-item"}});let o=n+1;let s="";if(typeof e[n]!=="undefined"&&e[n].indexOf(":")!==-1){s=parseInt(e[n].split(":")[1]);if(s>0){s="#landing"+s}else{s=""}}const l=new BX.Landing.UI.Field.LinkUrl({title:this.params.messages.area+" #"+o,content:s,textOnly:true,disableCustomURL:true,disableBlocks:true,disallowType:true,enableAreas:true,allowedTypes:[BX.Landing.UI.Field.LinkUrl.TYPE_PAGE],typeData:{button:{className:"fa fa-chevron-right",text:"",action:BX.Landing.UI.Field.LinkUrl.TYPE_PAGE},hideInput:false,contentEditable:false},settingMode:true,options:{siteId:this.params.siteId,landingId:this.params.landingId,filter:{"=TYPE":this.params.type}},onInit:this.rebuildHiddenField.bind(this),onInput:this.rebuildHiddenField.bind(this),onValueChange:this.rebuildHiddenField.bind(this)});this.areas[n]=l;t.appendChild(l.layout);i.appendChild(t)}},rebuildHiddenField:function(){let t="";for(let e=0,i=this.areas.length;e<i;e++){t+=e+1+":"+(this.areas[e].getValue()?this.areas[e].getValue().substr(13):0)+","}this.params.tplRefs.value=t},handleLayoutClick:function(t){const e=t.target.parentNode;const i=this.container.querySelector(".landing-form-layout-item-selected");if(i){i.classList.remove("landing-form-layout-item-selected")}this.changeLayout(e.dataset.block,e.dataset.layout)},changeLayout:function(t,e){const i=this.container.querySelector(".landing-form-layout-detail");this.container.classList.remove("landing-form-page-layout-short");i.classList.remove("landing-form-layout-detail-hidden");this.createBlocks(t);if(typeof e!=="undefined"){this.changeLayoutImg(e)}this.params.tplRefs.value=""},changeLayoutImg:function(t){const e=this.container.querySelectorAll(".landing-form-layout-img");for(let i=0;i<e.length;i++){if(e[i].dataset.layout===t){e[i].style.display="block"}else{e[i].style.display="none"}}}};BX.Landing.ToggleAdditionalFields=function(t){this.isOpen=false;this.form=t;this.hiddenRows=BX.convert.nodeListToArray(this.form.querySelectorAll(BX.Landing.ToggleAdditionalFields.SELECTOR_ROWS));this.toggleContainer=this.form.querySelector(BX.Landing.ToggleAdditionalFields.SELECTOR_CONTAINER);BX.Event.bind(this.toggleContainer,"click",this.onToggleClick.bind(this));if(window.location.hash){const t=window.location.hash.substr(1);this.hiddenRows.forEach((e=>{const i=e.dataset[BX.Landing.ToggleAdditionalFields.DATA_ROW_OPTION];if(i&&i===t){this.highlightHiddenRow(e)}}));const e=this.form.querySelector("["+BX.Landing.ToggleAdditionalFields.DATA_MAIN_OPTION_NAME+'="'+t+'"]');if(e){this.highlightRow(e)}}};BX.Landing.ToggleAdditionalFields.SELECTOR_ROWS=".landing-form-additional-row";BX.Landing.ToggleAdditionalFields.SELECTOR_CONTAINER=".landing-form-additional-fields-js";BX.Landing.ToggleAdditionalFields.DATA_OPTION="landingAdditionalOption";BX.Landing.ToggleAdditionalFields.DATA_ROW_OPTION="landingAdditionalDetail";BX.Landing.ToggleAdditionalFields.DATA_ROW_OPTION_NAME="data-landing-additional-detail";BX.Landing.ToggleAdditionalFields.DATA_MAIN_OPTION_NAME="data-landing-main-option";BX.Landing.ToggleAdditionalFields.CLASS_HIGHLIGHT="landing-form-row-highlight";BX.Landing.ToggleAdditionalFields.prototype={onToggleClick:function(t){if(t.target.dataset[BX.Landing.ToggleAdditionalFields.DATA_OPTION]){this.onHeaderClick(t)}else{this.toggleRows()}},toggleRows:function(){return this.isOpen?this.hideRows():this.showRows()},hideRows:function(){const t=[];this.hiddenRows.forEach((e=>{if(e.scrollHeight>0){e.style.height=0;t.push(l(e))}}));BX.Dom.removeClass(this.form,"landing-form-additional-open");this.isOpen=false;return Promise.all(t)},showRows:function(){const t=[];this.hiddenRows.forEach((e=>{if(e.scrollHeight>0){e.style.height="auto";t.push(l(e))}}));BX.Dom.addClass(this.form,"landing-form-additional-open");this.isOpen=true;return Promise.all(t)},onHeaderClick:function(t){const e=t.target.dataset[BX.Landing.ToggleAdditionalFields.DATA_OPTION];if(e){const t="["+BX.Landing.ToggleAdditionalFields.DATA_ROW_OPTION_NAME+' = "'+e+'"]';const i=this.form.querySelector(t);if(i){this.highlightHiddenRow(i)}}},highlightHiddenRow:function(t){const e=this.isOpen?Promise.resolve():this.showRows();e.then((()=>{this.highlightRow(t)}))},highlightRow:function(t){BX.Dom.addClass(t,BX.Landing.ToggleAdditionalFields.CLASS_HIGHLIGHT);window.scrollTo({top:BX.pos(t).top,behavior:"smooth"});setTimeout((()=>{BX.Dom.removeClass(t,BX.Landing.ToggleAdditionalFields.CLASS_HIGHLIGHT)}),2500)}};BX.Landing.ExternalMetrika=function(t,e,i){if(t.value===""){e.disabled=true;i.disabled=true}t.addEventListener("input",n.bind(this));function n(){if(t.value===""){e.disabled=true;e.checked=false;i.disabled=true;i.checked=false}else{e.disabled=false;i.disabled=false}}};BX.Landing.SaveBtn=function(t){t.addEventListener("click",e.bind(this));function e(){t.classList.add("ui-btn-clock");t.style.cursor="default";t.style.pointerEvents="none"}};BX.Landing.Cookies=function(){this.bgPickerBtn=document.querySelector(".landing-form-cookies-color-bg");this.textPickerBtn=document.querySelector(".landing-form-cookies-color-text");this.simplePreview=document.querySelector(".landing-form-cookies-settings-type-simple");this.advancedPreview=document.querySelector(".landing-form-cookies-settings-type-advanced");this.positions=document.querySelectorAll(".landing-form-cookies-position-item");this.inputApp=document.querySelector("#radio-cookies-mode-A");this.inputInfo=document.querySelector("#radio-cookies-mode-I");this.settings=document.querySelector(".landing-form-cookies-settings-wrapper");this.bgPicker=new BX.ColorPicker({bindElement:this.bgPickerBtn,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onBgColorSelected.bind(this),colors:BX.Landing.ColorPicker.prototype.setColors()});this.textPicker=new BX.ColorPicker({bindElement:this.textPickerBtn,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onTextColorSelected.bind(this),colors:BX.Landing.ColorPicker.prototype.setColors()});this.setSelectedBgColor(this.bgPickerBtn.value);this.setSelectedTextColor(this.textPickerBtn.value);this.hideCookiesSettings();this.bindEvents()};BX.Landing.Cookies.prototype={bindEvents:function(){this.positions.forEach(function(t){t.addEventListener("click",this.onSelectCookiesPosition.bind(this))}.bind(this));this.bgPickerBtn.addEventListener("click",this.showBgPicker.bind(this));this.textPickerBtn.addEventListener("click",this.showTextPicker.bind(this));this.inputInfo.addEventListener("change",this.hideCookiesSettings.bind(this));this.inputApp.addEventListener("change",this.showCookiesSettings.bind(this))},onBgColorSelected:function(){var t=this.bgPicker.getSelectedColor();this.setSelectedBgColor(t)},onTextColorSelected:function(){var t=this.textPicker.getSelectedColor();this.setSelectedTextColor(t)},onSelectCookiesPosition:function(t){this.positions.forEach(function(t){if(t.classList.contains("landing-form-cookies-position-item-selected")){t.classList.remove("landing-form-cookies-position-item-selected")}}.bind(this));t.currentTarget.classList.add("landing-form-cookies-position-item-selected")},showBgPicker:function(){this.bgPicker.open()},showTextPicker:function(){this.textPicker.open()},setSelectedBgColor:function(t){this.bgPickerBtn.style.background=t;this.bgPickerBtn.value=t;this.simplePreview.style.background=t;this.advancedPreview.style.background=t},setSelectedTextColor:function(t){this.textPickerBtn.style.background=t;this.textPickerBtn.value=t;this.advancedPreview.style.color=t;var e=document.querySelectorAll(".landing-form-cookies-settings-preview-svg");e.forEach((function(e){e.style.fill=t}))},hideCookiesSettings:function(){if(this.inputInfo.checked){this.settings.style.height="0";this.settings.style.opacity="0"}},showCookiesSettings:function(){if(this.inputApp.checked){this.settings.style.height=this.settings.scrollHeight+"px";this.settings.style.opacity="1";l(this.settings).then((()=>{this.settings.height="auto"}))}}};BX.Landing.B24ButtonColor=function(t,e){this.typeSelector=t;this.colorInput=e;this.valueControlWrap=BX.findParent(e,{class:"ui-ctl"});i(t,"change",this.checkVisibility.bind(this));this.checkVisibility()};BX.Landing.B24ButtonColor.prototype={checkVisibility:function(){this.valueControlWrap.hidden=this.typeSelector.value!=="custom";this.colorInput.labels.forEach((t=>{t.hidden=this.typeSelector.value!=="custom"}))}};BX.Landing.NeedPublicationField=function(t){t.forEach((function(t){var e=BX(t);if(e){BX.bind(e,"click",(function(){BX.UI.Dialogs.MessageBox.alert(BX.Loc.getMessage("LANDING_EDIT_NEED_PUBLICATION"))}))}}))};BX.Landing.ColorPalette=function(t,e){this.allColorsNode=t;this.customColorNode=null;this.colorPickerNode=null;if(typeof e!=="undefined"&&e){this.customColorNode=e;this.colorPickerNode=e.querySelector('input[type="text"]')}this.init();return this};BX.Landing.ColorPalette.prototype={init:function(){let e;if(this.allColorsNode){e=t(this.allColorsNode.children)}if(this.customColorNode){e=e.concat([this.customColorNode])}if(e){e.forEach(this.initSelectableItem,this)}if(e){this.setColor()}},setColor:function(t){if(t===undefined){this.color=s(this.getActiveColorNode(),"data-value")}else{this.color=t}if(this.colorPickerNode){this.colorPickerNode.setAttribute("value",this.color)}},getActiveColorNode:function(){let t;if(this.allColorsNode){t=this.allColorsNode.querySelector(".active")}if(!t&&this.customColorNode&&BX.Dom.hasClass(this.customColorNode,"active")){t=this.customColorNode}if(!t&&this.allColorsNode){t=this.allColorsNode.firstElementChild}return t},initSelectableItem:function(t){i(t,"click",e(this.onSelectableItemClick,this))},onSelectableItemClick:function(t){t.preventDefault();if(t.currentTarget.parentElement===this.allColorsNode){if(t.currentTarget.hasAttribute("data-value")){o(this.getActiveColorNode(),"active");n(t.currentTarget,"active");this.setColor(s(t.currentTarget,"data-value"))}}this.currentTarget=t.currentTarget;BX.Event.EventEmitter.subscribe("BX.Landing.ColorPickerTheme:onSelectColor",(()=>{if(this.currentTarget.hasAttribute("data-value")){o(this.getActiveColorNode(),"active");n(this.currentTarget,"active");this.setColor(s(this.currentTarget,"data-value"))}}))}};BX.Landing.ColorPicker=function(t,e){let i;if(e){i=e.defaultColor}this.picker=new BX.ColorPicker({bindElement:t,popupOptions:{angle:false,offsetTop:5},onColorSelected:this.onColorSelected.bind(this),colors:this.setColors(),selectedColor:i});this.input=t;this.colorPickerNode=t.parentElement;BX.addClass(this.colorPickerNode,"ui-colorpicker");this.colorIcon=BX.create("span",{props:{className:"ui-colorpicker-color"}});BX.insertBefore(this.colorIcon,this.input);this.colorValue=t.value;if(!this.colorValue&&i){t.value=i;this.colorValue=t.value}if(this.colorValue){BX.adjust(this.colorIcon,{attrs:{style:"background-color:"+this.colorValue}});BX.addClass(this.colorPickerNode,"ui-colorpicker-selected")}this.clearBtn=BX.create("span",{props:{className:"ui-colorpicker-clear"}});BX.insertAfter(this.clearBtn,this.input);BX.bind(this.colorPickerNode,"click",this.show.bind(this));BX.bind(this.clearBtn,"click",this.clear.bind(this))};BX.Landing.ColorPicker.prototype={onColorSelected:function(t){this.colorPickerNode.classList.add("ui-colorpicker-selected");this.colorIcon.style.backgroundColor=t;this.input.value=t;BX.Event.EventEmitter.emit(this,"BX.Landing.ColorPicker:onSelectColor")},show:function(t){if(t.target===this.clearBtn){return}this.picker.open()},clear:function(){this.colorPickerNode.classList.remove("ui-colorpicker-selected");this.input.value="";this.picker.setSelectedColor(null);BX.Event.EventEmitter.emit(this,"BX.Landing.ColorPicker:onClearColorPicker")},setColors:function(){return[["#f5f5f5","#eeeeee","#e0e0e0","#9e9e9e","#757575","#616161","#212121"],["#cfd8dc","#b0bec5","#90a4ae","#607d8b","#546e7a","#455a64","#263238"],["#d7ccc8","#bcaaa4","#a1887f","#795548","#6d4c41","#5d4037","#3e2723"],["#ffccbc","#ffab91","#ff8a65","#ff5722","#f4511e","#e64a19","#bf360c"],["#ffe0b2","#ffcc80","#ffb74d","#ff9800","#fb8c00","#f57c00","#e65100"],["#ffecb3","#ffe082","#ffd54f","#ffc107","#ffb300","#ffa000","#ff6f00"],["#fff9c4","#fff59d","#fff176","#ffeb3b","#fdd835","#fbc02d","#f57f17"],["#f0f4c3","#e6ee9c","#dce775","#cddc39","#c0ca33","#afb42b","#827717"],["#dcedc8","#c5e1a5","#aed581","#8bc34a","#7cb342","#689f38","#33691e"],["#c8e6c9","#a5d6a7","#81c784","#4caf50","#43a047","#388e3c","#1b5e20"],["#b2dfdb","#80cbc4","#4db6ac","#009688","#00897b","#00796b","#004d40"],["#b2ebf2","#80deea","#4dd0e1","#00bcd4","#00acc1","#0097a7","#006064"],["#b3e5fc","#81d4fa","#4fc3f7","#03a9f4","#039be5","#0288d1","#01579b"],["#bbdefb","#90caf9","#64b5f6","#2196f3","#1e88e5","#1976d2","#0d47a1"],["#c5cae9","#9fa8da","#7986cb","#3f51b5","#3949ab","#303f9f","#1a237e"],["#d1c4e9","#b39ddb","#9575cd","#673ab7","#5e35b1","#512da8","#311b92"],["#e1bee7","#ce93d8","#ba68c8","#9c27b0","#8e24aa","#7b1fa2","#4a148c"],["#f8bbd0","#f48fb1","#f06292","#e91e63","#d81b60","#c2185b","#880e4f"],["#ffcdd2","#ef9a9a","#e57373","#f44336","#e53935","#d32f2f","#b71c1c"]].map((function(t,e,i){return i.map((function(t){return t[e]}))}))}}})();
//# sourceMappingURL=landing-forms.map.js