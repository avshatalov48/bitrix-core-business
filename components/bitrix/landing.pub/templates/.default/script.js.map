{"version":3,"file":"script.js","sources":["src/js/landing.pub.top.panel.js","src/js/landing.pub.search.result.js"],"sourcesContent":["import {Event, Cache, Dom, Type} from 'main.core';\nimport {SliderHacks} from 'landing.sliderhacks';\n\nconst onEditButtonClick = Symbol('onEditButtonClick');\nconst onBackButtonClick = Symbol('onBackButtonClick');\nconst onForwardButtonClick = Symbol('onForwardButtonClick');\n\nexport class TopPanel\n{\n\tstatic cache = new Cache.MemoryCache();\n\n\tconstructor()\n\t{\n\t\tEvent.bind(TopPanel.getEditButton(), 'click', this[onEditButtonClick]);\n\t\tEvent.bind(TopPanel.getBackButton(), 'click', this[onBackButtonClick]);\n\t\tEvent.bind(TopPanel.getForwardButton(), 'click', this[onForwardButtonClick]);\n\n\t\tTopPanel.pushHistory(window.location.toString());\n\t\tTopPanel.checkNavButtonsActivity();\n\t}\n\n\tstatic getLayout(): HTMLDivElement\n\t{\n\t\treturn TopPanel.cache.remember('layout', () => {\n\t\t\treturn document.querySelector('.landing-pub-top-panel');\n\t\t});\n\t}\n\n\tstatic getEditButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('editButton', () => {\n\t\t\treturn TopPanel.getLayout().querySelector('.landing-pub-top-panel-edit-button');\n\t\t});\n\t}\n\n\t[onEditButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst href = Dom.attr(event.currentTarget, 'href');\n\t\tconst landingId = Dom.attr(event.currentTarget, 'data-landingId');\n\n\t\tif (Type.isString(href) && href !== '')\n\t\t{\n\t\t\tTopPanel.openSlider(href, landingId);\n\t\t}\n\t}\n\n\tstatic openSlider(url, landingId)\n\t{\n\t\tBX.SidePanel.Instance.open(url, {\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 240,\n\t\t\tallowChangeHistory: false,\n\t\t\tevents: {\n\t\t\t\tonClose() {\n\t\t\t\t\tvoid SliderHacks.reloadSlider(\n\t\t\t\t\t\twindow.location.toString().split('#')[0] + '#landingId' + landingId\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t// HISTORY save\n\tstatic history = [];\n\tstatic historyState;\n\n\tstatic pushHistory(url)\n\t{\n\t\tif (!Type.isNumber(TopPanel.historyState))\n\t\t{\n\t\t\tTopPanel.historyState = -1; // will increase later\n\t\t}\n\n\t\tif (TopPanel.historyState < TopPanel.history.length - 1)\n\t\t{\n\t\t\tTopPanel.history.splice(TopPanel.historyState + 1);\n\t\t}\n\n\t\tTopPanel.history.push(url);\n\t\tTopPanel.historyState++;\n\t}\n\n\tstatic checkNavButtonsActivity()\n\t{\n\t\tDom.removeClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\tDom.removeClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\n\t\tif (\n\t\t\t!Type.isArrayFilled(TopPanel.history)\n\t\t\t|| !Type.isNumber(TopPanel.historyState)\n\t\t\t|| TopPanel.history.length === 1\n\t\t)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\t\tDom.addClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\t\t\treturn;\n\t\t}\n\n\t\tif (TopPanel.historyState === 0)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getBackButton(), 'ui-btn-disabled');\n\t\t}\n\n\t\tif (TopPanel.historyState >= TopPanel.history.length - 1)\n\t\t{\n\t\t\tDom.addClass(TopPanel.getForwardButton(), 'ui-btn-disabled');\n\t\t}\n\t}\n\n\tstatic getBackButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('backButton', () => {\n\t\t\tconst layout = TopPanel.getLayout();\n\t\t\treturn layout ? layout.querySelector('.landing-pub-top-panel-back') : null;\n\t\t});\n\t}\n\n\tstatic getForwardButton(): HTMLAnchorElement\n\t{\n\t\treturn TopPanel.cache.remember('forwardButton', () => {\n\t\t\tconst layout = TopPanel.getLayout();\n\t\t\treturn layout ? layout.querySelector('.landing-pub-top-panel-forward') : null;\n\t\t});\n\t}\n\n\t[onBackButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\t\tif (\n\t\t\tType.isArrayFilled(TopPanel.history)\n\t\t\t&& Type.isNumber(TopPanel.historyState)\n\t\t\t&& TopPanel.historyState > 0\n\t\t)\n\t\t{\n\t\t\tvoid SliderHacks.reloadSlider(TopPanel.history[--TopPanel.historyState]);\n\t\t\tTopPanel.checkNavButtonsActivity();\n\t\t}\n\t}\n\n\t[onForwardButtonClick](event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (\n\t\t\tType.isArrayFilled(TopPanel.history)\n\t\t\t&& Type.isNumber(TopPanel.historyState)\n\t\t\t&& (TopPanel.historyState < TopPanel.history.length - 1)\n\t\t)\n\t\t{\n\t\t\tvoid SliderHacks.reloadSlider(TopPanel.history[++TopPanel.historyState]);\n\t\t\tTopPanel.checkNavButtonsActivity();\n\t\t}\n\t}\n}","\n\nexport class SearchResult\n{\n\t/**\n\t * Constructor.\n\t */\n\tconstructor()\n\t{\n\t\tthis.scrollToFirstBlock();\n\t}\n\n\t/**\n\t * Finds first highlight word and scroll to it.\n\t * @return {void}\n\t */\n\tscrollToFirstBlock()\n\t{\n\t\tvar result = document.querySelector('.landing-highlight');\n\t\tif (result)\n\t\t{\n\t\t\tvar parent = result.parentNode;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tif (parent.classList.contains('block-wrapper'))\n\t\t\t\t{\n\t\t\t\t\twindow.scrollTo({\n\t\t\t\t\t\ttop: parent.offsetTop,\n\t\t\t\t\t\tbehavior: 'smooth'\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\t\t}\n\t}\n}"],"names":["onEditButtonClick","Symbol","onBackButtonClick","onForwardButtonClick","TopPanel","Event","bind","getEditButton","getBackButton","getForwardButton","pushHistory","window","location","toString","checkNavButtonsActivity","event","preventDefault","href","Dom","attr","currentTarget","landingId","Type","isString","openSlider","isArrayFilled","history","isNumber","historyState","SliderHacks","reloadSlider","length","cache","remember","document","querySelector","getLayout","url","BX","SidePanel","Instance","open","cacheable","customLeftBoundary","allowChangeHistory","events","onClose","split","splice","push","removeClass","addClass","layout","Cache","MemoryCache","SearchResult","scrollToFirstBlock","result","parent","parentNode","classList","contains","scrollTo","top","offsetTop","behavior"],"mappings":"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"}