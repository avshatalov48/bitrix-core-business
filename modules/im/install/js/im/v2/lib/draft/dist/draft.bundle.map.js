{"version":3,"file":"draft.bundle.map.js","names":["this","BX","Messenger","v2","exports","main_core","main_core_events","im_v2_lib_logger","im_v2_application_core","ui_dexie","im_v2_lib_localStorage","im_v2_const","DB_NAME","recentDraftLocalStorageKey","copilotDraftLocalStorageKey","IndexedDbManager","static","instance","constructor","db","Dexie","version","stores","drafts","async","migrationStatus","get","recentDrafts","LocalStorageManager","getInstance","set","remove","copilotDrafts","setMigrationFinished","key","value","put","result","defaultValue","migrateFromLocalStorage","WRITE_TO_STORAGE_TIMEOUT","SHOW_DRAFT_IN_RECENT_TIMEOUT","STORAGE_KEY","DraftManager","inited","initPromise","Promise","resolve","initPromiseResolver","EventEmitter","subscribe","EventType","layout","onLayoutChange","bind","draftHistory","getStorageKey","fillDraftsFromStorage","Logger","warn","setRecentListDraftText","ready","Type","isPlainObject","Object","entries","forEach","dialogId","draft","setDraftText","text","trim","refreshSaveTimeout","setDraftPanel","panelType","messageId","panelMessageId","setDraftMentions","mentions","_this$drafts$dialogId","clearDraft","setRecentItemDraftText","_draft$text","Core","getStore","dispatch","getDraftMethodName","id","event","from","getData","name","getLayoutName","entityId","setTimeout","getDraft","clearTimeout","writeToStorageTimeout","saveToIndexedDb","prepareDrafts","TextareaPanelType","edit","Layout","chat","STORAGE_KEY$1","CopilotDraftManager","copilot","Lib","Event","Application","Dexie3","Const"],"sources":["draft.bundle.js"],"mappings":"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"}