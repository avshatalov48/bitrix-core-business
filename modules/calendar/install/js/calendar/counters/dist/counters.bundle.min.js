this.BX=this.BX||{};(function(t,e,s,r){"use strict";class i extends s.CounterPanel{constructor(t){super({target:t.countersWrap,items:i.getCountersValue(t.counters),multiselect:false});this.search=t.search;this.userId=t.userId;this.counters=t.counters;this.countersWrap=t.countersWrap;this.bindEvents()}bindEvents(){r.EventEmitter.subscribe("BX.UI.CounterPanel.Item:activate",this.onActivateItem.bind(this));r.EventEmitter.subscribe("BX.UI.CounterPanel.Item:deactivate",this.onDeactivateItem.bind(this));r.EventEmitter.subscribe("BX.Main.Filter:apply",this.onFilterApply.bind(this))}onActivateItem(t){const e=t.getData();const s=e.id===i.TYPE_INVITATION||i.checkCounterIsForGroup(e.id);if(s){this.search.setPresetInvitation()}}onDeactivateItem(){this.search.resetPreset()}recalculateCounters(){Object.entries(this.counters).forEach((([t,e])=>{const s=this.getItemById(t);s==null?void 0:s.updateValue(e.value);s==null?void 0:s.updateColor(e.color)}))}markCounters(){Object.entries(this.counters).forEach((([t,e])=>{const s=this.getItemById(t);if(s.id==="invitation"||s.id.includes("calendar_group_invites_")){this.fields.MEETING_STATUS==="Q"?s.activate(false):s.deactivate(false)}}))}setCountersValue(t){this.counters=t;this.recalculateCounters()}onFilterApply(){this.fields=this.search.filter.getFilterFieldsValues();this.markCounters()}static checkCounterIsForGroup(t){return new RegExp(i.TYPE_GROUP_INVITATION_TPL).test(t)}static getCountersValue(t){return Object.entries(t).map((([t,e])=>({id:t,title:i.getCountersName(t),value:e.value,color:e.color})))}static getCountersName(t){if(t===i.TYPE_INVITATION||i.checkCounterIsForGroup(t)){return e.Loc.getMessage("EC_COUNTER_INVITATION")}return null}static getCounterNameByGroupId(t){return i.TYPE_GROUP_INVITATION_TPL.replace("\\d",t)}}i.TYPE_INVITATION="invitation";i.TYPE_GROUP_INVITATION_TPL="calendar_group_invites_\\d";t.Counters=i})(this.BX.Calendar=this.BX.Calendar||{},BX,BX.UI,BX.Event);
//# sourceMappingURL=counters.bundle.map.js