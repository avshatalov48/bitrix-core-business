{"version":3,"file":"widgetvue.bundle.js","sources":["../src/widgetvue.js"],"sourcesContent":["import {WidgetOptions} from './internal/types';\nimport {Backend} from 'landing.backend';\nimport {Loc, Text, Type, Dom, Event} from 'main.core';\n\nimport './css/style.css';\n\nexport class WidgetVue\n{\n\tstatic runningAppNodes: Set<HTMLElement> = new Set();\n\n\t#rootNode: ?HTMLElement = null;\n\t#template: string;\n\t#lang: {[key: string]: string} = {};\n\t#appId: number = 0;\n\t#appAllowedByTariff: boolean = true;\n\t#fetchable: boolean = false;\n\t#clickable: boolean = false;\n\n\t/**\n\t * Unique string for every widget\n\t * @type {string}\n\t */\n\t#uniqueId: string;\n\t// #rootContent: ?string = null;\n\t#frame: ?Window = null;\n\n\t#defaultData: ?{} = null;\n\t#blockId: number = 0;\n\n\t// #application: VueCreateAppResult;\n\t// #contentComponent: Object;\n\n\t// #widgetOptions: {};\n\n\tconstructor(options: WidgetOptions): void\n\t{\n\t\tthis.#uniqueId = 'widget' + Text.getRandom(8);\n\n\t\tthis.#rootNode = Type.isString(options.rootNode)\n\t\t\t? document.querySelector(options.rootNode)\n\t\t\t: null\n\t\t;\n\n\t\tthis.#template = Type.isString(options.template) ? options.template : '';\n\n\t\t// this.#rootContent = this.#rootNode ? this.#rootNode.innerHTML : null;\n\n\t\tthis.#defaultData = Type.isObject(options.data) ? options.data : null;\n\t\tthis.#lang = options.lang || {};\n\t\tthis.#blockId = options.blockId ? Text.toNumber(options.blockId) : 0;\n\n\t\t// const isEditMode = Type.isFunction(BX.Landing.getMode) && BX.Landing.getMode() === 'edit';\n\t\t// this.#widgetOptions.clickable = !isEditMode;\n\n\t\tthis.#appId = options.appId ? Text.toNumber(options.appId) : 0;\n\t\tthis.#appAllowedByTariff = (this.#appId && Type.isBoolean(options.appAllowedByTariff))\n\t\t\t? options.appAllowedByTariff\n\t\t\t: true\n\t\t;\n\n\t\tthis.#fetchable = Type.isBoolean(options.fetchable) ? options.fetchable : false;\n\t\tconst isEditMode = Type.isFunction(BX.Landing.getMode) && BX.Landing.getMode() === 'edit';\n\t\tthis.#clickable = !isEditMode;\n\t}\n\n\t/**\n\t * Create frame with widget content\n\t * @returns {Promise|*}\n\t */\n\tmount()\n\t{\n\t\treturn this.#getFrameContent()\n\t\t\t.then(srcDoc => {\n\t\t\t\tthis.#frame = document.createElement('iframe');\n\t\t\t\tthis.#frame.className = 'landing-widgetvue-iframe';\n\t\t\t\tthis.#frame.sandbox = 'allow-scripts';\n\t\t\t\tthis.#frame.srcdoc = srcDoc;\n\n\t\t\t\tif (\n\t\t\t\t\tthis.#blockId > 0\n\t\t\t\t\t&& this.#rootNode\n\t\t\t\t\t&& !WidgetVue.runningAppNodes.has(this.#rootNode)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst blockWrapper = this.#rootNode.parentElement;\n\t\t\t\t\tDom.clean(blockWrapper);\n\t\t\t\t\tDom.append(this.#frame, blockWrapper);\n\n\t\t\t\t\tthis.#bindEvents();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\t#getFrameContent(): Promise<string>\n\t{\n\t\tlet content = '';\n\n\t\tconst engineParams = {\n\t\t\tid: this.#uniqueId,\n\t\t\torigin: window.location.origin,\n\t\t\tfetchable: this.#fetchable,\n\t\t\tclickable: this.#clickable,\n\t\t};\n\n\t\treturn this.#getCoreConfigs()\n\t\t\t.then(core => {\n\t\t\t\tcontent += this.#parseExtensionConfig(core);\n\t\t\t\tcontent += this.#parseExtensionConfig({\n\t\t\t\t\tlang_additional: this.#lang,\n\t\t\t\t});\n\n\t\t\t\treturn this.#getAssetsConfigs();\n\t\t\t})\n\n\t\t\t.then(assets => {\n\t\t\t\tcontent += this.#parseExtensionConfig(assets);\n\n\t\t\t\tif (!this.#appAllowedByTariff)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(Loc.getMessage('LANDING_WIDGETVUE_ERROR_PAYMENT'));\n\t\t\t\t}\n\n\t\t\t\tif (this.#defaultData)\n\t\t\t\t{\n\t\t\t\t\treturn this.#defaultData;\n\t\t\t\t}\n\n\t\t\t\treturn this.#fetchData();\n\t\t\t})\n\n\t\t\t.then(data => {\n\t\t\t\tengineParams.data = data;\n\t\t\t})\n\n\t\t\t.catch(error => {\n\t\t\t\tengineParams.error = error.message || 'error';\n\t\t\t})\n\n\t\t\t.then(() => {\n\t\t\t\tconst appInit = `\n\t\t\t\t\t<script>\n\t\t\t\t\t\tBX.ready(function() {\n\t\t\t\t\t\t\t(new BX.Landing.WidgetVue.Engine(\n\t\t\t\t\t\t\t\t${JSON.stringify(engineParams)}\n\t\t\t\t\t\t\t)).render();\n\t\t\t\t\t\t});\n\t\t\t\t\t</script>\n\t\t\t\t\t\n\t\t\t\t\t<div id=\"${this.#uniqueId}\">${this.#template}</div>\n\t\t\t\t`;\n\n\t\t\t\tcontent += appInit;\n\n\t\t\t\treturn content;\n\t\t\t})\n\t\t;\n\t}\n\n\t#getCoreConfigs(): Promise<Object>\n\t{\n\t\tconst extCodes = [\n\t\t\t'main.core',\n\t\t\t'ui.design-tokens',\n\t\t];\n\t\tconst tplCodes = [\n\t\t\t'bitrix24',\n\t\t];\n\n\t\treturn Backend.getInstance()\n\t\t\t.action(\n\t\t\t\t'Block::getAssetsConfig',\n\t\t\t\t{\n\t\t\t\t\textCodes,\n\t\t\t\t\ttplCodes,\n\t\t\t\t},\n\t\t\t)\n\t\t;\n\t}\n\n\t#getAssetsConfigs(): Promise<Object>\n\t{\n\t\tconst extCodes = [\n\t\t\t'landing.widgetvue.engine',\n\t\t];\n\n\t\treturn Backend.getInstance()\n\t\t\t.action(\n\t\t\t\t'Block::getAssetsConfig',\n\t\t\t\t{ extCodes },\n\t\t\t)\n\t\t;\n\t}\n\n\t#parseExtensionConfig(ext: Object): string\n\t{\n\t\tconst domain = `${document.location.protocol}//${document.location.host}`;\n\t\tlet html = '';\n\n\t\tif (ext.lang_additional !== undefined)\n\t\t{\n\t\t\thtml += `<script>BX.message(${JSON.stringify(ext.lang_additional)})</script>`;\n\t\t}\n\n\t\t(ext.js || []).forEach(js => {\n\t\t\thtml += `<script src=\"${domain}${js}\"></script>`;\n\t\t});\n\n\t\t(ext.css || []).forEach(css => {\n\t\t\thtml += `<link href=\"${domain}${css}\" type=\"text/css\" rel=\"stylesheet\" />`;\n\t\t});\n\n\t\treturn html;\n\t}\n\n\t#fetchData(params = {}): Promise<Object>\n\t{\n\t\tif (!this.#fetchable)\n\t\t{\n\t\t\tconsole.info('Fetch data is impossible now (haven`t handler)');\n\n\t\t\treturn Promise.resolve({});\n\t\t}\n\n\t\treturn Backend.getInstance()\n\t\t\t.action('RepoWidget::fetchData', {\n\t\t\t\tblockId: this.#blockId,\n\t\t\t\tparams,\n\t\t\t})\n\n\t\t\t.then(jsonData => {\n\t\t\t\tlet data = {};\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tdata = JSON.parse(jsonData);\n\t\t\t\t\tif (data.error)\n\t\t\t\t\t{\n\t\t\t\t\t\tthrow new Error(Loc.getMessage('LANDING_WIDGETVUE_ERROR_FETCH'), data.error);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch (error)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(Loc.getMessage('LANDING_WIDGETVUE_ERROR_FETCH'), error);\n\t\t\t\t}\n\n\t\t\t\treturn data;\n\t\t\t})\n\t\t;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(window, 'message', this.#onMessage.bind(this));\n\t}\n\n\t#onMessage(event)\n\t{\n\t\tif (event.data && event.data.name && event.data.params)\n\t\t{\n\t\t\tif (event.data.name === 'fetchData')\n\t\t\t{\n\t\t\t\tthis.#fetchData(event.data.params)\n\t\t\t\t\t.then(data => {\n\t\t\t\t\t\tevent.source.postMessage(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'setData',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'*',\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tevent.source.postMessage(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'setError',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'*',\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.data.name === 'setSize'\n\t\t\t\t&& event.data.params.size !== undefined\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.#frame.height = parseInt(event.data.params.size);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.data.name === 'openApplication'\n\t\t\t\t&& this.#appId > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst params = Type.isObject(event.data.params) ? event.data.params : {};\n\t\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\t\tthis.#appId,\n\t\t\t\t\tparams,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tevent.data.name === 'openPath'\n\t\t\t\t&& Type.isString(event.data.path)\n\t\t\t)\n\t\t\t{\n\t\t\t\t// todo: change open function\n\t\t\t\tconst url = new URL(event.data.path, window.location.origin);\n\t\t\t\tif (url.origin === window.location.origin)\n\t\t\t\t{\n\t\t\t\t\twindow.open(url.href, '_blank');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["WidgetVue","constructor","options","Text","getRandom","Type","isString","rootNode","document","querySelector","template","isObject","data","lang","blockId","toNumber","appId","isBoolean","appAllowedByTariff","fetchable","isEditMode","isFunction","BX","Landing","getMode","mount","then","srcDoc","createElement","className","sandbox","srcdoc","runningAppNodes","has","blockWrapper","parentElement","Dom","clean","append","content","engineParams","id","origin","window","location","clickable","core","lang_additional","assets","Error","Loc","getMessage","catch","error","message","appInit","JSON","stringify","extCodes","tplCodes","Backend","getInstance","action","ext","domain","protocol","host","html","undefined","js","forEach","css","params","console","info","Promise","resolve","jsonData","parse","Event","bind","event","name","source","postMessage","size","height","parseInt","rest","AppLayout","openApplication","path","url","URL","open","href","Set"],"mappings":"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"}