this.BX=this.BX||{};this.BX.Bizproc=this.BX.Bizproc||{};(function(e,t,s){"use strict";var i,r,l,n;function c(e,t){a(e,t);t.add(e)}function a(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function d(e,t,s){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return s}var o=s.Reflection.namespace("BX.Bizproc.Activity");var u=new WeakSet;var p=new WeakSet;var h=new WeakSet;var y=new WeakSet;var f=function(){function e(t){babelHelpers.classCallCheck(this,e);c(this,y);c(this,h);c(this,p);c(this,u);babelHelpers.defineProperty(this,"resultFieldsContainer",undefined);babelHelpers.defineProperty(this,"accessFieldsContainer",undefined);babelHelpers.defineProperty(this,"accessTypeSelect",undefined);babelHelpers.defineProperty(this,"resultTypeSelect",undefined);babelHelpers.defineProperty(this,"currentResultValues",{});babelHelpers.defineProperty(this,"currentAccessValues",{});babelHelpers.defineProperty(this,"renderedResultProperties",{});babelHelpers.defineProperty(this,"renderedAccessProperties",{});this.accessFieldsContainer=document.getElementById("access-fields-container");this.resultFieldsContainer=document.getElementById("result-fields-container");if(s.Type.isPlainObject(t)){var i=document.forms[t.formName];if(!s.Type.isNil(i)){this.accessTypeSelect=i.access_type;this.resultTypeSelect=i.result_type}this.resultFieldsMap=t.resultFieldsMap;this.accessFieldsMap=t.accessFieldsMap;this.objectTabs=t.objectTabs;this.template=t.template;this.activityFilter=t.activityFilter;if(s.Type.isPlainObject(t.currentResultValues)){this.currentResultValues=t.currentResultValues}if(s.Type.isPlainObject(t.currentAccessValues)){this.currentAccessValues=t.currentAccessValues}}}babelHelpers.createClass(e,[{key:"getBindFieldId",value:function e(){return"".concat(this.currentResultType,"_BindToCurrentElement")}},{key:"init",value:function e(){if(this.resultTypeSelect){this.renderResultFields();s.Event.bind(this.resultTypeSelect,"change",this.onResultTypeChange.bind(this))}if(this.accessTypeSelect){this.renderAccessFields();s.Event.bind(this.accessTypeSelect,"change",this.onAccessTypeChange.bind(this))}}},{key:"onResultTypeChange",value:function e(){s.Dom.clean(this.resultFieldsContainer);this.currentResultValues={};this.renderResultFields()}},{key:"onAccessTypeChange",value:function e(){s.Dom.clean(this.accessFieldsContainer);this.currentAccessValues={};this.renderAccessFields()}},{key:"renderResultFields",value:function e(){if(Object.hasOwn(this.resultFieldsMap,this.currentResultType)){var t=this.resultFieldsMap[this.currentResultType],i=t.documentType,r=t.fieldsMap;this.loadRenderedResultFields();for(var l=0,n=Object.keys(r);l<n.length;l++){var c=n[l];s.Dom.append(d(this,u,b).call(this,c),this.resultFieldsContainer)}}}},{key:"renderAccessFields",value:function e(){if(Object.hasOwn(this.accessFieldsMap,this.currentAccessType)){var t=this.accessFieldsMap[this.currentAccessType],i=t.documentType,r=t.fieldsMap;this.loadRenderedAccessFields();for(var l=0,n=Object.keys(r);l<n.length;l++){var c=n[l];s.Dom.append(d(this,p,T).call(this,c),this.accessFieldsContainer)}}}},{key:"loadRenderedResultFields",value:function e(){var t=this;var i=this.resultFieldsMap[this.currentResultType],r=i.documentType,l=i.fieldsMap;if(s.Type.isFunction(BX.Bizproc.FieldType.renderControlCollection)){this.renderedResultProperties=BX.Bizproc.FieldType.renderControlCollection(r,Object.entries(l).map((function(e){var s=babelHelpers.slicedToArray(e,2),i=s[0],r=s[1];return{property:r,fieldName:r.FieldName,value:t.currentResultValues[i],controlId:i}})),"designer")}}},{key:"loadRenderedAccessFields",value:function e(){var t=this;var i=this.accessFieldsMap[this.currentAccessType],r=i.documentType,l=i.fieldsMap;if(s.Type.isFunction(BX.Bizproc.FieldType.renderControlCollection)){this.renderedAccessProperties=BX.Bizproc.FieldType.renderControlCollection(r,Object.entries(l).map((function(e){var s=babelHelpers.slicedToArray(e,2),i=s[0],r=s[1];return{property:r,fieldName:r.FieldName,value:t.currentAccessValues[i],controlId:i}})),"designer")}}},{key:"currentResultType",get:function e(){if(!this.resultTypeSelect){return 0}return s.Text.toNumber(this.resultTypeSelect.value)}},{key:"currentAccessType",get:function e(){if(!this.accessTypeSelect){return 0}return s.Text.toNumber(this.accessTypeSelect.value)}}]);return e}();function b(e){var t=this;var r=this.resultFieldsMap[this.currentResultType],l=r.documentType,n=r.fieldsMap;var c=n[e];if(c.Type==="mixed"){return d(this,h,v).call(this,c)}var a=function s(){return BX.Bizproc.FieldType.renderControlDesigner(l,c,c.FieldName,t.currentResultValues[e])};return s.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr>\n\t\t\t\t<td class="adm-detail-content-cell-l" style="text-align: right; vertical-align: middle" align="right" width="25%">','</td>\n\t\t\t\t<td width="75%" class="adm-detail-content-cell-r">\n\t\t\t\t\t',"\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t"])),s.Text.encode(c.Name),s.Type.isDomNode(this.renderedResultProperties[e])?this.renderedResultProperties[e]:a())}function T(e){var t=this;var i=this.accessFieldsMap[this.currentAccessType],l=i.documentType,n=i.fieldsMap;var c=n[e];var a=function s(){return BX.Bizproc.FieldType.renderControlDesigner(l,c,c.FieldName,t.currentAccessValues[e])};return s.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr>\n\t\t\t\t<td class="adm-detail-content-cell-l" style="text-align: right; vertical-align: middle" align="right" width="25%">','</td>\n\t\t\t\t<td width="75%" class="adm-detail-content-cell-r">\n\t\t\t\t\t',"\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t"])),s.Text.encode(c.Name),s.Type.isDomNode(this.renderedAccessProperties[e])?this.renderedAccessProperties[e]:a())}function v(e){var i,r;var c=s.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['<td class="adm-detail-content-cell-r" width="75%"></td>'])));var a=(i=this.currentResultValues.ResultItem)===null||i===void 0?void 0:i.object;var o=(r=this.currentResultValues.ResultItem)===null||r===void 0?void 0:r.field;this.selector=new t.BpMixedSelector({targetNode:c,template:this.template,exceptErrorMessages:true,objectTabs:this.objectTabs,activityFilter:this.activityFilter,inputNames:{object:"result_item_object",field:"result_item_field"}});this.selector.renderMixedSelector();if(a&&o&&this.objectTabs[a]&&this.objectTabs[a][o]){this.selector.setSelectedObjectAndField(a,o,this.objectTabs[a][o].Name)}else{var u=d(this,y,m).call(this,a,o);if(u){this.selector.setSelectedObjectAndField(a,o,u)}}var p=s.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<tr \n\t\t\t\tdata-object="','"\n\t\t\t\tdata-field="','">\n\t\t\t\t<td class="adm-detail-content-cell-l" style="text-align: right; vertical-align: middle" align="right" width="25%">',":</td>\n\t\t\t\t","\n\t\t\t</tr>\n\t\t"])),s.Text.encode(a!==null&&a!==void 0?a:""),s.Text.encode(o!==null&&o!==void 0?o:""),s.Text.encode(e.Name),c);if(this.selector){this.selector.subscribe("onSelect",(function(e){p.setAttribute("data-object",e.data.item.object);p.setAttribute("data-field",e.data.item.field)}))}return p}function m(e,t){var s=this.selector.getMenuItemsByTabName("Activity");for(var i in s){var r=s[i];if(r.object===e){var l=r.items;for(var n in l){var c=l[n];if(c.field===t){return c.text}}}}return null}o.FixResultActivity=f})(this.BX.Bizproc.Activity=this.BX.Bizproc.Activity||{},BX.Bizproc,BX);
//# sourceMappingURL=script.map.js