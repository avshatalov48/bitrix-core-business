{"version":3,"file":"script.js","sources":["src/util.js","src/confidentialityselector.js","src/scrum.js","src/avatar.js","src/date.corrector.js","src/themepicker.js","src/tags.js","src/typepresetselector.js","src/fields.js","src/buttons.js","src/wizard.js","src/alert.js","src/team.js","src/features.js","src/uf.js","src/index.js"],"sourcesContent":["import {Loc, Type, Dom, Tag} from 'main.core';\n\nimport {WorkgroupForm} from './index';\n\nexport class Util\n{\n\tstatic cssClass = {\n\t\tselectorActive: '--active',\n\t\tselectorDisabled: '--disabled',\n\t};\n\n\tstatic initExpandSwitches()\n\t{\n\t\tconst expandSwitchers = document.querySelectorAll('[data-role=\"socialnetwork-group-create-ex__expandable\"]');\n\n\t\texpandSwitchers.forEach((switcher) => {\n\n\t\t\tswitcher.addEventListener('click', (e) => {\n\n\t\t\t\tconst targetId = e.currentTarget.getAttribute('for');\n\t\t\t\tconst target = document.getElementById(targetId);\n\t\t\t\tconst switcherWrapper = target.firstElementChild;\n\n\t\t\t\tif (target.offsetHeight === 0)\n\t\t\t\t{\n\t\t\t\t\ttarget.style.height = switcherWrapper.offsetHeight + 'px';\n\t\t\t\t\ttarget.classList.add('--open');\n\n\t\t\t\t\tconst scrollToTarget = () => {\n\t\t\t\t\t\tlet elementRealTop = target.getBoundingClientRect().top / 100;\n\t\t\t\t\t\tlet time = 400;\n\t\t\t\t\t\tlet currentTime = 0;\n\t\t\t\t\t\tlet scrollBySvs = () => {\n\t\t\t\t\t\t\twindow.scrollBy(0, elementRealTop);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (currentTime <= time)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twindow.setTimeout(scrollBySvs, currentTime, elementRealTop);\n\t\t\t\t\t\t\tcurrentTime += time / 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttarget.removeEventListener('transitionend', scrollToTarget);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst adjustHeight = () => {\n\t\t\t\t\t\ttarget.style.height = 'auto';\n\t\t\t\t\t\ttarget.removeEventListener('transitionend', adjustHeight);\n\t\t\t\t\t}\n\n\t\t\t\t\ttarget.addEventListener('transitionend', adjustHeight);\n\t\t\t\t\ttarget.addEventListener('transitionend', scrollToTarget);\n\t\t\t\t}\n\n\t\t\t\tif (target.offsetHeight > 0)\n\t\t\t\t{\n\t\t\t\t\ttarget.style.height = target.offsetHeight + 'px';\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\ttarget.style.removeProperty('height');\n\t\t\t\t\t\ttarget.classList.remove('--open');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic initDropdowns()\n\t{\n\n\t\tconst dropdownAreaList = document.querySelectorAll('[data-role=\"soc-net-dropdown\"]');\n\n\t\tdropdownAreaList.forEach((dropdownArea) => {\n\n\t\t\tdropdownArea.addEventListener('click', (e) => {\n\n\t\t\t\tconst dropdownArea = e.currentTarget;\n\t\t\t\tconst dropdownItemsData = this.getDropdownItems(dropdownArea);\n\t\t\t\tconst items = [];\n\n\t\t\t\tObject.entries(dropdownItemsData).forEach(([key, value]) => {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: value,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tdropdownMenu.close();\n\n\t\t\t\t\t\t\tthis.setDropdownValue(\n\t\t\t\t\t\t\t\tdropdownArea.querySelector('.ui-ctl-element'),\n\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\tdropdownArea\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.setInputValue(\n\t\t\t\t\t\t\t\tdropdownArea.querySelector('input'),\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tdropdownArea\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tlet neighbourDropdownArea = null;\n\t\t\t\t\t\t\tif (dropdownArea.classList.contains('--nonproject'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tneighbourDropdownArea = dropdownArea.parentNode.querySelector('.--project');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (dropdownArea.classList.contains('--project'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tneighbourDropdownArea = dropdownArea.parentNode.querySelector('.--nonproject');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (Type.isDomNode(neighbourDropdownArea))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.setDropdownValue(\n\t\t\t\t\t\t\t\t\tneighbourDropdownArea.querySelector('.ui-ctl-element'),\n\t\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\t\tneighbourDropdownArea\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.setInputValue(\n\t\t\t\t\t\t\t\t\tneighbourDropdownArea.querySelector('input'),\n\t\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\t\tneighbourDropdownArea\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconst dropdownMenu = new BX.PopupMenuWindow({\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tbindElement: dropdownArea,\n\t\t\t\t\twidth: dropdownArea.offsetWidth,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\titems: items,\n\t\t\t\t});\n\n\t\t\t\tdropdownMenu.params.width = dropdownArea.offsetWidth;\n\t\t\t\tdropdownMenu.show();\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic setDropdownValue(node, value, containerNode)\n\t{\n\t\tconst dropdownItemsData = this.getDropdownItems(containerNode);\n\t\tObject.entries(dropdownItemsData).forEach(([, itemValue]) => {\n\t\t\tif (value === itemValue)\n\t\t\t{\n\t\t\t\tnode.innerText = value;\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic setInputValue(node, value, containerNode)\n\t{\n\t\tconst dropdownItemsData = this.getDropdownItems(containerNode);\n\t\tObject.entries(dropdownItemsData).forEach(([itemKey]) => {\n\t\t\tif (value === itemKey)\n\t\t\t{\n\t\t\t\tnode.value = value;\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic getDropdownItems(node)\n\t{\n\t\tlet dropdownItemsData = {};\n\n\t\ttry\n\t\t{\n\t\t\tdropdownItemsData = JSON.parse(node.getAttribute('data-items'));\n\t\t}\n\t\tcatch(e)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tif (!Type.isPlainObject(dropdownItemsData))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\treturn dropdownItemsData;\n\t}\n\n\tstatic recalcFormPartProject(isChecked)\n\t{\n\t\tisChecked = !!isChecked;\n\n\t\tconst projectCheckboxNode = document.getElementById('GROUP_PROJECT');\n\t\tif (projectCheckboxNode)\n\t\t{\n\t\t\tthis.setCheckedValue(projectCheckboxNode, isChecked);\n\t\t}\n\n\t\tdocument.querySelectorAll('.socialnetwork-group-create-ex__create--switch-project, .socialnetwork-group-create-ex__create--switch-nonproject').forEach((node) => {\n\t\t\tif (isChecked)\n\t\t\t{\n\t\t\t\tnode.classList.add('--project');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnode.classList.remove('--project');\n\t\t\t}\n\t\t});\n\n\t\tthis.recalcNameInput();\n\t}\n\n\tstatic recalcNameInput()\n\t{\n\t\tconst inputNode = document.getElementById('GROUP_NAME_input');\n\t\tif (!inputNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet placeholderText = Loc.getMessage('SONET_GCE_T_NAME3');\n\n\t\tconst formInstance = WorkgroupForm.getInstance();\n\t\tif (Type.isPlainObject(formInstance.projectTypes[formInstance.selectedProjectType]))\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(formInstance.projectTypes[formInstance.selectedProjectType].SCRUM_PROJECT)\n\t\t\t\t&& formInstance.projectTypes[formInstance.selectedProjectType].SCRUM_PROJECT === 'Y'\n\t\t\t)\n\t\t\t{\n\t\t\t\tplaceholderText = Loc.getMessage('SONET_GCE_T_NAME3_SCRUM');\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tType.isStringFilled(formInstance.projectTypes[formInstance.selectedProjectType].PROJECT)\n\t\t\t\t&& formInstance.projectTypes[formInstance.selectedProjectType].PROJECT === 'Y'\n\t\t\t)\n\t\t\t{\n\t\t\t\tplaceholderText = Loc.getMessage('SONET_GCE_T_NAME3_PROJECT');\n\t\t\t}\n\t\t}\n\n\t\tinputNode.placeholder = placeholderText;\n\t}\n\n\tstatic setCheckedValue(node, value)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvalue = !!value;\n\n\t\tif (node.type === 'checkbox')\n\t\t{\n\t\t\tnode.checked = value;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.value = (value ? 'Y' : 'N');\n\t\t}\n\t}\n\n\tstatic getCheckedValue(node)\n\t{\n\t\tlet result = false;\n\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (node.type == 'hidden')\n\t\t{\n\t\t\tresult = (node.value === 'Y');\n\t\t}\n\t\telse if (node.type == 'checkbox')\n\t\t{\n\t\t\tresult = node.checked;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic unselectAllSelectorItems(container, selectorClass)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer.querySelectorAll(`.${selectorClass}`).forEach((selector) => {\n\t\t\tselector.classList.remove(this.cssClass.selectorActive);\n\t\t});\n\t}\n\n\tstatic selectSelectorItem(node)\n\t{\n\t\tnode.classList.add(this.cssClass.selectorActive);\n\t}\n\n\tstatic disableAllSelectorItems(container, selectorClass)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer.querySelectorAll(`.${selectorClass}`).forEach((selector) => {\n\t\t\tselector.classList.add(this.cssClass.selectorDisabled);\n\t\t});\n\t}\n\n\tstatic enableAllSelectorItems(container, selectorClass)\n\t{\n\t\tif (!Type.isDomNode(container))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer.querySelectorAll(`.${selectorClass}`).forEach((selector) => {\n\t\t\tselector.classList.remove(this.cssClass.selectorDisabled);\n\t\t});\n\t}\n\n\tstatic enableSelectorItem(node)\n\t{\n\t\tnode.classList.remove(this.cssClass.selectorDisabled);\n\t}\n\n\tstatic recalcInputValue(params): void\n\t{\n\t\tconst selectedItems = params.selectedItems || [];\n\t\tconst multiple = Type.isBoolean(params.multiple) ? params.multiple : true;\n\t\tconst inputContainerNodeId = params.inputContainerNodeId || '';\n\n\t\tlet inputNodeName = params.inputNodeName || '';\n\n\t\tif (\n\t\t\t!Type.isArray(selectedItems)\n\t\t\t|| !Type.isStringFilled(inputNodeName)\n\t\t\t|| !Type.isStringFilled(inputContainerNodeId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputContainerNode = document.getElementById(inputContainerNodeId);\n\t\tif (!inputContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (multiple)\n\t\t{\n\t\t\tinputNodeName = `${inputNodeName}[]`;\n\t\t}\n\n\t\tinputContainerNode.querySelectorAll(`input[name=\"${inputNodeName}\"]`).forEach((node) => {\n\t\t\tDom.remove(node);\n\t\t});\n\n\t\tselectedItems.forEach((item) => {\n\n\t\t\tlet prefix = null;\n\n\t\t\tswitch (item.entityId)\n\t\t\t{\n\t\t\t\tcase 'department':\n\t\t\t\t\tprefix = 'DR';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'user':\n\t\t\t\t\tprefix = 'U';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}\n\n\t\t\tif (prefix)\n\t\t\t{\n\t\t\t\tinputContainerNode.appendChild(Tag.render`<input type=\"hidden\" name=\"${inputNodeName}\" value=\"${prefix}${item.id}\" \\>`);\n\t\t\t}\n\t\t});\n\t};\n\n}\n","import {Type} from 'main.core';\nimport {Util} from './util';\n\nimport {WorkgroupForm} from './index';\n\nexport class ConfidentialitySelector\n{\n\tstatic cssClass = {\n\t\tcontainer: 'socialnetwork-group-create-ex__type-confidentiality-wrapper',\n\t\tselector: 'socialnetwork-group-create-ex__group-selector',\n\t};\n\n\tconstructor()\n\t{\n\t\tlet firstItemSelected = false;\n\n\t\tConfidentialitySelector.getItems().forEach((selector) => {\n\t\t\tselector.addEventListener('click', (e) => {\n\n\t\t\t\tconst selector = e.currentTarget;\n\t\t\t\tif (selector.classList.contains(Util.cssClass.selectorDisabled))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtil.unselectAllSelectorItems(ConfidentialitySelector.getContainer(), ConfidentialitySelector.cssClass.selector);\n\t\t\t\tUtil.selectSelectorItem(selector);\n\n\t\t\t\tWorkgroupForm.getInstance().recalcForm({\n\t\t\t\t\tselectedConfidentialityType: selector.getAttribute('data-bx-confidentiality-type'),\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst confidentialityType = selector.getAttribute('data-bx-confidentiality-type');\n\n\t\t\tif (Type.isStringFilled(WorkgroupForm.getInstance().selectedConfidentialityType))\n\t\t\t{\n\t\t\t\tif (WorkgroupForm.getInstance().selectedConfidentialityType === confidentialityType)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(selector);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!firstItemSelected)\n\t\t\t{\n\t\t\t\tthis.selectItem(selector);\n\t\t\t\tfirstItemSelected = true;\n\t\t\t}\n\t\t});\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents()\n\t{\n\t\tWorkgroupForm.getInstance().subscribe('onSwitchExtranet', ConfidentialitySelector.onSwitchExtranet);\n\t}\n\n\tstatic onSwitchExtranet(event)\n\t{\n\t\tconst data = event.getData();\n\t\tif (!Type.isBoolean(data.isChecked))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.isChecked)\n\t\t{\n\t\t\tConfidentialitySelector.unselectAll();\n\t\t\tConfidentialitySelector.select('secret')\n\t\t\tConfidentialitySelector.disableAll();\n\t\t\tConfidentialitySelector.enable('secret')\n\t\t}\n\t\telse\n\t\t{\n\t\t\tConfidentialitySelector.enableAll();\n\t\t}\n\t}\n\n\tselectItem(selector: Element)\n\t{\n\t\tUtil.selectSelectorItem(selector);\n\t\tWorkgroupForm.getInstance().recalcForm({\n\t\t\tselectedConfidentialityType: selector.getAttribute('data-bx-confidentiality-type'),\n\t\t});\n\t}\n\n\tstatic getContainer()\n\t{\n\t\treturn document.querySelector(`.${this.cssClass.container}`);\n\t}\n\n\tstatic getItems()\n\t{\n\t\tconst container = this.getContainer();\n\t\tif (!container)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn container.querySelectorAll(`.${this.cssClass.selector}`);\n\t}\n\n\tstatic unselectAll()\n\t{\n\t\tUtil.unselectAllSelectorItems(this.getContainer(), this.cssClass.selector);\n\t}\n\n\tstatic select(accessCode)\n\t{\n\t\tthis.getItems().forEach((selector) => {\n\t\t\tif (selector.getAttribute('data-bx-confidentiality-type') !== accessCode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUtil.selectSelectorItem(selector);\n\t\t});\n\t}\n\n\tstatic disableAll()\n\t{\n\t\tUtil.disableAllSelectorItems(this.getContainer(), this.cssClass.selector);\n\t}\n\n\tstatic enableAll()\n\t{\n\t\tUtil.enableAllSelectorItems(this.getContainer(), this.cssClass.selector);\n\t}\n\n\tstatic enable(accessCode)\n\t{\n\t\tthis.getItems().forEach((selector) => {\n\t\t\tif (selector.getAttribute('data-bx-confidentiality-type') !== accessCode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUtil.enableSelectorItem(selector);\n\t\t});\n\t}\n}\n","import {Dom, Type} from 'main.core';\n\nimport {ConfidentialitySelector} from './confidentialityselector';\nimport {WorkgroupForm} from './index';\nimport {Util} from './util';\n\nexport class Scrum\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tisScrumProject: boolean,\n\t\t}\n\t)\n\t{\n\t\tthis.isScrumProject = params.isScrumProject;\n\t}\n\n\tmakeAdditionalCustomizationForm()\n\t{\n\t\tif (this.isScrumProject)\n\t\t{\n\t\t\tthis.createHiddenInputs();\n\t\t\tthis.showScrumBlocks();\n\t\t\tif (!Type.isStringFilled(WorkgroupForm.getInstance().selectedConfidentialityType))\n\t\t\t{\n\t\t\t\tConfidentialitySelector.unselectAll();\n\t\t\t\tConfidentialitySelector.select('open');\n\t\t\t\tWorkgroupForm.getInstance().recalcForm({\n\t\t\t\t\tselectedConfidentialityType: 'open',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst landingCheckbox = document.getElementById('GROUP_LANDING');\n\t\t\tif (landingCheckbox)\n\t\t\t{\n\t\t\t\tlandingCheckbox.disabled = true;\n\t\t\t\tlandingCheckbox.checked = false;\n\t\t\t}\n\n\t\t\tthis.toggleFeatures(true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.removeHiddenInputs();\n\t\t\tthis.hideScrumBlocks();\n\n\t\t\tconst landingCheckbox = document.getElementById('GROUP_LANDING');\n\t\t\tif (landingCheckbox)\n\t\t\t{\n\t\t\t\tlandingCheckbox.disabled = false;\n\t\t\t}\n\n\t\t\tthis.toggleFeatures(false);\n\t\t}\n\n\t\tUtil.recalcNameInput();\n\t}\n\n\thideScrumBlocks()\n\t{\n\t\tdocument.querySelectorAll('.socialnetwork-group-create-ex__create--switch-scrum, .socialnetwork-group-create-ex__create--switch-nonscrum').forEach((scrumBlock) => {\n\t\t\tscrumBlock.classList.remove('--scrum');\n\t\t});\n\n\t\tconst moderatorsBlock = document.getElementById('expandable-moderator-block');\n\t\tif (moderatorsBlock)\n\t\t{\n\t\t\tmoderatorsBlock.classList.add('socialnetwork-group-create-ex__content-expandable');\n\t\t}\n\n\t\tconst moderatorsSwitch = document.getElementById('GROUP_MODERATORS_PROJECT_switch');\n\t\tif (moderatorsSwitch)\n\t\t{\n\t\t\tmoderatorsSwitch.classList.add('ui-ctl-file-link');\n\t\t}\n\n\t\tconst ownerBlock = document.getElementById('GROUP_OWNER_block');\n\t\tif (ownerBlock)\n\t\t{\n\t\t\townerBlock.classList.remove('--space-bottom');\n\t\t}\n \t}\n\n\tshowScrumBlocks()\n\t{\n\t\tdocument.querySelectorAll('.socialnetwork-group-create-ex__create--switch-scrum, .socialnetwork-group-create-ex__create--switch-nonscrum').forEach((scrumBlock) => {\n\t\t\tscrumBlock.classList.add('--scrum');\n\t\t});\n\n\t\tconst moderatorsBlock = document.getElementById('expandable-moderator-block');\n\t\tif (moderatorsBlock)\n\t\t{\n\t\t\tmoderatorsBlock.classList.remove('socialnetwork-group-create-ex__content-expandable');\n\t\t}\n\n\t\tconst moderatorsSwitch = document.getElementById('GROUP_MODERATORS_PROJECT_switch');\n\t\tif (moderatorsSwitch)\n\t\t{\n\t\t\tmoderatorsSwitch.classList.remove('ui-ctl-file-link');\n\t\t}\n\n\t\tconst ownerBlock = document.getElementById('GROUP_OWNER_block');\n\t\tif (ownerBlock)\n\t\t{\n\t\t\townerBlock.classList.add('--space-bottom');\n\t\t}\n\t}\n\n\tcreateHiddenInputs()\n\t{\n\t\tdocument.forms['sonet_group_create_popup_form'].appendChild(\n\t\t\tDom.create('input', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tname: 'SCRUM_PROJECT',\n\t\t\t\t\tvalue: 'Y',\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tremoveHiddenInputs()\n\t{\n\t\tdocument.forms['sonet_group_create_popup_form'].querySelectorAll('input[name=\"SCRUM_PROJECT\"]')\n\t\t\t.forEach((input) => {\n\t\t\t\tDom.remove(input);\n\t\t\t})\n\t\t;\n\t}\n\n\ttoggleFeatures(isScrum: boolean)\n\t{\n\t\tconst featuresNode = document.querySelector('.socialnetwork-group-create-ex__project-instruments');\n\t\tif (featuresNode)\n\t\t{\n\t\t\tfeaturesNode.querySelectorAll('input[type=\"checkbox\"][name=\"tasks_active\"], input[type=\"checkbox\"][name=\"calendar_active\"]').forEach((featuresCheckboxNode) => {\n\t\t\t\tif (isScrum)\n\t\t\t\t{\n\t\t\t\t\tfeaturesCheckboxNode.disabled = true;\n\t\t\t\t\tfeaturesCheckboxNode.checked = true;\n\n\t\t\t\t\tfeaturesCheckboxNode.parentNode.insertBefore(Dom.create('input', {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\t\t\tname: featuresCheckboxNode.name,\n\t\t\t\t\t\t\tvalue: 'Y',\n\t\t\t\t\t\t}\n\t\t\t\t\t}), featuresCheckboxNode);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfeaturesCheckboxNode.disabled = false;\n\n\t\t\t\t\tdocument.forms['sonet_group_create_popup_form'].querySelectorAll(`input[type=\"hidden\"][name=\"${featuresCheckboxNode.name}\"]`)\n\t\t\t\t\t\t.forEach((hiddenInput) => {\n\t\t\t\t\t\t\tDom.remove(hiddenInput);\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n","import { Type, Loc, Dom, ajax } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Button } from 'ui.buttons';\n\nexport class Avatar\n{\n\tstatic classList = {\n\t\thidden: '--hidden',\n\t\tselected: '--selected',\n\t};\n\n\tconstructor(\n\t\tparams: {\n\t\t\tcomponentName: string,\n\t\t\tsignedParameters: string,\n\t\t\tgroupId: number,\n\t\t}\n\t)\n\t{\n\t\tthis.confirmPopup = null;\n\n\t\tif (\n\t\t\t!Type.isStringFilled(params.componentName)\n\t\t\t|| Type.isUndefined(params.signedParameters)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.componentName = params.componentName;\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.groupId = (!Type.isUndefined(params.groupId) ? parseInt(params.groupId) : 0);\n\n\t\tconst container = document.querySelector('[data-role=\"group-avatar-cont\"]');\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectorNode = container.querySelector('[data-role=\"group-avatar-selector\"]');\n\t\tthis.imageNode = container.querySelector('[data-role=\"group-avatar-image\"]');\n\t\tthis.inputNode = container.querySelector('[data-role=\"group-avatar-input\"]');\n\t\tthis.typeInputNode = container.querySelector('[data-role=\"group-avatar-type-input\"]');\n\t\tthis.removeNode = container.querySelector('[data-role=\"group-avatar-remove\"]');\n\n\t\tif (\n\t\t\t!Type.isDomNode(this.imageNode)\n\t\t\t|| !Type.isDomNode(this.inputNode)\n\t\t\t|| !Type.isDomNode(this.typeInputNode)\n\t\t\t|| !Type.isDomNode(this.removeNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.recalc();\n\n\t\tconst avatarEditor = new BX.AvatarEditor({\n\t\t\tenableCamera: false,\n\t\t});\n\n\t\tthis.selectorNode.addEventListener('click', (e) => {\n\n\t\t\tif (\n\t\t\t\te.target.getAttribute('data-role') === 'group-avatar-remove'\n\t\t\t\t&& this.imageNode.style.backgroundImage !== ''\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.showConfirmPopup(Loc.getMessage('SONET_GCE_T_IMAGE_DELETE_CONFIRM'), this.deletePhoto.bind(this));\n\t\t\t}\n\t\t\telse if (e.target.getAttribute('data-role') === 'group-avatar-type')\n\t\t\t{\n\t\t\t\tthis.clearType();\n\t\t\t\tthis.setType(e.target.getAttribute('data-avatar-type'));\n\t\t\t}\n\t\t\telse if (e.target.getAttribute('data-role') === 'group-avatar-image')\n\t\t\t{\n\t\t\t\tavatarEditor.show('file');\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onApply', (event: BaseEvent) => {\n\t\t\tconst [ file ] = event.getCompatData();\n\n\t\t\tconst formData = new FormData();\n\t\t\tif (!file.name)\n\t\t\t{\n\t\t\t\tfile.name = 'tmp.png';\n\t\t\t}\n\t\t\tformData.append('newPhoto', file, file.name);\n\n\t\t\tthis.changePhoto(formData);\n\t\t});\n\t}\n\n\trecalc()\n\t{\n\t\tif (this.getFileId() <= 0)\n\t\t{\n\t\t\tthis.removeNode.classList.add(Avatar.classList.hidden);\n\t\t\tthis.imageNode.classList.remove(Avatar.classList.selected);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.removeNode.classList.remove(Avatar.classList.hidden);\n\t\t\tthis.imageNode.classList.add(Avatar.classList.selected);\n\t\t}\n\t}\n\n\tchangePhoto(formData)\n\t{\n\t\tconst loader = this.showLoader({\n\t\t\tnode: this.imageNode,\n\t\t\tloader: null,\n\t\t\tsize: 78,\n\t\t});\n\n\t\tajax.runComponentAction(this.componentName, 'loadPhoto', {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'ajax',\n\t\t\tdata: formData,\n\t\t}).then((response) => {\n\n\t\t\tif (\n\t\t\t\tType.isPlainObject(response.data)\n\t\t\t\t&& parseInt(response.data.fileId) > 0\n\t\t\t\t&& Type.isStringFilled(response.data.fileUri)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.clearType();\n\t\t\t\tthis.inputNode.value = parseInt(response.data.fileId);\n\t\t\t\tthis.typeInputNode.value = '';\n\t\t\t\tthis.imageNode.style = `background-image: url('${encodeURI(response.data.fileUri)}'); background-size: cover;`;\n\t\t\t\tthis.recalc();\n\t\t\t}\n\n\t\t\tthis.hideLoader({\n\t\t\t\tloader: loader,\n\t\t\t});\n\t\t}, (response) => {\n\t\t\tthis.hideLoader({loader: loader});\n\t\t\tthis.showErrorPopup(response[\"errors\"][0].message);\n\t\t});\n\t}\n\n\tdeletePhoto()\n\t{\n\t\tconst fileId = this.getFileId();\n\t\tif (fileId < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst loader = this.showLoader({\n\t\t\tnode: this.imageNode,\n\t\t\tloader: null,\n\t\t\tsize: 78,\n\t\t});\n\n\t\tajax.runComponentAction(this.componentName, 'deletePhoto', {\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tmode: 'ajax',\n\t\t\tdata: {\n\t\t\t\tfileId: fileId,\n\t\t\t\tgroupId: this.groupId,\n\t\t\t}\n\t\t}).then((response) => {\n\n\t\t\tthis.imageNode.style = '';\n\t\t\tthis.inputNode.value = '';\n\t\t\tthis.recalc();\n\n\t\t\tthis.hideLoader({\n\t\t\t\tloader: loader,\n\t\t\t});\n\t\t}, (response) => {\n\t\t\tthis.hideLoader({\n\t\t\t\tloader: loader,\n\t\t\t});\n\t\t\tthis.showErrorPopup(response.errors[0].message);\n\t\t});\n\t}\n\n\tclearType()\n\t{\n\t\tthis.selectorNode.querySelectorAll('[data-role=\"group-avatar-type\"]').forEach((typeItemNode) => {\n\t\t\ttypeItemNode.classList.remove(Avatar.classList.selected);\n\t\t});\n\t}\n\n\tsetType(avatarType)\n\t{\n\t\tthis.inputNode.value = '';\n\t\tthis.imageNode.style = '';\n\t\tthis.typeInputNode.value = avatarType;\n\n\t\tthis.imageNode.classList.remove(Avatar.classList.selected);\n\n\t\tthis.selectorNode.querySelectorAll('[data-role=\"group-avatar-type\"]').forEach((typeItemNode) => {\n\t\t\tif (typeItemNode.getAttribute('data-avatar-type') !== avatarType)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttypeItemNode.classList.add(Avatar.classList.selected);\n\t\t});\n\n\n\t\tthis.recalc();\n\t}\n\n\tgetFileId()\n\t{\n\t\treturn (Type.isStringFilled(this.inputNode.value) ? parseInt(this.inputNode.value) : 0);\n\t}\n\n\tshowLoader(params)\n\t{\n\t\tlet loader = null;\n\n\t\tif (Type.isDomNode(params.node))\n\t\t{\n\t\t\tif (Type.isNull(params.loader))\n\t\t\t{\n\t\t\t\tloader = new BX.Loader({\n\t\t\t\t\ttarget: params.node,\n\t\t\t\t\tsize: params.hasOwnProperty('size') ? params.size : 40,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tloader = params.loader;\n\t\t\t}\n\n\t\t\tloader.show();\n\t\t}\n\n\t\treturn loader;\n\t}\n\n\thideLoader(params)\n\t{\n\t\tif (!Type.isNull(params.loader))\n\t\t{\n\t\t\tparams.loader.hide();\n\t\t\tparams.loader = null;\n\t\t}\n\n\t\tif (Type.isDomNode(params.node))\n\t\t{\n\t\t\tDom.clean(params.node)\n\t\t}\n\t}\n\n\tshowErrorPopup(error)\n\t{\n\t\tif (!error)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnew Popup('gce-image-upload-error', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: error,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t}).show();\n\t}\n\n\tshowConfirmPopup(text, confirmCallback)\n\t{\n\t\tthis.confirmPopup = new Popup('gce-image-delete-confirm', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: text,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.confirmPopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_GCE_T_IMAGE_DELETE_CONFIRM_YES'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (button) => {\n\t\t\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\t\t\tthis.confirmPopup.close();\n\t\t\t\t\t\t\tconfirmCallback();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_GCE_T_IMAGE_DELETE_CONFIRM_NO'),\n\t\t\t\t\tevents : {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.confirmPopup.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t\tthis.confirmPopup.show();\n\t}\n}\n","import {Event} from 'main.core';\n\ntype Params = {\n\tculture: CultureData\n}\n\ntype CultureData = {\n\tshortDateFormat: string\n}\n\nexport class DateCorrector\n{\n\t#dateStartInput;\n\t#dateEndInput;\n\t#culture: CultureData;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#dateStartInput = this.#getDateInput('PROJECT_DATE_START');\n\t\tthis.#dateEndInput = this.#getDateInput('PROJECT_DATE_FINISH');\n\n\t\tthis.#culture = params.culture;\n\n\t\tthis.#bindHandlers();\n\t}\n\n\t#getDateInput(name: string): ?HTMLElement\n\t{\n\t\tif (document.getElementsByName(name)[0])\n\t\t{\n\t\t\treturn document.getElementsByName(name)[0];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#bindHandlers()\n\t{\n\t\tif (this.#dateStartInput)\n\t\t{\n\t\t\tEvent.bind(this.#dateStartInput, 'change', this.#adjustDates.bind(this, true));\n\t\t}\n\n\t\tif (this.#dateEndInput)\n\t\t{\n\t\t\tEvent.bind(this.#dateEndInput, 'change', this.#adjustDates.bind(this, false));\n\t\t}\n\t}\n\n\t#adjustDates(startChanged: boolean)\n\t{\n\t\tconst start = this.#getTimeStamp(this.#dateStartInput.value);\n\t\tconst end = this.#getTimeStamp(this.#dateEndInput.value);\n\n\t\tconst startDate = start ? new Date(start * 1000) : null;\n\t\tconst endDate = end ? new Date(end * 1000) : null;\n\n\t\tif (startDate && endDate)\n\t\t{\n\t\t\tif (startDate >= endDate)\n\t\t\t{\n\t\t\t\tconst defaultOffset = 86400 * 1000;\n\n\t\t\t\tif (startChanged)\n\t\t\t\t{\n\t\t\t\t\tconst newEndDate = new Date(startDate.getTime() + defaultOffset);\n\n\t\t\t\t\tthis.#dateEndInput.value = this.#getFormatDate(newEndDate.getTime() / 1000);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst newStartDate = new Date(endDate.getTime() - defaultOffset);\n\n\t\t\t\t\tthis.#dateStartInput.value = this.#getFormatDate(newStartDate.getTime() / 1000);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#getTimeStamp(date: string): ?number\n\t{\n\t\tif (date.toString().length > 0)\n\t\t{\n\t\t\t// eslint-disable-next-line bitrix-rules/no-bx\n\t\t\tconst parsedValue = BX.parseDate(date, true);\n\t\t\tif (parsedValue === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.#convertToSeconds(parsedValue.getTime());\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#convertToSeconds(value: number): number\n\t{\n\t\treturn Math.floor((parseInt(value) / 1000));\n\t}\n\n\t#getFormatDate(timeStamp: number): string\n\t{\n\t\tconst date = new Date(timeStamp * 1000);\n\n\t\treturn BX.date.format(this.#culture.shortDateFormat, date)\n\t}\n}","import { Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport class ThemePicker\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tcontainer: Element,\n\t\t\ttheme: object,\n\t\t}\n\t)\n\t{\n\t\tthis.container = params.container;\n\t\tthis.theme = params.theme;\n\t\tthis.draw(this.theme);\n\n\t\tconst previewImageNode = this.getNode('image');\n\t\tif (previewImageNode)\n\t\t{\n\t\t\tpreviewImageNode.addEventListener('click', this.open);\n\t\t}\n\n\t\tconst titleNode = this.getNode('title');\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.addEventListener('click', this.open);\n\t\t}\n\n\t\tconst deleteNode = this.getNode('delete');\n\t\tif (deleteNode)\n\t\t{\n\t\t\tdeleteNode.addEventListener('click', () => {\n\t\t\t\tthis.select({});\n\t\t\t});\n\t\t}\n\n\t\tEventEmitter.subscribe('Intranet.ThemePicker:onSave', (event: BaseEvent) => {\n\t\t\tconst [ data ] = event.getData();\n\t\t\tthis.select(data);\n\t\t});\n\t}\n\n\tselect(data)\n\t{\n\t\tconst theme = (Type.isPlainObject(data.theme) ? data.theme : {});\n\t\tthis.draw(theme);\n\t}\n\n\tdraw(theme)\n\t{\n\t\tconst previewImageNode = this.getNode('image');\n\t\tif (previewImageNode)\n\t\t{\n\t\t\tpreviewImageNode.style.backgroundImage = (Type.isStringFilled(theme.previewImage) ? `url('${theme.previewImage}')` : '');\n\t\t\tpreviewImageNode.style.backgroundColor = (Type.isStringFilled(theme.previewColor) ? theme.previewColor : 'transparent');\n\t\t}\n\n\t\tconst titleNode = this.getNode('title');\n\t\tif (titleNode)\n\t\t{\n\t\t\ttitleNode.innerHTML = (Type.isStringFilled(theme.title) ? theme.title : '');\n\t\t}\n\n\t\tconst inputNode = this.getNode('id');\n\t\tif (inputNode)\n\t\t{\n\t\t\tinputNode.value = (Type.isStringFilled(theme.id) ? theme.id : '');\n\t\t}\n\t}\n\n\topen(event)\n\t{\n\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(true);\n\n\t\tevent.preventDefault();\n\t}\n\n\tgetNode(name)\n\t{\n\t\tconst result = null;\n\t\tif (!Type.isStringFilled(name))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\treturn this.container.querySelector(`[bx-group-edit-theme-node=\"${name}\"]`);\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n}\n","import { Type, Loc } from 'main.core';\nimport { TagSelector as EntityTagSelector } from 'ui.entity-selector';\nimport { BaseEvent } from 'main.core.events';\n\nexport class Tags\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tgroupId: number,\n\t\t\tcontainerNodeId: string,\n\t\t\thiddenFieldId: string,\n\t\t}\n\t)\n\t{\n\t\tconst containerNode = document.getElementById(params.containerNodeId);\n\t\tif (!containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hiddenFieldNode = document.getElementById(params.hiddenFieldId);\n\n\t\tconst tagSelector = new EntityTagSelector({\n\t\t\taddButtonCaption: Loc.getMessage('SONET_GCE_T_TAG_ADD'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('SONET_GCE_T_KEYWORDS_ADD_TAG'),\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 350,\n\t\t\t\theight: 300,\n\t\t\t\toffsetLeft: 50,\n\t\t\t\tcompactView: true,\n\t\t\t\tpreload: true,\n\t\t\t\tcontext: 'PROJECT_TAG',\n\t\t\t\tsearchTabOptions: {\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: Loc.getMessage('SONET_GCE_T_TAG_SEARCH_FAILED'),\n\t\t\t\t\t\tsubtitle: Loc.getMessage('SONET_GCE_T_TAG_SEARCH_ADD_HINT'),\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'project-tag',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tgroupId: params.groupId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: true,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: Loc.getMessage('SONET_GCE_T_TAG_SEARCH_ADD_FOOTER_LABEL'),\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tthis.recalcinputValue(event.getTarget().getSelectedItems());\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (event) => {\n\t\t\t\t\t\tthis.recalcinputValue(event.getTarget().getSelectedItems());\n\t\t\t\t\t},\n\t\t\t\t\t'Search:onItemCreateAsync': (event: BaseEvent) => {\n\n\t\t\t\t\t\treturn new Promise((resolve) => {\n\n\t\t\t\t\t\t\tconst { searchQuery } = event.getData();\n\t\t\t\t\t\t\tconst name = searchQuery.getQuery().toLowerCase();\n\t\t\t\t\t\t\tconst dialog = event.getTarget();\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst tagsList = name.split(',');\n\n\t\t\t\t\t\t\t\ttagsList.forEach((tag) => {\n\t\t\t\t\t\t\t\t\tconst item = dialog.addItem({\n\t\t\t\t\t\t\t\t\t\tid: tag,\n\t\t\t\t\t\t\t\t\t\tentityId: 'project-tag',\n\t\t\t\t\t\t\t\t\t\ttitle: tag,\n\t\t\t\t\t\t\t\t\t\ttabs: [ 'all', 'recents' ],\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (item)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\titem.select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\ttagSelector.renderTo(containerNode);\n\t}\n\n\trecalcinputValue(items)\n\t{\n\t\tif (\n\t\t\t!Type.isArray(items)\n\t\t\t|| !Type.isDomNode(this.hiddenFieldNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tagsList = [];\n\n\n\t\titems.forEach((item) => {\n\t\t\ttagsList.push(item.id);\n\t\t});\n\n\t\tthis.hiddenFieldNode.value = tagsList.join(',');\n\t}\n}\n","import {Type} from 'main.core';\nimport {Util} from './util';\n\nimport {WorkgroupForm} from './index';\n\nexport class TypePresetSelector\n{\n\tconstructor()\n\t{\n\t\tthis.cssClass = {\n\t\t\tcontainer: 'socialnetwork-group-create-ex__type-preset-wrapper',\n\t\t\tselector: 'socialnetwork-group-create-ex__type-preset-selector',\n\t\t};\n\n\t\tthis.container = document.querySelector(`.${this.cssClass.container}`);\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet firstItemSelected = false;\n\n\t\tconst selectors = this.container.querySelectorAll(`.${this.cssClass.selector}`);\n\t\tselectors.forEach((selector) => {\n\t\t\tselector.addEventListener('click', (e) => {\n\n\t\t\t\tconst selector = e.currentTarget;\n\t\t\t\tif (selector.classList.contains(Util.cssClass.selectorDisabled))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtil.unselectAllSelectorItems(this.container, this.cssClass.selector);\n\t\t\t\tUtil.selectSelectorItem(selector);\n\n\t\t\t\tconst projectType = selector.getAttribute('data-bx-project-type');\n\n\t\t\t\tWorkgroupForm.getInstance().recalcForm({\n\t\t\t\t\tselectedProjectType: projectType,\n\t\t\t\t});\n\n\t\t\t\tWorkgroupForm.getInstance().wizardManager.setProjectType(projectType);\n\t\t\t});\n\n\t\t\tconst projectType = selector.getAttribute('data-bx-project-type');\n\n\t\t\tif (Type.isStringFilled(WorkgroupForm.getInstance().selectedProjectType))\n\t\t\t{\n\t\t\t\tif (WorkgroupForm.getInstance().selectedProjectType === projectType)\n\t\t\t\t{\n\t\t\t\t\tthis.selectItem(selector);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!firstItemSelected)\n\t\t\t{\n\t\t\t\tthis.selectItem(selector);\n\t\t\t\tfirstItemSelected = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tselectItem(selector: Element)\n\t{\n\t\tconst projectType = selector.getAttribute('data-bx-project-type');\n\t\tUtil.selectSelectorItem(selector);\n\t\tWorkgroupForm.getInstance().recalcForm({\n\t\t\tselectedProjectType: projectType,\n\t\t});\n\t\tWorkgroupForm.getInstance().wizardManager.setProjectType(projectType);\n\t}\n\n\n}\n","import { Type, Loc } from 'main.core';\nimport { WorkgroupForm } from './index';\n\nexport class FieldsManager\n{\n\tstatic mandatoryFieldsByStep = {\n\t\t2: [\n\t\t\t{\n\t\t\t\tid: 'GROUP_NAME_input',\n\t\t\t\ttype: 'string',\n\t\t\t\tbindNodeId: 'GROUP_NAME_input',\n\t\t\t},\n\t\t],\n\t\t4: [\n\t\t\t{\n\t\t\t\tid: 'SCRUM_MASTER_CODE_container',\n\t\t\t\ttype: 'input_hidden_container',\n\t\t\t\tbindNodeId: 'SCRUM_MASTER_selector',\n\t\t\t\tcondition: () => {\n\t\t\t\t\treturn !!WorkgroupForm.getInstance().scrumManager.isScrumProject;\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t};\n\n\tstatic check()\n\t{\n\t\tif (WorkgroupForm.getInstance().wizardManager.stepsCount === 1)\n\t\t{\n\t\t\treturn this.checkAll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.checkStep(WorkgroupForm.getInstance().wizardManager.currentStep);\n\t\t}\n\t}\n\n\tstatic checkStep(step)\n\t{\n\t\tstep = parseInt(step);\n\n\t\tconst errorDataList = [];\n\n\t\tif (Type.isArray(this.mandatoryFieldsByStep[step]))\n\t\t{\n\t\t\tthis.mandatoryFieldsByStep[step].forEach((fieldData) => {\n\n\t\t\t\tlet fieldNode = document.getElementById(fieldData.id);\n\t\t\t\tif (!Type.isDomNode(fieldNode))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (fieldNode.tagName.toLowerCase() !== 'input')\n\t\t\t\t{\n\t\t\t\t\tif (fieldData.type === 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldNode = fieldNode.querySelector('input[type=\"text\"]');\n\t\t\t\t\t\tif (!Type.isDomNode(fieldNode))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfieldData.fieldNode = fieldNode;\n\t\t\t\tconst errorText = this.checkField(fieldData);\n\t\t\t\tif (Type.isStringFilled(errorText))\n\t\t\t\t{\n\t\t\t\t\tconst bindNode = document.getElementById(fieldData.bindNodeId)\n\t\t\t\t\terrorDataList.push({\n\t\t\t\t\t\tbindNode: (Type.isDomNode(bindNode) ? bindNode : fieldNode),\n\t\t\t\t\t\tmessage: errorText,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn errorDataList;\n\t}\n\n\tstatic checkAll()\n\t{\n\t\tlet errorDataList = [];\n\t\tObject.entries(this.mandatoryFieldsByStep).forEach((stepData) => {\n\t\t\terrorDataList = errorDataList.concat(this.checkStep(parseInt(stepData[0])));\n\t\t});\n\n\t\treturn errorDataList;\n\t}\n\n\tstatic checkField(fieldData)\n\t{\n\t\tlet errorText = '';\n\n\t\tif (\n\t\t\t!Type.isPlainObject(fieldData)\n\t\t\t&& !Type.isDomNode(fieldData.fieldNode)\n\t\t)\n\t\t{\n\t\t\treturn errorText;\n\t\t}\n\n\t\tif (Type.isFunction(fieldData.condition))\n\t\t{\n\t\t\tif (!fieldData.condition())\n\t\t\t{\n\t\t\t\treturn errorText;\n\t\t\t}\n\t\t}\n\n\t\tconst fieldNode = fieldData.fieldNode;\n\t\tconst fieldType = (Type.isStringFilled(fieldData.type) ? fieldData.type : 'string');\n\t\tswitch (fieldType)\n\t\t{\n\t\t\tcase 'string':\n\t\t\t\terrorText = (fieldNode.value.trim() === '' ? Loc.getMessage('SONET_GCE_T_STRING_FIELD_ERROR') : '');\n\t\t\t\tbreak\n\t\t\tcase 'input_hidden_container':\n\t\t\t\tlet empty = true;\n\t\t\t\tfieldNode.querySelectorAll('input[type=\"hidden\"]').forEach((hiddenNode) => {\n\t\t\t\t\tif (!empty)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Type.isStringFilled(hiddenNode.value))\n\t\t\t\t\t{\n\t\t\t\t\t\tempty = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\terrorText = (empty ? Loc.getMessage('SONET_GCE_T_STRING_FIELD_ERROR') : '');\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\terrorText = '';\n\t\t}\n\n\t\treturn errorText;\n\t}\n\n\tstatic showError(errorData)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(errorData)\n\t\t\t|| !Type.isStringFilled(errorData.message)\n\t\t\t|| !Type.isDomNode(errorData.bindNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tWorkgroupForm.getInstance().alertManager.showAlert(errorData.message, errorData.bindNode.parentNode);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ButtonManager } from 'ui.buttons';\n\nimport { WorkgroupForm } from './index';\nimport { FieldsManager } from './fields';\n\nexport class Buttons\n{\n\tstatic cssClass = {\n\t\thidden: 'socialnetwork-group-create-ex__button-invisible',\n\t};\n\n\tconstructor()\n\t{\n\t\tthis.submitButton = document.getElementById('sonet_group_create_popup_form_button_submit');\n\t\tif (!this.submitButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.submitButtonClickHandler = this.submitButtonClickHandler.bind(this);\n\t\tthis.submitButton.addEventListener('click', this.submitButtonClickHandler);\n\n\t\tthis.backButton = document.getElementById('sonet_group_create_popup_form_button_step_2_back');\n\t\tif (this.backButton)\n\t\t{\n\t\t\tthis.backButton.addEventListener('click', (e) => {\n\n\t\t\t\tconst button = ButtonManager.createFromNode(e.currentTarget);\n\t\t\t\tif (\n\t\t\t\t\tbutton\n\t\t\t\t\t&& button.isDisabled()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (WorkgroupForm.getInstance().wizardManager.currentStep > 1)\n\t\t\t\t{\n\t\t\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep--;\n\t\t\t\t\tif (\n\t\t\t\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep === 3\n\t\t\t\t\t\t&& Object.entries(WorkgroupForm.getInstance().confidentialityTypes) <= 1\n\t\t\t\t\t) // skip confidentiality step\n\t\t\t\t\t{\n\t\t\t\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep--;\n\t\t\t\t\t}\n\n\t\t\t\t\tWorkgroupForm.getInstance().wizardManager.showCurrentStep();\n\t\t\t\t}\n\n\t\t\t\treturn e.preventDefault();\n\t\t\t});\n\t\t}\n\n\t\tthis.cancelButton = document.getElementById('sonet_group_create_popup_form_button_step_2_cancel');\n\n\t\tif (this.cancelButton)\n\t\t{\n\t\t\tthis.cancelButton.addEventListener('click', (e) => {\n\n\t\t\t\tconst button = ButtonManager.createFromNode(e.currentTarget);\n\t\t\t\tif (\n\t\t\t\t\tbutton\n\t\t\t\t\t&& button.isDisabled()\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentSlider = BX.SidePanel.Instance.getSliderByWindow(window);\n\n\t\t\t\tif (currentSlider)\n\t\t\t\t{\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [ currentSlider.getEvent('onClose') ],\n\t\t\t\t\t\tdata: currentSlider.getEvent('onClose'),\n\t\t\t\t\t});\n\n\t\t\t\t\tEventEmitter.emit(window.top, 'SidePanel.Slider:onClose', event);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst url = e.currentTarget.getAttribute('bx-url');\n\t\t\t\t\tif (Type.isStringFilled(url))\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.location = url;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\tcompatData: [ false ],\n\t\t\t\t\tdata: false,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit(window.top, 'BX.Bitrix24.PageSlider:close', event);\n\n\t\t\t\tEventEmitter.emit(window.top, 'onSonetIframeCancelClick');\n\n\t\t\t\treturn e.preventDefault();\n\t\t\t})\n\t\t}\n\t}\n\n\tsubmitButtonClickHandler(e)\n\t{\n\t\tconst button = ButtonManager.createFromNode(e.currentTarget);\n\t\tif (\n\t\t\tbutton\n\t\t\t&& button.isDisabled()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tWorkgroupForm.getInstance().alertManager.hideAllAlerts();\n\n\t\tconst errorDataList = FieldsManager.check().filter((errorData) => {\n\t\t\treturn (\n\t\t\t\tType.isPlainObject(errorData)\n\t\t\t\t&& Type.isStringFilled(errorData.message)\n\t\t\t\t&& Type.isDomNode(errorData.bindNode)\n\t\t\t);\n\t\t});\n\n\t\tif (errorDataList.length > 0)\n\t\t{\n\t\t\terrorDataList.forEach((errorData) => {\n\t\t\t\tFieldsManager.showError(errorData);\n\t\t\t});\n\t\t}\n\t\telse if (WorkgroupForm.getInstance().wizardManager.currentStep < WorkgroupForm.getInstance().wizardManager.stepsCount)\n\t\t{\n\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep++;\n\t\t\tif (\n\t\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep === 3\n\t\t\t\t&& Object.entries(WorkgroupForm.getInstance().confidentialityTypes) <= 1\n\t\t\t) // skip confidentiality step\n\t\t\t{\n\t\t\t\tWorkgroupForm.getInstance().wizardManager.currentStep++;\n\t\t\t}\n\n\t\t\tWorkgroupForm.getInstance().wizardManager.showCurrentStep();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst submitFunction = function(event) {\n\t\t\t\tWorkgroupForm.getInstance().submitForm(event)\n\t\t\t}.bind(WorkgroupForm.getInstance());\n\n\t\t\tsubmitFunction(e);\n\t\t}\n\n\t\treturn e.preventDefault();\n\t}\n\n\tstatic showWaitSubmitButton(disable)\n\t{\n\t\tdisable = !!disable;\n\n\t\tconst buttonNode = document.getElementById('sonet_group_create_popup_form_button_submit');\n\t\tif (!buttonNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst button = ButtonManager.createFromNode(buttonNode);\n\n\t\tif (disable)\n\t\t{\n\t\t\tif (button)\n\t\t\t{\n\t\t\t\tbutton.setWaiting(true);\n\t\t\t}\n\t\t\tbuttonNode.removeEventListener('click', WorkgroupForm.getInstance().submitButtonClickHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (button)\n\t\t\t{\n\t\t\t\tbutton.setWaiting(false);\n\t\t\t}\n\t\t\tbuttonNode.addEventListener('click', WorkgroupForm.getInstance().submitButtonClickHandler);\n\t\t}\n\t}\n\n\tstatic disableButton(buttonNode, disable)\n\t{\n\t\tif (!Type.isDomNode(buttonNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst button = ButtonManager.createFromNode(buttonNode);\n\t\tif (!button)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbutton.setDisabled(disable);\n\t}\n\n\tstatic showButton(buttonNode)\n\t{\n\t\tif (!Type.isDomNode(buttonNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbuttonNode.classList.remove(this.cssClass.hidden);\n\t}\n\n\tstatic hideButton(buttonNode)\n\t{\n\t\tif (!Type.isDomNode(buttonNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tbuttonNode.classList.add(this.cssClass.hidden);\n\t}\n}\n","import { Type } from 'main.core';\nimport { WorkgroupForm } from './index';\nimport { Buttons } from './buttons';\n\nexport class Wizard\n{\n\tstatic cssClass = {\n\t\tstep1Backgroud: 'socialnetwork-group-create-ex__background-gif',\n\t\tbreadcrumbsContainer: 'socialnetwork-group-create-ex__breadcrumbs',\n\t\tbreadcrumbsItem: 'socialnetwork-group-create-ex__breadcrumbs-item',\n\t\tbodyContainer: 'socialnetwork-group-create-ex__content',\n\t\tbodyItem: 'socialnetwork-group-create-ex__content-body',\n\t\tactiveBodyItem: '--active',\n\t\tactiveBreadcrumbsItem: '--active',\n\t};\n\n\tstatic getFirstStepNumber()\n\t{\n\t\treturn (Object.entries(WorkgroupForm.getInstance().projectTypes).length > 1 ? 1 : 2);\n\t}\n\n\tconstructor(\n\t\tparams: {\n\t\t\tcurrentStep: number,\n\t\t\tstepsCount: number,\n\t\t}\n\t)\n\t{\n\t\tthis.processedStep = 0;\n\t\tthis.currentStep = params.currentStep;\n\t\tthis.stepsCount = params.stepsCount;\n\n\t\tthis.step1BackgroudNode = document.querySelector(`.${Wizard.cssClass.step1Backgroud}`);\n\t\tthis.bodyContainer = document.querySelector(`.${Wizard.cssClass.bodyContainer}`);\n\t\tthis.breadcrumbsContainer = document.querySelector(`.${Wizard.cssClass.breadcrumbsContainer}`);\n\t}\n\n\tshowCurrentStep()\n\t{\n\t\tif (Type.isDomNode(this.bodyContainer))\n\t\t{\n\t\t\tthis.bodyContainer.querySelectorAll(`.${Wizard.cssClass.bodyItem}`).forEach((bodyItem) => {\n\t\t\t\tif (bodyItem.classList.contains(`--step-${this.currentStep}`))\n\t\t\t\t{\n\t\t\t\t\tbodyItem.classList.add(Wizard.cssClass.activeBodyItem)\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbodyItem.classList.remove(Wizard.cssClass.activeBodyItem);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isDomNode(this.breadcrumbsContainer))\n\t\t{\n\t\t\tthis.breadcrumbsContainer.querySelectorAll(`.${Wizard.cssClass.breadcrumbsItem}`).forEach((breadcrumbsItem) => {\n\t\t\t\tif (breadcrumbsItem.classList.contains(`--step-${this.currentStep}`))\n\t\t\t\t{\n\t\t\t\t\tbreadcrumbsItem.classList.add(Wizard.cssClass.activeBreadcrumbsItem)\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tbreadcrumbsItem.classList.remove(Wizard.cssClass.activeBreadcrumbsItem);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tthis.currentStep === Wizard.getFirstStepNumber()\n\t\t\t|| this.currentStep <= this.processedStep + 1\n\t\t)\n\t\t{\n\t\t\tButtons.hideButton(WorkgroupForm.getInstance().buttonsInstance.backButton);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (Type.isDomNode(this.step1BackgroudNode))\n\t\t\t{\n\t\t\t\tthis.step1BackgroudNode.classList.add(`--stop`);\n\t\t\t}\n\t\t\tButtons.showButton(WorkgroupForm.getInstance().buttonsInstance.backButton);\n\t\t}\n\n\t}\n\n\tsetProjectType(projectType)\n\t{\n\t\tif (Type.isDomNode(this.step1BackgroudNode))\n\t\t{\n\t\t\t[ 'project', 'scrum', 'group' ].forEach(projectType => {\n\t\t\t\tthis.step1BackgroudNode.classList.remove(`--${projectType}`);\n\t\t\t})\n\t\t\tthis.step1BackgroudNode.classList.remove('--stop');\n\t\t\tthis.step1BackgroudNode.classList.add(`--${projectType}`);\n\t\t}\n\t}\n\n\trecalcAfterSubmit(params)\n\t{\n\t\tconst processedStep = (Type.isStringFilled(params.processedStep) ? params.processedStep : '');\n\t\tconst createdGroupId = parseInt(!Type.isUndefined(params.createdGroupId) ? params.createdGroupId : 0);\n\t\tconst tabInputNode = document.getElementById('TAB');\n\t\tconst tabGroupIdNode = document.getElementById('SONET_GROUP_ID');\n\n\t\tif (\n\t\t\t!tabInputNode\n\t\t\t|| !Type.isStringFilled(processedStep)\n\t\t\t|| createdGroupId <= 0\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttabGroupIdNode.value = createdGroupId;\n\n\t\tif (processedStep === 'create')\n\t\t{\n\t\t\tthis.processedStep = 1;\n\t\t\ttabInputNode.value = 'edit';\n\t\t}\n\t\telse if (processedStep === 'edit')\n\t\t{\n\t\t\tthis.processedStep = 3;\n\t\t\ttabInputNode.value = 'invite';\n\t\t\tthis.bodyContainer.querySelectorAll('.socialnetwork-group-create-ex__create--switch-notinviteonly').forEach((selector) => {\n\t\t\t\tselector.classList.add('--inviteonly');\n\t\t\t});\n\t\t}\n\n\t\tthis.showCurrentStep();\n\t}\n}\n","import { Type, Dom } from 'main.core';\nimport { Alert } from 'ui.alerts';\n\nexport class AlertManager\n{\n\tconstructor(\n\t\tparams: {\n\t\t\terrorContainerId: string,\n\t\t}\n\t)\n\t{\n\t\tif (!Type.isStringFilled(params.errorContainerId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.globalErrorContainer = document.getElementById(params.errorContainerId);\n\n\t\tthis.nodeAlerts = new Map();\n\t}\n\n\tshowAlert(text, targetNode)\n\t{\n\t\tif (Type.isDomNode(targetNode))\n\t\t{\n\t\t\ttargetNode.classList.add('ui-ctl-danger');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetNode = this.globalErrorContainer;\n\t\t}\n\n\n\t\tconst textAlert = new Alert({\n\t\t\tcolor: Alert.Color.DANGER,\n\t\t\tanimate: true,\n\t\t});\n\n\t\tthis.nodeAlerts.set(targetNode, textAlert);\n\n\t\tsetTimeout(() => {\n\t\t\ttargetNode.parentNode.insertBefore(textAlert.getContainer(), targetNode.nextSibling);\n\t\t\ttextAlert.setText(text);\n\n\t\t\twindow.scrollTo({\n\t\t\t\ttop: Dom.getPosition(targetNode).top,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t}, 500);\n\n\t}\n\n\thideAllAlerts()\n\t{\n\t\tthis.nodeAlerts.forEach((textAlert, targetNode) => {\n\t\t\ttextAlert.hide();\n\n\t\t\tif (Type.isDomNode(targetNode))\n\t\t\t{\n\t\t\t\ttargetNode.classList.remove('ui-ctl-danger');\n\t\t\t}\n\t\t});\n\n\t\tthis.nodeAlerts.clear();\n\t}\n}\n","import {Loc, Type, Dom} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\nimport {TagSelector} from 'ui.entity-selector';\n\nimport {WorkgroupForm} from './index';\nimport {Util} from './util';\n\nexport class TeamManager\n{\n\tstatic instance = null;\n\n\tstatic contextList = {\n\t\towner: 'GROUP_INVITE_OWNER',\n\t\tscrumMaster: 'GROUP_INVITE_SCRUM_MASTER',\n\t\tmoderators: 'GROUP_INVITE_MODERATORS',\n\t\tusers: 'GROUP_INVITE',\n\t};\n\n\tstatic getInstance()\n\t{\n\t\treturn TeamManager.instance;\n\t}\n\n\tconstructor(params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\n\t\tthis.ownerSelector = null;\n\t\tthis.scrumMasterSelector = null;\n\t\tthis.moderatorsSelector = null;\n\t\tthis.usersSelector = null;\n\n\t\tthis.ownerOptions = params.ownerOptions || {};\n\t\tthis.scrumMasterOptions = params.scrumMasterOptions || {};\n\t\tthis.moderatorsOptions = params.moderatorsOptions || {};\n\t\tthis.usersOptions = params.usersOptions || {};\n\n\t\tthis.ownerContainerNode = document.getElementById('GROUP_OWNER_selector');\n\t\tthis.scrumMasterContainerNode = document.getElementById('SCRUM_MASTER_selector');\n\t\tthis.moderatorsContainerNode = document.getElementById('GROUP_MODERATORS_selector');\n\t\tthis.usersContainerNode = document.getElementById('GROUP_USERS_selector');\n\n\t\tthis.isCurrentUserAdmin = (Type.isBoolean(params.isCurrentUserAdmin) ? params.isCurrentUserAdmin : false);\n\t\tthis.extranetInstalled = (Type.isBoolean(params.extranetInstalled) ? params.extranetInstalled : false);\n\t\tthis.allowExtranet = (Type.isBoolean(params.allowExtranet) ? params.allowExtranet : false);\n\n\t\tTeamManager.instance = this;\n\n\t\tthis.buildOwnerSelector();\n\t\tthis.buildScrumMasterSelector();\n\t\tthis.buildModeratorsSelector();\n\t\tthis.buildUsersSelector();\n\n\t\tthis.bindEvents();\n\t}\n\n\tbuildOwnerSelector()\n\t{\n\t\tif (!Type.isDomNode(this.ownerContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.ownerContainerNode);\n\n\t\tconst selectorOptions = this.ownerOptions;\n\t\tthis.ownerSelector = new TagSelector({\n\n\t\t\tid: selectorOptions.selectorId || 'group_create_owner',\n\t\t\tdialogOptions: {\n\t\t\t\tid: selectorOptions.selectorId || 'group_create_owner',\n\t\t\t\tcontext: TeamManager.contextList.owner,\n\t\t\t\tpreselectedItems: selectorOptions.value,\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\t\t'Item:onSelect': TeamManager.onOwnerSelect,\n\t\t\t\t\t'Item:onDeselect': TeamManager.onOwnerSelect,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: !this.allowExtranet,\n\t\t\t\t\t\t\tinviteEmployeeLink: true,\n\t\t\t\t\t\t\tinviteExtranetLink: true,\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\tcheckWorkgroupWhenInvite: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: Loc.getMessage('SONET_GCE_T_ADD_OWNER'),\n\t\t});\n\n\t\tthis.ownerSelector.renderTo(this.ownerContainerNode);\n\t}\n\n\tbuildScrumMasterSelector()\n\t{\n\t\tif (!Type.isDomNode(this.scrumMasterContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.scrumMasterContainerNode);\n\n\t\tconst selectorOptions = this.scrumMasterOptions;\n\n\t\tthis.scrumMasterSelector = new TagSelector({\n\n\t\t\tid: selectorOptions.selectorId || 'group_create_scrum_master',\n\t\t\tdialogOptions: {\n\t\t\t\tid: selectorOptions.selectorId || 'group_create_scrum_master',\n\t\t\t\tcontext: TeamManager.contextList.scrumMaster,\n\t\t\t\tpreselectedItems: selectorOptions.value,\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\t\t'Item:onSelect': TeamManager.onScrumMasterSelect,\n\t\t\t\t\t'Item:onDeselect': TeamManager.onScrumMasterSelect,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: !this.allowExtranet,\n\t\t\t\t\t\t\tinviteEmployeeLink: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: Loc.getMessage('SONET_GCE_T_CHANGE_SCRUM_MASTER'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('SONET_GCE_T_CHANGE_SCRUM_MASTER_MORE'),\n\t\t});\n\n\t\tthis.scrumMasterSelector.renderTo(this.scrumMasterContainerNode);\n\t}\n\n\tbuildModeratorsSelector()\n\t{\n\t\tif (!Type.isDomNode(this.moderatorsContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.moderatorsContainerNode);\n\n\t\tconst selectorOptions = this.moderatorsOptions;\n\n\t\tthis.moderatorsSelector = new TagSelector({\n\t\t\tid: selectorOptions.selectorId || 'group_create_moderators',\n\t\t\tdialogOptions: {\n\t\t\t\tid: selectorOptions.selectorId || 'group_create_moderators',\n\t\t\t\tcontext: TeamManager.contextList.moderators,\n\t\t\t\tpreselectedItems: selectorOptions.value,\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\t\t'Item:onSelect': TeamManager.onModeratorsSelect,\n\t\t\t\t\t'Item:onDeselect': TeamManager.onModeratorsSelect,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: !this.allowExtranet,\n\t\t\t\t\t\t\tinviteEmployeeLink: true,\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\tcheckWorkgroupWhenInvite: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tmultiple: true,\n\t\t\taddButtonCaption: Loc.getMessage('SONET_GCE_T_ADD_USER'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('SONET_GCE_T_ADD_USER_MORE'),\n\t\t});\n\n\t\tthis.moderatorsSelector.renderTo(this.moderatorsContainerNode);\n\t}\n\n\tbuildUsersSelector()\n\t{\n\t\tif (!Type.isDomNode(this.usersContainerNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.usersContainerNode);\n\n\t\tconst selectorOptions = this.usersOptions;\n\n\t\tthis.usersSelector = new TagSelector({\n\t\t\tid: selectorOptions.selectorId || 'group_create_users',\n\t\t\tdialogOptions: {\n\t\t\t\tid: selectorOptions.selectorId || 'group_create_users',\n\t\t\t\tcontext: TeamManager.contextList.users,\n\t\t\t\tpreselectedItems: selectorOptions.value,\n\t\t\t\tevents: {\n\t\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\t\t'Item:onSelect': TeamManager.onUsersSelect,\n\t\t\t\t\t'Item:onDeselect': TeamManager.onUsersSelect,\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteEmployeeLink: true,\n\t\t\t\t\t\t\t'!userId': (this.isCurrentUserAdmin ? [ parseInt(Loc.getMessage('USER_ID')) ] : []),\n\t\t\t\t\t\t\tintranetUsersOnly: !this.allowExtranet,\n\t\t\t\t\t\t\tgroupId: this.groupId,\n\t\t\t\t\t\t\tcheckWorkgroupWhenInvite: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: (selectorOptions.enableSelectDepartment ? 'usersAndDepartments' : 'usersOnly'),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tmultiple: true,\n\t\t\taddButtonCaption: Loc.getMessage('SONET_GCE_T_ADD_USER'),\n\t\t\taddButtonCaptionMore: Loc.getMessage('SONET_GCE_T_ADD_USER_MORE'),\n\t\t});\n\n\t\tthis.usersSelector.renderTo(this.usersContainerNode);\n\t}\n\n\tbindEvents()\n\t{\n\t\tWorkgroupForm.getInstance().subscribe('onSwitchExtranet', this.onSwitchExtranet.bind(this));\n\t\tEventEmitter.emit('BX.Socialnetwork.WorkgroupFormTeamManager::onEventsBinded');\n\t}\n\n\tonSwitchExtranet(event)\n\t{\n\t\tconst data = event.getData();\n\t\tif (!Type.isBoolean(data.isChecked))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.allowExtranet = this.extranetInstalled && data.isChecked;\n\n\t\tif (\n\t\t\tthis.ownerSelector\n\t\t\t&& [ 'DONE', 'UNSENT' ].includes(this.ownerSelector.getDialog().loadState)\n\t\t)\n\t\t{\n\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\tselector: this.ownerSelector,\n\t\t\t\tisChecked: data.isChecked,\n\t\t\t\toptions: this.ownerOptions,\n\t\t\t});\n\t\t\tthis.buildOwnerSelector();\n\t\t}\n\n\t\tif (\n\t\t\tthis.scrumMasterSelector\n\t\t\t&& [ 'DONE', 'UNSENT' ].includes(this.scrumMasterSelector.getDialog().loadState)\n\t\t)\n\t\t{\n\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\tselector: this.scrumMasterSelector,\n\t\t\t\tisChecked: data.isChecked,\n\t\t\t\toptions: this.scrumMasterOptions,\n\t\t\t});\n\n\t\t\tthis.buildScrumMasterSelector();\n\t\t}\n\n\t\tif (\n\t\t\tthis.moderatorsSelector\n\t\t\t&& [ 'DONE', 'UNSENT' ].includes(this.moderatorsSelector.getDialog().loadState)\n\t\t)\n\t\t{\n\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\tselector: this.moderatorsSelector,\n\t\t\t\tisChecked: data.isChecked,\n\t\t\t\toptions: this.moderatorsOptions,\n\t\t\t});\n\n\t\t\tthis.buildModeratorsSelector();\n\t\t}\n\n\t\tif (\n\t\t\tthis.usersSelector\n\t\t\t&& [ 'DONE', 'UNSENT' ].includes(this.usersSelector.getDialog().loadState)\n\t\t)\n\t\t{\n\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\tselector: this.usersSelector,\n\t\t\t\tisChecked: data.isChecked,\n\t\t\t\toptions: this.usersOptions,\n\t\t\t});\n\n\t\t\tthis.buildUsersSelector();\n\t\t}\n\t}\n\n\trecalcSelectorByExtranetSwitched(params)\n\t{\n\t\tconst selector = params.selector;\n\t\tconst isChecked = params.isChecked;\n\n\t\tconst context = selector.getDialog().getContext();\n\t\tlet selectedItems = selector.getDialog().getSelectedItems();\n\n\t\tif (\n\t\t\tthis.extranetInstalled && !isChecked\n\t\t\t&& Type.isArray(selectedItems)\n\t\t)\n\t\t{\n\t\t\tselectedItems = selectedItems.filter((item) => {\n\t\t\t\treturn !(item.getEntityId() === 'user' && item.getEntityType() === 'extranet');\n\t\t\t});\n\n\t\t\tswitch (context)\n\t\t\t{\n\t\t\t\tcase TeamManager.contextList.owner:\n\t\t\t\t\tUtil.recalcInputValue({\n\t\t\t\t\t\tselectedItems: selectedItems,\n\t\t\t\t\t\tinputNodeName: 'OWNER_CODE',\n\t\t\t\t\t\tinputContainerNodeId: 'OWNER_CODE_container',\n\t\t\t\t\t\tmultiple: false,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase TeamManager.contextList.scrumMaster:\n\t\t\t\t\tUtil.recalcInputValue({\n\t\t\t\t\t\tselectedItems: selectedItems,\n\t\t\t\t\t\tinputNodeName: 'SCRUM_MASTER_CODE',\n\t\t\t\t\t\tinputContainerNodeId: 'SCRUM_MASTER_CODE_container',\n\t\t\t\t\t\tmultiple: false,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase TeamManager.contextList.moderators:\n\t\t\t\t\tUtil.recalcInputValue({\n\t\t\t\t\t\tselectedItems: selectedItems,\n\t\t\t\t\t\tinputNodeName: 'MODERATOR_CODES',\n\t\t\t\t\t\tinputContainerNodeId: 'MODERATOR_CODES_container',\n\t\t\t\t\t\tmultiple: true,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase TeamManager.contextList.users:\n\t\t\t\t\tUtil.recalcInputValue({\n\t\t\t\t\t\tselectedItems: selectedItems,\n\t\t\t\t\t\tinputNodeName: 'USER_CODES',\n\t\t\t\t\t\tinputContainerNodeId: 'USER_CODES_container',\n\t\t\t\t\t\tmultiple: true,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}\n\t\t}\n\n\t\tparams.options.value = selectedItems.map((item) => {\n\t\t\treturn [ item.getEntityId(), item.getId() ];\n\t\t});\n\t}\n\n\tonLoad(event: BaseEvent)\n\t{\n\t\tswitch (event.getTarget().context)\n\t\t{\n\t\t\tcase TeamManager.contextList.owner:\n\t\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\t\tselector: this.ownerSelector,\n\t\t\t\t\tisChecked: this.allowExtranet,\n\t\t\t\t\toptions: this.ownerOptions,\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase TeamManager.contextList.scrumMaster:\n\t\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\t\tselector: this.scrumMasterSelector,\n\t\t\t\t\tisChecked: this.allowExtranet,\n\t\t\t\t\toptions: this.scrumMasterOptions,\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase TeamManager.contextList.moderators:\n\t\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\t\tselector: this.moderatorsSelector,\n\t\t\t\t\tisChecked: this.allowExtranet,\n\t\t\t\t\toptions: this.moderatorsOptions,\n\t\t\t\t});\n\n\t\t\t\tif (WorkgroupForm.getInstance().initialFocus === 'addModerator')\n\t\t\t\t{\n\t\t\t\t\tthis.moderatorsSelector.getAddButtonLink().click();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase TeamManager.contextList.users:\n\t\t\t\tthis.recalcSelectorByExtranetSwitched({\n\t\t\t\t\tselector: this.usersSelector,\n\t\t\t\t\tisChecked: this.allowExtranet,\n\t\t\t\t\toptions: this.usersOptions,\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\tstatic onOwnerSelect(event: BaseEvent)\n\t{\n\t\tUtil.recalcInputValue({\n\t\t\tselectedItems: event.getTarget().getSelectedItems(),\n\t\t\tinputNodeName: 'OWNER_CODE',\n\t\t\tinputContainerNodeId: 'OWNER_CODE_container',\n\t\t\tmultiple: false,\n\t\t});\n\t}\n\n\tstatic onScrumMasterSelect(event: BaseEvent)\n\t{\n\t\tUtil.recalcInputValue({\n\t\t\tselectedItems: event.getTarget().getSelectedItems(),\n\t\t\tinputNodeName: 'SCRUM_MASTER_CODE',\n\t\t\tinputContainerNodeId: 'SCRUM_MASTER_CODE_container',\n\t\t\tmultiple: false,\n\t\t});\n\t}\n\n\tstatic onModeratorsSelect(event: BaseEvent)\n\t{\n\t\tUtil.recalcInputValue({\n\t\t\tselectedItems: event.getTarget().getSelectedItems(),\n\t\t\tinputNodeName: 'MODERATOR_CODES',\n\t\t\tinputContainerNodeId: 'MODERATOR_CODES_container',\n\t\t\tmultiple: true,\n\t\t});\n\t}\n\n\tstatic onUsersSelect(event: BaseEvent)\n\t{\n\t\tUtil.recalcInputValue({\n\t\t\tselectedItems: event.getTarget().getSelectedItems(),\n\t\t\tinputNodeName: 'USER_CODES',\n\t\t\tinputContainerNodeId: 'USER_CODES_container',\n\t\t\tmultiple: true,\n\t\t});\n\n\t\tconst hintNode = document.getElementById('GROUP_ADD_DEPT_HINT_block');\n\t\tif (hintNode)\n\t\t{\n\t\t\tTeamManager.showDepartmentHint({\n\t\t\t\tselectedItems: event.getTarget().getSelectedItems(),\n\t\t\t\thintNode: hintNode,\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic showDepartmentHint(params)\n\t{\n\t\tconst selectedItems = params.selectedItems || {};\n\t\tconst hintNode = params.hintNode || null;\n\t\tif (!Type.isDomNode(hintNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isArray(selectedItems))\n\t\t{\n\t\t\thintNode.classList.remove('visible');\n\t\t\treturn;\n\t\t}\n\n\t\tconst departmentFound = !Type.isUndefined(selectedItems.find((item) => {\n\t\t\treturn (item.entityId === 'department');\n\t\t}));\n\n\t\tif (departmentFound)\n\t\t{\n\t\t\thintNode.classList.add('visible');\n\t\t}\n\t\telse\n\t\t{\n\t\t\thintNode.classList.remove('visible');\n\t\t}\n\t}\n}\n","export class FeaturesManager\n{\n\tconstructor()\n\t{\n\t\tconst containerNode = document.getElementById('additional-block-features');\n\t\tif (!containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcontainerNode.querySelectorAll('.socialnetwork-group-create-ex__project-instruments--icon-action.--edit').forEach((editButton) => {\n\n\t\t\teditButton.addEventListener('click', (e) => {\n\n\t\t\t\tconst editButton = e.currentTarget;\n\t\t\t\tconst featureNode = editButton.closest('.socialnetwork-group-create-ex__project-instruments--item');\n\t\t\t\tif (featureNode)\n\t\t\t\t{\n\t\t\t\t\tfeatureNode.classList.add('--custom-value');\n\n\t\t\t\t\tconst inputNode = featureNode.querySelector('[data-role=\"feature-input-text\"]');\n\t\t\t\t\tconst textNode = featureNode.querySelector('[data-role=\"feature-label\"]');\n\t\t\t\t\tif (\n\t\t\t\t\t\tinputNode\n\t\t\t\t\t\t&& textNode\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tinputNode.value = textNode.innerText;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t});\n\n\t\tcontainerNode.querySelectorAll('.socialnetwork-group-create-ex__project-instruments--icon-action.--revert').forEach((cancelButton) => {\n\n\t\t\tcancelButton.addEventListener('click', (e) => {\n\n\t\t\t\tconst editButton = e.currentTarget;\n\t\t\t\tconst featureNode = editButton.closest('.socialnetwork-group-create-ex__project-instruments--item');\n\t\t\t\tif (featureNode)\n\t\t\t\t{\n\t\t\t\t\tfeatureNode.classList.remove('--custom-value');\n\n\t\t\t\t\tconst inputNode = featureNode.querySelector('[data-role=\"feature-input-text\"]');\n\t\t\t\t\tif (inputNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tinputNode.value = '';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t});\n\n\t\t});\n\t}\n}\n","import { Type } from 'main.core';\nimport { FieldsManager } from './fields';\n\nexport class UFManager\n{\n\tconstructor(\n\t\tparams: {\n\t\t\tmandatoryUFList: object,\n\t\t}\n\t)\n\t{\n\t\tif (\n\t\t\tType.isPlainObject(FieldsManager.mandatoryFieldsByStep)\n\t\t\t&& Type.isArray(FieldsManager.mandatoryFieldsByStep[2])\n\t\t\t&& Type.isArray(params.mandatoryUFList)\n\t\t)\n\t\t{\n\t\t\tparams.mandatoryUFList.forEach((ufData) => {\n\t\t\t\tif (\n\t\t\t\t\t!Type.isStringFilled(ufData.id)\n\t\t\t\t\t|| !Type.isStringFilled(ufData.type)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tFieldsManager.mandatoryFieldsByStep[2].push(ufData);\n\t\t\t});\n\t\t}\n\t}\n\n}\n","import {Type, Loc, ajax, Uri} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Scrum} from './scrum';\nimport {Avatar} from './avatar';\nimport {DateCorrector} from './date.corrector';\nimport {ThemePicker} from './themepicker';\nimport {Tags} from './tags';\nimport {Util} from './util';\nimport {TypePresetSelector} from './typepresetselector';\nimport {ConfidentialitySelector} from './confidentialityselector';\nimport {Buttons} from './buttons';\nimport {Wizard} from './wizard';\nimport {AlertManager} from './alert';\nimport {TeamManager} from './team';\nimport {FeaturesManager} from './features';\nimport {UFManager} from './uf';\n\nclass WorkgroupForm extends EventEmitter\n{\n\tstatic instance = null;\n\n\tstatic getInstance()\n\t{\n\t\treturn WorkgroupForm.instance;\n\t}\n\n\tconstructor(\n\t\tparams: {\n\t\t\tcomponentName: string,\n\t\t\tsignedParameters: string,\n\t\t\tselectedProjectType: string,\n\t\t\tselectedConfidentialityType: string,\n\t\t\tgroupId: number,\n\t\t\tisScrumProject: boolean,\n\t\t\tconfig: Object,\n\t\t\tavatarUploaderId: string,\n\t\t\tthemePickerData: Object,\n\t\t\tprojectOptions: Object,\n\t\t\tprojectTypes: Object,\n\t\t\tconfidentialityTypes: Object,\n\t\t\tstepsCount: number,\n\t\t\tfocus: string,\n\t\t\tculture: Object\n\t\t}\n\t)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.WorkgroupForm');\n\n\t\tthis.componentName = params.componentName;\n\t\tthis.signedParameters = params.signedParameters;\n\t\tthis.userSelector = '';\n\t\tthis.lastAction = 'invite';\n\t\tthis.animationList = {};\n\t\tthis.selectedTypeCode = false;\n\n\t\tthis.groupId = parseInt(params.groupId);\n\t\tthis.isScrumProject = params.isScrumProject;\n\t\tthis.config = params.config;\n\t\tthis.avatarUploaderId = params.avatarUploaderId;\n\t\tthis.themePickerData = params.themePickerData;\n\t\tthis.projectOptions = params.projectOptions;\n\n\t\tthis.projectTypes = params.projectTypes;\n\t\tthis.confidentialityTypes = params.confidentialityTypes;\n\t\tthis.selectedProjectType = params.selectedProjectType;\n\t\tthis.selectedConfidentialityType = params.selectedConfidentialityType;\n\t\tthis.initialFocus = (Type.isStringFilled(params.focus) ? params.focus : '');\n\t\tthis.culture = params.culture ? params.culture : {};\n\n\t\tthis.scrumManager = new Scrum({\n\t\t\tisScrumProject: this.isScrumProject,\n\t\t});\n\n\t\tthis.wizardManager = new Wizard({\n\t\t\tcurrentStep: Object.entries(this.projectTypes).length > 1 ? 1 : 2,\n\t\t\tstepsCount: (params.stepsCount > 1 ? params.stepsCount : 1),\n\t\t});\n\n\t\tthis.alertManager = new AlertManager({\n\t\t\terrorContainerId: 'sonet_group_create_error_block',\n\t\t});\n\n\t\tWorkgroupForm.instance = this;\n\n\t\tthis.init(params);\n\t\tthis.buttonsInstance = new Buttons();\n\t}\n\n\tinit(params)\n\t{\n\t\tthis.scrumManager.makeAdditionalCustomizationForm();\n\n\t\tif (this.groupId <= 0)\n\t\t{\n\t\t\tthis.recalcForm();\n\t\t}\n\n\t\tnew Avatar({\n\t\t\tcomponentName: this.componentName,\n\t\t\tsignedParameters: this.signedParameters,\n\t\t\tgroupId: this.groupId,\n\t\t});\n\n\t\tif (\n\t\t\tType.isPlainObject(params.themePickerData)\n\t\t\t&& document.getElementById('GROUP_THEME_container')\n\t\t)\n\t\t{\n\t\t\tnew ThemePicker({\n\t\t\t\tcontainer: document.getElementById('GROUP_THEME_container'),\n\t\t\t\ttheme: params.themePickerData,\n\t\t\t});\n\t\t}\n\n\t\tnew DateCorrector({\n\t\t\tculture: this.culture\n\t\t});\n\n\t\tif (document.getElementById('group-tags-bind-node'))\n\t\t{\n\t\t\tnew Tags({\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tcontainerNodeId: 'group-tags-bind-node',\n\t\t\t\thiddenFieldId: 'GROUP_KEYWORDS',\n\t\t\t});\n\t\t}\n\n\t\tnew TypePresetSelector();\n\t\tnew ConfidentialitySelector();\n\t\tnew FeaturesManager();\n\n\t\tif (Type.isStringFilled(this.initialFocus))\n\t\t{\n\t\t\tif (this.initialFocus === 'description')\n\t\t\t{\n\t\t\t\tconst groupDescriptionNode = document.getElementById('GROUP_DESCRIPTION_input');\n\t\t\t\tif (groupDescriptionNode)\n\t\t\t\t{\n\t\t\t\t\tgroupDescriptionNode.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst groupNameNode = document.getElementById('GROUP_NAME_input');\n\t\t\tif (groupNameNode)\n\t\t\t{\n\t\t\t\tgroupNameNode.focus();\n\t\t\t}\n\t\t}\n\n\t\tthis.bindEvents();\n\n\t\tUtil.initExpandSwitches();\n\t\tUtil.initDropdowns();\n\n\t\tif (Type.isStringFilled(params.expandableSettingsNodeId))\n\t\t{\n\t\t\tBX.UI.Hint.init(document.getElementById(params.expandableSettingsNodeId));\n\t\t}\n\n\t\tif (this.groupId <= 0 && this.selectedProjectType === 'scrum')\n\t\t{\n\t\t\tthis.saveScrumAnalyticData();\n\t\t}\n\t}\n\n\tbindEvents()\n\t{\n\t\tif (BX.SidePanel.Instance.getTopSlider())\n\t\t{\n\t\t\tEventEmitter.subscribe(BX.SidePanel.Instance.getTopSlider().getWindow(), 'SidePanel.Slider:onClose', (event) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst sliderInstance = event.getTarget();\n\t\t\t\t\tif (!sliderInstance)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.SidePanel.Instance.destroy(sliderInstance.getUrl());\n\t\t\t\t}, 500);\n\t\t\t});\n\t\t}\n\n\t\tconst extranetCheckboxNode = document.getElementById('IS_EXTRANET_GROUP');\n\t\tif (\n\t\t\textranetCheckboxNode\n\t\t\t&& extranetCheckboxNode.type === 'checkbox'\n\t\t)\n\t\t{\n\t\t\textranetCheckboxNode.addEventListener('click', () => {\n\t\t\t\tthis.switchExtranet(extranetCheckboxNode.checked);\n\t\t\t});\n\t\t}\n\n\t\tconst visibleCheckboxNode = document.getElementById('GROUP_VISIBLE');\n\t\tif (\n\t\t\tvisibleCheckboxNode\n\t\t\t&& visibleCheckboxNode.type === 'checkbox'\n\t\t)\n\t\t{\n\t\t\tvisibleCheckboxNode.addEventListener('click', () => {\n\t\t\t\tthis.switchNotVisible(visibleCheckboxNode.checked);\n\t\t\t});\n\t\t}\n\n\t\tconst projectCheckboxNode = document.getElementById('GROUP_PROJECT');\n\t\tif (\n\t\t\tprojectCheckboxNode\n\t\t\t&& projectCheckboxNode.type === 'checkbox'\n\t\t)\n\t\t{\n\t\t\tprojectCheckboxNode.addEventListener('click', () => {\n\t\t\t\tUtil.recalcFormPartProject(projectCheckboxNode.checked);\n\t\t\t});\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Socialnetwork.WorkgroupFormTeamManager::onEventsBinded',\n\t\t\tthis.recalcFormDependencies.bind(this)\n\t\t);\n\t}\n\n\trecalcForm(params)\n\t{\n\t\tif (Type.isPlainObject(params))\n\t\t{\n\t\t\tif (!Type.isUndefined(params.selectedProjectType))\n\t\t\t{\n\t\t\t\tthis.selectedProjectType = (Type.isStringFilled(params.selectedProjectType) ? params.selectedProjectType : '');\n\t\t\t}\n\t\t\tif (!Type.isUndefined(params.selectedConfidentialityType))\n\t\t\t{\n\t\t\t\tthis.selectedConfidentialityType = (Type.isStringFilled(params.selectedConfidentialityType) ? params.selectedConfidentialityType : '');\n\t\t\t}\n\t\t}\n\n\t\tif (this.groupId <= 0)\n\t\t{\n\t\t\tthis.scrumManager.isScrumProject = (\n\t\t\t\tType.isPlainObject(this.projectTypes[this.selectedProjectType])\n\t\t\t\t&& Type.isStringFilled(this.projectTypes[this.selectedProjectType]['SCRUM_PROJECT'])\n\t\t\t\t&& this.projectTypes[this.selectedProjectType]['SCRUM_PROJECT'] === 'Y'\n\t\t\t);\n\n\t\t\tUtil.recalcFormPartProject(\n\t\t\t\tType.isPlainObject(this.projectTypes[this.selectedProjectType])\n\t\t\t\t&& Type.isStringFilled(this.projectTypes[this.selectedProjectType].PROJECT)\n\t\t\t\t&& this.projectTypes[this.selectedProjectType].PROJECT === 'Y'\n\t\t\t);\n\t\t}\n\n\t\tthis.scrumManager.makeAdditionalCustomizationForm();\n\n\t\tif (this.groupId <= 0)\n\t\t{\n\t\t\tconst openedCheckboxNode = document.getElementById('GROUP_OPENED');\n\t\t\tif (openedCheckboxNode)\n\t\t\t{\n\t\t\t\tUtil.setCheckedValue(openedCheckboxNode, (\n\t\t\t\t\tType.isPlainObject(this.confidentialityTypes[this.selectedConfidentialityType])\n\t\t\t\t\t&& Type.isStringFilled(this.confidentialityTypes[this.selectedConfidentialityType].OPENED)\n\t\t\t\t\t&& this.confidentialityTypes[this.selectedConfidentialityType].OPENED === 'Y'\n\t\t\t\t));\n\t\t\t}\n\n\t\t\tconst visibleCheckboxNode = document.getElementById('GROUP_VISIBLE');\n\t\t\tif (visibleCheckboxNode)\n\t\t\t{\n\t\t\t\tUtil.setCheckedValue(visibleCheckboxNode, (\n\t\t\t\t\tType.isPlainObject(this.confidentialityTypes[this.selectedConfidentialityType])\n\t\t\t\t\t&& Type.isStringFilled(this.confidentialityTypes[this.selectedConfidentialityType].VISIBLE)\n\t\t\t\t\t&& this.confidentialityTypes[this.selectedConfidentialityType].VISIBLE === 'Y'\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\n\t\tthis.recalcFormDependencies();\n\t};\n\n\trecalcFormDependencies()\n\t{\n\t\tconst extranetCheckboxNode = document.getElementById('IS_EXTRANET_GROUP');\n\t\tif (extranetCheckboxNode)\n\t\t{\n\t\t\tthis.switchExtranet(Util.getCheckedValue(extranetCheckboxNode));\n\t\t}\n\n\t\tconst visibleCheckboxNode = document.getElementById('GROUP_VISIBLE');\n\t\tif (visibleCheckboxNode)\n\t\t{\n\t\t\tthis.switchNotVisible(visibleCheckboxNode.checked)\n\t\t}\n\t}\n\n\tswitchExtranet(isChecked)\n\t{\n\t\tthis.emit('onSwitchExtranet', new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tisChecked,\n\t\t\t},\n\t\t}));\n\n\t\tconst openedBlock = document.getElementById('GROUP_OPENED');\n\t\tif (openedBlock)\n\t\t{\n\t\t\tif (!isChecked)\n\t\t\t{\n\t\t\t\tif (openedBlock.type === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\topenedBlock.disabled = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (openedBlock.type === 'checkbox')\n\t\t\t\t{\n\t\t\t\t\topenedBlock.disabled = true;\n\t\t\t\t\topenedBlock.checked = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\topenedBlock.value = 'N';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst visibleBlock = document.getElementById('GROUP_VISIBLE');\n\t\tif (visibleBlock)\n\t\t{\n\t\t\tif (!isChecked)\n\t\t\t{\n\t\t\t\tif (visibleBlock.type == 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tvisibleBlock.disabled = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (visibleBlock.type == 'checkbox')\n\t\t\t\t{\n\t\t\t\t\tvisibleBlock.disabled = true;\n\t\t\t\t\tvisibleBlock.checked = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvisibleBlock.value = 'N';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.switchNotVisible(visibleBlock.checked)\n\t\t}\n\t}\n\n\tswitchNotVisible(isChecked)\n\t{\n\t\tconst openedNode = document.getElementById('GROUP_OPENED')\n\t\tif (\n\t\t\topenedNode\n\t\t\t&& openedNode.type == 'checkbox'\n\t\t)\n\t\t{\n\t\t\tif (isChecked)\n\t\t\t{\n\t\t\t\topenedNode.disabled = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\topenedNode.disabled = true;\n\t\t\t\topenedNode.checked = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tsubmitForm(e)\n\t{\n\t\tlet actionUrl = document.getElementById('sonet_group_create_popup_form').action;\n\n\t\tif (actionUrl)\n\t\t{\n\t\t\tconst groupIdNode = document.getElementById('SONET_GROUP_ID');\n\t\t\tlet b24statAction = 'addSonetGroup';\n\n\t\t\tif (groupIdNode)\n\t\t\t{\n\t\t\t\tif (parseInt(groupIdNode.value) <= 0)\n\t\t\t\t{\n\t\t\t\t\tactionUrl = Uri.addParam(actionUrl, {\n\t\t\t\t\t\taction: 'createGroup',\n\t\t\t\t\t\tgroupType: this.selectedTypeCode,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tb24statAction = 'editSonetGroup';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tactionUrl = Uri.addParam(actionUrl, {\n\t\t\t\tb24statAction: b24statAction,\n\t\t\t});\n\n\t\t\tconst formElements = document.forms['sonet_group_create_popup_form'].elements;\n\t\t\tif (\n\t\t\t\tformElements.GROUP_PROJECT\n\t\t\t\t&& (\n\t\t\t\t\tformElements.IS_EXTRANET_GROUP\n\t\t\t\t\t|| formElements.GROUP_OPENED\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet b24statType = (formElements.GROUP_PROJECT.checked ? 'project-' : 'group-');\n\t\t\t\tif (\n\t\t\t\t\tformElements.IS_EXTRANET_GROUP\n\t\t\t\t\t&& formElements.IS_EXTRANET_GROUP.checked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tb24statType += 'external';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tb24statType += (formElements.GROUP_OPENED.checked ? 'open' : 'closed');\n\t\t\t\t}\n\n\t\t\t\tactionUrl = Uri.addParam(actionUrl, {\n\t\t\t\t\tb24statType: b24statType,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tformElements.SCRUM_PROJECT\n\t\t\t\t&& b24statAction === 'addSonetGroup'\n\t\t\t)\n\t\t\t{\n\t\t\t\tactionUrl = Uri.addParam(actionUrl, {\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\tscrum: 'Y',\n\t\t\t\t\t\taction: 'scrum_create',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tButtons.showWaitSubmitButton(true);\n\n\t\t\tajax.submitAjax(\n\t\t\t\tdocument.forms['sonet_group_create_popup_form'],\n\t\t\t\t{\n\t\t\t\t\turl: actionUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tPROJECT_OPTIONS: this.projectOptions,\n\t\t\t\t\t},\n\t\t\t\t\tonsuccess: (response) => {\n\t\t\t\t\t\tif (Type.isStringFilled(response.ERROR))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst warningText = (\n\t\t\t\t\t\t\t\tType.isStringFilled(response.WARNING)\n\t\t\t\t\t\t\t\t\t? `${response.WARNING}<br>`\n\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tthis.alertManager.showAlert(`${warningText}${response.ERROR}`);\n\n\t\t\t\t\t\t\tif (Type.isStringFilled(response.WIZARD_STEP_PROCESSED))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.wizardManager.recalcAfterSubmit({\n\t\t\t\t\t\t\t\t\tprocessedStep: response.WIZARD_STEP_PROCESSED.toLowerCase(),\n\t\t\t\t\t\t\t\t\tcreatedGroupId: parseInt(!Type.isUndefined(response.CREATED_GROUP_ID) ? response.CREATED_GROUP_ID : 0),\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tType.isArray(response.SUCCESSFULL_USERS_ID)\n\t\t\t\t\t\t\t\t&& response.SUCCESSFULL_USERS_ID.length > 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresponse.SUCCESSFULL_USERS_ID = response.SUCCESSFULL_USERS_ID.map((userId) => {\n\t\t\t\t\t\t\t\t\treturn Number(userId);\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tconst usersSelector = TeamManager.getInstance().usersSelector;\n\t\t\t\t\t\t\t\tconst usersSelectorDialog = (usersSelector ? usersSelector.getDialog() : null);\n\t\t\t\t\t\t\t\tif (usersSelectorDialog)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tusersSelectorDialog.getSelectedItems().forEach((item) => {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\titem.entityId === 'user'\n\t\t\t\t\t\t\t\t\t\t\t&& response.SUCCESSFULL_USERS_ID.includes(item.id)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\titem.deselect();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', {\n\t\t\t\t\t\t\t\t\tcode: 'afterInvite',\n\t\t\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tButtons.showWaitSubmitButton(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (response.MESSAGE === 'SUCCESS')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst currentSlider = BX.SidePanel.Instance.getSliderByWindow(window);\n\t\t\t\t\t\t\tif (currentSlider)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\t\t\t\tcompatData: [ currentSlider.getEvent('onClose') ],\n\t\t\t\t\t\t\t\t\tdata: currentSlider.getEvent('onClose'),\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tEventEmitter.emit(window.top, 'SidePanel.Slider:onClose', event);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (window === top.window) // not frame\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (Type.isStringFilled(response.URL))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = response.URL;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (Type.isStringFilled(response.ACTION))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet eventData = null;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t[ 'create', 'edit' ].includes(response.ACTION)\n\t\t\t\t\t\t\t\t\t&& !Type.isUndefined(response.GROUP)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\teventData = {\n\t\t\t\t\t\t\t\t\t\tcode: (response.ACTION == 'create' ? 'afterCreate' : 'afterEdit'),\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tgroup: response.GROUP,\n\t\t\t\t\t\t\t\t\t\t\tprojectOptions: this.projectOptions,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (response.ACTION === 'invite')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\teventData = {\n\t\t\t\t\t\t\t\t\t\tcode: 'afterInvite',\n\t\t\t\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (eventData)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'sonetGroupEvent', eventData);\n\t\t\t\t\t\t\t\t\tif (response.ACTION === 'create')\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst createdGroupsData = JSON.parse(response.SELECTOR_GROUPS);\n\t\t\t\t\t\t\t\t\t\tif (Type.isArray(createdGroupsData))\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.postMessageAll(window, 'BX.Socialnetwork.Workgroup:onAdd', { projects: createdGroupsData });\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (currentSlider)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close(false, () => {\n\t\t\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.destroy(currentSlider.getUrl());\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tresponse.ACTION == 'create'\n\t\t\t\t\t\t\t\t\t\t&& Type.isStringFilled(response.URL)\n\t\t\t\t\t\t\t\t\t\t&& (\n\t\t\t\t\t\t\t\t\t\t\t!Type.isStringFilled(this.config.refresh)\n\t\t\t\t\t\t\t\t\t\t\t|| this.config.refresh === 'Y'\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlet bindingFound = false;\n\n\t\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.anchorRules.find((rule) => {\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\tbindingFound\n\t\t\t\t\t\t\t\t\t\t\t\t|| !Type.isArray(rule.condition)\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\trule.condition.forEach((condition) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (bindingFound)\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (response.URL.match(condition))\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tbindingFound = true;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\n\n\t\t\t\t\t\t\t\t\t\tif (bindingFound)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\t\t\t\t\t\t\tresponse.URL\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttop.window.location.href = response.URL;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonfailure: (errorData) => {\n\t\t\t\t\t\tButtons.showWaitSubmitButton(false);\n\t\t\t\t\t\tthis.alertManager.showAlert(Loc.getMessage('SONET_GCE_T_AJAX_ERROR'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\te.preventDefault();\n\t}\n\n\tsaveScrumAnalyticData()\n\t{\n\t\tconst actionUrl = document.getElementById('sonet_group_create_popup_form').action;\n\n\t\tconst source = new Uri(actionUrl).getQueryParam('source');\n\t\tconst availableSources = new Set([\n\t\t\t'guide_adv',\n\t\t\t'guide_direct',\n\t\t\t'guide_portal'\n\t\t]);\n\t\tif (availableSources.has(source))\n\t\t{\n\t\t\tajax.runAction(\n\t\t\t\t'bitrix:tasks.scrum.info.saveScrumStart',\n\t\t\t\t{\n\t\t\t\t\tdata: {},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\tscrum: 'Y',\n\t\t\t\t\t\taction: 'scrum_start',\n\t\t\t\t\t\tsource: source\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tshowHideBlock(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst containerNode = params.container;\n\t\tconst blockNode = params.block;\n\t\tconst show = !!params.show;\n\n\t\tif (\n\t\t\t!Type.isDomNode(containerNode)\n\t\t\t|| !Type.isDomNode(blockNode)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isUndefined(this.animationList[blockNode.id])\n\t\t\t&& !Type.isNull(this.animationList[blockNode.id])\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.animationList[blockNode.id] = null;\n\n\t\tconst maxHeight = parseInt(blockNode.offsetHeight);\n\t\tconst duration = (!Type.isUndefined(params.duration) && parseInt(params.duration) > 0 ? parseInt(params.duration) : 0);\n\n\t\tif (show)\n\t\t{\n\t\t\tcontainerNode.style.display = 'block';\n\t\t}\n\n\t\tif (duration > 0)\n\t\t{\n\t\t\tif (Type.isStringFilled(blockNode.id))\n\t\t\t{\n\t\t\t\tthis.animationList[blockNode.id] = true;\n\t\t\t}\n\n\t\t\tBX.delegate((new BX.easing({\n\t\t\t\tduration: duration,\n\t\t\t\tstart: {\n\t\t\t\t\theight: (show ? 0 : maxHeight),\n\t\t\t\t\topacity: (show ? 0 : 100),\n\t\t\t\t},\n\t\t\t\tfinish: {\n\t\t\t\t\theight: (show ? maxHeight : 0),\n\t\t\t\t\topacity: (show ? 100 : 0),\n\t\t\t\t},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tcontainerNode.style.maxHeight = `${state.height}px`;\n\t\t\t\t\tcontainerNode.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tif (Type.isStringFilled(blockNode.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.animationList[blockNode.id] = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t!Type.isUndefined(params.callback)\n\t\t\t\t\t\t&& Type.isFunction(params.callback.complete)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontainerNode.style.maxHeight = '';\n\t\t\t\t\t\tcontainerNode.style.opacity = '';\n\t\t\t\t\t\tparams.callback.complete();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})).animate(), this);\n\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams.callback.complete();\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport {\n\tWorkgroupForm,\n\tTeamManager as WorkgroupFormTeamManager,\n\tUFManager as WorkgroupFormUFManager,\n}\n"],"names":["Util","expandSwitchers","document","querySelectorAll","forEach","switcher","addEventListener","e","targetId","currentTarget","getAttribute","target","getElementById","switcherWrapper","firstElementChild","offsetHeight","style","height","classList","add","scrollToTarget","elementRealTop","getBoundingClientRect","top","time","currentTime","scrollBySvs","window","scrollBy","setTimeout","removeEventListener","adjustHeight","removeProperty","remove","dropdownAreaList","dropdownArea","dropdownItemsData","getDropdownItems","items","Object","entries","key","value","push","text","onclick","dropdownMenu","close","setDropdownValue","querySelector","setInputValue","neighbourDropdownArea","contains","parentNode","Type","isDomNode","BX","PopupMenuWindow","autoHide","cacheable","bindElement","width","offsetWidth","closeByEsc","animation","params","show","node","containerNode","itemValue","innerText","itemKey","JSON","parse","isPlainObject","isChecked","projectCheckboxNode","setCheckedValue","recalcNameInput","inputNode","placeholderText","Loc","getMessage","formInstance","WorkgroupForm","getInstance","projectTypes","selectedProjectType","isStringFilled","SCRUM_PROJECT","PROJECT","placeholder","type","checked","result","container","selectorClass","selector","cssClass","selectorActive","selectorDisabled","selectedItems","multiple","isBoolean","inputContainerNodeId","inputNodeName","isArray","inputContainerNode","Dom","item","prefix","entityId","appendChild","Tag","render","id","ConfidentialitySelector","firstItemSelected","getItems","unselectAllSelectorItems","getContainer","selectSelectorItem","recalcForm","selectedConfidentialityType","confidentialityType","selectItem","bindEvents","subscribe","onSwitchExtranet","event","data","getData","unselectAll","select","disableAll","enable","enableAll","accessCode","disableAllSelectorItems","enableAllSelectorItems","enableSelectorItem","Scrum","isScrumProject","createHiddenInputs","showScrumBlocks","landingCheckbox","disabled","toggleFeatures","removeHiddenInputs","hideScrumBlocks","scrumBlock","moderatorsBlock","moderatorsSwitch","ownerBlock","forms","create","attrs","name","input","isScrum","featuresNode","featuresCheckboxNode","insertBefore","hiddenInput","Avatar","confirmPopup","componentName","isUndefined","signedParameters","groupId","parseInt","selectorNode","imageNode","typeInputNode","removeNode","recalc","avatarEditor","AvatarEditor","enableCamera","backgroundImage","showConfirmPopup","deletePhoto","bind","clearType","setType","EventEmitter","getCompatData","file","formData","FormData","append","changePhoto","getFileId","hidden","selected","loader","showLoader","size","ajax","runComponentAction","mode","then","response","fileId","fileUri","encodeURI","hideLoader","showErrorPopup","message","errors","typeItemNode","avatarType","isNull","Loader","hasOwnProperty","hide","clean","error","Popup","offsetLeft","offsetTop","draggable","bindOnResize","closeIcon","content","events","confirmCallback","onPopupClose","destroy","buttons","Button","click","button","setWaiting","DateCorrector","culture","getElementsByName","Event","startChanged","start","end","startDate","Date","endDate","defaultOffset","newEndDate","getTime","newStartDate","date","toString","length","parsedValue","parseDate","Math","floor","timeStamp","format","shortDateFormat","ThemePicker","theme","draw","previewImageNode","getNode","open","titleNode","deleteNode","previewImage","backgroundColor","previewColor","innerHTML","title","Intranet","Bitrix24","Singleton","showDialog","preventDefault","Tags","containerNodeId","hiddenFieldNode","hiddenFieldId","tagSelector","EntityTagSelector","addButtonCaption","addButtonCaptionMore","dialogOptions","compactView","preload","context","searchTabOptions","stubOptions","subtitle","arrow","entities","options","searchOptions","allowCreateItem","footerOptions","label","recalcinputValue","getTarget","getSelectedItems","Promise","resolve","searchQuery","getQuery","toLowerCase","dialog","tagsList","split","tag","addItem","tabs","renderTo","join","TypePresetSelector","selectors","projectType","wizardManager","setProjectType","FieldsManager","stepsCount","checkAll","checkStep","currentStep","step","errorDataList","mandatoryFieldsByStep","fieldData","fieldNode","tagName","errorText","checkField","bindNode","bindNodeId","stepData","concat","isFunction","condition","fieldType","trim","empty","hiddenNode","errorData","alertManager","showAlert","scrumManager","Buttons","submitButton","submitButtonClickHandler","backButton","ButtonManager","createFromNode","isDisabled","confidentialityTypes","showCurrentStep","cancelButton","currentSlider","SidePanel","Instance","getSliderByWindow","BaseEvent","compatData","getEvent","emit","url","location","hideAllAlerts","check","filter","showError","submitFunction","submitForm","disable","buttonNode","setDisabled","Wizard","processedStep","step1BackgroudNode","step1Backgroud","bodyContainer","breadcrumbsContainer","bodyItem","activeBodyItem","breadcrumbsItem","activeBreadcrumbsItem","getFirstStepNumber","hideButton","buttonsInstance","showButton","createdGroupId","tabInputNode","tabGroupIdNode","AlertManager","errorContainerId","globalErrorContainer","nodeAlerts","Map","targetNode","textAlert","Alert","color","Color","DANGER","animate","set","nextSibling","setText","scrollTo","getPosition","behavior","clear","TeamManager","instance","ownerSelector","scrumMasterSelector","moderatorsSelector","usersSelector","ownerOptions","scrumMasterOptions","moderatorsOptions","usersOptions","ownerContainerNode","scrumMasterContainerNode","moderatorsContainerNode","usersContainerNode","isCurrentUserAdmin","extranetInstalled","allowExtranet","buildOwnerSelector","buildScrumMasterSelector","buildModeratorsSelector","buildUsersSelector","selectorOptions","TagSelector","selectorId","contextList","owner","preselectedItems","onLoad","onOwnerSelect","intranetUsersOnly","inviteEmployeeLink","inviteExtranetLink","checkWorkgroupWhenInvite","selectMode","scrumMaster","onScrumMasterSelect","moderators","onModeratorsSelect","users","onUsersSelect","enableSelectDepartment","includes","getDialog","loadState","recalcSelectorByExtranetSwitched","getContext","getEntityId","getEntityType","recalcInputValue","map","getId","initialFocus","getAddButtonLink","hintNode","showDepartmentHint","departmentFound","find","FeaturesManager","editButton","featureNode","closest","textNode","UFManager","mandatoryUFList","ufData","setEventNamespace","userSelector","lastAction","animationList","selectedTypeCode","config","avatarUploaderId","themePickerData","projectOptions","focus","init","makeAdditionalCustomizationForm","groupDescriptionNode","groupNameNode","initExpandSwitches","initDropdowns","expandableSettingsNodeId","UI","Hint","saveScrumAnalyticData","getTopSlider","getWindow","sliderInstance","getUrl","extranetCheckboxNode","switchExtranet","visibleCheckboxNode","switchNotVisible","recalcFormPartProject","recalcFormDependencies","openedCheckboxNode","OPENED","VISIBLE","getCheckedValue","openedBlock","visibleBlock","openedNode","actionUrl","action","groupIdNode","b24statAction","Uri","addParam","groupType","formElements","elements","GROUP_PROJECT","IS_EXTRANET_GROUP","GROUP_OPENED","b24statType","analyticsLabel","scrum","showWaitSubmitButton","submitAjax","method","dataType","PROJECT_OPTIONS","onsuccess","ERROR","warningText","WARNING","WIZARD_STEP_PROCESSED","recalcAfterSubmit","CREATED_GROUP_ID","SUCCESSFULL_USERS_ID","userId","Number","usersSelectorDialog","deselect","postMessageAll","code","MESSAGE","URL","href","ACTION","eventData","GROUP","group","createdGroupsData","SELECTOR_GROUPS","projects","refresh","bindingFound","anchorRules","rule","match","onfailure","source","getQueryParam","availableSources","Set","has","runAction","blockNode","block","maxHeight","duration","display","delegate","easing","opacity","finish","transition","makeEaseOut","transitions","quart","state","complete","callback"],"mappings":"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"}