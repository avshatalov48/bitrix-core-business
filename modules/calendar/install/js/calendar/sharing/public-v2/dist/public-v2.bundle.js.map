{"version":3,"file":"public-v2.bundle.js","sources":["../src/components/layout/bind-show-on-hover.js","../src/components/layout/members-list.js","../src/components/welcome.js","../src/components/calendar/day.js","../src/components/calendar/calendar.js","../src/components/slot-selector/base.js","../src/components/slot-selector/widget-date.js","../src/components/slot-selector/form/form.js","../src/components/slot-selector/empty-state/empty-state.js","../src/components/slot-selector/empty-state/access-denied.js","../src/components/slot-selector/slot-list/slot-item.js","../src/components/slot-selector/slot-list/slot-list.js","../src/components/slot-selector/event/event-layout.js","../src/components/slot-selector/event/event.js","../src/components/slot-selector/slot-selector.js","../src/public.js"],"sourcesContent":["import { Event } from 'main.core';\nimport { Menu, Popup } from 'main.popup';\n\nexport default function bindShowOnHover(popup: Menu|Popup)\n{\n\tif (popup instanceof Menu)\n\t{\n\t\tpopup = popup.getPopupWindow();\n\t}\n\n\tconst bindElement = popup.bindElement;\n\tconst container = popup.getPopupContainer();\n\n\tlet hoverElement = null;\n\n\tconst closeMenuHandler = () => {\n\t\tsetTimeout(() => {\n\t\t\tif (!container.contains(hoverElement) && !bindElement.contains(hoverElement))\n\t\t\t{\n\t\t\t\tpopup.close();\n\t\t\t}\n\t\t}, 100);\n\t};\n\tconst showMenuHandler = () => {\n\t\tsetTimeout(() => {\n\t\t\tif (bindElement.contains(hoverElement))\n\t\t\t{\n\t\t\t\tpopup.show();\n\t\t\t}\n\t\t}, 300);\n\t};\n\tconst clickHandler = () => {\n\t\tif (!popup.isShown())\n\t\t{\n\t\t\tpopup.show();\n\t\t}\n\t};\n\n\tEvent.bind(document, 'mouseover', (event) => {\n\t\thoverElement = event.target;\n\t});\n\tEvent.bind(bindElement, 'mouseenter', showMenuHandler);\n\tEvent.bind(bindElement, 'mouseleave', closeMenuHandler);\n\tEvent.bind(container, 'mouseleave', closeMenuHandler);\n\tEvent.bind(bindElement, 'click', clickHandler);\n\n\tlet popupWidth = popup.getPopupContainer().offsetWidth;\n\tlet elementWidth = popup.bindElement.offsetWidth;\n\tconst angleLeft = Popup.getOption('angleMinBottom');\n\tconst handleScroll = () => {\n\t\tpopup.adjustPosition();\n\t\tif (popup.angle)\n\t\t{\n\t\t\tpopup.setAngle({ offset: popupWidth / 2 + angleLeft });\n\t\t}\n\t};\n\n\tpopup.subscribeFromOptions({\n\t\tonShow: () => {\n\t\t\tpopupWidth = popup.getPopupContainer().offsetWidth;\n\t\t\telementWidth = popup.bindElement.offsetWidth;\n\n\t\t\tpopup.setOffset({ offsetLeft: elementWidth / 2 - popupWidth / 2 });\n\t\t\tpopup.adjustPosition();\n\n\t\t\tif (popup.angle)\n\t\t\t{\n\t\t\t\tpopup.setAngle({ offset: popupWidth / 2 + angleLeft });\n\t\t\t}\n\n\t\t\tdocument.addEventListener('scroll', handleScroll, true);\n\t\t},\n\t\tonAfterPopupShow: () => {\n\t\t\tconst left = popup.bindElement.getBoundingClientRect().left + elementWidth / 2 - popupWidth / 2;\n\t\t\tif (left < 0 || left + popupWidth > window.innerWidth)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpopup.getPopupContainer().style.left = left + 'px';\n\t\t\tif (popup.angle)\n\t\t\t{\n\t\t\t\tpopup.angle.element.style.marginLeft = popupWidth / 2 - 16 + 'px';\n\t\t\t}\n\t\t},\n\t\tonClose: () => {\n\t\t\tdocument.removeEventListener('scroll', handleScroll, true);\n\t\t},\n\t});\n}","import { Loc, Tag, Text, Type } from 'main.core';\nimport 'ui.icon-set.actions';\nimport { MenuManager } from 'main.popup';\nimport bindShowOnHover from './bind-show-on-hover';\n\nexport type Member = {\n\tname: string,\n\tlastName: string,\n\tavatar: string,\n\tisOwner: boolean,\n}\n\ntype MembersListParams = {\n\tmembers: Member[],\n\tavatarSize: number,\n\tclassName: string,\n\ttextClassName: string,\n\tallAttendees: boolean,\n\tmaxAvatarsCount: number,\n};\n\nexport class MembersList\n{\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tavatarItems: HTMLElement,\n\t};\n\n\t#params: MembersListParams;\n\t#members: Member[];\n\n\tconstructor(params: MembersListParams)\n\t{\n\t\tthis.#layout = {};\n\n\t\tthis.#params = params;\n\t\tthis.#members = params.members;\n\t}\n\n\trender(): HTMLElement|string\n\t{\n\t\tif (!Type.isArrayFilled(this.#members))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div class=\"${this.#params.className}\">\n\t\t\t\t<div class=\"${this.#params.textClassName}\">\n\t\t\t\t\t${this.#getMembersTitle()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub-line-avatar-container\" style=\"--ui-icon-size: ${this.#params.avatarSize}px\">\n\t\t\t\t\t${this.#renderAvatarItems()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst menu = MenuManager.create({\n\t\t\tid: 'calendar-pub-welcome-more-avatar-popup' + Date.now(),\n\t\t\tbindElement: this.#layout.avatarItems,\n\t\t\tclassName: 'calendar-pub-users-popup',\n\t\t\titems: this.#members.map((member) => ({\n\t\t\t\thtml: Tag.render`\n\t\t\t\t\t<div class=\"calendar-pub-users-popup-avatar-container\">\n\t\t\t\t\t\t${this.#renderAvatar(member, 'calendar-pub-users-popup-avatar')}\n\t\t\t\t\t\t<div class=\"calendar-pub-users-popup-avatar-text\">\n\t\t\t\t\t\t\t<span class=\"calendar-pub-users-popup-avatar-text-name\">\n\t\t\t\t\t\t\t\t${Text.encode(`${member.name} ${member.lastName}`.trim())}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"calendar-pub-users-popup-avatar-text-you\">\n\t\t\t\t\t\t\t\t${member.isOwner ? Loc.getMessage('CALENDAR_SHARING_MEETING_YOU_LABEL') : ''}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t})),\n\t\t\tmaxHeight: 300,\n\t\t\tmaxWidth: 300,\n\t\t});\n\n\t\tbindShowOnHover(menu);\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#getMembersTitle(): string\n\t{\n\t\tif (this.#params.allAttendees)\n\t\t{\n\t\t\treturn Loc.getMessage('CALENDAR_SHARING_MEETING_ATTENDEES');\n\t\t}\n\n\t\treturn Loc.getMessage('CALENDAR_SHARING_MEETING_HAS_MORE_USERS');\n\t}\n\n\t#renderAvatarItems(): HTMLElement\n\t{\n\t\tconst maxAvatarsCount = this.#params.maxAvatarsCount ?? 4;\n\t\tconst showMoreIcon = this.#members.length > maxAvatarsCount;\n\t\tconst avatarsCount = showMoreIcon ? maxAvatarsCount - 1 : maxAvatarsCount;\n\t\tconst avatarClassName = 'calendar-pub-line-avatar';\n\n\t\tthis.#layout.avatarItems = Tag.render`\n\t\t\t<div class=\"calendar-pub-line-avatars\">\n\t\t\t\t${this.#members.slice(0, avatarsCount).map((member) => this.#renderAvatar(member, avatarClassName))}\n\t\t\t\t${showMoreIcon ? this.#renderMoreAvatar() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.avatarItems;\n\t}\n\n\t#renderMoreAvatar(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"ui-icon ui-icon-common-user calendar-pub-line-avatar calendar-pub-line-avatar-more-container\">\n\t\t\t\t<div class=\"ui-icon-set --more calendar-pub-line-avatar-more\"></div>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#renderAvatar(member, className = ''): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"ui-icon ui-icon-common-user ${className}\">\n\t\t\t\t<i style=\"${this.#hasAvatar(member) ? `background-image: url('${member.avatar}')` : ''}\"></i>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#hasAvatar(member): boolean\n\t{\n\t\treturn Type.isStringFilled(member.avatar) && member.avatar !== '/bitrix/images/1.gif';\n\t}\n}","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport 'ui.icons.b24';\nimport { Member, MembersList } from './layout/members-list';\n\ntype WelcomeOptions = {\n\towner: any,\n\tlink: any,\n\tcurrentLang: string,\n\tmembers: Member[],\n}\n\nexport default class Welcome\n{\n\t#owner;\n\t#link;\n\t#currentLang;\n\t#name;\n\t#lastName;\n\t#photo;\n\t#layout;\n\t#members;\n\n\tconstructor(options: WelcomeOptions)\n\t{\n\t\tthis.#owner = options.owner || null;\n\t\tthis.#link = options.link || null;\n\t\tthis.#currentLang = options.currentLang || null;\n\t\tthis.#name = this.#owner.name || null;\n\t\tthis.#lastName = this.#owner.lastName || null;\n\t\tthis.#photo = this.#owner.photo || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbutton: null,\n\t\t\tlabel: null,\n\t\t};\n\t\tthis.#members = options.members;\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus !== 'viewed'\n\t\t\t&& this.#link.lastStatus !== 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('notViewed');\n\t\t\tthis.#link.lastStatus = 'notViewed';\n\t\t}\n\t}\n\n\tdisableButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--disabled');\n\t}\n\n\tenableButton()\n\t{\n\t\tDom.removeClass(this.#layout.button, '--disabled');\n\t}\n\n\thideButton()\n\t{\n\t\tDom.addClass(this.#layout.button, '--hidden');\n\t}\n\n\thandleWelcomePageButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.button, '--disabled'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.#link\n\t\t\t&& this.#link.type === 'crm_deal'\n\t\t\t&& this.#link.active === true\n\t\t\t&& this.#link.lastStatus === 'notViewed'\n\t\t)\n\t\t{\n\t\t\tthis.#handleTimelineNotify('viewed');\n\t\t\tthis.#link.lastStatus = 'viewed';\n\t\t}\n\n\t\tthis.disableButton();\n\t\tEventEmitter.emit('showSlotSelector', this);\n\t}\n\n\t#handleTimelineNotify(mode)\n\t{\n\t\tBX.ajax.runAction('calendar.api.sharingajax.handleTimelineNotify', {\n\t\t\tdata: {\n\t\t\t\tlinkHash: this.#link.hash,\n\t\t\t\tentityId: this.#link.entityId,\n\t\t\t\tentityType: this.#link.type,\n\t\t\t\tnotifyType: mode,\n\t\t\t},\n\t\t});\n\t}\n\n\t#getNodeButton(): HTMLElement\n\t{\n\t\tif (!this.#layout.button)\n\t\t{\n\t\t\tthis.#layout.button = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.button, 'click', () => {\n\t\t\t\tthis.handleWelcomePageButtonClick();\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe('hideSlotSelector', this.enableButton.bind(this));\n\t\t}\n\n\t\treturn this.#layout.button;\n\t}\n\n\t#getNodeLabel()\n\t{\n\t\tif (!this.#layout.label)\n\t\t{\n\t\t\tthis.#layout.label = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__block-label\"></div>\n\t\t\t`;\n\n\t\t\tif (this.#currentLang === 'ru')\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.label, '--ru');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.label;\n\t}\n\n\tsetAccessDenied()\n\t{\n\t\tthis.#layout.info = this.#getNodeInfo(true);\n\t}\n\n\t#getNodeInfo(accessDenied = false)\n\t{\n\t\tif (!this.#layout.info)\n\t\t{\n\t\t\tthis.#layout.infoTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-title calendar-pub__welcome-info_title\"></div>\n\t\t\t`;\n\t\t\tthis.#layout.infoSubTitle = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__typography-s calendar-pub__welcome-info_subtitle\"></div>\n\t\t\t`;\n\n\t\t\tthis.#layout.info = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__welcome-info\">\n\t\t\t\t\t${this.#layout.infoTitle}\n\t\t\t\t\t${this.#layout.infoSubTitle}\n\t\t\t\t\t${this.#renderAvatarsSection(this.#members)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tlet title = Loc.getMessage('CALENDAR_SHARING_MY_FREE_SLOTS');\n\t\tlet subTitle = Loc.getMessage('CALENDAR_SHARING_YOU_CAN_CHOOSE_FREE_MEETING_TIME');\n\t\tif (accessDenied)\n\t\t{\n\t\t\ttitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED');\n\t\t\tsubTitle = Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO');\n\t\t}\n\n\t\tthis.#layout.infoTitle.innerText = title;\n\t\tthis.#layout.infoSubTitle.innerText = subTitle;\n\n\t\treturn this.#layout.info;\n\t}\n\n\t#renderAvatarsSection(members)\n\t{\n\t\treturn new MembersList({\n\t\t\tclassName: 'calendar-pub-welcome-avatar-section-container',\n\t\t\ttextClassName: 'calendar-pub-ui__typography-xs-uppercase',\n\t\t\tavatarSize: 36,\n\t\t\tmembers,\n\t\t}).render();\n\t}\n\n\trender()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__block --welcome\">\n\t\t\t\t${this.#getNodeLabel()}\n\t\t\t\t<div class=\"calendar-pub__welcome\">\n\t\t\t\t\t<div class=\"calendar-pub__welcome-user\">\n\t\t\t\t\t\t<div class=\"calendar-pub__welcome-userpic ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${this.#photo ? `style=\"background-image: url(${encodeURI(this.#photo)})\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">\n\t\t\t\t\t\t\t${this.#name || ''} ${this.#lastName || ''} \n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__block-separator\"></div>\n\t\t\t\t\t${this.#getNodeInfo()}\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButton()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\ntype DayOptions = {\n\tvalue: number,\n\tnotCurrentMonth: boolean,\n\ttoday: boolean,\n\tselected: boolean,\n\tweekend: boolean,\n\tenableBooking: boolean,\n\tslots: Object,\n}\n\nexport default class Day\n{\n\t#layout;\n\t#value;\n\t#notCurrentMonth;\n\t#today;\n\t#selected;\n\t#weekend;\n\t#slots;\n\t#enableBooking;\n\n\tconstructor(options: DayOptions)\n\t{\n\t\tthis.#value = options.value || null;\n\t\tthis.#notCurrentMonth = options.notCurrentMonth || null;\n\t\tthis.#today = options.today || null;\n\t\tthis.#slots = options.slots || null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t};\n\t\tthis.#selected = options.selected || null;\n\t\tthis.#weekend = options.weekend || null;\n\t\tthis.#enableBooking = options.enableBooking || null;\n\n\t\tif (this.#selected)\n\t\t{\n\t\t\tthis.select();\n\t\t}\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tgetDay()\n\t{\n\t\treturn this.#value;\n\t}\n\n\tisEnableBooking()\n\t{\n\t\treturn this.#enableBooking;\n\t}\n\n\tselect()\n\t{\n\t\tthis.highlight();\n\t\tEventEmitter.emit('switchSlots', {\n\t\t\tslots: this.#slots,\n\t\t});\n\t}\n\n\thighlight()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectDate', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-col --day\">${this.#value}</div>\n\t\t\t`;\n\n\t\t\tif (this.#notCurrentMonth)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--not-current-month');\n\t\t\t}\n\n\t\t\tif (this.#weekend)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--weekend');\n\t\t\t}\n\n\t\t\tif (this.#enableBooking)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--enable-booking');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { Tag, Loc, Type, Dom, Event, Browser } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\nimport Day from './day';\nimport { DateTimeFormat } from 'main.date';\nimport { MenuManager } from 'main.popup';\n\nexport default class Calendar\n{\n\t#userIds;\n\t#accessibility;\n\t#layout;\n\t#currentMonth;\n\t#currentYear;\n\t#nowTime;\n\t#months;\n\t#selectedDay;\n\t#monthsSlotsMap;\n\t#timezoneOffsetUtc;\n\t#selectedTimezoneOffsetUtc;\n\t#currentMonthIndex;\n\t#currentDayNumber;\n\t#timezoneList;\n\t#calendarSettings;\n\t#rule;\n\t#selectedTimezoneId;\n\t#selectedTimezoneNode;\n\t#config;\n\t#loc;\n\t#timeZonePopup;\n\n\tconstructor(options)\n\t{\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tmonthWrapper: null,\n\t\t\ttimezoneWrapper: null,\n\t\t\tmonth: null,\n\t\t\tcurrentMonth: null,\n\t\t\tprevNav: null,\n\t\t\tnextNav: null,\n\t\t\tdaysOfWeek: null,\n\t\t\tnavigation: null,\n\t\t\tback: null,\n\t\t};\n\n\t\tthis.#userIds = options.userIds;\n\t\tthis.#accessibility = options.accessibility;\n\t\tthis.#timezoneList = options.timezoneList;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\t\tthis.#rule = options.rule;\n\n\t\tthis.#nowTime = new Date();\n\t\tthis.#currentMonthIndex = 0;\n\t\tthis.#currentDayNumber = 1;\n\t\tthis.#selectedTimezoneId = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';\n\t\tthis.#currentMonth = this.#nowTime.getMonth();\n\t\tthis.#currentYear = this.#nowTime.getFullYear();\n\t\tthis.#timezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#selectedTimezoneOffsetUtc = this.#nowTime.getTimezoneOffset();\n\t\tthis.#months = [];\n\t\tthis.#monthsSlotsMap = [];\n\n\t\tthis.#config = {\n\t\t\tslotSize: this.#rule.slotSize,\n\t\t\tfreeTime: {},\n\t\t\tstepSize: 30,\n\t\t\tweekHolidays: [6, 0],\n\t\t\tweekStart: 1,\n\t\t};\n\t\tthis.#loc = {\n\t\t\tweekdays: Util.getWeekdaysLoc(),\n\t\t};\n\t\tthis.#timeZonePopup = null;\n\n\t\tthis.#initConfig();\n\t\tthis.#initCurrentMonthSlots();\n\t\tthis.#bindEvents();\n\n\t\t// preload the next month's accessibilities\n\t\tconst nextYear = this.#getNextYear();\n\t\tconst nextMonth = this.#getNextMonth();\n\t\tthis.#loadMonthAccessibility(nextYear, nextMonth, false);\n\n\t\tsetInterval(this.#incrementTime.bind(this), 15000);\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectDate', (event) => {\n\t\t\tconst newSelectedDay = event.data;\n\t\t\tif (this.#selectedDay !== newSelectedDay)\n\t\t\t{\n\t\t\t\tthis.#selectedDay?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedDay = newSelectedDay;\n\t\t\tthis.#currentDayNumber = this.#selectedDay.getDay();\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', async (event) => {\n\t\t\tif (event.data.state === 'created' || event.data.state === 'not-created')\n\t\t\t{\n\t\t\t\tawait this.updateEventSlotsList();\n\t\t\t\tthis.highlightMonthDay();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('onDeleteEvent', async () => {\n\t\t\tawait this.updateEventSlotsList();\n\t\t});\n\n\t\tEventEmitter.subscribe('onCreateAnotherEventButtonClick', () => {\n\t\t\tthis.selectFirstAvailableDay();\n\t\t});\n\t}\n\n\t#incrementTime()\n\t{\n\t\tthis.#nowTime = new Date();\n\n\t\tconst timezoneNode = this.#getNodeTimeZone();\n\t\tDom.clean(this.#getNodeTimezoneWrapper());\n\t\tDom.append(timezoneNode, this.#getNodeTimezoneWrapper());\n\t}\n\n\t#initConfig()\n\t{\n\t\tif (this.#calendarSettings.weekHolidays)\n\t\t{\n\t\t\tthis.#config.weekHolidays = this.#calendarSettings.weekHolidays.map(\n\t\t\t\t(weekDay) => Util.getIndByWeekDay(weekDay),\n\t\t\t);\n\t\t}\n\n\t\tif (this.#calendarSettings.yearHolidays)\n\t\t{\n\t\t\tthis.#config.yearHolidays = this.#calendarSettings.yearHolidays;\n\t\t}\n\n\t\tif (this.#calendarSettings.weekStart)\n\t\t{\n\t\t\tthis.#config.weekStart = Util.getIndByWeekDay(this.#calendarSettings.weekStart);\n\t\t\tthis.#loc.weekdays.push(...this.#loc.weekdays.splice(0, this.#config.weekStart));\n\t\t}\n\n\t\tfor (const range of this.#rule.ranges)\n\t\t{\n\t\t\tfor (const weekday of range.weekdays)\n\t\t\t{\n\t\t\t\tthis.#config.freeTime[weekday] ??= [];\n\t\t\t\tthis.#config.freeTime[weekday].push({\n\t\t\t\t\tfrom: parseInt(range.from, 10),\n\t\t\t\t\tto: parseInt(range.to, 10),\n\t\t\t\t});\n\n\t\t\t\tconst [intersected, notIntersected] = this.#separate((interval) => this.#doIntervalsIntersect(\n\t\t\t\t\tinterval.from,\n\t\t\t\t\tinterval.to,\n\t\t\t\t\tparseInt(range.from, 10),\n\t\t\t\t\tparseInt(range.to, 10),\n\t\t\t\t), this.#config.freeTime[weekday]);\n\n\t\t\t\tif (intersected.length > 0)\n\t\t\t\t{\n\t\t\t\t\tconst from = Math.min(...intersected.map(interval => interval.from));\n\t\t\t\t\tconst to = Math.max(...intersected.map(interval => interval.to));\n\n\t\t\t\t\tthis.#config.freeTime[weekday] = [...notIntersected, { from, to }];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst timezoneOffset = Util.getTimeZoneOffset(this.#selectedTimezoneId);\n\t\tconst serverOffset = parseInt(this.#calendarSettings.serverOffset, 10);\n\t\tconst offset = serverOffset + timezoneOffset;\n\t\tfor (const weekday in this.#config.freeTime)\n\t\t{\n\t\t\tthis.#config.freeTime[weekday] = this.#config.freeTime[weekday].map((range) => {\n\t\t\t\treturn {\n\t\t\t\t\tfrom: range.from - offset,\n\t\t\t\t\tto: range.to - offset,\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#timezoneList[this.#selectedTimezoneId])\n\t\t{\n\t\t\tthis.#selectedTimezoneId = 'UTC';\n\t\t}\n\t}\n\n\t#separate(take, array)\n\t{\n\t\treturn array.reduce(([t, f], e) => (take(e) ? [[...t, e], f] : [t, [...f, e]]), [[], []]);\n\t}\n\n\t#initCurrentMonthSlots()\n\t{\n\t\tthis.#calculateDateTimeSlots(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\n\t\tconst month = this.#createMonth(this.#nowTime.getFullYear(), this.#nowTime.getMonth());\n\t\tthis.#months.push(month);\n\t}\n\n\t#calculateDateTimeSlots(year, month)\n\t{\n\t\tconst map = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = `${month + 1}.${year}`;\n\t\tconst nowTimestamp = this.#nowTime.getTime();\n\t\tconst timezoneOffset = (this.#selectedTimezoneOffsetUtc - this.#timezoneOffsetUtc) * (-60) * 1000;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst currentDate = new Date(year, month, dayIndex);\n\n\t\t\tif (this.#isYearHoliday(currentDate))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst freeTime = this.#config.freeTime[currentDate.getDay()];\n\t\t\tif (Type.isUndefined(freeTime))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const range of freeTime)\n\t\t\t{\n\t\t\t\tconst from = new Date(year, month, dayIndex, Math.floor(range.from / 60), range.from % 60);\n\t\t\t\tconst to = new Date(year, month, dayIndex, Math.floor(range.to / 60), range.to % 60);\n\n\t\t\t\tconst dayAccessibility = this.#accessibility[accessibilityArrayKey].filter((event) => {\n\t\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\t\tfrom.getTime(),\n\t\t\t\t\t\tto.getTime(),\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\t\twhile (from.getTime() < to.getTime())\n\t\t\t\t{\n\t\t\t\t\tconst slotStart = from.getTime();\n\t\t\t\t\tconst slotEnd = slotStart + this.#config.slotSize * 60 * 1000;\n\n\t\t\t\t\tif (slotEnd > to.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst slotAccessibility = dayAccessibility.filter((event) => {\n\t\t\t\t\t\tconst parseUTC = !event.isFullDay;\n\t\t\t\t\t\treturn this.#doIntervalsIntersect(\n\t\t\t\t\t\t\tBX.parseDate(event.from, parseUTC).getTime(),\n\t\t\t\t\t\t\tBX.parseDate(event.to, parseUTC).getTime(),\n\t\t\t\t\t\t\tslotStart,\n\t\t\t\t\t\t\tslotEnd,\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tconst available = slotAccessibility.length === 0 && slotStart > nowTimestamp;\n\t\t\t\t\tif (available)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst timeFrom = new Date(slotStart + timezoneOffset);\n\t\t\t\t\t\tconst timeTo = new Date(timeFrom.getTime() + (slotEnd - slotStart));\n\t\t\t\t\t\tconst dateIndex = timeFrom.getDate();\n\t\t\t\t\t\tmap[dateIndex] ??= [];\n\t\t\t\t\t\tif (timeFrom.getMonth() === month)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmap[dateIndex].push({ timeFrom, timeTo });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfrom.setTime(from.getTime() + this.#config.stepSize * 60 * 1000);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.#monthsSlotsMap[accessibilityArrayKey] = map;\n\t}\n\n\t#doIntervalsIntersect(from1, to1, from2, to2)\n\t{\n\t\tconst startsInside = from2 <= from1 && from1 < to2;\n\t\tconst endsInside = from2 < to1 && to1 <= to2;\n\t\tconst startsBeforeEndsAfter = from1 <= from2 && to1 >= to2;\n\n\t\treturn startsInside || endsInside || startsBeforeEndsAfter;\n\t}\n\n\t#createMonth(year, month)\n\t{\n\t\treturn {\n\t\t\tyear,\n\t\t\tmonth,\n\t\t\tcurrentTimezoneOffset: this.#selectedTimezoneOffsetUtc,\n\t\t\tname: this.#getMonthName(month),\n\t\t\tdays: this.#getMonthDays(year, month),\n\t\t};\n\t}\n\n\tasync updateEventSlotsList()\n\t{\n\t\tconst month = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = month.year;\n\t\tconst currentMonth = month.month + 1;\n\n\t\tawait this.#loadMonthAccessibility(currentYear, currentMonth);\n\n\t\tthis.#reCreateCurrentMonth();\n\t}\n\n\t#reCreateCurrentMonth()\n\t{\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\t\tthis.#updateCalendar();\n\t}\n\n\tasync #createNextMonth()\n\t{\n\t\tthis.nextMonthCreating = true;\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = currentMonth.year;\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\tconst nextMonthIndex = (currentMonthIndex + 1) % 12;\n\t\tconst nextYear = currentYear + Math.floor((currentMonthIndex + 1) / 12);\n\t\tconst nextMonth = nextMonthIndex + 1;\n\n\t\tawait this.#loadMonthAccessibility(nextYear, nextMonth);\n\n\t\tthis.#calculateDateTimeSlots(nextYear, nextMonthIndex);\n\n\t\tconst month = this.#createMonth(nextYear, nextMonthIndex);\n\t\tthis.#months.push(month);\n\t\tthis.nextMonthCreating = false;\n\t}\n\n\t#getNextMonth()\n\t{\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\tconst nextMonthIndex = (currentMonthIndex + 1) % 12;\n\t\treturn nextMonthIndex + 1;\n\t}\n\n\t#getNextYear()\n\t{\n\t\tconst currentMonth = this.#months[this.#currentMonthIndex];\n\t\tconst currentYear = currentMonth.year;\n\t\tconst currentMonthIndex = currentMonth.month;\n\n\t\treturn currentYear + Math.floor((currentMonthIndex + 1) / 12);\n\t}\n\n\tasync #loadMonthAccessibility(year, month, preloadNextMonth = true)\n\t{\n\t\tconst arrayKey = `${month}.${year}`;\n\t\tconst firstMonthDay = new Date(year, month - 1, 1);\n\t\tconst lastMonthDay = new Date(year, month, 0, 23, 59);\n\n\t\tif (!this.#accessibility[arrayKey])\n\t\t{\n\t\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getUsersAccessibility', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserIds: this.#userIds,\n\t\t\t\t\ttimestampFrom: firstMonthDay.getTime(),\n\t\t\t\t\ttimestampTo: lastMonthDay.getTime(),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.#accessibility[arrayKey] = response.data;\n\t\t}\n\n\t\tif (preloadNextMonth === false)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst nextMonthIndex = (month) % 12;\n\t\tconst nextYear = year + Math.floor((month) / 12);\n\t\tconst nextMonth = nextMonthIndex + 1;\n\n\t\tthis.#loadMonthAccessibility(nextYear, nextMonth, false);\n\t}\n\n\t#getMonthName(month)\n\t{\n\t\tconst currentMonthDate = new Date(this.#nowTime.getFullYear(), month, 1);\n\n\t\treturn DateTimeFormat.format('f', currentMonthDate.getTime() / 1000);\n\t}\n\n\t#getMonthDays(year, month)\n\t{\n\t\tconst days = [];\n\t\tconst daysCount = new Date(year, month + 1, 0).getDate();\n\t\tconst accessibilityArrayKey = `${month + 1}.${year}`;\n\n\t\tfor (let dayIndex = 1; dayIndex <= daysCount; dayIndex++)\n\t\t{\n\t\t\tconst newDay = new Date(year, month, dayIndex);\n\t\t\tconst slots = this.#monthsSlotsMap[accessibilityArrayKey][newDay.getDate()] ?? [];\n\n\t\t\tconst params = {\n\t\t\t\tvalue: dayIndex,\n\t\t\t\tslots,\n\t\t\t\tweekend: this.#isHoliday(newDay),\n\t\t\t\tenableBooking: slots.length > 0,\n\t\t\t};\n\n\t\t\tconst day = new Day(params);\n\t\t\tdays.push(day);\n\t\t}\n\n\t\treturn days;\n\t}\n\n\tselectFirstAvailableDay()\n\t{\n\t\tlet visibleDays = this.#months[this.#currentMonthIndex].days;\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tconst todayDay = this.#nowTime.getDate();\n\t\t\tvisibleDays = visibleDays.filter((day) => day.getDay() >= todayDay).slice(0, 14);\n\t\t}\n\t\tlet dayToSelect = visibleDays.find((day) => day.isEnableBooking());\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = visibleDays[0];\n\t\t}\n\n\t\tdayToSelect.select();\n\t}\n\n\tselectMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.select();\n\t}\n\n\thighlightMonthDay()\n\t{\n\t\tconst dayToSelect = this.#getDayToSelect();\n\n\t\tthis.#currentDayNumber = dayToSelect.day;\n\t\tdayToSelect.highlight();\n\t}\n\n\t#getDayToSelect()\n\t{\n\t\tconst monthDays = this.#months[this.#currentMonthIndex].days;\n\t\tlet dayToSelect = monthDays.find((day) => day.getDay() === this.#currentDayNumber);\n\t\tif (dayToSelect === undefined)\n\t\t{\n\t\t\tdayToSelect = monthDays[monthDays.length - 1];\n\t\t}\n\n\t\treturn dayToSelect;\n\t}\n\n\t#isHoliday(day)\n\t{\n\t\tconst monthKey = (`0${day.getMonth() + 1}`).slice(-2);\n\t\tconst dayMonthKey = `${day.getDate()}.${monthKey}`;\n\n\t\treturn (this.#config.weekHolidays.includes(day.getDay()) || this.#config.yearHolidays[dayMonthKey] !== undefined);\n\t}\n\n\t#isYearHoliday(day)\n\t{\n\t\tconst dayMonthKey = day.getDate() + '.' + ('0' + (day.getMonth() + 1)).slice(-2);\n\n\t\treturn this.#config.yearHolidays[dayMonthKey] !== undefined;\n\t}\n\n\tgetSelectedTimezoneId()\n\t{\n\t\treturn this.#selectedTimezoneId;\n\t}\n\n\t#getNodeTimeZone()\n\t{\n\t\tthis.#selectedTimezoneNode = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone-value\">\n\t\t\t\t${this.#getFormattedTimezone(this.#selectedTimezoneId)}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timezoneSelect = Tag.render`\n\t\t\t<div class=\"calendar-sharing__timezone\">\n\t\t\t\t${Browser.isMobile() ? this.#getNodeTimezoneSelect() : ''}\n\t\t\t\t<div class=\"calendar-sharing__timezone-area\">\n\t\t\t\t\t<div class=\"calendar-sharing__timezone-title\">${Loc.getMessage('CALENDAR_SHARING_YOR_TIME')}:</div>\n\t\t\t\t\t${this.#selectedTimezoneNode}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#getPopupTimezoneSelect();\n\n\t\tif (!Browser.isMobile())\n\t\t{\n\t\t\tEvent.bind(timezoneSelect, 'click', () => {\n\t\t\t\tconst timezonesPopup = this.#getPopupTimezoneSelect().getPopupWindow();\n\t\t\t\ttimezonesPopup.show();\n\n\t\t\t\tconst popupContent = timezonesPopup.getContentContainer();\n\t\t\t\tconst selectedTimezoneItem = popupContent.querySelector('.menu-popup-item.--selected');\n\t\t\t\tconst selectOffset = timezoneSelect.getBoundingClientRect().top\n\t\t\t\t\t+ timezoneSelect.offsetHeight / 4\n\t\t\t\t\t- popupContent.getBoundingClientRect().top\n\t\t\t\t;\n\t\t\t\tpopupContent.scrollTop = selectedTimezoneItem.offsetTop - selectOffset;\n\t\t\t});\n\t\t}\n\n\t\treturn timezoneSelect;\n\t}\n\n\t#getPopupTimezoneSelect()\n\t{\n\t\tif (this.#timeZonePopup?.getPopupWindow().isShown())\n\t\t{\n\t\t\treturn this.#timeZonePopup;\n\t\t}\n\n\t\tthis.#timeZonePopup?.destroy();\n\t\tconst items = Object.keys(this.#timezoneList).map((timezoneId) => ({\n\t\t\ttext: this.#getFormattedTimezone(timezoneId),\n\t\t\tclassName: (timezoneId === this.#selectedTimezoneId) ? 'menu-popup-no-icon --selected' : 'menu-popup-no-icon',\n\t\t\tonclick: () => {\n\t\t\t\tthis.#updateTimezone(timezoneId);\n\t\t\t\tthis.#timeZonePopup.close();\n\t\t\t},\n\t\t}));\n\n\t\tthis.#timeZonePopup = MenuManager.create({\n\t\t\tid: 'momomiomsiomx92984j',\n\t\t\tclassName: 'calendar-sharing-timezone-select-popup',\n\t\t\titems,\n\t\t\tautoHide: true,\n\t\t\tmaxHeight: window.innerHeight - 150,\n\t\t});\n\n\t\treturn this.#timeZonePopup;\n\t}\n\n\t#getNodeTimezoneSelect()\n\t{\n\t\tconst selectNode = Tag.render`\n\t\t\t<select class=\"calendar-sharing__timezone-select\">\n\t\t\t\t${Object.keys(this.#timezoneList).map((timezoneId) => Tag.render`\n\t\t\t\t\t<option value=\"${timezoneId}\" ${timezoneId === this.#selectedTimezoneId ? 'selected' : ''}>\n\t\t\t\t\t\t${this.#getFormattedTimezone(timezoneId)}\n\t\t\t\t\t</option>\n\t\t\t\t`)}\n\t\t\t</select>\n\t\t`;\n\n\t\tEvent.bind(selectNode, 'change', () => this.#updateTimezone(selectNode.value));\n\n\t\treturn selectNode;\n\t}\n\n\t#updateTimezone(timezoneId)\n\t{\n\t\tthis.#selectedTimezoneId = timezoneId;\n\t\tthis.#selectedTimezoneOffsetUtc = -(this.#timezoneList[this.#selectedTimezoneId].offset / 60);\n\t\tEventEmitter.emit('updateTimezone', { timezone: timezoneId });\n\t\tthis.#selectedTimezoneNode.innerHTML = this.#getFormattedTimezone(this.#selectedTimezoneId);\n\t\tthis.#reCreateCurrentMonth();\n\t\tthis.selectMonthDay();\n\t}\n\n\t#getFormattedTimezone(timezoneId)\n\t{\n\t\treturn `${this.getTimezonePrefix(this.#timezoneList[timezoneId].offset)} - ${timezoneId}`;\n\t}\n\n\tgetTimezonePrefix(timezoneOffset)\n\t{\n\t\tconst offset = timezoneOffset * 1000 - this.#timezoneOffsetUtc * (-60000);\n\t\tconst date = new Date(this.#nowTime.getTime() + offset);\n\n\t\treturn DateTimeFormat.format(Util.getTimeFormatShort(), date.getTime() / 1000);\n\t}\n\n\t#getNodeDaysOfWeek(): HTMLElement\n\t{\n\t\tif (!this.#layout.daysOfWeek)\n\t\t{\n\t\t\tconst nodesWeekDays = this.#loc.weekdays.map((weekDay) => {\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"calendar-sharing__month-col --day-of-week\">${weekDay}</div>\n\t\t\t\t`;\n\t\t\t});\n\n\t\t\tthis.#layout.daysOfWeek = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__month-row\">${nodesWeekDays}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.daysOfWeek;\n\t}\n\n\t#getNodeDay(param = {}): HTMLElement\n\t{\n\t\tparam.selected = this.#selectedDay?.getDay() === param.value && param.currentMonth === true;\n\t\tconst day = new Day(param);\n\n\t\treturn day.render();\n\t}\n\n\t#getNodeMonth()\n\t{\n\t\tconst monthInfo = this.#months[this.#currentMonthIndex];\n\t\tconst year = monthInfo.year;\n\t\tconst month = monthInfo.month;\n\n\t\tconst firstDayOfMonth = (new Date(year, month, 7).getDay() - (this.#config.weekStart - 1) + 7) % 7;\n\t\tconst lastDateOfMonth = new Date(year, month + 1, 0).getDate();\n\t\tconst lastDayOfLastMonth = month === 0\n\t\t\t? new Date(year - 1, 11, 0).getDate()\n\t\t\t: new Date(year, month, 0).getDate()\n\t\t;\n\n\t\tconst nodeMonth = Tag.render`<div class=\"calendar-sharing__month-row\"></div>`;\n\n\t\tlet k = lastDayOfLastMonth - firstDayOfMonth + 1;\n\t\tfor (let j = 0; j < firstDayOfMonth; j++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tfor (let i = 0; i <= lastDateOfMonth - 1; i++)\n\t\t{\n\t\t\tconst day = monthInfo.days[i];\n\t\t\tDom.append(day.render(), nodeMonth);\n\t\t}\n\n\t\tlet dayOfWeek = (new Date(year, month, lastDateOfMonth).getDay() - this.#config.weekStart + 7) % 7;\n\t\tfor (dayOfWeek, k = 1; dayOfWeek < 6; dayOfWeek++)\n\t\t{\n\t\t\tDom.append(this.#getNodeDay({\n\t\t\t\tvalue: k,\n\t\t\t\tnotCurrentMonth: true,\n\t\t\t}), nodeMonth);\n\t\t\tk++;\n\t\t}\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__month\">\n\t\t\t\t${this.#getNodeDaysOfWeek()}\n\t\t\t\t${nodeMonth}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst touchPosition = {\n\t\t\tx: null,\n\t\t};\n\n\t\tconst touchMove = (ev) => {\n\t\t\ttouchPosition.x = ev.changedTouches[0].clientX;\n\t\t};\n\n\t\tEvent.bind(result, 'touchstart', (ev) => {\n\t\t\ttouchMove(ev);\n\t\t});\n\n\t\tEvent.bind(result, 'touchend', (ev) => {\n\t\t\tif (touchPosition.x < ev.changedTouches[0].clientX - 100)\n\t\t\t{\n\t\t\t\tthis.#handlePreviousMonthArrowClick();\n\t\t\t}\n\n\t\t\tif (touchPosition.x > ev.changedTouches[0].clientX + 100)\n\t\t\t{\n\t\t\t\tthis.#handleNextMonthArrowClick();\n\t\t\t}\n\n\t\t\tresult.style.removeProperty('transform');\n\t\t});\n\n\t\tEvent.bind(result, 'touchmove', (ev) => {\n\t\t\tev.preventDefault();\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getNodeMonthWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.monthWrapper)\n\t\t{\n\t\t\tthis.#layout.monthWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --month\">\n\t\t\t\t\t${this.#getNodeMonth()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.monthWrapper;\n\t}\n\n\t#getNodeTimezoneWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.timezoneWrapper)\n\t\t{\n\t\t\tthis.#layout.timezoneWrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t${this.#getNodeTimeZone()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezoneWrapper;\n\t}\n\n\t#getNodeCurrentMonth()\n\t{\n\t\tif (!this.#layout.currentMonth)\n\t\t{\n\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\t\t\tthis.#layout.currentMonth = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">${currentMonthName}, ${currentYear}</div>\n\t\t\t`;\n\n\t\t\tEventEmitter.subscribe(this, 'updateCalendar', () => {\n\t\t\t\tconst currentMonthName = this.#months[this.#currentMonthIndex].name;\n\t\t\t\tconst currentYear = this.#months[this.#currentMonthIndex].year;\n\n\t\t\t\tthis.#layout.currentMonth.innerHTML = `${currentMonthName}, ${currentYear}`;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.currentMonth;\n\t}\n\n\t#updateCalendar(direction)\n\t{\n\t\tDom.clean(this.#getNodeMonthWrapper());\n\t\tconst nodeMonth = this.#getNodeMonth();\n\n\t\tif (Type.isString(direction))\n\t\t{\n\t\t\tDom.addClass(nodeMonth, `--animate-${direction}`);\n\t\t\tEvent.bind(nodeMonth, 'animationend', () => {\n\t\t\t\tDom.removeClass(nodeMonth, `--animate-${direction}`);\n\t\t\t}, { once: true });\n\t\t}\n\n\t\tDom.append(nodeMonth, this.#getNodeMonthWrapper());\n\t\tEventEmitter.emit(this, 'updateCalendar');\n\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\tDom.addClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#layout.prevNav, '--disabled');\n\t\t}\n\t}\n\n\t#getNodePrevNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.prevNav)\n\t\t{\n\t\t\tthis.#layout.prevNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_prev --disabled\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_PREV')}\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.prevNav, 'click', this.#handlePreviousMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.prevNav;\n\t}\n\n\t#getNodeNextNav(): HTMLElement\n\t{\n\t\tif (!this.#layout.nextNav)\n\t\t{\n\t\t\tthis.#layout.nextNav = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav_next\" title=\"${Loc.getMessage('CALENDAR_SHARING_NAV_NEXT')}\"></div>\n\t\t\t`;\n\t\t\tEvent.bind(this.#layout.nextNav, 'click', this.#handleNextMonthArrowClick.bind(this));\n\t\t}\n\n\t\treturn this.#layout.nextNav;\n\t}\n\n\t#getNodeNavigation(): HTMLElement\n\t{\n\t\tif (!this.#layout.navigation)\n\t\t{\n\t\t\tthis.#layout.navigation = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-nav\">\n\t\t\t\t\t${this.#getNodePrevNav()}\n\t\t\t\t\t${this.#getNodeNextNav()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.navigation;\n\t}\n\n\tasync #handleNextMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === this.#months.length - 1)\n\t\t{\n\t\t\tif (this.nextMonthCreating)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.#createNextMonth();\n\t\t}\n\n\t\tthis.#currentMonthIndex += 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickNextMonth');\n\t\tthis.#updateCalendar('next');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#handlePreviousMonthArrowClick()\n\t{\n\t\tif (this.#currentMonthIndex === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#currentMonthIndex -= 1;\n\t\tthis.#updateMonth(this.#currentMonthIndex);\n\n\t\tEventEmitter.emit(this, 'clickPrevMonth');\n\t\tthis.#updateCalendar('prev');\n\t\tthis.selectMonthDay();\n\t}\n\n\t#updateMonth(monthIndex)\n\t{\n\t\tconst year = this.#months[monthIndex].year;\n\t\tconst month = this.#months[monthIndex].month;\n\t\tthis.#calculateDateTimeSlots(year, month);\n\n\t\tthis.#months[this.#currentMonthIndex] = this.#createMonth(year, month);\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', () => {\n\t\t\t\tEventEmitter.emit('hideSlotSelector', this);\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t${this.#getNodeCurrentMonth()}\n\t\t\t\t\t\t${this.#getNodeNavigation()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeMonthWrapper()}\n\t\t\t\t\t${this.#getNodeTimezoneWrapper()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport { Tag, Dom } from 'main.core';\n\ntype BaseOptions = {\n\tisHiddenOnStart: boolean,\n};\nexport default class Base\n{\n\t#wrapNode;\n\t#isHiddenOnStart;\n\tconstructor(options: BaseOptions)\n\t{\n\t\tthis.#wrapNode = null;\n\t\tthis.#isHiddenOnStart = options.isHiddenOnStart;\n\t\tthis.#bindEvents();\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div></div>\n\t\t`;\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'base';\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.append(this.getContent(), this.#getWrapNode());\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#getWrapNode()\n\t{\n\t\tif (!this.#wrapNode)\n\t\t{\n\t\t\tthis.#wrapNode = Tag.render`<div class=\"calendar-pub__slots-wrap\"></div>`;\n\t\t\tif (this.#isHiddenOnStart)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#wrapNode;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev) => {\n\t\t\tif (ev.data === this.getType())\n\t\t\t{\n\t\t\t\tthis.#show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#hide();\n\t\t\t}\n\t\t});\n\t}\n\n\t#hide()\n\t{\n\t\tDom.addClass(this.#wrapNode, '--hidden');\n\t}\n\n\t#show()\n\t{\n\t\tDom.removeClass(this.#wrapNode, '--hidden');\n\t}\n}\n","import { Event, Tag, Loc, Type } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Util } from 'calendar.util';\nimport { Member, MembersList } from '../layout/members-list';\nimport { Popup } from 'main.popup';\nimport 'ui.icon-set.actions';\nimport bindShowOnHover from '../layout/bind-show-on-hover';\n\ntype Data = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n\trruleDescription: string,\n\tmembers: Member[],\n}\n\ntype WidgetDateProps = {\n\tallAttendees: boolean,\n\tfilled: boolean,\n\tbrowserTimezone: boolean,\n};\n\nexport default class WidgetDate\n{\n\t#props: WidgetDateProps;\n\t#layout;\n\t#value;\n\t#members;\n\n\tstatic timezoneNoticeUnderstood = false;\n\n\tconstructor(props: WidgetDateProps = {})\n\t{\n\t\tthis.#props = props;\n\n\t\tthis.#layout = {\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t\tavatarsSection: null,\n\t\t\ttimezoneNotice: null,\n\t\t};\n\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t\trruleDescription: '',\n\t\t};\n\t}\n\n\tupdateValue(data: Data)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\n\t\tif (data.members)\n\t\t{\n\t\t\tthis.#members = data.members;\n\t\t}\n\n\t\tif (data.rruleDescription)\n\t\t{\n\t\t\tthis.#value.rruleDescription = data.rruleDescription;\n\t\t}\n\n\t\tthis.updateLayout();\n\t}\n\n\tupdateLayout()\n\t{\n\t\tconst timezone = this.#props.browserTimezone ?? this.#value.timezone;\n\t\tlet offset = this.#getBrowserTimezoneOffset() * 60;\n\t\tconst from = this.#value.from.getTime() / 1000 + offset;\n\t\tconst to = this.#value.to.getTime() / 1000 + offset;\n\t\tconst isFullDay = this.#value.isFullDay;\n\n\t\tconst calendarMonthName = this.#formatMonthName(from);\n\t\tconst calendarDay = this.#formatCalendarDay(from);\n\n\t\tconst isSameDate = DateTimeFormat.format('j F Y', from) === DateTimeFormat.format('j F Y', to);\n\t\tlet calendarTime, eventDate, eventTime, eventTimezone;\n\t\tif (isFullDay)\n\t\t{\n\t\t\tcalendarTime = this.#formatWeekDay(from);\n\t\t\teventDate = `${this.#formatDate(from)} - ${this.#formatDate(to)}`;\n\t\t\teventTime = Loc.getMessage('CALENDAR_SHARING_WIDGET_DATE_FULL_DAY');\n\t\t\teventTimezone = '';\n\n\t\t\tif (isSameDate)\n\t\t\t{\n\t\t\t\teventDate = this.#formatWeekDate(from, '');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcalendarTime = this.#formatTime(from);\n\t\t\teventDate = this.#formatWeekDate(from);\n\t\t\teventTime = this.#formatTimeInterval(from, to);\n\t\t\teventTimezone = Util.getFormattedTimezone(timezone);\n\n\t\t\tif (!isSameDate)\n\t\t\t{\n\t\t\t\teventDate = Loc.getMessage('CALENDAR_SHARING_WIDGET_DATE_EVENT_START', {\n\t\t\t\t\t'#DATE#': this.#formatDateTime(from),\n\t\t\t\t});\n\t\t\t\teventTime = Loc.getMessage('CALENDAR_SHARING_WIDGET_DATE_EVENT_END', {\n\t\t\t\t\t'#DATE#': this.#formatDateTime(to),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis.#getNodeCalendarPageMonth().innerText = calendarMonthName;\n\t\tthis.#getNodeCalendarPageDay().innerText = calendarDay;\n\t\tthis.#getNodeCalendarPageTimeFrom().innerText = calendarTime;\n\t\tthis.#getNodeDayInfo().innerText = eventDate;\n\t\tthis.#getNodeTimeInterval().innerText = eventTime;\n\t\tthis.#getNodeTimezone().innerText = eventTimezone;\n\t\tthis.#getNodeTimezone().title = eventTimezone;\n\n\t\tthis.#renderAvatarsSection();\n\t}\n\n\t#formatDate(timestamp: number): string\n\t{\n\t\tconst dayMonthFormat = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\n\t\treturn DateTimeFormat.format(dayMonthFormat, timestamp);\n\t}\n\n\t#formatWeekDay(timestamp: number): string\n\t{\n\t\treturn DateTimeFormat.format('D', timestamp);\n\t}\n\n\t#formatWeekDate(timestamp: number): string\n\t{\n\t\tconst weekDateFormat = DateTimeFormat.getFormat('DAY_OF_WEEK_MONTH_FORMAT');\n\n\t\treturn DateTimeFormat.format(weekDateFormat, timestamp);\n\t}\n\n\t#formatDateTime(timestamp: number): string\n\t{\n\t\tconst dayMonthFormat = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\tconst format = `${dayMonthFormat} ${shortTimeFormat}`;\n\n\t\treturn  DateTimeFormat.format(format, timestamp);\n\t}\n\n\t#formatTimeInterval(from: number, to: number): string\n\t{\n\t\treturn `${this.#formatTime(from)} - ${this.#formatTime(to)}`;\n\t}\n\n\t#formatTime(timestamp: number): string\n\t{\n\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\treturn DateTimeFormat.format(shortTimeFormat, timestamp);\n\t}\n\n\t#formatMonthName(timestamp: number): string\n\t{\n\t\treturn DateTimeFormat.format('f', timestamp);\n\t}\n\n\t#formatCalendarDay(timestamp: number): string\n\t{\n\t\treturn DateTimeFormat.format('d', timestamp);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__form-date ${this.#props.filled ? '--filled' : ''}\">\n\t\t\t\t<div class=\"calendar-pub__form-date-main\">\n\t\t\t\t\t<div class=\"calendar-pub__form-date-day\">\n\t\t\t\t\t\t${this.#getNodeCalendarPageMonth()}\n\t\t\t\t\t\t<div class=\"calendar-pub__form-date-content\">\n\t\t\t\t\t\t\t${this.#getNodeCalendarPageDay()}\n\t\t\t\t\t\t\t${this.#getNodeCalendarPageTimeFrom()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__form-date-info\">\n\t\t\t\t\t\t${this.#getNodeDayInfo()}\n\t\t\t\t\t\t${this.#renderTime()}\n\t\t\t\t\t\t${this.#getNodeTimezone()}\n\t\t\t\t\t\t${this.#renderAvatarsSection()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#renderTimezoneNotice()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getNodeCalendarPageMonth()\n\t{\n\t\tif (!this.#layout.calendarPage.month)\n\t\t{\n\t\t\tthis.#layout.calendarPage.month = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_month\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.month;\n\t}\n\n\t#getNodeCalendarPageDay()\n\t{\n\t\tif (!this.#layout.calendarPage.day)\n\t\t{\n\t\t\tthis.#layout.calendarPage.day = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_num\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.day;\n\t}\n\n\t#getNodeCalendarPageTimeFrom()\n\t{\n\t\tif (!this.#layout.calendarPage.timeFrom)\n\t\t{\n\t\t\tthis.#layout.calendarPage.timeFrom = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-day_time\">13:00</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.calendarPage.timeFrom;\n\t}\n\n\t#getNodeDayInfo()\n\t{\n\t\tif (!this.#layout.dayInfo)\n\t\t{\n\t\t\tthis.#layout.dayInfo = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_day\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.dayInfo;\n\t}\n\n\t#renderTime(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__form-date-info_time-container\">\n\t\t\t\t${this.#getNodeTimeInterval()}\n\t\t\t\t${this.#renderRrule()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getNodeTimeInterval()\n\t{\n\t\tif (!this.#layout.timeInterval)\n\t\t{\n\t\t\tthis.#layout.timeInterval = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timeInterval;\n\t}\n\n\t#renderRrule(): HTMLElement|string\n\t{\n\t\tif (!Type.isStringFilled(this.#value.rruleDescription))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (!this.#layout.rrule)\n\t\t{\n\t\t\tthis.#layout.rrule = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-rrule ui-icon-set --refresh-7\"></div>\n\t\t\t`;\n\n\t\t\tconst popup = new Popup({\n\t\t\t\tbindElement: this.#layout.rrule,\n\t\t\t\tcontent: this.#value.rruleDescription,\n\t\t\t\tdarkMode: true,\n\t\t\t\tbindOptions: { position: 'top' },\n\t\t\t\toffsetTop: -10,\n\t\t\t\tangle: true,\n\t\t\t\tautoHide: true,\n\t\t\t});\n\n\t\t\tbindShowOnHover(popup);\n\t\t}\n\n\t\treturn this.#layout.rrule;\n\t}\n\n\t#getNodeTimezone()\n\t{\n\t\tif (!this.#layout.timezone)\n\t\t{\n\t\t\tthis.#layout.timezone = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-date-info_time-zone\"></div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezone;\n\t}\n\n\t#renderAvatarsSection(): HTMLElement|string\n\t{\n\t\tif (this.#props.allAttendees)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst avatarsSection = new MembersList({\n\t\t\tclassName: 'calendar-pub__form-date-members',\n\t\t\ttextClassName: 'calendar-pub-ui__typography-xs',\n\t\t\tavatarSize: 30,\n\t\t\tmembers: this.#members,\n\t\t\tallAttendees: this.#props.allAttendees,\n\t\t}).render();\n\n\t\tif (!this.#layout.avatarsSection)\n\t\t{\n\t\t\tthis.#layout.avatarsSection = Tag.render`\n\t\t\t\t<div>${avatarsSection}</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#layout.avatarsSection.innerHTML = '';\n\t\t\tthis.#layout.avatarsSection.append(avatarsSection);\n\t\t}\n\n\t\treturn this.#layout.avatarsSection;\n\t}\n\n\t#renderTimezoneNotice(): HTMLElement|string\n\t{\n\t\tconst offset = this.#getBrowserTimezoneOffset();\n\t\tif (WidgetDate.timezoneNoticeUnderstood || offset === 0)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tconst timezoneNoticeUnderstandButton = Tag.render`\n\t\t\t<div class=\"calendar-pub__link-button\">\n\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_UNDERSTAND')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(timezoneNoticeUnderstandButton, 'click', () => {\n\t\t\tthis.#layout.timezoneNotice.remove();\n\t\t\tWidgetDate.timezoneNoticeUnderstood = true;\n\t\t});\n\n\t\tconst noticeOffsetNode = Tag.render`\n\t\t\t<div class=\"calendar-pub-timezone-notice-offset\">\n\t\t\t\t${this.#getTimezoneNoticeText(offset)}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst timezonePopup = new Popup({\n\t\t\tbindElement: noticeOffsetNode,\n\t\t\tcontent: Util.getFormattedTimezone(this.#value.timezone),\n\t\t\tdarkMode: true,\n\t\t\tbindOptions: { position: 'top' },\n\t\t\toffsetTop: -10,\n\t\t\tangle: true,\n\t\t\tautoHide: true,\n\t\t});\n\n\t\tbindShowOnHover(timezonePopup);\n\n\t\tthis.#layout.timezoneNotice = Tag.render`\n\t\t\t<div class=\"calendar-pub__event-timezone-notice calendar-pub-ui__typography-sm\">\n\t\t\t\t<div>\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_EVENT_TIMEZONE_NOTICE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub__event-timezone-notice-bottom\">\n\t\t\t\t\t${noticeOffsetNode}\n\t\t\t\t\t${timezoneNoticeUnderstandButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#layout.timezoneNotice;\n\t}\n\n\t#getTimezoneNoticeText(offset): string\n\t{\n\t\tconst sign = (offset < 0) ? '+' : '-';\n\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_TIMEZONE_NOTICE_OFFSET', {\n\t\t\t'#OFFSET#': `${sign}${Util.formatDuration(Math.abs(offset))}`,\n\t\t});\n\t}\n\n\t#getBrowserTimezoneOffset(): number\n\t{\n\t\tif (!Type.isStringFilled(this.#props.browserTimezone) || !Type.isStringFilled(this.#value.timezone))\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst eventOffset = Util.getTimeZoneOffset(this.#props.browserTimezone);\n\t\tconst browserOffset = Util.getTimeZoneOffset(this.#value.timezone);\n\n\t\treturn browserOffset - eventOffset;\n\t}\n}\n","import { Tag, Loc, Event, Dom, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { DateTimeFormat } from 'main.date';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\nimport WidgetDate from '../widget-date';\n\ntype FormOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tlink: any,\n\tsharingUser: any,\n\tisFromCrm: boolean,\n\thasContactData: boolean,\n\tisMailFeatureEnabled: boolean,\n\tisPhoneFeatureEnabled: boolean,\n}\n\ntype FormData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n}\n\nexport default class Form extends Base\n{\n\t#layout;\n\t#value;\n\t#widgetDate;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#phoneDb;\n\t#isFromCrm;\n\t#hasContactData;\n\t#isPhoneFeatureEnabled;\n\t#isMailFeatureEnabled;\n\t#inputData;\n\t#inputErrors;\n\n\tconstructor(options: FormOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#widgetDate = new WidgetDate();\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#isFromCrm = options.isFromCrm;\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#isPhoneFeatureEnabled = options.isPhoneFeatureEnabled;\n\t\tthis.#isMailFeatureEnabled = options.isMailFeatureEnabled;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tbuttonSend: null,\n\t\t\twidgetDate: null,\n\t\t\tformArea: null,\n\t\t\tback: null,\n\t\t\tcalendarPage: {\n\t\t\t\tmonth: null,\n\t\t\t\tday: null,\n\t\t\t\ttimeFrom: null,\n\t\t\t},\n\t\t\tdayInfo: null,\n\t\t\ttimeInterval: null,\n\t\t\ttimezone: null,\n\t\t\tinputs: {\n\t\t\t\tname: null,\n\t\t\t\tcontact: null,\n\t\t\t\tdescription: null,\n\t\t\t},\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t\tmembers: this.#link.members,\n\t\t};\n\t\tthis.#inputData = {\n\t\t\tauthorName: '',\n\t\t\tcontactData: '',\n\t\t\tdescription: '',\n\t\t};\n\t\tthis.#inputErrors = {\n\t\t\tauthorNameEmpty: false,\n\t\t\tcontactDataEmpty: false,\n\t\t\tcontactDataIncorrect: false,\n\t\t};\n\t\tthis.#phoneDb = null;\n\t}\n\n\tcleanDescription()\n\t{\n\t\tthis.#getNodeInputDescription().value = null;\n\t\tthis.#inputData.description = '';\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'form';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n\n\tupdateFormValue(data: FormData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\t\tthis.updateFormLayout();\n\t}\n\n\tupdateFormLayout()\n\t{\n\t\tthis.#widgetDate.updateValue(this.#value);\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t\t${this.#getNodeBack()}\n\t\t\t\t\t\t<div class=\"calendar-sharing__calendar-title-day calendar-pub-ui__typography-title\">\n\t\t\t\t\t\t\t${this.#getEventName()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-block\">\n\t\t\t\t\t\t${this.#getNodeWidgetDate()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeFormArea()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#': `${this.#owner.name} ${this.#owner.lastName}`,\n\t\t});\n\t}\n\n\t#getNodeButtonSend(): HTMLElement\n\t{\n\t\tif (!this.#layout.buttonSend)\n\t\t{\n\t\t\tthis.#layout.buttonSend = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-ui__btn\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_CREATE_MEETING')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.buttonSend, 'click', () => this.#handleSaveButtonClick());\n\t\t}\n\n\t\treturn this.#layout.buttonSend;\n\t}\n\n\tasync #handleSaveButtonClick()\n\t{\n\t\tif (Dom.hasClass(this.#layout.buttonSend, '--wait'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#layout.buttonSend, '--wait');\n\n\t\tthis.clearInputErrors();\n\t\tif (!this.#validateData())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst isSuccessful = await this.#saveEvent();\n\n\t\tif (isSuccessful)\n\t\t{\n\t\t\tEventEmitter.emit('selectorTypeChange', 'event', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t});\n\t\t}\n\n\t\tDom.removeClass(this.#layout.buttonSend, '--wait');\n\t}\n\n\tasync #saveEvent(): boolean\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tif (this.#isFromCrm)\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveCrmEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tcrmDealLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.saveEvent', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\townerCreated: this.#sharingUser.ownerCreated,\n\t\t\t\t\t\townerId: this.#owner.id,\n\t\t\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\t\t\tuserContact: this.#inputData.contactData,\n\t\t\t\t\t\tdateFrom: this.#parseDate(this.#value.from),\n\t\t\t\t\t\tdateTo: this.#parseDate(this.#value.to),\n\t\t\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\t\t\tparentLinkHash: this.#link.hash,\n\t\t\t\t\t\tdescription: this.#inputData.description,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\tif (response.errors.length === 0)\n\t\t{\n\t\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\t\teventName: this.#getEventName(),\n\t\t\t\tfrom: this.#value.from,\n\t\t\t\tto: this.#value.to,\n\t\t\t\ttimezone: this.#value.timezone,\n\t\t\t\teventId: response.data.eventId,\n\t\t\t\teventLinkId: response.data.eventLinkId,\n\t\t\t\teventLinkHash: response.data.eventLinkHash,\n\t\t\t\teventLinkShortUrl: response.data.eventLinkShortUrl,\n\t\t\t\tuserName: this.#inputData.authorName,\n\t\t\t\tstate: 'created',\n\t\t\t\tisView: false,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (response?.data?.contactDataError || response?.data?.isEmptyContactName)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = response.data.contactDataError === true;\n\t\t\tthis.#inputErrors.authorNameEmpty = response.data.isEmptyContactName === true;\n\t\t\tthis.#renderInputErrors();\n\n\t\t\treturn false;\n\t\t}\n\n\t\tEventEmitter.emit('onSaveEvent', {\n\t\t\teventName: this.#getEventName(),\n\t\t\tfrom: this.#value.from,\n\t\t\tto: this.#value.to,\n\t\t\ttimezone: this.#value.timezone,\n\t\t\tstate: 'not-created',\n\t\t\tisView: false,\n\t\t});\n\n\t\treturn false;\n\t}\n\n\t#parseDate(date): string\n\t{\n\t\tconst dateInFormat = DateTimeFormat.format(Util.getDateFormat(), date.getTime() / 1000);\n\t\tconst timeInFormat = DateTimeFormat.format(Util.getTimeFormat(), date.getTime() / 1000);\n\n\t\treturn `${dateInFormat} ${timeInFormat}`;\n\t}\n\n\t#validateData(): boolean\n\t{\n\t\tif (this.#isCrmAndHasContact())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.#inputData.authorName.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.authorNameEmpty = true;\n\t\t}\n\n\t\tif (this.#inputData.contactData.length === 0)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataEmpty = true;\n\t\t}\n\n\t\tif (!this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tthis.#inputErrors.contactDataIncorrect = !this.#validatePhone() && !this.#validateEmail();\n\t\t}\n\t\tthis.#renderInputErrors();\n\n\t\treturn !this.#inputErrors.authorNameEmpty\n\t\t\t&& !this.#inputErrors.contactDataEmpty\n\t\t\t&& !this.#inputErrors.contactDataIncorrect\n\t\t\t;\n\t}\n\n\t#validatePhone(): boolean\n\t{\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst phone = this.#inputData.contactData.replace(/[()\\s\\-]+/g, '');\n\t\tconst match = phone.match(/(^\\+?\\d{4,25}$)/i);\n\n\t\treturn match?.[0] === phone;\n\t}\n\n\t#validateEmail(): boolean\n\t{\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst match = this.#inputData.contactData.match(/(^[^@]+@.+$)/i);\n\n\t\treturn match?.[0] === this.#inputData.contactData;\n\t}\n\n\tclearInputErrors()\n\t{\n\t\tthis.#clearContactNameError();\n\t\tthis.#clearContactDataError();\n\t}\n\n\t#clearContactDataError()\n\t{\n\t\tthis.#inputErrors.contactDataEmpty = false;\n\t\tthis.#inputErrors.contactDataIncorrect = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#clearContactNameError()\n\t{\n\t\tthis.#inputErrors.authorNameEmpty = false;\n\t\tthis.#renderInputErrors();\n\t}\n\n\t#showFullContactPlaceholder(): boolean\n\t{\n\t\treturn !this.#isMailContactOnly() && !this.#isPhoneContactOnly();\n\t}\n\n\t#isMailContactOnly(): boolean\n\t{\n\t\treturn !this.#isPhoneFeatureEnabled && this.#isMailFeatureEnabled;\n\t}\n\n\t#isPhoneContactOnly(): boolean\n\t{\n\t\treturn this.#isPhoneFeatureEnabled && !this.#isMailFeatureEnabled;\n\t}\n\n\t#isCrmAndHasContact(): boolean\n\t{\n\t\treturn this.#isFromCrm && this.#hasContactData;\n\t}\n\n\t#getNodeWidgetDate(): HTMLElement\n\t{\n\t\tif (!this.#layout.widgetDate)\n\t\t{\n\t\t\tthis.#layout.widgetDate = this.#widgetDate.render();\n\t\t}\n\n\t\treturn this.#layout.widgetDate;\n\t}\n\n\t#getNodeFormArea(): HTMLElement\n\t{\n\t\tif (!this.#layout.formArea)\n\t\t{\n\t\t\tthis.#layout.nameInputError = this.#getNodeInputError();\n\t\t\tthis.#layout.contactInputError = this.#getNodeInputError();\n\n\t\t\tthis.#layout.formArea = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form\">\n\t\t\t\t\t<div class=\"calendar-sharing__form-area\">\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputName()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_NAME')}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.nameInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputContact()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${this.#getContactDataPlaceholder()}<span>*</span></div>\n\t\t\t\t\t\t\t${this.#layout.contactInputError}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"calendar-sharing__form-input\">\n\t\t\t\t\t\t\t${this.#getNodeInputDescription()}\n\t\t\t\t\t\t\t<div class=\"calendar-sharing__form-input-title\">${Loc.getMessage('CALENDAR_SHARING_FORM_INPUT_INFO')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub__welcome-bottom\">\n\t\t\t\t\t\t${this.#getNodeButtonSend()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.formArea;\n\t}\n\n\t#getContactDataPlaceholder(): string\n\t{\n\t\tlet messageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_ENABLED';\n\t\tif (this.#isMailContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_PHONE_FEATURE_DISABLED';\n\t\t}\n\n\t\tif (this.#isPhoneContactOnly())\n\t\t{\n\t\t\tmessageCode = 'CALENDAR_SHARING_AUTHOR_CONTACT_DATA_PLACEHOLDER_MAIL_FEATURE_DISABLED';\n\t\t}\n\n\t\treturn Loc.getMessage(messageCode);\n\t}\n\n\t#getNodeInputName()\n\t{\n\t\tif (!this.#layout.inputs.name)\n\t\t{\n\t\t\tthis.#layout.inputs.name = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.name, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser?.userName)\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.name.value = this.#sharingUser?.userName;\n\t\t\t}\n\n\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\tEvent.bind(this.#layout.inputs.name, 'input', () => {\n\t\t\t\tthis.#inputData.authorName = this.#layout.inputs.name.value;\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.name, 'focus', this.#clearContactNameError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.name;\n\t}\n\n\t#getNodeInputContact()\n\t{\n\t\tif (!this.#layout.inputs.contact)\n\t\t{\n\t\t\tthis.#layout.inputs.contact = Tag.render`\n\t\t\t\t<input type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area\">\n\t\t\t`;\n\n\t\t\tif (this.#isMailContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'email';\n\t\t\t}\n\n\t\t\tif (this.#isPhoneContactOnly())\n\t\t\t{\n\t\t\t\tthis.#layout.inputs.contact.inputMode = 'tel';\n\t\t\t}\n\n\t\t\tif (this.#hasContactData)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.inputs.contact, '--hidden');\n\t\t\t}\n\t\t\telse if (this.#sharingUser)\n\t\t\t{\n\t\t\t\tif (this.#isMailFeatureEnabled && this.#sharingUser.personalMailbox)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalMailbox;\n\t\t\t\t}\n\t\t\t\telse if (this.#isPhoneFeatureEnabled && this.#sharingUser.personalPhone)\n\t\t\t\t{\n\t\t\t\t\tthis.#layout.inputs.contact.value = this.#sharingUser?.personalPhone;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'input', (event) => {\n\t\t\t\tthis.#inputData.contactData = this.#layout.inputs.contact.value;\n\t\t\t\tthis.#onPhoneInput(event);\n\t\t\t});\n\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'keydown', this.#onPhoneInputKeyDown.bind(this));\n\t\t\tEvent.bind(this.#layout.inputs.contact, 'focus', this.#clearContactDataError.bind(this));\n\t\t}\n\n\t\treturn this.#layout.inputs.contact;\n\t}\n\n\t#getNodeInputDescription()\n\t{\n\t\tif (!this.#layout.inputs.description)\n\t\t{\n\t\t\tthis.#layout.inputs.description = Tag.render`\n\t\t\t\t<textarea type=\"text\" placeholder=\" \" class=\"calendar-sharing__form-input-area --textarea\"></textarea>\n\t\t\t`;\n\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\tEvent.bind(this.#layout.inputs.description, 'input', () => {\n\t\t\t\tthis.#inputData.description = this.#layout.inputs.description.value;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.inputs.description;\n\t}\n\n\t#getNodeInputError()\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"calendar-sharing__form-input-error\"></span>\n\t\t`;\n\t}\n\n\t#renderInputErrors()\n\t{\n\t\tDom.removeClass(this.#layout.inputs.name.parentNode, '--error');\n\t\tDom.removeClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\tif (this.#inputErrors.authorNameEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.name.parentNode, '--error');\n\t\t\tthis.#layout.nameInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\n\t\tif (this.#inputErrors.contactDataEmpty)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_REQUIRED');\n\t\t}\n\n\t\tif (this.#inputErrors.contactDataIncorrect)\n\t\t{\n\t\t\tDom.addClass(this.#layout.inputs.contact.parentNode, '--error');\n\t\t\tthis.#layout.contactInputError.innerText = Loc.getMessage('CALENDAR_SHARING_INPUT_ERROR_INCORRECT');\n\t\t}\n\t}\n\n\t#getNodeBack(): HTMLElement\n\t{\n\t\tif (!this.#layout.back)\n\t\t{\n\t\t\tthis.#layout.back = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-back\"></div>\n\t\t\t`;\n\n\t\t\tEvent.bind(this.#layout.back, 'click', ()=> {\n\t\t\t\tEventEmitter.emit('selectorTypeChange', 'slot-list');\n\t\t\t});\n\t\t}\n\n\t\treturn this.#layout.back;\n\t}\n\n\t// phone input\n\t#onPhoneInput()\n\t{\n\t\tthis.#clearContactDataError();\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst textBeforeCursor = this.#getTextBeforeCursor(this.#layout.inputs.contact);\n\n\t\tthis.#inputData.contactData = this.#formatPhone(this.#inputData.contactData);\n\t\tthis.#layout.inputs.contact.value = this.#inputData.contactData;\n\n\t\tthis.#setCursorToFormattedPosition(this.#layout.inputs.contact, textBeforeCursor);\n\t}\n\n\t#getTextBeforeCursor(input)\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\n\t\treturn input.value.slice(0, selectionStart);\n\t}\n\n\t#setCursorToFormattedPosition(input, textBeforeCursor)\n\t{\n\t\tconst firstPart = this.#getTextEscapedForRegex(textBeforeCursor.slice(0, -1));\n\t\tconst lastCharacter = this.#getTextEscapedForRegex(textBeforeCursor.slice(-1));\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n\n\t#getTextEscapedForRegex(text)\n\t{\n\t\treturn text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\t}\n\n\t#onPhoneInputKeyDown(e)\n\t{\n\t\tif (!this.#isPhoneTypeInput())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isDigit(e.key) && !this.#isControlKey(e.key) && !Util.isAnyModifierKeyPressed(e))\n\t\t{\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\t#isPhoneTypeInput(): boolean\n\t{\n\t\treturn this.#isPhoneContactOnly() || (this.#showFullContactPlaceholder() && this.contactData.slice(0, 1) === '+');\n\t}\n\n\t#isDigit(key): boolean\n\t{\n\t\treturn /^\\d+$/.test(key);\n\t}\n\n\t#isControlKey(key): boolean\n\t{\n\t\treturn ['Esc', 'Delete', 'Backspace', 'Tab'].indexOf(key) >= 0 || key.includes('Arrow');\n\t}\n\n\t#formatPhone(value): string\n\t{\n\t\tvalue ??= '';\n\n\t\tconst hasPlus = value.indexOf('+') === 0;\n\t\tvalue = value.replace(/\\D/g, '');\n\n\t\tif (!hasPlus && value.substr(0, 1) === '8')\n\t\t{\n\t\t\tvalue = `7${value.substr(1)}`;\n\t\t}\n\n\t\tif (!this.#phoneDb)\n\t\t{\n\t\t\tthis.#phoneDb = \"247,ac,___-____|376,ad,___-___-___|971,ae,___-_-___-____|93,af,__-__-___-____|1268,ag,_ (___) ___-____|1264,ai,_ (___) ___-____|355,al,___ (___) ___-___|374,am,___-__-___-___|599,bq,___-___-____|244,ao,___ (___) ___-___|6721,aq,___-___-___|54,ar,__ (___) ___-____|1684,as,_ (___) ___-____|43,at,__ (___) ___-____|61,au,__-_-____-____|297,aw,___-___-____|994,az,___ (__) ___-__-__|387,ba,___-__-____|1246,bb,_ (___) ___-____|880,bd,___-__-___-___|32,be,__ (___) ___-___|226,bf,___-__-__-____|359,bg,___ (___) ___-___|973,bh,___-____-____|257,bi,___-__-__-____|229,bj,___-__-__-____|1441,bm,_ (___) ___-____|673,bn,___-___-____|591,bo,___-_-___-____|55,br,__-(__)-____-____|1242,bs,_ (___) ___-____|975,bt,___-_-___-___|267,bw,___-__-___-___|375,by,___ (__) ___-__-__|501,bz,___-___-____|243,cd,___ (___) ___-___|236,cf,___-__-__-____|242,cg,___-__-___-____|41,ch,__-__-___-____|225,ci,___-__-___-___|682,ck,___-__-___|56,cl,__-_-____-____|237,cm,___-____-____|86,cn,__ (___) ____-___|57,co,__ (___) ___-____|506,cr,___-____-____|53,cu,__-_-___-____|238,cv,___ (___) __-__|357,cy,___-__-___-___|420,cz,___ (___) ___-___|49,de,__-___-___|253,dj,___-__-__-__-__|45,dk,__-__-__-__-__|1767,dm,_ (___) ___-____|1809,do,_ (___) ___-____|,do,_ (___) ___-____|213,dz,___-__-___-____|593,ec,___-_-___-____|372,ee,___-___-____|20,eg,__ (___) ___-____|291,er,___-_-___-___|34,es,__ (___) ___-___|251,et,___-__-___-____|358,fi,___ (___) ___-__-__|679,fj,___-__-_____|500,fk,___-_____|691,fm,___-___-____|298,fo,___-___-___|262,fr,___-_____-____|33,fr,__ (___) ___-___|508,fr,___-__-____|590,fr,___ (___) ___-___|241,ga,___-_-__-__-__|1473,gd,_ (___) ___-____|995,ge,___ (___) ___-___|594,gf,___-_____-____|233,gh,___ (___) ___-___|350,gi,___-___-_____|299,gl,___-__-__-__|220,gm,___ (___) __-__|224,gn,___-__-___-___|240,gq,___-__-___-____|30,gr,__ (___) ___-____|502,gt,___-_-___-____|1671,gu,_ (___) ___-____|245,gw,___-_-______|592,gy,___-___-____|852,hk,___-____-____|504,hn,___-____-____|385,hr,___-__-___-___|509,ht,___-__-__-____|36,hu,__ (___) ___-___|62,id,__-__-___-__|353,ie,___ (___) ___-___|972,il,___-_-___-____|91,in,__ (____) ___-___|246,io,___-___-____|964,iq,___ (___) ___-____|98,ir,__ (___) ___-____|354,is,___-___-____|39,it,__ (___) ____-___|1876,jm,_ (___) ___-____|962,jo,___-_-____-____|81,jp,__ (___) ___-___|254,ke,___-___-______|996,kg,___ (___) ___-___|855,kh,___ (__) ___-___|686,ki,___-__-___|269,km,___-__-_____|1869,kn,_ (___) ___-____|850,kp,___-___-___|82,kr,__-__-___-____|965,kw,___-____-____|1345,ky,_ (___) ___-____|77,kz,_ (___) ___-__-__|856,la,___-__-___-___|961,lb,___-_-___-___|1758,lc,_ (___) ___-____|423,li,___ (___) ___-____|94,lk,__-__-___-____|231,lr,___-__-___-___|266,ls,___-_-___-____|370,lt,___ (___) __-___|352,lu,___ (___) ___-___|371,lv,___-__-___-___|218,ly,___-__-___-___|212,ma,___-__-____-___|377,mc,___-__-___-___|373,md,___-____-____|382,me,___-__-___-___|261,mg,___-__-__-_____|692,mh,___-___-____|389,mk,___-__-___-___|223,ml,___-__-__-____|95,mm,__-___-___|976,mn,___-__-__-____|853,mo,___-____-____|1670,mp,_ (___) ___-____|596,mq,___ (___) __-__-__|222,mr,___ (__) __-____|1664,ms,_ (___) ___-____|356,mt,___-____-____|230,mu,___-___-____|960,mv,___-___-____|265,mw,___-_-____-____|52,mx,__-__-__-____|60,my,__-_-___-___|258,mz,___-__-___-___|264,na,___-__-___-____|687,nc,___-__-____|227,ne,___-__-__-____|6723,nf,___-___-___|234,ng,___-__-___-__|505,ni,___-____-____|31,nl,__-__-___-____|47,no,__ (___) __-___|977,np,___-__-___-___|674,nr,___-___-____|683,nu,___-____|64,nz,__-__-___-___|968,om,___-__-___-___|507,pa,___-___-____|51,pe,__ (___) ___-___|689,pf,___-__-__-__|675,pg,___ (___) __-___|63,ph,__ (___) ___-____|92,pk,__ (___) ___-____|48,pl,__ (___) ___-___|970,ps,___-__-___-____|351,pt,___-__-___-____|680,pw,___-___-____|595,py,___ (___) ___-___|974,qa,___-____-____|40,ro,__-__-___-____|381,rs,___-__-___-____|7,ru,_ (___) ___-__-__|250,rw,___ (___) ___-___|966,sa,___-_-___-____|677,sb,___-_____|248,sc,___-_-___-___|249,sd,___-__-___-____|46,se,__-__-___-____|65,sg,__-____-____|386,si,___-__-___-___|421,sk,___ (___) ___-___|232,sl,___-__-______|378,sm,___-____-______|221,sn,___-__-___-____|252,so,___-_-___-___|597,sr,___-___-___|211,ss,___-__-___-____|239,st,___-__-_____|503,sv,___-__-__-____|1721,sx,_ (___) ___-____|963,sy,___-__-____-___|268,sz,___ (__) __-____|1649,tc,_ (___) ___-____|235,td,___-__-__-__-__|228,tg,___-__-___-___|66,th,__-__-___-___|992,tj,___-__-___-____|690,tk,___-____|670,tl,___-___-____|993,tm,___-_-___-____|216,tn,___-__-___-___|676,to,___-_____|90,tr,__ (___) ___-____|1868,tt,_ (___) ___-____|688,tv,___-_____|886,tw,___-____-____|255,tz,___-__-___-____|380,ua,___ (__) ___-__-__|256,ug,___ (___) ___-___|44,gb,__-__-____-____|598,uy,___-_-___-__-__|998,uz,___-__-___-____|396698,va,__-_-___-_____|1784,vc,_ (___) ___-____|58,ve,__ (___) ___-____|1284,vg,_ (___) ___-____|1340,vi,_ (___) ___-____|84,vn,__-__-____-___|678,vu,___-_____|681,wf,___-__-____|685,ws,___-__-____|967,ye,___-_-___-___|27,za,__-__-___-____|260,zm,___ (__) ___-____|263,zw,___-_-______|1,us,_ (___) ___-____|\"\n\t\t\t\t.split('|')\n\t\t\t\t.map((item) => {\n\t\t\t\t\titem = item.split(',');\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcode: item[0],\n\t\t\t\t\t\tid: item[1],\n\t\t\t\t\t\tmask: item[2],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t}\n\n\t\tif (value.length > 0)\n\t\t{\n\t\t\tlet mask = this.#findMask(value);\n\t\t\tmask += (`${mask.indexOf('-') >= 0 ? '-' : ' '}__`).repeat(10);\n\t\t\tfor (let i = 0; i < value.length; i++)\n\t\t\t{\n\t\t\t\tmask = mask.replace('_', value.slice(i, i + 1));\n\t\t\t}\n\t\t\tvalue = mask.replace(/\\D+$/, '').replace(/_/g, '0');\n\t\t}\n\n\t\tif (hasPlus || value.length > 0)\n\t\t{\n\t\t\tvalue = `+${value}`;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\t#findMask(value)\n\t{\n\t\tconst r = this.#phoneDb.filter((item) => {\n\t\t\treturn value.indexOf(item.code) === 0;\n\t\t}).sort((a, b) => {\n\t\t\treturn b.code.length - a.code.length;\n\t\t})[0];\n\n\t\treturn r ? r.mask : '_ ___ __ __ __';\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport Base from '../base';\n\ntype EmptyStateOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class EmptyState extends Base\n{\n\t#layout;\n\n\tconstructor(options: EmptyStateOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t};\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{}\n\n\tgetType()\n\t{\n\t\treturn 'empty-state';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_EMPTY_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport Base from '../base';\n\ntype AccessDeniedOptions = {\n\tisHiddenOnStart: boolean,\n};\n\nexport default class AccessDenied extends Base\n{\n\t#layout;\n\n\tconstructor(options: AccessDeniedOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\tcontent: null,\n\t\t};\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{}\n\n\tgetType()\n\t{\n\t\treturn 'access-denied';\n\t}\n\n\tgetContent()\n\t{\n\t\treturn this.#getNodeEmptyState();\n\t}\n\n\t#getNodeEmptyState(): HTMLElement\n\t{\n\t\tif (!this.#layout.content)\n\t\t{\n\t\t\tthis.#layout.content = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slots-empty --icon-cross\">\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_title\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__slots-empty_info\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_ACCESS_DENIED_INFO')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.content;\n\t}\n}\n","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Util } from 'calendar.util';\n\ntype SlotItemOptions = {\n\tvalue: {\n\t\tfrom: Date,\n\t\tto: Date,\n\t},\n}\n\nexport default class SlotItem\n{\n\t#layout;\n\t#selected;\n\t#value;\n\tBUTTON_MAX_WIDTH = 123;\n\n\tconstructor(options: SlotItemOptions)\n\t{\n\t\tthis.#selected = null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tvalue: null,\n\t\t\tselect: null,\n\t\t};\n\t\tthis.#value = options.value;\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEvent.bind(this.#getNodeWrapper(), 'click', this.select.bind(this));\n\t\tEvent.bind(this.#getNodeSelect(), 'click', this.showForm.bind(this));\n\t}\n\n\tisSelected()\n\t{\n\t\treturn this.#selected;\n\t}\n\n\tselect()\n\t{\n\t\tthis.#selected = true;\n\t\tDom.addClass(this.#getNodeWrapper(), '--selected');\n\t\tEventEmitter.emit('selectSlot', this);\n\t}\n\n\tunSelect()\n\t{\n\t\tthis.#selected = null;\n\t\tDom.removeClass(this.#getNodeWrapper(), '--selected');\n\t}\n\n\tshowForm()\n\t{\n\t\tEventEmitter.emit('confirmedSelectSlot', { value: this.#value });\n\t}\n\n\t#getNodeSelect(): HTMLElement\n\t{\n\t\tif (!this.#layout.select)\n\t\t{\n\t\t\tthis.#layout.select = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-select\">${Loc.getMessage('CALENDAR_SHARING_SELECT_SLOT')}</div>\n\t\t\t`;\n\n\t\t\tdocument.body.append(this.#layout.select);\n\t\t\tif (this.#layout.select.offsetWidth > this.BUTTON_MAX_WIDTH)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.select, '--compact');\n\t\t\t}\n\t\t\tthis.#layout.select.remove();\n\t\t}\n\n\t\treturn this.#layout.select;\n\t}\n\n\t#getNodeValue(): HTMLElement\n\t{\n\t\tif (!this.#layout.value)\n\t\t{\n\t\t\tlet value = Util.formatTimeInterval(this.#value.from, this.#value.to);\n\t\t\tvalue = value.replace(/(am|pm)/g, '<span class=\"calendar-sharing-am-pm\">$1</span>');\n\n\t\t\tthis.#layout.value = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-value\">${value}</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.value;\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__slot-item\">\n\t\t\t\t\t${this.#getNodeValue()}\n\t\t\t\t\t${this.#getNodeSelect()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#getNodeWrapper();\n\t}\n}\n","import { Dom, Loc, Tag, Event } from 'main.core';\nimport SlotItem from './slot-item';\nimport { EventEmitter } from 'main.core.events';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\n\ntype SlotListOptions = {\n\tisHiddenOnStart: boolean,\n\townerOffset: number,\n}\n\nexport default class SlotList extends Base\n{\n\t#layout;\n\t#slots;\n\t#selectedSlot;\n\t#timezoneNoticeWasUnderstood;\n\t#ownerTimezoneOffsetUtc;\n\t#selectedTimezoneOffsetUtc;\n\n\tconstructor(options: SlotListOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\t\tthis.#layout = {\n\t\t\ttitle: null,\n\t\t\tlist: null,\n\t\t\ttimezoneNotice: null,\n\t\t\ttimezoneNoticeOffset: null,\n\t\t};\n\t\tthis.#slots = [];\n\n\t\tthis.#timezoneNoticeWasUnderstood = false;\n\t\tthis.#ownerTimezoneOffsetUtc = -options.ownerOffset;\n\t\tthis.#selectedTimezoneOffsetUtc = new Date().getTimezoneOffset();\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('updateSlotsList', (event) => {\n\t\t\tthis.#slots = event.data.slots;\n\t\t\tthis.updateSlotsList();\n\t\t});\n\t\tEventEmitter.subscribe('selectSlot', (event) => {\n\t\t\tconst newSelectedSlot = event.data;\n\t\t\tif (this.#selectedSlot !== newSelectedSlot)\n\t\t\t{\n\t\t\t\tthis.#selectedSlot?.unSelect();\n\t\t\t}\n\n\t\t\tthis.#selectedSlot = newSelectedSlot;\n\t\t});\n\t\tEventEmitter.subscribe('updateTimezone', (event) => {\n\t\t\tthis.#selectedTimezoneOffsetUtc = Util.getTimeZoneOffset(event.getData().timezone);\n\n\t\t\tthis.#hideTimezoneNotice();\n\t\t\tif (this.#shouldShowTimezoneNotice())\n\t\t\t{\n\t\t\t\tthis.#showTimezoneNotice();\n\t\t\t}\n\t\t});\n\t}\n\n\tgetType()\n\t{\n\t\treturn 'slot-list';\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.#getNodeSlotList();\n\t}\n\n\tupdateSlotsList()\n\t{\n\t\tDom.clean(this.#getNodeList());\n\n\t\tconst slotListNode = this.#getNodeListItems();\n\n\t\tDom.append(slotListNode, this.#getNodeList());\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-top');\n\t\tDom.removeClass(this.#getNodeList(), '--shadow-bottom');\n\t}\n\n\t#getNodeSlotList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slotSelector)\n\t\t{\n\t\t\tthis.#layout.slotSelector = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__slot-list-wrap\">\n\t\t\t\t\t${this.#getNodeTitle()}\n\t\t\t\t\t${this.#getNodeList()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (this.#shouldShowTimezoneNotice())\n\t\t\t{\n\t\t\t\tthis.#showTimezoneNotice();\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.slotSelector;\n\t}\n\n\t#getNodeTitle(): HTMLElement\n\t{\n\t\tif (!this.#layout.title)\n\t\t{\n\t\t\tthis.#layout.title = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-bar\">\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-m\">${Loc.getMessage('CALENDAR_SHARING_SLOTS_FREE')}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.title;\n\t}\n\n\t#getNodeTimezoneNotice()\n\t{\n\t\tif (!this.#layout.timezoneNotice)\n\t\t{\n\t\t\tthis.#layout.timezoneNotice = Tag.render`\n\t\t\t\t<div class=\"calendar-pub-timezone-notice calendar-pub-ui__typography-s\">\n\t\t\t\t\t${this.#getNodeTimezoneNoticeText()}\n\t\t\t\t\t<div class=\"calendar-pub-timezone-notice-offset\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE_OFFSET')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getNodeTimezoneNoticeButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tthis.#hideTimezoneNotice();\n\t\t}\n\n\t\treturn this.#layout.timezoneNotice;\n\t}\n\n\t#getNodeTimezoneNoticeText()\n\t{\n\t\tif (!this.#layout.timezoneNoticeText)\n\t\t{\n\t\t\tthis.#layout.timezoneNoticeText = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.timezoneNoticeText;\n\t}\n\n\t#getNodeTimezoneNoticeButton()\n\t{\n\t\tconst button = Tag.render`\n\t\t\t<div class=\"calendar-pub-ui__btn --m\">\n\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_UNDERSTAND')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(button, 'click', () => {\n\t\t\tthis.#hideTimezoneNotice();\n\t\t\tthis.#timezoneNoticeWasUnderstood = true;\n\t\t});\n\n\t\treturn button;\n\t}\n\n\t#shouldShowTimezoneNotice()\n\t{\n\t\tconst timezoneIsVeryDifferent = Math.abs(this.#ownerTimezoneOffsetUtc - this.#selectedTimezoneOffsetUtc) >= 180;\n\n\t\treturn !this.#timezoneNoticeWasUnderstood && timezoneIsVeryDifferent;\n\t}\n\n\t#showTimezoneNotice()\n\t{\n\t\tconst offset = this.#ownerTimezoneOffsetUtc - this.#selectedTimezoneOffsetUtc;\n\t\tthis.#layout.timezoneNoticeText.innerText = this.#getTimezoneNoticeText(offset);\n\t\tDom.style(this.#layout.timezoneNotice, 'display', '');\n\t}\n\n\t#getTimezoneNoticeText(offset)\n\t{\n\t\tconst sign = (offset < 0) ? '+' : '-';\n\t\treturn Loc.getMessage('CALENDAR_SHARING_TIMEZONE_NOTICE', {\n\t\t\t'#OFFSET#': `${sign}${Util.formatDuration(Math.abs(offset))}`,\n\t\t});\n\t}\n\n\t#hideTimezoneNotice()\n\t{\n\t\tDom.style(this.#layout.timezoneNotice, 'display', 'none');\n\t}\n\n\t#getNodeList(): HTMLElement\n\t{\n\t\tif (!this.#layout.slots)\n\t\t{\n\t\t\tthis.#layout.slots = Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --overflow-hidden --shadow\">\n\t\t\t\t\t${this.#getNodeListItems()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#layout.slots;\n\t}\n\n\t#getNodeListItems(): HTMLElement\n\t{\n\t\tconst currentDaySlots = this.#slots\n\t\t\t.map((slot) => new SlotItem({\n\t\t\t\tvalue: {\n\t\t\t\t\tfrom: slot.timeFrom,\n\t\t\t\t\tto: slot.timeTo,\n\t\t\t\t},\n\t\t\t}));\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"calendar-sharing__slots\">\n\t\t\t\t${this.#getNodeTimezoneNotice()}\n\t\t\t\t${currentDaySlots.map((slotItem) => slotItem.render())}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(result, 'scroll', () => {\n\t\t\tif (result.scrollTop > 0)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-top');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#getNodeList(), '--shadow-top');\n\t\t\t}\n\n\t\t\tif (result.scrollHeight > result.offsetHeight\n\t\t\t\t&& Math.ceil(result.offsetHeight + result.scrollTop) < result.scrollHeight)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tif (result.scrollHeight > result.offsetHeight)\n\t\t\t{\n\t\t\t\tDom.addClass(this.#getNodeList(), '--shadow-bottom');\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n}\n","import { Dom, Event, Loc, Tag, Type, Browser, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Member, MembersList } from '../../layout/members-list';\nimport WidgetDate from '../widget-date';\nimport { DateTimeFormat } from 'main.date';\nimport { BottomSheet } from 'ui.bottomsheet';\nimport 'ui.icon-set.actions';\n\ntype File = {\n\tlink: string,\n\tname: string,\n\tsize: number,\n};\n\nexport type Props = {\n\teventNotFound: {\n\t\ttitle: string,\n\t\tsubtitle: string,\n\t},\n\n\teventName: string,\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tbrowserTimezone: string,\n\tisFullDay: boolean,\n\tmembers: Member[],\n\tlocation: string,\n\tdescription: string,\n\tfiles: File[],\n\trruleDescription: string,\n\tallAttendees: boolean,\n\tfilled: boolean,\n\n\ttitle: string,\n\n\ticonClassName: string,\n\n\tonDeleteEvent: function,\n\tcancelledInfo: {\n\t\tdate: Date,\n\t\tname: string,\n\t},\n\n\tshowBackCalendarButton: boolean,\n\tbottomButtons: {\n\t\tonAcceptInvitation: function,\n\t\tonDeclineInvitation: function,\n\t\tonDownloadIcs: function,\n\t\tonStartVideoconference: function,\n\t\tonReturnToCalendar: function,\n\t},\n\n\tpoweredLabel: {\n\t\tisRu: boolean,\n\t},\n};\n\nexport default class EventLayout\n{\n\t#props;\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tacceptButton: HTMLElement,\n\t\tdeclineButton: HTMLElement,\n\t\ticsButton: HTMLElement,\n\t\tvideoconferenceButton: HTMLElement,\n\n\t\tdescription: HTMLElement,\n\t\texpandButton: HTMLElement,\n\t\tcollapseButton: HTMLElement,\n\t};\n\n\tstatic descriptionCollapsed = true;\n\n\tconstructor(props: Props)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#layout = {};\n\t}\n\n\tupdate(props)\n\t{\n\t\tthis.#props = props;\n\n\t\tthis.render();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst wrap = this.#renderEvent();\n\n\t\tthis.#layout.wrap?.replaceWith(wrap);\n\t\tthis.#layout.wrap = wrap;\n\n\t\treturn wrap;\n\t}\n\n\t#renderEvent(): HTMLElement\n\t{\n\t\tif (this.#props.eventNotFound)\n\t\t{\n\t\t\treturn this.#renderEventNotFound();\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result\">\n\t\t\t\t${this.#renderPoweredLabel()}\n\t\t\t\t${this.#renderBackButton()}\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#renderNodeIcon()}\n\t\t\t\t\t${this.#renderEventNameNode()}\n\t\t\t\t\t${this.#renderStateTitleNode()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#renderWidgetDate()}\n\t\t\t\t\t${this.#renderProps()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t${this.#renderCancelContent()}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --top-auto\">\n\t\t\t\t\t${this.#renderBottomButtons()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderEventNotFound(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result\">\n\t\t\t\t<div class=\"calendar-sharing__calendar-block --form --center\">\n\t\t\t\t\t<div class=\"calendar-sharing__form-result_icon --decline\"></div>\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-title --center --line-height-normal\">\n\t\t\t\t\t\t${this.#props.eventNotFound.title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"calendar-pub-ui__typography-s --center\">\n\t\t\t\t\t\t${this.#props.eventNotFound.subtitle}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderPoweredLabel(): HTMLElement|string\n\t{\n\t\tif (!this.#props.poweredLabel)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__block-label ${this.#props.poweredLabel.isRu ? '--ru' : ''}\"></div>\n\t\t`;\n\t}\n\n\t#renderWidgetDate(): HTMLElement\n\t{\n\t\tconst widgetDate = new WidgetDate({\n\t\t\tallAttendees: this.#props.allAttendees,\n\t\t\tfilled: this.#props.filled,\n\t\t\tbrowserTimezone: this.#props.browserTimezone,\n\t\t});\n\n\t\tif (this.#props.from && this.#props.to)\n\t\t{\n\t\t\twidgetDate.updateValue({\n\t\t\t\tfrom: this.#props.from,\n\t\t\t\tto: this.#props.to,\n\t\t\t\ttimezone: this.#props.timezone,\n\t\t\t\tisFullDay: this.#props.isFullDay,\n\t\t\t\trruleDescription: this.#props.rruleDescription,\n\t\t\t\tmembers: this.#props.members,\n\t\t\t});\n\t\t}\n\n\t\treturn widgetDate.render();\n\t}\n\n\t#renderProps(): HTMLElement|string\n\t{\n\t\tif (!this.#props.allAttendees)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__event-props\">\n\t\t\t\t${this.#renderMembers()}\n\t\t\t\t${this.#renderLocation()}\n\t\t\t\t${this.#renderFiles()}\n\t\t\t\t${this.#renderDescription()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderMembers(): HTMLElement\n\t{\n\t\treturn new MembersList({\n\t\t\tclassName: 'calendar-pub__event-prop',\n\t\t\ttextClassName: 'calendar-pub-ui__typography-xs',\n\t\t\tavatarSize: 30,\n\t\t\tmembers: this.#props.members,\n\t\t\tallAttendees: this.#props.allAttendees,\n\t\t\tmaxAvatarsCount: 8,\n\t\t}).render();\n\t}\n\n\t#renderLocation(): HTMLElement|string\n\t{\n\t\tif (!Type.isStringFilled(this.#props.location))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__event-prop\">\n\t\t\t\t<div class=\"calendar-pub-ui__typography-xs\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_MEETING_LOCATION')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub-ui__typography-sm\">\n\t\t\t\t\t${Text.encode(this.#props.location)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDescription(): HTMLElement|string\n\t{\n\t\tif (!Type.isStringFilled(this.#props.description))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.description = Tag.render`\n\t\t\t<div class=\"calendar-pub-ui__typography-sm\">\n\t\t\t\t${this.#props.description}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (EventLayout.descriptionCollapsed)\n\t\t{\n\t\t\tconst collapseHeight = 100;\n\t\t\tthis.#layout.description.style.overflow = 'hidden';\n\t\t\tthis.#layout.description.style.maxHeight = `${collapseHeight}px`;\n\t\t\tsetTimeout(() => this.#collapseDescription(collapseHeight, false));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#layout.description.append(this.#renderCollapseButton());\n\t\t\tthis.#updateExpandCollapseButtonMargin(this.#layout.collapseButton);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__event-prop\">\n\t\t\t\t<div class=\"calendar-pub-ui__typography-xs\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_MEETING_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.description}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderFiles(): HTMLElement|string\n\t{\n\t\tif (!Type.isArrayFilled(this.#props.files))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__event-prop\">\n\t\t\t\t<div class=\"calendar-pub-ui__typography-xs\">\n\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_MEETING_FILES')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"calendar-pub-ui__typography-sm\">\n\t\t\t\t\t${this.#props.files.map((file) => this.#renderFile(file))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderFile(file: File): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"calendar-pub__event-file\">\n\t\t\t\t<a class=\"calendar-pub__event-file-name\" href=\"${encodeURI(file.link)}\">\n\t\t\t\t\t${Text.encode(file.name)}\n\t\t\t\t</a>\n\t\t\t\t<span class=\"calendar-pub__event-file-size\">${file.size}</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#collapseDescription(maxHeight: number, animate: boolean = true): void\n\t{\n\t\tthis.#setExpandCollapseButtonMargin(this.#layout.expandButton);\n\t\tthis.#layout.collapseButton?.remove();\n\t\tconst startHeight = this.#layout.description.offsetHeight;\n\n\t\tconst children = [...this.#layout.description.childNodes];\n\t\tlet lastVisible;\n\t\tlet height = 0;\n\t\tfor (let child of children)\n\t\t{\n\t\t\tif (child.nodeName === '#text')\n\t\t\t{\n\t\t\t\tconst span = Tag.render`<span>${Text.encode(child.textContent)}</span>`;\n\t\t\t\tchild.replaceWith(span);\n\t\t\t\tchild = span;\n\t\t\t}\n\t\t\tif (height > maxHeight)\n\t\t\t{\n\t\t\t\tchild.style.display = 'none';\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet childHeight = child.getBoundingClientRect().height;\n\t\t\tif (child.nodeName === 'BR' && child.previousSibling.nodeName !== 'BR')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (height < maxHeight && height + childHeight > maxHeight)\n\t\t\t{\n\t\t\t\tlastVisible = child;\n\t\t\t\tchild.after(this.#renderExpandButton());\n\t\t\t}\n\t\t\theight += childHeight;\n\t\t}\n\n\t\tthis.#layout.description.style.height = '';\n\t\tthis.#layout.description.style.maxHeight = '';\n\n\t\tif (lastVisible)\n\t\t{\n\t\t\tconst extraLines = (this.#layout.description.offsetHeight - maxHeight) / 20;\n\t\t\tif (extraLines > 2)\n\t\t\t{\n\t\t\t\tlastVisible.innerText = lastVisible.innerText.slice(0, -35 * (extraLines - 1));\n\t\t\t}\n\n\t\t\twhile (this.#layout.description.offsetHeight > maxHeight)\n\t\t\t{\n\t\t\t\tlastVisible.innerText = lastVisible.innerText.slice(0, -2);\n\t\t\t\tif (lastVisible.innerText === '')\n\t\t\t\t{\n\t\t\t\t\tconst previousVisible = lastVisible.previousSibling;\n\t\t\t\t\tlastVisible.remove();\n\t\t\t\t\tlastVisible = previousVisible;\n\t\t\t\t}\n\t\t\t\tlastVisible.innerHTML += '&mldr;';\n\t\t\t}\n\t\t}\n\n\t\tthis.#updateExpandCollapseButtonMargin(this.#layout.expandButton);\n\n\t\tif (animate)\n\t\t{\n\t\t\tthis.#animateDescriptionHeight(startHeight, maxHeight);\n\t\t}\n\n\t\tEventLayout.descriptionCollapsed = true;\n\t}\n\n\t#expandDescription(): void\n\t{\n\t\tthis.#setExpandCollapseButtonMargin(this.#layout.collapseButton);\n\t\tconst height = this.#layout.description.offsetHeight;\n\t\tthis.#layout.description.innerHTML = this.#props.description;\n\t\tthis.#layout.description.append(this.#renderCollapseButton());\n\t\tthis.#updateExpandCollapseButtonMargin(this.#layout.collapseButton);\n\t\tthis.#animateDescriptionHeight(height, this.#layout.description.offsetHeight);\n\t\tEventLayout.descriptionCollapsed = false;\n\t}\n\n\t#updateExpandCollapseButtonMargin(button: HTMLElement): void\n\t{\n\t\tconst span = Tag.render`\n\t\t\t<span>\n\t\t\t\t${button.previousSibling.cloneNode(true)}\n\t\t\t</span>\n\t\t`;\n\n\t\tbutton.previousSibling.replaceWith(span);\n\n\t\tif (span.offsetTop !== button.offsetTop)\n\t\t{\n\t\t\tDom.style(span, 'margin-right', '5px');\n\t\t\tDom.style(button, 'margin-left', '');\n\t\t}\n\t}\n\n\t#setExpandCollapseButtonMargin(button: HTMLElement): void\n\t{\n\t\tDom.style(button, 'margin-left', '5px');\n\t}\n\n\t#animateDescriptionHeight(startHeight: number, endHeight: number): void\n\t{\n\t\tconst animationDuration = 200;\n\t\tthis.#layout.description.style.height = `${startHeight}px`;\n\t\tthis.#layout.description.style.transition = `height ${animationDuration}ms ease`;\n\t\tsetTimeout(() => {\n\t\t\tthis.#layout.description.style.height = `${endHeight}px`;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.#layout.description.style.height = '';\n\t\t\t\tthis.#layout.description.style.transition = '';\n\t\t\t}, animationDuration);\n\t\t});\n\t}\n\n\t#renderExpandButton(): HTMLElement\n\t{\n\t\tif (this.#layout.expandButton)\n\t\t{\n\t\t\treturn this.#layout.expandButton;\n\t\t}\n\n\t\tthis.#layout.expandButton = Tag.render`\n\t\t\t<div class=\"calendar-pub__link-button\" style=\"margin-left: 5px;\">\n\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_EXPAND')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.expandButton, 'click', () => this.#expandDescription());\n\n\t\treturn this.#layout.expandButton;\n\t}\n\n\t#renderCollapseButton(): HTMLElement\n\t{\n\t\tif (this.#layout.collapseButton)\n\t\t{\n\t\t\treturn this.#layout.collapseButton;\n\t\t}\n\n\t\tthis.#layout.collapseButton = Tag.render`\n\t\t\t<div class=\"calendar-pub__link-button\" style=\"margin-left: 5px;\">\n\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_COLLAPSE')}\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.collapseButton, 'click', () => this.#collapseDescription(100));\n\n\t\treturn this.#layout.collapseButton;\n\t}\n\n\t#renderNodeIcon(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-sharing__form-result_icon ${this.#props.iconClassName}\"></div>\n\t\t`;\n\t}\n\n\t#renderBackButton(): HTMLElement\n\t{\n\t\tif (this.#props.showBackCalendarButton)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-sharing__calendar-bar --arrow\">\n\t\t\t\t\t<div class=\"calendar-sharing__calendar-back\" onclick=\"${this.#onReturnButtonClick.bind(this)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`<div class=\"calendar-sharing__calendar-bar --no-margin\"></div>`;\n\t}\n\n\t#renderEventNameNode(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub-ui__typography-title --center --line-height-normal\">\n\t\t\t\t${Text.encode(this.#props.eventName)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderStateTitleNode(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub-ui__typography-s --center\">\n\t\t\t\t${this.#props.title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderCancelContent(): HTMLElement|string\n\t{\n\t\tif (this.#props.onDeleteEvent)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${this.showCancelEventPopup.bind(this)}\" class=\"calendar-pub__form-status --decline\">\n\t\t\t\t\t<div class=\"ui-icon-set --undo-1\"></div>\n\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_DECLINE_MEETING')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.#props.onDeclineEvent)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${this.#props.onDeclineEvent}\" class=\"calendar-pub__form-status --decline\">\n\t\t\t\t\t<div class=\"ui-icon-set --cross-45\"></div>\n\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t${Loc.getMessage('CALENDAR_SHARING_DECISION_DECLINE_MEETING')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tif (this.#props.cancelledInfo)\n\t\t{\n\t\t\tconst dayMonthFormat = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\t\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst format = `${dayMonthFormat} ${shortTimeFormat}`;\n\t\t\tconst dateFormatted = DateTimeFormat.format(format, this.#props.cancelledInfo.date.getTime() / 1000);\n\n\t\t\tconst cancelledByEncoded = Text.encode(this.#props.cancelledInfo.name);\n\t\t\tconst cancelledByText = `${Loc.getMessage('CALENDAR_SHARING_WHO_CANCELED')}: ${cancelledByEncoded}`;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"calendar-pub__form-status\">\n\t\t\t\t\t<div class=\"calendar-pub__form-status_text\">\n\t\t\t\t\t\t${cancelledByText}<br> ${dateFormatted}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\t#renderBottomButtons(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.#getBottomButtons()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getBottomButtons(): HTMLElement[]\n\t{\n\t\tconst buttons = [];\n\n\t\tif (this.#props.bottomButtons.onAcceptInvitation)\n\t\t{\n\t\t\tbuttons.push(this.#renderAcceptButton());\n\t\t}\n\n\t\tif (this.#props.bottomButtons.onDeclineInvitation)\n\t\t{\n\t\t\tbuttons.push(this.#renderDeclineButton());\n\t\t}\n\n\t\tif (this.#props.bottomButtons.onStartVideoconference)\n\t\t{\n\t\t\tbuttons.push(this.#renderVideoconferenceButton());\n\t\t}\n\n\t\tif (this.#props.bottomButtons.onDownloadIcs)\n\t\t{\n\t\t\tbuttons.push(this.#renderIcsButton());\n\t\t}\n\n\t\tif (this.#props.bottomButtons.onReturnToCalendar)\n\t\t{\n\t\t\tbuttons.push(this.#renderReturnToCalendarButton());\n\t\t}\n\n\t\treturn buttons;\n\t}\n\n\t#renderAcceptButton(): HTMLElement\n\t{\n\t\tthis.#layout.acceptButton = this.#renderButton(\n\t\t\tLoc.getMessage('CALENDAR_SHARING_ACCEPT'),\n\t\t\tthis.#onAcceptButtonClick.bind(this),\n\t\t);\n\n\t\treturn this.#layout.acceptButton;\n\t}\n\n\tasync #onAcceptButtonClick(): Promise\n\t{\n\t\tDom.addClass(this.#layout.acceptButton, '--wait');\n\t\tawait this.#props.bottomButtons.onAcceptInvitation();\n\t\tDom.removeClass(this.#layout.acceptButton, '--wait');\n\t}\n\n\t#renderDeclineButton(): HTMLElement\n\t{\n\t\tthis.#layout.declineButton = this.#renderButton(\n\t\t\tLoc.getMessage('CALENDAR_SHARING_DECLINE'),\n\t\t\tthis.#onDeclineButtonClick.bind(this),\n\t\t\t'--light-border',\n\t\t);\n\n\t\treturn this.#layout.declineButton;\n\t}\n\n\tasync #onDeclineButtonClick(): Promise\n\t{\n\t\tDom.addClass(this.#layout.declineButton, '--wait');\n\t\tawait this.#props.bottomButtons.onDeclineInvitation();\n\t\tDom.removeClass(this.#layout.declineButton, '--wait');\n\t}\n\n\t#renderVideoconferenceButton(): HTMLElement\n\t{\n\t\tthis.#layout.videoconferenceButton = this.#renderButton(\n\t\t\tLoc.getMessage('CALENDAR_SHARING_OPEN_VIDEOCONFERENCE'),\n\t\t\tthis.#onVideoconferenceButtonClick.bind(this),\n\t\t);\n\n\t\treturn this.#layout.videoconferenceButton;\n\t}\n\n\tasync #onVideoconferenceButtonClick(): Promise\n\t{\n\t\tDom.addClass(this.#layout.videoconferenceButton, '--wait');\n\t\tawait this.#props.bottomButtons.onStartVideoconference();\n\t\tDom.removeClass(this.#layout.videoconferenceButton, '--wait');\n\t}\n\n\t#renderIcsButton(): HTMLElement\n\t{\n\t\tthis.#layout.icsButton = this.#renderButton(\n\t\t\tLoc.getMessage('CALENDAR_SHARING_ADD_TO_CALENDAR'),\n\t\t\tthis.#onIcsButtonClick.bind(this),\n\t\t\t'--light-border',\n\t\t);\n\n\t\treturn this.#layout.icsButton;\n\t}\n\n\tasync #onIcsButtonClick(): Promise\n\t{\n\t\tDom.addClass(this.#layout.icsButton, '--wait');\n\t\tawait this.#props.bottomButtons.onDownloadIcs();\n\t\tDom.removeClass(this.#layout.icsButton, '--wait');\n\t}\n\n\t#renderReturnToCalendarButton(): HTMLElement\n\t{\n\t\treturn this.#renderButton(\n\t\t\tLoc.getMessage('CALENDAR_SHARING_RETURN_TO_SLOT_LIST'),\n\t\t\tthis.#onReturnButtonClick.bind(this),\n\t\t\t'--light-border',\n\t\t);\n\t}\n\n\t#onReturnButtonClick(): void\n\t{\n\t\tthis.#props.bottomButtons.onReturnToCalendar();\n\t}\n\n\t#renderButton(text, action, className): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div\n\t\t\t\tonclick=\"${action}\"\n\t\t\t\tclass=\"calendar-pub-ui__btn ${className} --m calendar-pub-action-btn\"\n\t\t\t>\n\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${text}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowCancelEventPopup(): void\n\t{\n\t\tthis.#getPopup().show();\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (!this.popup)\n\t\t{\n\t\t\tconst popupContent = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-title\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-info\">${Loc.getMessage('CALENDAR_SHARING_POPUP_MEETING_CANCELED_INFO')}</div>\n\t\t\t\t\t<div class=\"calendar-pub__cookies-buttons ${Browser.isMobile() ? '--center' : '--flex-end'}\">\n\t\t\t\t\t\t<div onclick=\"${this.#closeCancelEventPopup.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --light-border\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_LEAVE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div onclick=\"${this.#onDeleteButtonClick.bind(this)}\" class=\"calendar-pub-ui__btn --inline --m --secondary\">\n\t\t\t\t\t\t\t<div class=\"calendar-pub-ui__btn-text\">${Loc.getMessage('CALENDAR_SHARING_POPUP_CANCEL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (Browser.isMobile())\n\t\t\t{\n\t\t\t\tthis.popup = new BottomSheet({\n\t\t\t\t\tclassName: 'calendar-pub__state',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\tpadding: '20px 25px',\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tclassName: 'calendar-pub__popup',\n\t\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\t\twidth: 380,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tcontent: popupContent,\n\t\t\t\t\toverlay: true,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn this.popup;\n\t}\n\n\t#closeCancelEventPopup(): void\n\t{\n\t\tthis.#getPopup().close();\n\t}\n\n\tasync #onDeleteButtonClick(): void\n\t{\n\t\tthis.#closeCancelEventPopup();\n\t\tthis.#props.onDeleteEvent();\n\t}\n}\n","import { Member } from '../../layout/members-list';\nimport Base from '../base';\nimport { Util } from 'calendar.util';\nimport { Loc, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport EventLayout from './event-layout';\n\ntype State = 'created' | 'not-created' | 'declined' ;\n\ntype EventData = {\n\tfrom: Date,\n\tto: Date,\n\ttimezone: string,\n\tisFullDay: boolean,\n\teventLinkHash: string,\n\teventName: string,\n\tstate: State,\n\tisView: boolean,\n\teventId: boolean,\n\tuserName: string,\n}\n\ntype EventOptions = {\n\tisHiddenOnStart: boolean,\n\towner: any,\n\tevent: any,\n\teventLinkHash: any,\n\tstate: State,\n\tisView: boolean,\n\teventId: number,\n\ttimezone: string,\n\tinDeletedSlider: boolean,\n\taction: string,\n\tcanceledByManager: boolean,\n\tshowBackCalendarButtons: boolean,\n\tmembers: Member[],\n};\n\nexport default class Event extends Base\n{\n\t#event;\n\t#owner;\n\t#currentTimezone;\n\t#icsFile;\n\t#layout;\n\t#value;\n\t#state;\n\t#inDeletedSlider;\n\t#isView;\n\t#showBackCalendarButtons;\n\n\t#eventLayout: EventLayout;\n\n\tconstructor(options: EventOptions)\n\t{\n\t\tsuper({ isHiddenOnStart: options.isHiddenOnStart });\n\n\t\tthis.#state = options.state;\n\t\tthis.#isView = options.isView;\n\t\tthis.#event = options.event;\n\t\tthis.#owner = options.owner;\n\t\tthis.#currentTimezone = options.timezone ?? Intl.DateTimeFormat().resolvedOptions().timeZone;\n\t\tthis.#layout = {\n\t\t\tback: null,\n\t\t\twidgetDate: null,\n\t\t\teventName: null,\n\t\t\ticon: null,\n\t\t\tstateTitle: null,\n\t\t\tadditionalBlock: null,\n\t\t\tbottomButton: null,\n\t\t};\n\t\tthis.#value = {\n\t\t\tfrom: null,\n\t\t\tto: null,\n\t\t\ttimezone: null,\n\t\t\tisFullDay: false,\n\t\t\tcanceledTimestamp: null,\n\t\t\tcanceledUserName: null,\n\t\t\teventName: null,\n\t\t\tcanceledByManager: options.canceledByManager,\n\t\t\teventLinkHash: options.eventLinkHash,\n\t\t\teventId: options.eventId,\n\t\t\tmembers: options.members,\n\t\t};\n\t\tthis.#icsFile = null;\n\t\tthis.#inDeletedSlider = options.inDeletedSlider === true;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\n\t\tif (this.#event)\n\t\t{\n\t\t\tthis.#initEventData();\n\t\t}\n\n\t\tthis.#eventLayout = new EventLayout(this.#getLayoutProps());\n\n\t\tif (options.action === 'cancel')\n\t\t{\n\t\t\tsetTimeout(() => this.#eventLayout.showCancelEventPopup(), 0);\n\t\t}\n\n\t\tif (options.action === 'ics')\n\t\t{\n\t\t\tthis.downloadIcsFile();\n\t\t}\n\n\t\tif (options.action === 'videoconference')\n\t\t{\n\t\t\tthis.startVideoconference();\n\t\t}\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn 'event';\n\t}\n\n\t#initEventData()\n\t{\n\t\tthis.#value.from = Util.getTimezoneDateFromTimestampUTC(\n\t\t\tparseInt(this.#event.timestampFromUTC, 10) * 1000,\n\t\t\tthis.#currentTimezone,\n\t\t);\n\t\tthis.#value.to = Util.getTimezoneDateFromTimestampUTC(\n\t\t\tparseInt(this.#event.timestampToUTC, 10) * 1000,\n\t\t\tthis.#currentTimezone,\n\t\t);\n\t\tthis.#value.timezone = this.#currentTimezone;\n\t\tthis.#value.isFullDay = this.#event.isFullDay;\n\t\tthis.#value.eventName = this.#getEventName();\n\t\tthis.#value.canceledTimestamp = this.#event.canceledTimestamp;\n\t\tthis.#value.canceledUserName = this.#event.externalUserName;\n\t}\n\n\tupdateValue(data: EventData)\n\t{\n\t\tif (data.from)\n\t\t{\n\t\t\tthis.#value.from = data.from;\n\t\t}\n\n\t\tif (data.to)\n\t\t{\n\t\t\tthis.#value.to = data.to;\n\t\t}\n\n\t\tif (data.timezone)\n\t\t{\n\t\t\tthis.#value.timezone = data.timezone;\n\t\t}\n\n\t\tif (Type.isBoolean(data.isFullDay))\n\t\t{\n\t\t\tthis.#value.isFullDay = data.isFullDay;\n\t\t}\n\n\t\tif (data.eventLinkHash)\n\t\t{\n\t\t\tthis.#value.eventLinkHash = data.eventLinkHash;\n\t\t}\n\n\t\tif (data.eventName)\n\t\t{\n\t\t\tthis.#value.eventName = data.eventName;\n\t\t}\n\n\t\tif (data.state)\n\t\t{\n\t\t\tthis.#state = data.state;\n\t\t}\n\n\t\tif (data.isView)\n\t\t{\n\t\t\tthis.#isView = false;\n\t\t}\n\n\t\tif (data.eventId)\n\t\t{\n\t\t\tthis.#value.eventId = data.eventId;\n\t\t}\n\n\t\tif (data.userName)\n\t\t{\n\t\t\tthis.#value.canceledUserName = data.userName;\n\t\t}\n\n\t\tif (this.#value.canceledByManager === true)\n\t\t{\n\t\t\tthis.#value.canceledByManager = false;\n\t\t}\n\n\t\tthis.#eventLayout.update(this.#getLayoutProps());\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.#eventLayout.render();\n\t}\n\n\t#getLayoutProps()\n\t{\n\t\treturn {\n\t\t\teventName: this.#value.eventName,\n\t\t\tfrom: this.#value.from,\n\t\t\tto: this.#value.to,\n\t\t\ttimezone: this.#value.timezone,\n\t\t\tisFullDay: this.#value.isFullDay,\n\t\t\tmembers: this.#value.members,\n\n\t\t\ttitle: this.#getStateTitleTextByState(this.#state),\n\n\t\t\ticonClassName: this.#getIconClassByState(this.#state),\n\n\t\t\tonDeleteEvent: this.#state === 'created' ? this.deleteEvent.bind(this) : '',\n\t\t\tcancelledInfo: this.#getCancelledInfo(),\n\n\t\t\tshowBackCalendarButton: this.#showBackCalendarButtons,\n\t\t\tbottomButtons: this.#getBottomButtons(),\n\t\t};\n\t}\n\n\t#getCancelledInfo(): any\n\t{\n\t\tif (this.#state === 'declined')\n\t\t{\n\t\t\tconst cancelledDate = Util.getTimezoneDateFromTimestampUTC(\n\t\t\t\tparseInt(this.#value.canceledTimestamp, 10) * 1000,\n\t\t\t\tthis.#currentTimezone,\n\t\t\t);\n\t\t\tif (this.#value.canceledByManager)\n\t\t\t{\n\t\t\t\tthis.#value.canceledUserName = `${this.#owner.name} ${this.#owner.lastName}`;\n\t\t\t}\n\n\t\t\tif (this.#value.canceledTimestamp && this.#value.canceledUserName && cancelledDate)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tdate: cancelledDate,\n\t\t\t\t\tname: this.#value.canceledUserName,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getBottomButtons()\n\t{\n\t\tconst bottomButtons = {};\n\n\t\tif (this.#state === 'created')\n\t\t{\n\t\t\tbottomButtons.onStartVideoconference = this.startVideoconference.bind(this);\n\t\t\tbottomButtons.onDownloadIcs = this.downloadIcsFile.bind(this);\n\t\t}\n\n\t\tif (['not-created', 'declined'].includes(this.#state) && this.#showBackCalendarButtons)\n\t\t{\n\t\t\tbottomButtons.onReturnToCalendar = this.#onReturnButtonClick.bind(this);\n\t\t}\n\n\t\treturn bottomButtons;\n\t}\n\n\t#getIconClassByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tresult = '--accept';\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t\tcase 'declined':\n\t\t\t\tresult = '--decline';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#getStateTitleTextByState(state: State)\n\t{\n\t\tlet result = '';\n\t\tswitch (state)\n\t\t{\n\t\t\tcase 'created':\n\t\t\t\tif (!this.#isView)\n\t\t\t\t{\n\t\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CREATED');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'not-created':\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_NOT_CREATED');\n\t\t\t\tbreak;\n\t\t\tcase 'declined':\n\t\t\t\tresult = Loc.getMessage('CALENDAR_SHARING_MEETING_CANCELED');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync deleteEvent()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.deleteEvent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventId: this.#value.eventId,\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tresponse = e;\n\t\t}\n\n\t\tif (response.errors.length === 0)\n\t\t{\n\t\t\tthis.#value.canceledTimestamp = Date.now() / 1000;\n\t\t\tthis.#state = 'declined';\n\t\t\tthis.#eventLayout.update(this.#getLayoutProps());\n\t\t\tEventEmitter.emit('onDeleteEvent');\n\t\t}\n\n\t\treturn response.errors.length === 0;\n\t}\n\n\tasync startVideoconference()\n\t{\n\t\tlet response = null;\n\t\ttry\n\t\t{\n\t\t\tresponse = await BX.ajax.runAction('calendar.api.sharingajax.getConferenceLink', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(error);\n\t\t}\n\n\t\tconst conferenceLink = response?.data?.conferenceLink;\n\n\t\tif (conferenceLink)\n\t\t{\n\t\t\twindow.location.href = conferenceLink;\n\t\t}\n\t}\n\n\tasync downloadIcsFile()\n\t{\n\t\tif (!this.#icsFile)\n\t\t{\n\t\t\tconst response = await BX.ajax.runAction('calendar.api.sharingajax.getIcsFileContent', {\n\t\t\t\tdata: {\n\t\t\t\t\teventLinkHash: this.#value.eventLinkHash,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.#icsFile = response.data;\n\t\t}\n\n\t\tUtil.downloadIcsFile(this.#icsFile, 'event');\n\t}\n\n\t#onReturnButtonClick()\n\t{\n\t\tEventEmitter.emit('onCreateAnotherEventButtonClick');\n\t}\n\n\t#getEventName()\n\t{\n\t\treturn Loc.getMessage('CALENDAR_SHARING_EVENT_NAME', {\n\t\t\t'#OWNER_NAME#': `${this.#owner.name} ${this.#owner.lastName}`,\n\t\t});\n\t}\n}\n","import { Dom, Tag, Type } from 'main.core';\nimport { Form } from './form/index';\nimport { EmptyState, AccessDenied } from './empty-state/index';\nimport { SlotList } from './slot-list/index';\nimport { Event } from './event/index';\nimport { EventEmitter } from 'main.core.events';\nimport { Member } from '../layout/members-list';\n\ntype SlotSelectorOptions = {\n\tselectedTimezoneId: number,\n\towner: any,\n\tlink: any,\n\tmembers: Member[],\n\tsharingUser: any,\n\thasContactData: boolean,\n\tcalendarSettings: any,\n\teventLinkHash: any,\n\tevent: any,\n\taction: string,\n\tshowBackCalendarButtons: any,\n};\n\nexport default class SlotSelector\n{\n\t#layout;\n\t#components;\n\t#selectedTimezoneId;\n\t#owner;\n\t#link;\n\t#sharingUser;\n\t#isFromCrm;\n\t#hasContactData;\n\t#calendarSettings;\n\t#eventLinkHash;\n\t#event;\n\t#members;\n\t#action;\n\t#showBackCalendarButtons;\n\n\tBLOCK_NAME_FORM = 'form';\n\tBLOCK_NAME_SLOT_LIST = 'slot-list';\n\tBLOCK_NAME_EMPTY_STATE = 'empty-state';\n\tBLOCK_NAME_ACCESS_DENIED = 'access-denied';\n\tBLOCK_NAME_EVENT = 'event';\n\n\tconstructor(options: SlotSelectorOptions)\n\t{\n\t\tthis.#selectedTimezoneId = options.selectedTimezoneId;\n\t\tthis.#owner = options.owner;\n\t\tthis.#link = options.link;\n\t\tthis.#sharingUser = options.sharingUser;\n\t\tthis.#eventLinkHash = options.eventLinkHash;\n\t\tthis.#event = options.event;\n\t\tthis.#members = options.members;\n\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tempty: null,\n\t\t\ttitle: null,\n\t\t\tslots: null,\n\t\t\tslotSelector: null,\n\t\t};\n\t\tthis.#components = {\n\t\t\tform: null,\n\t\t\tslotList: null,\n\t\t\temptyState: null,\n\t\t\tevent: null,\n\t\t\taccessDenied: null,\n\t\t};\n\t\tthis.#isFromCrm = this.#link.type === 'crm_deal';\n\t\tthis.#hasContactData = options.hasContactData;\n\t\tthis.#calendarSettings = options.calendarSettings;\n\t\tthis.#showBackCalendarButtons = options.showBackCalendarButtons;\n\t\tthis.#action = options.action;\n\n\t\tthis.#bindEvents();\n\t\t// EventEmitter.subscribe('selectorStateChange', this.showForm.bind(this));\n\t\t// EventEmitter.subscribe('hideForm', this.hideForm.bind(this));\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('confirmedSelectSlot', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tconst value = data.value;\n\t\t\tthis.#components.form.updateFormValue({\n\t\t\t\tfrom: value.from,\n\t\t\t\tto: value.to,\n\t\t\t\ttimezone: this.#selectedTimezoneId,\n\t\t\t});\n\t\t\tthis.openForm();\n\t\t});\n\n\t\tEventEmitter.subscribe('switchSlots', (event) => {\n\t\t\tconst slots = event.data.slots ?? [];\n\t\t\tif (slots.length > 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit('updateSlotsList', event);\n\t\t\t\tthis.openSlotList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.openEmptyState();\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('updateTimezone', (event) => {\n\t\t\tconst data = event.data;\n\t\t\tthis.#selectedTimezoneId = data.timezone;\n\t\t});\n\n\t\tEventEmitter.subscribe('onSaveEvent', (event) => {\n\t\t\tconst eventData = event.data;\n\t\t\tthis.#components.form.cleanDescription();\n\t\t\tthis.#components.event.updateValue(eventData);\n\t\t\tthis.openEvent();\n\t\t});\n\t}\n\n\topenForm()\n\t{\n\t\tthis.#components.form?.clearInputErrors();\n\t\tthis.openBlock(this.BLOCK_NAME_FORM);\n\t}\n\n\topenSlotList()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_SLOT_LIST);\n\t}\n\n\topenEmptyState()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EMPTY_STATE);\n\t}\n\n\topenAccessDenied()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_ACCESS_DENIED);\n\t}\n\n\topenEvent()\n\t{\n\t\tthis.openBlock(this.BLOCK_NAME_EVENT);\n\t}\n\n\topenBlock(blockName)\n\t{\n\t\tEventEmitter.emit('selectorTypeChange', blockName);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#components.form)\n\t\t{\n\t\t\tthis.#components.form = new Form({\n\t\t\t\tisHiddenOnStart: true,\n\t\t\t\towner: this.#owner,\n\t\t\t\tlink: this.#link,\n\t\t\t\tsharingUser: this.#sharingUser,\n\t\t\t\tisFromCrm: this.#isFromCrm,\n\t\t\t\thasContactData: this.#hasContactData,\n\t\t\t\tisPhoneFeatureEnabled: this.#calendarSettings.phoneFeatureEnabled,\n\t\t\t\tisMailFeatureEnabled: this.#calendarSettings.mailFeatureEnabled,\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#components.emptyState)\n\t\t{\n\t\t\tthis.#components.emptyState = new EmptyState({ isHiddenOnStart: true });\n\t\t}\n\n\t\tif (!this.#components.accessDenied)\n\t\t{\n\t\t\tthis.#components.accessDenied = new AccessDenied({ isHiddenOnStart: true });\n\t\t}\n\n\t\tif (!this.#components.slotList)\n\t\t{\n\t\t\tthis.#components.slotList = new SlotList({\n\t\t\t\tisHiddenOnStart: false,\n\t\t\t\townerOffset: parseInt(this.#calendarSettings.serverOffset, 10),\n\t\t\t});\n\t\t}\n\n\t\tif (!this.#components.event)\n\t\t{\n\t\t\tlet state = 'created';\n\n\t\t\tif (this.#link.active === false || this.#event?.meetingStatus === 'N' || this.#event?.deleted === 'Y')\n\t\t\t{\n\t\t\t\tstate = 'declined';\n\t\t\t}\n\n\t\t\tlet canceledByManager = false;\n\t\t\tif (this.#event?.meetingStatus === 'N')\n\t\t\t{\n\t\t\t\tcanceledByManager = true;\n\t\t\t}\n\n\t\t\tthis.#components.event = new Event({\n\t\t\t\tisHiddenOnStart: false,\n\t\t\t\towner: this.#owner,\n\t\t\t\tevent: this.#event,\n\t\t\t\teventLinkHash: this.#eventLinkHash,\n\t\t\t\tstate,\n\t\t\t\teventId: this.#event.id,\n\t\t\t\tisView: Type.isString(this.#eventLinkHash),\n\t\t\t\tcanceledByManager,\n\t\t\t\tshowBackCalendarButtons: this.#showBackCalendarButtons,\n\t\t\t\taction: this.#action,\n\t\t\t\tmembers: this.#members,\n\t\t\t});\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"calendar-pub__slots\">\n\t\t\t\t${this.#components.slotList.render()}\n\t\t\t\t${this.#components.form.render()}\n\t\t\t\t${this.#components.emptyState.render()}\n\t\t\t\t${this.#components.event.render()}\n\t\t\t\t${this.#components.accessDenied.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Tag, Type, Dom } from 'main.core';\nimport Welcome from './components/welcome';\nimport { Calendar } from './components/calendar/index';\nimport { SlotSelector } from './components/slot-selector/index';\nimport { EventEmitter } from 'main.core.events';\n\nimport 'ui.design-tokens';\nimport './style.css';\n\ntype PublicOptions = {\n\ttarget: HTMLElement,\n\tlink: any,\n\tparentLink: any,\n\tevent: any,\n\taction: string,\n\tcurrentLang: string,\n\towner: any,\n}\n\nexport default class PublicV2\n{\n\t#layout;\n\t#owner;\n\t#welcomePage;\n\t#calendar;\n\t#slotsBlock;\n\n\t#linkMembers;\n\t#eventMembers;\n\n\tconstructor(options: PublicOptions)\n\t{\n\t\tthis.#owner = options.owner || null;\n\t\tthis.target = Type.isDomNode(options.target) ? options.target : null;\n\t\tthis.#layout = {\n\t\t\twrapper: null,\n\t\t\tanimate: null,\n\t\t};\n\t\tthis.#welcomePage = null;\n\t\tthis.#calendar = null;\n\t\tthis.#slotsBlock = null;\n\n\t\tthis.#linkMembers = (options.parentLink || options.link).members;\n\t\tthis.#eventMembers = options.link.members ?? options.event.members;\n\n\t\tthis.#init();\n\t\tthis.#bindEvents();\n\n\t\tthis.showPageWelcome(options);\n\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\tif (options.parentLink && options.parentLink.active === true)\n\t\t\t{\n\t\t\t\tthis.#renderFreeSlots(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse if (options.event)\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#welcomePage.setAccessDenied();\n\t\t\t\tthis.#slotsBlock.openEvent();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#renderSlotsSelector(options);\n\t\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\t\tthis.#welcomePage.hideButton();\n\t\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t\t}\n\t\t}\n\t\telse if (options.link.active === true)\n\t\t{\n\t\t\tthis.#renderFreeSlots(options);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#renderSlotsSelector(options);\n\t\t\tthis.#welcomePage.handleWelcomePageButtonClick();\n\t\t\tthis.#welcomePage.hideButton();\n\t\t\tthis.#slotsBlock.openAccessDenied();\n\t\t}\n\n\t\t// this.showFreeSlots();\n\t}\n\n\t#bindEvents()\n\t{\n\t\tEventEmitter.subscribe('showSlotSelector', this.showFreeSlots.bind(this));\n\t\tEventEmitter.subscribe('hideSlotSelector', this.hideFreeSlots.bind(this));\n\t}\n\n\tshowPageWelcome(options)\n\t{\n\t\tif (!options.owner)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#welcomePage = new Welcome({\n\t\t\towner: options.owner,\n\t\t\tlink: options.link,\n\t\t\tcurrentLang: options.currentLang,\n\t\t\tmembers: this.#linkMembers,\n\t\t});\n\n\t\tDom.append(this.#welcomePage.render(), this.#getNodeWrapper());\n\t}\n\n\t#renderFreeSlots(options)\n\t{\n\t\tthis.#calendar = new Calendar({\n\t\t\tuserIds: options.link.userIds,\n\t\t\taccessibility: options.userAccessibility,\n\t\t\ttimezoneList: options.timezoneList,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\trule: options.link.rule,\n\t\t});\n\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: this.#calendar.getSelectedTimezoneId(),\n\t\t\towner: this.#owner,\n\t\t\tlink: options.parentLink || options.link,\n\t\t\tmembers: this.#eventMembers,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: true,\n\t\t\teventLinkHash,\n\t\t\taction: options.action,\n\t\t});\n\n\t\tconst firstNodeWrapper = Tag.render`\n\t\t\t<div class=\"calendar-pub__block --plus\">\n\t\t\t\t${this.#calendar.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t${firstNodeWrapper}\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEventEmitter.subscribe('selectorTypeChange', (ev) => {\n\t\t\tif (ev.data === 'form' || ev.data === 'event')\n\t\t\t{\n\t\t\t\tDom.addClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(firstNodeWrapper, '--hidden');\n\t\t\t}\n\t\t});\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\n\t\tif (options.link.type !== 'event')\n\t\t{\n\t\t\tthis.#calendar.selectFirstAvailableDay();\n\t\t}\n\t}\n\n\t#renderSlotsSelector(options)\n\t{\n\t\tlet eventLinkHash = null;\n\t\tif (options.link.type === 'event')\n\t\t{\n\t\t\teventLinkHash = options.link.hash;\n\t\t}\n\n\t\tthis.#slotsBlock = new SlotSelector({\n\t\t\tselectedTimezoneId: null,\n\t\t\towner: this.#owner,\n\t\t\tlink: options.link,\n\t\t\tsharingUser: options.sharingUser,\n\t\t\thasContactData: options.hasContactData,\n\t\t\tcalendarSettings: options.calendarSettings,\n\t\t\tevent: options.event,\n\t\t\tshowBackCalendarButtons: false,\n\t\t\taction: options.action,\n\t\t\teventLinkHash,\n\t\t});\n\n\t\tthis.#layout.animate = Tag.render`\n\t\t\t<div class=\"calendar-pub__block-animate\">\n\t\t\t\t<div class=\"calendar-pub__block\">\n\t\t\t\t\t${this.#slotsBlock.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.append(this.#layout.animate, this.#getNodeWrapper());\n\t}\n\n\tshowFreeSlots()\n\t{\n\t\tDom.removeClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\thideFreeSlots()\n\t{\n\t\tDom.addClass(this.#getNodeWrapper(), '--hide');\n\t}\n\n\t#getNodeWrapper(): HTMLElement\n\t{\n\t\tif (!this.#layout.wrapper)\n\t\t{\n\t\t\tthis.#layout.wrapper = Tag.render`\n\t\t\t\t<div class=\"calendar-pub__wrapper calendar-pub__state --hide\"></div>\n\t\t\t`;\n\n\t\t\tif (Type.isArrayFilled(this.#linkMembers) || Type.isArrayFilled(this.#eventMembers))\n\t\t\t{\n\t\t\t\tDom.addClass(this.#layout.wrapper, '--large');\n\t\t\t}\n\t\t}\n\n\t\treturn this.#layout.wrapper;\n\t}\n\n\t#render()\n\t{\n\t\tif (!this.target)\n\t\t{\n\t\t\tconsole.warn('BX.Calendar.Sharing: \"target\" is not defined');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.target.parentNode)\n\t\t{\n\t\t\tDom.append(this.#getNodeWrapper(), this.target.parentNode);\n\t\t\tDom.remove(this.target);\n\t\t}\n\t}\n\n\t#init(): void\n\t{\n\t\tthis.#render();\n\t}\n}\n"],"names":["bindShowOnHover","popup","Menu","getPopupWindow","bindElement","container","getPopupContainer","hoverElement","closeMenuHandler","setTimeout","contains","close","showMenuHandler","show","clickHandler","isShown","Event","bind","document","event","target","popupWidth","offsetWidth","elementWidth","angleLeft","Popup","getOption","handleScroll","adjustPosition","angle","setAngle","offset","subscribeFromOptions","onShow","setOffset","offsetLeft","addEventListener","onAfterPopupShow","left","getBoundingClientRect","window","innerWidth","style","element","marginLeft","onClose","removeEventListener","MembersList","constructor","params","members","render","Type","isArrayFilled","wrap","Tag","className","textClassName","avatarSize","menu","MenuManager","create","id","Date","now","avatarItems","items","map","member","html","Text","encode","name","lastName","trim","isOwner","Loc","getMessage","maxHeight","maxWidth","allAttendees","maxAvatarsCount","showMoreIcon","length","avatarsCount","avatarClassName","slice","avatar","isStringFilled","Welcome","options","owner","link","currentLang","photo","wrapper","button","label","type","active","lastStatus","disableButton","Dom","addClass","enableButton","removeClass","hideButton","handleWelcomePageButtonClick","hasClass","EventEmitter","emit","setAccessDenied","info","encodeURI","mode","BX","ajax","runAction","data","linkHash","hash","entityId","entityType","notifyType","subscribe","accessDenied","infoTitle","infoSubTitle","title","subTitle","innerText","Day","value","notCurrentMonth","today","slots","selected","weekend","enableBooking","select","isSelected","getDay","isEnableBooking","highlight","unSelect","Calendar","monthWrapper","timezoneWrapper","month","currentMonth","prevNav","nextNav","daysOfWeek","navigation","back","userIds","accessibility","timezoneList","calendarSettings","rule","Intl","DateTimeFormat","resolvedOptions","timeZone","getMonth","getFullYear","getTimezoneOffset","slotSize","freeTime","stepSize","weekHolidays","weekStart","weekdays","Util","getWeekdaysLoc","nextYear","nextMonth","setInterval","updateEventSlotsList","currentYear","year","selectFirstAvailableDay","visibleDays","days","todayDay","getDate","filter","day","dayToSelect","find","undefined","selectMonthDay","highlightMonthDay","getSelectedTimezoneId","getTimezonePrefix","timezoneOffset","date","getTime","format","getTimeFormatShort","newSelectedDay","state","timezoneNode","clean","append","weekDay","getIndByWeekDay","yearHolidays","push","splice","range","ranges","weekday","from","parseInt","to","intersected","notIntersected","interval","Math","min","max","getTimeZoneOffset","serverOffset","take","array","reduce","t","f","e","daysCount","accessibilityArrayKey","nowTimestamp","dayIndex","currentDate","isUndefined","floor","dayAccessibility","parseUTC","isFullDay","parseDate","slotStart","slotEnd","slotAccessibility","available","timeFrom","timeTo","dateIndex","setTime","from1","to1","from2","to2","startsInside","endsInside","startsBeforeEndsAfter","currentTimezoneOffset","nextMonthCreating","currentMonthIndex","nextMonthIndex","preloadNextMonth","arrayKey","firstMonthDay","lastMonthDay","response","timestampFrom","timestampTo","currentMonthDate","newDay","monthDays","monthKey","dayMonthKey","includes","timezoneSelect","Browser","isMobile","timezonesPopup","popupContent","getContentContainer","selectedTimezoneItem","querySelector","selectOffset","top","offsetHeight","scrollTop","offsetTop","destroy","Object","keys","timezoneId","text","onclick","autoHide","innerHeight","selectNode","timezone","innerHTML","nodesWeekDays","param","monthInfo","firstDayOfMonth","lastDateOfMonth","lastDayOfLastMonth","nodeMonth","k","j","i","dayOfWeek","result","touchPosition","x","touchMove","ev","changedTouches","clientX","removeProperty","preventDefault","currentMonthName","direction","isString","once","monthIndex","Base","isHiddenOnStart","getContent","getType","WidgetDate","props","calendarPage","dayInfo","timeInterval","avatarsSection","timezoneNotice","rruleDescription","updateValue","isBoolean","updateLayout","browserTimezone","calendarMonthName","calendarDay","isSameDate","calendarTime","eventDate","eventTime","eventTimezone","getFormattedTimezone","filled","timestamp","dayMonthFormat","getFormat","weekDateFormat","shortTimeFormat","rrule","content","darkMode","bindOptions","position","timezoneNoticeUnderstood","timezoneNoticeUnderstandButton","remove","noticeOffsetNode","timezonePopup","sign","formatDuration","abs","eventOffset","browserOffset","Form","sharingUser","isFromCrm","hasContactData","isPhoneFeatureEnabled","isMailFeatureEnabled","buttonSend","widgetDate","formArea","inputs","contact","description","authorName","contactData","authorNameEmpty","contactDataEmpty","contactDataIncorrect","cleanDescription","updateFormValue","updateFormLayout","clearInputErrors","isSuccessful","eventName","ownerCreated","ownerId","dateFrom","dateTo","userName","userContact","crmDealLinkHash","parentLinkHash","errors","eventId","eventLinkId","eventLinkHash","eventLinkShortUrl","isView","contactDataError","isEmptyContactName","dateInFormat","getDateFormat","timeInFormat","getTimeFormat","phone","replace","match","nameInputError","contactInputError","messageCode","inputMode","personalMailbox","personalPhone","parentNode","textBeforeCursor","input","selectionStart","firstPart","lastCharacter","matches","formattedPosition","indexOf","setSelectionRange","key","isAnyModifierKeyPressed","test","hasPlus","substr","split","item","code","mask","repeat","r","sort","a","b","EmptyState","AccessDenied","SlotItem","BUTTON_MAX_WIDTH","showForm","body","formatTimeInterval","SlotList","list","timezoneNoticeOffset","ownerOffset","updateSlotsList","slotListNode","newSelectedSlot","getData","slotSelector","timezoneNoticeText","timezoneIsVeryDifferent","currentDaySlots","slot","slotItem","scrollHeight","ceil","EventLayout","update","replaceWith","showCancelEventPopup","eventNotFound","subtitle","poweredLabel","isRu","location","descriptionCollapsed","collapseHeight","overflow","collapseButton","files","file","size","animate","expandButton","startHeight","children","childNodes","lastVisible","height","child","nodeName","span","textContent","display","childHeight","previousSibling","after","extraLines","previousVisible","cloneNode","endHeight","animationDuration","transition","iconClassName","showBackCalendarButton","onDeleteEvent","onDeclineEvent","cancelledInfo","dateFormatted","cancelledByEncoded","cancelledByText","buttons","bottomButtons","onAcceptInvitation","onDeclineInvitation","onStartVideoconference","onDownloadIcs","onReturnToCalendar","acceptButton","declineButton","videoconferenceButton","icsButton","action","BottomSheet","padding","contentBackground","width","animation","overlay","icon","stateTitle","additionalBlock","bottomButton","canceledTimestamp","canceledUserName","canceledByManager","inDeletedSlider","showBackCalendarButtons","downloadIcsFile","startVideoconference","deleteEvent","error","console","conferenceLink","href","getTimezoneDateFromTimestampUTC","timestampFromUTC","timestampToUTC","externalUserName","cancelledDate","SlotSelector","BLOCK_NAME_FORM","BLOCK_NAME_SLOT_LIST","BLOCK_NAME_EMPTY_STATE","BLOCK_NAME_ACCESS_DENIED","BLOCK_NAME_EVENT","selectedTimezoneId","empty","form","slotList","emptyState","openForm","openBlock","openSlotList","openEmptyState","openAccessDenied","openEvent","blockName","phoneFeatureEnabled","mailFeatureEnabled","meetingStatus","deleted","eventData","PublicV2","isDomNode","parentLink","showPageWelcome","showFreeSlots","hideFreeSlots","userAccessibility","firstNodeWrapper","warn"],"mappings":"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"}