{"version":3,"file":"setting-selector.bundle.js","sources":["../src/setting-selector.js"],"sourcesContent":["import { Type, Tag, Dom, Event } from 'main.core';\nimport { Actions, Icon } from 'ui.icon-set.api.core';\nimport { Dialog } from 'ui.entity-selector';\nimport 'ui.icon-set.actions';\nimport './css/style.css';\n\nconst settingEntityId = 'setting';\n\nexport class SettingSelector\n{\n\t#container: HTMLElement | null = null;\n\t#settingButtonTextNode: HTMLElement | null = null;\n\t#settingButton: HTMLElement | null = null;\n\t#hiddenInput: HTMLInputElement | null = null;\n\t#inputName: string;\n\t#settingsMap = new Map();\n\t#selectedOptionKey: '';\n\t#dialogOptions: {};\n\n\t// At least one item from the list must be selected.\n\t#forbidOptionDeselect = true;\n\n\tconstructor(options: Options)\n\t{\n\t\tconst {\n\t\t\tsettingsMap = {},\n\t\t\tselectedOptionKey,\n\t\t\tinputName,\n\t\t\tdialogOptions = {},\n\t\t} = options;\n\n\t\tObject.entries(settingsMap).forEach(([key, value]) => {\n\t\t\tthis.#settingsMap.set(key, value);\n\t\t});\n\n\t\tthis.#dialogOptions = dialogOptions;\n\t\tthis.#inputName = inputName;\n\t\tthis.#selectedOptionKey = selectedOptionKey;\n\t\tthis.#container = this.#renderContainer();\n\t\tthis.#createSelector();\n\t}\n\n\tgetSelected(): string\n\t{\n\t\treturn this.#selectedOptionKey;\n\t}\n\n\t#createSelector(): void\n\t{\n\t\tconst items = [];\n\n\t\tthis.#settingsMap.forEach((value, key) => {\n\t\t\titems.push({\n\t\t\t\tid: key,\n\t\t\t\ttitle: value,\n\t\t\t\tentityId: settingEntityId,\n\t\t\t\tselected: (key === this.getSelected()),\n\t\t\t\ttabs: 'recents',\n\t\t\t});\n\t\t});\n\n\t\tthis.settingDialog = new Dialog({\n\t\t\titems,\n\t\t\ttargetNode: this.#settingButton,\n\t\t\twidth: 170,\n\t\t\theight: (37 * items.length) + 15,\n\t\t\tmultiple: false,\n\t\t\tenableSearch: false,\n\t\t\tdropdownMode: true,\n\t\t\tshowAvatars: false,\n\t\t\tcompactView: true,\n\t\t\tevents: {\n\t\t\t\t'Item:onBeforeDeselect': (event) => {\n\t\t\t\t\tif (this.#forbidOptionDeselect)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'Item:onBeforeSelect': () => {\n\t\t\t\t\tthis.#forbidOptionDeselect = false;\n\t\t\t\t},\n\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\tthis.select(selectedItem.getId());\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\tthis.#forbidOptionDeselect = true;\n\t\t\t\t},\n\t\t\t},\n\t\t\t...this.#dialogOptions,\n\t\t});\n\n\t\tEvent.bind(this.#settingButton, 'click', () => {\n\t\t\tthis.settingDialog.show();\n\t\t});\n\t}\n\n\tselect(key)\n\t{\n\t\tthis.#selectedOptionKey = key;\n\t\tthis.#settingButtonTextNode.textContent = this.#settingsMap.get(this.getSelected());\n\t\tif (this.#hiddenInput)\n\t\t{\n\t\t\tthis.#hiddenInput.setAttribute('value', key);\n\t\t}\n\t}\n\n\t#renderContainer(): HTMLElement\n\t{\n\t\tconst icon = new Icon({\n\t\t\ticon: Actions.CHEVRON_DOWN,\n\t\t\tcolor: getComputedStyle(document.body).getPropertyValue('--ui-color-base-80'),\n\t\t\tsize: 16,\n\t\t});\n\n\t\tthis.icon = icon.render();\n\n\t\tlet selectedOptionText = this.#settingsMap.get(this.#selectedOptionKey);\n\n\t\tif (selectedOptionText === undefined)\n\t\t{\n\t\t\tselectedOptionText = '';\n\t\t}\n\n\t\tthis.#settingButtonTextNode = Tag.render`<div class=\"setting-selector-button-text\"></div>`;\n\n\t\tthis.#settingButtonTextNode.setAttribute('title', selectedOptionText);\n\t\tthis.#settingButtonTextNode.textContent = selectedOptionText;\n\n\t\tthis.#settingButton = Tag.render`\n\t\t\t<div class=\"setting-selector-button\">\n\t\t\t\t${this.#settingButtonTextNode}\n\t\t\t\t${this.icon}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (this.#inputName === undefined)\n\t\t{\n\t\t\tthis.#hiddenInput = Tag.render``;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#hiddenInput = Tag.render`<input type=\"hidden\">`;\n\n\t\t\tthis.#hiddenInput.setAttribute('name', this.#inputName);\n\t\t\tthis.#hiddenInput.setAttribute('value', this.#selectedOptionKey);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t <div class=\"setting-selector-container\">\n\t\t\t${this.#settingButton}\n\t\t\t${this.#hiddenInput}\n\t\t\t </div>\n\t\t`;\n\t}\n\n\trenderTo(targetContainer: HTMLElement): void\n\t{\n\t\tif (Type.isDomNode(targetContainer))\n\t\t{\n\t\t\tDom.append(this.#container, targetContainer);\n\t\t}\n\t}\n}\n"],"names":["settingEntityId","SettingSelector","constructor","options","Map","settingsMap","selectedOptionKey","inputName","dialogOptions","Object","entries","forEach","key","value","set","getSelected","select","textContent","get","setAttribute","renderTo","targetContainer","Type","isDomNode","Dom","append","items","push","id","title","entityId","selected","tabs","settingDialog","Dialog","targetNode","width","height","length","multiple","enableSearch","dropdownMode","showAvatars","compactView","events","event","preventDefault","item","selectedItem","getData","getId","Event","bind","show","icon","Icon","Actions","CHEVRON_DOWN","color","getComputedStyle","document","body","getPropertyValue","size","render","selectedOptionText","undefined","Tag"],"mappings":"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"}