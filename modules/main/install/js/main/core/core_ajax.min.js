(function(e){if(e.BX.ajax)return;var a=e.BX,t={},r={method:"GET",dataType:"html",timeout:0,async:true,processData:true,scriptsRunFirst:false,emulateOnload:true,skipAuthCheck:false,start:true,cache:true,preparePost:true,headers:false,lsTimeout:30,lsForce:false},n={},s=[],o={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};a.ajax=function(e){var n,s;if(!e||!e.url||!a.type.isString(e.url)){return false}for(var u in t)if(typeof e[u]=="undefined")e[u]=t[u];t={};for(u in r)if(typeof e[u]=="undefined")e[u]=r[u];e.method=e.method.toUpperCase();if(!a.localStorage)e.lsId=null;if(a.browser.IsIE()){var l=o.url_utf.exec(e.url);if(l){do{e.url=e.url.replace(l,a.util.urlencode(l));l=o.url_utf.exec(e.url)}while(l)}}if(e.dataType=="json")e.emulateOnload=false;if(!e.cache&&e.method=="GET")e.url=a.ajax._uncache(e.url);if(e.method=="POST"){if(e.preparePost){e.data=a.ajax.prepareData(e.data)}else if(i(e.headers)==="application/json"){const t=a.Type.isPlainObject(e.data)||a.Type.isString(e.data)||a.Type.isNumber(e.data)||a.Type.isBoolean(e.data)||a.Type.isArray(e.data);if(t){e.data=JSON.stringify(e.data)}}}var c=true;if(e.lsId&&!e.lsForce){var f=a.localStorage.get("ajax-"+e.lsId);if(f!==null){c=false;var p=function(t){if(t.key=="ajax-"+e.lsId&&t.value!="BXAJAXWAIT"){var r=t.value,n=!!t.oldValue&&r==null;if(!n)a.ajax.__run(e,r);else if(e.onfailure)e.onfailure("timeout");a.removeCustomEvent("onLocalStorageChange",p)}};if(f=="BXAJAXWAIT"){a.addCustomEvent("onLocalStorageChange",p)}else{setTimeout((function(){p({key:"ajax-"+e.lsId,value:f})}),10)}}}if(c){e.xhr=a.ajax.xhr();if(!e.xhr)return;if(e.lsId){a.localStorage.set("ajax-"+e.lsId,"BXAJAXWAIT",e.lsTimeout)}if(a.Type.isFunction(e.onprogress)){a.bind(e.xhr,"progress",e.onprogress)}if(a.Type.isFunction(e.onprogressupload)&&e.xhr.upload){a.bind(e.xhr.upload,"progress",e.onprogressupload)}e.xhr.open(e.method,e.url,e.async);if(!e.skipBxHeader&&!a.ajax.isCrossDomain(e.url)){e.xhr.setRequestHeader("Bx-ajax","true")}if(e.method=="POST"&&e.preparePost){e.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(typeof e.headers=="object"){for(u=0;u<e.headers.length;u++)e.xhr.setRequestHeader(e.headers[u].name,e.headers[u].value)}var d=false;var h=e.xhr.onreadystatechange=function(t){if(d)return;if(t==="timeout"){if(e.onfailure){e.onfailure("timeout","",e)}a.onCustomEvent(e.xhr,"onAjaxFailure",["timeout","",e]);e.xhr.onreadystatechange=a.DoNothing;e.xhr.abort();if(e.async){e.xhr=null}}else{if(e.xhr.readyState==4||t=="run"){n=a.ajax.xhrSuccess(e.xhr)?"success":"error";d=true;e.xhr.onreadystatechange=a.DoNothing;if(n=="success"){var r=!!e.skipAuthCheck||a.ajax.isCrossDomain(e.url)?false:e.xhr.getResponseHeader("X-Bitrix-Ajax-Status");if(!!r&&r=="Authorize"){if(e.onfailure){e.onfailure("auth",e.xhr.status,e)}a.onCustomEvent(e.xhr,"onAjaxFailure",["auth",e.xhr.status,e])}else{var s=e.xhr.responseText;if(e.lsId){a.localStorage.set("ajax-"+e.lsId,s,e.lsTimeout)}a.ajax.__run(e,s)}}else{if(e.onfailure){e.onfailure("status",e.xhr.status,e)}a.onCustomEvent(e.xhr,"onAjaxFailure",["status",e.xhr.status,e])}if(e.async){e.xhr=null}}}};if(e.async&&e.timeout>0){setTimeout((function(){if(e.xhr&&!d){h("timeout")}}),e.timeout*1e3)}if(e.start){e.xhr.send(e.data);if(!e.async){h("run")}}return e.xhr}};a.ajax.xhr=function(){if(e.XMLHttpRequest){try{return new XMLHttpRequest}catch(e){}}else if(e.ActiveXObject){try{return new e.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new e.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new e.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}return null};a.ajax.isCrossDomain=function(t,r){r=r||e.location;if(t.indexOf("//")===0){t=r.protocol+t}if(t.indexOf("http")!==0){return false}var n=e.document.createElement("a");n.href=t;return n.protocol!==r.protocol||n.hostname!==r.hostname||a.ajax.getHostPort(n.protocol,n.host)!==a.ajax.getHostPort(r.protocol,r.host)};a.ajax.getHostPort=function(e,a){var t=/:(\d+)$/.exec(a);if(t){return t[1]}else{if(e==="http:"){return"80"}else if(e==="https:"){return"443"}}return""};a.ajax.__prepareOnload=function(t,r){if(t.length>0){a.ajax["onload_"+r]=null;for(var n=0,s=t.length;n<s;n++){if(t[n].isInternal){t[n].JS=t[n].JS.replace(o.script_onload,"BX.ajax.onload_"+r)}}}a.CaptureEventsGet();a.CaptureEvents(e,"load")};a.ajax.__runOnload=function(t){if(null!=a.ajax["onload_"+t]){a.ajax["onload_"+t].apply(e);a.ajax["onload_"+t]=null}var r=a.CaptureEventsGet();if(r){for(var n=0;n<r.length;n++)r[n].apply(e)}};a.ajax.__run=function(e,t){if(!e.processData){if(e.onsuccess){e.onsuccess(t)}a.onCustomEvent(e.xhr,"onAjaxSuccess",[t,e])}else{t=a.ajax.processRequestData(t,e)}};a.ajax._onParseJSONFailure=function(e){this.jsonFailure=true;this.jsonResponse=e;this.jsonProactive=/^\[WAF\]/.test(e)};a.ajax.processRequestData=function(e,t){var r,n=[],s=[];switch(t.dataType.toUpperCase()){case"JSON":var o=t.xhr||{};a.addCustomEvent(o,"onParseJSONFailure",a.proxy(a.ajax._onParseJSONFailure,t));r=a.parseJSON(e,o);a.removeCustomEvent(o,"onParseJSONFailure",a.proxy(a.ajax._onParseJSONFailure,t));if(!!r&&a.type.isArray(r["bxjs"])){for(var i=0;i<r["bxjs"].length;i++){if(a.type.isNotEmptyString(r["bxjs"][i])){n.push({isInternal:false,JS:r["bxjs"][i],bRunFirst:t.scriptsRunFirst})}else{n.push(r["bxjs"][i])}}}if(!!r&&a.type.isArray(r["bxcss"])){s=r["bxcss"]}break;case"SCRIPT":n.push({isInternal:true,JS:e,bRunFirst:t.scriptsRunFirst});r=e;break;default:var u=a.processHTML(e,t.scriptsRunFirst);r=u.HTML;n=u.SCRIPT;s=u.STYLE;break}if(s.length>0){a.loadCSS(s)}let l=null;if(t.emulateOnload){l=parseInt(Math.random()*1e6);a.ajax.__prepareOnload(n,l)}const c=a.defer((function(){if(t.emulateOnload){a.ajax.__runOnload(l)}a.onCustomEvent(t.xhr,"onAjaxSuccessFinish",[t])}));try{if(!!t.jsonFailure){throw{type:"json_failure",data:t.jsonResponse,bProactive:t.jsonProactive}}t.scripts=n;a.ajax.processScripts(t.scripts,true);if(t.onsuccess){t.onsuccess(r)}a.onCustomEvent(t.xhr,"onAjaxSuccess",[r,t]);a.ajax.processScripts(t.scripts,false,c)}catch(e){if(t.onfailure)t.onfailure("processing",e);a.onCustomEvent(t.xhr,"onAjaxFailure",["processing",e,t])}};a.ajax.processScripts=function(e,t,r){var n=[],s="";r=r||a.DoNothing;for(var o=0,i=e.length;o<i;o++){if(typeof t!="undefined"&&t!=!!e[o].bRunFirst)continue;if(e[o].isInternal)s+=";"+e[o].JS;else n.push(e[o].JS)}n=a.util.array_unique(n);var u=s.length>0?function(){a.evalGlobal(s)}:a.DoNothing;if(n.length>0){a.load(n,(function(){u();r()}))}else{u();r()}};a.ajax.prepareData=function(e,t){var r="";if(a.type.isString(e))r=e;else if(null!=e){for(var n in e){if(e.hasOwnProperty(n)){if(r.length>0)r+="&";var s=a.util.urlencode(n);if(t)s=t+"["+s+"]";if(typeof e[n]=="object")r+=a.ajax.prepareData(e[n],s);else r+=s+"="+a.util.urlencode(e[n])}}}return r};a.ajax.xhrSuccess=function(e){return e.status>=200&&e.status<300||e.status===304||e.status===1223||e.status===0};a.ajax.Setup=function(e,a){a=!!a;for(var n in e){if(a)t[n]=e[n];else r[n]=e[n]}};a.ajax.replaceLocalStorageValue=function(e,t,r){if(!!a.localStorage)a.localStorage.set("ajax-"+e,t,r)};a.ajax._uncache=function(e){return e+((e.indexOf("?")!==-1?"&":"?")+"_="+(new Date).getTime())};a.ajax.get=function(e,t,r){if(a.type.isFunction(t)){r=t;t=""}t=a.ajax.prepareData(t);if(t){e+=(e.indexOf("?")!==-1?"&":"?")+t;t=""}return a.ajax({method:"GET",dataType:"html",url:e,data:"",onsuccess:r})};a.ajax.getCaptcha=function(e){return a.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",e)};a.ajax.insertToNode=function(e,r){r=a(r);if(!!r){var n={cancel:false};a.onCustomEvent("onAjaxInsertToNode",[{url:e,node:r,eventArgs:n}]);if(n.cancel===true){return}var s=null;if(!t.denyShowWait){s=a.showWait(r);delete t.denyShowWait}return a.ajax.get(e,(function(e){r.innerHTML=e;a.closeWait(r,s)}))}};a.ajax.post=function(e,t,r){t=a.ajax.prepareData(t);return a.ajax({method:"POST",dataType:"html",url:e,data:t,onsuccess:r})};a.ajax.promise=function(e){var t=new a.Promise;e.onsuccess=function(e){t.fulfill(e)};e.onfailure=function(e,a,r){t.reject({reason:e,data:a,ajaxConfig:r,xhr:r.xhr})};var r=a.ajax(e);if(r){if(typeof e.onrequeststart==="function"){e.onrequeststart(r)}}else{t.reject({reason:"init",data:false})}return t};a.ajax.loadScriptAjax=function(e,t,r){if(a.type.isArray(e)){for(var s=0,i=e.length;s<i;s++){a.ajax.loadScriptAjax(e[s],t,r)}}else{var u=e.replace(/\.js\?.*/,".js");if(o.script_self.test(u))return;if(o.script_self_window.test(u)&&a.CWindow)return;if(o.script_self_admin.test(u)&&a.admin)return;if(typeof n[u]=="undefined"){if(!!r){n[u]="";return a.loadScript(e)}else{return a.ajax({url:e,method:"GET",dataType:"script",processData:true,emulateOnload:false,scriptsRunFirst:true,async:false,start:true,onsuccess:function(e){n[u]=e;if(t)t(e)}})}}else if(t){t(n[u])}}};a.ajax.loadJSON=function(e,t,r,n){if(a.type.isFunction(t)){n=r;r=t;t=""}t=a.ajax.prepareData(t);if(t){e+=(e.indexOf("?")!==-1?"&":"?")+t;t=""}return a.ajax({method:"GET",dataType:"json",url:e,onsuccess:r,onfailure:n})};var i=function(e){if(!a.Type.isArray(e)){return null}var t=e.filter((function(e){return e.name==="Content-Type"})).pop();return t?t.value:null};const u=function(e){if(!a.Type.isPlainObject(e)){console.error("BX.ajax: {analytics} must be an object.");return false}const t=["event","tool","category"];for(const r of t){if(!a.Type.isStringFilled(e[r])){console.error(`BX.ajax: The "${r}" property in the "analytics" object must be a non-empty string.`);return false}}const r=["p1","p2","p3","p4","p5"];for(const t of r){const r=e[t];if(!a.Type.isStringFilled(r)){continue}if(r.split("_").length>2){console.error(`BX.ajax: The "${t}" property (${r}) in the "analytics" object must be a string containing a single underscore.`);return false}}return true};const l=function(e){const t={};if(a.Type.isStringFilled(e.analyticsLabel)||a.Type.isPlainObject(e.analyticsLabel)){t.analyticsLabel=e.analyticsLabel}if(a.Type.isPlainObject(e.analytics)){if(e.analyticsLabel){delete t.analyticsLabel;console.error("BX.ajax: Only {analytics} or {analyticsLabel} should be used. If both are present, {analyticsLabel} will be ignored.")}if(u(e.analytics)){t.st=e.analytics}else{console.error("BX.ajax: {analytics} is invalid and is skipped.")}}return t};const c=function(e){let a=e.getParameters||{};a={...a,...l(e)};if(typeof e.mode!=="undefined"){a.mode=e.mode}if(e.navigation){if(e.navigation.page){a.nav="page-"+e.navigation.page}if(e.navigation.size){if(a.nav){a.nav+="-"}else{a.nav=""}a.nav+="size-"+e.navigation.size}}return a};var f=function(e){e=a.type.isPlainObject(e)?e:{};e.headers=e.headers||[];e.headers.push({name:"X-Bitrix-Csrf-Token",value:a.bitrix_sessid()});if(a.message.SITE_ID){e.headers.push({name:"X-Bitrix-Site-Id",value:a.message.SITE_ID})}if(typeof e.json!=="undefined"){if(!a.type.isPlainObject(e.json)){throw new Error("Wrong `config.json`, plain object expected.")}e.headers.push({name:"Content-Type",value:"application/json"});e.data=e.json;e.preparePost=false}else if(e.data instanceof FormData){e.preparePost=false;if(typeof e.signedParameters!=="undefined"){e.data.append("signedParameters",e.signedParameters)}}else if(a.type.isPlainObject(e.data)||a.Type.isNil(e.data)){e.data=a.type.isPlainObject(e.data)?e.data:{};if(typeof e.signedParameters!=="undefined"){e.data.signedParameters=e.signedParameters}}if(!e.method){e.method="POST"}return e};var p=function(e,t){t=t||false;var r=a.clone(e);var n=null;var s=e.onrequeststart;e.onrequeststart=function(e){n=e;if(a.type.isFunction(s)){s(e)}};var o=r.onrequeststart;r.onrequeststart=function(e){n=e;if(a.type.isFunction(o)){o(e)}};var i=a.ajax.promise(e);return i.then((function(e){if(!t&&a.type.isPlainObject(e)&&a.type.isArray(e.errors)){var n=false;e.errors.forEach((function(e){if(e.code==="invalid_csrf"&&e.customData.csrf){a.message({bitrix_sessid:e.customData.csrf});r.headers=r.headers||[];r.headers=r.headers.filter((function(e){return e&&e.name!=="X-Bitrix-Csrf-Token"}));r.headers.push({name:"X-Bitrix-Csrf-Token",value:a.bitrix_sessid()});n=true}}));if(n){return p(r,true)}}if(!a.type.isPlainObject(e)||e.status!=="success"){var s=new a.Promise;s.reject(e);return s}return e})).catch((function(e){var t=new a.Promise;var r;if(a.type.isPlainObject(e)&&e.xhr&&e.xhr.responseText){try{r=JSON.parse(e.xhr.responseText);e=r}catch(e){}}if(a.type.isPlainObject(e)&&e.status&&e.hasOwnProperty("data")){t.reject(e)}else{t.reject({status:"error",data:{ajaxRejectData:e},errors:[{code:"NETWORK_ERROR",message:"Network error"}]})}return t})).then((function(e){var t=new a.Promise;var r=n.getAllResponseHeaders().trim().split(/[\r\n]+/);var s={};r.forEach((function(e){var a=e.split(": ");var t=a.shift().toLowerCase();s[t]=a.join(": ")}));if(!s["x-process-assets"]){t.fulfill(e);return t}var o=a.prop.getObject(a.prop.getObject(e,"data",{}),"assets",{});var i=new Promise((function(e,t){var r=a.prop.getArray(o,"css",[]);a.load(r,(function(){a.loadScript(a.prop.getArray(o,"js",[]),e)}))}));i.then((function(){var r=a.prop.getArray(o,"string",[]);var n=r.join("\n");a.html(document.head,n,{useAdjacentHTML:true}).then((function(){t.fulfill(e)}))}));return t}))};a.ajax.runAction=function(e,t){t=f(t);var r=c(t);r.action=e;var n="/bitrix/services/main/ajax.php?"+a.ajax.prepareData(r);return p({method:t.method,dataType:"json",url:n,data:t.data,timeout:t.timeout,preparePost:t.preparePost,headers:t.headers,onrequeststart:t.onrequeststart,onprogress:t.onprogress,onprogressupload:t.onprogressupload})};a.ajax.runComponentAction=function(e,t,r){r=f(r);r.mode=r.mode||"ajax";var n=c(r);n.c=e;n.action=t;var s="/bitrix/services/main/ajax.php?"+a.ajax.prepareData(n);return p({method:r.method,dataType:"json",url:s,data:r.data,timeout:r.timeout,preparePost:r.preparePost,headers:r.headers,onrequeststart:r.onrequeststart?r.onrequeststart:null,onprogress:r.onprogress,onprogressupload:r.onprogressupload})};a.ajax.load=function(e,t){if(!a.type.isArray(e))e=[e];var r=0;if(!a.type.isFunction(t))t=a.DoNothing;var n=function(e){if(a.type.isFunction(this.callback))this.callback(e);if(++r>=o)t()};for(var s=0,o=e.length;s<o;s++){switch(e[s].type.toUpperCase()){case"SCRIPT":a.loadScript([e[s].url],a.proxy(n,e[s]));break;case"CSS":a.loadCSS([e[s].url]);if(++r>=o)t();break;case"JSON":a.ajax.loadJSON(e[s].url,a.proxy(n,e[s]));break;default:a.ajax.get(e[s].url,"",a.proxy(n,e[s]));break}}};a.ajax.submit=function(e,t){if(!e.target){if(null==e.BXFormTarget){var r="formTarget_"+Math.random();e.BXFormTarget=document.body.appendChild(a.create("IFRAME",{props:{name:r,id:r,src:"javascript:void(0)"},style:{display:"none"}}))}e.target=e.BXFormTarget.name}e.BXFormCallback=t;a.bind(e.BXFormTarget,"load",a.proxy(a.ajax._submit_callback,e));a.submit(e);return false};a.ajax.submitComponentForm=function(t,r,n){if(!t.target){if(null==t.BXFormTarget){var s="formTarget_"+Math.random();t.BXFormTarget=document.body.appendChild(a.create("IFRAME",{props:{name:s,id:s,src:"javascript:void(0)"},style:{display:"none"}}))}t.target=t.BXFormTarget.name}if(!!n)var o=a.showWait(r);t.BXFormCallback=function(t){if(!!n)a.closeWait(o);var s=function(){if(!!e.bxcompajaxframeonload){setTimeout((function(){e.bxcompajaxframeonload();e.bxcompajaxframeonload=null}),10)}};a(r).innerHTML=t;a.onCustomEvent("onAjaxSuccess",[null,null,s])};a.bind(t.BXFormTarget,"load",a.proxy(a.ajax._submit_callback,t));return true};a.ajax._submit_callback=function(){try{if(this.BXFormTarget.contentWindow.location.href.indexOf("http")!=0)return}catch(e){return}if(this.BXFormCallback)this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML]);a.unbindAll(this.BXFormTarget)};a.ajax.prepareForm=function(e,a){a=!!a?a:{};var t,r,n,s=[],o=e.elements.length,i=0,u=0;if(!!e){for(t=0;t<o;t++){n=e.elements[t];if(n.disabled)continue;if(!n.type)continue;switch(n.type.toLowerCase()){case"text":case"textarea":case"password":case"number":case"hidden":case"select-one":s.push({name:n.name,value:n.value});u+=n.name.length+n.value.length;break;case"file":if(!!n.files){for(r=0;r<n.files.length;r++){i++;s.push({name:n.name,value:n.files[r],file:true});u+=n.files[r].size}}break;case"radio":case"checkbox":if(n.checked){s.push({name:n.name,value:n.value});u+=n.name.length+n.value.length}break;case"select-multiple":for(var l=0;l<n.options.length;l++){if(n.options[l].selected){s.push({name:n.name,value:n.options[l].value});u+=n.name.length+n.options[l].length}}break;default:break}}t=0;u=0;var c=a,f,p,d,h;while(t<s.length){var x=s[t].name.indexOf("[");if(h){c[s[t].name]={};c[s[t].name][h.replace(/\[|\]/gi,"")]=s[t].value;c=a;h=null;t++}else if(x==-1){c[s[t].name]=s[t].value;c=a;t++}else{f=s[t].name.substring(0,x);p=s[t].name.substring(x+1);d=p.indexOf("]");if(d==-1){if(!c[f])c[f]=[];c=a;t++}else if(d==0){if(!c[f])c[f]=[];c=c[f];s[t].name=""+c.length;if(p.substring(d+1).indexOf("[")===0)h=p.substring(0,d)+p.substring(d+1)}else{if(!c[f])c[f]={};c=c[f];s[t].name=p.substring(0,d)+p.substring(d+1)}}}}return{data:a,filesCount:i,roughSize:u}};a.ajax.submitAjax=function(t,r){r=r!==null&&typeof r=="object"?r:{};r.url=r["url"]||t.getAttribute("action");var n=r["data"]||{};r.data=a.ajax.prepareForm(t).data;for(var s in n){if(n.hasOwnProperty(s)){r.data[s]=n[s]}}if(!e["FormData"]){a.ajax(r)}else{var o=function(e){var a=Object.prototype.toString.call(e);return a=="[object File]"||a=="[object Blob]"},i=function(e,a,t){if(!!t&&typeof t=="object"&&!o(t)){for(var r in t){if(t.hasOwnProperty(r)){i(e,a==""?r:a+"["+r+"]",t[r])}}}else e.append(a,!!t?t:"")},u=function(e){var t={};if(null!=e){if(typeof e=="object"){for(var r in e){if(e.hasOwnProperty(r)){var n=a.util.urlencode(r);if(typeof e[r]=="object"&&e[r]["file"]!==true)t[n]=u(e[r]);else if(e[r]["file"]===true)t[n]=e[r]["value"];else t[n]=a.util.urlencode(e[r])}}}else t=a.util.urlencode(e)}return t},l=new e.FormData;if(r.method!=="POST"){r.data=a.ajax.prepareData(r.data);if(r.data){r.url+=(r.url.indexOf("?")!==-1?"&":"?")+r.data;r.data=""}}else{if(r.preparePost===true)r.data=u(r.data);i(l,"",r.data);r.data=l}r.preparePost=false;r.start=false;var c=a.ajax(r);if(!!r["onprogress"])c.upload.addEventListener("progress",(function(e){var a=null;if(e.lengthComputable&&(e.total||e["totalSize"])){a=e.loaded*100/(e.total||e["totalSize"])}r["onprogress"](e,a)}));c.send(l)}};a.ajax.UpdatePageData=function(e){if(e.TITLE)a.ajax.UpdatePageTitle(e.TITLE);if(e.WINDOW_TITLE||e.TITLE)a.ajax.UpdateWindowTitle(e.WINDOW_TITLE||e.TITLE);if(e.NAV_CHAIN)a.ajax.UpdatePageNavChain(e.NAV_CHAIN);if(e.CSS&&e.CSS.length>0)a.loadCSS(e.CSS);if(e.SCRIPTS&&e.SCRIPTS.length>0){var t=function(r,n,s){if(!!n&&a.type.isArray(n.scripts)){for(var o=0,i=e.SCRIPTS.length;o<i;o++){n.scripts.push({isInternal:false,JS:e.SCRIPTS[o]})}}else{a.loadScript(e.SCRIPTS,s)}a.removeCustomEvent("onAjaxSuccess",t)};a.addCustomEvent("onAjaxSuccess",t)}else{var r=function(e,t,n){if(a.type.isFunction(n)){n()}a.removeCustomEvent("onAjaxSuccess",r)};a.addCustomEvent("onAjaxSuccess",r)}};a.ajax.UpdatePageTitle=function(e){var t=a("pagetitle");if(t){a.remove(t.firstChild);if(!t.firstChild)t.appendChild(document.createTextNode(e));else t.insertBefore(document.createTextNode(e),t.firstChild)}};a.ajax.UpdateWindowTitle=function(e){document.title=e};a.ajax.UpdatePageNavChain=function(e){var t=a("navigation");if(t){t.innerHTML=e}};a.userOptions={options:null,bSend:false,delay:5e3,path:"/bitrix/admin/user_options.php?"};a.userOptions.setAjaxPath=function(e){a.userOptions.path=e.indexOf("?")==-1?e+"?":e+"&"};a.userOptions.save=function(e,t,r,n,s){if(null==a.userOptions.options)a.userOptions.options={};s=!!s;a.userOptions.options[e+"."+t+"."+r]=[e,t,r,n,s];var o=a.userOptions.__get();if(o!="")document.cookie=a.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+encodeURIComponent(o)+"&sessid="+a.bitrix_sessid()+"; expires=Thu, 31 Dec "+((new Date).getFullYear()+1)+" 23:59:59 GMT; path=/;";if(!a.userOptions.bSend){a.userOptions.bSend=true;setTimeout((function(){a.userOptions.send(null)}),a.userOptions.delay)}};a.userOptions.send=function(e){var t=a.userOptions.__get();a.userOptions.options=null;a.userOptions.bSend=false;if(t!=""){document.cookie=a.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;";a.ajax({method:"GET",dataType:"html",processData:false,cache:false,url:a.userOptions.path+t+"&sessid="+a.bitrix_sessid(),onsuccess:e})}};a.userOptions.del=function(e,t,r,n){a.ajax.get(a.userOptions.path+"action=delete&c="+e+"&n="+t+(r==true?"&common=Y":"")+"&sessid="+a.bitrix_sessid(),n)};a.userOptions.__get=function(){if(!a.userOptions.options)return"";var e="",t=-1,r="",n,s;for(s in a.userOptions.options){if(a.userOptions.options.hasOwnProperty(s)){n=a.userOptions.options[s];if(r!=n[0]+"."+n[1]){t++;e+="&p["+t+"][c]="+a.util.urlencode(n[0]);e+="&p["+t+"][n]="+a.util.urlencode(n[1]);if(n[4]==true)e+="&p["+t+"][d]=Y";r=n[0]+"."+n[1]}var o=n[2];var i=n[3];if(o===null){e+="&p["+t+"][v]="+a.util.urlencode(i)}else{e+="&p["+t+"][v]["+a.util.urlencode(o)+"]="+a.util.urlencode(i)}}}return e.substr(1)};a.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:false,bHashCollision:false,bPushState:!!(history.pushState&&a.type.isFunction(history.pushState)),startState:null,init:function(t){if(a.ajax.history.bInited)return;this.obParams=t;var r=this.obParams.getState();if(a.ajax.history.bPushState){a.ajax.history.expected_hash=e.location.pathname;if(e.location.search)a.ajax.history.expected_hash+=e.location.search;a.ajax.history.put(r,a.ajax.history.expected_hash,"",true);setTimeout((function(){a.bind(e,"popstate",a.ajax.history.__hashListener)}),500)}else{a.ajax.history.expected_hash=e.location.hash;if(!a.ajax.history.expected_hash||a.ajax.history.expected_hash=="#")a.ajax.history.expected_hash="__bx_no_hash__";d.put(a.ajax.history.expected_hash,r);a.ajax.history.obTimer=setTimeout(a.ajax.history.__hashListener,500);if(a.browser.IsIE()){a.ajax.history.obFrame=document.createElement("IFRAME");a.hide_object(a.ajax.history.obFrame);document.body.appendChild(a.ajax.history.obFrame);a.ajax.history.obFrame.contentWindow.document.open();a.ajax.history.obFrame.contentWindow.document.write(a.ajax.history.expected_hash);a.ajax.history.obFrame.contentWindow.document.close()}else if(a.browser.IsOpera()){a.ajax.history.obImage=document.createElement("IMG");a.hide_object(a.ajax.history.obImage);document.body.appendChild(a.ajax.history.obImage);a.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';")}}a.ajax.history.bInited=true},__hashListener:function(t){t=t||e.event||{state:false};if(a.ajax.history.bPushState){a.ajax.history.obParams.setState(t.state||a.ajax.history.startState)}else{if(a.ajax.history.obTimer){e.clearTimeout(a.ajax.history.obTimer);a.ajax.history.obTimer=null}var r;if(null!=a.ajax.history.obFrame)r=a.ajax.history.obFrame.contentWindow.document.body.innerText;else r=e.location.hash;if(!r||r=="#")r="__bx_no_hash__";if(r.indexOf("#")==0)r=r.substring(1);if(r!=a.ajax.history.expected_hash){var n=d.get(r);if(n){a.ajax.history.obParams.setState(n);a.ajax.history.expected_hash=r;if(null!=a.ajax.history.obFrame){var s=r=="__bx_no_hash__"?"":r;if(e.location.hash!=s&&e.location.hash!="#"+s)e.location.hash=s}}}a.ajax.history.obTimer=setTimeout(a.ajax.history.__hashListener,500)}},put:function(t,r,n,s){if(this.bPushState){if(!s){history.pushState(t,"",r)}else{a.ajax.history.startState=t}}else{if(typeof n!="undefined")r=n;else r="view"+r;d.put(r,t);a.ajax.history.expected_hash=r;e.location.hash=a.util.urlencode(r);if(null!=a.ajax.history.obFrame){a.ajax.history.obFrame.contentWindow.document.open();a.ajax.history.obFrame.contentWindow.document.write(r);a.ajax.history.obFrame.contentWindow.document.close()}}},checkRedirectStart:function(t,r){var n=e.location.hash;if(n.substring(0,1)=="#")n=n.substring(1);var s=n.substring(0,5);if(s=="view/"||s=="view%"){a.ajax.history.bHashCollision=true;document.write("<"+'div id="__ajax_hash_collision_'+r+'" style="display: none;">')}},checkRedirectFinish:function(t,r){document.write("</div>");var n=e.location.hash;if(n.substring(0,1)=="#")n=n.substring(1);a.ready((function(){var e=n.substring(0,5);if(e=="view/"||e=="view%"){var s=a("__ajax_hash_collision_"+r);var o=s.firstChild;a.cleanNode(o);s.style.display="block";if(e!="view%")n=a.util.urlencode(n);n+=(n.indexOf("%3F")==-1?"%3F":"%26")+t+"="+r;var i="/bitrix/tools/ajax_redirector.php?hash="+n;a.ajax.insertToNode(i,o)}}))}};a.ajax.component=function(e){this.node=e};a.ajax.component.prototype.getState=function(){var t={node:this.node,title:e.document.title,data:a(this.node).innerHTML};var r=a("navigation");if(null!=r)t.nav_chain=r.innerHTML;a.onCustomEvent(a(t.node),"onComponentAjaxHistoryGetState",[t]);return t};a.ajax.component.prototype.setState=function(e){a(e.node).innerHTML=e.data;a.ajax.UpdatePageTitle(e.title);if(e.nav_chain){a.ajax.UpdatePageNavChain(e.nav_chain)}a.onCustomEvent(a(e.node),"onComponentAjaxHistorySetState",[e])};var d={arHistory:{},put:function(e,a){this.arHistory[e]=a},get:function(e){return this.arHistory[e]}};a.ajax.FormData=function(){this.elements=[];this.files=[];this.features={};this.isSupported();this.log("BX FormData init")};a.ajax.FormData.isSupported=function(){var e=new a.ajax.FormData;var t=e.features.supported;e=null;return t};a.ajax.FormData.prototype.log=function(e){if(false){try{if(a.browser.IsIE())e=JSON.stringify(e);console.log(e)}catch(e){}}};a.ajax.FormData.prototype.isSupported=function(){var a={};a.fileReader=e.FileReader&&e.FileReader.prototype.readAsBinaryString;a.readFormData=a.sendFormData=!!e.FormData;a.supported=!!(a.readFormData&&a.sendFormData);this.features=a;this.log("features:");this.log(a);return a.supported};a.ajax.FormData.prototype.append=function(e,a){if(typeof a==="object"){this.files.push({name:e,value:a})}else{this.elements.push({name:e,value:a})}};a.ajax.FormData.prototype.send=function(e,t,r,n){this.log("FD send");this.xhr=a.ajax({method:"POST",dataType:"html",url:e,onsuccess:t,onfailure:n,start:false,preparePost:false});if(r){this.xhr.upload.addEventListener("progress",(function(e){if(e.lengthComputable)r(e.loaded/(e.total||e.totalSize))}),false)}if(this.features.readFormData&&this.features.sendFormData){var s=new FormData;this.log("use browser formdata");for(var o in this.elements){if(this.elements.hasOwnProperty(o))s.append(this.elements[o].name,this.elements[o].value)}for(o in this.files){if(this.files.hasOwnProperty(o))s.append(this.files[o].name,this.files[o].value)}this.xhr.send(s)}return this.xhr};a.addCustomEvent("onAjaxFailure",a.debug)})(window);
//# sourceMappingURL=core_ajax.map.js