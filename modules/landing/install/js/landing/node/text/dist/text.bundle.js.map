{"version":3,"file":"text.bundle.js","sources":["../src/text.js"],"sourcesContent":["import { Event } from 'main.core';\nimport { Base } from 'landing.node.base';\nimport { TableEditor } from 'landing.node.tableeditor';\n\nconst escapeText = BX.Landing.Utils.escapeText;\nconst matchers = BX.Landing.Utils.Matchers;\nconst changeTagName = BX.Landing.Utils.changeTagName;\nconst textToPlaceholders = BX.Landing.Utils.textToPlaceholders;\n\nexport class Text extends Base\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\n\t\tthis.currentNode = null;\n\t\tthis.type = 'text';\n\t\tthis.tableBaseFontSize = '22';\n\n\t\tthis.onClick = this.onClick.bind(this);\n\t\tthis.onPaste = this.onPaste.bind(this);\n\t\tthis.onDrop = this.onDrop.bind(this);\n\t\tthis.onInput = this.onInput.bind(this);\n\t\tthis.onKeyDown = this.onKeyDown.bind(this);\n\t\tthis.onMousedown = this.onMousedown.bind(this);\n\t\tthis.onMouseup = this.onMouseup.bind(this);\n\n\t\t// Bind on node events\n\t\tthis.bindEvents(this.node);\n\t\tEvent.bind(document, 'mouseup', this.onMouseup);\n\t}\n\n\tbindEvents(node)\n\t{\n\t\tEvent.bind(node, 'mousedown', this.onMousedown);\n\t\tEvent.bind(node, 'click', this.onClick);\n\t\tEvent.bind(node, 'paste', this.onPaste);\n\t\tEvent.bind(node, 'drop', this.onDrop);\n\t\tEvent.bind(node, 'input', this.onInput);\n\t\tEvent.bind(node, 'keydown', this.onKeyDown);\n\t}\n\n\t/**\n\t * Handles allow inline edit event\n\t */\n\tonAllowInlineEdit()\n\t{\n\t\t// Show title \"Click to edit\" for node\n\t\tthis.node.setAttribute('title', escapeText(BX.Landing.Loc.getMessage('LANDING_TITLE_OF_TEXT_NODE')));\n\t}\n\n\t/**\n\t * Handles change event\n\t * @param {boolean} [preventAdjustPosition]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tonChange(preventAdjustPosition, preventHistory)\n\t{\n\t\tsuper.onChange.call(this, preventHistory);\n\t\tif (!preventAdjustPosition)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(this.node);\n\t\t}\n\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tBX.Landing.History.getInstance().push();\n\t\t}\n\t}\n\n\tonKeyDown(event)\n\t{\n\t\tif (event.code === 'Backspace')\n\t\t{\n\t\t\tthis.onBackspaceDown(event);\n\t\t}\n\t\tthis.onInput(event);\n\t}\n\n\tonInput(event)\n\t{\n\t\tclearTimeout(this.inputTimeout);\n\n\t\tconst key = event.keyCode || event.which;\n\n\t\tif (!(key === 90 && (/win/i.test(top.window.navigator.userAgent) ? event.ctrlKey : event.metaKey)))\n\t\t{\n\t\t\tthis.inputTimeout = setTimeout(() => {\n\t\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t\t{\n\t\t\t\t\tthis.onChange(true);\n\t\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t\t}\n\t\t\t}, 400);\n\t\t}\n\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tconst tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'), 10);\n\t\t\tif (\n\t\t\t\tevent.srcElement.textContent === ''\n\t\t\t\t&& BX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t\t&& tableFontSize < this.tableBaseFontSize\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.Dom.addClass(event.srcElement, 'landing-table-td-height');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Dom.removeClass(event.srcElement, 'landing-table-td-height');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Handles escape press event\n\t */\n\tonEscapePress()\n\t{\n\t\t// Hide editor by press on Escape button\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tif (this === this.currentNode)\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\n\t\t\tthis.disableEdit();\n\t\t}\n\t}\n\n\t/**\n\t * Handles drop event on this node\n\t *\n\t * @param {DragEvent} event\n\t */\n\tonDrop(event)\n\t{\n\t\t// Prevents drag and drop any content into editor area\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Handles paste event on this node\n\t *\n\t * @param {ClipboardEvent} event\n\t * @param {function} event.preventDefault\n\t * @param {object} event.clipboardData\n\t */\n\tonPaste(event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tif (event.clipboardData && event.clipboardData.getData)\n\t\t{\n\t\t\tconst sourceText = event.clipboardData.getData('text/plain');\n\t\t\tlet encodedText = BX.Text.encode(sourceText);\n\t\t\tif (this.isLinkPasted(sourceText))\n\t\t\t{\n\t\t\t\tencodedText = this.prepareToLink(encodedText);\n\t\t\t}\n\t\t\tconst formattedHtml = encodedText.replaceAll('\\n', '<br>');\n\t\t\tdocument.execCommand('insertHTML', false, formattedHtml);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// ie11\n\t\t\tconst text = window.clipboardData.getData('text');\n\t\t\tdocument.execCommand('paste', true, BX.Text.encode(text));\n\t\t}\n\n\t\tthis.onChange();\n\t}\n\n\t/**\n\t * Handles click on document\n\t */\n\tonDocumentClick(event)\n\t{\n\t\tif (this.isEditable() && !this.fromNode)\n\t\t{\n\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\tthis.disableEdit();\n\t\t}\n\n\t\tthis.fromNode = false;\n\t}\n\n\tonMousedown(event)\n\t{\n\t\tBX.Event.EventEmitter.emit('BX.Landing.Node.Text:onMousedown');\n\t\tif (!this.manifest.group)\n\t\t{\n\t\t\tthis.fromNode = true;\n\n\t\t\tif (this.manifest.allowInlineEdit !== false\n\t\t\t\t&& BX.Landing.Main.getInstance().isControlsEnabled())\n\t\t\t{\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.enableEdit();\n\t\t\t\tif (this.isTable(event))\n\t\t\t\t{\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tthis.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t\t\t.forEach((table) => {\n\t\t\t\t\t\t\tif (!table.hasAttribute('table-prepare'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.prepareNewTable(table);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\tconst tableFontSize = parseInt(window.getComputedStyle(event.srcElement).getPropertyValue('font-size'), 10);\n\t\t\t\t\tif (\n\t\t\t\t\t\tevent.srcElement.textContent === ''\n\t\t\t\t\t\t&& BX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t\t\t\t&& tableFontSize < this.tableBaseFontSize\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Dom.addClass(event.srcElement, 'landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Dom.removeClass(event.srcElement, 'landing-table-td-height');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (!this.manifest.textOnly && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(this.node, null, this.buttons);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.nodeTableContainerList)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.nodeTableContainerList.forEach((tableContainer) => {\n\t\t\t\t\t\t\ttableContainer.tableEditor.unselect(tableContainer.tableEditor);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tBX.Landing.UI.Tool.ColorPicker.hideAll();\n\t\t\t}\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (event.target.nodeName === 'A'\n\t\t\t\t\t|| event.target.parentElement.nodeName === 'A')\n\t\t\t\t{\n\t\t\t\t\tconst range = document.createRange();\n\t\t\t\t\trange.selectNode(event.target);\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tonMouseup()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.fromNode = false;\n\t\t}, 10);\n\t}\n\n\t/**\n\t * Click on field - switch edit mode.\n\t */\n\tonClick(event)\n\t{\n\t\tif (this.isTable(event))\n\t\t{\n\t\t\tthis.addTableButtons(event);\n\t\t}\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tthis.fromNode = false;\n\n\t\tif (event.target.nodeName === 'A'\n\t\t\t|| event.target.parentElement.nodeName === 'A')\n\t\t{\n\t\t\tconst range = document.createRange();\n\t\t\trange.selectNode(event.target);\n\t\t\twindow.getSelection().removeAllRanges();\n\t\t\twindow.getSelection().addRange(range);\n\t\t}\n\t}\n\n\t/**\n\t * Checks that is editable\n\t * @return {boolean}\n\t */\n\tisEditable(): boolean\n\t{\n\t\treturn this.node.isContentEditable;\n\t}\n\n\t/**\n\t * Enables edit mode\n\t */\n\tenableEdit(): void\n\t{\n\t\tconst currentNode = this.currentNode;\n\t\tif (currentNode)\n\t\t{\n\t\t\tconst node = this.currentNode.node;\n\t\t\tconst nodeTableContainerList = node.querySelectorAll('.landing-table-container');\n\t\t\tif (nodeTableContainerList.length > 0)\n\t\t\t{\n\t\t\t\tnodeTableContainerList.forEach((nodeTableContainer) => {\n\t\t\t\t\tif (!nodeTableContainer.tableEditor)\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeTableContainer.tableEditor = new TableEditor(nodeTableContainer, this.currentNode);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.nodeTableContainerList = nodeTableContainerList;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.isEditable() && !BX.Landing.UI.Panel.StylePanel.getInstance().isShown())\n\t\t{\n\t\t\tif (this !== this.currentNode && this.currentNode !== null)\n\t\t\t{\n\t\t\t\tthis.disableEdit();\n\t\t\t}\n\n\t\t\tthis.currentNode = this;\n\t\t\tBX.Landing.Node.Text.currentNode = this.currentNode;\n\n\t\t\tthis.buttons = [];\n\t\t\tthis.buttons.push(this.getDesignButton());\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.buttons.push(this.getChangeTagButton());\n\t\t\t\tthis.getChangeTagButton().onChangeHandler = this.onChangeTag.bind(this);\n\t\t\t}\n\n\t\t\tthis.lastValue = this.getValue();\n\t\t\tthis.node.contentEditable = true;\n\n\t\t\tthis.node.setAttribute('title', '');\n\t\t}\n\t}\n\n\t/**\n\t * Gets design button for editor\n\t * @return {BX.Landing.UI.Button.Design}\n\t */\n\tgetDesignButton(): BX.Landing.UI.Button.Design\n\t{\n\t\tif (!this.designButton)\n\t\t{\n\t\t\tthis.designButton = new BX.Landing.UI.Button.Design('design', {\n\t\t\t\thtml: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DESIGN'),\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DESIGN') },\n\t\t\t\tonClick: function() {\n\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\tthis.disableEdit();\n\t\t\t\t\tthis.onDesignShow(this.manifest.code);\n\t\t\t\t}.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.designButton.insertBefore = 'ai_copilot';\n\n\t\treturn this.designButton;\n\t}\n\n\t/**\n\t * Disables edit mode\n\t */\n\tdisableEdit()\n\t{\n\t\tif (this.isEditable())\n\t\t{\n\t\t\tthis.node.contentEditable = false;\n\n\t\t\tif (this.lastValue !== this.getValue())\n\t\t\t{\n\t\t\t\tthis.onChange();\n\t\t\t\tthis.lastValue = this.getValue();\n\t\t\t}\n\n\t\t\tif (this.isAllowInlineEdit())\n\t\t\t{\n\t\t\t\tthis.node.setAttribute('title', escapeText(BX.Landing.Loc.getMessage('LANDING_TITLE_OF_TEXT_NODE')));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets form field\n\t * @return {BX.Landing.UI.Field.Text}\n\t */\n\tgetField(): BX.Landing.UI.Field.Text\n\t{\n\t\tif (this.field)\n\t\t{\n\t\t\tthis.field.setValue(this.node.innerHTML);\n\t\t\tthis.field.content = this.node.innerHTML;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.field = new BX.Landing.UI.Field.Text({\n\t\t\t\tselector: this.selector,\n\t\t\t\ttitle: this.manifest.name,\n\t\t\t\tcontent: this.node.innerHTML,\n\t\t\t\ttextOnly: this.manifest.textOnly,\n\t\t\t\tbind: this.node,\n\t\t\t});\n\n\t\t\tif (this.isHeader())\n\t\t\t{\n\t\t\t\tthis.field.changeTagButton = this.getChangeTagButton();\n\t\t\t}\n\t\t}\n\n\t\treturn this.field;\n\t}\n\n\t/**\n\t * Sets node value\n\t * @param value\n\t * @param {?boolean} [preventSave = false]\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tsetValue(value, preventSave, preventHistory)\n\t{\n\t\tthis.preventSave(preventSave);\n\t\tthis.lastValue = this.isSavePrevented() ? this.getValue() : this.lastValue;\n\t\tthis.node.innerHTML = value;\n\t\tthis.onChange(false, preventHistory);\n\t}\n\n\t/**\n\t * Gets node value\n\t * @return {string}\n\t */\n\tgetValue(): string\n\t{\n\t\tif (this.node.querySelector('.landing-table-container') !== null)\n\t\t{\n\t\t\tconst node = this.node.cloneNode(true);\n\t\t\tthis.prepareTable(node);\n\n\t\t\treturn textToPlaceholders(node.innerHTML);\n\t\t}\n\n\t\treturn textToPlaceholders(this.node.innerHTML);\n\t}\n\n\t/**\n\t * Checks that this node is header\n\t * @return {boolean}\n\t */\n\tisHeader(): boolean\n\t{\n\t\treturn matchers.headerTag.test(this.node.nodeName);\n\t}\n\n\t/**\n\t * Checks that this node is table\n\t * @return {boolean}\n\t */\n\tisTable(event): boolean\n\t{\n\t\tlet nodeIsTable = false;\n\t\tif (this.currentNode && event)\n\t\t{\n\t\t\tthis.currentNode.node.querySelectorAll('.landing-table-container')\n\t\t\t\t.forEach((table) => {\n\t\t\t\t\tif (table.contains(event.srcElement))\n\t\t\t\t\t{\n\t\t\t\t\t\tnodeIsTable = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\treturn nodeIsTable;\n\t}\n\n\t/**\n\t * Delete br tags in new table and add flag after this\n\t */\n\tprepareNewTable(table)\n\t{\n\t\ttable.querySelectorAll('br').forEach((tdTag) => {\n\t\t\ttdTag.remove();\n\t\t});\n\t\ttable.setAttribute('table-prepare', 'true');\n\t\tthis.currentNode.onChange(true);\n\t}\n\n\taddTableButtons(event)\n\t{\n\t\tconst buttons = [];\n\t\tlet neededButtons = [];\n\t\tlet setTd = [];\n\t\tconst tableButtons = this.getTableButtons();\n\t\tconst tableAlignButtons = [tableButtons[0], tableButtons[1], tableButtons[2], tableButtons[3]];\n\t\tconst node = this.currentNode.node;\n\t\tlet table = null;\n\t\tlet isCell = false;\n\t\tlet isButtonAddRow = false;\n\t\tlet isButtonAddCol = false;\n\t\tlet isNeedTablePanel = true;\n\t\tif (\n\t\t\tBX.Dom.hasClass(event.srcElement, 'landing-table')\n\t\t\t|| BX.Dom.hasClass(event.srcElement, 'landing-table-col-dnd')\n\t\t)\n\t\t{\n\t\t\tisNeedTablePanel = false;\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-row-add'))\n\t\t{\n\t\t\tisButtonAddRow = true;\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-col-add'))\n\t\t{\n\t\t\tisButtonAddCol = true;\n\t\t}\n\t\tlet hideButtons = [];\n\t\tconst nodeTableList = node.querySelectorAll('.landing-table');\n\t\tif (nodeTableList.length > 0)\n\t\t{\n\t\t\tnodeTableList.forEach((nodeTable) => {\n\t\t\t\tif (nodeTable.contains(event.srcElement))\n\t\t\t\t{\n\t\t\t\t\ttable = nodeTable;\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t\tlet isSelectedAll;\n\n\t\ttableButtons.forEach((tableButton) => {\n\t\t\ttableButton.options.srcElement = event.srcElement;\n\t\t\ttableButton.options.node = node;\n\t\t\ttableButton.options.table = table;\n\t\t});\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-row-dnd'))\n\t\t{\n\t\t\tsetTd = event.srcElement.parentNode.children;\n\t\t\tsetTd = [...setTd];\n\t\t\tneededButtons = this.getAmountTableRows(table) > 1 ? [0, 1, 2, 3, 4, 5, 6] : [0, 1, 2, 3, 4, 5];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'row';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement.parentNode, 'landing-table-col-dnd'))\n\t\t{\n\t\t\tconst childNodes = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\tconst childNodesArray = [...childNodes];\n\t\t\tconst childNodesArrayPrepare = [];\n\t\t\tchildNodesArray.forEach((childNode) => {\n\t\t\t\tif (childNode.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tchildNodesArrayPrepare.push(childNode);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst neededPosition = childNodesArrayPrepare.indexOf(event.srcElement.parentElement);\n\t\t\tconst rows = event.srcElement.parentElement.parentElement.parentElement.childNodes;\n\t\t\trows.forEach((row) => {\n\t\t\t\tif (row.nodeType === 1)\n\t\t\t\t{\n\t\t\t\t\tconst rowChildPrepare = [];\n\t\t\t\t\trow.childNodes.forEach((rowChildNode) => {\n\t\t\t\t\t\tif (rowChildNode.nodeType === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trowChildPrepare.push(rowChildNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (rowChildPrepare[neededPosition])\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTd.push(rowChildPrepare[neededPosition]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tneededButtons = this.getAmountTableCols(table) > 1 ? [0, 1, 2, 3, 4, 5, 7] : [0, 1, 2, 3, 4, 5];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'col';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t}\n\n\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-th-select-all'))\n\t\t{\n\t\t\tif (BX.Dom.hasClass(event.srcElement, 'landing-table-th-select-all-selected'))\n\t\t\t{\n\t\t\t\tisSelectedAll = true;\n\t\t\t\tconst rows = event.srcElement.parentElement.parentElement.childNodes;\n\t\t\t\trows.forEach((row) => {\n\t\t\t\t\trow.childNodes.forEach((th) => {\n\t\t\t\t\t\tsetTd.push(th);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tneededButtons = [0, 1, 2, 3, 4, 5, 8, 9, 10];\n\t\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\t\ttableButtons[neededButton].options.target = 'table';\n\t\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tisSelectedAll = false;\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tBX.Dom.hasClass(event.srcElement, 'landing-table-td')\n\t\t\t|| event.srcElement.closest('.landing-table-td') !== null\n\t\t)\n\t\t{\n\t\t\tsetTd.push(event.srcElement);\n\t\t\tneededButtons = [3, 2, 1, 0];\n\t\t\tneededButtons.forEach((neededButton) => {\n\t\t\t\ttableButtons[neededButton].options.target = 'cell';\n\t\t\t\ttableButtons[neededButton].options.setTd = setTd;\n\t\t\t\ttableButtons[neededButton].insertAfter = 'strikeThrough';\n\t\t\t\tbuttons.push(tableButtons[neededButton]);\n\t\t\t});\n\t\t\tisCell = true;\n\t\t\thideButtons = ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull', 'createTable', 'pasteTable'];\n\t\t}\n\n\t\tlet activeAlignButtonId = null;\n\t\tconst setActiveAlignButtonId = [];\n\t\tsetTd.forEach((th) => {\n\t\t\tif (th.nodeType === 1)\n\t\t\t{\n\t\t\t\tactiveAlignButtonId = undefined;\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-left'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignLeft';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-center'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignCenter';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-right'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignRight';\n\t\t\t\t}\n\n\t\t\t\tif (BX.Dom.hasClass(th, 'text-justify'))\n\t\t\t\t{\n\t\t\t\t\tactiveAlignButtonId = 'alignJustify';\n\t\t\t\t}\n\t\t\t\tsetActiveAlignButtonId.push(activeAlignButtonId);\n\t\t\t}\n\t\t});\n\t\tlet count = 0;\n\t\tlet isIdentical = true;\n\t\twhile (count < setActiveAlignButtonId.length && isIdentical)\n\t\t{\n\t\t\tif (count > 0 && setActiveAlignButtonId[count] !== setActiveAlignButtonId[count - 1])\n\t\t\t{\n\t\t\t\tisIdentical = false;\n\t\t\t}\n\t\t\tcount++;\n\t\t}\n\n\t\tactiveAlignButtonId = isIdentical ? setActiveAlignButtonId[0] : undefined;\n\t\tif (activeAlignButtonId)\n\t\t{\n\t\t\ttableAlignButtons.forEach((tableAlignButton) => {\n\t\t\t\tif (tableAlignButton.id === activeAlignButtonId)\n\t\t\t\t{\n\t\t\t\t\tBX.Dom.addClass(tableAlignButton.layout, 'landing-ui-active');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (buttons[0] && buttons[1] && buttons[2] && buttons[3])\n\t\t{\n\t\t\tbuttons[0].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[1].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[2].options.alignButtons = tableAlignButtons;\n\t\t\tbuttons[3].options.alignButtons = tableAlignButtons;\n\t\t}\n\n\t\tif (!this.manifest.textOnly)\n\t\t{\n\t\t\tif (isNeedTablePanel)\n\t\t\t{\n\t\t\t\tif (!isButtonAddRow && !isButtonAddCol && table)\n\t\t\t\t{\n\t\t\t\t\tif (isCell)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true, hideButtons);\n\t\t\t\t\t}\n\t\t\t\t\telse if (isSelectedAll === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().show(table.parentNode, null, buttons, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Landing.UI.Panel.EditorPanel.getInstance().hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets change tag button\n\t * @return {BX.Landing.UI.Button.ChangeTag}\n\t */\n\tgetChangeTagButton(): BX.Landing.UI.Button.ChangeTag\n\t{\n\t\tif (!this.changeTagButton)\n\t\t{\n\t\t\tthis.changeTagButton = new BX.Landing.UI.Button.ChangeTag('changeTag', {\n\t\t\t\thtml: `<span class=\"landing-ui-icon-editor-${this.node.nodeName.toLowerCase()}\"></span>`,\n\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_CHANGE_TAG') },\n\t\t\t\tonChange: this.onChangeTag.bind(this),\n\t\t\t});\n\t\t}\n\n\t\tthis.changeTagButton.insertAfter = 'unlink';\n\n\t\tthis.changeTagButton.activateItem(this.node.nodeName);\n\n\t\treturn this.changeTagButton;\n\t}\n\n\tgetTableButtons(): []\n\t{\n\t\tthis.buttons = [];\n\t\tthis.buttons.push(\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\n\t\t\t\t'alignLeft',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-left\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_LEFT') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\n\t\t\t\t'alignCenter',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-center\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_CENTER') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\n\t\t\t\t'alignRight',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-right\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_RIGHT') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.AlignTable(\n\t\t\t\t'alignJustify',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-justify\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_JUSTIFY') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.TableColorAction(\n\t\t\t\t'tableTextColor',\n\t\t\t\t{\n\t\t\t\t\ttext: BX.Landing.Loc.getMessage('EDITOR_ACTION_SET_FORE_COLOR'),\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_COLOR') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.TableColorAction(\n\t\t\t\t'tableBgColor',\n\t\t\t\t{\n\t\t\t\t\thtml: '<i class=\"landing-ui-icon-editor-fill-color\"></i>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_CELL_BG') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable(\n\t\t\t\t'deleteRow',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DELETE_ROW_TABLE') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.DeleteElementTable(\n\t\t\t\t'deleteCol',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_DELETE_COL_TABLE') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.StyleTable(\n\t\t\t\t'styleTable',\n\t\t\t\t{\n\t\t\t\t\thtml: `\n\t\t\t\t\t\t${BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE')}\n\t\t\t\t\t\t\t<i class=\"fas fa-chevron-down g-ml-8\"></i>\n\t\t\t\t\t`,\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.CopyTable(\n\t\t\t\t'copyTable',\n\t\t\t\t{\n\t\t\t\t\ttext: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY'),\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t\tnew BX.Landing.UI.Button.DeleteTable(\n\t\t\t\t'deleteTable',\n\t\t\t\t{\n\t\t\t\t\thtml: '<span class=\"landing-ui-icon-editor-delete\"></span>',\n\t\t\t\t\tattrs: { title: BX.Landing.Loc.getMessage('LANDING_TITLE_OF_EDITOR_ACTION_TABLE_DELETE') },\n\t\t\t\t},\n\t\t\t\tthis.currentNode,\n\t\t\t),\n\t\t);\n\n\t\treturn this.buttons;\n\t}\n\n\t/**\n\t * Handles change tag event\n\t * @param value\n\t * @param {?boolean} [preventHistory = false]\n\t */\n\tonChangeTag(value, preventHistory)\n\t{\n\t\tthis.node = changeTagName(this.node, value);\n\n\t\tthis.bindEvents(this.node);\n\n\t\tif (!this.getField().isEditable() && !preventHistory)\n\t\t{\n\t\t\tthis.disableEdit();\n\t\t\tthis.enableEdit();\n\t\t}\n\n\t\tconst data = {};\n\t\tdata[this.selector] = value;\n\n\t\tif (!preventHistory)\n\t\t{\n\t\t\tthis.changeOptionsHandler(data)\n\t\t\t\t.then(() => {\n\t\t\t\t\tBX.Landing.History.getInstance().push();\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t}\n\t}\n\n\tgetAmountTableCols(table): number\n\t{\n\t\treturn table.querySelectorAll('.landing-table-col-dnd').length;\n\t}\n\n\tgetAmountTableRows(table): number\n\t{\n\t\treturn table.querySelectorAll('.landing-table-row-dnd').length;\n\t}\n\n\tprepareTable(node): HTMLElement\n\t{\n\t\tconst setClassesForRemove = [\n\t\t\t'table-selected-all',\n\t\t\t'landing-table-th-select-all-selected',\n\t\t\t'landing-table-cell-selected',\n\t\t\t'landing-table-row-selected',\n\t\t\t'landing-table-th-selected',\n\t\t\t'landing-table-th-selected-cell',\n\t\t\t'landing-table-th-selected-top',\n\t\t\t'landing-table-th-selected-x',\n\t\t\t'landing-table-tr-selected-left',\n\t\t\t'landing-table-tr-selected-y',\n\t\t\t'landing-table-col-selected',\n\t\t\t'landing-table-tr-selected',\n\t\t\t'table-selected-all-right',\n\t\t\t'table-selected-all-bottom',\n\t\t];\n\t\tsetClassesForRemove.forEach((className) => {\n\t\t\tnode.querySelectorAll(`.${className}`).forEach((element) => {\n\t\t\t\tBX.Dom.removeClass(element, className);\n\t\t\t});\n\t\t});\n\n\t\treturn node;\n\t}\n\n\tonBackspaceDown(event)\n\t{\n\t\tconst selection = window.getSelection();\n\t\tconst position = selection.getRangeAt(0).startOffset;\n\t\tif (position === 0)\n\t\t{\n\t\t\tlet focusNode = selection.focusNode;\n\t\t\tif (!BX.Type.isNil(focusNode) && focusNode.nodeType !== 3)\n\t\t\t{\n\t\t\t\tif (focusNode.firstChild.nodeType === 3 && focusNode.firstChild.firstChild.nodeType === 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild.firstChild;\n\t\t\t\t}\n\t\t\t\telse if (focusNode.firstChild.nodeType === 3)\n\t\t\t\t{\n\t\t\t\t\tfocusNode = null;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfocusNode = focusNode.firstChild;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (focusNode)\n\t\t\t{\n\t\t\t\tconst focusNodeParent = focusNode.parentNode;\n\t\t\t\tconst allowedNodeName = new Set(['BLOCKQUOTE', 'UL']);\n\t\t\t\tif (focusNodeParent && allowedNodeName.has(focusNodeParent.nodeName))\n\t\t\t\t{\n\t\t\t\t\tconst focusNodeContainer = document.createElement('div');\n\t\t\t\t\tfocusNodeContainer.append(focusNode);\n\t\t\t\t\tfocusNodeParent.append(focusNodeContainer);\n\t\t\t\t}\n\t\t\t\tlet contentNode = focusNode.parentNode.parentNode;\n\t\t\t\twhile (contentNode && !allowedNodeName.has(contentNode.nodeName))\n\t\t\t\t{\n\t\t\t\t\tcontentNode = contentNode.parentNode;\n\t\t\t\t}\n\n\t\t\t\tif (contentNode && contentNode.childNodes.length === 1)\n\t\t\t\t{\n\t\t\t\t\tcontentNode.after(focusNode.parentNode);\n\t\t\t\t\tcontentNode.remove();\n\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tisLinkPasted(text): boolean\n\t{\n\t\tconst reg = /^https?:\\/\\/(?:www\\.)?[\\w#%+.:=@~-]{1,256}\\.[\\d()A-Za-z]{1,6}\\b[\\w#%&()+./:=?@~-]*$/;\n\n\t\treturn Boolean(reg.test(text));\n\t}\n\n\tprepareToLink(text): HTMLElement\n\t{\n\t\treturn `<a class='g-bg-transparent' href='${text}' target='_blank'> ${text} </a>`;\n\t}\n}\n"],"names":["escapeText","BX","Landing","Utils","matchers","Matchers","changeTagName","textToPlaceholders","Text","Base","constructor","options","currentNode","type","tableBaseFontSize","onClick","bind","onPaste","onDrop","onInput","onKeyDown","onMousedown","onMouseup","bindEvents","node","Event","document","onAllowInlineEdit","setAttribute","Loc","getMessage","onChange","preventAdjustPosition","preventHistory","call","UI","Panel","EditorPanel","getInstance","adjustPosition","History","push","event","code","onBackspaceDown","clearTimeout","inputTimeout","key","keyCode","which","test","top","window","navigator","userAgent","ctrlKey","metaKey","setTimeout","lastValue","getValue","isTable","tableFontSize","parseInt","getComputedStyle","srcElement","getPropertyValue","textContent","Dom","hasClass","addClass","removeClass","onEscapePress","isEditable","hide","disableEdit","preventDefault","clipboardData","getData","sourceText","encodedText","encode","isLinkPasted","prepareToLink","formattedHtml","replaceAll","execCommand","text","onDocumentClick","fromNode","EventEmitter","emit","manifest","group","allowInlineEdit","Main","isControlsEnabled","stopPropagation","enableEdit","querySelectorAll","forEach","table","hasAttribute","prepareNewTable","textOnly","StylePanel","isShown","show","buttons","nodeTableContainerList","tableContainer","tableEditor","unselect","Tool","ColorPicker","hideAll","requestAnimationFrame","target","nodeName","parentElement","range","createRange","selectNode","getSelection","removeAllRanges","addRange","addTableButtons","isContentEditable","length","nodeTableContainer","TableEditor","Node","getDesignButton","isHeader","getChangeTagButton","onChangeHandler","onChangeTag","contentEditable","designButton","Button","Design","html","attrs","title","onDesignShow","insertBefore","isAllowInlineEdit","getField","field","setValue","innerHTML","content","Field","selector","name","changeTagButton","value","preventSave","isSavePrevented","querySelector","cloneNode","prepareTable","headerTag","nodeIsTable","contains","tdTag","remove","neededButtons","setTd","tableButtons","getTableButtons","tableAlignButtons","isCell","isButtonAddRow","isButtonAddCol","isNeedTablePanel","hideButtons","nodeTableList","nodeTable","isSelectedAll","tableButton","parentNode","children","getAmountTableRows","neededButton","childNodes","childNodesArray","childNodesArrayPrepare","childNode","nodeType","neededPosition","indexOf","rows","row","rowChildPrepare","rowChildNode","getAmountTableCols","th","closest","insertAfter","activeAlignButtonId","setActiveAlignButtonId","undefined","count","isIdentical","tableAlignButton","id","layout","alignButtons","ChangeTag","toLowerCase","activateItem","AlignTable","TableColorAction","DeleteElementTable","StyleTable","CopyTable","DeleteTable","data","changeOptionsHandler","then","catch","setClassesForRemove","className","element","selection","position","getRangeAt","startOffset","focusNode","Type","isNil","firstChild","focusNodeParent","allowedNodeName","Set","has","focusNodeContainer","createElement","append","contentNode","after","reg","Boolean"],"mappings":";;;;;CAIA,MAAMA,UAAU,GAAGC,EAAE,CAACC,OAAO,CAACC,KAAK,CAACH,UAAU;CAC9C,MAAMI,QAAQ,GAAGH,EAAE,CAACC,OAAO,CAACC,KAAK,CAACE,QAAQ;CAC1C,MAAMC,aAAa,GAAGL,EAAE,CAACC,OAAO,CAACC,KAAK,CAACG,aAAa;CACpD,MAAMC,kBAAkB,GAAGN,EAAE,CAACC,OAAO,CAACC,KAAK,CAACI,kBAAkB;AAE9D,CAAO,MAAMC,IAAI,SAASC,sBAAI,CAC9B;GACCC,WAAW,CAACC,OAAO,EACnB;KACC,KAAK,CAACA,OAAO,CAAC;KAEd,IAAI,CAACC,WAAW,GAAG,IAAI;KACvB,IAAI,CAACC,IAAI,GAAG,MAAM;KAClB,IAAI,CAACC,iBAAiB,GAAG,IAAI;KAE7B,IAAI,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC;KACtC,IAAI,CAACC,OAAO,GAAG,IAAI,CAACA,OAAO,CAACD,IAAI,CAAC,IAAI,CAAC;KACtC,IAAI,CAACE,MAAM,GAAG,IAAI,CAACA,MAAM,CAACF,IAAI,CAAC,IAAI,CAAC;KACpC,IAAI,CAACG,OAAO,GAAG,IAAI,CAACA,OAAO,CAACH,IAAI,CAAC,IAAI,CAAC;KACtC,IAAI,CAACI,SAAS,GAAG,IAAI,CAACA,SAAS,CAACJ,IAAI,CAAC,IAAI,CAAC;KAC1C,IAAI,CAACK,WAAW,GAAG,IAAI,CAACA,WAAW,CAACL,IAAI,CAAC,IAAI,CAAC;KAC9C,IAAI,CAACM,SAAS,GAAG,IAAI,CAACA,SAAS,CAACN,IAAI,CAAC,IAAI,CAAC;;;KAG1C,IAAI,CAACO,UAAU,CAAC,IAAI,CAACC,IAAI,CAAC;KAC1BC,eAAK,CAACT,IAAI,CAACU,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACJ,SAAS,CAAC;;GAGhDC,UAAU,CAACC,IAAI,EACf;KACCC,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,WAAW,EAAE,IAAI,CAACH,WAAW,CAAC;KAC/CI,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,OAAO,EAAE,IAAI,CAACT,OAAO,CAAC;KACvCU,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,OAAO,EAAE,IAAI,CAACP,OAAO,CAAC;KACvCQ,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,MAAM,EAAE,IAAI,CAACN,MAAM,CAAC;KACrCO,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,OAAO,EAAE,IAAI,CAACL,OAAO,CAAC;KACvCM,eAAK,CAACT,IAAI,CAACQ,IAAI,EAAE,SAAS,EAAE,IAAI,CAACJ,SAAS,CAAC;;;;CAI7C;CACA;GACCO,iBAAiB,GACjB;;KAEC,IAAI,CAACH,IAAI,CAACI,YAAY,CAAC,OAAO,EAAE5B,UAAU,CAACC,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,4BAA4B,CAAC,CAAC,CAAC;;;;CAItG;CACA;CACA;CACA;GACCC,QAAQ,CAACC,qBAAqB,EAAEC,cAAc,EAC9C;KACC,KAAK,CAACF,QAAQ,CAACG,IAAI,CAAC,IAAI,EAAED,cAAc,CAAC;KACzC,IAAI,CAACD,qBAAqB,EAC1B;OACC/B,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,cAAc,CAAC,IAAI,CAACf,IAAI,CAAC;;KAGxE,IAAI,CAACS,cAAc,EACnB;OACChC,EAAE,CAACC,OAAO,CAACsC,OAAO,CAACF,WAAW,EAAE,CAACG,IAAI,EAAE;;;GAIzCrB,SAAS,CAACsB,KAAK,EACf;KACC,IAAIA,KAAK,CAACC,IAAI,KAAK,WAAW,EAC9B;OACC,IAAI,CAACC,eAAe,CAACF,KAAK,CAAC;;KAE5B,IAAI,CAACvB,OAAO,CAACuB,KAAK,CAAC;;GAGpBvB,OAAO,CAACuB,KAAK,EACb;KACCG,YAAY,CAAC,IAAI,CAACC,YAAY,CAAC;KAE/B,MAAMC,GAAG,GAAGL,KAAK,CAACM,OAAO,IAAIN,KAAK,CAACO,KAAK;KAExC,IAAI,EAAEF,GAAG,KAAK,EAAE,KAAK,MAAM,CAACG,IAAI,CAACC,GAAG,CAACC,MAAM,CAACC,SAAS,CAACC,SAAS,CAAC,GAAGZ,KAAK,CAACa,OAAO,GAAGb,KAAK,CAACc,OAAO,CAAC,CAAC,EAClG;OACC,IAAI,CAACV,YAAY,GAAGW,UAAU,CAAC,MAAM;SACpC,IAAI,IAAI,CAACC,SAAS,KAAK,IAAI,CAACC,QAAQ,EAAE,EACtC;WACC,IAAI,CAAC5B,QAAQ,CAAC,IAAI,CAAC;WACnB,IAAI,CAAC2B,SAAS,GAAG,IAAI,CAACC,QAAQ,EAAE;;QAEjC,EAAE,GAAG,CAAC;;KAGR,IAAI,IAAI,CAACC,OAAO,CAAClB,KAAK,CAAC,EACvB;OACC,MAAMmB,aAAa,GAAGC,QAAQ,CAACV,MAAM,CAACW,gBAAgB,CAACrB,KAAK,CAACsB,UAAU,CAAC,CAACC,gBAAgB,CAAC,WAAW,CAAC,EAAE,EAAE,CAAC;OAC3G,IACCvB,KAAK,CAACsB,UAAU,CAACE,WAAW,KAAK,EAAE,IAChCjE,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,kBAAkB,CAAC,IACrDH,aAAa,GAAG,IAAI,CAAC/C,iBAAiB,EAE1C;SACCb,EAAE,CAACkE,GAAG,CAACE,QAAQ,CAAC3B,KAAK,CAACsB,UAAU,EAAE,yBAAyB,CAAC;QAC5D,MAED;SACC/D,EAAE,CAACkE,GAAG,CAACG,WAAW,CAAC5B,KAAK,CAACsB,UAAU,EAAE,yBAAyB,CAAC;;;;;;CAMnE;CACA;GACCO,aAAa,GACb;;KAEC,IAAI,IAAI,CAACC,UAAU,EAAE,EACrB;OACC,IAAI,IAAI,KAAK,IAAI,CAAC5D,WAAW,EAC7B;SACCX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;;OAGrD,IAAI,CAACC,WAAW,EAAE;;;;;CAKrB;CACA;CACA;CACA;GACCxD,MAAM,CAACwB,KAAK,EACZ;;KAECA,KAAK,CAACiC,cAAc,EAAE;;;;CAIxB;CACA;CACA;CACA;CACA;CACA;GACC1D,OAAO,CAACyB,KAAK,EACb;KACCA,KAAK,CAACiC,cAAc,EAAE;KAEtB,IAAIjC,KAAK,CAACkC,aAAa,IAAIlC,KAAK,CAACkC,aAAa,CAACC,OAAO,EACtD;OACC,MAAMC,UAAU,GAAGpC,KAAK,CAACkC,aAAa,CAACC,OAAO,CAAC,YAAY,CAAC;OAC5D,IAAIE,WAAW,GAAG9E,EAAE,CAACO,IAAI,CAACwE,MAAM,CAACF,UAAU,CAAC;OAC5C,IAAI,IAAI,CAACG,YAAY,CAACH,UAAU,CAAC,EACjC;SACCC,WAAW,GAAG,IAAI,CAACG,aAAa,CAACH,WAAW,CAAC;;OAE9C,MAAMI,aAAa,GAAGJ,WAAW,CAACK,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC;OAC1D1D,QAAQ,CAAC2D,WAAW,CAAC,YAAY,EAAE,KAAK,EAAEF,aAAa,CAAC;MACxD,MAED;;OAEC,MAAMG,IAAI,GAAGlC,MAAM,CAACwB,aAAa,CAACC,OAAO,CAAC,MAAM,CAAC;OACjDnD,QAAQ,CAAC2D,WAAW,CAAC,OAAO,EAAE,IAAI,EAAEpF,EAAE,CAACO,IAAI,CAACwE,MAAM,CAACM,IAAI,CAAC,CAAC;;KAG1D,IAAI,CAACvD,QAAQ,EAAE;;;;CAIjB;CACA;GACCwD,eAAe,CAAC7C,KAAK,EACrB;KACC,IAAI,IAAI,CAAC8B,UAAU,EAAE,IAAI,CAAC,IAAI,CAACgB,QAAQ,EACvC;OACCvF,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;OACpD,IAAI,CAACC,WAAW,EAAE;;KAGnB,IAAI,CAACc,QAAQ,GAAG,KAAK;;GAGtBnE,WAAW,CAACqB,KAAK,EACjB;KACCzC,EAAE,CAACwB,KAAK,CAACgE,YAAY,CAACC,IAAI,CAAC,kCAAkC,CAAC;KAC9D,IAAI,CAAC,IAAI,CAACC,QAAQ,CAACC,KAAK,EACxB;OACC,IAAI,CAACJ,QAAQ,GAAG,IAAI;OAEpB,IAAI,IAAI,CAACG,QAAQ,CAACE,eAAe,KAAK,KAAK,IACvC5F,EAAE,CAACC,OAAO,CAAC4F,IAAI,CAACxD,WAAW,EAAE,CAACyD,iBAAiB,EAAE,EACrD;SACCrD,KAAK,CAACsD,eAAe,EAAE;SACvB,IAAI,CAACC,UAAU,EAAE;SACjB,IAAI,IAAI,CAACrC,OAAO,CAAClB,KAAK,CAAC,EACvB;WACC,IAAI,CAACgC,WAAW,EAAE;WAClB,IAAI,CAAC9D,WAAW,CAACY,IAAI,CAAC0E,gBAAgB,CAAC,0BAA0B,CAAC,CAChEC,OAAO,CAAEC,KAAK,IAAK;aACnB,IAAI,CAACA,KAAK,CAACC,YAAY,CAAC,eAAe,CAAC,EACxC;eACC,IAAI,CAACC,eAAe,CAACF,KAAK,CAAC;;YAE5B,CAAC;WACH,MAAMvC,aAAa,GAAGC,QAAQ,CAACV,MAAM,CAACW,gBAAgB,CAACrB,KAAK,CAACsB,UAAU,CAAC,CAACC,gBAAgB,CAAC,WAAW,CAAC,EAAE,EAAE,CAAC;WAC3G,IACCvB,KAAK,CAACsB,UAAU,CAACE,WAAW,KAAK,EAAE,IAChCjE,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,kBAAkB,CAAC,IACrDH,aAAa,GAAG,IAAI,CAAC/C,iBAAiB,EAE1C;aACCb,EAAE,CAACkE,GAAG,CAACE,QAAQ,CAAC3B,KAAK,CAACsB,UAAU,EAAE,yBAAyB,CAAC;YAC5D,MAED;aACC/D,EAAE,CAACkE,GAAG,CAACG,WAAW,CAAC5B,KAAK,CAACsB,UAAU,EAAE,yBAAyB,CAAC;;UAEhE,MAED;WACC,IAAI,CAAC,IAAI,CAAC2B,QAAQ,CAACY,QAAQ,IAAI,CAACtG,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACoE,UAAU,CAAClE,WAAW,EAAE,CAACmE,OAAO,EAAE,EACtF;aACCxG,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACoE,IAAI,CAAC,IAAI,CAAClF,IAAI,EAAE,IAAI,EAAE,IAAI,CAACmF,OAAO,CAAC;;WAGlF,IAAI,IAAI,CAACC,sBAAsB,EAC/B;aACC,IAAI,CAACA,sBAAsB,CAACT,OAAO,CAAEU,cAAc,IAAK;eACvDA,cAAc,CAACC,WAAW,CAACC,QAAQ,CAACF,cAAc,CAACC,WAAW,CAAC;cAC/D,CAAC;;;SAIJ7G,EAAE,CAACC,OAAO,CAACiC,EAAE,CAAC6E,IAAI,CAACC,WAAW,CAACC,OAAO,EAAE;;OAGzCC,qBAAqB,CAAC,MAAM;SAC3B,IAAIzE,KAAK,CAAC0E,MAAM,CAACC,QAAQ,KAAK,GAAG,IAC7B3E,KAAK,CAAC0E,MAAM,CAACE,aAAa,CAACD,QAAQ,KAAK,GAAG,EAC/C;WACC,MAAME,KAAK,GAAG7F,QAAQ,CAAC8F,WAAW,EAAE;WACpCD,KAAK,CAACE,UAAU,CAAC/E,KAAK,CAAC0E,MAAM,CAAC;WAC9BhE,MAAM,CAACsE,YAAY,EAAE,CAACC,eAAe,EAAE;WACvCvE,MAAM,CAACsE,YAAY,EAAE,CAACE,QAAQ,CAACL,KAAK,CAAC;;QAEtC,CAAC;;;GAIJjG,SAAS,GACT;KACCmC,UAAU,CAAC,MAAM;OAChB,IAAI,CAAC+B,QAAQ,GAAG,KAAK;MACrB,EAAE,EAAE,CAAC;;;;CAIR;CACA;GACCzE,OAAO,CAAC2B,KAAK,EACb;KACC,IAAI,IAAI,CAACkB,OAAO,CAAClB,KAAK,CAAC,EACvB;OACC,IAAI,CAACmF,eAAe,CAACnF,KAAK,CAAC;;KAG5BA,KAAK,CAACsD,eAAe,EAAE;KACvBtD,KAAK,CAACiC,cAAc,EAAE;KACtB,IAAI,CAACa,QAAQ,GAAG,KAAK;KAErB,IAAI9C,KAAK,CAAC0E,MAAM,CAACC,QAAQ,KAAK,GAAG,IAC7B3E,KAAK,CAAC0E,MAAM,CAACE,aAAa,CAACD,QAAQ,KAAK,GAAG,EAC/C;OACC,MAAME,KAAK,GAAG7F,QAAQ,CAAC8F,WAAW,EAAE;OACpCD,KAAK,CAACE,UAAU,CAAC/E,KAAK,CAAC0E,MAAM,CAAC;OAC9BhE,MAAM,CAACsE,YAAY,EAAE,CAACC,eAAe,EAAE;OACvCvE,MAAM,CAACsE,YAAY,EAAE,CAACE,QAAQ,CAACL,KAAK,CAAC;;;;;CAKxC;CACA;CACA;GACC/C,UAAU,GACV;KACC,OAAO,IAAI,CAAChD,IAAI,CAACsG,iBAAiB;;;;CAIpC;CACA;GACC7B,UAAU,GACV;KACC,MAAMrF,WAAW,GAAG,IAAI,CAACA,WAAW;KACpC,IAAIA,WAAW,EACf;OACC,MAAMY,IAAI,GAAG,IAAI,CAACZ,WAAW,CAACY,IAAI;OAClC,MAAMoF,sBAAsB,GAAGpF,IAAI,CAAC0E,gBAAgB,CAAC,0BAA0B,CAAC;OAChF,IAAIU,sBAAsB,CAACmB,MAAM,GAAG,CAAC,EACrC;SACCnB,sBAAsB,CAACT,OAAO,CAAE6B,kBAAkB,IAAK;WACtD,IAAI,CAACA,kBAAkB,CAAClB,WAAW,EACnC;aACCkB,kBAAkB,CAAClB,WAAW,GAAG,IAAImB,oCAAW,CAACD,kBAAkB,EAAE,IAAI,CAACpH,WAAW,CAAC;;UAEvF,CAAC;SACF,IAAI,CAACgG,sBAAsB,GAAGA,sBAAsB;;;KAItD,IAAI,CAAC,IAAI,CAACpC,UAAU,EAAE,IAAI,CAACvE,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACoE,UAAU,CAAClE,WAAW,EAAE,CAACmE,OAAO,EAAE,EACjF;OACC,IAAI,IAAI,KAAK,IAAI,CAAC7F,WAAW,IAAI,IAAI,CAACA,WAAW,KAAK,IAAI,EAC1D;SACC,IAAI,CAAC8D,WAAW,EAAE;;OAGnB,IAAI,CAAC9D,WAAW,GAAG,IAAI;OACvBX,EAAE,CAACC,OAAO,CAACgI,IAAI,CAAC1H,IAAI,CAACI,WAAW,GAAG,IAAI,CAACA,WAAW;OAEnD,IAAI,CAAC+F,OAAO,GAAG,EAAE;OACjB,IAAI,CAACA,OAAO,CAAClE,IAAI,CAAC,IAAI,CAAC0F,eAAe,EAAE,CAAC;OAEzC,IAAI,IAAI,CAACC,QAAQ,EAAE,EACnB;SACC,IAAI,CAACzB,OAAO,CAAClE,IAAI,CAAC,IAAI,CAAC4F,kBAAkB,EAAE,CAAC;SAC5C,IAAI,CAACA,kBAAkB,EAAE,CAACC,eAAe,GAAG,IAAI,CAACC,WAAW,CAACvH,IAAI,CAAC,IAAI,CAAC;;OAGxE,IAAI,CAAC0C,SAAS,GAAG,IAAI,CAACC,QAAQ,EAAE;OAChC,IAAI,CAACnC,IAAI,CAACgH,eAAe,GAAG,IAAI;OAEhC,IAAI,CAAChH,IAAI,CAACI,YAAY,CAAC,OAAO,EAAE,EAAE,CAAC;;;;;CAKtC;CACA;CACA;GACCuG,eAAe,GACf;KACC,IAAI,CAAC,IAAI,CAACM,YAAY,EACtB;OACC,IAAI,CAACA,YAAY,GAAG,IAAIxI,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACC,MAAM,CAAC,QAAQ,EAAE;SAC7DC,IAAI,EAAE3I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,uCAAuC,CAAC;SACxE+G,KAAK,EAAE;WAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,uCAAuC;UAAG;SACpFf,OAAO,EAAE,YAAW;WACnBd,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;WACpD,IAAI,CAACC,WAAW,EAAE;WAClB,IAAI,CAACqE,YAAY,CAAC,IAAI,CAACpD,QAAQ,CAAChD,IAAI,CAAC;UACrC,CAAC3B,IAAI,CAAC,IAAI;QACX,CAAC;;KAGH,IAAI,CAACyH,YAAY,CAACO,YAAY,GAAG,YAAY;KAE7C,OAAO,IAAI,CAACP,YAAY;;;;CAI1B;CACA;GACC/D,WAAW,GACX;KACC,IAAI,IAAI,CAACF,UAAU,EAAE,EACrB;OACC,IAAI,CAAChD,IAAI,CAACgH,eAAe,GAAG,KAAK;OAEjC,IAAI,IAAI,CAAC9E,SAAS,KAAK,IAAI,CAACC,QAAQ,EAAE,EACtC;SACC,IAAI,CAAC5B,QAAQ,EAAE;SACf,IAAI,CAAC2B,SAAS,GAAG,IAAI,CAACC,QAAQ,EAAE;;OAGjC,IAAI,IAAI,CAACsF,iBAAiB,EAAE,EAC5B;SACC,IAAI,CAACzH,IAAI,CAACI,YAAY,CAAC,OAAO,EAAE5B,UAAU,CAACC,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,4BAA4B,CAAC,CAAC,CAAC;;;;;;CAMxG;CACA;CACA;GACCoH,QAAQ,GACR;KACC,IAAI,IAAI,CAACC,KAAK,EACd;OACC,IAAI,CAACA,KAAK,CAACC,QAAQ,CAAC,IAAI,CAAC5H,IAAI,CAAC6H,SAAS,CAAC;OACxC,IAAI,CAACF,KAAK,CAACG,OAAO,GAAG,IAAI,CAAC9H,IAAI,CAAC6H,SAAS;MACxC,MAED;OACC,IAAI,CAACF,KAAK,GAAG,IAAIlJ,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACoH,KAAK,CAAC/I,IAAI,CAAC;SACzCgJ,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBV,KAAK,EAAE,IAAI,CAACnD,QAAQ,CAAC8D,IAAI;SACzBH,OAAO,EAAE,IAAI,CAAC9H,IAAI,CAAC6H,SAAS;SAC5B9C,QAAQ,EAAE,IAAI,CAACZ,QAAQ,CAACY,QAAQ;SAChCvF,IAAI,EAAE,IAAI,CAACQ;QACX,CAAC;OAEF,IAAI,IAAI,CAAC4G,QAAQ,EAAE,EACnB;SACC,IAAI,CAACe,KAAK,CAACO,eAAe,GAAG,IAAI,CAACrB,kBAAkB,EAAE;;;KAIxD,OAAO,IAAI,CAACc,KAAK;;;;CAInB;CACA;CACA;CACA;CACA;GACCC,QAAQ,CAACO,KAAK,EAAEC,WAAW,EAAE3H,cAAc,EAC3C;KACC,IAAI,CAAC2H,WAAW,CAACA,WAAW,CAAC;KAC7B,IAAI,CAAClG,SAAS,GAAG,IAAI,CAACmG,eAAe,EAAE,GAAG,IAAI,CAAClG,QAAQ,EAAE,GAAG,IAAI,CAACD,SAAS;KAC1E,IAAI,CAAClC,IAAI,CAAC6H,SAAS,GAAGM,KAAK;KAC3B,IAAI,CAAC5H,QAAQ,CAAC,KAAK,EAAEE,cAAc,CAAC;;;;CAItC;CACA;CACA;GACC0B,QAAQ,GACR;KACC,IAAI,IAAI,CAACnC,IAAI,CAACsI,aAAa,CAAC,0BAA0B,CAAC,KAAK,IAAI,EAChE;OACC,MAAMtI,IAAI,GAAG,IAAI,CAACA,IAAI,CAACuI,SAAS,CAAC,IAAI,CAAC;OACtC,IAAI,CAACC,YAAY,CAACxI,IAAI,CAAC;OAEvB,OAAOjB,kBAAkB,CAACiB,IAAI,CAAC6H,SAAS,CAAC;;KAG1C,OAAO9I,kBAAkB,CAAC,IAAI,CAACiB,IAAI,CAAC6H,SAAS,CAAC;;;;CAIhD;CACA;CACA;GACCjB,QAAQ,GACR;KACC,OAAOhI,QAAQ,CAAC6J,SAAS,CAAC/G,IAAI,CAAC,IAAI,CAAC1B,IAAI,CAAC6F,QAAQ,CAAC;;;;CAIpD;CACA;CACA;GACCzD,OAAO,CAAClB,KAAK,EACb;KACC,IAAIwH,WAAW,GAAG,KAAK;KACvB,IAAI,IAAI,CAACtJ,WAAW,IAAI8B,KAAK,EAC7B;OACC,IAAI,CAAC9B,WAAW,CAACY,IAAI,CAAC0E,gBAAgB,CAAC,0BAA0B,CAAC,CAChEC,OAAO,CAAEC,KAAK,IAAK;SACnB,IAAIA,KAAK,CAAC+D,QAAQ,CAACzH,KAAK,CAACsB,UAAU,CAAC,EACpC;WACCkG,WAAW,GAAG,IAAI;;QAEnB,CAAC;;KAGJ,OAAOA,WAAW;;;;CAIpB;CACA;GACC5D,eAAe,CAACF,KAAK,EACrB;KACCA,KAAK,CAACF,gBAAgB,CAAC,IAAI,CAAC,CAACC,OAAO,CAAEiE,KAAK,IAAK;OAC/CA,KAAK,CAACC,MAAM,EAAE;MACd,CAAC;KACFjE,KAAK,CAACxE,YAAY,CAAC,eAAe,EAAE,MAAM,CAAC;KAC3C,IAAI,CAAChB,WAAW,CAACmB,QAAQ,CAAC,IAAI,CAAC;;GAGhC8F,eAAe,CAACnF,KAAK,EACrB;KACC,MAAMiE,OAAO,GAAG,EAAE;KAClB,IAAI2D,aAAa,GAAG,EAAE;KACtB,IAAIC,KAAK,GAAG,EAAE;KACd,MAAMC,YAAY,GAAG,IAAI,CAACC,eAAe,EAAE;KAC3C,MAAMC,iBAAiB,GAAG,CAACF,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,EAAEA,YAAY,CAAC,CAAC,CAAC,CAAC;KAC9F,MAAMhJ,IAAI,GAAG,IAAI,CAACZ,WAAW,CAACY,IAAI;KAClC,IAAI4E,KAAK,GAAG,IAAI;KAChB,IAAIuE,MAAM,GAAG,KAAK;KAClB,IAAIC,cAAc,GAAG,KAAK;KAC1B,IAAIC,cAAc,GAAG,KAAK;KAC1B,IAAIC,gBAAgB,GAAG,IAAI;KAC3B,IACC7K,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,eAAe,CAAC,IAC/C/D,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,uBAAuB,CAAC,EAE9D;OACC8G,gBAAgB,GAAG,KAAK;;KAGzB,IAAI7K,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,uBAAuB,CAAC,EAC9D;OACC4G,cAAc,GAAG,IAAI;;KAGtB,IAAI3K,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,uBAAuB,CAAC,EAC9D;OACC6G,cAAc,GAAG,IAAI;;KAEtB,IAAIE,WAAW,GAAG,EAAE;KACpB,MAAMC,aAAa,GAAGxJ,IAAI,CAAC0E,gBAAgB,CAAC,gBAAgB,CAAC;KAC7D,IAAI8E,aAAa,CAACjD,MAAM,GAAG,CAAC,EAC5B;OACCiD,aAAa,CAAC7E,OAAO,CAAE8E,SAAS,IAAK;SACpC,IAAIA,SAAS,CAACd,QAAQ,CAACzH,KAAK,CAACsB,UAAU,CAAC,EACxC;WACCoC,KAAK,GAAG6E,SAAS;WAEjB,OAAO,IAAI;;SAGZ,OAAO,KAAK;QACZ,CAAC;;KAEH,IAAIC,aAAa;KAEjBV,YAAY,CAACrE,OAAO,CAAEgF,WAAW,IAAK;OACrCA,WAAW,CAACxK,OAAO,CAACqD,UAAU,GAAGtB,KAAK,CAACsB,UAAU;OACjDmH,WAAW,CAACxK,OAAO,CAACa,IAAI,GAAGA,IAAI;OAC/B2J,WAAW,CAACxK,OAAO,CAACyF,KAAK,GAAGA,KAAK;MACjC,CAAC;KAEF,IAAInG,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,uBAAuB,CAAC,EAC9D;OACCuG,KAAK,GAAG7H,KAAK,CAACsB,UAAU,CAACoH,UAAU,CAACC,QAAQ;OAC5Cd,KAAK,GAAG,CAAC,GAAGA,KAAK,CAAC;OAClBD,aAAa,GAAG,IAAI,CAACgB,kBAAkB,CAAClF,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;OAC/FkE,aAAa,CAACnE,OAAO,CAAEoF,YAAY,IAAK;SACvCf,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAACyG,MAAM,GAAG,KAAK;SACjDoD,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAAC4J,KAAK,GAAGA,KAAK;SAChD5D,OAAO,CAAClE,IAAI,CAAC+H,YAAY,CAACe,YAAY,CAAC,CAAC;QACxC,CAAC;;KAGH,IAAItL,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,CAACoH,UAAU,EAAE,uBAAuB,CAAC,EACzE;OACC,MAAMI,UAAU,GAAG9I,KAAK,CAACsB,UAAU,CAACsD,aAAa,CAACA,aAAa,CAACkE,UAAU;OAC1E,MAAMC,eAAe,GAAG,CAAC,GAAGD,UAAU,CAAC;OACvC,MAAME,sBAAsB,GAAG,EAAE;OACjCD,eAAe,CAACtF,OAAO,CAAEwF,SAAS,IAAK;SACtC,IAAIA,SAAS,CAACC,QAAQ,KAAK,CAAC,EAC5B;WACCF,sBAAsB,CAACjJ,IAAI,CAACkJ,SAAS,CAAC;;QAEvC,CAAC;OACF,MAAME,cAAc,GAAGH,sBAAsB,CAACI,OAAO,CAACpJ,KAAK,CAACsB,UAAU,CAACsD,aAAa,CAAC;OACrF,MAAMyE,IAAI,GAAGrJ,KAAK,CAACsB,UAAU,CAACsD,aAAa,CAACA,aAAa,CAACA,aAAa,CAACkE,UAAU;OAClFO,IAAI,CAAC5F,OAAO,CAAE6F,GAAG,IAAK;SACrB,IAAIA,GAAG,CAACJ,QAAQ,KAAK,CAAC,EACtB;WACC,MAAMK,eAAe,GAAG,EAAE;WAC1BD,GAAG,CAACR,UAAU,CAACrF,OAAO,CAAE+F,YAAY,IAAK;aACxC,IAAIA,YAAY,CAACN,QAAQ,KAAK,CAAC,EAC/B;eACCK,eAAe,CAACxJ,IAAI,CAACyJ,YAAY,CAAC;;YAEnC,CAAC;WACF,IAAID,eAAe,CAACJ,cAAc,CAAC,EACnC;aACCtB,KAAK,CAAC9H,IAAI,CAACwJ,eAAe,CAACJ,cAAc,CAAC,CAAC;;;QAG7C,CAAC;OACFvB,aAAa,GAAG,IAAI,CAAC6B,kBAAkB,CAAC/F,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;OAC/FkE,aAAa,CAACnE,OAAO,CAAEoF,YAAY,IAAK;SACvCf,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAACyG,MAAM,GAAG,KAAK;SACjDoD,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAAC4J,KAAK,GAAGA,KAAK;SAChD5D,OAAO,CAAClE,IAAI,CAAC+H,YAAY,CAACe,YAAY,CAAC,CAAC;QACxC,CAAC;;KAGH,IAAItL,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,6BAA6B,CAAC,EACpE;OACC,IAAI/D,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,sCAAsC,CAAC,EAC7E;SACCkH,aAAa,GAAG,IAAI;SACpB,MAAMa,IAAI,GAAGrJ,KAAK,CAACsB,UAAU,CAACsD,aAAa,CAACA,aAAa,CAACkE,UAAU;SACpEO,IAAI,CAAC5F,OAAO,CAAE6F,GAAG,IAAK;WACrBA,GAAG,CAACR,UAAU,CAACrF,OAAO,CAAEiG,EAAE,IAAK;aAC9B7B,KAAK,CAAC9H,IAAI,CAAC2J,EAAE,CAAC;YACd,CAAC;UACF,CAAC;SACF9B,aAAa,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;SAC5CA,aAAa,CAACnE,OAAO,CAAEoF,YAAY,IAAK;WACvCf,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAACyG,MAAM,GAAG,OAAO;WACnDoD,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAAC4J,KAAK,GAAGA,KAAK;WAChD5D,OAAO,CAAClE,IAAI,CAAC+H,YAAY,CAACe,YAAY,CAAC,CAAC;UACxC,CAAC;QACF,MAED;SACCL,aAAa,GAAG,KAAK;SACrBjL,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;;;KAItD,IACCxE,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAAC1B,KAAK,CAACsB,UAAU,EAAE,kBAAkB,CAAC,IAClDtB,KAAK,CAACsB,UAAU,CAACqI,OAAO,CAAC,mBAAmB,CAAC,KAAK,IAAI,EAE1D;OACC9B,KAAK,CAAC9H,IAAI,CAACC,KAAK,CAACsB,UAAU,CAAC;OAC5BsG,aAAa,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;OAC5BA,aAAa,CAACnE,OAAO,CAAEoF,YAAY,IAAK;SACvCf,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAACyG,MAAM,GAAG,MAAM;SAClDoD,YAAY,CAACe,YAAY,CAAC,CAAC5K,OAAO,CAAC4J,KAAK,GAAGA,KAAK;SAChDC,YAAY,CAACe,YAAY,CAAC,CAACe,WAAW,GAAG,eAAe;SACxD3F,OAAO,CAAClE,IAAI,CAAC+H,YAAY,CAACe,YAAY,CAAC,CAAC;QACxC,CAAC;OACFZ,MAAM,GAAG,IAAI;OACbI,WAAW,GAAG,CAAC,aAAa,EAAE,eAAe,EAAE,cAAc,EAAE,aAAa,EAAE,aAAa,EAAE,YAAY,CAAC;;KAG3G,IAAIwB,mBAAmB,GAAG,IAAI;KAC9B,MAAMC,sBAAsB,GAAG,EAAE;KACjCjC,KAAK,CAACpE,OAAO,CAAEiG,EAAE,IAAK;OACrB,IAAIA,EAAE,CAACR,QAAQ,KAAK,CAAC,EACrB;SACCW,mBAAmB,GAAGE,SAAS;SAE/B,IAAIxM,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAACgI,EAAE,EAAE,WAAW,CAAC,EACpC;WACCG,mBAAmB,GAAG,WAAW;;SAGlC,IAAItM,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAACgI,EAAE,EAAE,aAAa,CAAC,EACtC;WACCG,mBAAmB,GAAG,aAAa;;SAGpC,IAAItM,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAACgI,EAAE,EAAE,YAAY,CAAC,EACrC;WACCG,mBAAmB,GAAG,YAAY;;SAGnC,IAAItM,EAAE,CAACkE,GAAG,CAACC,QAAQ,CAACgI,EAAE,EAAE,cAAc,CAAC,EACvC;WACCG,mBAAmB,GAAG,cAAc;;SAErCC,sBAAsB,CAAC/J,IAAI,CAAC8J,mBAAmB,CAAC;;MAEjD,CAAC;KACF,IAAIG,KAAK,GAAG,CAAC;KACb,IAAIC,WAAW,GAAG,IAAI;KACtB,OAAOD,KAAK,GAAGF,sBAAsB,CAACzE,MAAM,IAAI4E,WAAW,EAC3D;OACC,IAAID,KAAK,GAAG,CAAC,IAAIF,sBAAsB,CAACE,KAAK,CAAC,KAAKF,sBAAsB,CAACE,KAAK,GAAG,CAAC,CAAC,EACpF;SACCC,WAAW,GAAG,KAAK;;OAEpBD,KAAK,EAAE;;KAGRH,mBAAmB,GAAGI,WAAW,GAAGH,sBAAsB,CAAC,CAAC,CAAC,GAAGC,SAAS;KACzE,IAAIF,mBAAmB,EACvB;OACC7B,iBAAiB,CAACvE,OAAO,CAAEyG,gBAAgB,IAAK;SAC/C,IAAIA,gBAAgB,CAACC,EAAE,KAAKN,mBAAmB,EAC/C;WACCtM,EAAE,CAACkE,GAAG,CAACE,QAAQ,CAACuI,gBAAgB,CAACE,MAAM,EAAE,mBAAmB,CAAC;;QAE9D,CAAC;;KAGH,IAAInG,OAAO,CAAC,CAAC,CAAC,IAAIA,OAAO,CAAC,CAAC,CAAC,IAAIA,OAAO,CAAC,CAAC,CAAC,IAAIA,OAAO,CAAC,CAAC,CAAC,EACxD;OACCA,OAAO,CAAC,CAAC,CAAC,CAAChG,OAAO,CAACoM,YAAY,GAAGrC,iBAAiB;OACnD/D,OAAO,CAAC,CAAC,CAAC,CAAChG,OAAO,CAACoM,YAAY,GAAGrC,iBAAiB;OACnD/D,OAAO,CAAC,CAAC,CAAC,CAAChG,OAAO,CAACoM,YAAY,GAAGrC,iBAAiB;OACnD/D,OAAO,CAAC,CAAC,CAAC,CAAChG,OAAO,CAACoM,YAAY,GAAGrC,iBAAiB;;KAGpD,IAAI,CAAC,IAAI,CAAC/E,QAAQ,CAACY,QAAQ,EAC3B;OACC,IAAIuE,gBAAgB,EACpB;SACC,IAAI,CAACF,cAAc,IAAI,CAACC,cAAc,IAAIzE,KAAK,EAC/C;WACC,IAAIuE,MAAM,EACV;aACC1K,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACoE,IAAI,CAACN,KAAK,CAACgF,UAAU,EAAE,IAAI,EAAEzE,OAAO,EAAE,IAAI,EAAEoE,WAAW,CAAC;YACtG,MACI,IAAIG,aAAa,KAAK,KAAK,EAChC;aACCjL,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;YACpD,MAED;aACCxE,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACoE,IAAI,CAACN,KAAK,CAACgF,UAAU,EAAE,IAAI,EAAEzE,OAAO,EAAE,IAAI,CAAC;;;QAG3F,MAED;SACC1G,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACC,KAAK,CAACC,WAAW,CAACC,WAAW,EAAE,CAACmC,IAAI,EAAE;;;;;;CAMxD;CACA;CACA;GACC4D,kBAAkB,GAClB;KACC,IAAI,CAAC,IAAI,CAACqB,eAAe,EACzB;OACC,IAAI,CAACA,eAAe,GAAG,IAAIzJ,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACsE,SAAS,CAAC,WAAW,EAAE;SACtEpE,IAAI,EAAG,uCAAsC,IAAI,CAACpH,IAAI,CAAC6F,QAAQ,CAAC4F,WAAW,EAAG,WAAU;SACxFpE,KAAK,EAAE;WAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,2CAA2C;UAAG;SACxFC,QAAQ,EAAE,IAAI,CAACwG,WAAW,CAACvH,IAAI,CAAC,IAAI;QACpC,CAAC;;KAGH,IAAI,CAAC0I,eAAe,CAAC4C,WAAW,GAAG,QAAQ;KAE3C,IAAI,CAAC5C,eAAe,CAACwD,YAAY,CAAC,IAAI,CAAC1L,IAAI,CAAC6F,QAAQ,CAAC;KAErD,OAAO,IAAI,CAACqC,eAAe;;GAG5Be,eAAe,GACf;KACC,IAAI,CAAC9D,OAAO,GAAG,EAAE;KACjB,IAAI,CAACA,OAAO,CAAClE,IAAI,CAChB,IAAIxC,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACyE,UAAU,CAClC,WAAW,EACX;OACCvE,IAAI,EAAE,mDAAmD;OACzDC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,2CAA2C;;MACrF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACyE,UAAU,CAClC,aAAa,EACb;OACCvE,IAAI,EAAE,qDAAqD;OAC3DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,6CAA6C;;MACvF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACyE,UAAU,CAClC,YAAY,EACZ;OACCvE,IAAI,EAAE,oDAAoD;OAC1DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,4CAA4C;;MACtF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAACyE,UAAU,CAClC,cAAc,EACd;OACCvE,IAAI,EAAE,sDAAsD;OAC5DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,8CAA8C;;MACxF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC0E,gBAAgB,CACxC,gBAAgB,EAChB;OACC9H,IAAI,EAAErF,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC;OAC/D+G,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,sCAAsC;;MAChF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC0E,gBAAgB,CACxC,cAAc,EACd;OACCxE,IAAI,EAAE,mDAAmD;OACzDC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,8CAA8C;;MACxF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC2E,kBAAkB,CAC1C,WAAW,EACX;OACCzE,IAAI,EAAE,qDAAqD;OAC3DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,iDAAiD;;MAC3F,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC2E,kBAAkB,CAC1C,WAAW,EACX;OACCzE,IAAI,EAAE,qDAAqD;OAC3DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,iDAAiD;;MAC3F,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC4E,UAAU,CAClC,YAAY,EACZ;OACC1E,IAAI,EAAG;QACJ3I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,4CAA4C,CAAE;;MAE1E;OACD+G,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,4CAA4C;;MACtF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC6E,SAAS,CACjC,WAAW,EACX;OACCjI,IAAI,EAAErF,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;OAC5E+G,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,2CAA2C;;MACrF,EACD,IAAI,CAAClB,WAAW,CAChB,EACD,IAAIX,EAAE,CAACC,OAAO,CAACiC,EAAE,CAACuG,MAAM,CAAC8E,WAAW,CACnC,aAAa,EACb;OACC5E,IAAI,EAAE,qDAAqD;OAC3DC,KAAK,EAAE;SAAEC,KAAK,EAAE7I,EAAE,CAACC,OAAO,CAAC2B,GAAG,CAACC,UAAU,CAAC,6CAA6C;;MACvF,EACD,IAAI,CAAClB,WAAW,CAChB,CACD;KAED,OAAO,IAAI,CAAC+F,OAAO;;;;CAIrB;CACA;CACA;CACA;GACC4B,WAAW,CAACoB,KAAK,EAAE1H,cAAc,EACjC;KACC,IAAI,CAACT,IAAI,GAAGlB,aAAa,CAAC,IAAI,CAACkB,IAAI,EAAEmI,KAAK,CAAC;KAE3C,IAAI,CAACpI,UAAU,CAAC,IAAI,CAACC,IAAI,CAAC;KAE1B,IAAI,CAAC,IAAI,CAAC0H,QAAQ,EAAE,CAAC1E,UAAU,EAAE,IAAI,CAACvC,cAAc,EACpD;OACC,IAAI,CAACyC,WAAW,EAAE;OAClB,IAAI,CAACuB,UAAU,EAAE;;KAGlB,MAAMwH,IAAI,GAAG,EAAE;KACfA,IAAI,CAAC,IAAI,CAACjE,QAAQ,CAAC,GAAGG,KAAK;KAE3B,IAAI,CAAC1H,cAAc,EACnB;OACC,IAAI,CAACyL,oBAAoB,CAACD,IAAI,CAAC,CAC7BE,IAAI,CAAC,MAAM;SACX1N,EAAE,CAACC,OAAO,CAACsC,OAAO,CAACF,WAAW,EAAE,CAACG,IAAI,EAAE;QACvC,CAAC,CACDmL,KAAK,CAAC,MAAM,EAAE,CAAC;;;GAInBzB,kBAAkB,CAAC/F,KAAK,EACxB;KACC,OAAOA,KAAK,CAACF,gBAAgB,CAAC,wBAAwB,CAAC,CAAC6B,MAAM;;GAG/DuD,kBAAkB,CAAClF,KAAK,EACxB;KACC,OAAOA,KAAK,CAACF,gBAAgB,CAAC,wBAAwB,CAAC,CAAC6B,MAAM;;GAG/DiC,YAAY,CAACxI,IAAI,EACjB;KACC,MAAMqM,mBAAmB,GAAG,CAC3B,oBAAoB,EACpB,sCAAsC,EACtC,6BAA6B,EAC7B,4BAA4B,EAC5B,2BAA2B,EAC3B,gCAAgC,EAChC,+BAA+B,EAC/B,6BAA6B,EAC7B,gCAAgC,EAChC,6BAA6B,EAC7B,4BAA4B,EAC5B,2BAA2B,EAC3B,0BAA0B,EAC1B,2BAA2B,CAC3B;KACDA,mBAAmB,CAAC1H,OAAO,CAAE2H,SAAS,IAAK;OAC1CtM,IAAI,CAAC0E,gBAAgB,CAAE,IAAG4H,SAAU,EAAC,CAAC,CAAC3H,OAAO,CAAE4H,OAAO,IAAK;SAC3D9N,EAAE,CAACkE,GAAG,CAACG,WAAW,CAACyJ,OAAO,EAAED,SAAS,CAAC;QACtC,CAAC;MACF,CAAC;KAEF,OAAOtM,IAAI;;GAGZoB,eAAe,CAACF,KAAK,EACrB;KACC,MAAMsL,SAAS,GAAG5K,MAAM,CAACsE,YAAY,EAAE;KACvC,MAAMuG,QAAQ,GAAGD,SAAS,CAACE,UAAU,CAAC,CAAC,CAAC,CAACC,WAAW;KACpD,IAAIF,QAAQ,KAAK,CAAC,EAClB;OACC,IAAIG,SAAS,GAAGJ,SAAS,CAACI,SAAS;OACnC,IAAI,CAACnO,EAAE,CAACoO,IAAI,CAACC,KAAK,CAACF,SAAS,CAAC,IAAIA,SAAS,CAACxC,QAAQ,KAAK,CAAC,EACzD;SACC,IAAIwC,SAAS,CAACG,UAAU,CAAC3C,QAAQ,KAAK,CAAC,IAAIwC,SAAS,CAACG,UAAU,CAACA,UAAU,CAAC3C,QAAQ,KAAK,CAAC,EACzF;WACCwC,SAAS,GAAGA,SAAS,CAACG,UAAU,CAACA,UAAU;UAC3C,MACI,IAAIH,SAAS,CAACG,UAAU,CAAC3C,QAAQ,KAAK,CAAC,EAC5C;WACCwC,SAAS,GAAG,IAAI;UAChB,MAED;WACCA,SAAS,GAAGA,SAAS,CAACG,UAAU;;;OAIlC,IAAIH,SAAS,EACb;SACC,MAAMI,eAAe,GAAGJ,SAAS,CAAChD,UAAU;SAC5C,MAAMqD,eAAe,GAAG,IAAIC,GAAG,CAAC,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;SACrD,IAAIF,eAAe,IAAIC,eAAe,CAACE,GAAG,CAACH,eAAe,CAACnH,QAAQ,CAAC,EACpE;WACC,MAAMuH,kBAAkB,GAAGlN,QAAQ,CAACmN,aAAa,CAAC,KAAK,CAAC;WACxDD,kBAAkB,CAACE,MAAM,CAACV,SAAS,CAAC;WACpCI,eAAe,CAACM,MAAM,CAACF,kBAAkB,CAAC;;SAE3C,IAAIG,WAAW,GAAGX,SAAS,CAAChD,UAAU,CAACA,UAAU;SACjD,OAAO2D,WAAW,IAAI,CAACN,eAAe,CAACE,GAAG,CAACI,WAAW,CAAC1H,QAAQ,CAAC,EAChE;WACC0H,WAAW,GAAGA,WAAW,CAAC3D,UAAU;;SAGrC,IAAI2D,WAAW,IAAIA,WAAW,CAACvD,UAAU,CAACzD,MAAM,KAAK,CAAC,EACtD;WACCgH,WAAW,CAACC,KAAK,CAACZ,SAAS,CAAChD,UAAU,CAAC;WACvC2D,WAAW,CAAC1E,MAAM,EAAE;WAEpB3H,KAAK,CAACiC,cAAc,EAAE;;;;;GAM1BM,YAAY,CAACK,IAAI,EACjB;KACC,MAAM2J,GAAG,GAAG,qFAAqF;KAEjG,OAAOC,OAAO,CAACD,GAAG,CAAC/L,IAAI,CAACoC,IAAI,CAAC,CAAC;;GAG/BJ,aAAa,CAACI,IAAI,EAClB;KACC,OAAQ,qCAAoCA,IAAK,sBAAqBA,IAAK,OAAM;;CAEnF;;;;;;;;"}