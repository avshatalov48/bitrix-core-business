{"version":3,"file":"copilot-list.bundle.js","sources":["../src/components/message-text.js","../src/components/copilot-item.js","../src/classes/copilot-service.js","../src/classes/context-menu-manager.js","../src/copilot-list.js"],"sourcesContent":["import { Core } from 'im.v2.application.core';\nimport { Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Parser } from 'im.v2.lib.parser';\nimport { AvatarSize, MessageAvatar } from 'im.v2.component.elements';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelUser, ImModelChat, ImModelRecentItem, ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const MessageText = {\n\tname: 'MessageText',\n\tcomponents: { MessageAvatar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['recent/getMessage'](this.recentItem.dialogId);\n\t\t},\n\t\tshowLastMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showLastMessage);\n\t\t},\n\t\thiddenMessageText(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_LIST_RECENT_CHAT_TYPE_GROUP_V2');\n\t\t},\n\t\tisLastMessageAuthor(): boolean\n\t\t{\n\t\t\tif (!this.message)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.message.authorId === Core.getUserId();\n\t\t},\n\t\tlastMessageAuthorAvatar(): string\n\t\t{\n\t\t\tconst authorDialog = this.$store.getters['chats/get'](this.message.authorId);\n\n\t\t\tif (!authorDialog)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn authorDialog.avatar;\n\t\t},\n\t\tlastMessageAuthorAvatarStyle(): Object\n\t\t{\n\t\t\treturn { backgroundImage: `url('${this.lastMessageAuthorAvatar}')` };\n\t\t},\n\t\tmessageText(): string\n\t\t{\n\t\t\tconst formattedText = Parser.purifyRecent(this.recentItem);\n\t\t\tif (!formattedText)\n\t\t\t{\n\t\t\t\treturn this.hiddenMessageText;\n\t\t\t}\n\n\t\t\treturn formattedText;\n\t\t},\n\t\tformattedMessageText(): string\n\t\t{\n\t\t\tconst SPLIT_INDEX = 27;\n\n\t\t\treturn Utils.text.insertUnseenWhitespace(this.messageText, SPLIT_INDEX);\n\t\t},\n\t\tpreparedDraftContent(): string\n\t\t{\n\t\t\tconst phrase = this.loc('IM_LIST_RECENT_MESSAGE_DRAFT_2');\n\t\t\tconst PLACEHOLDER_LENGTH = '#TEXT#'.length;\n\t\t\tconst prefix = phrase.slice(0, -PLACEHOLDER_LENGTH);\n\n\t\t\treturn `\n\t\t\t\t<span class=\"bx-im-list-copilot-item__message_draft-prefix\">${prefix}</span>\n\t\t\t\t<span class=\"bx-im-list-copilot-item__message_text_content\">${this.formattedDraftText}</span>\n\t\t\t`;\n\t\t},\n\t\tformattedDraftText(): string\n\t\t{\n\t\t\treturn Parser.purify({ text: this.recentItem.draft.text, showIconIfEmptyText: false });\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-copilot-item__message_container\">\n\t\t\t<span class=\"bx-im-list-copilot-item__message_text\">\n\t\t\t\t<span v-if=\"recentItem.draft.text && dialog.counter === 0\" v-html=\"preparedDraftContent\"></span>\n\t\t\t\t<span v-else-if=\"!showLastMessage\">{{ hiddenMessageText }}</span>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<span v-if=\"isLastMessageAuthor\" class=\"bx-im-list-copilot-item__message_author-icon --self\"></span>\n\t\t\t\t\t<span v-else-if=\"message.authorId\" class=\"bx-im-list-copilot-item__message_author-icon --user\">\n\t\t\t\t\t\t<MessageAvatar \n\t\t\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t\t\t:authorId=\"message.authorId\"\n\t\t\t\t\t\t\t:size=\"AvatarSize.XXS\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"bx-im-list-copilot-item__message_text_content\">{{ formattedMessageText }}</span>\n\t\t\t\t</template>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import 'main.date';\n\nimport { Core } from 'im.v2.application.core';\nimport { Settings, Layout } from 'im.v2.const';\nimport { ChatAvatar, AvatarSize, ChatTitle } from 'im.v2.component.elements';\n\nimport { MessageText } from './message-text';\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport '../css/copilot-item.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelRecentItem, ImModelChat, ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const CopilotItem = {\n\tname: 'CopilotItem',\n\tcomponents: { ChatAvatar, ChatTitle, MessageText },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\trecentItem(): ImModelRecentItem\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\treturn this.formatDate(this.message.date);\n\t\t},\n\t\tformattedCounter(): string\n\t\t{\n\t\t\treturn this.dialog.counter > 99 ? '99+' : this.dialog.counter.toString();\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.recentItem.dialogId, true);\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['recent/getMessage'](this.recentItem.dialogId);\n\t\t},\n\t\tlayout(): { name: string, entityId: string }\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tisChatSelected(): boolean\n\t\t{\n\t\t\tif (this.layout.name !== Layout.copilot.name)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.layout.entityId === this.recentItem.dialogId;\n\t\t},\n\t\tisChatMuted(): boolean\n\t\t{\n\t\t\tconst isMuted = this.dialog.muteList.find((element) => {\n\t\t\t\treturn element === Core.getUserId();\n\t\t\t});\n\n\t\t\treturn Boolean(isMuted);\n\t\t},\n\t\tisSomeoneTyping(): boolean\n\t\t{\n\t\t\treturn this.dialog.writingList.length > 0;\n\t\t},\n\t\tshowLastMessage(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.recent.showLastMessage);\n\t\t},\n\t\tshowPinnedIcon(): boolean\n\t\t{\n\t\t\treturn this.recentItem.pinned && this.dialog.counter === 0 && !this.recentItem.unread;\n\t\t},\n\t\tshowCounter(): boolean\n\t\t{\n\t\t\treturn this.dialog.counter > 0;\n\t\t},\n\t\twrapClasses(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--pinned': this.recentItem.pinned,\n\t\t\t\t'--selected': this.isChatSelected,\n\t\t\t};\n\t\t},\n\t\titemClasses(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--no-text': !this.showLastMessage,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tformatDate(date): string\n\t\t{\n\t\t\treturn DateFormatter.formatByTemplate(date, DateTemplate.recent);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :data-id=\"recentItem.dialogId\" :class=\"wrapClasses\" class=\"bx-im-list-copilot-item__wrap\">\n\t\t\t<div :class=\"itemClasses\" class=\"bx-im-list-copilot-item__container\">\n\t\t\t\t<div class=\"bx-im-list-copilot-item__avatar_container\">\n\t\t\t\t\t<div class=\"bx-im-list-copilot-item__avatar_content\">\n\t\t\t\t\t\t<ChatAvatar\n\t\t\t\t\t\t\t:avatarDialogId=\"recentItem.dialogId\"\n\t\t\t\t\t\t\t:contextDialogId=\"recentItem.dialogId\"\n\t\t\t\t\t\t\t:withSpecialTypes=\"false\"\n\t\t\t\t\t\t\t:size=\"AvatarSize.XL\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div v-if=\"isSomeoneTyping\" class=\"bx-im-list-copilot-item__avatar_typing\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-list-copilot-item__content_container\">\n\t\t\t\t\t<div class=\"bx-im-list-copilot-item__content_header\">\n\t\t\t\t\t\t<ChatTitle :dialogId=\"recentItem.dialogId\" :withMute=\"true\" />\n\t\t\t\t\t\t<div class=\"bx-im-list-copilot-item__date\">\n\t\t\t\t\t\t\t<span>{{ formattedDate }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-list-copilot-item__content_bottom\">\n\t\t\t\t\t\t<MessageText :item=\"recentItem\" />\n\t\t\t\t\t\t<div :class=\"{'--extended': dialog.counter > 99}\" class=\"bx-im-list-copilot-item__counter_wrap\">\n\t\t\t\t\t\t\t<div class=\"bx-im-list-copilot-item__counter_container\">\n\t\t\t\t\t\t\t\t<div v-if=\"showPinnedIcon\" class=\"bx-im-list-copilot-item__pinned-icon\"></div>\n\t\t\t\t\t\t\t\t<div v-else-if=\"showCounter\" :class=\"{'--muted': isChatMuted}\" class=\"bx-im-list-copilot-item__counter_number\">\n\t\t\t\t\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { RestMethod } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { RecentService } from 'im.v2.provider.service';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelRecentItem } from 'im.v2.model';\n\nexport class CopilotRecentService extends RecentService\n{\n\tgetQueryParams(firstPage: boolean): JsonObject\n\t{\n\t\treturn {\n\t\t\tONLY_COPILOT: 'Y',\n\t\t\tLIMIT: this.itemsPerPage,\n\t\t\tLAST_MESSAGE_DATE: firstPage ? null : this.lastMessageDate,\n\t\t\tGET_ORIGINAL_TEXT: 'Y',\n\t\t\tPARSE_TEXT: 'Y',\n\t\t};\n\t}\n\n\tgetModelSaveMethod(): string\n\t{\n\t\treturn 'recent/setCopilot';\n\t}\n\n\tgetCollection(): ImModelRecentItem[]\n\t{\n\t\treturn Core.getStore().getters['recent/getCopilotCollection'];\n\t}\n\n\tgetExtractorOptions(): { withBirthdays?: boolean }\n\t{\n\t\treturn { withBirthdays: false };\n\t}\n\n\thideChat(dialogId)\n\t{\n\t\tLogger.warn('Im.CopilotRecentList: hide chat', dialogId);\n\t\tconst recentItem = Core.getStore().getters['recent/get'](dialogId);\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tCore.getStore().dispatch('recent/delete', {\n\t\t\tid: dialogId,\n\t\t});\n\n\t\tconst chatIsOpened = Core.getStore().getters['application/isChatOpen'](dialogId);\n\t\tif (chatIsOpened)\n\t\t{\n\t\t\tMessenger.openCopilot();\n\t\t}\n\n\t\tCore.getRestClient().callMethod(RestMethod.imRecentHide, { DIALOG_ID: dialogId }).catch((error) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error('Im.CopilotRecentList: hide chat error', error);\n\t\t});\n\t}\n}\n","import { Loc } from 'main.core';\n\nimport { Messenger } from 'im.public';\nimport { RecentMenu, type MenuItem } from 'im.v2.lib.menu';\n\nimport { CopilotRecentService } from './copilot-service';\n\nexport class CopilotRecentMenu extends RecentMenu\n{\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetOpenItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_OPEN'),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.openCopilot(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetHideItem(): MenuItem\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_LIB_MENU_HIDE_MSGVER_1'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.getRecentService().hideChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetRecentService(): CopilotRecentService\n\t{\n\t\tif (!this.service)\n\t\t{\n\t\t\tthis.service = new CopilotRecentService();\n\t\t}\n\n\t\treturn this.service;\n\t}\n}\n","import { CopilotDraftManager } from 'im.v2.lib.draft';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ListLoadingState as LoadingState } from 'im.v2.component.elements';\n\nimport { CopilotItem } from './components/copilot-item';\nimport { CopilotRecentService } from './classes/copilot-service';\nimport { CopilotRecentMenu } from './classes/context-menu-manager';\n\nimport './css/copilot-list.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelRecentItem } from 'im.v2.model';\n\n// @vue/component\nexport const CopilotList = {\n\tname: 'CopilotList',\n\tcomponents: { CopilotItem, LoadingState },\n\temits: ['chatClick'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tisLoadingNextPage: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tcollection(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.getRecentService().getCollection();\n\t\t},\n\t\tsortedItems(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn [...this.collection].sort((a, b) => {\n\t\t\t\tconst firstDate = this.$store.getters['recent/getSortDate'](a.dialogId);\n\t\t\t\tconst secondDate = this.$store.getters['recent/getSortDate'](b.dialogId);\n\n\t\t\t\treturn secondDate - firstDate;\n\t\t\t});\n\t\t},\n\t\tpinnedItems(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.sortedItems.filter((item) => {\n\t\t\t\treturn item.pinned === true;\n\t\t\t});\n\t\t},\n\t\tgeneralItems(): ImModelRecentItem[]\n\t\t{\n\t\t\treturn this.sortedItems.filter((item) => {\n\t\t\t\treturn item.pinned === false;\n\t\t\t});\n\t\t},\n\t\tisEmptyCollection(): boolean\n\t\t{\n\t\t\treturn this.collection.length === 0;\n\t\t},\n\t},\n\tasync created()\n\t{\n\t\tthis.contextMenuManager = new CopilotRecentMenu();\n\n\t\tthis.isLoading = true;\n\t\tawait this.getRecentService().loadFirstPage();\n\t\tthis.isLoading = false;\n\t\tvoid CopilotDraftManager.getInstance().initDraftHistory();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenuManager.destroy();\n\t},\n\tmethods:\n\t{\n\t\tasync onScroll(event: Event)\n\t\t{\n\t\t\tthis.contextMenuManager.close();\n\t\t\tif (!Utils.dom.isOneScreenRemaining(event.target) || !this.getRecentService().hasMoreItemsToLoad)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoadingNextPage = true;\n\t\t\tawait this.getRecentService().loadNextPage();\n\t\t\tthis.isLoadingNextPage = false;\n\t\t},\n\t\tonClick(item, event)\n\t\t{\n\t\t\tthis.$emit('chatClick', item.dialogId);\n\t\t},\n\t\tonRightClick(item, event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.contextMenuManager.openMenu(item, event.currentTarget);\n\t\t},\n\t\tgetRecentService(): CopilotRecentService\n\t\t{\n\t\t\tif (!this.service)\n\t\t\t{\n\t\t\t\tthis.service = new CopilotRecentService();\n\t\t\t}\n\n\t\t\treturn this.service;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-list-copilot__scope bx-im-list-copilot__container\">\n\t\t\t<LoadingState v-if=\"isLoading && isEmptyCollection\" />\n\t\t\t<div v-else @scroll=\"onScroll\" class=\"bx-im-list-copilot__scroll-container\">\n\t\t\t\t<div v-if=\"isEmptyCollection\" class=\"bx-im-list-copilot__empty\">\n\t\t\t\t\t<div class=\"bx-im-list-copilot__empty_icon\"></div>\n\t\t\t\t\t<div class=\"bx-im-list-copilot__empty_text\">{{ loc('IM_LIST_COPILOT_EMPTY') }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"pinnedItems.length > 0\" class=\"bx-im-list-copilot__pinned_container\">\n\t\t\t\t\t<CopilotItem\n\t\t\t\t\t\tv-for=\"item in pinnedItems\"\n\t\t\t\t\t\t:key=\"item.dialogId\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t@click=\"onClick(item, $event)\"\n\t\t\t\t\t\t@click.right=\"onRightClick(item, $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-list-copilot__general_container\">\n\t\t\t\t\t<CopilotItem\n\t\t\t\t\t\tv-for=\"item in generalItems\"\n\t\t\t\t\t\t:key=\"item.dialogId\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t@click=\"onClick(item, $event)\"\n\t\t\t\t\t\t@click.right=\"onRightClick(item, $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<LoadingState v-if=\"isLoadingNextPage\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["MessageText","name","components","MessageAvatar","props","item","type","Object","required","data","computed","AvatarSize","recentItem","dialog","$store","getters","dialogId","user","message","showLastMessage","Settings","recent","hiddenMessageText","$Bitrix","Loc","getMessage","isLastMessageAuthor","authorId","Core","getUserId","lastMessageAuthorAvatar","authorDialog","avatar","lastMessageAuthorAvatarStyle","backgroundImage","messageText","formattedText","Parser","purifyRecent","formattedMessageText","SPLIT_INDEX","Utils","text","insertUnseenWhitespace","preparedDraftContent","phrase","loc","PLACEHOLDER_LENGTH","length","prefix","slice","formattedDraftText","purify","draft","showIconIfEmptyText","methods","phraseCode","replacements","template","CopilotItem","ChatAvatar","ChatTitle","formattedDate","formatDate","date","formattedCounter","counter","toString","layout","isChatSelected","Layout","copilot","entityId","isChatMuted","isMuted","muteList","find","element","Boolean","isSomeoneTyping","writingList","showPinnedIcon","pinned","unread","showCounter","wrapClasses","itemClasses","DateFormatter","formatByTemplate","DateTemplate","CopilotRecentService","RecentService","getQueryParams","firstPage","ONLY_COPILOT","LIMIT","itemsPerPage","LAST_MESSAGE_DATE","lastMessageDate","GET_ORIGINAL_TEXT","PARSE_TEXT","getModelSaveMethod","getCollection","getStore","getExtractorOptions","withBirthdays","hideChat","Logger","warn","dispatch","id","chatIsOpened","Messenger","openCopilot","getRestClient","callMethod","RestMethod","imRecentHide","DIALOG_ID","catch","error","console","CopilotRecentMenu","RecentMenu","getMenuItems","getPinMessageItem","getHideItem","getLeaveItem","getOpenItem","onclick","context","menuInstance","close","getRecentService","service","CopilotList","LoadingState","emits","isLoading","isLoadingNextPage","collection","sortedItems","sort","a","b","firstDate","secondDate","pinnedItems","filter","generalItems","isEmptyCollection","created","contextMenuManager","loadFirstPage","CopilotDraftManager","getInstance","initDraftHistory","beforeUnmount","destroy","onScroll","event","dom","isOneScreenRemaining","target","hasMoreItemsToLoad","loadNextPage","onClick","$emit","onRightClick","preventDefault","openMenu","currentTarget"],"mappings":"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"}